<html>
<head>
<title>Creating a Real-Time Flight-info Data Pipeline with StreamSets, Kafka, ElasticSearch and Kibana</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用StreamSets、Kafka、ElasticSearch和Kibana创建实时航班信息数据管道</h1>
<blockquote>原文：<a href="https://itnext.io/creating-a-real-time-flight-info-data-pipeline-with-streamsets-kafka-elasticsearch-and-kibana-dc40868c1021?source=collection_archive---------0-----------------------#2019-11-01">https://itnext.io/creating-a-real-time-flight-info-data-pipeline-with-streamsets-kafka-elasticsearch-and-kibana-dc40868c1021?source=collection_archive---------0-----------------------#2019-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e1ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将使用<a class="ae ko" href="https://www.schiphol.nl/nl/developer-center/pagina/our-flight-api-explored/" rel="noopener ugc nofollow" target="_blank">史基浦航班API </a>、<a class="ae ko" href="https://streamsets.com/products/sdc" rel="noopener ugc nofollow" target="_blank">流集数据收集器</a>、<a class="ae ko" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Kafka </a>、<a class="ae ko" href="https://www.elastic.co" rel="noopener ugc nofollow" target="_blank">elastic search</a>和<a class="ae ko" href="https://www.elastic.co" rel="noopener ugc nofollow" target="_blank"> Kibana </a>来构建到达史基浦(阿姆斯特丹国际机场)航班的实时数据管道。我将向您展示使我们能够创建这个数据管道的高级架构和相应的配置。最终结果将是一个从ElasticSearch获取实时数据的Kibana仪表板。</p><p id="4af0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要阅读这个“教程”,你应该对Docker和数据工程概念有一些基本的了解，比如转换和流。</p><h1 id="08d0" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">高层架构</h1><p id="79a2" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">高层架构由两条数据管道组成；一条管道传输来自公共飞行API的数据，转换数据并将数据发布到Kafka主题<code class="fe ls lt lu lv b">flight_info</code>:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lw"><img src="../Images/0bd59fc9a7c0603916437ca84c6a8c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNUyI1cJ5wtAlBeo9aNSgA.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">已描述的第一个管道的可视化表示</figcaption></figure><p id="4aa9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二个管道消耗来自这个主题的数据，并将数据写入ElasticSearch。最后，Kibana连接到ElasticSearch，每5秒钟获取一次新数据:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mm"><img src="../Images/7bf184903bac2f7df8dbffe8eb8c5b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3lOlmiE2pofo1QPASKlSQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">已描述的第二条管道的直观表示</figcaption></figure><p id="d9b6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文的剩余部分，我将简要介绍管道的每个组件及其相应的配置。</p><h1 id="9317" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">用Docker-Compose创建我们的环境</h1><p id="7a52" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">我们可以通过这个简单的<a class="ae ko" href="https://github.com/klimpie94/flight-pipeline/blob/master/docker-compose.yml" rel="noopener ugc nofollow" target="_blank"> docker-compose文件</a>轻松构建我们将要使用的所有服务。在包含该文件的目录中执行<code class="fe ls lt lu lv b">docker-compose up</code>命令，将自动创建一个本地环境，其中包含:</p><ul class=""><li id="209c" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated">一个卡夫卡节点</li><li id="0509" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated">动物园管理员</li><li id="89bc" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated">流集数据收集器</li><li id="4674" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated">弹性搜索6.3.2</li><li id="8fdb" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated">基巴纳6.3.2</li></ul><blockquote class="nb nc nd"><p id="3d49" class="jq jr ne js b jt ju jv jw jx jy jz ka nf kc kd ke ng kg kh ki nh kk kl km kn im bi translated">在继续下一步之前，您必须对您的撰写文件做一个小小的更改:</p><p id="d1ce" class="jq jr ne js b jt ju jv jw jx jy jz ka nf kc kd ke ng kg kh ki nh kk kl km kn im bi translated">KAFKA _ ADVERTISED _ HOST _ NAME:<place your="" docker="" host="" ip="" here=""/></p></blockquote><p id="21b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以通过以下步骤找到您的Docker主机IP:</p><ul class=""><li id="28f7" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated">在你的终端中做一个<strong class="js iu"> <em class="ne"> ifconfig </em> </strong></li><li id="44e1" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated">向下滚动到<strong class="js iu"> <em class="ne"> en0: </em> </strong></li><li id="6e34" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated"><strong class="js iu"> <em class="ne"> inet </em> </strong>后的ip就是你的Docker主机IP。</li></ul><p id="e793" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">多亏了这个<a class="ae ko" href="https://stackoverflow.com/questions/22944631/how-to-get-the-ip-address-of-the-docker-host-from-inside-a-docker-container" rel="noopener ugc nofollow" target="_blank">环节</a></p><h1 id="5c67" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">史基浦机场-公共飞行API</h1><p id="9145" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">史基浦公共航班API是一个REST API，它提供了大量关于往来史基浦机场的当前和预定航班的信息。它是免费的，在<a class="ae ko" href="https://developer.schiphol.nl/signup" rel="noopener ugc nofollow" target="_blank">网站</a>注册后就可以访问。</p><p id="5983" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注册后，您可以访问航班的详细信息，如目的地、航班状态、飞机类型、预定时间等。对于我们的特定用例，我们感兴趣的是进港航班和其他与此密切相关的有用信息。</p><h1 id="01b5" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">流集数据收集器</h1><p id="012a" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">StreamSets Data Collector (SDC)是一款开源、低延迟的接收工具，可以让您在一个易于使用的UI中设计复杂的任意对任意数据管道。它设计用于处理连续到达的数据(流)和批处理数据。SDC兼容多种系统和工具，如Spark、关系数据库、云(AWS、Azure、GCP)、Hadoop等。</p><h1 id="7862" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated"><strong class="ak">创建第一条管道</strong></h1><p id="181e" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">如果您执行了前面的docker-compose命令，那么您可以通过这个<a class="ae ko" href="http://localhost:18630" rel="noopener ugc nofollow" target="_blank">链接</a>访问SDC。默认的登录凭证是密码为<code class="fe ls lt lu lv b">admin</code>的<code class="fe ls lt lu lv b">admin</code>，下一步是创建一个名为‘Flight data to Kafka’的新管道。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ni"><img src="../Images/3601bc95c50910a5f622397bd661383f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0t0EE_vd0p-iv7SdpeYdg.png"/></div></div></figure><p id="179a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> HTTP客户端</strong></p><p id="d5e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">点击“保存”后，您将看到一个空管道。选择<strong class="js iu"> HTTP客户端</strong>作为‘origin ’,并使用以下配置开始配置HTTP客户端origin:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/26cff50805fe5c6a4bfac24eba0f55ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4iGwdHUV6m4UMmO3CGpuPQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">HTTP客户端1/2的配置</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nk"><img src="../Images/1789e98f6e76fa66c0730f64518457f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8NjDPgqNQBEQ9-I9eTVmg.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">HTTP客户端2/2的配置</figcaption></figure><p id="c060" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种配置允许我们向公共Flight API发出GET请求，该API将依次响应一个包含20个航班的大型JSON响应。公共Flight API使用分页，这基本上意味着它被设计成将响应保持在合理的大小。在响应的链接头中，返回下一个和最后一个页面的<strong class="js iu">的URI。这样配置分页选项卡将允许我们从所有航班获取数据！</strong></p><p id="2808" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在所有请求中，我们都需要提供<code class="fe ls lt lu lv b">APP ID</code>和<code class="fe ls lt lu lv b">APP KEY</code>。从版本v4开始，这必须在标题中完成。我们将<strong class="js iu">模式</strong>设置为<code class="fe ls lt lu lv b">Streaming</code>，并将<strong class="js iu"> HTTP方法</strong>设置为<code class="fe ls lt lu lv b">GET</code>。所有的HTTP客户端参数，如<code class="fe ls lt lu lv b">Resource URL</code>、<code class="fe ls lt lu lv b">app_id</code>和<code class="fe ls lt lu lv b">app_key</code>都由公共飞行API提供，在这里可以很容易地找到<a class="ae ko" href="https://developer.schiphol.nl/admin/applications" rel="noopener ugc nofollow" target="_blank">。</a></p><blockquote class="nb nc nd"><p id="7e29" class="jq jr ne js b jt ju jv jw jx jy jz ka nf kc kd ke ng kg kh ki nh kk kl km kn im bi translated"><em class="it">我们还需要更改数据格式页签中的一个参数:</em></p><p id="7404" class="jq jr ne js b jt ju jv jw jx jy jz ka nf kc kd ke ng kg kh ki nh kk kl km kn im bi translated">设置为:</p><p id="1113" class="jq jr ne js b jt ju jv jw jx jy jz ka nf kc kd ke ng kg kh ki nh kk kl km kn im bi translated"><strong class="js iu">最大对象长度(字符):</strong> 32768000</p></blockquote><p id="f4b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每个JSON响应都是一个大的JSON对象，包含几个不同的航班。然而，为每次飞行使用一个JSON对象要容易得多。因此，我们使用一个<strong class="js iu">字段透视器</strong>将大的JSON对象展平为每个航班的一条消息:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nl"><img src="../Images/b44babb3ead2a3dba27689a64e46192c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hlrYaXSk34FzpmutscJywg.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">用StreamSets字段透视工具展平JSON对象</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nm"><img src="../Images/ffea2921670e2d5c10df554732f0324b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILu25jkJHwOd6PN-cDA0qA.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">现场Pivoter的配置</figcaption></figure><p id="00e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">展平JSON对象后，我们可以使用<strong class="js iu">字段移除器</strong>轻松选择我们感兴趣的字段:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nk"><img src="../Images/fb830660d22c68ca51d962f228124ae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JH2IUYTTQZdDyAkAvANYWQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">现场移除器处理器的配置</figcaption></figure><p id="1e62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我们现在只剩下我们感兴趣的字段(见:下图左侧)。然而，我们仍然背负着一个嵌套字段(<code class="fe ls lt lu lv b">Route-destinations-0</code>)，为了克服这种不适，我们将应用一个<strong class="js iu">字段拼合器</strong>。这个字段展平器以一种更理想的格式展平我们的JSON对象(图片的右侧展示了最终结果)。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/7d2c3e3f5fef707f1f0eed6783750240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6dJQn3UKJm6ifPrplUHwA.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">输入数据:应用字段移除器后得到的JSON。输出数据:应用字段拼合器后的JSON</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/9957ca2b86325b2fef00794ec3cf1821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*INaA2UhOUlXNAFfDJFDC8Q.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">场平仪的配置</figcaption></figure><p id="e95c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除此之外，我们还将通过在此阶段声明一个前提条件来过滤掉所有偏离:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/441ed7a003e94bdf82426a8cdbb8f957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAYPrLl27VuE_PKSrO0OHg.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">保留所有满足前提条件FlightDirection=="A "的记录。</figcaption></figure><p id="b170" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们还将对JSON对象应用一个<strong class="js iu">字段重命名器</strong>。这个字段重命名器只是将字段<code class="fe ls lt lu lv b">/’route.destinations.0'</code>转换成<code class="fe ls lt lu lv b">/departedFrom</code>。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nn"><img src="../Images/9090bb2a01e8960f8a6dd5ee34bee71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hx8JdfFWyhVXtKgSEhfevw.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">发送给Kafka的JSON对象</figcaption></figure><p id="8adb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的数据现在可以写入卡夫卡；我们“飞行数据到卡夫卡”管道的最后一步。</p><p id="ef7d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">卡夫卡<br/> </strong>卡夫卡是什么？简而言之:Kafka是一个开源软件，它提供了一个在分布式环境中存储、读取和分析流数据的框架。Kafka的受欢迎程度尤其可以用其高吞吐量(百万/秒)、可扩展性和可靠性来解释。如果你对卡夫卡不熟悉，看看他们的<a class="ae ko" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank">网站和文档</a>。</p><p id="c2bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在SDC，我们必须指定卡夫卡的制片人作为目的地。Kafka Producer有可能不在您的目的地标签中，在这种情况下，您必须通过软件包管理器安装它，您可以通过单击屏幕顶部的“gift”图标来访问软件包管理器。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi no"><img src="../Images/23ca3aa105e072fecf9c6f3b54b0b4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0l2IW6HUh13IUEXTH0wXjQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">卡夫卡生产者的配置</figcaption></figure><p id="0b85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种配置(如上图)创建了一个名为<code class="fe ls lt lu lv b">flight_info</code>的卡夫卡主题。在代理URI中，您必须指定&lt; Docker主机IP:9092 &gt;。就这样，我们已经完成了我们的第一个管道，它应该是这样的:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/b0e9a808393ffaf9741584dbbe277def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BMiueFD-2wFrQPN8PZRGrQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">StreamSets数据收集器中第一个管道的概述</figcaption></figure><h1 id="bc9f" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">创建第二条管道</h1><p id="454e" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">第二管线仅由两个阶段组成。起点是一个从主题<code class="fe ls lt lu lv b">flight_info</code>读取数据的Kafka消费者，这条管道的目的地是ElasticSearch。</p><blockquote class="np"><p id="c83e" class="nq nr it bd ns nt nu nv nw nx ny kn dk translated">什么是ElasticSearch？ElasticSearch是一个分布式、开源的搜索和分析引擎，适用于所有类型的数据，包括文本、数字、地理空间、结构化和非结构化数据。ElasticSearch以其简单的REST APIs、分布式特性、速度和可伸缩性而闻名，它是Elastic Stack的核心组件，是一套用于数据摄取、丰富、存储、分析和可视化的开源工具。(来源:<a class="ae ko" href="https://www.elastic.co/products/elasticsearch" rel="noopener ugc nofollow" target="_blank">链接</a>)</p></blockquote><figure class="oa ob oc od oe mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nz"><img src="../Images/30224732bb441a639d8cf1d6bb089065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9-7Ub-JUvrxukqPJH0Z-A.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">卡夫卡消费者的配置</figcaption></figure><p id="886d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了使本文简单，我们将把航班数据写入一个名为<code class="fe ls lt lu lv b">flights</code>的ElasticSearch索引(例如，一种“表”)，将映射设置为<code class="fe ls lt lu lv b">flights</code>(尽管我们没有上传任何元数据到ElasticSearch)，并将<strong class="js iu">文档ID </strong>字段设置为<code class="fe ls lt lu lv b">${record:value(‘/flightName’)}</code>。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/1d5d6ccc0d57b1742081bcef7ed46682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dy-4npN9f_S--r2NGwtVaQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">弹性搜索1/2的配置</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/183867708a1cb5413abe6c20fecccf23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J63Ss90q1-aaor62hIyDDw.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">弹性搜索2/2的配置</figcaption></figure><p id="dc57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们选中<strong class="js iu"> Enable Upsert </strong>，这样记录将根据文档ID自动更新或插入到ElasticSearch中。</p><p id="5ff2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们可以同时运行“飞往Kafka的航班数据”和“飞往ElasticSearch的Kafka”:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/467443fa80cdfaceb2b530dd9e3356ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lo6FvBC_n6PwUfB64FPBWQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">流集内部管道监控</figcaption></figure><h1 id="2903" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">基巴纳</h1><p id="09ac" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">Kibana是一个用于弹性搜索的开源数据可视化插件。它在Elasticsearch集群上索引的内容之上提供可视化功能。用户可以在大量数据的基础上创建条形图、折线图和散点图，或者饼状图和地图(来源:<a class="ae ko" href="https://www.theserverside.com/discussions/thread/80828.html" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="ad86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过这个<a class="ae ko" href="http://localhost:5601" rel="noopener ugc nofollow" target="_blank">链接</a>可以访问基巴纳。单击链接后，我们需要设置一个索引模式。搜索索引<code class="fe ls lt lu lv b">flights</code>并创建索引模式，我们现在应该能够在Kibana中可视化并<a class="ae ko" href="http://localhost:5601/app/kibana#/discover" rel="noopener ugc nofollow" target="_blank">查看</a>我们的数据。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/726cc02a7123630f9ea9e4acdf2f2a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ptxi55SgZpc7en_XC23qhg.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">在Kibana中创建索引模式</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nj"><img src="../Images/97454ed610acab15da6a7725fdc4e786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKX0SkEJsk11aShtvOIBsQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">实时飞行数据显示在基巴纳</figcaption></figure><h1 id="fea0" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结束语</h1><p id="479e" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">如您所见，由于有了<strong class="js iu"> StreamSets，创建这样一个相对复杂的管道已经被简化了几个数量级。</strong>我期待着在我当前的项目中使用这个<strong class="js iu">强大的</strong>工具，并且我可能会在不久的将来写一篇关于<a class="ae ko" href="https://streamsets.com/products/transformer/" rel="noopener ugc nofollow" target="_blank"> StreamSets Transformer </a>的文章。这篇文章的docker-compose文件可以在<a class="ae ko" href="https://github.com/klimpie94/flight-pipeline/blob/master/docker-compose.yml" rel="noopener ugc nofollow" target="_blank">这里</a>找到。请随时向我提供任何反馈或意见。</p><p id="cc33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，如果你有兴趣参加<a class="ae ko" href="https://www.linkit.nl/vacatures/data-engineering/0007529/data-engineering-apprenticeship-starts-feb-1st-2020" rel="noopener ugc nofollow" target="_blank">数据工程训练营</a>或者你只是好奇我是如何经历这两个‘紧张’月的，请随时联系我:)我可以肯定地推荐这是你职业生涯的一个完美开端。</p><h1 id="e08e" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">参考</h1><ul class=""><li id="bc35" class="mn mo it js b jt ln jx lo kb of kf og kj oh kn ms mt mu mv bi translated"><a class="ae ko" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Getting_Started/GettingStarted_Title.html#concept_htw_ghg_jq" rel="noopener ugc nofollow" target="_blank">流集数据采集器文档</a></li><li id="1ac3" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated"><a class="ae ko" href="https://www.schiphol.nl/nl/developer-center/pagina/our-flight-api-explored/" rel="noopener ugc nofollow" target="_blank">史基浦机场公共航班API </a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Creating a Twitter bot at 5am</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在凌晨5点创建一个推特机器人</h1>
<blockquote>原文：<a href="https://itnext.io/creating-a-twitter-bot-in-5am-2a42a9920e67?source=collection_archive---------1-----------------------#2018-05-06">https://itnext.io/creating-a-twitter-bot-in-5am-2a42a9920e67?source=collection_archive---------1-----------------------#2018-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c29f1e10028241d15d94acbc078edf26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*diKuoCb0vjKUjXMrrKixXQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/photos/HAIPJ8PyeL8?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">freestocks.org</a>在<a class="ae kc" href="https://unsplash.com/search/photos/twitter-bot?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="8134" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如今，社交网络的使用被认为是一件很正常的事情，是我们日常生活的一部分。也许大部分人甚至不去想它。他们只是自动使用它们。就这样。</p><p id="e3e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是这些人中的一些人也可能会问这个让我写这篇文章的问题——我们从这些网络中获得了什么来给他们我们的个人数据、我们的兴趣和偏好？我们能用它们做什么？</p><p id="a970" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嗯，创建一个Twitter机器人不是新的也不是热门话题(甚至不难做到)，但这是我提到的事情之一。Twitter是一个社交网络，它产生并使用人与人之间的大量数据流。这个网络中所谓的机器人实际上是用某种编程语言编写的小程序。</p><p id="4487" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">我们能从社交网络中获得的最有价值的东西之一就是数据。我们可以用自动化的方式来完成。这就是这些软件，机器人，可以帮助我们的地方。</em></p><p id="120b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你在谷歌上搜索这个话题，你会发现Twitter机器人最常见的例子之一是转发或喜欢某些推文的机器人，通过某些标准进行搜索。该标准可以由机器人的创建者来定义。我在这个话题上读得越多，我就越想我能用这个机器人做什么。此外，我必须确保这不会垃圾邮件和骚扰其他人。还是那句话，最简单的答案就是正确的。我已经决定创建一个机器人，它将向我发送私人消息，其中包含与我感兴趣的主题相关的推文信息。在我完成第一个版本后不久(大约在早上5点开始，<em class="lb">因此有了这篇文章的标题:)</em><em class="lb"/>我想我自己也应该做得对其他人更有用一点。</p><p id="1eaf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">我就是这样用Node.js创建了一个Twitter机器人，向他的追随者直接发送消息，提供与特定搜索标准相关的tweets信息。</em></p><p id="f1dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在说得够多了，让我们开始有趣的部分。</p><p id="3832" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">TL；博士</strong></p><p id="d894" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文的其余部分将是如何创建一个twitter机器人并将其部署到Heroku的一步一步的教程。机器人会向他的追随者发送私人信息。这些消息将包含与预定义搜索标准相关的推文。你可能已经熟悉了# <em class="lb">标签</em>这个术语。实际上，这样的标签将成为我们的搜索标准，或者是我们过滤推文的关键词。在我的例子中，我选择使用以下代码:#js、#javascript、#JS、#JavaScript、#react、#reactjs、#nodejs、#Nodejs。这意味着机器人会发送提到他们的消息。然后，我们将获取机器人拥有的所有追随者的id，并使用它们向他们发送直接消息。</p><p id="e28b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想直接跳到代码，这里有<a class="ae kc" href="https://github.com/mihailgaberov/twitter-bot" rel="noopener ugc nofollow" target="_blank">的GitHub回购</a>。</p><p id="2c0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">初始设置<br/> </strong>通过<strong class="kf ir"> <em class="lb"> npm </em> </strong>设置项目:</p><p id="bb94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于这将是一个基于Node.js的项目，使用著名的节点包管理器<a class="ae kc" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>是有意义的。首先，确保你已经安装了<a class="ae kc" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>，然后你就可以使用<em class="lb"> npm </em>。</p><p id="28ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成安装后，您可以为我们的机器人设置一个简单的项目。要开始，请在您的终端中键入以下内容:</p><ol class=""><li id="80fe" class="lc ld iq kf b kg kh kk kl ko le ks lf kw lg la lh li lj lk bi translated"><strong class="kf ir"><em class="lb">NPM</em>T22】initT24】</strong></li><li id="2b2a" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">回答<em class="lb"> npm </em>要求您创建package.json文件的问题(您可以跳过这一步，使用默认答案，方法是添加- <strong class="kf ir"> y </strong>参数，如下:<strong class="kf ir"><em class="lb">NPM</em><em class="lb">init</em><em class="lb">-y</em></strong>)</li><li id="1bbb" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">通过键入:<strong class="kf ir"><em class="lb">NPM I twit dotenv-save-dev</em></strong><em class="lb">安装我们需要的依赖项。</em>这将安装我们创建机器人所需的所有软件包。(‘I’是‘install’的缩写)</li></ol><p id="833a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">注</em> <strong class="kf ir"> </strong> <em class="lb">约</em> <strong class="kf ir"> </strong> <em class="lb">包</em> <strong class="kf ir"> : </strong>既有<strong class="kf ir"> </strong>包<strong class="kf ir"> </strong>又有<strong class="kf ir"> </strong>名噪一时的<strong class="kf ir"> </strong>。第一个<a class="ae kc" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"><em class="lb"/></a>是通过<em class="lb">处理<a class="ae kc" href="https://en.wikipedia.org/wiki/Environment_variable" rel="noopener ugc nofollow" target="_blank">环境变量</a>。env </em>文件。这是我们存储API密钥和令牌的地方。第二个，即<a class="ae kc" href="https://www.npmjs.com/package/twit" rel="noopener ugc nofollow" target="_blank"> <em class="lb"> twit </em> </a>，是Node.js的一个Twitter API客户端，它提供了一个很好的、容易使用的与Twitter API交互的界面。</p><p id="cdd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">配置设置<br/> </strong>为了能够使用<a class="ae kc" href="https://developer.twitter.com/en/docs" rel="noopener ugc nofollow" target="_blank">推特应用编程接口</a>，我们需要获得四样东西:消费者密钥、消费者秘密、访问令牌和访问令牌秘密。这些都是简单的字符串，您稍后会看到。要得到这些，你唯一需要做的就是推特账户。一旦你得到了它，去<a class="ae kc" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank">https://apps.twitter.com/</a>创建一个新的应用程序。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/70e8f371318ef9c116ea3582e92fb3c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RpSJsqBTx00eR49I."/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/26dea67d97ca1bc7ae79c2cc5ad90e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:66/0*mIJloxPIYLnsB-ha."/></div></figure><p id="6cba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，您必须转到“密钥和访问令牌”选项卡，并通过单击底部的按钮生成令牌。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/f8b0b1623bcd2cfb2481524e7d6c70fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5nMVyJeiswSg4Jcq."/></div></div></figure><p id="c1f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，一旦您完成了这些配置，我们就可以继续了。回到您的项目并创建一个新文件。您可以将其命名为<em class="lb">config . js</em>把<em class="lb"/><em class="lb"/>后面的<em class="lb"> </em>代码<em class="lb"> </em>放在里面:</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="60b0" class="mc md iq ly b gy me mf l mg mh">require('dotenv').config()<br/>module.exports = {<br/> consumer_key: process.env.CONSUMER_KEY,<br/> consumer_secret: process.env.CONSUMER_SECRET,<br/> access_token: process.env.ACCESS_TOKEN,<br/> access_token_secret: process.env.ACCESS_TOKEN_SECRET<br/>}</span></pre><p id="83b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这只是一个包含我们需要的配置的简单对象。通过使用<a class="ae kc" href="https://nodejs.org/api/modules.html" rel="noopener ugc nofollow" target="_blank"> Node.js模块导出</a>，我们将它公开以备后用。</p><p id="3ccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在主项目目录中创建另一个文件并命名为<em class="lb">。</em><a class="ae kc" href="https://www.twilio.com/blog/2017/08/working-with-environment-variables-in-node-js.html" rel="noopener ugc nofollow" target="_blank"><em class="lb">env</em></a>——这是我们将放置先前生成的密钥的地方。它应该是这样的:</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="75f1" class="mc md iq ly b gy me mf l mg mh">CONSUMER_KEY=jsjIiJsjNslaxxxxxxxxxx<br/>CONSUMER_SECRET=ksjdhdjdxxxxxxxx<br/>ACCESS_TOKEN=jdjwowlgxxxxxxxxxxxx<br/>ACCESS_TOKEN_SECRET=jsoJdPxxxxx</span></pre><p id="4f79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，密钥的值是您的个人秘密密钥，这就是为什么您<strong class="kf ir">必须</strong> <strong class="kf ir">而不是</strong>将该文件提交到公共存储库中。</p><p id="7b8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">与Twitter API <br/> </strong>交互一旦我们完成了配置，我们就可以开始实现我们机器人的主要逻辑了。我们将把这个逻辑放到一个新文件中——<em class="lb">bot . js</em>(当然你可以随意命名自己的文件)。</p><p id="27b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从要求(例如导入)我们拥有的依赖项开始:</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="f29d" class="mc md iq ly b gy me mf l mg mh">const Twit = require('twit')<br/>const config = require('./config')<br/>const helpers = require('./helpers')</span></pre><p id="49e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个是我们安装的帮助我们轻松操作Twitter APIs的包。第二个是我们的配置，最后一个是一个小的帮助文件，其中包含一些有用的功能，我们可以重复使用。稍后我会更详细地解释这一点。</p><p id="0db1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">顺便提一下，我必须提到我使用的Node.js版本是最新的稳定版本。如果你不想明确地更新你的，我建议用你当前的教程来试试这个教程——如果有用的话，不用麻烦了。</p><p id="38e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，您的项目结构最终将是这样的:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/79b72a0f35af447681cda64ae542deb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/0*aGQJiv7qUeOvnpxb."/></div></figure><p id="51fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是通过将我们的配置作为输入参数传递来初始化Twit客户机:</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="1a70" class="mc md iq ly b gy me mf l mg mh">const Twitter = new Twit(config)</span></pre><p id="7e6a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这之后，就是我们主要函数的实现。它实现了我们需要的所有逻辑来获取推文，根据我们的搜索标准过滤它们，并向我们的机器人的追随者发送直接消息。</p><p id="cb54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">搜索<br/> </strong>我们从搜索功能开始，使用<em class="lb"> twit </em>包中的<em class="lb"> get() </em>方法向<em class="lb">搜索/tweets </em>端点发送get请求。我们还传递了一个<em class="lb"> params </em>对象，包含我们的搜索偏好，比如我们讨论过的标签和其他一些过滤器。</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="e62e" class="mc md iq ly b gy me mf l mg mh">const sendDirectMessage = function ()<br/>const params = {<br/>  q: '#js, #javascript, #JavaScript, #JS, #Javascript, #react,       #reactjs, #nodejs, #Nodejs, -filter:retweets',<br/>  result_type: 'recent',<br/>  lang: 'en'<br/>}</span><span id="c4af" class="mc md iq ly b gy mj mf l mg mh">Twitter.get('search/tweets', params, function (err, data) {…}</span></pre><p id="9e62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">过滤响应<br/> </strong>注意最后一部分的‘q’属性。这是由<a class="ae kc" href="https://developer.twitter.com/en/docs/tweets/search/api-reference/get-search-tweets.html" rel="noopener ugc nofollow" target="_blank"> Twitter API </a>提供的过滤器，允许我们过滤我们将得到的结果，并确保我们不会收到任何转发。这有助于我们减少机器人报告消息中的重复。<br/> <em class="lb"> result_type </em>是Twitter提供的另一个标志，它将结果缩小到只包括最近发布的推文。</p><p id="ae9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是生成机器人将发送给他的追随者的消息的内容。这可以通过简单地迭代<em class="lb">数据</em>来完成。<em class="lb">status</em>数组，包含我们搜索请求返回的所有tweets。然后我使用<a class="ae kc" href="http://es6-features.org/#StringInterpolation" rel="noopener ugc nofollow" target="_blank"> ES6字符串模板</a>来组成<em class="lb">内容</em>对象，它最终只是另一个稍长的字符串，将作为消息的实际内容。</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="b040" class="mc md iq ly b gy me mf l mg mh">data.statuses.forEach((status) =&gt; {<br/>  content += ` — — New Tweet:\n<br/>  Status text: ${status.text} \n<br/>  By: ${status.user.name}\n\n`<br/>})</span></pre><p id="78a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">获取</strong><strong class="kf ir"/><strong class="kf ir">追随者<br/> </strong>然后我们需要做另一个请求，以获取所有追随者的id。当我们实现实际发送背后的功能时，我们将使用这些id。这是通过点击'<em class="lb"> followers/ids </em>'端点并传递id和我们的机器人的屏幕名称(尽管只有id是必需的参数)来完成的。</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="3f8b" class="mc md iq ly b gy me mf l mg mh">Twitter.get('followers/ids', {<br/>  user_id: 982290988562608129,<br/>  screen_name: 'herrklinkerhof3'<br/>}, function (err, response) {…}</span></pre><p id="5a34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">发送</strong> <strong class="kf ir">消息<br/> </strong>在我们请求获取关注者id的回调部分，是发送直接消息的逻辑所在。我们使用另一个循环(<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"><em class="lb">forEach</em></a>JavaScript数组的方法)来遍历关注者id，并对每个关注者id向“<em class="lb">direct _ messages/events/new</em>”发出POST请求，发布我们之前编写的内容。</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="37f5" class="mc md iq ly b gy me mf l mg mh">response.ids.forEach((id) =&gt; {<br/>  Twitter.post('direct_messages/events/new', {<br/>    event: {<br/>      'type': 'message_create',<br/>      'message_create': {<br/>        'target': {<br/>          'recipient_id': id<br/>        },<br/>        'message_data': {<br/>          'text': content,<br/>        }<br/>      }<br/>    }<br/>}, function (err, response) {…}</span></pre><p id="d94f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">仅此而已。在文件的底部，我们只调用新创建的函数。</p><p id="0a84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">错误</strong> <strong class="kf ir">处理<br/> </strong>在本教程中没有实现实际的错误处理。这将是另一篇文章的主题。这里，为了简单起见，我们只是控制台记录错误。</p><p id="f5b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成所有步骤后，您的文件应该是这样的:</p><pre class="lr ls lt lu gt lx ly lz ma aw mb bi"><span id="bfe0" class="mc md iq ly b gy me mf l mg mh">const Twit = require('twit')<br/>const config = require('./config')<br/>const helpers = require('./helpers')<br/>const Twitter = new Twit(config)</span><span id="ac76" class="mc md iq ly b gy mj mf l mg mh">const sendDirectMessage = function () {<br/>  const params = {<br/>    q: '#js, #javascript, #JavaScript, #JS, #Javascript, #react, #reactjs, #nodejs, #Nodejs, -filter:retweets',<br/>    result_type: 'recent',<br/>    lang: 'en'<br/>  }</span><span id="b5b1" class="mc md iq ly b gy mj mf l mg mh">  Twitter.get('search/tweets', params, function (err, data) {<br/>    if (!err) {<br/>      let content = `== New report (from ${helpers.getCurrentTime()}           (${data.statuses.length} tweets)) ==\n`</span><span id="a609" class="mc md iq ly b gy mj mf l mg mh">      data.statuses.forEach((status) =&gt; {<br/>        content += ` — — New Tweet:\n<br/>        Status text: ${status.text} \n<br/>        By: ${status.user.name}\n\n`<br/>      })</span><span id="dbe3" class="mc md iq ly b gy mj mf l mg mh">      Twitter.get('followers/ids', {<br/>        user_id: 982290988562608129,<br/>        screen_name: 'herrklinkerhof3'<br/>      }, function (err, response) {<br/>           if (err) {<br/>             console.log('Something went wrong while getting followers. Error: ', err)<br/>           }</span><span id="f05e" class="mc md iq ly b gy mj mf l mg mh">           if (response) {<br/>             response.ids.forEach((id) =&gt; {<br/>               Twitter.post('direct_messages/events/new', {<br/>                 event: {<br/>                   'type': 'message_create',<br/>                   'message_create': {<br/>                     'target': {<br/>                       'recipient_id': id<br/>                     },<br/>                     'message_data': {<br/>                       'text': content,<br/>                     }<br/>                   }</span><span id="c86d" class="mc md iq ly b gy mj mf l mg mh">                 }</span><span id="058e" class="mc md iq ly b gy mj mf l mg mh">      }, function (err, response) {<br/>           if (response) {<br/>             console.log('Message sent. Response: ', response)<br/>           }</span><span id="d4df" class="mc md iq ly b gy mj mf l mg mh">           if (err) {<br/>             console.log('Something went wrong while sending message. Error: ', err)<br/>           }<br/>         })<br/>       })<br/>      }<br/>    })</span><span id="b6f5" class="mc md iq ly b gy mj mf l mg mh">     } else {<br/>       console.log('Something went wrong while searching.')<br/>     }<br/>  })<br/>}</span><span id="f655" class="mc md iq ly b gy mj mf l mg mh">sendDirectMessage()</span></pre><p id="11c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">现在是什么时间<br/> </strong>我前面提到的helpers文件(<em class="lb"> helpers.js </em>)。目前它只有一个功能，但是它可以根据您的需要轻松地拥有多个功能。这背后的想法是向您展示当您模块化代码并使其可重用时，使用是多么方便和容易。正在讨论的函数用于获取我们包含在报告标题中的当前时间。就这么简单。</p><p id="f827" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">在本地运行bot<br/></strong>要在本地运行bot，您唯一要做的就是打开您的终端并键入以下内容:</p><p id="427c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb"> npm启动</em></p><p id="46f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一切正常，您将看到“消息已发送”。响应:…'消息在控制台和所有现有的追随者将收到生成的消息。</p><p id="6203" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们完成编码之后，是时候把我们的工作部署到某个地方了。最著名的主持平台之一叫做<a class="ae kc" href="https://id.heroku.com/login" rel="noopener ugc nofollow" target="_blank"> Heroku </a>。我们将使用它来托管我们的bot应用程序。它给你选择开一个免费帐户，并有多达5个网络应用程序部署(他们会给你更多，如果你用信用卡号码验证自己)。创建帐户并登录后，您会在屏幕顶部看到一个“新建”菜单，您可以使用它来创建新的应用程序。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/b4aca4f7b4b85b7686ceea994ff93b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9NqkvyEBG3d5vfY4."/></div></div></figure><p id="5a16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以随意命名您的应用程序。</p><p id="1039" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">配置</strong> <strong class="kf ir">变量<br/> </strong>创建新应用后，你应该可以找到“设置”选项卡。转到那里，点击“显示配置变量”按钮。在这里，您可以输入您的配置变量(您还记得—您的消费者和API密钥)。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/ca724565988509e577f10e17a5e53c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hao0JTIUG11FXFjk."/></div></div></figure><p id="7a31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加它们后，只需再做一件事，即可部署您的应用程序。转到“部署”选项卡，将GitHub存储库连接到应用程序。然后启用自动部署，就这样。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/03512fa3af0363fba15c69d0baf46a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kMHr0yJT1fUGN3Oq."/></div></div></figure><p id="88e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在同一页的底部，你会发现“部署分支”按钮。使用它开始您的第一次部署。</p><p id="81f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，你应该把你的机器人部署到Heroku。如果你已经启用了自动部署，每次当你提交一些东西到你的GitHub库时，一个新的部署将被触发。</p><p id="50b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们想要在特定的时间触发特定的任务时，Heroku中有一些非常有用的东西可以使用。它叫做<a class="ae kc" href="https://devcenter.heroku.com/articles/scheduler" rel="noopener ugc nofollow" target="_blank"> Heroku Scheduler </a>，一个插件可以让你做到这一点。你可以在“资源”标签下找到它。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/10f5c3b3dbdee4cf3b5f17b8c63ef62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/0*9vGKo2-KwSTAaM09."/></div></figure><p id="b806" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你输入了你的信用卡信息，你就可以免费使用它。在我们的例子中，我们将使用它在特定时间运行bot，这意味着它将执行我们实现的搜索和发送消息的逻辑。我们通过添加由调度程序运行的作业来实现这一点，如下所示:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/f5ff79c7073c8098dc52788a89ed5d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pziJllm_v7e_nIAE."/></div></div></figure><p id="441f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过这种方式，我们可以有定期的报告，并及时了解人们在推特上关注什么，关注我们预先定义的兴趣。我在我的实现中使用了它，它在世界协调时每天早上5:30被触发。</p><p id="8ecf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">结论<br/> </strong>现在你应该已经在Heroku上部署了一个完全正常工作的Twitter机器人，或者至少知道如何实现它。简而言之，我们所做的是，我们看到了如何让社交网络为我们服务，通过实现一个Twitter机器人，让他寻找我们感兴趣的信息，并将报告作为直接消息发送给我们。此外，我们不仅为自己，也为对相同主题感兴趣的任何人增加了一个有用的功能，允许机器人的追随者也可以获得这些报告。我希望这对你和我来说都是一次有趣的旅行。欢迎把你的问题或评论发给我，或者你可以分享你的经验。</p><p id="234b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">未完待续… <br/> </strong>在另一篇文章中，我们将看到如何使用数据库来存储这些推文的最后搜索结果，并生成只包含唯一新推文的报告。敬请关注。</p><p id="ef03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">更新<br/> </strong> <em class="lb">我已经减少了用于搜索的标签的初始数量，并使用了</em> <a class="ae kc" href="https://developer.twitter.com/en/docs/tweets/search/guides/standard-operators" rel="noopener ugc nofollow" target="_blank"> <em class="lb">或运算符</em> </a> <em class="lb">来获得更好的搜索结果。</em></p><p id="f0e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">你可以在这里找到我的实现</em><a class="ae kc" href="https://github.com/mihailgaberov/twitter-bot" rel="noopener ugc nofollow" target="_blank"><em class="lb">https://github.com/mihailgaberov/twitter-bot</em></a><em class="lb">。如果你想开始收到和我一样的报告，请在Twitter @HerrKlinkerhof3中关注我的机器人。</em></p></div></div>    
</body>
</html>
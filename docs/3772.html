<html>
<head>
<title>Machine learning basics with a Python tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Python教程的机器学习基础</h1>
<blockquote>原文：<a href="https://itnext.io/machine-learning-basics-with-a-python-tutorial-2b262545a943?source=collection_archive---------2-----------------------#2020-02-21">https://itnext.io/machine-learning-basics-with-a-python-tutorial-2b262545a943?source=collection_archive---------2-----------------------#2020-02-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="c562" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">机器学习已经成为一个热门词汇有一段时间了，它隐藏了从数据分析到神经网络的一切。在本文中，我们将揭示ML的一些工作原理，我将向您展示一个文本分类的实际例子——对电影分级和文本情感分析进行分类。</p><h1 id="7380" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">监督和非监督学习</h1><p id="4350" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">ML有两个主要类别——监督学习和非监督学习。</p><p id="c22b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们必须有带注释的数据，例如温度数据及其日期和位置。然而，ML世界中的典型例子是所谓的<a class="ae lr" href="https://medium.com/syncedreview/mnist-reborn-restored-and-expanded-additional-50k-training-samples-70c6f8a9e9a9" rel="noopener"> MNIST数据集</a>——用实际数字标注的手写数字。</p><h2 id="03b5" class="ls kp it bd kq lt lu dn ku lv lw dp ky kb lx ly lc kf lz ma lg kj mb mc lk md bi translated">分类和回归</h2><p id="9998" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">数据分类只有一个目的——确定数据点属于哪一类数据(例如，在MNIST的情况下，确定图像中手写的数字；在下面的教程的情况下是电影评论的情绪)。回归用于从数据中“预测”和推断。例如生成文本——你可以从7本书中生成一个全新的哈利波特章节<a class="ae lr" href="https://twitter.com/botnikstudios/status/940627812259696643?s=20" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="27e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二个ML类别是无监督学习。它用于未标注的数据，通常用于发现数据点之间的隐藏模式和连接，或者用于数据聚类。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div class="gh gi me"><img src="../Images/464f4da1cf121a75f5b1860946864ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*cnVHiu0qNISC65fl.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated"><a class="ae lr" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_dbscan.html" rel="noopener ugc nofollow" target="_blank">无监督数据聚类</a></figcaption></figure><h1 id="40ae" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">数据集</h1><p id="0242" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">数据集通常有三个部分——训练集、测试集和验证集。</p><p id="b136" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">训练集由主要数据组成，ML算法使用这些数据来“学习”问题，找到模式和数据配置，并找到每个决策点的最佳权重。</p><p id="58dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">验证集是训练集的一部分，但同时又必须与训练集有所区别。换句话说，我们<em class="mq">随机</em>从一个数据集中抽取70%的数据用于训练集，30%用于验证集。</p><p id="aa26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">测试集使用完全不同的数据，最好是来自相似的数据集。在MNIST手写数字的情况下，它将是来自一个或多个不同作者的数据。通过这种方式，我们可以确定分类模型的准确性，这是衡量模型质量的主要标准。</p><p id="f129" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有时你会发现这两个术语，测试和验证集，可以自由地互换，以及它们的正确含义。</p><h1 id="5bfd" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">现在举个实际的例子</h1><p id="7284" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">作为例子，我将向你展示如何制作一个电影文本评论分类器。</p><p id="49db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我从imdb.com下载了文本数据。我已经为新电影“1917”复制了20条正面评论和20条负面评论——当然，IMDB API将用于现实生活中的项目。此外，评论不会保存在文本文件中，而是保存在一个. csv文件和类注释中。为了便于使用，我在本教程中使用了一个基本格式——前20行是正数，后20行是负数。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/84bd092df23cc731c2324bd622390bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-AZYWb0V9eiGThbwO_5HA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">dataset.txt中的数据点示例</figcaption></figure><p id="8d5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我用Python加载文件:</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mw"><img src="../Images/c732e6f6aec781a84d25bf7d3d5819cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uempYxe9cJw8MPXaH6tlPQ.png"/></div></div></figure><p id="02a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在所有的行都被加载到一个列表中。现在，我必须以某种方式转换文本，以便分类器能够在训练阶段提取尽可能多的有用信息。我去掉了文本中的特殊字符，并进行词汇化——将单词转换成它们的词根形式:</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mx"><img src="../Images/376d4aa9d4581cc4f50bf2552280b12e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UIE8dCakkLs3Rto-K3y5oA.png"/></div></div></figure><p id="7406" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我需要将单词转换成适合ML的格式。矢量化开始发挥作用了。将一个单词矢量化意味着将其转换为数字形式——可以说这类似于在文本中查找最常用的单词，但具有更深层次的上下文。我使用的矢量化方法是<a class="ae lr" href="https://en.wikipedia.org/wiki/Bag-of-words_model" rel="noopener ugc nofollow" target="_blank">单词包，</a>，它几乎完全做到了这一点。</p><p id="a756" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">矢量器被设置为只考虑20个最常用的单词；这些词必须在文本中出现至少2次，在60%的评论中出现最多(否则它们会失去信息价值和意义，有点像一个说话太多的神经质的人的话)。在此基础上，我删除了所有停用词，对ML没有任何重要意义的词(the，and，…)。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi my"><img src="../Images/a0934c59ccd0ccf75bef6c459a816116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7fa0hlwwvl6PUEisxFCgg.png"/></div></div></figure><p id="5799" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在文本被转换成数值，看起来像这样(每一行是一个单独的评论):</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mz"><img src="../Images/d962598fcdaaf098d5db05d5876e5e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfOkuGYtQCRGmDq3YpEU9g.png"/></div></div></figure><h2 id="57a2" class="ls kp it bd kq lt lu dn ku lv lw dp ky kb lx ly lc kf lz ma lg kj mb mc lk md bi translated">分类器训练</h2><p id="16e1" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">我使用了一个简单的分类器，5个邻居的K近邻和70/30数据集分割。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi na"><img src="../Images/ac595f6edf22e8d7750c7700ef2cd225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiYR1BsPOsPIhTKHJqlAWQ.png"/></div></div></figure><p id="9402" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在最后打印分类报告，混淆矩阵和模型精度。混淆矩阵在对角线上显示真阳性和真阴性，在另一条对角线上显示假阳性和假阴性。通过这些设置和这个小数据集，我得到了这个模型的2-7真实比率。准确率上升到了75%，但这对于这么小的数据集来说是很少见的(根据模型设置，准确率会下降到35%)。随着更多的数据(数千个数据点)和更智能的分类器，准确率可能会超过90%，没有任何问题。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nb"><img src="../Images/b6d37f098f460b35297fb16fbf1532d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwfdFBppz83Ju1S4Qf3_0g.png"/></div></div></figure><h2 id="5d5c" class="ls kp it bd kq lt lu dn ku lv lw dp ky kb lx ly lc kf lz ma lg kj mb mc lk md bi translated">文本中的情感分析</h2><p id="ae30" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">我将向你展示一个更有趣的实验——文本情感分析。这是一种用于观点和情感提取的NLP(自然语言处理)。社交网络通常被用作数据的来源和分类模型的目标(脸书和它令人毛骨悚然的老大哥对你的私人聊天、墙报等的分析)。).</p><p id="9699" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在这里用了一个相当简单的例子，VADER(化合价感知词典和情感推理器)的一个电影评论。VADER基于预先训练的分类模型对文本情感进行分类(有更复杂的方法来进行更准确和可靠的分析，如谷歌云自然语言API)。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nc"><img src="../Images/f18418beb102e278ef877d2cbcf10ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3DjUIGMxipSyJrTKrWeew.png"/></div></div></figure><p id="5a1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的3行代码在文本中找到70%的中性情绪和22%的正面情绪(这是正面评论之一):</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/e9a007caf5005f612d0f54421fc47fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rBlxKgRLrzDkFnix0xHqGA.png"/></div></div></figure><h2 id="ef0d" class="ls kp it bd kq lt lu dn ku lv lw dp ky kb lx ly lc kf lz ma lg kj mb mc lk md bi translated">在你走之前</h2><p id="4203" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">所以，我希望你喜欢这篇文章和教程，如果你对完整的源代码(包括导入和其他细节)感兴趣，你可以在我的<a class="ae lr" href="https://github.com/janjilecek/ML_article/tree/medium" rel="noopener ugc nofollow" target="_blank"> github </a>上找到它。下次见！</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nd"><img src="../Images/d03b95f35f07d74dd1a5b73de8127641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzzFih6_t6zY32n-ipx3mA.png"/></div></div></figure></div></div>    
</body>
</html>
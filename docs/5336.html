<html>
<head>
<title>Organize Your Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">组织您的测试</h1>
<blockquote>原文：<a href="https://itnext.io/organize-your-tests-96a7b9639999?source=collection_archive---------2-----------------------#2021-02-12">https://itnext.io/organize-your-tests-96a7b9639999?source=collection_archive---------2-----------------------#2021-02-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/80a478574d9b015b7d39259087320b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kZC6yODQ3NBrLiPHME1N-Q.png"/></div></div></figure><p id="344d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为什么要组织你的测试？那么，如果测试没有条理，你如何获得正确的反馈呢？</p><p id="e1e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我今年创作了至少两本flutter应用程序开发书籍，其中一部分工作就是确保每个学习flutter的开发者都能完成两项任务:</p><p id="9c52" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">1.学习扑得快</p><p id="baa4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2.能够在三个月的代码冲刺中推出一个中等大小的应用。</p><p id="7eaa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，我浏览了所有的flutter文档和dart文档，并分析了哪些地方出了问题，以使作为开发者的你能够成功完成上述两项任务。</p><p id="876b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这一次我将向你展示一些真正好的测试组织习惯和一些关于测试的秘密。而且，因为集成测试和小部件测试使用相同的测试api，所以集成和小部件测试都可以使用。</p><h1 id="2144" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">背景</strong></h1><p id="1d42" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">首先，让我们从最初创建flutter项目时创建的原始小部件测试代码开始:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="c5f4" class="ml la it mh b gy mm mn l mo mp">import 'package:flutter/material.dart';</span><span id="1ef2" class="ml la it mh b gy mq mn l mo mp">import 'package:flutter_test/flutter_test.dart';</span><span id="294d" class="ml la it mh b gy mq mn l mo mp">import 'package:link_like_a_boss/main.dart';</span><span id="00b3" class="ml la it mh b gy mq mn l mo mp">void main() {</span><span id="4e73" class="ml la it mh b gy mq mn l mo mp">testWidgets('Counter increments smoke test', (WidgetTester tester) <em class="mr">async</em> {</span><span id="618f" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Build our app and trigger a frame.</em></span><span id="db34" class="ml la it mh b gy mq mn l mo mp"><em class="mr">await</em> tester.pumpWidget(MyApp());</span><span id="f29d" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Verify that our counter starts at 0.</em></span><span id="d786" class="ml la it mh b gy mq mn l mo mp">expect(find.text('0'), findsOneWidget);</span><span id="8ae6" class="ml la it mh b gy mq mn l mo mp">expect(find.text('1'), findsNothing);</span><span id="a4fd" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Tap the '+' icon and trigger a frame.</em></span><span id="ec07" class="ml la it mh b gy mq mn l mo mp"><em class="mr">await</em> tester.tap(find.byIcon(Icons.add));</span><span id="4e32" class="ml la it mh b gy mq mn l mo mp"><em class="mr">await</em> tester.pump();</span><span id="8b00" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Verify that our counter has incremented.</em></span><span id="bed2" class="ml la it mh b gy mq mn l mo mp">expect(find.text('0'), findsNothing);</span><span id="76bd" class="ml la it mh b gy mq mn l mo mp">expect(find.text('1'), findsOneWidget);</span><span id="7fa8" class="ml la it mh b gy mq mn l mo mp">});</span><span id="e770" class="ml la it mh b gy mq mn l mo mp">}</span></pre><p id="c860" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这并不坏，但是在向你展示初级开发人员如何组织测试方面，这又是一个糟糕的工作。让我告诉你一个更好的方法。</p><h1 id="85f2" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">我组织测试的方式</strong></h1><p id="e707" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">最好的方法是展示代码，这样你就可以看到不同之处，然后我会解释代码的不同之处:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="d4da" class="ml la it mh b gy mm mn l mo mp">import 'package:flutter/material.dart';</span><span id="7221" class="ml la it mh b gy mq mn l mo mp">import 'package:flutter_test/flutter_test.dart';</span><span id="b957" class="ml la it mh b gy mq mn l mo mp">import 'package:karma/main.dart';</span><span id="b60f" class="ml la it mh b gy mq mn l mo mp">@TestOn("android")</span><span id="0ee0" class="ml la it mh b gy mq mn l mo mp">@TestOn("ios")</span><span id="0e7a" class="ml la it mh b gy mq mn l mo mp">void main() {</span><span id="9ac3" class="ml la it mh b gy mq mn l mo mp">setUpAll(() <em class="mr">async</em> {});</span><span id="957d" class="ml la it mh b gy mq mn l mo mp">tearDownAll(() <em class="mr">async</em> {});</span><span id="625d" class="ml la it mh b gy mq mn l mo mp">tearDown(() <em class="mr">async</em>{});</span><span id="38ad" class="ml la it mh b gy mq mn l mo mp">group('Basic Simple Unit Test', (){</span><span id="7f74" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// use runAsync when yu have calls to such things as Future.delayed in the testWidgets</em></span><span id="8952" class="ml la it mh b gy mq mn l mo mp">testWidgets("Counter increments smoke test", (WidgetTester tester) <em class="mr">async</em> {</span><span id="4591" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Build our app and trigger a frame.</em></span><span id="7889" class="ml la it mh b gy mq mn l mo mp"><em class="mr">await</em> tester.pumpWidget(MyApp());</span><span id="5fb1" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Verify that our counter starts at 0.</em></span><span id="1fef" class="ml la it mh b gy mq mn l mo mp">expect(find.text('0'), findsOneWidget);</span><span id="95c0" class="ml la it mh b gy mq mn l mo mp">expect(find.text('1'), findsNothing);</span><span id="3aa8" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Tap the '+' icon and trigger a frame.</em></span><span id="4be0" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// notice we cannot do a find.byType(FlatButton) because class _FlatButtonWithIcon is hiddne</em></span><span id="d7dd" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// so either this or</em></span><span id="5c3a" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// final iconedFlatBtnFinder = find.ancestor(of: find.byIcon(Icons.add),</em></span><span id="3a6e" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// matching: find.byWidgetPredicate((widget) =&gt; widget is FlatButton));</em></span><span id="0459" class="ml la it mh b gy mq mn l mo mp"><em class="mr">//</em></span><span id="7837" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// this happens to be more effectice in less code lines</em></span><span id="c177" class="ml la it mh b gy mq mn l mo mp"><em class="mr">await</em> tester.tap(find.byIcon(Icons.add));</span><span id="e934" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// only use pumpAndSettle() when you really do not know how many frames</em></span><span id="4ecb" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// otherwise use tester.pump() and define the number of microseconds</em></span><span id="1f1e" class="ml la it mh b gy mq mn l mo mp"><em class="mr">await</em> tester.pumpAndSettle();</span><span id="42a3" class="ml la it mh b gy mq mn l mo mp"><em class="mr">// Verify that our counter has incremented.</em></span><span id="d8f7" class="ml la it mh b gy mq mn l mo mp">expect(find.text('0'), findsNothing);</span><span id="c1c0" class="ml la it mh b gy mq mn l mo mp">expect(find.text('1'), findsOneWidget);</span><span id="e4ee" class="ml la it mh b gy mq mn l mo mp">});</span><span id="1ad0" class="ml la it mh b gy mq mn l mo mp">});</span><span id="e7fb" class="ml la it mh b gy mq mn l mo mp">}</span></pre><p id="a7c8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> TestOn注解</strong></p><p id="8763" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">@TestOn注释告诉flutter在android和ios平台上运行这些测试。这不是必需的，但我添加它作为测试和应用程序在什么平台上有效的文档</p><p id="4e50" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> setUpAll、setUp、tearDownAll和tearDown </strong></p><p id="2dcb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些函数可以在组块之外，也可以在组块之内，告诉flutter在测试设置和测试拆除期间执行什么。让我给你看一个集成测试的例子:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="8586" class="ml la it mh b gy mm mn l mo mp">setUpAll(() <em class="mr">async</em> {</span><span id="9857" class="ml la it mh b gy mq mn l mo mp">IntegrationTestWidgetsFlutterBinding.ensureInitialized();</span><span id="5509" class="ml la it mh b gy mq mn l mo mp">});</span></pre><p id="2c98" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这确保了在设置测试时和执行测试之前，integrationtestwidgetsfutterbinding被初始化。</p><p id="bca6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">异步vs运行异步</strong></p><p id="284e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一些你在最初的文件中找不到的东西。颤振测试同步运行，而不是异步运行。要异步执行它，你必须使用runAsync。</p><p id="63c5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">tester . pump vs tester . pumpandsettle</strong></p><p id="867b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您正在使用Future.delayed或者您正在注入依赖项来呈现列表，那么您应该将tester.pump更改为tester.pumpAndSettle，因为您将无法确定将tester.pump设置为多少帧(毫秒)。</p><p id="a674" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">使用群组</strong></p><p id="0271" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们通过组块建立测试套件，这样我们可以得到一个很好的有组织的测试套件文件。例如，在集成测试中，我可以直接在dart中设置行为测试，而不使用小黄瓜，这意味着不必用另一种语言编写BDD。</p><h1 id="ee81" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">结论</strong></h1><p id="6633" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">这听起来不多，但当你有数百个测试时，你会感谢我的。此外，让像你这样的初级开发人员从一开始就养成这种好习惯，会让你更容易从第一次编写代码开始就使用测试驱动开发来获得颤振概念。</p><h1 id="3ff4" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">资源</strong></h1><p id="6acb" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">一般资源:</p><p id="f993" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">扑社区资源【https://flutter.dev/community T2】</p><p id="37e0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">https://flutter.dev/docs/get-started/install飘起SDK <a class="ae ms" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank"/></p><p id="880c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Android Studio IDE<a class="ae ms" href="https://developer.android.com/studio" rel="noopener ugc nofollow" target="_blank">https://developer.android.com/studio</a></p><p id="c1ef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">MS的Visual Studio代码<a class="ae ms" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">https://code.visualstudio.com/</a></p><p id="5ae2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">扑单据<a class="ae ms" href="https://flutter.dev/docs" rel="noopener ugc nofollow" target="_blank">https://flutter.dev/docs</a></p><p id="693d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">dart Docs<a class="ae ms" href="https://dart.dev/guides" rel="noopener ugc nofollow" target="_blank">https://dart.dev/guides</a></p><p id="704f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">谷歌Firebase移动设备测试实验室<a class="ae ms" href="https://firebase.google.com/docs/test-lab" rel="noopener ugc nofollow" target="_blank">https://firebase.google.com/docs/test-lab</a></p><p id="fb04" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">商标公告</strong></p><p id="7b3a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Google LLC拥有以下商标:飞镖，颤振，机器人，机器人，诺托。苹果公司拥有iOS、MacOSX、Swift和ObjectiveC商标。苹果公司拥有SF Pro、Sf Compact、SF mono和New York字体的商标。JetBeans Inc .拥有JetBeans、IntelliJ和Kotlin的商标。甲骨文公司拥有Java商标。微软公司拥有微软视窗操作系统和Powershell的商标。Gradle是Gradle Inc .的商标。Git项目拥有Git的商标。Linux基金会拥有Linux的商标。智能手机OME自己的商标到他们的手机产品名称。尽我所能，我遵守上述商标的品牌和使用指南。</p><h1 id="e594" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">关于弗雷德·格罗特</strong></h1><p id="f89f" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">我是一个疯狂的SOB，作为一名前android移动开发者，我开始写关于flutter移动应用程序开发、设计和生活的文章(见<a class="ae ms" href="https://fredgrott.medium.com/eff-covid-and-the-gop-e912db0548b8" rel="noopener"> Eff COVID和</a><a class="ae ms" href="https://fredgrott.medium.com/eff-covid-and-the-gop-e912db0548b8)." rel="noopener">GOP</a>)。我会达到关键的每月100万观众大关吗？静观其变。在这些社交平台上找到我:</p><p id="c84b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae ms" href="https://www.xing.com/profile/Fred_Grott/cv" rel="noopener ugc nofollow" target="_blank">https://www.xing.com/profile/Fred_Grott/cv</a></p><p id="bf11" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae ms" href="https://www.linkedin.com/in/fredgrottstartupfluttermobileappdesigner/" rel="noopener ugc nofollow" target="_blank">https://www . LinkedIn . com/in/fredgrottstartupfluttermobileappdesigner/</a></p><p id="aa36" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">https://keybase.io/fredgrott<a class="ae ms" href="https://keybase.io/fredgrott" rel="noopener ugc nofollow" target="_blank"/></p><p id="cdad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">【https://twitter.com/fredgrott T4】</p></div></div>    
</body>
</html>
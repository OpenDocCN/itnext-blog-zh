<html>
<head>
<title>How to Create a Sentiment Analyzer with Text Classification — Python (AI)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建带有文本分类的情感分析器— Python (AI)</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-a-sentiment-analyzer-with-text-classification-python-ai-f3a5d10922c5?source=collection_archive---------1-----------------------#2019-02-18">https://itnext.io/how-to-create-a-sentiment-analyzer-with-text-classification-python-ai-f3a5d10922c5?source=collection_archive---------1-----------------------#2019-02-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/37e592b75bb80d8cfe17fabd61ec728d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cc8exApLG6iB4ftp_l_qBQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">斯蒂芬·道森在<a class="ae kc" href="https://unsplash.com/search/photos/dashboard?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d0ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">评论是网络上最毒的东西之一，但也有一些正面的，对吧？—使用人工智能创建一个基于文本分类的情感分析器如何？</p><p id="b810" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们去看看。</p><p id="8a8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们试图回答的问题是:一个特定的评论表达了积极的情绪还是消极的情绪？</p><p id="e99c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也许你不熟悉AI和机器学习概念，所以，让我用一种极其概括的方式解释一下，它是如何工作的。</p><p id="d8c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们谈论机器学习时，它相对类似于我们自己的学习过程。</p><blockquote class="lb"><p id="169f" class="lc ld iq bd le lf lg lh li lj lk la dk translated">你如何识别一种动物是猫还是狗？</p></blockquote><p id="5340" class="pw-post-body-paragraph kd ke iq kf b kg ll ki kj kk lm km kn ko ln kq kr ks lo ku kv kw lp ky kz la ij bi translated">我知道这样想起来很奇怪，但会有意义的。当你第一次看到那只动物时，有人告诉你:<strong class="kf ir">这是一只猫</strong>。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/ec67ada4767fdc925ff00bbdb1ade166.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*ZCRjAnuylgxi0q_AQHaFQg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">这是一只猫。</figcaption></figure><p id="1d71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后你大脑会联想到这种动物的一些特征，即使你没有注意到。</p><p id="e37a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在一些不同类型的猫的曝光之后，你将能够认出任何一只猫，包括像一只画的猫的抽象。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/473a48f102d7684e818f1ecd4b46d281.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*COuPbC2PSMoLFeQ1J_TYbg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">还是猫…</figcaption></figure><p id="8fba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，可以很公平地说，我们的经历塑造了我们看待事物的方式。人工智能模型也可以有这些经验，但我们将使用数据，而不是实际的事实。</p><p id="1071" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，我们的第一步是收集关于评论的数据，幸运的是一些公司提供了几个开放的数据集。我们将使用三个不同的数据集:IMDb，亚马逊和Yelp。</p><p id="f484" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在我的<a class="ae kc" href="https://github.com/gabrielschade/IA/tree/master/ClassificacaoComentariosComNaiveBayes/Datasets" rel="noopener ugc nofollow" target="_blank"> GitHub </a>或者我的<a class="ae kc" href="https://notebooks.azure.com/gabriel-schade/projects/py-sentiment-analysis/tree/Data" rel="noopener ugc nofollow" target="_blank"> Azure笔记本项目</a>中访问它们，这是你将要关注的。</p><p id="77ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，是时候创建开发解决方案的环境了。Azure笔记本电脑将很好地完成这项任务。</p><p id="ee65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建您的帐户后，您将能够创建一个新项目。</p><p id="8bae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Azure笔记本项目在某些方面像GitHub仓库一样工作，它们可以是公共的或私有的，有一个README.md文件，目的完全相同。</p><p id="f2ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新的项目窗口非常简单明了，如下图所示:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/b1ef14ade908160c16aae63f72cb43df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*ULMBWitVX7PGTxysF3Au4Q.png"/></div></figure><p id="ebe8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在您处于项目环境中，您将能够创建新的文件夹、文件和笔记本。正如我之前所说，它就像一个存储库，所以，你可以看到<em class="lx">星</em>和<em class="lx">克隆</em>按钮。</p><p id="b480" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建一个名为<em class="lx"> Data </em>的文件夹，并上传我们的数据集，如下图所示:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/88438d5c9ec49b1e96efd6556843e796.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIz847nisVPF4TMxHLsv6w.png"/></div></div></figure><h1 id="58b3" class="lz ma iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">规划人工智能算法解决方案</h1><p id="6297" class="pw-post-body-paragraph kd ke iq kf b kg mx ki kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">为了解决这个问题，我们将实现一个分类算法，我们将使用一个名为Scikit-learn的Python库来简化它。这个库包含了一些人工智能算法的实现，包括一些分类算法。</p><p id="68ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以将人工智能解决方案分成三个不同的步骤:</p><ol class=""><li id="70ed" class="nc nd iq kf b kg kh kk kl ko ne ks nf kw ng la nh ni nj nk bi translated">预处理；</li><li id="f74c" class="nc nd iq kf b kg nl kk nm ko nn ks no kw np la nh ni nj nk bi translated">培训；</li><li id="cda7" class="nc nd iq kf b kg nl kk nm ko nn ks no kw np la nh ni nj nk bi translated">评价；</li></ol><p id="53c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一步是收集、清理和组织你的数据。幸运的是，所选的数据集已经相当干净了。</p><p id="20eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二步是通过示例使用清理后的数据集来训练模型。通过这样做，您将生成一个分类器模型。</p><p id="8ddb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个模型包含一个预测功能，可以接收任何新的评论，并将其分类为正面或负面的评论。</p><p id="2617" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后一步是当你验证你的模型是否足够好来解决预定的问题。没有一步一步的验证，因为这完全取决于问题的意图。</p><h1 id="58e5" class="lz ma iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">让我们编码我们的算法</h1><p id="14b5" class="pw-post-body-paragraph kd ke iq kf b kg mx ki kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">在上述所有步骤之前，您需要创建笔记本本身，只需点击<em class="lx">添加</em>按钮并选择第一个选项:笔记本。</p><p id="13b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新的笔记本窗口也非常简单，对我们来说，只需要选择一个名称，然后选择Python 3.6作为笔记本语言。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/bda0e16f92fd550f8368946ee5d7bc2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*5BCyvG9MgaEDB5fKhLqeYw.png"/></div></figure><p id="2ccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从创建这个解决方案所需的库导入开始:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="afe7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Azure Notebook中，您可以混合markdown标题和代码，使其更有组织性:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/039a6caa3e22912da9cf5ce7ba157af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xEj9EsS2Vxrp0ijYw6LBdw.png"/></div></div></figure><p id="305b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以编写打开所有数据集并将它们合并为一个的函数。使用Python非常简单:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a528" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您需要注意到,<code class="fe nu nv nw nx b">root</code>变量包含数据集的文件夹名，在我的例子中是<code class="fe nu nv nw nx b">Data</code>,但是您可以随意使用任何文件夹名。</p><p id="1bb3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里另一个有趣的事情是，我们使用了断行符scape( <code class="fe nu nv nw nx b">\n</code>)将我们的数据分割成一个数组。</p><p id="e82d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用笔记本存储代码的另一个很酷的事情是，你可以与它交互，例如，我们已经可以调用<code class="fe nu nv nw nx b">get_all_data</code>函数并查看结果:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/e646383f2eb173374ddd98d088e39144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfqnfqNwg7V6vCPzF3JEqg.png"/></div></div></figure><p id="7bc7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说到<code class="fe nu nv nw nx b">get_all_data</code>的结果，我们来查看一下我们数据集的一些数据:</p><pre class="lr ls lt lu gt nz nx oa ob aw oc bi"><span id="62ca" class="od ma iq nx b gy oe of l og oh">Wow... Loved this place.	1<br/>Wasted two hours.  	0</span></pre><p id="9e09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设第一个是对一个地方的正面评价，可能是一家餐馆，而第二个是对一部电影的负面评价，这是很公平的。</p><p id="c5df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是让我们注意一下数据结构，有一个文本评论，后面是一个制表符(<code class="fe nu nv nw nx b">\t</code>)和一个代表每个评论实际分类的数字。</p><p id="b83f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将通过制表符值(<code class="fe nu nv nw nx b">\t</code>)来分割每一行，这样我们将创建一个数组，其中位置0包含文本，位置1包含分类。这会让我们以后的工作更容易。</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="0fb9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我之前说过的，我们可以单独运行每个函数，所以，让我们来看看结果:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/3ff64bb1a00fb61a15ee2bd0273b3d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*moKvPeuAADoHFPBNruZ9fw.png"/></div></div></figure><p id="cf7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成第一步的最后一个任务是将数据集分成两个不同的集合，每个集合用于下一个过程:训练和评估。</p><p id="a692" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要使用一个比率来划分数据，通常它可以在70–80%的培训比率和30–20%的评估比率之间变化，但在这种特殊情况下，我们将使用75%的比率来进行培训，因此，让我们划分它:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="625a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以看到上面的代码基于<code class="fe nu nv nw nx b">training_ratio</code>变量分割数据，所以，在我们完成实验后，你可以回到这里，改变这个值，看看它会如何执行。</p><p id="445e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在有了两个不同的数据集，我们准备进入下一步:训练过程。</p><p id="8935" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这样做之前，让我们将整个第一步简化为一个函数:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="ef9a" class="od ma iq bd mb oj ok dn mf ol om dp mj ko on oo mn ks op oq mr kw or os mv ot bi translated">稍微后退一步来理解这个理论</h2><p id="58d7" class="pw-post-body-paragraph kd ke iq kf b kg mx ki kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">在我们实施培训流程之前，了解它是如何工作的很重要，对吗？—没有它，它将只是一个由外部库实现的神奇解决方案。</p><p id="889b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要识别一个基于文本的情感，怎么做呢？—答案是:<em class="lx">词频。</em></p><p id="2f96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了实现它，我们首先需要用我们的算法创建一个所有已知单词的列表。让我们使用一个较小版本的数据集。假设我们的模型知道的所有单词是:</p><p id="4d53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nu nv nw nx b">hello, this, is, a, good, list, for, test</code></p><p id="5743" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们需要用这些单词输入一些数据文本，让我们试试:</p><p id="fccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nu nv nw nx b">this is a good test</code></p><p id="7ebd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里的过程非常简单，我们将创建一个新的列表，将所有已知单词替换为它们在输入中出现的次数，如下图所示:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ou"><img src="../Images/fe218ec0829cda34bfcf4b6a59c3bb13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X9G_P_LOwPD-ooNqigCtLA.png"/></div></div></figure><p id="340e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这类似于从文本到有形的数学值的转换，这要容易得多。让我们用<code class="fe nu nv nw nx b">good</code>这个词做个测试。</p><p id="da95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个词听起来很正面，对吧？但是我们的算法怎么能知道呢？</p><p id="0bc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这只是一个简单的数学问题，我们的模型会计算单词<code class="fe nu nv nw nx b">good</code>在一个肯定句中出现了多少次，然后用这个数字除以这个单词出现的次数。它会给这个词打正分。</p><p id="4fcd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个过程叫做<strong class="kf ir">矢量化</strong>。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ov"><img src="../Images/41edd525870f373624ff422264c2c441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYO1UGb6SqbrMzh7PkhDwg.png"/></div></div></figure><p id="cbca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要计算负分，您可以简单地使用1-正分。</p><p id="cb48" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两个分数计算出来后，<strong class="kf ir">朴素贝叶斯</strong>算法会用它们来计算句子分数。</p><p id="bcbc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种算法在没有任何上下文的情况下单独评估每个单词，这就是你的名字中包含naive的原因。</p><p id="a3b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，关于理论已经足够了，让我们回到代码上来！</p><h1 id="2310" class="lz ma iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">编码培训流程</h1><p id="ea3a" class="pw-post-body-paragraph kd ke iq kf b kg mx ki kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">我们不需要担心上面提到的所有细节，我们可以假设我们会收到一个能够将文本转换为数值的矢量器。</p><p id="553d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，让我们将我们的训练数据集分成两个不同的列表，一个用于句子，另一个用于结果。</p><p id="3695" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，让我们使用<code class="fe nu nv nw nx b">fit_transform</code>函数对句子进行矢量化，最后让我们返回一个<code class="fe nu nv nw nx b">BernoulliNB().fit</code>函数调用的结果。</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="fabe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nu nv nw nx b">BernoulliNB</code>(朴素贝叶斯的缩写)将生成我们的分类模型。现在我们可以使用该模型的<code class="fe nu nv nw nx b">predict</code>函数来尝试预测任何文本的情感，让我们尝试一个例子:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a664" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们在笔记本上看看它是如何工作的:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ow"><img src="../Images/61fc0ec695f2162058bb7ab18a95455b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MSVJep31-Gc_JrwjBn7xxw.png"/></div></div></figure><p id="3945" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们测试了“我爱这部电影！”一个肯定的句子和预测结果是' 1 '，我们已经看到它代表一个肯定，所以结果是正确预测的。</p><p id="d83f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它现在正在工作，但是让我们用两个不同的函数来改进结果的可视化:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="1f90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，可视化我们的测试容易多了:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ox"><img src="../Images/e2ccc6f81f7238fef3f00ab87ad0e350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5uCu-LtJtdpFjLH8D8YuIw.png"/></div></div></figure><p id="caf5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">酷，工作完成了，对吧？— <strong class="kf ir">错了</strong>！</p><p id="ffb5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要评估我们的模型表现如何。最直观的方法是计算正确答案的百分比，所以，让我们开始吧。</p><h1 id="72f0" class="lz ma iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">估价</h1><p id="0248" class="pw-post-body-paragraph kd ke iq kf b kg mx ki kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">是时候使用之前创建的评估数据集了。我们的第一次验证是将我们的预测答案与实际答案进行对比，计算正确的答案。</p><p id="5e34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我来解释一下，我们已经知道评估数据集中每一句话的正确答案，你还记得数据结构吗？一个句子和一个<code class="fe nu nv nw nx b">\t</code>拆分的分类结果。</p><p id="a60a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们将通过使用我们的模型迭代所有数据来预测每个句子的情感分析，然后，我们将比较模型预测结果和数据集中的实际结果。</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="65ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们来看看结果:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oy"><img src="../Images/0e40dc310ae55b5279826f6ce655026e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4d2nw-d2Aos_rtSFNaePRA.png"/></div></div></figure><p id="3b16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">82%看起来是一个不错的结果，但是我们如何获得更多关于我们模型的信息呢？</p><h2 id="5239" class="od ma iq bd mb oj ok dn mf ol om dp mj ko on oo mn ks op oq mr kw or os mv ot bi translated">混乱矩阵</h2><p id="5680" class="pw-post-body-paragraph kd ke iq kf b kg mx ki kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">幸运的是，有更多的技术可以获得关于预测模型的信息。我们将使用混淆矩阵。</p><p id="4a20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以自己生成这个矩阵，也可以在<code class="fe nu nv nw nx b">sklearn.metrics</code>使用函数生成这个矩阵。我们将使用lib实现，因为没有关于如何生成混淆矩阵的秘密，实际上相当容易。</p><p id="2526" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是在我们开始之前，我们需要了解混淆矩阵是什么？</p><p id="a805" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">混淆矩阵的概念非常简单，我们将在一个矩阵中存储一种预期结果和预测结果的组合。</p><p id="ca3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的特殊情况下，这个矩阵将包含四个不同的值:</p><ul class=""><li id="1741" class="nc nd iq kf b kg kh kk kl ko ne ks nf kw ng la oz ni nj nk bi translated">当实际结果是否定的时，否定的预测；</li><li id="0d8e" class="nc nd iq kf b kg nl kk nm ko nn ks no kw np la oz ni nj nk bi translated">当实际结果是正面的时候，负面的预测；</li><li id="23b9" class="nc nd iq kf b kg nl kk nm ko nn ks no kw np la oz ni nj nk bi translated">当实际结果为负时，预测为正；</li><li id="7383" class="nc nd iq kf b kg nl kk nm ko nn ks no kw np la oz ni nj nk bi translated">当实际结果是积极的时，积极的预测；</li></ul><p id="a755" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些值中的两个表示正确的预测，另外两个表示错误的预测。这个矩阵非常有用，因为在一些情况下，产生假阴性和产生假阳性没有什么大问题，反之亦然。</p><p id="fd23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，每次你可以假设一些诚实的错误，你需要检查你的模型什么时候犯错误。</p><p id="6a7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建混淆矩阵:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="b46b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以使用<code class="fe nu nv nw nx b">pandas</code>数据框来提高可视化:</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="5fee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这段代码生成了一个非常酷矩阵，如下图所示:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/58bf8d46c02585d99f4fe058fafb1fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*pgm5_On8kXvs3jIWG7KGFg.png"/></div></figure><p id="733d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是这还不够酷，我们可以使用著名的<code class="fe nu nv nw nx b">matplotlib.pyplot</code>库来创建一个更好的可视化效果。</p><figure class="lr ls lt lu gt jr"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="255f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这段代码并不重要，因为它与我们的解决方案没有直接关系，它只是一种可视化我们数据的方式，所以不用担心。</p><p id="3290" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看生成的可视化是什么样子的:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/a8a1b82c07d2419a35f566bbbeef53e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*i2h3OyKm_AQ3U8XjHggFug.png"/></div></figure><p id="f34d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，我们可以通过分别对行求和来得到阴性和阳性结果的总和。</p><p id="f48e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，否定句共有386个，否定共有364个，共计750个句子，是3000个总句子的25%。</p><p id="94c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这386个否定句子中，322个被正确分类，而64个(大约16.5%)被分类为肯定句子，产生了一些假肯定。另一方面，有293个正确分类的肯定句子和71个(大约24%)错误否定句子。</p><p id="0719" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您能够对重组和改进您模型做出正确的决定。</p></div></div>    
</body>
</html>
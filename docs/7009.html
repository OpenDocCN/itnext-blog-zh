<html>
<head>
<title>Git Submodules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Git子模块</h1>
<blockquote>原文：<a href="https://itnext.io/git-submodules-489f3d6222cd?source=collection_archive---------2-----------------------#2022-05-15">https://itnext.io/git-submodules-489f3d6222cd?source=collection_archive---------2-----------------------#2022-05-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e60f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在开发一个项目时，您通常希望在其中包含另一个项目。这种需求的一些常见情况如下:</p><ul class=""><li id="c397" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">包含格式样式指南或构建工具的共享存储库</li><li id="c19b" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">第三方库</li><li id="5e44" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">您要在当前项目中登记的回购</li></ul><p id="3b5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这些情况下，您可以使用git子模块。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/629a1406c4fb406fdbe904fd2617ab83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u6PMQ-BzTRwTU36MJeeIvw.png"/></div></div></figure><h1 id="104e" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">创建子模块</h1><p id="d174" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">要在git repo中创建子模块，您需要运行以下命令:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="c02b" class="mw lp it ms b gy mx my l mz na">git submodule add &lt;url&gt; &lt;directory&gt;</span></pre><p id="3931" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里的<code class="fe nb nc nd ms b">&lt;url&gt;</code>是另一个repo的URL的占位符，而<code class="fe nb nc nd ms b">&lt;directory&gt;</code>是您希望子模块所在的目录名。例如，以下命令从GitHub repo <code class="fe nb nc nd ms b">django-twitter-clone</code>创建一个子模块，并将其存储在目录<code class="fe nb nc nd ms b">django-twitter-clone</code>中:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="6f33" class="mw lp it ms b gy mx my l mz na">git submodule add git@github.com:aerabi/django-twitter-clone.git django-twitter-clone</span></pre><p id="0308" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">执行该命令后，在回购的根目录下会创建一个名为<code class="fe nb nc nd ms b">.gitattributes</code>的文件，内容如下:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="25f0" class="mw lp it ms b gy mx my l mz na">[submodule "django-twitter-clone"]<br/>   path = django-twitter-clone<br/>   url = git@github.com:aerabi/django-twitter-clone.git</span></pre><p id="4f50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于每个额外的子模块，该文件中会记录一个新条目。</p><h1 id="7d4b" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">克隆带有子模块的项目</h1><p id="66e9" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">让我们假设您想要克隆一个带有子模块的repo。在通常的git克隆之后，包含子模块的路径仍然是空的。要填充它，您需要另外运行以下命令:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="97fd" class="mw lp it ms b gy mx my l mz na">git submodule init<br/>git submodule update</span></pre><p id="12e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者一气呵成:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="671d" class="mw lp it ms b gy mx my l mz na">git submodule --init update</span></pre><h1 id="6730" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">有助于子模块</h1><p id="f598" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">子模块是它自己的git repo。主repo及其子模块上有不同的分支。</p><p id="a2bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们假设您的子模块存在于路径<code class="fe nb nc nd ms b">shared</code>下，您可以并且想要直接提交给它的主模块。要创建子模块，首先，转到该路径并更改分支:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="734c" class="mw lp it ms b gy mx my l mz na">cd shared<br/>git checkout master<br/>git pull</span></pre><p id="bf0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">进行更改并提交给子模块。然后推送到子模块的主分支:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="ccfa" class="mw lp it ms b gy mx my l mz na">git push origin master</span></pre><p id="14b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返回主机存储库，验证您对子模块所做的更改:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="2445" class="mw lp it ms b gy mx my l mz na">cd ..<br/>git diff --submodule</span></pre><p id="00b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Git应该向您显示自从您的分支上的上一个版本以来添加到子模块的提交列表。如果您满意，添加子模块并提交更改:</p><pre class="ld le lf lg gt mr ms mt mu aw mv bi"><span id="53f5" class="mw lp it ms b gy mx my l mz na">git add shared<br/>git commit -m "Update the submodule"</span></pre><p id="f5ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总之，这就是我们在这里所做的:</p><ul class=""><li id="1fd2" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">对“其他”回购进行一些更改</li><li id="7991" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">将更改推送到主服务器</li><li id="e00d" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">移动“子模块指针”,指向主repo上最新版本的主模块</li><li id="2951" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">在主repo中提交新的指针值</li></ul><p id="b65f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些动作中的每一个都可以独立完成。</p><ul class=""><li id="f20c" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">人们可以独立地克隆“其他”回购协议，并对其进行一些修改。</li><li id="64b6" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">人们可以通过接受和合并拉取请求来改变“其他”回购协议的主协议。</li><li id="f3ad" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">一个人只能通过改变子模块上的分支并提取最新的改变来更新已经被其他人贡献的子模块。</li></ul><h1 id="1f4a" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">摘要</h1><p id="64aa" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">处理git子模块并不简单。人们可能需要几年才能适应子模块。这是许多人不愿意使用它们并寻找替代品的主要原因。我会说，它们非常有用和强大，只是对不接触它们的人来说，一些指导和教育可能是必要的。</p><p id="2183" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还有更多的子模块。稍后我会做一篇相同主题的后续文章。</p><ul class=""><li id="7d82" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated"><a class="ae ne" href="https://medium.com/subscribe/@aerabi" rel="noopener">订阅</a>my Medium publishes，以便在新的Git周刊发布时获得通知。</li><li id="6a43" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">关注Twitter 上的<a class="ae ne" href="https://twitter.com/MohammadAliEN" rel="noopener ugc nofollow" target="_blank">我，获取git上的每周文章和每日推文。</a></li></ul></div></div>    
</body>
</html>
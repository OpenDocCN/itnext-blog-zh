<html>
<head>
<title>How I generated 1000 random faces for my game in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用Python为我的游戏生成1000个随机面孔</h1>
<blockquote>原文：<a href="https://itnext.io/how-i-generated-1000-random-faces-for-my-game-in-python-83340079013f?source=collection_archive---------1-----------------------#2019-10-06">https://itnext.io/how-i-generated-1000-random-faces-for-my-game-in-python-83340079013f?source=collection_archive---------1-----------------------#2019-10-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4076" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我的游戏开发过程中，我意识到我需要一个有人脸头像的对话系统。</p><p id="a726" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此我决定基于一个著名的游戏<em class="ko">论文创建一个人脸生成器。</em></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/4ed3a10564af3da6eaa996cac4dc7436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*jLDoY19mpTHAWoHD.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://forums.tigsource.com/index.php?topic=29750.20" rel="noopener ugc nofollow" target="_blank">杜科普的</a>人脸生成器(请转自论文)</figcaption></figure><h1 id="97d8" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">数据采集</h1><p id="f53a" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我从pixabay.com下载了大约50幅肖像(所有图片都是CC许可的，不需要注明出处)。</p><p id="05a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我在Photoshop中剪切每个图像的背景(只是一个多边形选择工具和Delete键)。我计划稍后使用<em class="ko">剪切</em>效果来隐藏任何瑕疵。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/df301e814a00a8798525e1a654ae5656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*JeI9eP6upNk-1uQ3Z62Tvw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">背景已移除的图像</figcaption></figure><h2 id="06ee" class="mg ld it bd le mh mi dn li mj mk dp lm kb ml mm lq kf mn mo lu kj mp mq ly mr bi translated">人脸分割</h2><p id="86c6" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我用图层来分割脸部。我只是简单地刷上“鼻子和嘴”，然后是“眼睛和眉毛”部分，然后为它创建一个新的PS层。我通过选择可见像素(<em class="ko">Ctrl+图层缩略图点击</em>)并从选择的图层中新建一个图层。任何头发，眼镜或其他面部覆盖进入一个名为“头发_重叠”的层。我标记了所有50张图片的片段。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/e13f869386e399fb0d7b03c793b32bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*btI_lyJVMG0TptjobWiHeg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">层工作流</figcaption></figure><p id="5ee7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还必须为新粘贴的特征准备面部——我使用<em class="ko">克隆图章工具</em>，克隆皮肤并涂抹所有面部特征(新图层<em class="ko">涂抹</em>)。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/6971d24a1ea534f928135c5e3af85278.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/1*fNBf6O8D_eefVje51HBBNw.gif"/></div></figure><h2 id="2226" class="mg ld it bd le mh mi dn li mj mk dp lm kb ml mm lq kf mn mo lu kj mp mq ly mr bi translated">特征抽出</h2><p id="bbae" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我下载的一些肖像照片不适合整体使用，所以我只提取了我可以用于生成器的特征(即只有鼻子和嘴唇)。</p><p id="ae8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将使用<em class="ko"> psd_tools </em>和<em class="ko"> Pillow </em> Python库提取特性(安装那些使用<em class="ko">pip install PSD-tools Pillow</em>或让您的IDE处理它的特性)。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b6ba6c2627bdd9cbbcdd8398b4a72ebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*egcQm7I7IphQ7rbYB_QN0g.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">这个代码片段应该列出所有的层和它们的边界框..</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/f36cf04248682d6446880e806d68035a.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*5U5yS6sDY_QTl5G7JUcH2g.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">..确实如此。</figcaption></figure><p id="d570" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我想将所有的图层导出到单独的图像文件中。我还为每个层名称创建了一个文件夹(下面的代码片段生成了多个文件夹和文件，即<em class="ko">eyes/girl-919048 _ 1920 . PSD . png</em>)。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi na"><img src="../Images/42d9574f9581230367a0e989d5f0a241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kj_O-YwsI1LL6tlbQ9E80Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">将图层提取到图像文件</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nb"><img src="../Images/c1ba11c844498dc22b6c419803ef5442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*unNuft_8pIGtf0Ay3OD8hg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">提取的“眼睛”层</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nc"><img src="../Images/335fe3194fdd8787a34a96569eb5496c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1xb3aWSmVyOVYRU6jc5qw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">“鼻子_嘴”层</figcaption></figure><h1 id="4b06" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">面孔生成器</h1><p id="3fcc" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">现在我只需要把它们放在一起，枕头图片会有所帮助。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nd"><img src="../Images/fe6a280079eed903058bddfcf7f67414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iE8iqoIXODHBn5KTfnwHHA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">层层叠叠</figcaption></figure><p id="f16b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">生成的图像有点难看，所以现在是时候尝试用剪切过滤器隐藏不完美之处了。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/48b261440bab5fcc5e0cf976fbf2fbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*DP7Kw_XMOWqbacNgPc_SnA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">生成的图像</figcaption></figure><p id="cfbc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">断流</em>滤波器很好地“隐藏”了故障。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nf"><img src="../Images/61a0a673d9851200e7d657064651b337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KiiZLTw37dP1_SV4TM9Ujw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">动作中的剪切效果</figcaption></figure><p id="1a88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不幸的是，如果不使用Sobel过滤器、中值过滤器和抖动，就无法在Python中创建这种效果，这将非常耗时。我发现了一个GIMP插件<a class="ae lb" href="http://gimpchat.com/viewtopic.php?p=137912" rel="noopener ugc nofollow" target="_blank"><em class="ko">FU _ artist _ cutout . SCM</em></a><em class="ko"/>做同样的事情，但这也不是正确的方法。我将使用G'MIC库，它也有一个<a class="ae lb" href="https://gmicol.greyc.fr/" rel="noopener ugc nofollow" target="_blank">在线UI </a>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ng"><img src="../Images/9a5fae22d015735f69c95ec56a531623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dunfivhLQyNEE1jUr5MpLw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">G'MIC在线实用程序</figcaption></figure><p id="b2a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事实证明，gmic只能使用脚本，它没有用于<em class="ko">剪切</em>效果的命令行参数。我在文件<em class="ko"> gmic_stdlib.gmic: </em>中找到了<em class="ko">剪切</em>效果的定义</p><pre class="kq kr ks kt gt nh ni nj nk aw nl bi"><span id="f2c5" class="mg ld it ni b gy nm nn l no np">fx_cutout :<br/>-repeat $! -l[$&gt;] -split_opacity -l[0]<br/>-<strong class="ni iu">median</strong> {10-$3}<br/>-<strong class="ni iu">quantize</strong> $1<br/>--area. 0,1 med=${-med} -rm.<br/>-inpaint_holes {$med*$2%},0,1<br/>-if $4 -n 0,255 -endif-endl -a c -endl -done</span></pre><p id="24e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我可以为g'mic创建自己的剪切滤波器:</p><pre class="kq kr ks kt gt nh ni nj nk aw nl bi"><span id="3b2d" class="mg ld it ni b gy nm nn l no np"># File `myCutout.gmic`<br/>cutout : <br/>  -echo "Arguments : $1,$2"<br/>  -input $1<br/>    -repeat $! -l[$&gt;] -split_opacity -l[0] <br/>    -median <strong class="ni iu">6</strong><br/>    -quantize <strong class="ni iu">20</strong> <br/>    --area. 0,1 med=${-med} -rm. <br/>    -inpaint_holes {$med*<strong class="ni iu">0</strong>%},0,1 <br/>  -endl -a c -endl -done -output $2</span></pre><p id="0951" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了这个和命令行工具，我就准备好了。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nq"><img src="../Images/1b7bb4fb8bbaec5f49eccacee4db3ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1SCpFMnrl6JKTs9GRtb_A.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">G'MIC在行动</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nr"><img src="../Images/222d7e290dd023d7bb5af2e48d9bf00a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlK0kHNsyGtFqJMIoueJLw.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">随机脸。头发覆盖工作，膨胀。</figcaption></figure><p id="1728" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我只需将它插入到<em class="ko">子进程</em>中，让它运行一段时间来生成我想要的任意多的随机面。完成了。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/8b8df4d48734f10b9b9217774c7af552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*_gn11fqjbouFw1NSkOR5eA.png"/></div></figure><p id="8340" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码和一些。我的github上有psd测试文件。</p><div class="nt nu gp gr nv nw"><a href="https://github.com/janjilecek/faceGenerator" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">janjilecek/faceGenerator</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div></div></a></div></div></div>    
</body>
</html>
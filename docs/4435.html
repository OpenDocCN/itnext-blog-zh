<html>
<head>
<title>GitHub: Use Actions to Run Multiple Jobs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitHub:使用动作运行多个作业</h1>
<blockquote>原文：<a href="https://itnext.io/github-use-actions-to-run-multiple-jobs-d85914ae5b27?source=collection_archive---------6-----------------------#2020-06-29">https://itnext.io/github-use-actions-to-run-multiple-jobs-d85914ae5b27?source=collection_archive---------6-----------------------#2020-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7145" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们将采用构建两个split核心web应用程序的示例工作流，并将其拆分，这样每个web应用程序都是单独构建的。如果你需要赶上进度，这篇文章使用了以下文章中的回购和工作流程。</p><p id="65b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://elanderson.net/2020/06/github-import-an-azure-devops-repo/" rel="noopener ugc nofollow" target="_blank"> GitHub:导入一个Azure devo PS Repo</a><br/><a class="ae kl" href="https://elanderson.net/2020/06/github-use-actions-to-build-asp-net-core-application/" rel="noopener ugc nofollow" target="_blank">GitHub:使用动作构建ASP.NET核心应用</a> <br/> <a class="ae kl" href="https://elanderson.net/2020/06/github-use-actions-to-publish-artifacts/" rel="noopener ugc nofollow" target="_blank"> GitHub:使用动作发布工件</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/dc3a5367282686dfa6a19b88d0932359.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*2YUjmHzol8WefkXu.png"/></div></figure><h2 id="8686" class="ku kv iq bd kw kx ky dn kz la lb dp lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated">起点和计划</h2><p id="112c" class="pw-post-body-paragraph jn jo iq jp b jq ln js jt ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ij bi translated">我们的工作流目前包含一个作业，这个作业恰好构建了两个ASP.NET核心web应用程序。NET CLI选择并构建这两个应用程序。以下是我们当前工作流程的YAML。</p><pre class="kn ko kp kq gt ls lt lu lv aw lw bi"><span id="3e2e" class="ku kv iq lt b gy lx ly l lz ma">name: .NET Core<br/><br/>on:<br/>  push:<br/>    branches: [ master ]<br/>  pull_request:<br/>    branches: [ master ]<br/><br/>jobs:<br/>  build:<br/><br/>    runs-on: ubuntu-latest<br/><br/>    steps:<br/>    - uses: actions/checkout@v2<br/>      <br/>    - name: Setup .NET Core<br/>      uses: actions/setup-dotnet@v1<br/>      with:<br/>        dotnet-version: 3.1.101<br/> <br/>    - name: Install dependencies<br/>      run: dotnet restore<br/>      <br/>    - name: Build<br/>      run: dotnet build --configuration Release --no-restore<br/>      <br/>    - name: Test<br/>      run: dotnet test --no-restore --verbosity normal<br/><br/>    - name: Publish<br/>      run: dotnet publish <br/>    <br/>    - name: Upload WebApp1 Build Artifact<br/>      uses: actions/upload-artifact@v2<br/>      with:<br/>        name: WebApp1<br/>        path: /home/runner/work/Playground/Playground/src/WebApp1/bin/Debug/netcoreapp3.1/publish/<br/>        <br/>    - name: Upload WebApp2 Build Artifact<br/>      uses: actions/upload-artifact@v2<br/>      with:<br/>        name: WebApp2<br/>        path: /home/runner/work/Playground/Playground/src/WebApp2/bin/Debug/netcoreapp3.1/publish/</span></pre><p id="4bcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章将采用这个工作流，将两个web应用程序的构建和发布分成两个任务。通过将工作流分割成多个作业，我们打开了作业并行运行的可能性。这样做的一个原因是，如果您的构建部分是独立的，那么可以加快整个工作流的运行时间。为什么需要多个作业的另一个例子是，如果不同的作业需要在不同的操作系统上运行，例如一个需要运行Windows，另一个需要运行Linux。</p><h2 id="69b7" class="ku kv iq bd kw kx ky dn kz la lb dp lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated">创造就业机会</h2><p id="d4f9" class="pw-post-body-paragraph jn jo iq jp b jq ln js jt ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ij bi translated">下面是构建第一个web应用程序的工作流程。第一个变化是从<strong class="jp ir"> build </strong>到<strong class="jp ir"> build_web_app1 </strong>的ID，因为每个作业必须有一个唯一的ID。其余大部分突出显示的更改都与。现在针对特定项目的. NET CLI命令。还要注意，我们从硬编码路径改为使用表达式来获取工作空间路径，该路径是<strong class="jp ir"> ${{ github.workspace }} </strong>位，而不是<strong class="jp ir">/home/runner/work/Playground/Playground/</strong>。更多信息见<a class="ae kl" href="https://help.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions" rel="noopener ugc nofollow" target="_blank">表达式语法文档</a>。</p><pre class="kn ko kp kq gt ls lt lu lv aw lw bi"><span id="f2db" class="ku kv iq lt b gy lx ly l lz ma">name: .NET Core<br/><br/>on:<br/>  push:<br/>    branches: [ master ]<br/>  pull_request:<br/>    branches: [ master ]<br/><br/>jobs:<br/>  build_web_app1:<br/><br/>    name: Build WebApp1<br/>    runs-on: ubuntu-latest<br/><br/>    steps:<br/>    - uses: actions/checkout@v2<br/>      <br/>    - name: Setup .NET Core<br/>      uses: actions/setup-dotnet@v1<br/>      with:<br/>        dotnet-version: 3.1.101<br/> <br/>    - name: Install dependencies<br/>      run: dotnet restore ${{ github.workspace }}/src/WebApp1/WebApp1.csproj<br/>      <br/>    - name: Build<br/>      run: dotnet build ${{ github.workspace }}/src/WebApp1/WebApp1.csproj --configuration Release --no-restore<br/>      <br/>    - name: Test<br/>      run: dotnet test ${{ github.workspace }}/src/WebApp1/WebApp1.csproj --no-restore --verbosity normal<br/><br/>    - name: Publish<br/>      run: dotnet publish ${{ github.workspace }}/src/WebApp1/WebApp1.csproj<br/>    <br/>    - name: Upload Build Artifact<br/>      uses: actions/upload-artifact@v2<br/>      with:<br/>        name: WebApp1<br/>        path: ${{ github.workspace }}/src/WebApp1/bin/Debug/netcoreapp3.1/publish/</span></pre><p id="0a48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是定义了两个作业的完整文件。正如您所看到的，第二个作业与第一个作业基本相同，只是ID、名称和项目不同。</p><pre class="kn ko kp kq gt ls lt lu lv aw lw bi"><span id="04a3" class="ku kv iq lt b gy lx ly l lz ma">name: .NET Core<br/><br/>on:<br/>  push:<br/>    branches: [ master ]<br/>  pull_request:<br/>    branches: [ master ]<br/><br/>jobs:<br/>  build_web_app1:<br/><br/>    name: Build WebApp1<br/>    runs-on: ubuntu-latest<br/><br/>    steps:<br/>    - uses: actions/checkout@v2<br/>      <br/>    - name: Setup .NET Core<br/>      uses: actions/setup-dotnet@v1<br/>      with:<br/>        dotnet-version: 3.1.101<br/> <br/>    - name: Install dependencies<br/>      run: dotnet restore ${{ github.workspace }}/src/WebApp1/WebApp1.csproj<br/>      <br/>    - name: Build<br/>      run: dotnet build ${{ github.workspace }}/src/WebApp1/WebApp1.csproj --configuration Release --no-restore<br/>      <br/>    - name: Test<br/>      run: dotnet test ${{ github.workspace }}/src/WebApp1/WebApp1.csproj --no-restore --verbosity normal<br/><br/>    - name: Publish<br/>      run: dotnet publish ${{ github.workspace }}/src/WebApp1/WebApp1.csproj<br/>    <br/>    - name: Upload Build Artifact<br/>      uses: actions/upload-artifact@v2<br/>      with:<br/>        name: WebApp1<br/>        path: ${{ github.workspace }}/src/WebApp1/bin/Debug/netcoreapp3.1/publish/<br/>        <br/>  build_web_app2:<br/><br/>    name: Build WebApp2<br/>    runs-on: ubuntu-latest<br/><br/>    steps:<br/>    - uses: actions/checkout@v2<br/>      <br/>    - name: Setup .NET Core<br/>      uses: actions/setup-dotnet@v1<br/>      with:<br/>        dotnet-version: 3.1.101<br/> <br/>    - name: Install dependencies<br/>      run: dotnet restore ${{ github.workspace }}/src/WebApp2/WebApp2.csproj<br/>      <br/>    - name: Build<br/>      run: dotnet build ${{ github.workspace }}/src/WebApp2/WebApp2.csproj --configuration Release --no-restore<br/>      <br/>    - name: Test<br/>      run: dotnet test ${{ github.workspace }}/src/WebApp2/WebApp2.csproj --no-restore --verbosity normal<br/><br/>    - name: Publish<br/>      run: dotnet publish ${{ github.workspace }}/src/WebApp2/WebApp2.csproj<br/>       <br/>    - name: Upload Build Artifact<br/>      uses: actions/upload-artifact@v2<br/>      with:<br/>        name: WebApp2<br/>        path: ${{ github.workspace }}/src/WebApp2/bin/Debug/netcoreapp3.1/publish/</span></pre><p id="1586" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成所有编辑后，提交对repo的更改以运行工作流。从工作流运行的结果中，您将看到它现在有两个作业，并且我们仍然像以前一样为两个应用程序获得工件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/45e5459219dd0f7325626e395fa16cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H_-aGgN7-MxMd6ND.png"/></div></div></figure><h2 id="b853" class="ku kv iq bd kw kx ky dn kz la lb dp lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated">包扎</h2><p id="7b28" class="pw-post-body-paragraph jn jo iq jp b jq ln js jt ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ij bi translated">如果您的应用程序需要，将它们分成不同的任务不仅对工作流运行时有帮助，而且还能帮助您推理构建过程的每个部分正在做什么。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="0e99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mn">原载于</em><a class="ae kl" href="https://elanderson.net/2020/06/github-use-actions-to-run-multiple-jobs/" rel="noopener ugc nofollow" target="_blank"><em class="mn"/></a><em class="mn">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Jenkins pipelines using Cucumber and multi-branch pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">詹金斯管道使用黄瓜和多分支管道</h1>
<blockquote>原文：<a href="https://itnext.io/jenkins-pipelines-889420409510?source=collection_archive---------0-----------------------#2018-02-06">https://itnext.io/jenkins-pipelines-889420409510?source=collection_archive---------0-----------------------#2018-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="20a8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本文档的目的是提供一个关于如何开始使用管道和多分支管道的简要指南。</h2></div><p id="73a7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fjenkins-pipelines-889420409510" rel="noopener ugc nofollow" target="_blank"> <em class="lc">点击这里在LinkedIn </em>上分享这篇文章</a></p><h1 id="c91e" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">要求:</h1><p id="c6b6" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">本文档中使用的版本是Jenkins 2.89.2(。war)用Java 8。</p><p id="562e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">【https://jenkins.io/doc/pipeline/tour/getting-started/ T4】</p><p id="c27b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用的插件(要安装:管理Jenkins →管理插件→可用):</p><p id="563b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">管道:声明性—</strong><a class="ae lb" href="https://plugins.jenkins.io/pipeline-model-definition" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">https://plugins.jenkins.io/pipeline-model-definition</strong></a></p><p id="8522" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">蓝海—</strong><a class="ae lb" href="https://plugins.jenkins.io/blueocean" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">https://plugins.jenkins.io/blueocean</strong></a></p><p id="04ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">黄瓜报道—</strong><a class="ae lb" href="https://plugins.jenkins.io/cucumber-reports" rel="noopener ugc nofollow" target="_blank">【https://plugins.jenkins.io/cucumber-reports】T21</a></p><h1 id="156c" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">詹金斯管道公司:</h1><p id="6bc8" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">如果您以前没有使用过Jenkins Pipelines，我推荐您阅读文档(<a class="ae lb" href="https://jenkins.io/doc/book/pipeline/" rel="noopener ugc nofollow" target="_blank">https://jenkins.io/doc/book/pipeline/</a>)。它包括对该技术的完整描述和介绍，以及使用它的好处。</p><h1 id="6846" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">Jenkins管道入门:</h1><p id="a911" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">使用的Jenkinsfile如下:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="6f44" class="mj le iq mf b gy mk ml l mm mn">pipeline {<br/>    agent any<br/>    stages {</span><span id="1420" class="mj le iq mf b gy mo ml l mm mn">stage('testing pipeline'){<br/>          steps{<br/>      echo 'test1'<br/>                sh 'mkdir from-jenkins'<br/>                sh 'touch from-jenkins/test.txt'<br/>                }<br/>        }</span><span id="e3b8" class="mj le iq mf b gy mo ml l mm mn">}<br/>}</span></pre><p id="4a23" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代号:<a class="ae lb" href="https://github.com/mluyo3414/jenkins-test" rel="noopener ugc nofollow" target="_blank">https://github.com/mluyo3414/jenkins-test</a></p><ol class=""><li id="9a63" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated">点击新项目</li></ol><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1e46a9f1d0c0c0040821ad09ffabddfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*aq9j02CH41GpybYlytoWTw.png"/></div></figure><p id="269a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.命名项目，选择“管道”,然后单击“确定”</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/94f00e635f8831c388b24e3633dbbc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*vy8QfmkqdqNNdZRdR5cNmA.png"/></div></figure><p id="c250" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.创建项目后，将显示配置页面。在“管道”部分，我们可以决定从SCM获取Jenkinsfile，或者在Jenkins中创建管道脚本。建议将Jenkinsfile放在SCM中，这样它就可以移植和维护。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/60e59ee0cd3c41e716b256e974e86574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*8ifnla8YgePN65yjmluiJQ.png"/></div></figure><p id="448c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择的SCM是带有简单用户和通行证凭证的Git(也可以使用SSH)。默认情况下，Jenkins将在该存储库中查找Jenkinsfile，除非在“脚本路径”目录中另有指定。</p><p id="0855" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.保存作业后，返回作业页面，选择“立即构建”。Jenkins将触发作业，其中第一步是从SCM下拉Jenkinsfile。它将报告从上次运行以来的任何更改并执行它。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/b862c8567a81c822232beaffbcda5f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WUCOF2_l4CJfZoZ8GAWG4w.png"/></div></div></figure><p id="caa6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">单击舞台会提供控制台信息:</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/91cfe25dd021d3f3ed0034ab530d822d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRhA-woUUJgNz_dSA0u4cA.png"/></div></div></figure><p id="7e8b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Ocean Blue为pipelines提供了更好的用户界面，可以从作业的主页访问(见上图)。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/27b0a01d8c2e8b6ffb2c25c56c74a9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BOROec7F453cw4D-emZYQ.png"/></div></div></figure><p id="e979" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个简单的管道有一个包含三个步骤的阶段(除了默认阶段:提取jenkinsFile的Checkout SCM)。第一步回显一条消息，第二步将在jenkins工作区中创建一个名为from-jenkins的目录，第三步在创建的目录中创建一个文件test.txt。jenkins工作空间的路径是$user/。Jenkins/执行作业的机器中的工作区(在本例中，作业在任何可用的节点中执行。如果没有连接其他节点，则在安装了Jenkins的机器上执行—选中管理Jenkins -&gt;管理节点)。</p><p id="d6f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一种创建管道的方法是使用Ocean Blue的插件</p><ol class=""><li id="6142" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated">点击打开蓝色海洋</li></ol><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/91a9b19199494c2b1e79b92649410794.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*YwS3W0mHVz4ZDCMPej7HVA.png"/></div></figure><p id="1bbb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.单击新建管道</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/de9caf14199a180de70671a7af903b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*18MoSyHBDjovDd8vqL9K1w.png"/></div></figure><p id="6479" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.选择SCM和存储库URL，将提供一个SSH密钥。这需要添加到您的Git SSH密钥(在设置→SSH和GPG密钥)。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/f7840eab47aaac0bbd40aaf1db211db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*bBk5Srcoy4ZZvh8k7HEEAg.png"/></div></figure><p id="c5c2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.Jenkins将自动检测分支和Jenkinsfile(如果存在)。它还会触发作业。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/4a41db865fdcbbd6951cfbd47cff045d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U0LZpAUbRjyYROCklXdFwQ.png"/></div></div></figure><p id="3741" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">管道开发</strong>:</p><p id="c194" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的Jenkinsfile从Github仓库触发cucumber测试，创建并归档一个jar，发送电子邮件，并展示使用变量、并行阶段等执行作业的不同方式。演示中使用的java项目从https://github.com/cucumber/cucumber-jvm的<a class="ae lb" href="https://github.com/cucumber/cucumber-jvm" rel="noopener ugc nofollow" target="_blank">转移到https://github.com/mluyo3414/cucumber-jvm的</a><a class="ae lb" href="https://github.com/mluyo3414/cucumber-jvm" rel="noopener ugc nofollow" target="_blank"/>。Jenkinsfile的位置是<a class="ae lb" href="https://github.com/mluyo3414/cucumber-jvm/blob/master/examples/java-calculator/Jenkinsfile" rel="noopener ugc nofollow" target="_blank">https://github . com/mluyo 3414/cucumber-JVM/blob/master/examples/Java-calculator/Jenkins file</a>。由于Jenkinsfile不在存储库的顶层目录中，因此必须将配置更改为另一个路径:</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/a3ca195005d064d987869c9832cec1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*-YMxdR7_xmj5PFiNOgUQ6A.png"/></div></figure><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="fe09" class="mj le iq mf b gy mk ml l mm mn">pipeline {<br/>    // 1. runs in any agent, otherwise specify a slave node<br/>    agent any<br/>    parameters {</span><span id="af4b" class="mj le iq mf b gy mo ml l mm mn">// 2.variables for the parametrized execution of the test: Text and options<br/>        choice(choices: 'yes\nno', description: 'Are you sure you want to execute this test?', name: 'run_test_only')<br/>        choice(choices: 'yes\nno', description: 'Archived war?', name: 'archive_war')<br/>        string(defaultValue: "<a class="ae lb" href="mailto:your.email@gmail.com" rel="noopener ugc nofollow" target="_blank">your.email@gmail.com</a>", description: 'email for notifications', name: 'notification_email')<br/>    }</span><span id="4293" class="mj le iq mf b gy mo ml l mm mn">//3. Environment variables</span><span id="14a0" class="mj le iq mf b gy mo ml l mm mn">environment {</span><span id="58e4" class="mj le iq mf b gy mo ml l mm mn">firstEnvVar= 'FIRST_VAR'</span><span id="451c" class="mj le iq mf b gy mo ml l mm mn">secondEnvVar= 'SECOND_VAR'</span><span id="48c9" class="mj le iq mf b gy mo ml l mm mn">thirdEnvVar= 'THIRD_VAR'</span><span id="af05" class="mj le iq mf b gy mo ml l mm mn">}</span><span id="de74" class="mj le iq mf b gy mo ml l mm mn">//4. Stages<br/>    stages {<br/>        stage('Test'){<br/>             //conditional for parameter<br/>            when {<br/>                environment name: 'run_test_only', value: 'yes'<br/>            }<br/>            steps{<br/>                sh 'cd examples/java-calculator &amp;&amp; mvn clean integration-test'<br/>            }<br/>        }</span><span id="6fee" class="mj le iq mf b gy mo ml l mm mn">//5. demo parallel stage with script<br/>        stage ('Run demo parallel stages') {</span><span id="b46f" class="mj le iq mf b gy mo ml l mm mn">steps {<br/>        parallel(<br/>        "Parallel stage #1":<br/>                  {<br/>                  //running a script instead of DSL. In this case to run an if/else<br/>                  script{<br/>                    if (env.run_test_only =='yes')<br/>                        {<br/>                        echo env.firstEnvVar<br/>                        }<br/>                    else<br/>                        {<br/>                        echo env.secondEnvVar<br/>                        }<br/>                  }<br/>         },<br/>        "Parallel stage #2":{<br/>                echo "${thirdEnvVar}"<br/>                }<br/>                )<br/>             }<br/>        }<br/>    }</span><span id="f614" class="mj le iq mf b gy mo ml l mm mn">//6. post actions for success or failure of job. Commented out in the following code: Example on how to add a node where a stage is specifically executed. Also, PublishHTML is also a good plugin to expose Cucumber reports but we are using a plugin using Json.<br/>    <br/>post {<br/>        success {<br/>        //node('node1'){</span><span id="4c70" class="mj le iq mf b gy mo ml l mm mn">echo "Test succeeded"<br/>            script {<br/>    // configured from using gmail smtp Manage Jenkins-&gt; Configure System -&gt; Email Notification<br/>    // SMTP server: smtp.gmail.com<br/>    // Advanced: Gmail user and pass, use SSL and SMTP Port 465<br/>    // Capitalized variables are Jenkins variables – see <a class="ae lb" href="https://wiki.jenkins.io/display/JENKINS/Building+a+software+project" rel="noopener ugc nofollow" target="_blank">https://wiki.jenkins.io/display/JENKINS/Building+a+software+project</a><br/>                mail(bcc: '',<br/>                     body: "Run ${JOB_NAME}-#${BUILD_NUMBER} succeeded. To get more details, visit the build results page: ${BUILD_URL}.",<br/>                     cc: '',<br/>                     from: '<a class="ae lb" href="mailto:jenkins-admin@gmail.com" rel="noopener ugc nofollow" target="_blank">jenkins-admin@gmail.com</a>',<br/>                     replyTo: '',<br/>                     subject: "${JOB_NAME} ${BUILD_NUMBER} succeeded",<br/>                     to: env.notification_email)<br/>                     if (env.archive_war =='yes')<br/>                     {<br/>             // ArchiveArtifact plugin<br/>                        archiveArtifacts '**/java-calculator-*-SNAPSHOT.jar'<br/>                      }<br/>                       // Cucumber report plugin<br/>                      cucumber fileIncludePattern: '**/java-calculator/target/cucumber-report.json', sortingMethod: 'ALPHABETICAL'<br/>            //publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: true, reportDir: '/home/reports', reportFiles: 'reports.html', reportName: 'Performance Test Report', reportTitles: ''])<br/>            }<br/>        //}<br/>        }<br/>        failure {<br/>            echo "Test failed"<br/>            mail(bcc: '',<br/>                body: "Run ${JOB_NAME}-#${BUILD_NUMBER} succeeded. To get more details, visit the build results page: ${BUILD_URL}.",<br/>                 cc: '',<br/>                 from: '<a class="ae lb" href="mailto:jenkins-admin@gmail.com" rel="noopener ugc nofollow" target="_blank">jenkins-admin@gmail.com</a>',<br/>                 replyTo: '',<br/>                 subject: "${JOB_NAME} ${BUILD_NUMBER} failed",<br/>                 to: env.notification_email)<br/>                 cucumber fileIncludePattern: '**/java-calculator/target/cucumber-report.json', sortingMethod: 'ALPHABETICAL'</span><span id="362c" class="mj le iq mf b gy mo ml l mm mn">//publishHTML([allowMissing: true, alwaysLinkToLastBuild: false, keepAll: true, reportDir: '/home/tester/reports', reportFiles: 'reports.html', reportName: 'Performance Test Report', reportTitles: ''])<br/>        }<br/>    }</span><span id="0b01" class="mj le iq mf b gy mo ml l mm mn">}</span></pre><ul class=""><li id="6988" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la nn mv mw mx bi translated">总是检查“管道语法”以了解如何使用Jenkinsfile中的不同插件。</li></ul><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/7765ff92c0d47a8bbee906248fa5e5bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FKfv6veNlyQ8g684B1yLtA.png"/></div></div></figure><h2 id="588a" class="mj le iq bd lf no np dn lj nq nr dp ln ko ns nt lp ks nu nv lr kw nw nx lt ny bi translated">发送的电子邮件:</h2><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nz"><img src="../Images/4e23d9fa6e979fd31d5a1ef5f7afcb48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6sXTwYZPwqy3Vou9ACtjA.png"/></div></div></figure><h2 id="4cf7" class="mj le iq bd lf no np dn lj nq nr dp ln ko ns nt lp ks nu nv lr kw nw nx lt ny bi translated">存档的jar:</h2><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oa"><img src="../Images/c5c0f8b9a113072dac7cf45a0cee6089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OTpXsbrgX_X7iiaxnQBDsQ.png"/></div></div></figure><h2 id="8ff2" class="mj le iq bd lf no np dn lj nq nr dp ln ko ns nt lp ks nu nv lr kw nw nx lt ny bi translated">此外，在同一页面中，您还可以访问“黄瓜报告”:</h2><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/63582c11bc2fd6612d9426ea196c8575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*59cbbRsnv5sajlD07BEV8g.png"/></div></div></figure><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7cc88ae7498fe24ec86f471cfb8493ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*qi7GPb_71ENIlyY4lKtQOA.png"/></div></figure><h1 id="dc01" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">关于如何创建多分支管道的说明</h1><p id="dde3" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated"><a class="ae lb" href="https://jenkins.io/doc/book/pipeline/multibranch/#creating-a-multibranch-pipeline" rel="noopener ugc nofollow" target="_blank">https://Jenkins . io/doc/book/pipeline/multi branch/# creating-a-multi branch-pipeline</a></p><p id="11b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">前面的链接使用git，并假设已经配置了凭证。如果项目已经有了一个Jenkinsfile(就像我们在前面的例子中所做的那样)，那么遵循前面的方法也更容易。</p><p id="0091" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果这是您第一次创建管道，您可以使用Ocean Blue执行以下步骤。</p><ol class=""><li id="47b4" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated">开放的海洋蓝</li></ol><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0cedea33b083d4a8ec6d36fcdbc5b07a.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*jximYCVydwrXiySTq-FgQg.png"/></div></figure><p id="c464" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.选择“新管道”</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi od"><img src="../Images/e4007ae12c7854d90daa0c2541328385.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*KNJ8O5yq55BP_VVxkVltGw.png"/></div></figure><p id="fa75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.选择“git”并插入Git存储库地址。这是一个目前没有Jenkinsfile的存储库。将生成一个ssh密钥，然后在下一步中必须使用它</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9d15e4a934cf6567ca42b53e003f70d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*AYr5hCTGwE4fzS-38cfiSw.png"/></div></figure><p id="9622" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.去Github。点击右上角的个人资料头像，选择“设置”。然后从左侧菜单中选择“SSH ang GPG密钥”并插入Jenkins提供的SSH密钥。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nz"><img src="../Images/eaf339ab4f805e27ce8197494815ea11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bFUrVfcEgYLsMcRV-JvY1w.png"/></div></div></figure><p id="1084" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.回到Jenkins，点击“创建管道”。如果项目不包含Jenkinsfile，那么Jenkins会提示您创建一个新的。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi of"><img src="../Images/bbf56b3dd12ee287a19f3af2abe12f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*8IT611b37imMsI8kAlIkKg.png"/></div></figure><p id="84cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.单击“创建管道”后，交互式管道图将提示您通过单击“+”添加阶段。您可以添加并行或顺序阶段以及每个阶段的多个步骤。有一个包含不同步骤选项的列表。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi og"><img src="../Images/c1dc30741fa4ee7c59a76c945ff0a500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BR37hYj1gNm3fze-4RQTew.png"/></div></div></figure><p id="8c78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图包含3个阶段。第一个阶段名为“阶段1”，然后是阶段2a和阶段2b，包含简单的打印消息步骤。您还可以添加环境变量，并指定这个Jenkinsfile将在哪个代理中执行。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/5b82a99f04749cceb9eaec824931a705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Up_4WKFIQsNpcNa3fEhj1g.png"/></div></div></figure><p id="89c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">单击“保存”，然后通过单击“保存并运行”提交新的Jenkinsfile</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/1eda71fc38eae08aae7bd11bf419cb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*_I23qHAEXUTBqsyQrH_WTg.png"/></div></figure><p id="1c48" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者你也可以添加一个新的分支</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/1c5f2802bbd12c11843bfc857b0afcde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*ZTv17a3gx23ymHlWpE4R3A.png"/></div></figure><p id="5dee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">8.然后执行该作业。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/a4da3acadb6638ec479424ad7152ba58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4wwsyMGkb422eT-84qRfg.png"/></div></div></figure><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nz"><img src="../Images/5264da09197032e05cac008af6136a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6jKvfkR79w1-_6HUyr4JGw.png"/></div></div></figure><p id="16d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果添加了新的分支，您将能够在Github中看到它</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/2934fa520d3a60dcd4c73f57e7a47f9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRsSXsWDjEDf6xhUem8osQ.png"/></div></div></figure><p id="a6b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果项目已经有了一个Jenkinsfile，那么按照这些步骤开始时附加的链接中提供的说明进行操作会更容易。传统视图中的配置如下所示:</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nz"><img src="../Images/9b2a0feafdedd56b2f1e217f643c3526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4WjsTzg7aTlz67ex8Wrpcg.png"/></div></div></figure><p id="e640" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">9.如果创建了另一个具有Jenkinsfile的分支，则可以通过单击“立即扫描多分支管道”来发现它。在这种情况下，在Github中从“master”创建了一个新的分支“new-feature-2”(只有带有Jenkinsfiles的分支才会显示在Jenkins中)。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/5296c47eccde90dfa21f3b0a8b56b909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lp_vT9KwNUxmWPm8raNCww.png"/></div></div></figure><p id="b4f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后经过扫描，新的分支出现在詹金斯身上</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nz"><img src="../Images/460a61c1ec1a7ef33dab0a293278f497.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uI3ILbMXMr5Q1O2FFVUz_w.png"/></div></div></figure><p id="b9f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这项新功能是直接使用Github创建的，Jenkins将在执行扫描时检测新的分支。如果新发现的管道在发现时不想执行，则通过在作业的多分支管道主页中单击“配置”来更改设置，并添加属性“抑制自动SCM触发”,这样Jenkins将只发现新管道，但它们必须手动触发。</p><figure class="ma mb mc md gt mz gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b1e01a63fbbd7a353125b62ddbdbddda.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*pVFGew1f3Ma-Hv7pvQgUHA.png"/></div></figure></div></div>    
</body>
</html>
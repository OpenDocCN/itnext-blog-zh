<html>
<head>
<title>Creating Scroll Animations in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter中创建滚动动画</h1>
<blockquote>原文：<a href="https://itnext.io/creating-scroll-animations-in-flutter-74eb340627d9?source=collection_archive---------2-----------------------#2019-07-06">https://itnext.io/creating-scroll-animations-in-flutter-74eb340627d9?source=collection_archive---------2-----------------------#2019-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0865" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Flutter从头开始构建流畅的滚动动画</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/585a166a928eb7abb3619227407d3e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*a3MK5P1HWtv8s1muC8WpYQ.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">运行中的<a class="ae ky" href="https://github.com/kenreilly/flutter-scroll-animation-demo" rel="noopener ugc nofollow" target="_blank">演示应用</a>的屏幕记录</figcaption></figure><h2 id="52b1" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="1e9c" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在本文中，我们将看看如何使用<a class="ae ky" href="https://flutter.dev" rel="noopener ugc nofollow" target="_blank"> Flutter SDK </a>从头开始创建自定义滚动动画。Flutter是创建运行良好的原生移动应用程序的强大工具，它在创建丰富的用户体验(如动画)方面提供了令人难以置信的灵活性。</p><p id="9f55" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果您没有颤振环境，请前往<a class="ae ky" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank">安装页面</a>。本文中示例项目的源代码可以在<a class="ae ky" href="https://github.com/kenreilly/flutter-scroll-animation-demo" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="cc57" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">入门指南</h2><p id="925d" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">对于这个演示，我使用<code class="fe na nb nc nd b">flutter create</code>创建了一个默认的Flutter项目，并且只使用了Flutter中直接可用的类，没有向项目添加任何依赖项。在许多情况下，任务(如自定义动画)可以直接完成，不需要额外的库。</p><p id="b946" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这个示例应用程序的基本思想是创建一个包含几个项目的简单列表视图，当视图上下滚动时，让一个齿轮在后台顺时针/逆时针旋转。我们将通过获取用于列表视图的滚动控制器并将其传递给动画背景来实现这一点，这将构建一个与滚动位置同步旋转的自定义小部件。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="a5b2" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">应用程序入口点</h2><p id="4f55" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们将从主应用程序文件<strong class="lx iu"> lib/main.dart </strong>开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="cb3b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在<strong class="lx iu"> main.dart </strong>文件中，有以下组件的导入:</p><ul class=""><li id="7f97" class="ng nh it lx b ly mo mb mp li ni lm nj lq nk mn nl nm nn no bi translated"><strong class="lx iu"> demo-card.dart </strong></li><li id="472e" class="ng nh it lx b ly nq mb nr li ns lm nt lq nu mn nl nm nn no bi translated"><strong class="lx iu">items . dart</strong>T19】(为演示应用定义项目类和模拟内容)</li><li id="ef22" class="ng nh it lx b ly nq mb nr li ns lm nt lq nu mn nl nm nn no bi translated"><strong class="lx iu"> animated-bg.dart </strong> <em class="np">(构建动画背景小工具)</em></li></ul><p id="b3ed" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">主应用程序类(<strong class="lx iu"> AnimationDemo </strong>)设置了一个基本应用程序，它包装了默认的主页小部件(<strong class="lx iu"> MyHomePage </strong>)。在<strong class="lx iu"> MyHomePage </strong>类中有一个<em class="np"> _controller </em>属性，它被初始化为<a class="ae ky" href="https://api.flutter.dev/flutter/widgets/ScrollController-class.html" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu">scroll controller</strong></a>类的一个新实例，随后被传递到<strong class="lx iu"> AnimatedBackground </strong>(它在后台驱动齿轮旋转动画)和<strong class="lx iu"> ListView </strong>(它呈现演示项目的滚动列表)。还有一个<em class="np"> _cards </em>属性，它以从<em class="np"> items.dart </em>导入的<strong class="lx iu"> Item </strong>对象列表开始，并返回要在ListView中呈现的<strong class="lx iu"> DemoCard </strong>小部件列表。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="beb9" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">项目类别</h2><p id="f03b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们将签出的第一个导入文件是<strong class="lx iu"> lib/items.dart </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="aa77" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> Item </strong>类提供了一个数据结构，该数据结构将被传递给<strong class="lx iu">列表视图</strong>中呈现的<strong class="lx iu">演示卡</strong>的实例。除了名称、描述(目前在演示中没有使用)、颜色和要为每个项目渲染的<strong class="lx iu">图标</strong>之外，没有什么其他的了。一个<strong class="lx iu">项目</strong>对象的列表将作为一个简单内容的列表在<strong class="lx iu">列表视图</strong>中呈现。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="d476" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">DemoCard类</h2><p id="5097" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">下一个要检查的文件是<strong class="lx iu"> lib/demo-card.dart </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="6ea9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> DemoCard </strong>类在其构造函数中接收一个<strong class="lx iu">项目</strong>并返回一个Card小部件，该小部件呈现<strong class="lx iu">文本</strong>和<strong class="lx iu">图标</strong>元素，这些元素显示为每个项目定义的<em class="np">名称</em>和<em class="np">图标</em>。使用<strong class="lx iu">阴影</strong>、<strong class="lx iu">文本样式</strong>和<strong class="lx iu">圆形矩形边框</strong>以及卡片的仰角(设置为<code class="fe na nb nc nd b">3</code>)来应用一些基本样式。<strong class="lx iu">列</strong>和<strong class="lx iu">行</strong>小部件用于跨越卡片上的子元素。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="b09b" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">动画背景类</h2><p id="5ce8" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">把最好的留到最后，让我们看看<strong class="lx iu"> lib/animated-bg.dart </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="cf27" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在该文件的顶部，导入了<code class="fe na nb nc nd b">dart:math</code>库以访问<strong class="lx iu"> π </strong>常量，用于旋转齿轮的旋转变换计算。<strong class="lx iu"> AnimatedBackground </strong>类构造函数采用将驱动旋转的<strong class="lx iu"> ScrollController </strong>。<em class="np"> _offset </em>属性将返回控制器偏移量(如果控制器有客户端<em class="np">)(即控制器被正确初始化并连接到实际的滚动元素，如ListView) </em>或者它将简单地返回零。<em class="np"> build </em>方法返回一个<a class="ae ky" href="https://api.flutter.dev/flutter/widgets/AnimatedBuilder-class.html" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu">animated builder</strong></a>，它接受控制器(用作<a class="ae ky" href="https://api.flutter.dev/flutter/foundation/Listenable-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lx iu"> Listenable </strong> </a>在滚动事件上重新绘制自身)并构建一个<strong class="lx iu">溢出框</strong>，该溢出框被对齐以将齿轮置于屏幕外。</p><p id="820a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">值<code class="fe na nb nc nd b">4</code>和<code class="fe na nb nc nd b">3</code>将齿轮放在被测设备——iphonexʀ模拟器——的左下角。在实践中，<strong class="lx iu">校准</strong>值应该根据设备屏幕高度和宽度计算，以给出将齿轮放置在任何设备上的期望位置(左下角、向侧面居中等)的精确值，但是对于这个示例，我们将保持简单。</p><p id="36f1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后是精彩的部分，动画本身发生在<strong class="lx iu"> Transform </strong>类的<em class="np"> rotate </em>静态方法中。这个类使用一个<code class="fe na nb nc nd b">angle</code>和一个<code class="fe na nb nc nd b">child</code>，按照预期的角度旋转子元素。对于这个演示，我希望齿轮移动缓慢，感觉更符合滚动物理，而不是1:1值的疯狂惯性效应，我希望齿轮逆时针滚动，就好像它在物理上驱动列表一样，所以我将<code class="fe na nb nc nd b">offset</code>乘以<code class="fe na nb nc nd b">math.pi</code>，然后将乘积除以<em class="np"> -1024 </em>。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="db7a" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">结论</strong></h2><p id="fe41" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">本文和示例项目展示了Flutter为创建定制动画用户体验所提供的一些功能。仅仅使用几个基本的类和简单的数学，我们就有了一个完整的动画，为一些无聊的东西(比如设置屏幕)增加了一个有趣得多的元素。</p><p id="ca6c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这些概念可以扩展到创建闪屏、加载动画、页面转换、通知效果或任何其他可以想象的东西。几乎任何以<code class="fe na nb nc nd b">double</code>作为参数的东西都可以被动画化，这导致效果的直接实现，比如本例中使用的旋转，以及不透明度、位置和许多其他属性。</p><p id="4fb7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">感谢您的阅读，祝您的下一个颤振项目好运！</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><blockquote class="nv"><p id="3c8b" class="nw nx it bd ny nz oa ob oc od oe mn dk translated">肯尼斯·雷利(<a class="ae ky" href="https://twitter.com/8_bit_hacker" rel="noopener ugc nofollow" target="_blank"> 8_bit_hacker </a>)是<a class="ae ky" href="https://lvl-up.tech/" rel="noopener ugc nofollow" target="_blank"> LevelUP </a>的CTO</p></blockquote></div></div>    
</body>
</html>
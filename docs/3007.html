<html>
<head>
<title>How to test Vue apps with the popular Cypress framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用流行的Cypress框架测试Vue应用</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-test-vue-apps-with-the-popular-cypress-framework-aa9342e2bd58?source=collection_archive---------6-----------------------#2019-09-14">https://itnext.io/how-to-test-vue-apps-with-the-popular-cypress-framework-aa9342e2bd58?source=collection_archive---------6-----------------------#2019-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/39e3431ce7cce23a306a2bc55972121a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cenjHE5G6nX-8ftK4MuT-A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">柏树和Vue标志</figcaption></figure><h1 id="0f0f" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">介绍</h1><p id="7864" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">本文解释了如何使用Cypress测试Vuejs应用程序。用Vuejs创建的一个简单的todo应用程序就是一个例子。</p><p id="457f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">本文没有深入讨论用Cypress进行测试，Cypress文档是更好的资源。不是简单地解释Cypress和它是如何工作的，而是使用一个工作的(简单但有点实用的)应用程序来展示Cypress如何与Vuejs一起使用。</p><p id="f4b4" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">Cypress有很多功能，用起来会很神奇。但同时，它也是一把双刃剑。当寻找完美的断言来创建适当的测试时，这些丰富的特性有时会使人困惑，所以我解释了当我寻找在测试中使用的适当条件时的一些思考过程。</p><p id="2c0b" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">该应用程序将不会被广泛测试。仅测试基本功能，足以确保基本功能正常工作。</p><h1 id="acfd" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">设置应用程序</h1><p id="c903" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">由于本文的重点是编写测试，我们不会在创建应用程序本身上花费太多时间。这是一个简单的todo应用程序，所以我给了它基本的功能——添加任务、删除任务和删除任务。还有一些附加功能，比如不能添加空任务和不能添加重复任务。如果你愿意，你可以重构它，使它也能够处理重复的任务。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/7a0747838f0adad7abd428682ab6142c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*exAAUcz8X-vREie0"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">简单的待办事项应用程序</figcaption></figure><p id="6019" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这是todo应用程序的代码。它非常简约，没有太多的风格(实际上没有)。但是它是有效的，这就是我们开始编写测试所需要的。所以让我们开始写测试吧。我们必须先安装赛普拉斯。</p><h1 id="5613" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">安装和设置Cypress</h1><p id="952f" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">要使用npm安装Cypress:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/67a0f3338ac6d5257a0283c9ce587de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FzneDDXTB3Cf0N-y"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">将Cypress安装为开发依赖项</figcaption></figure><p id="d777" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">现在我们已经安装了Cypress作为开发依赖项，我们可以开始编写测试了。如果你是第一次使用Cypress，那么请遵循<a class="ae mj" href="https://docs.cypress.io/guides/getting-started/installing-cypress.html#System-requirements" rel="noopener ugc nofollow" target="_blank">文档</a>中的步骤。</p><p id="84e2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">当在一个项目中第一次启动Cypress时，它将为我们创建大量的测试来帮助我们开始。我们并不真的需要这些，所以可以删除它们。</p><p id="08d5" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">安装Cypress后，将创建一个同名的新文件夹，其中也有一些我提到的测试文件夹。尽管删除所有这些测试和文件夹是好的，但是保留一个名为<code class="fe mk ml mm mn b">integration</code>的文件夹。这是因为Cypress会在这个文件夹中查找测试。我试图在这个文件夹之外创建一个测试文件，但是它没有出现在Cypress UI中。我不确定我是否错过了什么，或者是否有一个解决的方法。如果有人知道这件事，请在下面的评论中告诉我🙂</p><p id="d5fb" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">至于测试文件的命名，尽管Cypress文档似乎将所有的示例文件都命名为<code class="fe mk ml mm mn b">something_spec.js</code>(意味着它们都以<code class="fe mk ml mm mn b">_spec.js</code>结尾)，但这并不是必须的。只要是JavaScript文件就可以随便命名。确保使用有意义的名字，而不是随意的名字。如果你有一个命名系统，那就太好了！</p><h1 id="7f44" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">写作测试</h1><p id="d4b3" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">应用程序已准备好，Cypress已安装并设置好。现在是时候开始编写我们的测试了。</p><p id="1e83" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我们将编写的第一个测试是检查是否添加了todo。查看应用程序代码，我们可以在输入字段中编写我们的任务，单击一个按钮，我们的任务就会被添加到一个无序列表中。因此，我们可以通过在输入框中书写并点击按钮来创建todos。</p><p id="73fc" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我以前曾用Jest为我的Vue应用程序编写测试，并在上面写了一篇文章。在编写这个测试时，我使用了与编写Jest测试相同的思维过程。说正经的，Vue组件是导入的，然后我们挂载它，如此等等。然而，在赛普拉斯，我找不到这样的东西。直到我看到一个使用<code class="fe mk ml mm mn b">visit()</code>的例子。我马上去了控制台，用<code class="fe mk ml mm mn b">npm run serve</code>启动了app。这个命令是针对Vue 3.x的，所以如果你使用Vue 2.x，那就是<code class="fe mk ml mm mn b">npm run start</code>。因为我可以使用localhost在浏览器上访问这个应用程序，所以我将那个地址用于<code class="fe mk ml mm mn b">cy.visit()</code>。</p><p id="9724" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">酷！Cypress可以访问应用程序页面，就像我正在访问它一样。所以现在剩下的就是选择输入框，输入一个任务，然后点击一个按钮。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/6b61f1927354a810e2fbc5ec345bb38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oNbPQo7EfPvTX8XY"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">检查是否创建了新todo的第一个Cypress测试</figcaption></figure><p id="87d9" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><code class="fe mk ml mm mn b">it</code>是大多数测试库用来编写测试用例的术语。你可以阅读我的文章，我会对此做更多的解释。</p><p id="e72f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">在这里，我们通过localhost访问应用程序，使用<code class="fe mk ml mm mn b">cy.get()</code>找到输入字段，并开始在里面输入内容。要输入一些东西，我们只需将<code class="fe mk ml mm mn b">cy.click()</code>链接到<code class="fe mk ml mm mn b">cy.get()</code>。然后我们<em class="mo">用同样的方法得到</em>按钮，并通过链接<code class="fe mk ml mm mn b">cy.click()</code>点击它。现在剩下的就是检查todo是否真的被添加到列表中。</p><p id="be93" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我首先想到的是获取整个列表，但是后来意识到我们只是检查我们创建的任务是否已经被添加。因为我们只检查那个，所以我使用了<code class="fe mk ml mm mn b">cy.get()</code>来查找包含我们的任务的列表元素。</p><p id="1ca1" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">现在看起来很容易，不是吗？这是你第一次测试赛普拉斯！！</p><p id="04b8" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">让我们不要在这里停下来，继续前进。我们的第二个测试是检查点击任务是否会把它划掉。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/7a2703f02815f94ffe970e19e3db6464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vK4-HTDsHttWIXzl"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">第二个测试检查单击任务是否会将其删除；表示它已经完成</figcaption></figure><p id="cb41" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">在第一次测试中，我们已经访问了应用程序页面并创建了一个todo，所以这次我们要做的就是单击它并检查它是否被越过。点击它，我们<em class="mo">得到</em>它，就像我们在第一次测试中使用<code class="fe mk ml mm mn b">cy.get()</code>一样。然后我们确保通过链接<code class="fe mk ml mm mn b">cy.contains()</code>来指定我们正在寻找的任务。接下来，我们像点击按钮一样点击它，通过链接<code class="fe mk ml mm mn b">cy.click()</code>。</p><p id="809b" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">最后，为了检查它是否被划掉，我们再次获得特定的任务，然后断言它具有<code class="fe mk ml mm mn b">completed</code>的类。</p><p id="f2b6" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果你再看一下我们的应用程序代码，我们已经写了一些CSS，用一个类<code class="fe mk ml mm mn b">completed</code>赋予元素，一个删除线的文本装饰。您可以更彻底地进行测试，而不是检查任务是否实际应用了CSS。这将确保测试即使在由于某种原因添加了<code class="fe mk ml mm mn b">completed</code>类但没有应用CSS的情况下也能工作。您可以在Cypress文档中搜索合适的断言。这将是导航文档的一个很好的练习。</p><p id="8834" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">现在进行最后的测试，我们将检查一个任务是否可以通过点击一个按钮来删除。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/2bf3b30b3f2bceb5d1cc42c105fdad0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fezyophd_IsEBYOe"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">第三个也是最后一个测试，检查任务是否被删除</figcaption></figure><p id="7c67" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这次的测试相当小。我们用<code class="fe mk ml mm mn b">cy.get()</code>和链条<code class="fe mk ml mm mn b">click()</code>得到按钮。最后，我们得到特定的任务，并断言它不包含任务内容。至此，我们已经完成了所有的测试，并确保应用程序的基本功能正常工作。</p><p id="8ab3" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">以下是我们在一个地方编写的所有测试:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/6a070a222acd304537b12a4fd50a78fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_a-NAp511Q0iiuyY"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我们为Todo应用程序编写的所有三个Cypress测试</figcaption></figure><h1 id="0c36" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">包扎</h1><p id="fc9a" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">你可能已经注意到，我们只与HTML元素交互，在测试中甚至没有接触过任何Vuejs，尽管我们的整个应用程序都是用Vue编写的。那是因为柏树就是那样做的。以Jest为例，与Vue应用程序相比，你可以为React应用程序编写不同的测试。在我看来，我认为Cypress是独立于任何特定框架的。不管你是在你的应用中使用基于组件的方法，使用服务器还是让它无服务器，Cypress都被设计成在你的浏览器中运行时测试你的应用。它模拟了普通用户在实际使用您的应用程序时的行为。您不必导入或安装任何组件。</p><p id="dd72" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">也就是说，我们已经完成了所有的测试。我们创建了一个最小的todo应用程序，并使用Cypress为它编写了测试。Cypress为测试提供了一些非常酷的工具和特性。如果你还没有尝试过，你就错过了。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="fea8" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><em class="mo">原载于</em> <a class="ae mj" href="https://dev.to/napoleon039/how-to-test-vue-apps-with-the-popular-cypress-framework-4jfg" rel="noopener ugc nofollow" target="_blank"> <em class="mo"> dev.to </em> </a> <em class="mo">。</em></p></div></div>    
</body>
</html>
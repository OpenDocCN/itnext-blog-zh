# Scala 中的代数数据类型和模式匹配

> 原文：<https://itnext.io/algebraic-data-types-and-pattern-matching-in-scala-96859310a624?source=collection_archive---------3----------------------->

![](img/86d92d4bb152aeebab591e4409d73c90.png)

[弗兰基·查马基](https://unsplash.com/@franki?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/data-engineering?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的照片

代数数据类型(ADT)听起来像代码设计原则，但实际上它可以被看作是对代码进行分类的一种方式。由于模式匹配，它被广泛使用，它鼓励您避免使用非法的数据状态。

在使用 Scala 时，如果您使用带有不可变字段的`case class` es 创建数据模型，而`case object`数据类型没有方法，那么您已经在编写 ADT 了。这使您能够通过类型创建富有表现力的、灵活的领域建模。

因此，在我们查看不同 ADT 类型的示例之前，让我们先来看几个相关的重要术语。

# 编程中的代数是什么？

在编程中，抽象是关键。将现实生活中的概念转化为数字和关系，是我们每天在工作中所做的事情。代数是一切之母。

理论上，代数可以被认为是:

*   一组物体
*   可以应用于这些对象以创建新对象的操作

## 数字代数

通过使用(a)整数(对象集)和(b)可用于这些对象的运算(+、—、*、/)，我们创建了新的数字(对象)。

```
1 + 1 = 2
2 * 2 = 4
```

## 关系代数

这可以看作是一个关系数据库。(a)数据库表是“对象集”,( b) SELECT、UPDATE 和 JOIN 是允许您创建新对象的“操作符”。

## 代码中的代数

下面是一个如何创建 Scala 操作符来从现有数据类型创建新数据类型的例子:

通过`sealed trait`,我们保留了扩展抽象数据的一组有限的可能值。通过这样做，编译器可以检查我们的函数是否处理了所有可能的值。此外，编译器确保密封特征只能在定义它的文件中扩展。

有三种代数数据类型。让我们在下一节看看代数数据类型的例子。

# 总和类型

它只是枚举了该类型所有可能的实例。它的 arity 等于组成它的类型的 arity 之和。它也被称为“枚举类型”。关于总和类型的要点是:

*   通常以`sealed trait`作为基本类型创建
*   实例创建为`case object`
*   当谈到和类型时，我们使用短语“是 a”和“或”。例如，星期一*是*类型的一天，而一天是星期二*或*星期三*或*星期四*或* …

下面是一些 Sum 类型的示例:

它本质上是一种在一个像元组一样的结构中输入多个值的方法。它的 arity 可以通过乘以所有构造函数字段可以获得的可能性的数量来计算。

最简单的例子是使用布尔函数:

由于 boolean 可以有 2 种可能，而`Foo`有 2 个字段，所以它的 arity 是 2*2 = 4。因此我们可以创建 4 种不同类型的`Foo`。

那么，如何才能知道其他类型能有多少种可能性呢？以下是简短的答案列表:

*   `Nothing`有 0 个可能的值
*   `Unit`有 1 个可能值
*   `Bool`有两个可能的值
*   `Byte`有 256 个可能值
*   `Int`有 232 个可能的值
*   `String`有无限可能的值

基本上，类型越少，代码就越简单。

在我们看更多的例子之前，这里是产品类型用法的重要部分:

*   一般用`final case class`创建
*   当谈论产品类型时，我们使用短语“has a”和“and”。Foo *有一个*字段 1 *和*字段 2。
*   产品类型可以是递归的

以下是几个产品类型示例:

# 模式匹配

使用模式匹配时，ADTs 使您的生活更加轻松。

模式匹配允许您使用提取器方法分解给定的 ADT。它基本上提取了产品类型的字段。为此，case 类的伴随对象需要实现`unapply`方法，以便成为提取器。

当我们使用`sealed trait`定义一个代数数据类型时，如果我们在模式检查中遗漏了一个 case 条件，编译器会对我们大喊大叫。

让我们看看 scala 文档中关于[模式匹配](https://docs.scala-lang.org/tour/pattern-matching.html)的例子:

# 结论

当您使用代数数据类型时，对数据进行分类会使您的生活更加轻松。这将使您能够使用更强大的 switch 语句版本，如模式匹配，使您的代码更容易推理。
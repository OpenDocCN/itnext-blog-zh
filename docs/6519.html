<html>
<head>
<title>Modern C++ in Advent of Code: Day8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代C++代码的出现:第8天</h1>
<blockquote>原文：<a href="https://itnext.io/modern-c-in-advent-of-code-day8-3b5d3e6c24b6?source=collection_archive---------3-----------------------#2021-12-08">https://itnext.io/modern-c-in-advent-of-code-day8-3b5d3e6c24b6?source=collection_archive---------3-----------------------#2021-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8a70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是代码问世的第八天。今天，我们将使用位操作来解开混乱的电线。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/b82379dd7464eb32e8d68a12c84aab11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rzhq0c9x0e4yJIa8g-Sm9A.png"/></div></div></figure><p id="1eae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，请先尝试解决问题，然后再看解决方案。对于本系列中的所有文章，<a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">查看这个列表</a>。</p><h1 id="a3a9" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第八天:第一部分</h1><p id="b7e8" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们今天的目标是解读一个七段显示器。我们的输入是一系列字符串，描述显示器的哪些部分被点亮:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="65b0" class="mg kz iq mc b gy mh mi l mj mk"> aaa     aaa     aaa  <br/>b   c       c   b<br/>b   c       c   b<br/> ddd             ddd<br/>e   f       f   e   f<br/>e   f       f   e   f<br/> ggg             ggg   </span></pre><p id="af72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ml mm mn mc b">876</code>的显示将被编码为<code class="fe ml mm mn mc b">abcdefg acf abdefg</code>。不幸的是，除了处理这种表示，我们的输入也是混乱的。幸运的是，每个输入行内的加扰是稳定的，单个输入的所有显示都以相同的方式加扰。整个输入是以下格式的一系列行:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="78fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">定界符之前的显示作为信息，应该允许我们解码加扰，定界符之后的显示是我们要解码的。</p><p id="e6c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于第1部分，我们不会解决解读输入的整个问题。相反，我们只需要识别<em class="mq">唯一的</em>号。这些是1、4、7和8，因为我们可以仅根据lit段的数量来识别这些数字(1为2段，4为4段，7为3段，8为7段)。</p><p id="66b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，即使有了这个更简单的任务，我们也可以为即将到来的解码输入任务做准备，并方便地表示七段显示:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="b8d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">位是一种表示由具有两种状态(开/关)的元素组成的项目的便捷方式。然而，我们需要小心，因为位操作很容易使代码难以阅读。准备更容易使用的命名常数是缓解这一问题的一种方法，也就是说，在这里，我们已经命名了每个段，并准备了一个数组来表示每个数字的亮段。</p><p id="2923" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">准备工作完成后，我们现在可以解析输入，首先是测试:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="487e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后是解析代码:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="7e5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一次，我们不依赖于流，而是一个字符一个字符地解析字符串。我们读取小写字符，跳过空白并检测何时通过了<code class="fe ml mm mn mc b">|</code>分隔符。表达式<code class="fe ml mm mn mc b">*it-'a'</code>依赖于小写字符被编码为一个连续的范围，所以<code class="fe ml mm mn mc b">'c'-'a'==2</code>和<code class="fe ml mm mn mc b">'a'+3=='d'</code>。</p><p id="11af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入解析完成后，我们现在可以读取整个输入，并使用<code class="fe ml mm mn mc b">std::ranges::count_if</code>对1、4、7和8的实例进行计数。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="de78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了计算lit段的数量，我们使用<code class="fe ml mm mn mc b">std::popcount</code>，它返回设置为1的位数。</p><h1 id="cd0f" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第八天:第二部分</h1><p id="39fa" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">是时候整理输入了。我们将使用约束求解的基本版本来确定哪个输入连接到哪个段。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="828b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解决布线将利用逻辑来缩小可能的连接。在我们解决了哪个输入连接到哪个段之后，我们就可以使用这个信息来解码数字(在输入的定界符之后)。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="6e25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">测试准备好了，是时候写求解器了。我们将需要域变量。您可以将这些视为具有一组可能值的变量。求解的要点是从这些集合中去除不可能的值，直到我们得到一个唯一的解。集合也可以很方便地用位来表示，所以我们使用<code class="fe ml mm mn mc b">uint8_t</code>来表示七个可能的段连接的集合。</p><p id="05fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看我们能从杂乱的输入中挖掘出什么信息。</p><h2 id="6c23" class="mg kz iq bd la mr ms dn le mt mu dp li jy mv mw lm kc mx my lq kg mz na lu nb bi translated">明显的事实</h2><p id="7436" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们已经讨论过具有唯一表示的数字。一，四，七，八。第八段没有给出任何信息，因为它列出了所有段。</p><ul class=""><li id="9c65" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">首先，点亮的线段必须是C或F</li><li id="2d0a" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">对于四个，点亮的段必须是B、C、D或F</li><li id="7fc8" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">对于7，点亮的段必须是A、C或F</li></ul><h2 id="3fbd" class="mg kz iq bd la mr ms dn le mt mu dp li jy mv mw lm kc mx my lq kg mz na lu nb bi translated">消极的</h2><p id="1560" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们也可以考虑负面因素。</p><ul class=""><li id="cb65" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">首先，未点亮的线段不能是C或F</li><li id="7888" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">对于四个，未点亮的段不能是B、C、D或F</li><li id="cd9f" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">对于7，不亮段不能是A、C或F</li></ul><p id="9f45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一个略显隐晦的负面。</p><ul class=""><li id="f450" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">对于有五个发光段的数字，不发光段是B、C、E或F</li><li id="4b92" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">对于有六个发光段的数字，不发光段是C、D或E</li></ul><h2 id="0f53" class="mg kz iq bd la mr ms dn le mt mu dp li jy mv mw lm kc mx my lq kg mz na lu nb bi translated">清理工作</h2><p id="6e21" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">最后，如果我们有一条只有一个连接点的线，那条线是固定的，我们知道没有其他线连接到这条线段。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="2cc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们初始化每条线(域变量)来连接所有的段。然后，我们检查我们的每一个输入，并根据点亮段的数量应用上述逻辑。我们遍历了所有的线路，排除了不可能的连接。最后，我们进行清理(第50–59行)。</p><p id="d251" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我们期望每条线连接到一个段，并在解码函数中执行翻译过程。</p><p id="33e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成所有工作后，我们只需要迭代这些数字来计算总和:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><h1 id="abca" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">链接和技术说明</h1><p id="2b43" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">每日解决方案存储库位于:【https://github.com/HappyCerberus/moderncpp-aoc-2021】T2。</p><p id="e3b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">看看这个列表，里面有关于《代码降临》中其他日子的文章</a>。</p><p id="c8ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请不要忘记亲自尝试<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">降临码</a>。</p><h1 id="557c" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">感谢您的阅读</h1><p id="3a68" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">感谢您阅读这篇文章。你喜欢吗？</p><p id="8502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也在YouTube上发布视频。你有问题吗？在<a class="ae kl" href="https://twitter.com/SimonToth83" rel="noopener ugc nofollow" target="_blank">推特</a>或<a class="ae kl" href="https://www.linkedin.com/in/simontoth" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div></div>    
</body>
</html>
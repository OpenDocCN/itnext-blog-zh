<html>
<head>
<title>Easy and Fast Adjustment of Kubernetes CPU and Memory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻松快速地调整Kubernetes CPU和内存</h1>
<blockquote>原文：<a href="https://itnext.io/easy-and-fast-adjustment-of-kubernetes-cpu-and-memory-709394cc2cb1?source=collection_archive---------0-----------------------#2020-12-18">https://itnext.io/easy-and-fast-adjustment-of-kubernetes-cpu-and-memory-709394cc2cb1?source=collection_archive---------0-----------------------#2020-12-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="87c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Kubernetes中分配和管理CPU和内存资源既复杂又容易。在为众多客户完成这项任务后，我决定创建一个框架区域。我将向您展示Kubernetes的资源和限制是什么，以及如何管理它们。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/38fe4b77b5939efedc7aca24855f0837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0raPh3cQoHTCqatZDBQA5A.png"/></div></div></figure><h2 id="bce2" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">该框架包含以下步骤。</h2><ul class=""><li id="3347" class="lt lu it js b jt lv jx lw kb lx kf ly kj lz kn ma mb mc md bi translated"><strong class="js iu">信息图表指南</strong>显示了确定和分配资源和限制时应遵循的算法。</li><li id="0f47" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><strong class="js iu">代码模板</strong>允许以最小的适应性应用那些算法。</li><li id="a892" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><strong class="js iu">算法和工具</strong>收集有关资源消耗的指标并设置限制。</li><li id="f76d" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><strong class="js iu">链接</strong>到官方文档，您可以快速获取一些示例并阅读更多详细信息。</li></ul><h2 id="3864" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">这篇文章没有包含的内容。</h2><p id="0e82" class="pw-post-body-paragraph jq jr it js b jt lv jv jw jx lw jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">我的目标是简单。所以你不会找到关于资源、限制范围和配额如何工作的详细描述。有大量关于它的文章，以及Kubernetes的完整文档。相反，你可以在这里找到关于如何快速调整项目中Kubernetes资源的信息<strong class="js iu"><em class="mm"/>。</strong></p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="64a3" class="mu lb it bd lc mv mw mx lf my mz na li nb nc nd ll ne nf ng lo nh ni nj lr nk bi translated">关于CPU和内存资源的基础指南</h1><p id="661e" class="pw-post-body-paragraph jq jr it js b jt lv jv jw jx lw jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">两个备忘单从Kubernetes、度量单位、资源状态工作流以及如何应用它的一些规则方面解释了什么是资源。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nl"><img src="../Images/a50392aa48ce0b694a9b2b9b666cbfef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yjMSe7VDWmTxNogGcQxytQ.png"/></div></div></figure><h2 id="73fc" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">CPU和内存<strong class="ak">测量单位</strong></h2><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/c3ea499a3c21a90bfdfd9cac1b46e54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OxT-5PQk8GyGxdsh"/></div></div></figure><p id="35ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="mm">请注意</em></strong><em class="mm"/><strong class="js iu"><em class="mm">CPU计算公式并不适用于每个设置或项目</em> </strong> <em class="mm">。它被用作检测和分配资源和限制的过程的起点。</em></p><p id="b479" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Kubernetes部署YAML模板包括容器、资源和限制定义。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e4e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更详细的信息和代码片段:</p><ul class=""><li id="0cfb" class="lt lu it js b jt ju jx jy kb np kf nq kj nr kn ma mb mc md bi translated"><a class="ae ns" href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/" rel="noopener ugc nofollow" target="_blank"> Kubernetes.io .分配内存资源指南</a>。</li><li id="85c3" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><a class="ae ns" href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-cpu-resource/" rel="noopener ugc nofollow" target="_blank"> Kubernetes.io .分配CPU资源指南</a>。</li><li id="acdf" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><a class="ae ns" href="https://cloud.google.com/blog/products/gcp/kubernetes-best-practices-resource-requests-and-limits" rel="noopener ugc nofollow" target="_blank"> Kubernetes最佳实践资源请求和限制</a></li><li id="1be5" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated">Azure Kubernetes服务。开发人员最佳实践资源管理</li></ul><h1 id="b59b" class="mu lb it bd lc mv nt mx lf my nu na li nb nv nd ll ne nw ng lo nh nx nj lr nk bi translated">资源<strong class="ak">配额指南</strong></h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/157cdc7f975ba36e3fc9ea885599203c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8GQuYKVTclvqe-R1"/></div></div></figure><p id="b8b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">两个配额<strong class="js iu">模板，包含支持的命名空间中持久卷声明和资源的配额定义</strong>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="f0e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以使用ku bectl“apply”命令来设置名称空间的配额约束。</p><pre class="kp kq kr ks gt ny nz oa ob aw oc bi"><span id="3c90" class="la lb it nz b gy od oe l of og">kubectl apply -f resource-quota.yaml — namespace backend</span></pre><p id="7161" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">配额、指标以及如何使用配额表达式和代码示例的详细说明。</p><ul class=""><li id="b9ef" class="lt lu it js b jt ju jx jy kb np kf nq kj nr kn ma mb mc md bi translated"><a class="ae ns" href="https://kubernetes.io/docs/concepts/policy/resource-quotas/" rel="noopener ugc nofollow" target="_blank">https://kubernetes.io/docs/concepts/policy/resource-quotas/</a></li></ul><h1 id="c885" class="mu lb it bd lc mv nt mx lf my nu na li nb nv nd ll ne nw ng lo nh nx nj lr nk bi translated">极限<strong class="ak">范围指南</strong></h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/ab536320b4445b1e9b8333994178d057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4HOj5vwpS5PV6x8Y9caNg.png"/></div></div></figure><p id="719b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">两个限制范围代码模板，用于限制容器的CPU和内存资源，以及限制存储(持久卷声明)。要设置该约束，您也可以使用<code class="fe oi oj ok nz b">kubectl apply -f path/to/file.yaml -n namespace</code></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="4c60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更详细的信息和代码片段。</p><ul class=""><li id="1291" class="lt lu it js b jt ju jx jy kb np kf nq kj nr kn ma mb mc md bi translated"><a class="ae ns" href="https://kubernetes.io/docs/tasks/administer-cluster/manage-resources/cpu-default-namespace/" rel="noopener ugc nofollow" target="_blank">管理资源。Cpu默认命名空间</a></li><li id="9a0e" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><a class="ae ns" href="https://kubernetes.io/docs/tasks/administer-cluster/limit-storage-consumption/" rel="noopener ugc nofollow" target="_blank"> Kubernetes木卫一。限制存储消耗</a></li><li id="8801" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><a class="ae ns" href="https://www.howtoforge.com/limit-ranges-in-kubernetes/" rel="noopener ugc nofollow" target="_blank"> Kubernetes木卫一。极限范围</a></li></ul></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="3358" class="mu lb it bd lc mv mw mx lf my mz na li nb nc nd ll ne nf ng lo nh ni nj lr nk bi translated">有助于资源和限制例程的工具和框架</h1><ul class=""><li id="3613" class="lt lu it js b jt lv jx lw kb lx kf ly kj lz kn ma mb mc md bi translated"><a class="ae ns" href="https://github.com/derailed/popeye" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">Popeye</strong></a><strong class="js iu"/>扫描集群的潜在配置、资源和网络漏洞问题，并生成所有问题的详细报告。</li><li id="a2ee" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><a class="ae ns" href="https://github.com/FairwindsOps/goldilocks/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">金凤花</strong> </a>扫描pod的资源限制，并使用推荐的资源创建报告。</li><li id="5c09" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated">一个简单的工具，来自Azure团队，可以扫描pods来寻找丢失的资源并限制请求。</li><li id="4b47" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ma mb mc md bi translated"><a class="ae ns" href="https://github.com/derailed/k9s#benchmark-your-applications" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">K9s+基准测试</strong> </a> —提供命令行界面(CLI ),允许您在您喜爱的终端软件<br/>中轻松管理、监控甚至基准测试您的集群</li></ul><p id="6be4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一些有用的免费开源工具，很容易安装。您还可以将这些工具与<a class="ae ns" href="https://www.datadoghq.com/blog/announcing-aks/" rel="noopener ugc nofollow" target="_blank"> Datadog </a>、<a class="ae ns" href="https://ifi.tech/2020/10/28/how-to-configure-prometheus-and-grafana-in-azure-kubernetes-aks/" rel="noopener ugc nofollow" target="_blank"> Grafana+Prometeus </a>、Azure Monitor结合使用，以改进资源和限制监控。</p><h1 id="c099" class="mu lb it bd lc mv nt mx lf my nu na li nb nv nd ll ne nw ng lo nh nx nj lr nk bi translated">算法</h1><ol class=""><li id="57b5" class="lt lu it js b jt lv jx lw kb lx kf ly kj lz kn ol mb mc md bi translated">设置资源请求。获取特定应用程序/容器的CPU和内存使用信息。</li><li id="49f2" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ol mb mc md bi translated">设置资源限制。设置资源请求。运行负载测试以检测高负载下容器的CPU和内存..</li><li id="0723" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ol mb mc md bi translated">监控容器的CPU和内存使用情况。</li><li id="87de" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ol mb mc md bi translated">监控持久存储的使用情况。</li><li id="f7f5" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ol mb mc md bi translated">检查是否可以使用限制范围应用资源限制(如果您有类似的容器、存储设置)</li><li id="fcbd" class="lt lu it js b jt me jx mf kb mg kf mh kj mi kn ol mb mc md bi translated">如果需要，应用存储限制范围。或者使用配额(不建议对生产环境应用配额)</li></ol></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="c13d" class="mu lb it bd lc mv mw mx lf my mz na li nb nc nd ll ne nf ng lo nh ni nj lr nk bi translated">结论</h1><p id="583e" class="pw-post-body-paragraph jq jr it js b jt lv jv jw jx lw jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">我已经和你分享了我每天创建和使用的框架，同时处理Kubernetes的请求和限制。希望你会觉得有用。有什么好主意吗？</p><p id="329c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请在评论中分享你的反馈和建议。</p></div></div>    
</body>
</html>
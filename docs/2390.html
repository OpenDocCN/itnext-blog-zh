<html>
<head>
<title>Performance Analyzer for Kubernetes on vSphere</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">vSphere上Kubernetes的性能分析器</h1>
<blockquote>原文：<a href="https://itnext.io/performance-analyzer-for-kubernetes-on-vsphere-ce85ddbe05ee?source=collection_archive---------5-----------------------#2019-05-16">https://itnext.io/performance-analyzer-for-kubernetes-on-vsphere-ce85ddbe05ee?source=collection_archive---------5-----------------------#2019-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a2b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能已经注意到，我们Opvizor一直在改进Performance Analyzer的容器支持。无论你是在<a class="ae kl" href="https://www.docker.com" rel="noopener ugc nofollow" target="_blank"> Docker </a>主机上运行docker container，还是使用<a class="ae kl" href="https://www.kubernetes.io" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>。由于我们已经拥有业界最详细、最完整的VMware监控体系之一，尤其是Kubernetes监控部分对许多客户来说非常方便。原因很简单，他们在vSphere上运行Kubernetes，因此Kubernetes主机是在VMware vSphere上运行的虚拟机。</p><p id="3c28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Performance Analyzer在全堆栈监控和性能分析方面处于领先地位，从VMkernel (NUMA不平衡、内核存储队列等)开始，进入虚拟机性能指标(内存膨胀、cpu就绪aso。)、到来宾(Kubernetes节点导出器— cpu、内存、numa、磁盘利用率)和到Kubernetes Pod(容器上下文切换、数据包丢失……)。</p><p id="c8f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您在生产环境中或以严肃的方式在vSphere 上运行<strong class="jp ir"> Kubernetes，您应该导入Performance Analyzer，并获取完整的图片，而不是拼图。</strong></p><p id="8e20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">让我们进入一些细节</strong></p><p id="0158" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将Performance Analyzer连接到您的VMware vCenter服务器以及Kubernetes环境后，您可以在很短的时间内在结构良好的控制面板中找到性能指标。</p><p id="e4f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Kubernetes节点</strong>和运行这些节点的虚拟机之间的匹配是自动发生的。一个典型的控制面板是Starter:<strong class="jp ir">VMware Virtual Machines K8s</strong>，它在一个位置显示所有重要指标。如果您想在vSphere integration上测试Kubernetes，请联系我们。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/1437adf90dfe6f69b9f6b4e3fb54f38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZGhhsiXkxnwZdIQe6zHWJA.png"/></div></div></figure><p id="b14a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通用性能指标旁边的一些亮点是NUMA主节点和NUMA远程节点利用率图表。NUMA度量收集需要在现有的节点导出器中进行简单的更改，或者部署Opvizor节点导出器。该控制面板是一个很好的起点，因为它显示了整个堆栈。</p><p id="4310" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">节点导出器</strong></p><p id="0ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论Kubernetes节点是在VMware vSphere上运行还是在硬件上运行，Node exporter Full控制面板都提供了详细的可视化效果。可以检查所有重要的资源指标并发出警报— CPU、内存、磁盘、网络。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/693fc0a34b6b4d24dcd21674b027bef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMTiJ6sVOdNPPtBpufrapA.png"/></div></div></figure><p id="7023" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还提供了详细的NUMA利用率指标或文件系统信息。</p><p id="5567" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Pod概述</strong></p><p id="44c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到Starter dashboard，因为它还显示了容器信息，包括顶级消费者或麻烦制造者。数据是随着时间的推移收集的，因此您可以很容易地在过去几分钟或过去几周甚至几个月发生的事情之间进行更改。请注意，更多的数据意味着更多的IOps，因此，如果您运行具有数百或数千个pod的环境，在我们的支持下仔细检查开箱即用的配置非常重要。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/94e14d929b2643675a567bf5d75bb51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GRiapn4shTy6vc8tLr6piw.png"/></div></div></figure><p id="34d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，仪表板显示当前负载、所选时间范围内的平均负载和峰值。</p><p id="3ed8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Pod详细信息</strong></p><p id="8a82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，我们还提供了几个Pod细节仪表板。您可以检查容器的所有KPI，甚至可以通过任何可用的Kubernetes标签(app、service等)进行过滤，而不仅仅是pod名称。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/3b87205a3429cfd0539bd78110e5b035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ysoK93Q9WKSTmtstV9NYw.png"/></div></div></figure><p id="b8be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">许多可用的监控工具要么在这里停止，要么在这里启动，并且不提供VMware vSphere详细信息或详细的容器详细信息，如Pod流程详细信息。我们为我们的客户提供了一个<a class="ae kl" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank">掌舵</a>图表，该图表部署了一个daemonset来运行Kubernetes节点上的pod流程导出器。</p><p id="834f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Pod集装箱工艺视图</strong></p><p id="3047" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，我们不仅可以收集外部性能指标，还可以收集内部指标。进程数量、内存利用率、上下文切换或写入的字节只是您可以为容器中的所有进程或所选进程收集的一些信息(可以配置进程选择)。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/31e17a61c001f3dc402928d13472136e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2ReQvwBQIy_ZQYCxB4HaQ.png"/></div></div></figure><p id="d216" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您已经全面了解了在运行Kubernetes和VMware vSphere时可以收集、可视化和用于警报的信息量。在那篇文章中，我们忽略了进行实时故障排除以及将容器日志文件与容器性能数据相关联的能力。我们会在后续的博客文章中深入探讨这一点。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="bed8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lf">原载于2019年5月16日</em><a class="ae kl" href="https://www.opvizor.com/performance-analyzer-for-kubernetes-on-vsphere" rel="noopener ugc nofollow" target="_blank"><em class="lf">https://www.opvizor.com</em></a><em class="lf">。</em></p></div></div>    
</body>
</html>
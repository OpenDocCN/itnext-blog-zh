<html>
<head>
<title>Switching build-configurations in spring-boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在弹簧靴中切换构建配置</h1>
<blockquote>原文：<a href="https://itnext.io/switching-build-configurations-in-spring-boot-e7a607c6af82?source=collection_archive---------1-----------------------#2018-04-07">https://itnext.io/switching-build-configurations-in-spring-boot-e7a607c6af82?source=collection_archive---------1-----------------------#2018-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3a21a7b6058476b40484b5e368bbcf5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GynYFisz45b3TSvzjDUgOQ.jpeg"/></div></div></figure><blockquote class="jy jz ka"><p id="4bb7" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae la" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fswitching-build-configurations-in-spring-boot-e7a607c6af82%3Futm_source%3Dmedium_sharelink%26utm_medium%3Dsocial%26utm_campaign%3Dbuffer" rel="noopener ugc nofollow" target="_blank">点击这里在LinkedIn上分享这篇文章</a></p></blockquote><p id="f1cb" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke ir">总结</strong></p><ul class=""><li id="bf46" class="le lf iq ke b kf kg kj kk lb lg lc lh ld li kz lj lk ll lm bi translated">设置环境变量$SPRING_PROFILES_ACTIVE</li><li id="4744" class="le lf iq ke b kf ln kj lo lb lp lc lq ld lr kz lj lk ll lm bi translated">任何应用-{something}。{something}匹配的yml将优先于application.yml</li></ul><p id="ac91" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke ir">示威游行</strong></p><p id="aba4" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">*我不会在这里展示任何应用程序逻辑，但如果有人想初始化一个简单的spring-boot应用程序，这里是一个很好的地方。</p><p id="ca99" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><a class="ae la" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank">https://start.spring.io/</a></p><p id="8e0a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">构建目标通常至少由开发/生产来分隔，下面是如何使用spring-boot和application.yml来做到这一点。</p><p id="fd6a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">例如，让我们根据构建配置选择不同的数据库。我将使用“demodb”数据库进行生产，使用“tst_demodb”进行开发。</p><p id="b00a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">应用程序. yml</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="83a7" class="mb mc iq lx b gy md me l mf mg"><strong class="lx ir">spring:<br/>  datasource:<br/>    url: </strong>jdbc:mysql://127.0.0.1:3306/{DB_name} //demodb<br/>    <strong class="lx ir">username: </strong>hoge<br/>    <strong class="lx ir">password: </strong>hoge<br/>    <strong class="lx ir">hikari:<br/>      minimum-idle: </strong>10<br/>      <strong class="lx ir">maximum-pool-size: </strong>10<br/>      <strong class="lx ir">connection-timeout: </strong>3000</span></pre><p id="6b4a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">应用程序开发人员</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="ff05" class="mb mc iq lx b gy md me l mf mg"><strong class="lx ir">spring:<br/>  datasource:<br/>    url: </strong>jdbc:mysql://127.0.0.1:3306/{DB_name} //tst_demodb<br/>    <strong class="lx ir">username: </strong>fuga<br/>    <strong class="lx ir">password: </strong>fuga<br/>    <strong class="lx ir">hikari:<br/>      minimum-idle: </strong>10<br/>      <strong class="lx ir">maximum-pool-size: </strong>10<br/>      <strong class="lx ir">connection-timeout: </strong>3000</span></pre><p id="1c83" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">两个yamls都放在</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="bc17" class="mb mc iq lx b gy md me l mf mg">{project_root}/src/main/resources/config</span></pre><p id="8cfb" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">现在创建一个简单的部署脚本，如下所示:</p><p id="3a02" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">初始化. sh</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="0fe8" class="mb mc iq lx b gy md me l mf mg">#!/bin/bash</span><span id="5203" class="mb mc iq lx b gy mh me l mf mg"><strong class="lx ir">export SPRING_PROFILES_ACTIVE='dev'</strong></span><span id="4ca1" class="mb mc iq lx b gy mh me l mf mg">./gradlew bootRun</span></pre><p id="dea0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">很抱歉这么晚才提到使用gradle，但是只要您的应用程序可以启动，maven或任何东西都可以。</p><p id="4048" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">这里的关键点用粗体显示。</p><p id="c16d" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">通过设置SPRING_PROFILES_ACTIVE，任何应用-{something}。将使用xml。</p><p id="3541" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在本例中，一个名为application- <strong class="ke ir"> dev </strong>的文件。将读取yml而不是application.yml</p><p id="614a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">以下是输出结果:</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="9c55" class="mb mc iq lx b gy md me l mf mg">.   ____          _            __ _ _</span><span id="56e4" class="mb mc iq lx b gy mh me l mf mg">/\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \</span><span id="1294" class="mb mc iq lx b gy mh me l mf mg">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</span><span id="1d4a" class="mb mc iq lx b gy mh me l mf mg">\\/  ___)| |_)| | | | | || (_| |  ) ) ) )</span><span id="3174" class="mb mc iq lx b gy mh me l mf mg">'  |____| .__|_| |_|_| |_\__, | / / / /</span><span id="8feb" class="mb mc iq lx b gy mh me l mf mg">=========|_|==============|___/=/_/_/_/</span><span id="7442" class="mb mc iq lx b gy mh me l mf mg">:: Spring Boot ::        (v2.0.0.RELEASE)<br/></span><span id="cb37" class="mb mc iq lx b gy mh me l mf mg">2018-04-07 19:09:06.764  INFO 17839 --- [           main] c.e.mybatisdemo.MybatisdemoApplication   : <strong class="lx ir">The following profiles are active: dev</strong></span></pre><p id="deaf" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">检查应用程序中的任何d b-insert或updates只发生在tst_demodb上，这是在application-dev.yml中指定的</p><p id="1b44" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke ir">总结</strong></p><ul class=""><li id="95da" class="le lf iq ke b kf kg kj kk lb lg lc lh ld li kz lj lk ll lm bi translated">设置环境变量$SPRING_PROFILES_ACTIVE</li><li id="e187" class="le lf iq ke b kf ln kj lo lb lp lc lq ld lr kz lj lk ll lm bi translated">任何应用-{something}。{something}匹配的yml将优先于application.yml</li></ul></div></div>    
</body>
</html>
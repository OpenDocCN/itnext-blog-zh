<html>
<head>
<title>How to Spot Gaps in Your Public Cloud Kubernetes Security Posture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何发现您的公共云Kubernetes安全状况中的差距</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-spot-gaps-in-your-public-cloud-kubernetes-security-posture-b9cd375f1b25?source=collection_archive---------1-----------------------#2022-05-10">https://itnext.io/how-to-spot-gaps-in-your-public-cloud-kubernetes-security-posture-b9cd375f1b25?source=collection_archive---------1-----------------------#2022-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fe65104dec80dcfd49d75c831ca30b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QlXlvWK-tnOTX8ZK"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Kubernetes的安全问题</figcaption></figure><p id="d474" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">特斯拉被黑是因为他们的Kubernetes管理控制台没有密码保护。在另一个事件中，Capital One的AWS防火墙定义过于宽松，导致30GB的信贷申请数据(影响1.06亿客户)暴露。除了实现Kubernetes本身，最重要的考虑是安全性。</p><h2 id="e35f" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">大约60%的Kubernetes安全漏洞是由于配置错误造成的</h2><p id="2319" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">【2021年Kubernetes安全状况</p><p id="9590" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">与任何其他技术领域相比，公共云总是有能力引入看不见的漏洞，特别是通过影子IT以及开发团队和最终用户可以使用的服务的便利性。</p><h2 id="6346" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">您真的知道您的组织是否正在使用或计划使用公有云Kubernetes </strong>吗？</h2><p id="8d0d" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">您了解这对于保护组织的应用程序和数据意味着什么吗？</p><p id="df0c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上图是文章“<strong class="ke ir">如何发现您的公共云Kubernetes安全态势中的差距”</strong>的前提，该文章旨在展示<strong class="ke ir"> </strong>您需要考虑的一些领域，这是一个永无止境的挑战。尤其是在面对迟钝且普遍存在的范式转换技术时，因为它将是普遍存在的，而且如果您还没有掌握理解您想要采取的安全态势所需的关于攻击媒介和漏洞图的高级信息。</p><p id="2829" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你已经了解kubernetes和容器，那么很好。您不需要成为容器和kubernetes方面的专家，但是理解基础知识对于能够确定在哪里集中精力是至关重要的。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/49106c32c377495566ee135eed27e86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AjVR-I_4dELdwVHE"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">库伯内特建筑</figcaption></figure><p id="f0e4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上面简化的Kubernetes架构是理解一些需要考虑的安全领域的基础。</p><p id="1d06" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">看一下这些文章，从较高的层次理解这些技术，重点是linux容器和Kubernetes。<a class="ae ly" href="https://www.appvia.io/blog/understanding-common-kubernetes-terms" rel="noopener ugc nofollow" target="_blank">https://www . app via . io/blog/understanding-common-kubernetes-terms</a></p><p id="75db" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.appvia.io/blog/what-is-kubernetes" rel="noopener ugc nofollow" target="_blank">https://www.appvia.io/blog/what-is-kubernetes</a></p><p id="8534" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.redhat.com/en/topics/containers" rel="noopener ugc nofollow" target="_blank">https://www.redhat.com/en/topics/containers</a></p><h2 id="287d" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">公有云Kubernetes v Kubernetes发行版</strong></h2><p id="0465" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">Kubernetes可以在任何地方使用，公共云、私有数据中心、edge等。然而，当我们想要在公共云中使用Kubernetes时，我们需要进行区分。我们可以选择以两种方式使用Kubernetes。</p><h2 id="8199" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">云管理或自我管理的Kubernetes </strong></h2><p id="b8bf" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">有了自我管理的Kubernetes平台，我们可以使用开源的Kubernetes项目作为起点，或者采用第三方Kubernetes发行版，如Red Hat的OpenShift或VMWare的Tanzu，并部署到公共云。或者，我们可以利用<strong class="ke ir">公共云的本地Kubernetes服务</strong>。</p><h2 id="0623" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">有什么区别？</strong></h2><p id="3f6a" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">Opensource、OpenShift和Tanzu为您提供了构建和管理Kubernetes集群的最终控制权，由您来安装、管理和维护构成Kubernetes的平台和基础设施中的所有组件。您负责管理计算(服务器)、控制平面(运行Kubernetes集群所需的核心服务)、网络和存储。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/a5e4272cc35cafdf7e4518c742117d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l2h3LdMeD_WJC8Bv"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">云上自我管理的Kubernetes</figcaption></figure><p id="3042" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第二个选择是使用公共云Kubernetes服务。最大的区别是，云提供商将管理和运行Kubernetes基础设施，而您只需要使用Kubernetes来部署和运行您的容器工作负载。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/bc54e1bfacd1a86a141ff68e34a6764d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5N1vSzU_wXtOvd0q"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">公共云托管的Kubernetes服务</figcaption></figure><blockquote class="mf mg mh"><p id="86e7" class="kc kd mi ke b kf kg kh ki kj kk kl km mj ko kp kq mk ks kt ku ml kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="iq">安全性和合规性被视为公共云中的共同责任</em> </strong></p></blockquote><p id="6ec3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在使用AKS/EKS/GKE这样的托管服务时，安全性和合规性被视为共同的责任。一般来说，云提供商负责“云”的安全性，而您负责“云中”的安全性。</p><p id="1b1d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公共云提供商负责管理Kubernetes控制平面。这包括Kubernetes masters、ETCD数据库以及提供安全可靠服务所需的其他基础设施。作为公共云Kubernetes服务的消费者，您在很大程度上负责其他一切，例如IAM、pod安全、运行时安全、网络安全等等。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/5fa19ce344457271dc020ac653cd1c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3CkUG7eqap6rc4z4"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae ly" href="https://aws.amazon.com/compliance/shared-responsibility-model/" rel="noopener ugc nofollow" target="_blank"> AWS共享责任模式</a></figcaption></figure><p id="93c8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这里看看一篇关于共担责任的很棒的文章:<a class="ae ly" href="https://www.appvia.io/blog/shared-responsibility-model-cloud-security" rel="noopener ugc nofollow" target="_blank">https://www . app via . io/blog/shared-respons ibility-model-cloud-security</a></p><h1 id="8078" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">第2部分—分解在考虑公共云Kubernetes的安全性时应该注意的核心领域</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/341c016d3b08e4d3c4a8c74d91387805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*fZjizwcBEj7PRCm7.png"/></div></figure><h1 id="b79d" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">API服务器</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/66fac8017ca2714699c2d920429522db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QcIrsqdHgXOmLgDN4nsP1g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">API服务器</figcaption></figure><p id="0028" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">API服务器提供了专门用于管理Kubernetes集群的入口点。API服务器端点通过公共云IAM和RBAC Kubernetes得到保护，但是，如果配置不正确，它<strong class="ke ir">对互联网</strong>开放，因此会成为攻击媒介。</p><ul class=""><li id="7a24" class="ng nh iq ke b kf kg kj kk kn ni kr nj kv nk kz nl nm nn no bi translated"><em class="mi">通过使用私有集群或IP白名单和黑名单来保护API服务器端点。</em></li><li id="71ae" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">通过有效的IAM控制保护对API服务器的访问。</em></li><li id="551d" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">在集群RBAC控制中定义有效的职责分离。</em></li></ul><h2 id="62eb" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">微软AKS </strong></h2><p id="0373" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">通过Azure AD IAM控件保护API服务器。</p><ul class=""><li id="5eed" class="ng nh iq ke b kf kg kj kk kn ni kr nj kv nk kz nl nm nn no bi translated"><em class="mi">使用IP白名单限制。</em></li><li id="fcb2" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster" rel="noopener ugc nofollow" target="_blank"> <em class="mi">集群安全最佳实践和</em> </a> <a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster" rel="noopener ugc nofollow" target="_blank"> <em class="mi">升级</em> </a></li></ul><h2 id="7341" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">谷歌GKE </strong></h2><ul class=""><li id="f33d" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">通过私有集群保护API服务器。</em></li><li id="b0a2" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">禁用公共端点。</em></li><li id="04aa" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">使用IP白名单限制。</em></li><li id="c925" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster" rel="noopener ugc nofollow" target="_blank"> <em class="mi">强化集群的安全性</em> </a></li></ul><h2 id="0c13" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">亚马逊EKS </strong></h2><ul class=""><li id="ae38" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">通过私有集群保护API服务器。</em></li><li id="6ff7" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">禁用公共端点。</em></li><li id="9415" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi">集群端点访问控制</em> </a></li></ul><h1 id="1d7f" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">ETCD</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/0ff0a1c24abfdbb458e8999a5ba8ea3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LX9bMC4ljSsSpd8oxcy9Xg.png"/></div></div></figure><p id="4e3f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ETCD是一个分布式数据存储，其中包含集群数据，包括Kubernetes secrets，这是一种机制，通过它可以将用户证书、密码或API密钥等敏感数据提供给容器。</p><p id="6970" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">AK、EKS和GKE都为ETCD提供静态加密来保护存储的信息，然而，Kubernetes的秘密在默认情况下只进行base64编码(明文)。</p><ul class=""><li id="2a2c" class="ng nh iq ke b kf kg kj kk kn ni kr nj kv nk kz nl nm nn no bi translated"><em class="mi"> Kubernetes的秘密对同一名称空间内的</em> <strong class="ke ir"> <em class="mi">所有pod</em></strong><em class="mi">可用。</em></li><li id="14f8" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">默认情况下，密码将以明文形式(base 64编码)装入pod。</em></li><li id="3282" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">通过加密秘密和轮换证书来保护敏感信息</em></li><li id="f496" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">使用公共云加密服务(例如AWS KMS、Azure Key Vault)。</em></li><li id="1f8a" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">使用第三方机密管理工具(例如Hashicorp Vault)。</em></li></ul><h2 id="106e" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">谷歌GKE </strong></h2><ul class=""><li id="8d11" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">静态加密的秘密(默认)。</em></li><li id="3c9f" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">建议使用第三方保险库或应用级机密加密。</em></li><li id="8dd1" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets" rel="noopener ugc nofollow" target="_blank"> <em class="mi">在应用层加密秘密</em> </a></li></ul><h2 id="29b1" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">微软AKS </strong></h2><ul class=""><li id="8a5a" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">机密在静态时加密(默认)。</em></li><li id="663b" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">推荐Azure Key Vault。</em></li><li id="3a5e" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.microsoft.com/en-us/azure/aks/developer-best-practices-pod-security" rel="noopener ugc nofollow" target="_blank"><em class="mi">pod安全的最佳实践</em> </a></li></ul><h2 id="dacc" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">亚马逊EKS </strong></h2><ul class=""><li id="1940" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">静态加密的秘密(取决于ETCD存储，需要配置)。</em></li><li id="cb78" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">可配置秘密审计(当秘密被推送到云监控时)。</em></li><li id="24c5" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://aws.github.io/aws-eks-best-practices/security/docs/data/" rel="noopener ugc nofollow" target="_blank"> <em class="mi">数据加密和机密管理</em> </a></li></ul><h1 id="bb96" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">网络</h1><h1 id="2c58" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">控制平面网络/工人网络</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/724417b586fd9431a671500f5d8bec79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwgwjFNnXs7AZWLKVzxL8A.png"/></div></div></figure><p id="703d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通常，公共云Kubernetes中的控制平面运行在独立于工作节点(运行应用程序的地方)的网络中。作为服务的消费者，您无法访问由云提供商管理和保护的控制平面网络。</p><p id="8727" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">保护集群时，必须考虑两个网络之间的接入点。提供商有不同的机制来缩小安全差距:</p><h2 id="6fa9" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">微软AKS </strong></h2><ul class=""><li id="22e9" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi"> AKS为工作节点的公共和私有端点提供与控制平面通信的能力。当使用公共端点或私有接口来保持VPN内的通信时，AKS还提供IP和CIDR地址白名单和黑名单。</em></li><li id="e379" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">使用网络安全组。</em></li><li id="53fb" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.microsoft.com/en-us/azure/aks/concepts-security#network-security" rel="noopener ugc nofollow" target="_blank"> <em class="mi">应用和集群的安全概念</em> </a></li></ul><h2 id="2e86" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">亚马逊EKS </strong></h2><ul class=""><li id="0017" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">使用</em> <a class="ae ly" href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> AWS VPC安全组</em> </a> <em class="mi">来控制Kubernetes控制平面和集群的工作节点之间的流量。</em></li><li id="4bb5" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://aws.github.io/aws-eks-best-practices/security/docs/network/" rel="noopener ugc nofollow" target="_blank"> <em class="mi">网络安全</em> </a></li></ul><h2 id="ae58" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak"> <em class="nz">谷歌GKE </em> </strong></h2><ul class=""><li id="5da9" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">添加</em> <a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks" rel="noopener ugc nofollow" target="_blank"> <em class="mi">授权网络</em> </a> <em class="mi">，使用IP地址白名单。</em></li></ul><h1 id="78a1" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">pod网络的网络策略</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/3816d26c5c4bbf313292947d1f9299f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pE14pBm1MvP_ak475vnx0w.png"/></div></div></figure><p id="be69" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">默认情况下，Kubernetes集群中的所有pod可以自由地与其他pod通信。这带来了来自集群内运行的应用程序的内部攻击的巨大威胁。</p><p id="ad0a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">应该通过集群中存在的网络安全结构来缓解这些威胁。网络策略是Kubernetes资源，用于控制pod和/或网络端点之间的流量，以及控制pod和名称空间之间的数据进出。</p><h2 id="1646" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">微软AKS </strong></h2><ul class=""><li id="c3b7" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">建议使用Calico网络提供商来启用网络策略。</em></li><li id="0439" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.microsoft.com/en-us/azure/aks/concepts-security#network-security" rel="noopener ugc nofollow" target="_blank"> <em class="mi">网络安全</em> </a></li></ul><h2 id="e127" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">亚马逊EKS </strong></h2><ul class=""><li id="ce26" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">建议使用Calico网络提供商来启用网络策略。</em></li><li id="b1b9" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://aws.github.io/aws-eks-best-practices/security/docs/network/" rel="noopener ugc nofollow" target="_blank"> <em class="mi">网络安全</em> </a></li></ul><h2 id="5945" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">谷歌GKE </strong></h2><ul class=""><li id="dfab" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">使用GKE数据面板V2时，网络策略自动启用。</em></li><li id="cfed" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_with_network_policy" rel="noopener ugc nofollow" target="_blank"> <em class="mi">用网络策略限制pod之间的流量</em> </a></li></ul><h1 id="43d7" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">虚拟机(节点)、操作系统和容器运行时</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/ad9f5f72c9253ce04d6e98c6e114273a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1oVP0Y1DJTkzQ5DfLtCHw.png"/></div></div></figure><p id="87c4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Kubernetes集群中的应用程序运行在称为节点的虚拟服务器的容器中。该节点拥有主机操作系统和容器运行时(运行容器)。这两个组件都需要在您的Kubernetes安全态势中加以关注，因为主机中的漏洞会危及您在那里运行的一切，包括Kubernetes和其中的工作负载。</p><p id="b730" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公共云提供商在缓解这一级别的安全漏洞方面做了大量工作，包括针对主机操作系统运行CIS基准测试，以及定期修补和更新。但是，作为最终用户，您仍然有责任确保您采用了云补丁和升级。</p><h2 id="8ecb" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">微软AKS </strong></h2><ul class=""><li id="6bc6" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">使用针对Linux或Windows 2019优化的Ubuntu(受管节点)。</em></li><li id="6098" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">默认为Containerd，Docker为选项。</em></li><li id="d352" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.microsoft.com/en-us/azure/aks/concepts-security#node-security" rel="noopener ugc nofollow" target="_blank"> <em class="mi">节点安全</em> </a></li></ul><h2 id="edf7" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">亚马逊EKS </strong></h2><ul class=""><li id="a839" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">受管节点或自管节点有不同的安全考虑—查看文档。</em></li><li id="de67" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">EKS 1.23中的默认容器。</em></li><li id="8971" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.aws.amazon.com/eks/latest/userguide/eks-compute.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> EKS节点</em> </a></li></ul><h2 id="21b0" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">谷歌GKE </strong></h2><ul class=""><li id="f7f1" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">使用屏蔽GKE节点。</em></li><li id="a75e" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">默认为Containerd。</em></li><li id="66a3" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#container_node_choices" rel="noopener ugc nofollow" target="_blank"> <em class="mi">集装箱节点选择</em> </a></li></ul><h1 id="3620" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">操作系统</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/974ba97509f40285bb957e929a0e6c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7VIPklBX5MiuEOo6otxyZQ.png"/></div></div></figure><p id="04b1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公共云Kubernetes服务在创建集群时允许各种各样的节点选项，从Windows到Linux主机，以及容器运行时优化的操作系统。为您的节点选择正确的操作系统包括了解持续的安全修补策略。</p><blockquote class="mf mg mh"><p id="fc00" class="kc kd mi ke b kf kg kh ki kj kk kl km mj ko kp kq mk ks kt ku ml kw kx ky kz ij bi translated"><strong class="ke ir">“了解公共云修补策略的差异”</strong></p></blockquote><h2 id="deaf" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">修补和更新</h2><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/5320702d569624c8d18b817e4f908845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JNu_dmew9-taLWDoQUtBFg.png"/></div></div></figure><p id="a0f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">不同的云提供商有不同的方法来修补和更新其产品中的操作系统和容器运行时。</p><p id="b8f8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一般来说，如果您使用“自我管理”的虚拟机作为主机，那么您需要负责修补和升级。如果您使用提供商管理的虚拟机，则会自动应用部分或全部修补和升级流程。</p><p id="d49e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以做几件事情来强化自己提供的节点映像，比如删除包管理器、拥有只读文件系统等等。最好的指导是与操作系统提供商一起加强映像。</p><h2 id="ffd9" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">微软AKS </strong></h2><ul class=""><li id="8412" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">微软安全策略每晚自动向所有节点应用操作系统补丁，但是，需要节点重启的补丁不会强制节点重启，必须手动处理。</em></li><li id="3727" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">补丁映像每周提供一次，没有新补丁的自动警报，但Azure服务健康可用于识别新的安全补丁版本:</em> <a class="ae ly" href="https://docs.microsoft.com/en-us/azure/service-health/service-health-overview" rel="noopener ugc nofollow" target="_blank"> <em class="mi">微软服务健康概述</em> </a></li><li id="88d2" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.microsoft.com/en-us/azure/aks/node-updates-kured" rel="noopener ugc nofollow" target="_blank"> <em class="mi">对Linux节点应用安全和内核更新</em> </a></li></ul><h2 id="0980" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">亚马逊EKS </strong></h2><ul class=""><li id="244c" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi"> AWS为您提供了打了补丁的AMI版本，您必须通过升级集群中的节点组来手动应用这些版本。</em></li><li id="073d" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">由自动化流程处理的自动化节点更新(扩展、清空和更新)流程。</em></li><li id="c24e" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">没有自动补丁通知，但是补丁发布会发布到</em> <a class="ae ly" href="https://github.com/awslabs/amazon-eks-ami/releases.atom" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> rss订阅频道</em> </a></li><li id="f399" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.aws.amazon.com/eks/latest/userguide/managed-node-update-behavior.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi">托管节点更新行为</em> </a></li><li id="1eb6" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://docs.aws.amazon.com/eks/latest/userguide/update-managed-node-group.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi">更新被管节点组</em> </a></li><li id="5a49" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://aws.amazon.com/bottlerocket/" rel="noopener ugc nofollow" target="_blank"><em class="mi">AWS bottle rocket</em></a><em class="mi">(专为运行最小操作系统的容器而创建，因此攻击向量更小)是更安全节点的一个选项。</em></li></ul><h2 id="6cf1" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated"><strong class="ak">谷歌GKE </strong></h2><ul class=""><li id="c7df" class="ng nh iq ke b kf lt kj lu kn nu kr nv kv nw kz nl nm nn no bi translated"><em class="mi">提供用于应用补丁或升级的更新节点映像。客户可以订阅更新频道以自动将节点升级到最新版本，也可以手动申请。</em></li><li id="e6e7" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi"> GKE向发布/订阅渠道发布升级通知:</em> <a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-upgrades" rel="noopener ugc nofollow" target="_blank"> <em class="mi">自动升级节点</em> </a></li><li id="5e1f" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><a class="ae ly" href="https://cloud.google.com/kubernetes-engine/docs/resources/security-patching" rel="noopener ugc nofollow" target="_blank"> <em class="mi">安全补丁</em> </a></li></ul><blockquote class="mf mg mh"><p id="75e3" class="kc kd mi ke b kf kg kh ki kj kk kl km mj ko kp kq mk ks kt ku ml kw kx ky kz ij bi translated"><strong class="ke ir">安全是共同的责任】</strong></p></blockquote><p id="eef8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在处理节点安全和修补工作时，共同责任是最重要的。您必须了解您的云提供商用于安全补丁和更新的方法，并确保有适当的流程来审查和应用正确的流程，以保持节点安全性最新。</p><h1 id="cba8" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">工作量</h1><h1 id="9441" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">保护容器和部署</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/74503edb2f5fb184d636d00ab4f84eb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NIe7wKCXnx4yJEUg5zwUtA.png"/></div></div></figure><p id="c617" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">容器和容器工作负载的安全性是一个很大的主题，有许多含义，不在本文的讨论范围之内。但是，您应该知道在保护系统和数据方面需要解决的问题。</p><p id="fd2f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要考虑的一个重要方面是供应链的安全。</p><h1 id="b95d" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">集装箱特定安全性</h1><p id="6858" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">保护容器工作负载始于容器如何与容器运行时接口，从而与底层工作节点和网络接口。容器带来了许多安全问题，必须通过应用基于策略的保护来解决。</p><h1 id="5b66" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">最小特权</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/37a0471163bb32dc1ad3734192fa4dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*end9Z_4yNbBhkTgNpcC1Ag.png"/></div></div></figure><p id="9d79" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">必须创建应用程序容器，以仅公开执行容器角色所需的服务和组件。此外，必须制定策略来拒绝容器运行时交互的某些方面，例如:</p><ul class=""><li id="73e4" class="ng nh iq ke b kf kg kj kk kn ni kr nj kv nk kz nl nm nn no bi translated">不允许“特权容器”</li><li id="46d0" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated">特权容器可以进入worker节点的根，从而进入Kubernetes集群的任何部分。</li><li id="e80c" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated">限制用户id</li><li id="d534" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated">限制容器内正在执行的流程的用户(userid ),例如，不允许root用户执行容器内的流程。</li><li id="e70c" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated">限制网络、文件系统和命名空间访问</li><li id="f43d" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated">容器不应该具有访问主机文件系统或网络的能力。</li></ul><p id="9e84" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上面的列表只是一个选择，它给出了容器安全的重要性以及需要创建策略来保护和保障的地方。</p><p id="f3e1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Kubernetes在1.21中弃用了Pod安全策略，并将在1.25中完全删除(2022年4月)。Pod安全策略是用于定义上述pod和OS级安全限制策略的核心功能。请注意您现有的解决方案是否利用了这一点。看看这些博客，了解更多关于这背后的基本原理和替代工具的信息:<br/> <a class="ae ly" href="https://www.appvia.io/blog/podsecuritypolicy-is-dead-long-live" rel="noopener ugc nofollow" target="_blank"> PodSecurityPolicy已死。万岁…？</a></p><p id="ea41" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.appvia.io/blog/policy-as-versioned-code" rel="noopener ugc nofollow" target="_blank">版本化政策代码</a></p><p id="f1e9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.appvia.io/blog/how-to-use-the-security-profiles-operator" rel="noopener ugc nofollow" target="_blank">如何使用安全配置文件操作符</a></p><h2 id="eb43" class="la lb iq bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">集装箱供应链</h2><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/cebe766ea9387a0f1c40e8c11fff525b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rr3Vt6cJdZs2U2EX_CQoTA.png"/></div></div></figure><p id="baa5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">容器无处不在所催生的一个领域是软件供应链安全。容器打包格式的一个特征是允许软件被分解成“层”,这些层可能来自其他来源，例如第三方软件提供商。分层软件方法在识别软件“层”中包含什么以及应用了什么安全控制缓解措施方面提出了挑战。</p><p id="0e3f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此外，基本容器映像可能来自公共存储库，其中软件层的内容未知，很有可能嵌入恶意软件。</p><p id="8656" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在您的软件交付过程中必须小心谨慎，以确保开发中使用的<strong class="ke ir">容器映像来自可信来源，并且已经过映像扫描</strong>，以确保容器中使用的软件版本具有最新的补丁和已识别的易受攻击的映像层。</p><p id="8cc1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要考虑的一个重要方面是内部容器构建标识。作为标签的版本号有利于识别，但不足以确保容器中的内容就是您所期望的。看看如何使用SHA校验和来确保映像与预期的一样。此外，看看图像签名，它可以让您更加确信图像与签名时完全相同。</p><p id="113e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">供应链问题将在本博客中进一步讨论:</p><p id="087b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.appvia.io/blog/tutorial-keyless-sign-and-verify-your-container-images" rel="noopener ugc nofollow" target="_blank">教程:用cosign </a>无钥匙签名并验证你的容器图像</p><h1 id="3f4d" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">应用程序对集群的访问</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/3c99597d991365eef70b12630dae393d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rllf2BLBB2ACq9VNKxk3gQ.png"/></div></div></figure><p id="f164" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">需要公开公共端点的公共云Kubernetes应用程序有几种选择。通常这些分为三个方面:</p><ul class=""><li id="0e5e" class="ng nh iq ke b kf kg kj kk kn ni kr nj kv nk kz nl nm nn no bi translated"><em class="mi">入口</em></li><li id="4d16" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">节点端口</em></li><li id="0f9b" class="ng nh iq ke b kf np kj nq kn nr kr ns kv nt kz nl nm nn no bi translated"><em class="mi">负载平衡器</em></li></ul><h1 id="eda0" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">Kubernetes入口</h1><p id="793c" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">Kubernetes入口配置有两个对象:入口控制器和入口对象。</p><p id="022d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">入口控制器是一个软件，它为Kubernetes服务提供反向代理、可配置的流量路由和TLS终端。Kubernetes入口资源用于为各个Kubernetes服务配置入口规则和路由。使用入口控制器和入口规则，可以使用单个IP地址将流量路由到Kubernetes集群中的多个服务。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9bbe70ab6c222495e1a2db19a7be7e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*f5PNA77r_sxNhD3a.png"/></div></figure><h1 id="604d" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">节点端口</h1><p id="a685" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">在底层节点上创建端口映射，允许使用节点IP地址和端口直接访问应用程序。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/990ba8b95ff95a661b51bdaeec9bae6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*y4ZNWxlsARuJhUmd.png"/></div></figure><h1 id="1676" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">负载平衡器</h1><p id="e703" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">使用负载平衡器资源，该资源具有连接到所请求的pod的外部IP地址。为了允许客户的流量到达应用程序，在所需的端口上创建负载平衡规则。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/11b5f8587f84fe57fc8692b7321b00a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*wwwQbmFcmibviux8.png"/></div></figure><h1 id="db6a" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">安全是一项共同责任</h1><p id="e2d7" class="pw-post-body-paragraph kc kd iq ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz ij bi translated">公共云Kubernetes提供商通常将入口的安全问题交还给用户。由您来配置入口控制器、证书和策略，以确保从外部访问您的服务。应制定足够的策略和流程来识别可能造成安全威胁的错误配置的入口。</p><p id="dad9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">看看这篇关于TLS在EKS的入口的博文:</p><p id="38c5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.appvia.io/blog/expose-kubernetes-service-eks-dns-tls" rel="noopener ugc nofollow" target="_blank">教程:如何使用DNS和TLS在EKS上公开Kubernetes服务</a></p><h1 id="6639" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">集装箱登记处</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/c28f29e8d8c719f06145ef205132cec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5VkXu71PljvX-2ifAhUuXQ.png"/></div></div></figure><p id="ebec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">默认情况下，Kubernetes可以从任何目的地获取Pod规范中定义的容器图像，只要它可以从节点到达。这带来了用户(授权或未授权)可能意外或恶意指定从不可信来源运行的图像的风险，这可能对平台和相邻服务造成直接损害，导致数据泄漏，并增加托管和审计成本。</p><p id="5ef8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">采用集群级映像策略控制可显著降低这种风险，并可通过使用自定义准入控制器(即OpenPolicyAgent Gatekeeper)来实现。</p><p id="90ef" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">做什么:</p><ul class=""><li id="b21c" class="ng nh iq ke b kf kg kj kk kn ni kr nj kv nk kz nl nm nn no bi translated">仅允许从受信任的存储库中提取图像。始终引用图像标签和摘要(例如，通过使用<a class="ae ly" href="https://github.com/open-policy-agent/gatekeeper-library/tree/master/library/general/allowedrepos" rel="noopener ugc nofollow" target="_blank"> OPA看门人</a>)。</li></ul><p id="9652" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">看看下面这篇关于验证集装箱供应链的博客。Appvia Wayfinder还实现了一个自定义准入控制器，该控制器提供可信存储库的策略实施:</p><p id="4e08" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae ly" href="https://www.appvia.io/blog/5-things-to-improve-your-kubernetes-security-posture" rel="noopener ugc nofollow" target="_blank">改善Kubernetes安全状况的5件事</a></p><h1 id="59a7" class="mn lb iq bd lc mo mp mq lf mr ms mt li mu mv mw ll mx my mz lo na nb nc lr nd bi translated">摘要</h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/2cecc250e58494f544317d8eefe9dbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNRj-i5pKpQrJ2qtPXf40g.png"/></div></div></figure><p id="b722" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">希望这已经给出了在考虑将公共云Kubernetes作为交付应用程序的工具时，您需要了解的大多数安全领域的合理的高层次说明。我提到的每一个领域都有更详细的保护内容和保护方式，但是现在您应该对投入时间的范围有所了解。</p><p id="8c6c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Kubernetes和containers是一组很棒的技术，可以用更简单、更标准化的方式构建可伸缩的应用程序。是的，它仍然很复杂，但是比构建过去的雪花基础设施和架构要简单得多。设计一个经过深思熟虑的安全态势需要您了解移动部件，因为任何这些部件的错误配置都可能导致您组织的数据易受攻击。</p><p id="a30e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在<a class="ae ly" href="http://www.appvia.io" rel="noopener ugc nofollow" target="_blank"> Appvia.io </a>这里，我们有专注于为公共云Kubernetes提供安全防护和基于策略的合规性的产品和服务。<a class="ae ly" href="https://www.appvia.io/wayfinder" rel="noopener ugc nofollow" target="_blank"> Appvia Wayfinder </a>让您安心合规地解决您的安全问题。看一看我们的so</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to View Kubernetes Pod Logs With Kubectl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Kubectl查看Kubernetes Pod日志</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-view-kubernetes-pod-logs-with-kubectl-e60b284102c1?source=collection_archive---------3-----------------------#2022-11-08">https://itnext.io/how-to-view-kubernetes-pod-logs-with-kubectl-e60b284102c1?source=collection_archive---------3-----------------------#2022-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="68f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查看Kubernetes (K8S)中的日志对于排除故障和了解集群的各个组件中发生的事情非常重要。在本文中，我们将关注如何使用<code class="fe ko kp kq kr b">kubectl logs</code>命令行工具查看pod日志。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/16b6da6cf954600c95fb57aec4d8f541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3fJLytm-Jzd0OX2HZUE7vw.jpeg"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">乔纳斯·史密斯在<a class="ae li" href="https://unsplash.com/s/photos/container?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="f4f8" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">什么是kubectl？</h2><p id="0b92" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><code class="fe ko kp kq kr b">kubectl</code>是一个命令行工具，允许您对K8S集群运行命令。您可以使用<code class="fe ko kp kq kr b">kubectl</code>来部署应用程序、检查和管理集群资源以及查看日志。</p><h2 id="0439" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">设置kubectl别名</h2><p id="f056" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">使用<code class="fe ko kp kq kr b">kubectl</code>时，多次输入会很快变得令人厌烦。为了缩短这个时间，你可以设置一个别名(如果你考虑参加Kubernetes管理员(CKA)认证考试，时间很紧，强烈建议你设置一个别名以节省时间！).下面的例子设置了一个名为<code class="fe ko kp kq kr b">k</code>的别名，因此所有以后的命令都是针对名为‘my-namespace’的名称空间运行的。</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="9cd7" class="lj lk it kr b gy ml mm l mn mo">alias k="kubectl --namespace my-namespace"</span><span id="ce7b" class="lj lk it kr b gy mp mm l mn mo">k logs</span></pre></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h2 id="4713" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">Kubectl日志命令快速参考</h2><ol class=""><li id="6724" class="mx my it js b jt mc jx md kb mz kf na kj nb kn nc nd ne nf bi translated">打印pod的日志</li></ol><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="b382" class="lj lk it kr b gy ml mm l mn mo">kubectl logs &lt;pod_name&gt;</span></pre><p id="b7bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.打印pod最近6小时的日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="c46a" class="lj lk it kr b gy ml mm l mn mo">kubectl logs --since=6h &lt;pod_name&gt;</span></pre><p id="ac82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.获取pod的最近50行日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="c44e" class="lj lk it kr b gy ml mm l mn mo">kubectl logs --tail=50 &lt;pod_name&gt;</span></pre><p id="7db9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.打印pod的日志并跟踪新日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="a9ec" class="lj lk it kr b gy ml mm l mn mo">kubectl logs -f &lt;pod_name&gt;</span></pre><p id="c41d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.打印pod中容器的日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="aa7d" class="lj lk it kr b gy ml mm l mn mo">kubectl logs -c &lt;container_name&gt; &lt;pod_name&gt;</span></pre><p id="1b47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.将pod的日志输出到名为“pod.log”的文件中</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="9228" class="lj lk it kr b gy ml mm l mn mo">kubectl logs &lt;pod_name&gt; &gt; pod.log</span></pre><p id="f5ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">7.查看以前出现故障的pod的日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="74f9" class="lj lk it kr b gy ml mm l mn mo">kubectl logs --previous &lt;pod_name&gt;</span></pre><p id="6f5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">8.查看pod中所有容器的日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="fbbb" class="lj lk it kr b gy ml mm l mn mo">kubectl logs <!-- -->&lt;pod_name&gt;<!-- --> --all-containers</span></pre></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h2 id="581e" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">Kubectl记录带有示例的命令参考</h2><p id="81e0" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">您可以使用<code class="fe ko kp kq kr b">kubectl get pods</code>命令查看集群上的窗格。如果您的pod在默认名称空间之外运行，请添加<code class="fe ko kp kq kr b">--namespace &lt;namespace name&gt;</code>标志。通过添加<code class="fe ko kp kq kr b">&lt;my-label&gt;=&lt;my-value&gt;</code>，您还可以根据需要使用标签来过滤结果。</p><p id="03e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在我的Azure Kubernetes服务(AKS)集群上运行了以下pods:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ng"><img src="../Images/2e268cae7e074f60a9f4fbe244d31b21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gv5TAkSk1hazZF9wovknnQ.png"/></div></div></figure><p id="7809" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">kubectl logs</code>显示来自容器的标准输出和错误流的日志。如果您正在为容器配置日志记录，您将需要确保输出被写入这些输出，以便通过以下命令正确显示。</p><ol class=""><li id="88ca" class="mx my it js b jt ju jx jy kb nh kf ni kj nj kn nc nd ne nf bi translated">我对名为redis-master-f46ff57fd-qmrd7的redis-master pod的日志感兴趣。</li></ol><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="2358" class="lj lk it kr b gy ml mm l mn mo">kubectl logs redis-master-f46ff57fd-qmrd7</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nk"><img src="../Images/efb2739c0a6fb238f3e76b397e5b9643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kViuapg4KAmNetYrQgMyg.png"/></div></div></figure><p id="9e0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于我的pod刚刚启动，我可以看到pod启动时创建的日志。这显示了pod中的所有日志。</p><p id="fac9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.打印pod kubectl日志的最后10分钟的日志—since = 10m redis-master-f 46 ff 57 FD-qmrd 7。</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="1ce1" class="lj lk it kr b gy ml mm l mn mo">kubectl logs --since=10m redis-master-f46ff57fd-qmrd7</span></pre><p id="ef99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">没有显示任何内容，因为在过去10分钟内没有生成任何日志！将时间更改为15分钟显示了所有日志。</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="67dd" class="lj lk it kr b gy ml mm l mn mo">kubectl logs --since=15m redis-master-f46ff57fd-qmrd7</span></pre><p id="9a4c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.要仅查看日志的最后5行:</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="5e77" class="lj lk it kr b gy ml mm l mn mo">kubectl logs redis-master-f46ff57fd-qmrd7 --tail 5</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nl"><img src="../Images/942e2379661b70f728ba19d7e6a48b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_eknuNl-mW-nCr1F2ibQw.png"/></div></div></figure><p id="abb9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.我想关注我添加的任何新日志<code class="fe ko kp kq kr b">-f</code></p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="c5c1" class="lj lk it kr b gy ml mm l mn mo">kubectl logs -f redis-master-f46ff57fd-qmrd7</span></pre><p id="7471" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">日志显示在示例1中，任何新生成的日志将持续流动并自动显示在我的终端中，直到我退出(例如，在Windows PowerShell中使用CTRL+C)。</p><p id="d55f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.现在我想在redis-master-f46ff57fd-qmrd7中打印一个容器的日志。我首先需要使用<code class="fe ko kp kq kr b">kubectl describe</code>命令查看哪些容器正在pod中运行:</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="1519" class="lj lk it kr b gy ml mm l mn mo">kubectl describe pod redis-master-f46ff57fd-qmrd7</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nm"><img src="../Images/81b3aeaf583185e9a4e4995fa1cb4c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYBWaTtargp2zIrl3ZLvBQ.png"/></div></div></figure><p id="4395" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这显示了一个名为master的容器。</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="fa67" class="lj lk it kr b gy ml mm l mn mo">kubectl logs -c master redis-master-f46ff57fd-qmrd7</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nn"><img src="../Images/e7ba13252a80b0d155ef79ed2b340dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKVXc_s4yuXWh9F31CAhYg.png"/></div></div></figure><p id="c6a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.现在让我们将一个pod的日志输出到一个名为“pod.log”的文件中</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="e31d" class="lj lk it kr b gy ml mm l mn mo">kubectl logs redis-master-f46ff57fd-qmrd7 &gt;&gt; pod.log</span></pre><p id="02b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<code class="fe ko kp kq kr b">cat</code>查看日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="9196" class="lj lk it kr b gy ml mm l mn mo">cat .\pod.log</span></pre><p id="d109" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">7.查看以前出现故障的pod的日志</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="2e71" class="lj lk it kr b gy ml mm l mn mo">kubectl logs --previous redis-master-f46ff57fd-qmrd7</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi no"><img src="../Images/14983b9e545786943de411478634b12d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v0Mbc_NWHazrx2Uu40L1IQ.png"/></div></div></figure><p id="112d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我看到一个错误，确认pod中以前的容器没有被终止。</p><p id="1b52" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">8.如果我有多个容器，我可以使用<code class="fe ko kp kq kr b">--all-containers</code>标志查看所有容器的日志。</p><pre class="kt ku kv kw gt mh kr mi mj aw mk bi"><span id="f67c" class="lj lk it kr b gy ml mm l mn mo">kubectl logs <!-- -->&lt;pod_name&gt;<!-- --> --all-containers</span></pre></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h2 id="df06" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">摘要</h2><p id="7abc" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><code class="fe ko kp kq kr b">kubectl logs</code>命令使您能够从您的资源中访问日志。在本文中，我们重点介绍了一些从pod获取日志的示例。</p><p id="bf7f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如图所示，您可以查看当前日志，不断将新的pod日志流式传输到您的终端，并使用不同的命令选项从以前终止的pod访问日志。Kubectl从容器的标准输出和错误流中收集日志。</p><p id="d90c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">想要更多Kubernetes内容？在这里查看我在K8S <a class="ae li" href="https://jackwesleyroper.medium.com/kubernetes-k8s-related-articles-index-54718769e390" rel="noopener">上的其他文章</a>！</p><p id="c2b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">干杯！🍻</p><div class="np nq gp gr nr ns"><a href="https://www.buymeacoffee.com/jackwesleyroper" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">Jack Roper正在Azure、Azure DevOps、Terraform、Kubernetes和Cloud tech上写博客！</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">希望我的博客能帮到你，你会喜欢它的内容！我真的很喜欢写技术内容和分享…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og lc ns"/></div></div></a></div><p id="d90b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="oh">最初发表于</em><a class="ae li" href="https://spacelift.io/" rel="noopener ugc nofollow" target="_blank"><em class="oh">space lift . io</em></a><em class="oh">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>New formatting concept for JSON based virtual DOM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于JSON的虚拟DOM的新格式化概念</h1>
<blockquote>原文：<a href="https://itnext.io/new-formatting-concept-for-json-based-virtual-dom-ee52acc5e04a?source=collection_archive---------1-----------------------#2021-05-01">https://itnext.io/new-formatting-concept-for-json-based-virtual-dom-ee52acc5e04a?source=collection_archive---------1-----------------------#2021-05-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5680" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我在2001年(jQuery之前→ 2006年)第一次钻研Javascript时，有这样一个概念:</p><p id="7918" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“不要将html和Javascript混合使用”</p><p id="7220" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像jQuery或Wordpress这样的例子已经向我们展示了如果你把代码混合到一个极限，代码会变得多么糟糕。</p><p id="054b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">React和JSX的结合向我们展示了它可以以一种没问题的方式完成，所以这个概念今天不再适用。</p><p id="eca4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，这个概念的含义是不同的:</p><p id="521d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">“不要把逻辑和你的标记混在一起”</strong></p><p id="1d3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我看来，这是大多数前端开发人员最近已经忘记的事情，是时候敲响警钟了。</p><h1 id="34f2" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">内容</h1><ol class=""><li id="6f4e" class="lj lk iq jp b jq ll ju lm jy ln kc lo kg lp kk lq lr ls lt bi translated">问题1:标记中的逻辑</li><li id="84ef" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">问题2:范围界定</li><li id="cbce" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">使用基于JSON的vdom的优势</li><li id="eeb9" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">基于JSON的vdom有什么问题？</li><li id="ac4b" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">新的格式化概念</li><li id="26cf" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">更复杂的格式更改示例</li><li id="b018" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">在行动中体验好处！</li></ol><h1 id="3bc5" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">问题1:标记中的逻辑</h1><p id="6c63" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">查看React主页:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/ca627b1eeb4f3131c6b63bbd9f8e6b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*vlQD85KALu9YVjW4kahOcw.png"/></div></div></figure><p id="ca78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会说这不是真正的XML，所以让我们使用术语标记。</p><p id="e0cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">if / else语句不属于此处。循环也是如此。</p><p id="6599" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Javascript不擅长编辑“字符串”。在运行时动态改变模板可能很棘手，尤其是当组件变得越来越复杂时。</p><h1 id="2caf" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">2.问题2:范围界定</h1><p id="9e01" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">可能每个前端开发人员都遇到过“这种情况”，非常确切。你在你的标记中使用了一个类fn，但是你的作用域并不总是清晰的。</p><p id="cda2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次查看React主页:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/be22bf7b31164ad6dcaea71352a6ef70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*QpNVgblTbVu8Nr0NDZ1Xsg.png"/></div></figure><p id="e23f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">公共类字段在构造函数中得到应用。如果您滥用它们来定义函数，每个实例都将得到自己的副本。这很昂贵，而且与类应该如何工作没有什么关系:在原型级别应用方法。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/6368c0c29a343636345afbfc0862ecca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*uz450_SYBGBu3yq8zES5YQ.png"/></div></figure><p id="c50d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">肯定更好，但仍然是一个包装器，只是为了让您的范围到位。</p><p id="0cac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你选择基于JSON的vdom，这些问题就不存在了。</p><h1 id="7bea" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">3.使用基于JSON的vdom的优势</h1><p id="295d" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">这超出了本文的范围。<br/>(抱歉，但我不得不这么说)</p><p id="1bdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果使用嵌套的Javascript对象和数组，Javascript非常适合在运行时动态操作它们。</p><p id="5f86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我写了一篇文章深入讨论这个问题(例如无限滚动):</p><div class="mq mr gp gr ms mt"><a href="https://medium.com/dataseries/your-benefits-of-working-with-json-based-virtual-dom-7318a983da9e" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">使用基于JSON的虚拟DOM的好处</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">许多以前的同事和朋友找到我，问我:“你是如何做到如此高效和快速的……</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh mm mt"/></div></div></a></div><h1 id="32a8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">4.基于JSON的vdom有什么问题？</h1><p id="c98d" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">最大的担忧是它可能很难阅读。</p><p id="7cf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复杂组件的示例:</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="2959" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码并不是很紧凑，而且看DOM结构也很棘手。</p><h1 id="76d1" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">5.新的格式化概念</h1><p id="69f7" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">因为我们可以用不同的方式格式化JSON，所以我考虑了一个概念，让它看起来更像html，而不改变内容本身。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="caf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">DOM结构更加清晰。</p><p id="9467" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【旁注】没有标签属性的对象是<code class="fe nk nl nm nn b">div</code>。</p><p id="73ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过直接访问一个<code class="fe nk nl nm nn b">ul</code>节点或使用一个标志来轻松地添加或删除列表项。</p><h1 id="8083" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">6.更复杂的格式更改示例</h1><p id="406e" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">旧:</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="3ea8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">新:</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="cc86" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">7.在行动中体验好处！</h1><p id="347e" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">neo.mjs很有可能是第一个完全包含JSON的Javascript UI框架。没有XML，没有模板。</p><div class="mq mr gp gr ms mt"><a href="https://github.com/neomjs/neo" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">近地天体</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">neo.mjs使您能够使用一个以上的CPU创建可扩展的高性能应用程序，而无需使用…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">github.com</p></div></div><div class="nc l"><div class="no l ne nf ng nc nh mm mt"/></div></div></a></div><p id="3a49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于框架的主要参与者是web工作者，因此无法直接访问真正的DOM。这使得虚拟dom通常是强制性的。</p><p id="e963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了多线程方面，基于JSON的vdom在获得这种性能方面发挥了关键作用。解析嵌套的objects &amp; arrays结构进行增量更新的速度非常快。</p><p id="c4c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望新的vdom格式能让你更容易上手。</p><p id="fb03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问候&amp;快乐编码，<br/>托拜厄斯</p><p id="0e91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">文章预览图像:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi np"><img src="../Images/252505a7f115113608e091b491a174d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*9ach4cFC9Yax84rwJUM_2Q.png"/></div></figure></div></div>    
</body>
</html>
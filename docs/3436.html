<html>
<head>
<title>microVM: Another Level of Abstraction for Serverless Computing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">microVM:无服务器计算的另一个抽象层次</h1>
<blockquote>原文：<a href="https://itnext.io/microvm-another-level-of-abstraction-for-serverless-computing-5f106b030f15?source=collection_archive---------2-----------------------#2019-12-16">https://itnext.io/microvm-another-level-of-abstraction-for-serverless-computing-5f106b030f15?source=collection_archive---------2-----------------------#2019-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e286" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何用消防员在无权限的环境下运行一个microVM？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ab72b19ea8d847c9360f82d9dd57190e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lNlcljTATMVw8oSloQT8tw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">演职员表:<a class="ae kv" href="https://firecracker-microvm.github.io/" rel="noopener ugc nofollow" target="_blank">https://firecracker-microvm.github.io/</a></figcaption></figure><p id="a8a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">多年来，云计算是说服用户和企业花钱将服务托管在云数据中心的服务器上的一种方式。事物在变化，仅仅提供基本的存储和处理能力已经成为过去。如今的云服务非常复杂，每一种都需要适当的培训才能使用。分布式数据存储、负载平衡器、存储、无服务器和容器自动化和协调服务只是大量云计算服务的几个例子。</p><p id="e5f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">人们现在可以在云服务(软件即服务)上运行一个软件，在多个云提供商上托管<a class="ae kv" href="https://en.wikipedia.org/wiki/High_availability#Percentage_calculation" rel="noopener ugc nofollow" target="_blank">五九SLA </a>，有效地在全球范围内提供高可用性，所有这些都从一个中心位置进行控制，自动化并与市场上最新的尖端技术相协调。这些技术的数量还在不断增长。</p><p id="7806" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，大多数云提供商使用开源模式来分发他们的技术和软件。其中的例子有<a class="ae kv" href="https://github.com/kubernetes/kubernetes" rel="noopener ugc nofollow" target="_blank">库伯内特</a>、<a class="ae kv" href="https://github.com/docker/docker-ce" rel="noopener ugc nofollow" target="_blank">码头工人</a>和<a class="ae kv" href="https://github.com/firecracker-microvm/firecracker" rel="noopener ugc nofollow" target="_blank">鞭炮</a>。容器化和轻量级虚拟机只是在云上部署应用程序的各种方式中的两种。各有利弊。但在这篇文章中，我将介绍bargade，这是一个轻量级虚拟机，或microVM，由Amazon创建的管理工具，用于运行他们的无服务器平台。与容器化相反，特别是docker，它使用一个带有cgroups、名称空间等的共享Linux内核。，microVMs使用在基于内核的虚拟机(KVM)之上虚拟化的独立Linux内核。microVM的优点是更少的内存开销(5 MB)，非常小的优化内核和安全性。最有趣的部分是，它是用<a class="ae kv" href="http://rust-lang.org/" rel="noopener ugc nofollow" target="_blank"> Rust </a>编写的，有一个令人敬畏的<a class="ae kv" href="http://golang.org/" rel="noopener ugc nofollow" target="_blank"> Go </a> SDK，并且已经为它开发了许多工具:</p><div class="ls lt gp gr lu lv"><a href="https://github.com/firecracker-microvm/firecracker" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">鞭炮-微姆/鞭炮</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">我们的使命是实现容器和功能工作负载的安全、多租户、最小开销的执行。阅读…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a href="https://github.com/firecracker-microvm/firecracker-containerd" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">鞭炮容器</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">自动化状态测试Lint这个库支持使用容器运行时containerd来管理鞭炮……</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mk l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a href="https://github.com/firecracker-microvm/firecracker-go-sdk" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">鞭炮-micro VM/鞭炮-go-sdk</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">这个包是一个Go库，用来与鞭炮API交互。它被设计成一个抽象的…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="ml l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a href="https://github.com/firecracker-microvm/firectl" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">鞭炮——微姆/火</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">Firectl是一个基本的命令行工具，可以让你通过命令行运行任意的鞭炮微麦克风。这让…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mm l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a href="https://github.com/weaveworks/ignite" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">weaveworks/ignite</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">Weave Ignite是一款开源虚拟机(VM)管理器，具有容器UX和内置GitOps管理功能…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mn l mg mh mi me mj kp lv"/></div></div></a></div><p id="e1e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一个演示项目展示了microVM的能力和特性，展示了它可以在不到一分钟的时间内运行4k microVMs的速度:</p><div class="ls lt gp gr lu lv"><a href="https://github.com/firecracker-microvm/firecracker-demo" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">鞭炮-微型麦克风/鞭炮-演示</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">这个演示展示了鞭炮的灵活性和高密度的能力。它已经在EC2 I3.metal主机上运行过了</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mo l mg mh mi me mj kp lv"/></div></div></a></div><p id="222e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几个月前，我已经开始尝试它，并编写了一些bash脚本和一个简单的README，以便能够展示如何下载项目二进制文件或从源代码构建项目，并快速开始使用microVMs:</p><div class="ls lt gp gr lu lv"><a href="https://github.com/mostafa/firefighter" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">mostafa/消防员</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">消防员，现在，作为一套脚本下载或从源构建鞭炮和火焰</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mp l mg mh mi me mj kp lv"/></div></div></a></div><p id="5c85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了使用它，只需在磁盘上的某个地方克隆项目，然后运行<code class="fe mq mr ms mt b">get_latest.sh</code>或<code class="fe mq mr ms mt b">build_latest.sh</code>。要获得最新的二进制文件以及预建的Debian和Alpine内核和rootfs，你只需要安装<a class="ae kv" href="https://curl.haxx.se/" rel="noopener ugc nofollow" target="_blank"> curl </a>。但是为了从源代码构建它，你应该安装Rust编译器。安装Rust编译器和工具链最简单的方法，只需下载并安装<a class="ae kv" href="https://rustup.rs/" rel="noopener ugc nofollow" target="_blank"> rustup </a>安装程序就可以轻松安装其他东西。Rust官方网站上有一个简单的教程，提供了如何做到这一点的说明。为了构建最新版本，我假设你已经安装了<a class="ae kv" href="http://debian.org/" rel="noopener ugc nofollow" target="_blank"> Debian GNU/Linux </a>，因为APT。</p><div class="ls lt gp gr lu lv"><a href="https://www.rust-lang.org/tools/install" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">安装铁锈</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">使用rustup(推荐),看起来像是在运行macOS、Linux或其他类似Unix的操作系统。下载Rustup和…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">www.rust-lang.org</p></div></div><div class="me l"><div class="mu l mg mh mi me mj kp lv"/></div></div></a></div><p id="de38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然从源代码构建给了您完全的控制权和可定制性，但是对于纯粹的实验来说，只需下载二进制文件和相关文件就可以了！</p><pre class="kg kh ki kj gt mv mt mw mx aw my bi"><span id="d1d7" class="mz na iq mt b gy nb nc l nd ne">$ <strong class="mt ir">git clone </strong><a class="ae kv" href="https://github.com/mostafa/firefighter" rel="noopener ugc nofollow" target="_blank"><strong class="mt ir">https://github.com/mostafa/firefighter</strong></a><br/>$ <strong class="mt ir">cd firefighter</strong><br/>$ <strong class="mt ir">./get_latest.sh</strong></span></pre><p id="1920" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个脚本下载了最新的带进度条的鞭炮、firectl和jailer二进制文件，还有Alpine和Debian内核以及位于<code class="fe mq mr ms mt b">images</code>目录下的rootfs。</p><p id="fe10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不带选项或带<code class="fe mq mr ms mt b">help</code>运行以下命令将打印使用说明:</p><pre class="kg kh ki kj gt mv mt mw mx aw my bi"><span id="2299" class="mz na iq mt b gy nb nc l nd ne">$ <strong class="mt ir">./run_microvm.sh</strong><br/>Usage:<br/>run_microvm.sh start &lt;distro-name&gt; | &lt;vmlinuz.bin&gt; &lt;rootfs.ext4&gt;<br/>run_microvm.sh stop<br/>run_microvm.sh config<br/>run_microvm.sh status<br/>run_microvm.sh help</span><span id="4e24" class="mz na iq mt b gy nf nc l nd ne">Available distros:<br/> - debian<br/> - alpine</span></pre><p id="77c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行Alpine microVM，只需运行以下命令，它需要root/sudo权限:</p><pre class="kg kh ki kj gt mv mt mw mx aw my bi"><span id="660f" class="mz na iq mt b gy nb nc l nd ne">$ <strong class="mt ir">./run_microvm.sh start alpine<br/></strong>Giving read/write access to KVM to user<br/>[sudo] password for user:<br/>Booting kernel: images/alpine-vmlinuz.bin<br/>Image: images/alpine.ext4<br/>...<br/>Enable routing from/to MicroVM<br/>Run MicroVM<br/>...<br/>Welcome to Alpine Linux 3.8<br/>Kernel 4.14.55-84.37.amzn2.x86_64 on an x86_64 (ttyS0)</span><span id="6722" class="mz na iq mt b gy nf nc l nd ne">localhost login:</span></pre><p id="f5b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe mq mr ms mt b">root</code>作为用户名和密码，您可以登录microVM。在microVM中运行以下命令以启用互联网访问:</p><pre class="kg kh ki kj gt mv mt mw mx aw my bi"><span id="c503" class="mz na iq mt b gy nb nc l nd ne">$ <strong class="mt ir">ip addr add 172.16.0.2/24 dev eth0</strong><br/>$ <strong class="mt ir">ip route add default via 172.16.0.1 dev eth0</strong><br/>$ <strong class="mt ir">echo "nameserver 8.8.8.8" &gt; /etc/resolv.conf</strong><br/>$ <strong class="mt ir">ping -c 3 google.com<br/></strong>PING google.com (172.217.20.46): 56 data bytes<br/>64 bytes from 172.217.20.46: seq=0 ttl=54 time=4.270 ms<br/>64 bytes from 172.217.20.46: seq=1 ttl=54 time=5.979 ms<br/>64 bytes from 172.217.20.46: seq=2 ttl=54 time=6.455 ms</span><span id="7e6b" class="mz na iq mt b gy nf nc l nd ne">--- google.com ping statistics ---<br/>3 packets transmitted, 3 packets received, 0% packet loss<br/>round-trip min/avg/max = 4.270/5.568/6.455 ms</span></pre><p id="e8bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您可以在另一个终端上使用以下命令停止microVM:</p><pre class="kg kh ki kj gt mv mt mw mx aw my bi"><span id="e7dc" class="mz na iq mt b gy nb nc l nd ne">$ <strong class="mt ir">./run_microvm.sh stop</strong></span></pre><p id="4cda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">暂时就这样了。你应该弄清楚如何利用这一点。</p><p id="28f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个简单的开源项目，欢迎任何反馈和贡献。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="5524" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">穆斯塔法·莫拉迪安</strong>T3<em class="nn">Sr .</em>SWE @<a class="no np ep" href="https://medium.com/u/7df2fe2c0bfd?source=post_page-----5f106b030f15--------------------------------" rel="noopener" target="_blank">负载冲击</a><br/><a class="ae kv" href="http://github.com/mostafa" rel="noopener ugc nofollow" target="_blank">GitHub</a>|<a class="ae kv" href="https://www.linkedin.com/in/mostafa-moradian/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kv" href="https://twitter.com/MosiMoradian" rel="noopener ugc nofollow" target="_blank">Twitter</a></p></div></div>    
</body>
</html>
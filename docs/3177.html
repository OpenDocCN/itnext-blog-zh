<html>
<head>
<title>Laravel: Multitap, Multitap, Multitap</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多击，多击，多击</h1>
<blockquote>原文：<a href="https://itnext.io/laravel-multitap-multitap-multitap-2496f2d58174?source=collection_archive---------3-----------------------#2019-10-17">https://itnext.io/laravel-multitap-multitap-multitap-2496f2d58174?source=collection_archive---------3-----------------------#2019-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1ca9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">因为敲打不应该在第一轮就结束</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/af2d34c458e11428d90b58262ae919b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P3UJ901w_Fl8vwXo"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@chernus_tr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Taras Chernus </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f127" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Laravel包括的一个简洁的助手是<a class="ae kv" href="https://laravel.com/docs/master/helpers#method-tap" rel="noopener ugc nofollow" target="_blank"/><code class="fe ls lt lu lv b"><a class="ae kv" href="https://laravel.com/docs/master/helpers#method-tap" rel="noopener ugc nofollow" target="_blank">tap()</a></code><a class="ae kv" href="https://laravel.com/docs/master/helpers#method-tap" rel="noopener ugc nofollow" target="_blank">方法</a>。简而言之，它允许您调用一个对象方法并返回相同的对象而不是方法结果，允许您链接另一个方法。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="048e" class="ma mb iq lv b gy mc md l me mf">tap($user)-&gt;save()-&gt;setAttribute('done', true);</span></pre><p id="d336" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不会给你解释它的工作原理和使用方法。更好的是，我将指出泰勒关于 <code class="fe ls lt lu lv b"><a class="ae kv" href="https://medium.com/@taylorotwell/tap-tap-tap-1fc6fc1f93a6" rel="noopener">t</a>ap()</code> <a class="ae kv" href="https://medium.com/@taylorotwell/tap-tap-tap-1fc6fc1f93a6" rel="noopener">方法</a>的文章。</p><p id="7a38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我多次面临的问题是<code class="fe ls lt lu lv b">tap()</code>只对<strong class="ky ir">有效一次</strong>。我的意思是，一旦你调用的方法返回了对象，下一个方法调用就会给出它的结果而不是同一个对象。如果下一个方法结果是<code class="fe ls lt lu lv b">void</code>，你将得到一个<code class="fe ls lt lu lv b">void</code>结果。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="c20a" class="ma mb iq lv b gy mc md l me mf">// This will return the method result</span><span id="e000" class="ma mb iq lv b gy mg md l me mf">tap($object)-&gt;doSomething()-&gt;getResult();</span></pre><p id="6ca2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有时我想链接多个方法，而不必一次又一次地调用对象。有时我不能添加fluent方法，因为对象来自外部包。</p><p id="76de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我发明了multitap。</p><h1 id="9ea1" class="mh mb iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">无限制攻丝</h1><p id="880d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我决定扩展<code class="fe ls lt lu lv b">HigherOrderTapProxy</code>类，它是在<code class="fe ls lt lu lv b">tap()</code>助手下工作的魔法，覆盖_call方法。我把它保存为<code class="fe ls lt lu lv b">InfiniteHigherOrderTapProxy</code>,因为虽然它很长，但有意义。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a634" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这个类，你可以不断地调用你的类方法，它总是透明地传递给它。如果你想得到一个方法结果，或者完全摆脱敲击，你可以调用任何附加了“AndUntap”的方法，你将得到结果。整洁！</p><p id="393d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，我喜欢有表现力的一行程序，所以我们要在某个地方添加一个函数助手。我更喜欢<code class="fe ls lt lu lv b">/helpers/helpers.php</code>，但是你可能想使用任何其他的技术来添加你自己的根函数到你的项目中。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="c3e7" class="ma mb iq lv b gy mc md l me mf">if (! function_exists('multitap')) {<br/>    /**<br/>     * Makes something infinitely tapped<br/>     *<br/>     * @param mixed $object<br/>     * @return \App\Helpers\InfiniteHigherOrderTapProxy<br/>     */<br/>    function multitap($object)<br/>    {<br/>        return new InfiniteHigherOrderTapProxy($object);<br/>    }<br/>}</span></pre><p id="34a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，有了它，你就可以用一个liners来处理简单乏味的对象，并流畅地使用它们，即使它的每个方法都只返回对象本身。然后，我将调用最后一个方法，附加“AndUntap”来退出点击。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="fa3e" class="ma mb iq lv b gy mc md l me mf">echo multitap($boring)<br/>    -&gt;set(10)<br/>    -&gt;add(2)<br/>    -&gt;remove(5)<br/>    -&gt;getResultAndUntap();</span><span id="7fa3" class="ma mb iq lv b gy mg md l me mf">// 13</span></pre><p id="456f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为它扩展了<code class="fe ls lt lu lv b">HigherOrderTapProxy</code>，您可以选择在任何时候通过指向<code class="fe ls lt lu lv b">target</code>属性来到达底层对象。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="0b13" class="ma mb iq lv b gy mc md l me mf">echo multitap($boring)<br/>    -&gt;set(20)<br/>    -&gt;add(4)<br/>    -&gt;remove(10)<br/>    -&gt;target-&gt;getResult();</span><span id="01eb" class="ma mb iq lv b gy mg md l me mf">// 14</span></pre><p id="d870" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这差不多就是我如何将我力所不及的任何类转换成一个可多次点击的对象，我可以流畅地链接它，直到我需要为止。</p></div></div>    
</body>
</html>
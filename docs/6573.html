<html>
<head>
<title>Ruby on Rails 7, importmap and VueJS 3, no more webpacker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby on Rails 7，importmap和VueJS 3，没有更多的webpacker</h1>
<blockquote>原文：<a href="https://itnext.io/ruby-on-rails-7-importmaps-and-vuejs-3-no-more-webpacker-4ef06372a49c?source=collection_archive---------0-----------------------#2021-12-21">https://itnext.io/ruby-on-rails-7-importmaps-and-vuejs-3-no-more-webpacker-4ef06372a49c?source=collection_archive---------0-----------------------#2021-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1309" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Ruby on Rails 7和gem <a class="ae kl" href="https://github.com/rails/importmap-rails" rel="noopener ugc nofollow" target="_blank"> importmap-rails </a>让我们可以使用javascript模块和库，而不需要传输或捆绑。我记得当我修改webpacker配置以将VueJS 3添加到我的rails项目时失败了，并开始使用VueJS 2来代替它。现在我有一个新的机会尝试第三版。</p><p id="99f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，我们如何开始，只是添加宝石到你的宝石档案</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="4437" class="kv kw iq kr b gy kx ky l kz la">gem 'importmap-rails'</span></pre><p id="fa07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后安装</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="12c9" class="kv kw iq kr b gy kx ky l kz la">bundle install</span><span id="0816" class="kv kw iq kr b gy lb ky l kz la">rails importmap:install</span></pre><p id="40d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将添加<strong class="jp ir"> config/importmap.rb </strong>文件和默认js端点<strong class="jp ir">app/JavaScript/application . js</strong>。</p><p id="5487" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有别忘了删除一切和webpacker，gem，配置文件，node_modules有关的东西。</p><p id="819b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">gem的使用包含两个步骤。</p><p id="7905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">添加包</strong></p><p id="fbca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为第一步，我们需要添加js依赖项来导入映射配置。这可以通过两种方式实现。</p><p id="57a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过运行特殊命令</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="0a2a" class="kv kw iq kr b gy kx ky l kz la">./bin/importmap pin vue@next</span><span id="1a98" class="kv kw iq kr b gy lb ky l kz la">or </span><span id="fbfe" class="kv kw iq kr b gy lb ky l kz la">./bin/importmap pin vue@next --download</span></pre><p id="ea52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者通过手动将pin链接添加到importmap.rb</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="1f45" class="kv kw iq kr b gy kx ky l kz la">pin "vue", to: "<a class="ae kl" href="https://ga.jspm.io/npm:vue@3.2.26/dist/vue.esm-browser.js'" rel="noopener ugc nofollow" target="_blank">https://ga.jspm.io/npm:vue@3.2.26/dist/vue.esm-browser.js</a>"</span></pre><p id="9349" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我更喜欢第二种方式，因为您可以直接指定使用什么包。所以在使用VueJS 3之后，你会有这样的importmap.rb配置。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="fea0" class="kv kw iq kr b gy kx ky l kz la">pin "vue", to: "<a class="ae kl" href="https://ga.jspm.io/npm:vue@3.2.26/dist/vue.esm-browser.js'" rel="noopener ugc nofollow" target="_blank">https://ga.jspm.io/npm:vue@3.2.26/dist/vue.esm-browser.js</a>"</span><span id="43e2" class="kv kw iq kr b gy lb ky l kz la">pin_all_from "app/javascript/controllers", under: "controllers"</span><span id="1383" class="kv kw iq kr b gy lb ky l kz la">pin "application", preload: true</span></pre><p id="bc70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">添加VusJS 3控制器</strong></p><p id="ec01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二步是添加vuejs控制器。所以在<strong class="jp ir">app/JavaScript/application . js</strong>中为你的控制器添加导入。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="22f4" class="kv kw iq kr b gy kx ky l kz la">import "controllers/component_controller"</span></pre><p id="a8ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后可以在app/JavaScript/controllers/component _ controller . js文件中添加控制器</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a026" class="kv kw iq kr b gy kx ky l kz la">import * as Vue from "vue"</span><span id="222d" class="kv kw iq kr b gy lb ky l kz la">const point = "#point"</span><span id="9017" class="kv kw iq kr b gy lb ky l kz la">const element = document.querySelector(point)<br/>if (element !== null) {<br/>  const app = Vue.createApp({<br/>    data() {<br/>      return { count: 1 }<br/>    },<br/>    created() {<br/>      console.log("count is: "+ this.count) // =&gt; "count is: 1"<br/>    }<br/>  })<br/>  const vm = app.mount(point)<br/>}</span></pre><p id="04d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仅此而已。你不需要做任何webpacker配置，添加加载器或任何其他东西。</p><p id="10ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">优点</strong></p><ul class=""><li id="152b" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">不需要配置webpacker，所以至少rails开发人员的js痛苦要少得多</li><li id="baeb" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">部署应用程序所浪费的时间更少，因此您可以节省几分钟，因为您不需要编译js</li></ul><p id="e0c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">缺点</strong></p><ul class=""><li id="61db" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">不能<strong class="jp ir">要求</strong>文件，需要使用一些额外的库</li><li id="34e4" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">可能需要找到另一种方式来使用cli库，比如ttag-cli。</li></ul></div></div>    
</body>
</html>
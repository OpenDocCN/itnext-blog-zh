<html>
<head>
<title>What is a webhook and how to create one?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是webhook以及如何创建web hook？</h1>
<blockquote>原文：<a href="https://itnext.io/what-is-a-webhook-and-how-to-create-one-f7057d2cc0a?source=collection_archive---------4-----------------------#2018-07-13">https://itnext.io/what-is-a-webhook-and-how-to-create-one-f7057d2cc0a?source=collection_archive---------4-----------------------#2018-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3c3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我们在web上做的大多数事情都可以用事件来描述，webhooks已经成为一种事实上的连接系统的方式，无论是新用户帐户的创建、成功的支付、DockerHub图像推送事件还是Git存储库中的新pull请求。它们是非常有用和轻量级的信息共享方式。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/319790bf41bda6ace8fd7bfe42d793ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eyc16Ydypz4g8Y4WJMbSHA.png"/></div></div></figure><p id="0cbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，到底什么是webhook？webhook是应用程序向其他应用程序提供实时信息的一种方式。webhook在数据发生时将数据传送给其他应用程序，这意味着您可以立即获得数据。与典型的API不同，在典型的API中，您需要非常频繁地轮询数据以便实时获取数据。这使得webhooks对提供商和消费者来说都更加有效。由于大多数供应商都有严格的API速率限制，您要么必须采用webhooks，要么接受您的系统总是稍微(或更多)过时的事实。上面的例子显示了向用户请求付款的典型流程。</p><p id="cd9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">webhook有时被称为“反向API”，因为它们给出了API规范，并且您必须为web hook设计一个API来使用。webhook会向你的应用发出一个HTTP请求(通常是一个帖子)，然后你会负责解释它。您可以将其视为CLI/UI使用的常规API路由，但在这种情况下，用户将是您依赖的第三方服务。</p><p id="8026" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然大多数开发人员都在使用由Stripe或GitHub等流行服务产生的webhooks，但有时您也想让用户从您的应用程序接收webhooks。在这篇博文中，我们将构建一个简单的应用程序，用户可以在其中注册他们的端点并接收事件。</p><h1 id="20cc" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">创建webhook调度应用程序</h1><p id="dd66" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们的应用程序将会用Go编写(安装说明可以在这里找到<a class="ae ma" href="https://golang.org/doc/install" rel="noopener ugc nofollow" target="_blank">但是你可以选择任何你想要的语言，这只是一个简单的例子来演示外发的webhook行为。代码很简单，即使是非Go开发人员也应该觉得可读:</a></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><h1 id="b7b6" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">运行您的webhook生成器</h1><p id="6b60" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">要使用我们的webhook生成器，我们需要一个可以接收并帮助我们调试它的端点。对于这个任务，我们将使用这个免费的服务:【https://bin.webhookrelay.com/<a class="ae ma" href="https://bin.webhookrelay.com/" rel="noopener ugc nofollow" target="_blank">。打开链接后，你应该被重定向到一个独特的网址，这是你的bin。获取bin地址，您马上会需要它。</a></p><p id="3531" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始我们的应用程序:</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="0770" class="mi ky iq me b gy mj mk l ml mm">$ go run main.go</span><span id="6f9a" class="mi ky iq me b gy mn mk l ml mm">Create webhooks on http://localhost:8090/webhooks</span></pre><p id="f7f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，添加我们的bin:</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="e229" class="mi ky iq me b gy mj mk l ml mm">curl --request POST \</span><span id="f62b" class="mi ky iq me b gy mn mk l ml mm">--url http://localhost:8090/webhooks \</span><span id="ea69" class="mi ky iq me b gy mn mk l ml mm">--header 'content-type: application/json' \</span><span id="2055" class="mi ky iq me b gy mn mk l ml mm">--data '{</span><span id="d69b" class="mi ky iq me b gy mn mk l ml mm">"name": "joe",</span><span id="e7a3" class="mi ky iq me b gy mn mk l ml mm">"destination": "https://bin.webhookrelay.com/v1/webhooks/821024d7-12a0-4b41-99f2-71fcc2906989"</span><span id="c88f" class="mi ky iq me b gy mn mk l ml mm">}'</span></pre><p id="23c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加后，几秒钟后您应该会看到日志:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mo"><img src="../Images/76f51005f3ecfdcbb040608c957a904e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6EAbArGwf9qwKJ1A0TkOAw.png"/></div></div></figure><p id="7c4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的webhooks bin中，我们应该看到传入的请求:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mp"><img src="../Images/dae04fcb907c13e8624765b29d130009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyDj5tcydPq7KrJzBmEBAA.png"/></div></div></figure><h1 id="cc53" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="f48a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">总结一下——web hooks和API请求是相似的，都是事件，目的是在系统之间共享信息。虽然API轮询在早期看起来是一个不错的解决方案，但是如果有太多的用户依赖它，可能会导致后端停机或者严重影响性能。</p><p id="f589" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要在您的系统中成功实现webhooks，请考虑:</p><ul class=""><li id="8c2f" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">用户应该能够指定网页挂钩的目的地</li><li id="613f" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">虽然大多数系统只允许为webhooks添加一个目的地，但是您可能希望允许更多目的地。</li><li id="9806" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">如果状态代码&gt; =500，请重试webhooks。虽然有些人可能认为我们应该使用4XX状态代码重试，但他们通常意味着这是一个错误的请求，我们不应该重试相同的请求。</li></ul><p id="3c4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对webhooks感兴趣或有兴趣吗？在我们的 <a class="ae ma" href="https://webhookrelay.com/v1/examples/receiving-webhooks-on-localhost.html" rel="noopener ugc nofollow" target="_blank"> <em class="ne">示例集</em> </a> <em class="ne">中查看如何在本地主机或私有网络上接收webhook。Webhook Relay为开发者提供了一个免费层！</em></p><p id="1e36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ne">原载于2018年7月13日</em><a class="ae ma" href="https://webhookrelay.com/blog/2018/07/13/how-to-create-webhook/" rel="noopener ugc nofollow" target="_blank"><em class="ne">webhookrelay.com</em></a><em class="ne">。</em></p></div></div>    
</body>
</html>
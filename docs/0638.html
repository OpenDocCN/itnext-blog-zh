<html>
<head>
<title>Will EKS Simplify Your Migration To Kubernetes On AWS?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EKS会简化你在AWS上向Kubernetes的迁移吗？</h1>
<blockquote>原文：<a href="https://itnext.io/will-eks-simplify-your-migration-to-kubernetes-on-aws-f92b28ca736?source=collection_archive---------3-----------------------#2018-04-24">https://itnext.io/will-eks-simplify-your-migration-to-kubernetes-on-aws-f92b28ca736?source=collection_archive---------3-----------------------#2018-04-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/862c3d5d17cb57a360bf32d591ab0150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VWskWprN0_TDirsx54laAQ.png"/></div></div></figure><p id="bd0f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一年多以前，在AWS上建立一个Kubernetes集群并不是一件容易的事情。</p><p id="5ec6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是在AWS上设置HA Kubernetes集群所需的一些东西:</p><ol class=""><li id="e6d0" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">设置AWS资源:VPC，自动缩放组，ELB，DNS</li><li id="0c77" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">自动化etcd安装和备份</li><li id="e51b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">选择和配置网络驱动程序</li><li id="0632" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">编写puppet代码来部署不同的Kubernetes组件</li></ol><p id="2d89" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这只是我脑海中的一个部分列表，但是我希望您能够了解整体情况——建立一个Kubernetes集群将会从您的整个Kubernetes迁移项目中分配出很大一部分。</p><p id="b9ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今天，有像<a class="ae lk" href="https://github.com/kubernetes/kops" rel="noopener ugc nofollow" target="_blank"> kops </a>这样的工具可以自动完成上面提到的大部分任务，并且可以帮助你在AWS上构建HA Kubernetes集群。特别是Kops相当成熟，看起来最近<a class="ae lk" href="https://github.com/kubernetes/kops/graphs/code-frequency" rel="noopener ugc nofollow" target="_blank">得到了很多开发关注</a>。</p><h1 id="2633" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">为AWS管理Kubernetes</h1><p id="9447" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">如果您想避免在AWS上建立自己的Kubernetes集群，有一些商业选项可用，如Stackpoint。</p><p id="fd6a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">去年底，AWS宣布<a class="ae lk" href="https://aws.amazon.com/blogs/aws/amazon-elastic-container-service-for-kubernetes/" rel="noopener ugc nofollow" target="_blank">接受其托管的Kubernetes服务</a>的测试人员，名为“EKS”。</p><p id="8340" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我不是云分析师，所以我甚至不想深入探讨这一声明的战略含义。不过，我会问另一个问题，这个问题与我们一直在做的客户工作更相关:“<strong class="ka ir">EKS会大幅减少将公司迁移到运行AWS的Kubernetes所需的时间吗？</strong>”</p><h1 id="cce9" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">Kubernetes项目的典型步骤</h1><p id="2e7c" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">在过去的两年中，我完成了多个Kubernetes迁移项目，在这些项目中，我们采用了一个工作生产环境，并将其迁移到Kubernetes集群上运行。</p><p id="903c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了回答我上面提到的问题，让我们来看看将现有环境迁移到Kubernetes通常需要执行的任务:</p><h1 id="ad03" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">1.设置一个或多个Kubernetes集群</h1><p id="6f0a" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">正如我提到的，有了kops这样的工具，现在这是一项相对容易的工作，特别是如果你已经对Kubernetes的内部有了很好的了解，这将帮助你尽早做出正确的决定，比如使用哪个网络驱动程序。</p><h1 id="7c69" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">2.码头化</h1><p id="577c" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">如果您还没有使用Docker并以其他方式部署您的应用程序，那么为您的所有服务创建合适的Docker映像可能需要几天时间。</p><h1 id="95c4" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">3.对部署和构建自动化的调整</h1><p id="b6ac" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">老实说，我会说这部分大概占了项目时间的一半！</p><p id="efa6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为什么？因为通常您会发现许多关于部署环境的问题或假设，您需要首先克服这些问题。</p><p id="f9c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可能会有一些硬编码的Jenkins作业来执行部署的某些部分，或者被触发来执行特定的部署后任务。</p><p id="4579" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，詹金斯可以是一个地狱般的烂摊子，你甚至不想碰。因此，启动一个单独的Jenkins实例来处理新的Kubernetes环境可能更有意义。</p><p id="bd93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果Jenkins不参与，那么可能会有一组部署脚本，比如说Python，累积了如此多未使用的遗留代码，以至于甚至日常使用它的人都不完全理解它的作用！</p><p id="d994" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最终，我们需要绘制现有的部署流程，并将其转化为Kubernetes世界中的工作方式。</p><h1 id="7192" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">4.库伯内特人的创造体现了</h1><p id="4687" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">通常创建这些清单是作为上一步的一部分来完成的，但是我想把它单独归为一类。</p><p id="c6c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大多数情况下，这个过程非常简单，但它可能会变得越来越复杂，这取决于您想要部署的服务数量以及它们与<a class="ae lk" href="https://12factor.net/" rel="noopener ugc nofollow" target="_blank"> 12因素应用宣言</a>的对应程度。</p><p id="b2fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您有一堆无状态服务，一个简单的envsub模板就足够了。</p><p id="400f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，如果您有几十个具有复杂关系的服务影响部署，我们可能需要使用Kubernetes部署的重炮:<a class="ae lk" href="https://github.com/kubernetes/helm" rel="noopener ugc nofollow" target="_blank"> Helm </a>。</p><h1 id="a69b" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">5.监控和记录</h1><p id="8fcd" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">这一阶段的复杂程度取决于您当前使用的工具和您所拥有的监控范围。</p><p id="11cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您使用CloudWatch来监控和绘制一些内置的AWS指标，您可能需要实现并切换到一组与Kubernetes集成的新监控工具。</p><p id="dd57" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">像Datadog这样的其他监控工具可能需要较少的调整，但是您仍然需要执行几个步骤来转发新的指标。</p><h1 id="ef6e" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">6.培训和移交</h1><p id="6aac" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">如果在迁移到Kubernetes之后，您的开发团队不能自己操作日常任务，那么您就错过了Kubernetes的一个核心优势。</p><p id="6f0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不幸的是，尽管Kubernetes最近越来越受欢迎，但教授它的主要概念需要时间。文档不是最好的，团队需要时间来学习如何有效地使用Kubernetes。我以前写过关于<a class="ae lk" href="https://opsfleet.com/what-makes-kubernetes-difficult-for-beginners/" rel="noopener ugc nofollow" target="_blank">对初学者来说在Kubernetes </a>学习有什么困难，所以你可能想看一看以获得更全面的了解。</p><h1 id="ffa2" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">摘要</h1><p id="2f59" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">如果你在AWS上运行，EKS真的简化了到Kubernetes的迁移吗？从我上面提到的所有任务来看，<strong class="ka ir">在AWS上建立一个Kubernetes集群将占用大约10%的迁移项目</strong>。</p><p id="4c7a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这还不包括维护，维护也取决于群集的大小和环境的复杂性。</p><p id="ef4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是要回答我在本文开始时提出的问题，EKS可能会减少一些与集群设置相关的时间，甚至可能在将来减少与监控和日志记录相关的时间。由于大部分迁移项目的复杂性与现有基础设施有关，我认为<strong class="ka ir">在AWS上迁移到Kubernetes将在整个2018年继续充满挑战</strong>！</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><p id="009e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mv">最初发表于</em><a class="ae lk" href="https://opsfleet.com/will-eks-simplify-your-migration-to-kubernetes-on-aws/" rel="noopener ugc nofollow" target="_blank">T5【opsfleet.com】</a><em class="mv">。</em></p></div></div>    
</body>
</html>
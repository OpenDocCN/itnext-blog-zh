<html>
<head>
<title>Building Microservices with Spring Data REST</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spring Data REST构建微服务</h1>
<blockquote>原文：<a href="https://itnext.io/building-microservices-with-spring-data-rest-40bb94080a9e?source=collection_archive---------1-----------------------#2017-06-15">https://itnext.io/building-microservices-with-spring-data-rest-40bb94080a9e?source=collection_archive---------1-----------------------#2017-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a7eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">微服务目前得到了IT市场的大量关注。像优步、亚马逊、微软和网飞这样的公司正在投资将其平台从<a class="ae kl" href="http://microservices.io/patterns/monolithic.html" rel="noopener ugc nofollow" target="_blank">整体架构</a>迁移到<a class="ae kl" href="http://microservices.io/patterns/microservices.html" rel="noopener ugc nofollow" target="_blank">微服务架构</a>。为了帮助其他公司做同样的事情，大型市场参与者正在共享一套框架、文档和新技术来处理这个新市场的复杂性。其中一些公司认为有两种选择:创新或死亡。与此同时，软件社区中也有一些怀疑者，他们认为微服务并不是什么新鲜事物，它只是对<a class="ae kl" href="http://www.javaworld.com/article/2071889/soa/what-is-service-oriented-architecture.html" rel="noopener ugc nofollow" target="_blank"> SOA </a>的重新命名。</p><p id="2703" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我写这篇文章的目的是展示微服务架构模式如何让你进行更敏捷的开发。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/4f5aeea0506e7a42fa35c79455cae3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwNSvJDWVkPYtqym4aH0VQ.png"/></div></div></figure><p id="1cfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这篇文章我们会用<a class="ae kl" href="https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/" rel="noopener ugc nofollow" target="_blank"/><a class="ae kl" href="https://docs.spring.io/spring-data/rest/docs/current/reference/html/" rel="noopener ugc nofollow" target="_blank">Spring Data REST</a><a class="ae kl" href="http://swagger.io/" rel="noopener ugc nofollow" target="_blank">Swagger 2</a><a class="ae kl" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank">Mongo DB</a>和<a class="ae kl" href="https://maven.apache.org/" rel="noopener ugc nofollow" target="_blank"> Maven </a>。如果你不知道这些技术，不要担心，我会在编码前做一个简短的介绍。</p><h2 id="074d" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">Spring Boot</h2><p id="e21b" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Spring Boot使得创建独立的、生产级的基于Spring的应用程序变得容易，你可以“直接运行”。大多数Spring Boot应用需要很少的弹簧配置。</p><h2 id="fed9" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">特征</h2><ul class=""><li id="ddd4" class="lw lx iq jp b jq lr ju ls jy ly kc lz kg ma kk mb mc md me bi translated">创建独立的Spring应用程序</li><li id="644e" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">直接嵌入Tomcat、Jetty或Undertow(无需部署WAR文件)</li><li id="8677" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">提供固执己见的“初学者”POM来简化您的Maven配置</li><li id="c2a1" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">尽可能自动配置Spring</li><li id="76bc" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">提供生产就绪特性，如指标、运行状况检查和外部化配置</li><li id="8971" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">绝对<strong class="jp ir">没有代码生成</strong>和<strong class="jp ir">不需要XML </strong>配置</li></ul><p id="afd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle" rel="noopener ugc nofollow" target="_blank">参考指南</a>包括所有功能的详细描述。</p><h2 id="c42c" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">弹簧数据架</h2><p id="80d5" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Spring Data REST构建在Spring数据仓库之上，分析应用程序的域模型，并为模型中包含的集合公开超媒体驱动的HTTP资源。</p><h2 id="4112" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">特征</h2><ul class=""><li id="e089" class="lw lx iq jp b jq lr ju ls jy ly kc lz kg ma kk mb mc md me bi translated">展示代表你的模型的<a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#repository-resources" rel="noopener ugc nofollow" target="_blank">集合、项目和关联资源</a>。</li><li id="829f" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">通过<a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#paging-and-sorting" rel="noopener ugc nofollow" target="_blank">导航链接</a>支持分页。</li><li id="1211" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">为存储库中定义的查询方法提供专用的<a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#repository-resources.query-method-resource" rel="noopener ugc nofollow" target="_blank">搜索资源。</a></li><li id="ad07" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">允许通过操作弹簧<code class="fe mk ml mm mn b">ApplicationEvents</code>将<a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#events" rel="noopener ugc nofollow" target="_blank">挂钩到REST请求</a>的处理中。</li><li id="e624" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated"><a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#metadata" rel="noopener ugc nofollow" target="_blank">公开关于被发现为ALPS和JSON模式的模型的元数据</a>。</li><li id="dc4b" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">允许通过<a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#projections-excerpts" rel="noopener ugc nofollow" target="_blank">投影</a>定义客户特定的表示。</li><li id="b8a6" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated">允许暴露默认资源的<a class="ae kl" href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#customizing-sdr" rel="noopener ugc nofollow" target="_blank">高级定制</a>。</li></ul><h2 id="a8c5" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">霸气2</h2><p id="5cb0" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Swagger是面向OpenAPI规范(OAS)的世界上最大的API开发工具框架，支持从设计和文档到测试和部署的整个API生命周期的开发。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/26b79d4120cc4453b12c2b6d3245a1f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*p4lSBuWPE9qmFaOtVjJPBA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">霸气的UI界面。</figcaption></figure><h2 id="91ce" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">Spring数据Mongo数据库</h2><p id="139e" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Spring Data MongoDB项目将核心的Spring概念应用到使用MongoDB文档风格数据存储的解决方案开发中。它提供了一个“模板”,作为存储和查询文档的高级抽象。您会注意到与Spring框架中JDBC支持的相似之处。</p><h2 id="a973" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">专家</h2><p id="af27" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Apache Maven是一个软件项目管理和理解工具。基于项目对象模型(POM)的概念，Maven可以从一个中心信息管理项目的构建、报告和文档。</p><h1 id="20c2" class="mt kz iq bd la mu mv mw ld mx my mz lg na nb nc lj nd ne nf lm ng nh ni lp nj bi translated">让我们开始吧</h1><p id="0fe1" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">首先，我们需要使用<a class="ae kl" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank"> Spring Initializr </a>创建一个Spring Boot应用程序。如果你对Spring Boot没有足够的经验，请阅读<a class="ae kl" href="https://spring.io/guides/gs/spring-boot/" rel="noopener ugc nofollow" target="_blank">这篇</a>。基本代码可以在文章末尾找到。</p><h2 id="db03" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated"><strong class="ak">添加依赖关系</strong></h2><p id="813a" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在根文件夹中找到pom.xml，添加Spring Data REST、MondoDB、Swagger 2 (Jars和UI)和Test的依赖项。</p><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="2cd9" class="ky kz iq mn b gy no np l nq nr"><em class="ns">&lt;!--DATA REST--&gt;<br/></em>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;org.springframework.boot&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;spring-boot-starter-data-rest&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;<br/><br/><em class="ns">&lt;!--EMBED MONGO DB--&gt;<br/></em>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;org.springframework.boot&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;spring-boot-starter-data-mongodb&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;<br/><br/>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;de.flapdoodle.embed&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;de.flapdoodle.embed.mongo&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>    &lt;<strong class="mn ir">version</strong>&gt;1.50.5&lt;/<strong class="mn ir">version</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;<br/><br/><br/><em class="ns">&lt;!--DEPENDENCIES FOR SWAGGER DOCUMENTATION--&gt;<br/></em>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;io.springfox&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;springfox-data-rest&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>    &lt;<strong class="mn ir">version</strong>&gt;2.7.0&lt;/<strong class="mn ir">version</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;<br/><br/>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;io.springfox&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;springfox-swagger-ui&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>    &lt;<strong class="mn ir">version</strong>&gt;2.7.0&lt;/<strong class="mn ir">version</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;<br/><br/>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;io.springfox&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;springfox-swagger2&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>    &lt;<strong class="mn ir">version</strong>&gt;2.7.0&lt;/<strong class="mn ir">version</strong>&gt;<br/>    &lt;<strong class="mn ir">scope</strong>&gt;compile&lt;/<strong class="mn ir">scope</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;<br/><br/><em class="ns">&lt;!--TEST--&gt;<br/></em>&lt;<strong class="mn ir">dependency</strong>&gt;<br/>    &lt;<strong class="mn ir">groupId</strong>&gt;org.springframework.boot&lt;/<strong class="mn ir">groupId</strong>&gt;<br/>    &lt;<strong class="mn ir">artifactId</strong>&gt;spring-boot-starter-test&lt;/<strong class="mn ir">artifactId</strong>&gt;<br/>    &lt;<strong class="mn ir">scope</strong>&gt;test&lt;/<strong class="mn ir">scope</strong>&gt;<br/>&lt;/<strong class="mn ir">dependency</strong>&gt;</span></pre><p id="9155" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个例子中，我们使用了embed MongoDB，因此重启服务器后，数据将会丢失。</p><h2 id="aa20" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated"><strong class="ak">设置我们的网络服务</strong></h2><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="6090" class="ky kz iq mn b gy no np l nq nr">@SpringBootApplication<br/>@EnableAutoConfiguration<br/>@EnableSwagger2<br/>@Import({springfox.documentation.spring.data.rest.configuration.SpringDataRestConfiguration.<strong class="mn ir">class</strong>})<br/><strong class="mn ir">public class </strong>SpringRestApplication {<br/><br/>    <strong class="mn ir">public static void </strong>main(String[] args) {<br/>        SpringApplication.<em class="ns">run</em>(SpringRestApplication.<strong class="mn ir">class</strong>, args);<br/>    }<br/>}</span></pre><ul class=""><li id="89c7" class="lw lx iq jp b jq jr ju jv jy nt kc nu kg nv kk mb mc md me bi translated"><strong class="jp ir"> SpringBootApplication </strong>:这是我们REST服务的标准配置。这个注释相当于使用了<code class="fe mk ml mm mn b">@Configuration</code>、<code class="fe mk ml mm mn b">@EnableAutoConfiguration</code>和<code class="fe mk ml mm mn b">@ComponentScan</code></li><li id="261c" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated"><strong class="jp ir">enable auto configuration</strong>:允许我们的Swagger2和MongoDB依赖项进行自我配置。</li><li id="fcad" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated"><strong class="jp ir"> EnableSwagger2 </strong>:基于Swagger2生成API文档。</li><li id="f0f1" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated"><a class="ae kl" href="http://twitter.com/Import" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">@导入</strong></a><strong class="jp ir">({ spring fox . documentation . Spring . Data . rest . configuration . springdatarestconfiguration . class }):</strong>将Spring数据REST配置导入到API文档中。</li></ul><h2 id="7a9d" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">模型</h2><p id="989b" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我们有针对性的服务管理<strong class="jp ir">作者</strong>、<strong class="jp ir">书籍</strong>和<strong class="jp ir">类别。</strong></p><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="345c" class="ky kz iq mn b gy no np l nq nr">@Document<br/><strong class="mn ir">public class </strong>Author {<br/><br/>    @Id<br/>    <strong class="mn ir">private </strong>String <strong class="mn ir">id</strong>;<br/><br/>    <strong class="mn ir">private </strong>String <strong class="mn ir">name</strong>;<br/><br/>    @DBRef<br/>    <strong class="mn ir">private </strong>List&lt;Book&gt; <strong class="mn ir">books</strong>;<br/><br/>    <strong class="mn ir">public </strong>String getId() {<br/>        <strong class="mn ir">return id</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setId(String id) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">id </strong>= id;<br/>    }<br/><br/>    <strong class="mn ir">public </strong>String getName() {<br/>        <strong class="mn ir">return name</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setName(String name) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">name </strong>= name;<br/>    }<br/><br/>    <strong class="mn ir">public </strong>List&lt;Book&gt; getBooks() {<br/>        <strong class="mn ir">return books</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setBooks(List&lt;Book&gt; books) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">books </strong>= books;<br/>    }<br/>}</span><span id="5eaf" class="ky kz iq mn b gy nw np l nq nr">@Document<br/><strong class="mn ir">public class </strong>Book {<br/><br/>    @Id<br/>    <strong class="mn ir">private </strong>String <strong class="mn ir">id</strong>;<br/><br/>    <strong class="mn ir">private </strong>String <strong class="mn ir">name</strong>;<br/><br/>    @DBRef<br/>    <strong class="mn ir">private </strong>Category <strong class="mn ir">category</strong>;<br/><br/>    <strong class="mn ir">private </strong>Double <strong class="mn ir">price</strong>;<br/><br/>    <strong class="mn ir">public </strong>Book() {<br/>    }<br/><br/>    <strong class="mn ir">public </strong>String getId() {<br/>        <strong class="mn ir">return id</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setId(String id) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">id </strong>= id;<br/>    }<br/><br/>    <strong class="mn ir">public </strong>String getName() {<br/>        <strong class="mn ir">return name</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setName(String name) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">name </strong>= name;<br/>    }<br/><br/>    <strong class="mn ir">public </strong>Category getCategory() {<br/>        <strong class="mn ir">return category</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setCategory(Category category) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">category </strong>= category;<br/>    }<br/><br/>    <strong class="mn ir">public </strong>Double getPrice() {<br/>        <strong class="mn ir">return price</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setPrice(Double price) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">price </strong>= price;<br/>    }<br/>}</span><span id="5380" class="ky kz iq mn b gy nw np l nq nr">@Document<br/><strong class="mn ir">public class </strong>Category {<br/><br/>    @Id<br/>    <strong class="mn ir">private </strong>String <strong class="mn ir">id</strong>;<br/><br/>    <strong class="mn ir">private </strong>String <strong class="mn ir">name</strong>;<br/><br/>    <strong class="mn ir">public </strong>String getName() {<br/>        <strong class="mn ir">return name</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setName(String name) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">name </strong>= name;<br/>    }<br/><br/>    <strong class="mn ir">public </strong>String getId() {<br/>        <strong class="mn ir">return id</strong>;<br/>    }<br/><br/>    <strong class="mn ir">public void </strong>setId(String id) {<br/>        <strong class="mn ir">this</strong>.<strong class="mn ir">id </strong>= id;<br/>    }<br/>}</span></pre><h1 id="ae3c" class="mt kz iq bd la mu mv mw ld mx my mz lg na nb nc lj nd ne nf lm ng nh ni lp nj bi translated">仓库资源</h1><p id="ef56" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在关于Spring Data REST的酷的部分，在用@RepositoryRestResource注释MongoRepositories时，RepositoryRestHandler将基于我们的存储库映射所有的端点，模拟一个RestController。</p><h2 id="cad5" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">作者知识库</h2><p id="f433" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">这个存储库将公开CRUD操作。您可以在<a class="ae kl" href="http://projects.spring.io/spring-data/" rel="noopener ugc nofollow" target="_blank"> Spring数据</a>之后添加自己的方法。</p><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="7404" class="ky kz iq mn b gy no np l nq nr">@RepositoryRestResource(collectionResourceRel = <strong class="mn ir">"authors"</strong>, path = <strong class="mn ir">"authors"</strong>)<br/><strong class="mn ir">public interface </strong>AuthorRepository <strong class="mn ir">extends </strong>MongoRepository&lt;Author, String&gt; {<br/>    Author findOneByBooks(Book book);<br/>}</span></pre><h2 id="3a75" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">图书仓库</h2><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="e7aa" class="ky kz iq mn b gy no np l nq nr">@RepositoryRestResource(collectionResourceRel = <strong class="mn ir">"books"</strong>, path = <strong class="mn ir">"books"</strong>)<br/><strong class="mn ir">public interface </strong>BookRepository <strong class="mn ir">extends </strong>MongoRepository&lt;Book, String&gt; {<br/>    List&lt;Book&gt; findByCategory(Category category);<br/>}</span></pre><h2 id="765f" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated"><strong class="ak">类别仓库</strong></h2><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="c5a8" class="ky kz iq mn b gy no np l nq nr">@RepositoryRestResource(collectionResourceRel = <strong class="mn ir">"categories"</strong>, path = <strong class="mn ir">"categories"</strong>)<br/><strong class="mn ir">public interface </strong>CategoryRepository <strong class="mn ir">extends </strong>MongoRepository&lt;Category, String&gt; {<br/>}</span></pre><h2 id="c765" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">设置基本路径</h2><p id="14f0" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">可以为Data REST服务设置一个基本路径。转到位于“src/main/resources/application . properties”的应用程序属性文件。</p><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="44b6" class="ky kz iq mn b gy no np l nq nr"><strong class="mn ir">spring.data.rest.base-path</strong>=<strong class="mn ir">/api</strong></span></pre><h2 id="29c9" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated"><strong class="ak">上次霸气配置</strong></h2><p id="4cd7" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">下面是一个Swagger API扫描的例子。</p><pre class="kn ko kp kq gt nk mn nl nm aw nn bi"><span id="0cbf" class="ky kz iq mn b gy no np l nq nr"><em class="ns">/**<br/> * Created by rodrigo.chaves on 13/06/2017.<br/> */<br/></em>@Configuration<br/><strong class="mn ir">public class </strong>SwaggerConfig {<br/>    @Bean<br/>    <strong class="mn ir">public </strong>Docket productApi() {<br/>        <strong class="mn ir">return new </strong>Docket(DocumentationType.<strong class="mn ir"><em class="ns">SWAGGER_2</em></strong>).select()<br/>                .apis(RequestHandlerSelectors.<em class="ns">any</em>())<br/>                .paths(PathSelectors.<em class="ns">any</em>())<br/>                .build();<br/>    }<br/>}</span></pre><h2 id="e398" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">让我们运行它！</h2><p id="b71c" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我们只需要转到根文件夹，运行“mvn spring-boot:run”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nx"><img src="../Images/756893fbc44bf1b23cbdf52114fb2892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BYkumRgSWDziFi0QchItg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">RepositoryRestHandlerMapping正在映射和公开我们的API。</figcaption></figure><h2 id="c8d0" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">来测试一下吧！</h2><p id="a73f" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">从<a class="ae kl" href="http://localhost:8080/swagger-ui.html" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/Swagger-ui . html</a>打开Swagger API文档</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ny"><img src="../Images/a452177869415a4d22e2a58cc372f7ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t5HoAf--cgBF1YDhvTnY_w.png"/></div></div></figure><p id="16b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Swagger列出了web服务中所有可用的端点。您可以测试所有为我们自动创建的端点。我们可以看到我们的附加方法“findOneByBooks”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nz"><img src="../Images/f4293c2a95d80e6521f77363b9269ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVKo1g_aD0zlX91IH5loaQ.png"/></div></div></figure><h2 id="70ac" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">我们来试试吧！</h2><p id="55bc" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">通过使用swagger-ui，我们可以直接测试我们的API。基本上，这就是我们对“api/authors”的结果。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oa"><img src="../Images/7d057388b6b81051d858197de6a375ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ZrU-TywJnajNCWF7zwAnA.png"/></div></div></figure><p id="4f8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个有趣的特性是所有的API都实现了现成的HATEOAS(作为应用程序状态引擎的超媒体)模式！超媒体驱动的站点通过在响应中包含超媒体链接，提供动态导航站点的<a class="ae kl" href="https://spring.io/understanding/rest" rel="noopener ugc nofollow" target="_blank"> REST </a>界面的信息。</p><p id="3eca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个例子可以在https://github.com/LINKIT-Group/spring-data-rest<a class="ae kl" href="https://github.com/LINKIT-Group/spring-data-rest" rel="noopener ugc nofollow" target="_blank">或者</a><a class="ae kl" href="https://github.com/LINKIT-Group/spring-data-rest/archive/master.zip" rel="noopener ugc nofollow" target="_blank">这里</a>下载</p></div></div>    
</body>
</html>
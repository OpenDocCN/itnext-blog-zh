<html>
<head>
<title>Using a Local SFTP-Server for Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用本地SFTP服务器进行测试</h1>
<blockquote>原文：<a href="https://itnext.io/using-a-local-sftp-server-for-testing-659daaa0290a?source=collection_archive---------1-----------------------#2021-08-12">https://itnext.io/using-a-local-sftp-server-for-testing-659daaa0290a?source=collection_archive---------1-----------------------#2021-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7592" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关于如何在本地Docker实例上设置SFTP服务器的快速教程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/caea2a73872a03250a0935e109deedec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LTKWKuORXkqCA5ti"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@viktortalashuk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">维克多·塔拉舒克</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="b9f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更新2021–09–13:如果你正在寻找相同的教程，但不是针对FTPS，你可以阅读<a class="ae le" href="https://twissmueller.medium.com/using-a-local-ftps-server-for-testing-6f2d77873bab" rel="noopener">这篇文章。</a></p><p id="a6ca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您是否急需一台SFTP服务器来测试本地开发人员机器上的某些东西？</p><p id="f683" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">什么事？</p><p id="62e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">给你…</p><h2 id="6554" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">设置</h2><p id="3443" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">注意:我是在运行Docker Desktop的Mac上做的。</p><p id="4e58" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，需要一个测试文件，它将被上传到SFTP服务器上。</p><ul class=""><li id="0094" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated"><code class="fe mm mn mo mp b">/someotherdirectory/hello_sftp.txt</code></li></ul><p id="9a6d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，一个目录被用作Docker容器的卷挂载。</p><ul class=""><li id="428e" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated"><code class="fe mm mn mo mp b">/Users/youruser/sftp-in</code></li></ul><p id="fdd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们需要另一个目录来下载之前上传的文件:</p><ul class=""><li id="c025" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated"><code class="fe mm mn mo mp b">/some-download-dir</code></li></ul><p id="b574" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是时候提取Docker映像并运行它了:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="4e8f" class="lf lg it mp b gy mu mv l mw mx">$ docker run -v /Users/youruser/sftp-in:/home/foo/upload -p 2222:22 -d atmoz/sftp foo:pass</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/d2e18581d62c39220068a4036be6910d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*CCzn914CZRjL4TJM6PV6Rw.png"/></div></figure><p id="401b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们连接到SFTP服务器:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="6654" class="lf lg it mp b gy mu mv l mw mx">$ sftp -oPort=2222 foo@localhost<br/>foo@localhost's password:<br/>Connected to localhost.<br/>sftp&gt;</span></pre><p id="8ded" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，一切都在它的位置，我们可以上传一个文件。</p><h2 id="b367" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">上传文件到SFTP服务器</h2><p id="81a3" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">在<code class="fe mm mn mo mp b">/someotherdirectory/hello_sftp.txt</code>测试文件在主机上就位后，我们现在可以上传它:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="1449" class="lf lg it mp b gy mu mv l mw mx">sftp&gt; put /someotherdirectory/hello_sftp.txt /upload/hello_sftp.txt<br/>Uploading /someotherdirectory/hello_sftp.txt to /upload/hello_sftp.txt<br/>/someotherdirectory/hello_sftp.txt                                     100%    0     0.0KB/s   00:00</span></pre><p id="bd3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大概就是这样。文件已经从你的本地主机上传到SFTP服务器，而SFTP服务器的上传目录在你的主机上。</p><p id="2055" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以用三种方法来检查它是否有效。</p><p id="2e9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在SFTP服务器上:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="af30" class="lf lg it mp b gy mu mv l mw mx">sftp&gt; ls /upload<br/>/upload/hello_sftp.txt</span></pre><p id="f9d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在主机上:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="35a0" class="lf lg it mp b gy mu mv l mw mx">$ ls /Users/youruser/sftp-in</span></pre><p id="8156" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了好玩，从Docker容器内部，首先打开一个外壳:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="4dab" class="lf lg it mp b gy mu mv l mw mx">docker exec -ti 743fe6ac65af /bin/bash</span></pre><p id="d3a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从那里，我们列出文件:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="e103" class="lf lg it mp b gy mu mv l mw mx">root@743fe6ac65af:/# ls /home/foo/upload/<br/>hello_sftp.txt</span></pre><h2 id="73b9" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">从SFTP服务器下载文件</h2><p id="7413" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">当然，我们也可以反过来从SFTP服务器下载文件。</p><p id="232f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们检索之前上传的文件，并将其保存在另一个目录中。</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="fd7e" class="lf lg it mp b gy mu mv l mw mx">sftp&gt; get /upload/hello_sftp.txt /some-download-dir/hello_again.txt<br/>Fetching /upload/hello_sftp.txt to /some-download-dir/hello_again.txt</span></pre><p id="5e3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以在我们的主机上使用以下命令检查这一点:</p><pre class="kp kq kr ks gt mq mp mr ms aw mt bi"><span id="54a1" class="lf lg it mp b gy mu mv l mw mx">$ ls /some-download-dir/</span></pre><p id="7c79" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读。希望有帮助！</p><p id="08e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这篇文章，请给我买杯咖啡。</p><h2 id="2692" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">资源</h2><ul class=""><li id="1c0c" class="md me it js b jt ly jx lz kb mz kf na kj nb kn mi mj mk ml bi translated"><a class="ae le" href="https://hub.docker.com/r/atmoz/sftp" rel="noopener ugc nofollow" target="_blank">Docker Hub上的atmoz/sftp</a></li></ul></div></div>    
</body>
</html>
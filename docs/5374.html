<html>
<head>
<title>Virtual Clusters For Kubernetes — Benefits &amp; Use Cases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes虚拟集群—优势和使用案例</h1>
<blockquote>原文：<a href="https://itnext.io/virtual-clusters-for-kubernetes-benefits-use-cases-2ca3cd71ec0e?source=collection_archive---------6-----------------------#2021-02-19">https://itnext.io/virtual-clusters-for-kubernetes-benefits-use-cases-2ca3cd71ec0e?source=collection_archive---------6-----------------------#2021-02-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6e6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">丹尼尔·塞利</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/fe5426e72a79ed24861bfa98a8572814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IlPjb3xame6Mj46F"/></div></div></figure><p id="1225" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虚拟Kubernetes集群(vClusters)有可能将Kubernetes的采用提高到一个新的水平。它们运行在物理Kubernetes集群中，可以像普通集群一样使用，但仍然只是一个虚拟的构造。(在此了解关于虚拟集群如何工作的更多信息<a class="ae la" href="https://loft.sh/blog/introduction-into-virtual-clusters-in-kubernetes/" rel="noopener ugc nofollow" target="_blank"/>)。与彻底改变了物理服务器使用的虚拟机类似，虚拟Kubernetes集群与物理集群相比有一些好处，这使它们在一些场景中特别有用。</p><p id="049e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将描述虚拟Kubernetes集群的优势，并提供一些使用案例，在这些案例中，vClusters优于其他解决方案，例如许多单独的集群或基于名称空间的多租户。</p><h1 id="3a69" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">虚拟Kubernetes集群的优势</h1><p id="6523" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">虚拟集群对Kubernetes的好处主要基于两个特征:物理集群的共享和隔离。</p><h1 id="5c17" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">集群共享/多租户</h1><p id="2284" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">由于v cluster是Kubernetes中的一个虚拟抽象，因此可以在一个物理集群上运行多个v cluster，这具有以下优势:</p><ul class=""><li id="2219" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated"><strong class="js iu">减少管理工作。</strong>由于只需维护一个物理集群，虚拟集群大大减少了管理工作量。从用户的角度来看，这一点与另一个可能导致类似结果的替代方案相比变得尤为明显:不是在一个物理集群中运行虚拟集群，而是可以运行许多必须维护的物理集群，即使在中等规模的团队中，这也很快变得不可行。此外，物理集群可以通过一种非常“基本”的方式进行配置，而无需进行大量的额外安装，因为大部分安装都是在vCluster级别进行的。</li><li id="b9e9" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">降低成本。</strong>除了减少管理工作量从而降低成本之外，虚拟集群还能更高效地利用计算资源，因为资源由租户共享。同样，通过将虚拟机引入物理服务器基础架构，也获得了类似的效率提升。虚拟集群的一次性本质进一步提高了这种成本效益，这样，当不需要它们时，它们就可以被“扔掉”(关闭)。或者，可以将它们“置于睡眠状态”(按比例缩小)，这一过程甚至可以自动化，例如通过<a class="ae la" href="https://loft.sh/" rel="noopener ugc nofollow" target="_blank"> Loft </a>等解决方案提供的睡眠模式。</li></ul><h1 id="7869" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">隔离/硬多租户</h1><p id="8987" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">由于虚拟Kubernetes集群提供了一种更难的多租户形式，即用户彼此严格隔离，因此与基于名称空间的多租户方法相比，它们具有一些额外的优势:</p><ul class=""><li id="90f4" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated"><strong class="js iu">稳定的系统。</strong>使用虚拟Kubernetes集群不会损害系统的稳定性。即使虚拟集群出现故障，底层物理集群通常也不会受到影响。(只有在某些极端情况下，虚拟集群的故障会导致物理集群的故障，这也类似于虚拟机很少会导致底层物理机中断。)这与错误的来源无关，错误可能来自群集内部，例如工程师意外损坏了某些东西，也可能来自外部，例如对系统的恶意攻击。这使得整个系统更具弹性，并有助于实现合理的微服务架构，真正分离各个服务的关注点。</li><li id="581c" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">充分的灵活性。</strong>当每个工程师都在同一个物理集群上工作或每个微服务都在运行时，他们的虚拟集群是完全独立的。这允许以非常不同的方式配置vClusters。例如，虚拟集群可以有不同的Kubernetes版本或不同的API服务器配置。这再次使工程师能够自由工作，并使用最适合其用例的方式，而不必考虑其他要求或底层物理Kubernetes集群。</li></ul><p id="dadf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总的来说，虚拟Kubernetes集群是将效率与稳定、灵活的系统相结合的唯一方法，因为它具有与Kubernetes本地资源的硬多租户。使用许多单独集群的替代方案只能解决隔离问题，但会造成巨大的成本负担，而基于名称空间的软多租户方法保持了合理的成本，但只能提供有限的稳定性和灵活性。因此，到目前为止，虚拟集群是那些希望同时拥有两个世界的公司的唯一选择。</p><p id="ccb1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于虚拟集群的行为大多类似于常规的Kubernetes集群，因此它们的应用范围也同样广泛。为此，我将集中讨论三个主要用例，这些用例没有被具有名称空间或大量物理集群的备选解决方案很好地涵盖。</p><h1 id="d205" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">CI/CD和测试</h1><p id="c825" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated"><strong class="js iu">需求:</strong>对于Kubernetes环境中的CI/CD和测试场景，工程师需要在任何需要的时候访问Kubernetes。为了保持低成本，环境应该只在实际使用时才运行。工程师还应该能够修改Kubernetes的配置，以获得更真实的测试。</p><p id="5d8a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">问题:创建一个Kubernetes集群需要一些时间，即使是在公共云中。因为计算资源是昂贵的，并且许多CI/CD管道是按分钟计费的，所以等待30分钟直到集群启动通常是不可行的。这也会减缓工程师行动的反馈循环，并中断他们的工作流程。因此，一个集群通常只是由工程师共享用于测试，如果同事同时使用它，这又会导致等待时间。这也是非常低效的，因为即使没有测试或管道在运行，这样的集群也总是在运行并耗费资金。</p><p id="a9df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">虚拟集群解决方案:</strong>虚拟集群的优势在于可以在几秒钟内启动，因此工程师可以按需创建它们。由于它们是成熟的集群，一次只能由一个工程师或应用程序使用，因此可以根据具体情况自由配置和调整。在测试或CI/CD过程完成后，它们也可以毫无问题地被丢弃，这使得计算资源的成本尽可能低。为此，虚拟Kubernetes集群非常适合CI/CD和测试场景。</p><h1 id="4495" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">云原生开发</h1><p id="fbfa" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated"><strong class="js iu">要求:</strong>越来越多的公司希望<a class="ae la" href="https://loft.sh/blog/the-journey-of-adopting-cloud-native-development/" rel="noopener ugc nofollow" target="_blank">在开发过程中就让开发者直接访问Kubernetes】。为此，工程师需要让Kubernetes能够工作和试验，同时保持这些环境的低成本和低管理工作。</a></p><p id="60ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">问题:</strong>每个工程师的单独集群通常是不可行的，因为这是一个昂贵的解决方案，需要一些Kubernetes知识，并导致高维护工作量。为此，有时已经使用了基于名称空间的多租户。然而，缺乏强隔离会给工程师带来破坏整个系统的风险。此外，他们通常没有集群的管理员权限，因此在配置选项方面受到限制。</p><p id="c8a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">虚拟集群解决方案:</strong>同样，虚拟Kubernetes集群可以由工程师按需启动，无需太多的Kubernetes先验知识。这样，工程师们就可以很好地相互隔离，在安全的开发沙箱中工作，而不用担心会影响到其他人。同时，这种方法非常经济高效，因为单个物理集群只需要很少的管理工作，可以共享资源，并且可以轻松删除虚拟集群。除了删除虚拟集群之外，还可以让它们进入睡眠模式，例如<a class="ae la" href="https://loft.sh/docs/sleep-mode/basics" rel="noopener ugc nofollow" target="_blank"> Loft </a>提供的睡眠模式。这允许开发人员从他们结束的地方继续他们的工作，同时不会产生计算成本。</p><h1 id="51f2" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">AI+ML实验</h1><p id="9dc1" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated"><strong class="js iu">需求:</strong>对于人工智能和机器学习应用，往往需要大量的计算资源。为了进行实验，工程师们因此需要访问一个拥有强大电力的云环境。他们还需要能够轻松地复制这些环境，以不同的参数重新运行实验，或者并行运行它们。</p><p id="1000" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">问题:</strong>由于资源需求高，成本是AI和ML实验的主要问题。因此，让实验环境一直运行是不合理的，因为即使不使用它，也会产生很高的成本。从工作流的角度来看，如果另一个实验仍在运行，共享环境会导致工程师的等待时间。对于需要很长时间启动并中断工程师工作流程的单个集群也是如此。</p><p id="dcc5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">虚拟集群解决方案:</strong>对于想要运行实验的人工智能和机器学习工程师来说，虚拟集群是一个很好的替代方案。当需要时，它们可以在几秒钟内创建，并且可复制性非常好，因此甚至可以并行运行实验，这可以加速许多工作流。尽管vClusters几乎可以立即使用，但它们并没有闲置，因为它们可以在实验结束后轻松关闭，因此这些昂贵实验的成本被降至最低。</p><h1 id="61b0" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">存在哪些虚拟集群解决方案</h1><p id="ec7c" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">虚拟Kubernetes集群仍然是一个非常新的话题，但是现在已经可以使用了。<a class="ae la" href="https://github.com/kubernetes-sigs/multi-tenancy" rel="noopener ugc nofollow" target="_blank">多租户工作组</a>已经在这个领域提出了一个实验性的解决方案。Darren Shepherd的k3v是开源社区中概念实现的另一个证明。</p><p id="20ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">针对虚拟Kubernetes集群的更高级的<a class="ae la" href="https://loft.sh/" rel="noopener ugc nofollow" target="_blank">平台解决方案是Loft </a>。Loft是一个商业解决方案，它在虚拟集群解决方案的基础上提供了一些附加功能，如睡眠模式和用户管理，这些功能在一个完整的平台中可以现成使用。</p><h1 id="b268" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="5832" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">虚拟Kubernetes集群的概念仍然非常新，但可能是Kubernetes的一大进步，与从物理服务器到虚拟机的突破性移动有着惊人的相似之处。共享集群与强隔离的结合将效率与弹性和灵活性融为一体。这使得Kubernetes对于目前仍然难以实现的用例也更具吸引力，例如CI/CD、测试、云原生开发和AI/ML实验，因此可以进一步刺激Kubernetes的采用。</p><p id="95dc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由<a class="ae la" href="https://unsplash.com/@kelvin1987?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Kelvin Ang </a>在<a class="ae la" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="1196" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mz">最初发布于</em><a class="ae la" href="https://loft.sh/blog/virtual-clusters-for-kubernetes-benefits-use-cases/" rel="noopener ugc nofollow" target="_blank"><em class="mz">https://loft . sh</em></a><em class="mz">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Next.js app on Github Pages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Github页面上的Next.js应用</h1>
<blockquote>原文：<a href="https://itnext.io/next-js-app-on-github-pages-768020f2b65e?source=collection_archive---------4-----------------------#2018-02-19">https://itnext.io/next-js-app-on-github-pages-768020f2b65e?source=collection_archive---------4-----------------------#2018-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8e96cf0f6c7ff78ebe43d997c53d605a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NZ7KxwBB1NSuVsJP4FeMnQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Next.js + Github页面</figcaption></figure><p id="533f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae la" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fnext-js-app-on-github-pages-768020f2b65e" rel="noopener ugc nofollow" target="_blank"> <em class="lb">点击这里在LinkedIn上分享这篇文章</em> </a> <em class="lb"> </em></p><p id="2fdf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最近，我决定最终创建我的主页。对于这个任务，我决定使用Next.js，它的静态导出功能令人惊叹。毫不犹豫地，我也决定使用github页面，因为我将github。我当时想:“这应该简单明了，只需将应用程序导出到<code class="fe lc ld le lf b">docs</code>文件夹(带有<code class="fe lc ld le lf b">next build</code>和<code class="fe lc ld le lf b">next export -o docs</code>)中，就大功告成了”。那些已经在咯咯笑的人，其实是对的，因为原来不是小菜一碟。</p><p id="bf9b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，我们有这个指南<a class="ae la" href="https://github.com/zeit/next.js/wiki/Deploying-a-Next.js-app-into-GitHub-Pages" rel="noopener ugc nofollow" target="_blank"/>(它实际上错过了一些重要的信息，我已经添加了，但最好继续阅读帖子)。第一个重要的部分是<code class="fe lc ld le lf b">.nojekyll</code>文件，因为Jekyll忽略文件夹，以下划线开始，我们有<code class="fe lc ld le lf b">_next</code>。所以你应该在你的<code class="fe lc ld le lf b">docs</code>文件夹中添加一个名为<code class="fe lc ld le lf b">.nojekyll</code>的空文件。别担心，不会在<code class="fe lc ld le lf b">next export</code>时被删除。你也可以选择使用<code class="fe lc ld le lf b">gh-pages</code>分支(有一个很酷的git特性叫做subtree for it，<a class="ae la" href="https://gist.github.com/cobyism/4730490" rel="noopener ugc nofollow" target="_blank">见这里</a>)。所以应该没问题吧？…</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/e0b899ac18799669d36332221da9f14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0IMUgxXUqA-Nutq6VLU2g.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Cuphead卡格尼康乃馨老板</figcaption></figure><h1 id="7d77" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">首要问题</h1><p id="0c84" class="pw-post-body-paragraph kc kd iq ke b kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz ij bi translated">如果不是你的个人或组织页面，你的github页面会发布在<code class="fe lc ld le lf b"><a class="ae la" href="http://{username}.github.io/{reponame}." rel="noopener ugc nofollow" target="_blank">http://{username}.github.io/{reponame}</a></code> <a class="ae la" href="http://{username}.github.io/{reponame}." rel="noopener ugc nofollow" target="_blank">下。这意味着默认情况下，到脚本的链接将被断开。不过不用担心，<code class="fe lc ld le lf b">next.js</code>有一个选项可以修复它，它叫<code class="fe lc ld le lf b">assetPrefix</code>。问题是你不想为本地开发清除<code class="fe lc ld le lf b">assetPrefix</code>，所以最好依靠<code class="fe lc ld le lf b">process.env.NODE_ENV</code>，或者任何你用来区分dev和prod的东西。</a></p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/c9595dac93ca8596b76a2a97b56bfc7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YAeOvAWO34gc2u6HNXad-A.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Cuphead卡拉玛丽亚老板</figcaption></figure><h1 id="9a00" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">我们继续下一个</h1><p id="2362" class="pw-post-body-paragraph kc kd iq ke b kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz ij bi translated">您已经更新了静态文件的路径，但是链接呢？我们还应该给它们加上前缀。将前缀传递给组件和页面的最简单方法是使用<code class="fe lc ld le lf b">webpack.DefinePlugin</code>和webpack配置函数(Next.js版本≥ 5)。</p><blockquote class="mr ms mt"><p id="61f9" class="kc kd lb ke b kf kg kh ki kj kk kl km mu ko kp kq mv ks kt ku mw kw kx ky kz ij bi translated">Next.js也有一个使用<code class="fe lc ld le lf b">env-config.js</code>的选项，但是我看不出将一个关注点分成两个文件有什么意义。</p></blockquote><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="14be" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后我们这样使用它。重要的是，我们没有简单地把它加到<code class="fe lc ld le lf b">href</code>的前缀上，而是使用了<code class="fe lc ld le lf b">as</code>道具。否则这就不是客户端导航，而是全页面重载。我想知道这是什么原因(见<a class="ae la" href="https://github.com/zeit/next.js/issues/3335#issuecomment-348802894" rel="noopener ugc nofollow" target="_blank">这个线程</a>了解更多信息)。</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="ebb4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您也可以为它创建一个简单的包装器。</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><figure class="lh li lj lk gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/111c898d80bffad811635b021fefa588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*Rwxavy5zVS8Qm30hkbSoGw.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">瘾君子魔鬼老板</figcaption></figure><h1 id="8dd0" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">奖金问题</h1><p id="4b78" class="pw-post-body-paragraph kc kd iq ke b kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz ij bi translated">如果你正在使用Next.js v5通用webpack配置特性，比如<code class="fe lc ld le lf b">withCss</code> decorator，它允许你使用旧式css方法(普通css、css-modules、sass、less、post-css)创建单独的文件，你可能想使用<code class="fe lc ld le lf b">_document.js</code>文件来微调Next.js将用来呈现你的页面的模板。但是在<code class="fe lc ld le lf b">assetPrefix</code>的情况下，你可能也想改变这个脚本的url。幸运的是你可以从道具(<code class="fe lc ld le lf b">this.props.__NEXT_DATA__.assetPrefix</code>)中得到<code class="fe lc ld le lf b">assetPrefix</code>，就像这样。</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/91ba703e0d99a0f68b20a9a7ab6646cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMjZLxnhwjYnn1v-DYJk7A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">“谢谢”屏幕</figcaption></figure><p id="4a9d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">谢谢你的关注，我希望你不会很快面临另一堆什么问题！</p></div></div>    
</body>
</html>
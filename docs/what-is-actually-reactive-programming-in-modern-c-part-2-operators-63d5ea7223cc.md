# 现代 C++中的反应式编程实际上是什么？部分。2:操作员

> 原文：<https://itnext.io/what-is-actually-reactive-programming-in-modern-c-part-2-operators-63d5ea7223cc?source=collection_archive---------1----------------------->

大家好，欢迎回到 C++的反应式编程世界！

希望你已经看过这个系列的第一部了。在这篇文章中，我们将探讨运营商和他们的权力。

正如我们之前所学的，你可以在运算符的帮助下修改你的可观察对象及其事件——它们是扩展值流、添加一些复杂逻辑、变换、过滤值等的小构件。目前，在反应式编程的世界里有很多类型的操作符。让我们逐一查看，以熟悉每种类型，并探究一些示例:

# 创造可观的

首先，你需要以某种方式创造你的可观察对象。例如，您可以创建一个可观察对象来发出一个值列表，遍历某个容器或发出某个函数的结果(函数将在订阅期间执行):

当订户订阅它时，会发出传递的值，然后发出完成。与`obs_of_doubles`相同，但是它会迭代 vector 并从中发出值。`obs_of_char`将在订阅上执行传递的函数，发出结果值，然后发出完成。

最重要的是:每个新订阅都从头开始“订阅回调”。这意味着订户 1 在`obs_of_char`订阅并获得值，然后订户 2 在`obs_of_char`订阅，然后函数将再次执行，而不是发出“缓存的”值。

# 转换

然后我们可以修改我们的观察值。例如，我们可以发送第一个可观察值的部分和，并将第二个可观察值乘以 10:

增加的运营商只有在订阅后，并且只有在从潜在的可观测量中获得新的排放时才会采取行动。换句话说:它是懒惰的计算，在实际订阅之前什么都不会发生

# 过滤

并不是所有的排放都对我们有用，所以我们可以在可观测值上增加一些过滤逻辑。

例如，我们可以只过滤≤ 5 的值，跳过前 1 次发射。

# 有条件的

除了上面提供的能力之外，我们还可以提供一些关于 observable 什么时候可以发射值或者什么时候应该停止发射(或者哪个应该发射值)的条件。

例如，我们强制我们的字符的可观察对象发出值，直到 v！= "0".当条件达到时，可观察到发送完成和退订。

# 结合

当我们只能利用一个可观测量时，我们能利用多个可观测量做什么呢？结合他们！例如，我们可以通过`concat`操作符将它们结合起来，它保持了可观察对象的顺序:当第一个可观察对象仅在此事件之后完成时，第二个可观察对象开始发射:

在这种情况下，可观测值从`filtered_partial_sums_of_obs_of_ints`开始发射，直到完成，然后从`take_while_obs_of_char`发送值，直到完成，然后从`skiped_multiplied_obs_of_doubles`发送值。

# 订阅

那么让我们订阅这个可观察值并检查结果:

(为了获得更好的结果，我在`obs_of_symbols` 中添加了`repeat()`，以无限发送来自函数的值——因此，它会重新订阅可观察值并重新发出函数，直到订阅被取消；在我们的例子中，由于`take_while`，它将被取消订阅

可能的输出:

```
New value 1
New value 3
3210123
New value 51
New value 50
New value 49
New value 103
```

在这里我们看到:
***** 1 和 3 from `filtered_partial_sums_of_obs_of_ints` : 1=0+1，3=1+2，然后 6=3+3 不符合 v ≤ 5 的条件，所以没有其他值，所以 observable 终止，下一个开始于`concat_with`
***** 3210123 —是我作为 get_char 的输入键入控制台的内容。Observable 将 chars 解释为相应的代码，所以我们看到 51(3)，50(2)，49(1)。然后可观测量发出 0，但是`take_while`终止了这些可观测量，所以，`concat_with`转到最后一个可观测量
*****103——就是 10.3 乘以 10。但是由于`skip(1)`跳过了 35 (3.5*10)

# 结论

在这篇简单的文章中，我们已经检查了大多数类型的操作符，并在它们的帮助下构建了简单的例子！在下一篇文章中，我将向您展示如何使用线程和同步原语来创建可观察的多线程！

链接到 [ReactivePlusPlus](https://github.com/victimsnino/ReactivePlusPlus) (rpp)库。请自行检查，做一些实验，并在您的项目中使用它=)
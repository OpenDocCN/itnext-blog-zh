<html>
<head>
<title>A few steps to protect your K8S cluster</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保护K8S集群的几个步骤</h1>
<blockquote>原文：<a href="https://itnext.io/a-few-steps-to-protect-your-k8s-cluster-87f339557fc6?source=collection_archive---------4-----------------------#2022-02-17">https://itnext.io/a-few-steps-to-protect-your-k8s-cluster-87f339557fc6?source=collection_archive---------4-----------------------#2022-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c058a58810b17f4b09c072f6f62834b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLgRJ4QHgej8jW0k89NeZQ.png"/></div></div></figure><p id="a5f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保护Kubernetes环境最重要的任务是访问控制的质量以及用户认证或授权的安全性。Webhook访问控制器就是用来解决这个问题的。但是一旦任何新的组件被添加到集群中，就会导致意想不到的困难。例如，应用程序可能没有正确部署，或者可能存在管理问题。</p><p id="13c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很明显，用户和开发人员都需要有效地管理风险。为了简化这个过程，为访问控制器创建了一个威胁<a class="ae kw" href="https://github.com/kubernetes/sig-security/blob/main/sig-security-docs/papers/admission-control/kubernetes-admission-control-threat-model.md" rel="noopener ugc nofollow" target="_blank">模型。</a></p><p id="a713" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种开发的主要目的是考虑当访问控制器使用不当时出现的所有潜在风险。</p><p id="7254" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于控制器的误用，攻击者理论上能够绕过安全策略，这为他们打开了通向封闭集群的直接且未经授权的路径，该封闭集群最初应该受到良好的保护并且是安全的。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="c0b3" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何保护访问控制器和封闭集群免受未授权访问？</h1><p id="3bd8" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">上述威胁模型成为进一步开发用于保护控制器的新工具和方法的基础。使用这种安全方法有助于集群运营商避免与产品使用过程相关的所有潜在风险。</p><p id="211c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">拥有一个现成的风险模型为运营商提供了相当多的安全好处。他们是多方向的，这意味着你可以依靠他们的高效率。</p><ol class=""><li id="5c4c" class="mh mi iq ka b kb kc kf kg kj mj kn mk kr ml kv mm mn mo mp bi translated">所有集群成员的安全性是通过验证集群中所有成员的配置实现的。在这种情况下，为所有webhook流量正确配置<strong class="ka ir"> TLS </strong>非常重要APIs和web hook之间的通信必须按顺序加密。</li><li id="5aa4" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">你还需要确保只允许通过<strong class="ka ir">认证的</strong>访问。事实是，如果没有这样的项目，攻击者将能够向控制器发送无限数量的访问请求。因此，服务将会过载，最终导致系统故障。使用认证访问是一种保证，这种情况发生的风险会降低几倍。</li><li id="2c22" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">在发生<strong class="ka ir">故障</strong>时<strong class="ka ir">可用</strong>的集群成员和那些最重要的组件之间达成妥协同样具有影响力，因此这些组件应该保持关闭。该方法的本质是保持一些关键组件处于关闭状态，保护它们免受未经授权的访问，但同时保留部署某些集群的可能性。在实践中，这种考虑到权衡的安全性遵从模型是最可行的。</li></ol><p id="ff76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个确保系统安全的组件是webhook配置的<strong class="ka ir">定期检查</strong>。根据具体情况，这可以手动或自动完成。最重要的是确保webhook配置中的设置是正确的，从而避免由这种配置中的错误导致的漏洞。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="71f9" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">验证Kubernetes安全特性是否配置正确</h1><p id="ca6c" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">一个非常流行的做法是安装一个准入控制器webhook作为集群工作负载。如果您的数字产品遇到了同样的情况，那么确保所有Kubernetes安全设置都是正确的是有意义的，这甚至可以在理论上影响该环境中应用程序的运行。接下来的步骤如下:</p><ol class=""><li id="baba" class="mh mi iq ka b kb kc kf kg kj mj kn mk kr ml kv mm mn mo mp bi translated"><a class="ae kw" href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" rel="noopener ugc nofollow" target="_blank">基于角色的访问控制(RBAC) </a>权限的限制。</li><li id="8f52" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">限制特权(关键)工作负载的要求。</li><li id="69e1" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">使用<a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/network-policies/" rel="noopener ugc nofollow" target="_blank">网络策略</a>最大限度地降低向群集外发送敏感信息的风险。</li><li id="5b48" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">每个集群都应该有一个单独的web hook——这将使访问每个单独的组件变得复杂。</li></ol><p id="f3f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">控制对外部系统的访问，以及不断增加的访问复杂性需求，是这个列表中最重要的主题。如果你真的关心应用程序的安全性和可靠性，你将不得不特别注意这几点。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="9ce5" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">准入控制器规则库</h1><p id="42c3" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">Kubernetes环境的安全性直接依赖于与每个组件和集群的功能相关的规则库。由于规则是安全性的一个关键组成部分，它们必须被设计为准确地实现目标，绕过潜在的误报和漏报。</p><p id="0454" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你不能从一开始就说规则是完全按照这个要求创建的。您的产品中使用的任何规则都应该定期检查和测试。这是消除可能的错误并保证执行的准确性和应用的有效性的唯一方法。</p><p id="4312" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，随着Kubernetes API的每一次发布，这些规则都需要被重新审查和评估。发生这种情况是因为他们必须考虑到所有外部现实和变化，以保持与时俱进，并确保他们仍然能够应付分配给他们的职能。</p><p id="0210" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保护部署在云中的应用程序需要新的安全方法。这并不总是方便的，开发人员被迫投入到新方法、途径和工具的研究中。但是，正是目前水平的产品安全性的支持，保证了在市场上的成功推广和用户的积极反馈。因此，请再次仔细研究以上信息，以免遗漏任何信息，并向您的客户保证一个有价值且安全的产品。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Test Automation in React Native using Appium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Appium在React Native中进行自动化测试</h1>
<blockquote>原文：<a href="https://itnext.io/test-automation-in-react-native-ac9ac2330ab9?source=collection_archive---------0-----------------------#2020-02-17">https://itnext.io/test-automation-in-react-native-ac9ac2330ab9?source=collection_archive---------0-----------------------#2020-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0c94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将讨论如何使用Appium在React Native中进行简单的UI测试自动化。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/94fb1671f756d210b8395d807be3e485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*45tGwjC4tH-cVxWCMAK69Q.jpeg"/></div></div></figure><p id="ceae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Appium </strong>是一款开源工具，用于跨平台应用和移动应用的自动化UI测试。它的功能与Selenium服务器相同，Selenium服务器在后台运行。它还使用了类似Selenium的web驱动程序。如果您已经体验过Selenium，那么使用Appium并不是什么大事。</p><p id="c353" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Appium支持Android和iOS平台。但是在这篇文章中，我将只关注Android平台。</p><p id="f1ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是我们将要经历的步骤，</p><ul class=""><li id="6588" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk lc ld le lf bi translated">设置项目</li><li id="17ba" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">配置web驱动程序IO</li><li id="b56f" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">编写简单的登录表单</li><li id="91b6" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">为测试设置组件选择器</li><li id="032e" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">编写测试用例</li><li id="a68a" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">试探性试验</li></ul><p id="9995" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在开始之前，让我们创建一个新的react本地项目，</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="98ce" class="lq lr iq lm b gy ls lt l lu lv">react-native init reactnative_test</span></pre></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="f844" class="md lr iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">对于不耐烦(TL；DR；)</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi na"><img src="../Images/1e03cfb2d0e42383d12452c218894b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*3ln7MmzWwITlLRQxC7sBog.jpeg"/></div></figure><p id="c9a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是Github回购:</p><div class="nb nc gp gr nd ne"><a href="https://github.com/shamique/react-native-appium" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">shamique/react-native-appium</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">在GitHub上创建一个帐户，为shamique/react-native-appium开发做出贡献。</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kv ne"/></div></div></a></div><h1 id="91a1" class="md lr iq bd me mf nt mh mi mj nu ml mm mn nv mp mq mr nw mt mu mv nx mx my mz bi translated">设置项目</h1><p id="40d2" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">— Appium服务器</p><p id="55d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过npm或作为独立应用程序安装Appium(推荐)。为方便起见，我将通过npm安装。如果你喜欢单机版，可以从这里的<a class="ae od" href="https://github.com/appium/appium-desktop/releases/" rel="noopener ugc nofollow" target="_blank">下载。</a></p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="627a" class="lq lr iq lm b gy ls lt l lu lv">npm install -g appium</span></pre><p id="7113" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们创建一个单独的目录来编写我们的测试项目。您可以在项目的根文件夹中创建此文件夹，以保持所有内容都在适当的位置。</p><p id="1065" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建测试文件夹后，在测试文件夹中启动package.json文件。</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="58ef" class="lq lr iq lm b gy ls lt l lu lv">npm init -y</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oe"><img src="../Images/f2615a07b9e3ebe85db824618c72b81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*E6v6F0jEoC5cYoSkHacuQA.png"/></div></div><figcaption class="of og gj gh gi oh oi bd b be z dk translated">创建了test_project文件夹并启动了package.json</figcaption></figure><p id="92cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们在test_project目录中安装下面的依赖项，</p><p id="fb48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—网络驱动</p><p id="8cc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">WebdriverIO是一个支持Appium的nodejs开源测试工具。</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="d928" class="lq lr iq lm b gy ls lt l lu lv">npm install --save webdriverio @wdio/cli</span></pre><p id="ad15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—柴框架</p><p id="513c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另外，让我们在编写测试用例时为断言安装Chai。</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="018c" class="lq lr iq lm b gy ls lt l lu lv">npm install --save chai</span></pre><h1 id="b5c0" class="md lr iq bd me mf nt mh mi mj nu ml mm mn nv mp mq mr nw mt mu mv nx mx my mz bi translated">配置web驱动程序IO</h1><p id="b155" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">现在我们需要生成web驱动程序配置文件。在测试项目中运行下面的命令，</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="5719" class="lq lr iq lm b gy ls lt l lu lv">npx wdio config</span></pre><p id="2945" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它会问你一系列问题，并根据你的选择安装所需的依赖项。</p><blockquote class="oj ok ol"><p id="2f30" class="jn jo om jp b jq jr js jt ju jv jw jx on jz ka kb oo kd ke kf op kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong>:在进行配置时，请务必选择Mocha框架和Appium服务</p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oq"><img src="../Images/8c8195bcdb94d7703e98b6332ad3654d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijWDBcHkYwSGs_xmFpaX3Q.png"/></div></div></figure><p id="f9f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦完成，test_project目录中就会生成<code class="fe or os ot lm b">wdio.conf</code>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/bc0ad2ecf807a0b2c1924879947f8fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*kTme8UU9zeY2xhRaoch0hw.png"/></div></figure><p id="4e1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要做以下更改来配置WebDriverIO以使用Appium并在Android模拟器上运行测试:</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="fe46" class="lq lr iq lm b gy ls lt l lu lv">exports.config = {<br/>  <strong class="lm ir">services: ['appium'],</strong><br/>  <strong class="lm ir">port: 4723,<br/>  </strong>runner: 'local',<br/>  specs: [<br/>    './test/specs/**/*.js'<br/>  ],</span><span id="e8dc" class="lq lr iq lm b gy ov lt l lu lv">  capabilities: [{<br/><strong class="lm ir">     maxInstances: 1,<br/>     browserName: '',<br/>     appiumVersion: '1.13.0',<br/>     platformName: 'Android',<br/>     platformVersion: '&lt;Add emulator's platform version&gt;',<br/>     deviceName: '&lt;Add emulator name&gt;',<br/>     app: '&lt;path to APK&gt;',<br/>     automationName: 'UiAutomator2'</strong><br/>  }],<br/>  <br/>  logLevel: 'trace',<br/>  bail: 0,<br/>  waitforTimeout: 10000,<br/>  connectionRetryTimeout: 90000,<br/>  connectionRetryCount: 3,<br/>  framework: 'mocha',<br/>  reporters: ['spec'],<br/>  mochaOpts: {<br/>    ui: 'bdd'<br/>    timeout: 60000<br/>  }<br/>}</span></pre><p id="505c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在配置文件中做了以下更改，</p><ul class=""><li id="0dc0" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk lc ld le lf bi translated">将appium添加到服务列表并设置默认端口</li><li id="e75a" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">在应用程序属性中设置APK文件夹路径。这个文件的通常位置是<code class="fe or os ot lm b">.apk</code>的<code class="fe or os ot lm b">&lt;PROJECT_ROOT&gt;/android/app/build/outputs/apk/&lt;FILE_NAME.apk&gt;</code></li><li id="f38a" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">将<code class="fe or os ot lm b">maxInstances</code>设置为1，以避免并行运行多个测试。</li><li id="f220" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">还要将automationName设置为UiAutomator2。因为UiAutomator1在最新的appium版本中已被弃用。</li></ul><h1 id="3b88" class="md lr iq bd me mf nt mh mi mj nu ml mm mn nv mp mq mr nw mt mu mv nx mx my mz bi translated">编写简单的登录页面</h1><p id="dfa0" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">打开react本地项目中的App.js文件，用下面的代码替换代码，</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="5d38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们继续之前，只需运行应用程序，看看应用程序是否在运行中没有任何问题。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/0064e3d013b550621cd96d0f8f0ad480.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*-dHrADzf2jTd0qisw8qiGw.png"/></div></figure><p id="c224" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，我们有一个简单的登录表单。因此，我们将编写测试用例来验证我们的登录功能。基本上是根据用户的输入来测试用户的登录状态是否成功。</p><h1 id="42d8" class="md lr iq bd me mf nt mh mi mj nu ml mm mn nv mp mq mr nw mt mu mv nx mx my mz bi translated">为测试设置组件选择器</h1><p id="34c4" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">为了使组件可测试，我们需要在相关组件上添加一个属性。对于Android来说是<code class="fe or os ot lm b">accessibilityLabel</code>，对于iOS来说是<code class="fe or os ot lm b">testID</code>。这些属性将有助于在屏幕上识别和定位可测试组件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oz"><img src="../Images/f2c18c47525b879d395da75e2eec4ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWMO9lpxhHkogYc2gKIQTA.png"/></div></div></figure><h1 id="7b78" class="md lr iq bd me mf nt mh mi mj nu ml mm mn nv mp mq mr nw mt mu mv nx mx my mz bi translated">编写测试用例</h1><p id="3a4a" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">好了，现在是写测试用例的时候了。在测试项目下创建一个名为<code class="fe or os ot lm b">App.test.js</code>的文件，并在其中添加以下代码，</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h1 id="44a0" class="md lr iq bd me mf nt mh mi mj nu ml mm mn nv mp mq mr nw mt mu mv nx mx my mz bi translated">运行测试</h1><p id="4636" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">01).在模拟器中运行react本机应用程序</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="38ff" class="lq lr iq lm b gy ls lt l lu lv">react-native run-android</span></pre><p id="c8b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">02).在单独的命令提示符下启动Appium服务器，</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="4b43" class="lq lr iq lm b gy ls lt l lu lv">appium</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pa"><img src="../Images/d8eb4bcfe860de102f89a6d1f8b4153f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M462Wm1yNUI5UrDUMtUaUw.png"/></div></div><figcaption class="of og gj gh gi oh oi bd b be z dk translated">Appium服务器已启动</figcaption></figure><p id="a02f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">03).在单独的命令提示符下运行webdriver测试套件，</p><pre class="km kn ko kp gt ll lm ln lo aw lp bi"><span id="c65b" class="lq lr iq lm b gy ls lt l lu lv">npx wdio ./wdio.conf.js</span></pre><p id="2c57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一切都相应地设置好了，您应该会看到下面的测试结果。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pb"><img src="../Images/f50e3b7536af622a01396c5f08fba38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*oZUqb0cNf13wMylOw8TALg.gif"/></div></div><figcaption class="of og gj gh gi oh oi bd b be z dk translated">自动化测试正在进行</figcaption></figure><p id="ba10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦自动化过程完成，您将会看到如下测试结果，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pc"><img src="../Images/fe8c2ea8ea8edbaefb84d5cf34f09294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xrd9gZMminEcmr5NlNLw6Q.png"/></div></div><figcaption class="of og gj gh gi oh oi bd b be z dk translated">实验报告</figcaption></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pd"><img src="../Images/eb2d1524cfa37943e63f417e89adb428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E47xsI-6RhunuRnVojXDyg.jpeg"/></div></div></figure><p id="4228" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你一直读到最后。你可以在下面的资源库中找到完整的源代码。</p><div class="nb nc gp gr nd ne"><a href="https://github.com/shamique/react-native-appium" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">shamique/react-native-appium</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">在GitHub上创建一个帐户，为shamique/react-native-appium开发做出贡献。</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kv ne"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.4 ffmpeg.wasm v0.2 — Add Libx264</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建FFmpeg WebAssembly版本(= FFmpeg . wasm):part . 4 FFmpeg . wasm v 0.2—添加Libx264</h1>
<blockquote>原文：<a href="https://itnext.io/build-ffmpeg-webassembly-version-ffmpeg-js-part-4-ffmpeg-js-v0-2-web-worker-and-libx264-d0596f1beb4e?source=collection_archive---------2-----------------------#2019-10-30">https://itnext.io/build-ffmpeg-webassembly-version-ffmpeg-js-part-4-ffmpeg-js-v0-2-web-worker-and-libx264-d0596f1beb4e?source=collection_archive---------2-----------------------#2019-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/8c0c378d4f8e771bf56ebf20e4685f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*bJYwDAe6Hj59mpHZr46olQ.png"/></div></figure><blockquote class="jx jy jz"><p id="1e4b" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2020/9更新:调整段落结构，使其更具可读性。</p></blockquote><p id="039a" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">之前的故事:<a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/build-ffmpeg-webassembly-version-ffmpeg-js-part-3-ffmpeg-js-v0-1-0-transcoding-avi-to-mp4-f729e503a397">构建FFmpeg WebAssembly版本(= FFmpeg . wasm):part . 3 FFmpeg . wasm v 0.1—将avi转码为mp4 </a></p><p id="9428" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">在这一部分，您将学习:</p><ol class=""><li id="ad4e" class="ld le it kd b ke kf ki kj kz lf la lg lb lh ky li lj lk ll bi translated">将Libx264添加到ffmpeg-core.js</li><li id="50e4" class="ld le it kd b ke lm ki ln kz lo la lp lb lq ky li lj lk ll bi translated">浏览器中的ffmpeg.wasm演示</li></ol></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="d583" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">将Libx264添加到ffmpeg-core.js</h1><p id="2b3d" class="pw-post-body-paragraph ka kb it kd b ke mw kg kh ki mx kk kl kz my ko kp la mz ks kt lb na kw kx ky im bi translated">下一步，我们想转码一个avi视频，并在我们的网络浏览器中播放。默认情况下,<code class="fe nb nc nd ne b">ffmpeg-core.js</code>可以将avi代码转换为mp4，但是mp4文件不能在网络浏览器中播放，因为它的编码不被支持。所以我们首先需要将libx264添加到我们的<code class="fe nb nc nd ne b">ffmpeg-core.js</code>中。</p><p id="f769" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">下面是我们将要添加的<code class="fe nb nc nd ne b">x264</code>库的链接:</p><div class="nf ng gp gr nh ni"><a href="https://code.videolan.org/videolan/x264" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">视频局域网/ x264</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">x264，最好最快的H.264编码器</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">code.videolan.org</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw jv ni"/></div></div></a></div><p id="8639" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated"><code class="fe nb nc nd ne b">x264</code>比<code class="fe nb nc nd ne b">ffmpeg</code>更容易建立，以下是你需要通过的关键论点:</p><figure class="nx ny nz oa gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><blockquote class="jx jy jz"><p id="fd59" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">检查存储库中的完整版本<a class="ae lc" href="https://github.com/ffmpegwasm/FFmpeg/blob/n4.3.1-p4/wasm/build-scripts/build-x264.sh" rel="noopener ugc nofollow" target="_blank"> build-x264.sh </a></p></blockquote><p id="324a" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">配置ffmpeg时，必须添加<code class="fe nb nc nd ne b">--enable-gpl</code>和<code class="fe nb nc nd ne b">--enable-libx264</code>标志。</p><figure class="nx ny nz oa gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><blockquote class="jx jy jz"><p id="8cc5" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">检查存储库中的完整版本的<a class="ae lc" href="https://github.com/ffmpegwasm/FFmpeg/blob/n4.3.1-p4/wasm/build-scripts/configure.sh" rel="noopener ugc nofollow" target="_blank"> configure.sh </a>和<a class="ae lc" href="https://github.com/ffmpegwasm/FFmpeg/blob/n4.3.1-p4/wasm/build-scripts/build-ffmpeg.sh" rel="noopener ugc nofollow" target="_blank"> build-ffmpeg.sh </a></p></blockquote><p id="7b9c" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">所有脚本就绪后，现在您可以用<code class="fe nb nc nd ne b">x264</code>构建一个ffmpeg.wasm(可能还有所有其他库。)</p><h1 id="f53a" class="ly lz it bd ma mb od md me mf oe mh mi mj of ml mm mn og mp mq mr oh mt mu mv bi translated">浏览器中的ffmpeg.wasm演示</h1><p id="4319" class="pw-post-body-paragraph ka kb it kd b ke mw kg kh ki mx kk kl kz my ko kp la mz ks kt lb na kw kx ky im bi translated">这个故事的最后一部分是ffmpeg.wasm v0.2.2的演示，场景是创建一个网页，使用户能够上传视频文件(例如avi)并在网络浏览器中播放。由于无法直接播放avi文件，我们将首先使用ffmpeg.wasm对视频进行转码:</p><figure class="nx ny nz oa gt ju gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/cb6d2fbff84e20153b2c8e46f4a86f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/1*05TQjXj_-nJHt3RWpBBilA.gif"/></div></figure><p id="8568" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">以下是完整的HTML代码(在此下载示例视频<a class="ae lc" href="https://github.com/ffmpegwasm/ffmpeg.wasm/raw/master/tests/assets/flame.avi" rel="noopener ugc nofollow" target="_blank">):</a></p><figure class="nx ny nz oa gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><blockquote class="jx jy jz"><p id="a2c5" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">可能需要很长时间才能完成，可以打开DevTools查看日志。检查<a class="ae lc" href="https://github.com/ffmpegwasm/FFmpeg/blob/n4.3.1-p4/wasm/transcode.html" rel="noopener ugc nofollow" target="_blank">transcode.html</a>看看它是如何工作的。</p></blockquote><p id="fa23" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">你可以访问这里的知识库，看看它是如何详细工作的:<a class="ae lc" href="https://github.com/ffmpegwasm/FFmpeg/tree/n4.3.1-p4" rel="noopener ugc nofollow" target="_blank">https://github.com/ffmpegwasm/FFmpeg/tree/n4.3.1-p4</a></p><p id="66f6" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">并且可以在这里随意下载建造神器:【https://github.com/ffmpegwasm/FFmpeg/releases/tag/n4.3.1-p4 T2】</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="c908" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl kz kn ko kp la kr ks kt lb kv kw kx ky im bi translated">这是这一系列故事的一个暂停，希望你学会如何从头开始构建自己的ffmpeg.wasm，并有可能应用于任何其他库。下次见！😃</p></div></div>    
</body>
</html>
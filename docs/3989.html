<html>
<head>
<title>WordPress CMS for Mobile Apps (Ionic + Firebase) — Part 3/4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">移动应用的WordPress CMS(Ionic+Firebase)——第3/4部分</h1>
<blockquote>原文：<a href="https://itnext.io/wordpress-cms-for-mobile-apps-ionic-firebase-part-3-4-63803349a8af?source=collection_archive---------8-----------------------#2020-04-06">https://itnext.io/wordpress-cms-for-mobile-apps-ionic-firebase-part-3-4-63803349a8af?source=collection_archive---------8-----------------------#2020-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3b1d9cc14dea8c685b83a1c35a9df805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HhLNZor-Z4PA5zhJ.png"/></div></div></figure><blockquote class="jy jz ka"><p id="e881" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="iq">第一部分:</em> <a class="ae la" rel="noopener ugc nofollow" target="_blank" href="/wordpress-cms-for-mobile-apps-ionic-firebase-part-1-4-983fea94d12"> <em class="iq">创建具有博客功能的移动应用(Ionic框架)</em> </a></p><p id="985e" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="iq">第二部分:</em> <a class="ae la" href="https://medium.com/@dalenguyen/wordpress-cms-for-mobile-apps-ionic-firebase-part-2-4-759d4dcfbc2e" rel="noopener"> <em class="iq">将帖子数据从WordPress同步到Firebase </em> </a></p><p id="3f6c" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="iq">第三部分:</em> <strong class="ke ir"> <em class="iq">在Ionic app上发布WordPress帖子内容</em> </strong></p><p id="d00e" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="iq">第4部分:为博客功能添加缓存(正在进行)</em></p></blockquote><p id="41bd" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在上一篇文章中，我向你展示了如何从WordPress准备文章。现在是时候在Ionic App上展示帖子了。</p><h1 id="68ba" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">显示来自Restful API的WordPress文章</h1><p id="a8f8" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">在Angular的HttpClient的帮助下，我们可以使用这个服务来调用WordPress Restful API。</p><p id="8c19" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">首先，我们需要添加HttpClientModule</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5c5d" class="mq lf iq mm b gy mr ms l mt mu">// app.module.ts</span><span id="7f84" class="mq lf iq mm b gy mv ms l mt mu">import { HttpClientModule } from '<a class="ae la" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>/http';</span><span id="04e3" class="mq lf iq mm b gy mv ms l mt mu"><a class="ae la" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  declarations: [AppComponent],<br/>  entryComponents: [],<br/>  imports: [<br/>    ...<br/>    HttpClientModule,<br/>  ],<br/>  providers: [<br/>    StatusBar,<br/>    SplashScreen,<br/>    { provide: RouteReuseStrategy, useClass: IonicRouteStrategy },<br/>  ],<br/>  bootstrap: [AppComponent],<br/>})<br/>export class AppModule {}</span></pre><p id="a190" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">然后用HttpClient检索帖子列表。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6201" class="mq lf iq mm b gy mr ms l mt mu">// /src/app/home/home.page.ts</span><span id="1b68" class="mq lf iq mm b gy mv ms l mt mu">import { Component } from '<a class="ae la" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { Observable } from 'rxjs';<br/><strong class="mm ir">import { HttpClient } from '</strong><a class="ae la" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank"><strong class="mm ir">@angular/common</strong></a><strong class="mm ir">/http';</strong></span><span id="053a" class="mq lf iq mm b gy mv ms l mt mu">import { Post } from '../shared/models/post.model';</span><span id="361c" class="mq lf iq mm b gy mv ms l mt mu"><a class="ae la" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-home',<br/>  templateUrl: 'home.page.html',<br/>  styleUrls: ['home.page.scss'],<br/>})<br/>export class HomePage {<br/>  <strong class="mm ir">posts$: Observable&lt;Post[]&gt;;</strong></span><span id="36bf" class="mq lf iq mm b gy mv ms l mt mu">constructor(private http: HttpClient) {<br/>    <strong class="mm ir">this.posts$ = http.get(<br/>      `</strong><a class="ae la" href="http://wordpress.dalenguyen.me/wp-json/wp/v2/posts?_embed`" rel="noopener ugc nofollow" target="_blank"><strong class="mm ir">http://example.com/wp-json/wp/v2/posts?_embed`</strong></a><strong class="mm ir"><br/>    ) as Observable&lt;Post[]&gt;;</strong></span><span id="b032" class="mq lf iq mm b gy mv ms l mt mu">    // Print out the list of posts<br/>    this.posts$.subscribe((posts) =&gt; console.log(posts));<br/>  }<br/>}</span></pre><h1 id="8752" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">显示来自Firestore的WordPress帖子</strong></h1><p id="bc5c" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">假设您的Firestore数据库中有帖子列表。我们可以用help <a class="ae la" href="https://github.com/angular/angularfire" rel="noopener ugc nofollow" target="_blank"> AngularFire </a>包检索数据。</p><p id="e78c" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke ir">第一步:将AngularFire安装到项目上</strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="81c7" class="mq lf iq mm b gy mr ms l mt mu">npm install firebase @angular/fire --save</span></pre><p id="35f8" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke ir">第二步:添加Firebase项目</strong></p><p id="fc45" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">去<a class="ae la" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>创建一个新的应用程序，如果你还没有。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/f2cffa70f70cb18a9035a78b013fd945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vns0hQabOcT5pu9WU5942Q.png"/></div></div></figure><p id="95ef" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">创建新项目后，您将看到Firebase凭据。我们可以把它添加到环境中。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="2f84" class="mq lf iq mm b gy mr ms l mt mu">// /src/environments/environment.ts</span><span id="429c" class="mq lf iq mm b gy mv ms l mt mu">export const environment = {<br/>  production: false,<br/>  firebaseConfig: {<br/>    apiKey: "&lt;your-api-key&gt;",<br/>    authDomain: "&lt;your-auth-domain&gt;",<br/>    databaseURL: "&lt;your-database-url&gt;",<br/>    projectId: "&lt;your-cloud-firestore-project&gt;",<br/>    storageBucket: "&lt;your-storage-bucket&gt;",<br/>    messagingSenderId: "&lt;your-sender-id&gt;",<br/>    appId: "&lt;your-app-id&gt;",<br/>    measurementId: "&lt;your-measurement-id&gt;"<br/>  }<br/>};</span></pre><p id="6162" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">别忘了加上AngularFireModule。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="c726" class="mq lf iq mm b gy mr ms l mt mu">// /src/app/app.module.ts</span><span id="0af7" class="mq lf iq mm b gy mv ms l mt mu"><strong class="mm ir">import { AngularFireModule } from '</strong><a class="ae la" href="http://twitter.com/angular/fire" rel="noopener ugc nofollow" target="_blank"><strong class="mm ir">@angular/fire</strong></a><strong class="mm ir">';<br/>import { AngularFirestoreModule } from '</strong><a class="ae la" href="http://twitter.com/angular/fire" rel="noopener ugc nofollow" target="_blank"><strong class="mm ir">@angular/fire</strong></a><strong class="mm ir">/firestore';</strong></span><span id="c935" class="mq lf iq mm b gy mv ms l mt mu"><strong class="mm ir">import { environment } from 'src/environments/environment';</strong></span><span id="a962" class="mq lf iq mm b gy mv ms l mt mu"><a class="ae la" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  declarations: [AppComponent],<br/>  entryComponents: [],<br/>  imports: [<br/>    BrowserModule,<br/>    IonicModule.forRoot(),<br/>    AppRoutingModule,<br/><strong class="mm ir">    AngularFireModule.initializeApp(environment.firebaseConfig),<br/>    AngularFirestoreModule<br/></strong>  ],<br/>  ...<br/>})<br/>export class AppModule {}</span></pre><p id="a9d6" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke ir">第三步:显示Firestore的帖子</strong></p><p id="23aa" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在Ionic项目中初始化App之后，我们现在可以访问Firestore来检索数据。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="365a" class="mq lf iq mm b gy mr ms l mt mu">// /src/app/home/home.page.ts</span><span id="6d97" class="mq lf iq mm b gy mv ms l mt mu">import { Component } from '<a class="ae la" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { Observable } from 'rxjs';<br/><strong class="mm ir">import { AngularFirestore } from '</strong><a class="ae la" href="http://twitter.com/angular/fire" rel="noopener ugc nofollow" target="_blank"><strong class="mm ir">@angular/fire</strong></a><strong class="mm ir">/firestore';</strong></span><span id="9569" class="mq lf iq mm b gy mv ms l mt mu">import { Post } from '../shared/models/post.model';</span><span id="6c19" class="mq lf iq mm b gy mv ms l mt mu"><a class="ae la" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-home',<br/>  templateUrl: 'home.page.html',<br/>  styleUrls: ['home.page.scss']<br/>})<br/>export class HomePage {<br/>  posts$: Observable&lt;Post[]&gt;;</span><span id="e7dc" class="mq lf iq mm b gy mv ms l mt mu">constructor(private fireStore: AngularFirestore) {<br/>    <strong class="mm ir">this.posts$ = this.fireStore.collection&lt;any&gt;('wpPosts').valueChanges();</strong><br/>  }<br/>}</span></pre><p id="0380" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">基于Post模型，我们可以显示来自模板的数据。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="adac" class="mq lf iq mm b gy mr ms l mt mu">// /src/app/home/home.page.html</span><span id="f918" class="mq lf iq mm b gy mv ms l mt mu">&lt;ion-app&gt;<br/>  &lt;ion-header&gt;<br/>    &lt;ion-toolbar&gt;<br/>      &lt;ion-title&gt;WordPress CMS&lt;/ion-title&gt;<br/>    &lt;/ion-toolbar&gt;<br/>  &lt;/ion-header&gt;</span><span id="21cf" class="mq lf iq mm b gy mv ms l mt mu">&lt;ion-content class="ion-padding"&gt;<br/>    &lt;ion-card *ngFor="<strong class="mm ir">let post of posts$ | async</strong>"&gt;<br/>      &lt;ion-card-header&gt;<br/>        &lt;ion-card-title&gt;{{<strong class="mm ir">post.post_title</strong>}}&lt;/ion-card-title&gt;<br/>      &lt;/ion-card-header&gt;<br/>      &lt;ion-card-content&gt;<br/>        &lt;p&gt;Date &lt;strong&gt;{{<strong class="mm ir">post.post_date | date</strong>}}&lt;/strong&gt;&lt;/p&gt;<br/>        &lt;p&gt;By &lt;strong&gt;{{post.post_author}}&lt;/strong&gt;&lt;/p&gt;<br/>        &lt;img<br/>          [src]="<strong class="mm ir">post.post_thumbnail</strong> ? post.post_thumbnail : '<a class="ae la" href="https://miro.medium.com/max/4800/1*jFsgUxz4Dm4HDIlpMjz8Sg.png'" rel="noopener">https://miro.medium.com/max/4800/1*jFsgUxz4Dm4HDIlpMjz8Sg.png'</a>"<br/>          alt="{{post.post_title}}"<br/>        /&gt;<br/>        &lt;p [innerHTML]="<strong class="mm ir">post.post_excerpt</strong>"&gt;&lt;/p&gt;<br/>      &lt;/ion-card-content&gt;<br/>    &lt;/ion-card&gt;<br/>  &lt;/ion-content&gt;<br/>&lt;/ion-app&gt;</span></pre><p id="548a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">一切都设置好了，你会在你的Ionic app上看到帖子的内容。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/9ca17576fd9b07c2b6579b65a592cac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xh7HpfItqRSPpOEOJ-IEBA.png"/></div></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">帖子是从Firestore检索的</figcaption></figure><p id="7d22" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">我们已经成功地构建了一个Ionic应用程序，提供来自WordPress CMS的内容。</p><p id="d419" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在下一篇文章中，我将向您展示如何添加缓存层，以便更快地检索内容，从而获得更好的性能。</p><p id="239a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">如果你想看完整的工作代码，请在Github上查看:<a class="ae la" href="https://github.com/dalenguyen/ionic-firebase-wordpress" rel="noopener ugc nofollow" target="_blank"> Ionic Firebase WordPress </a></p></div></div>    
</body>
</html>
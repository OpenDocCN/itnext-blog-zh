<html>
<head>
<title>GitOps with Flux and Helm Operator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带通量和舵操作器的GitOps</h1>
<blockquote>原文：<a href="https://itnext.io/gitops-with-flux-and-helm-operator-f41b82e2de95?source=collection_archive---------0-----------------------#2021-03-09">https://itnext.io/gitops-with-flux-and-helm-operator-f41b82e2de95?source=collection_archive---------0-----------------------#2021-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/21f158c12abdb2711ecd7d036fa04fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kt-XrD20J5_TdmnJBAcFjA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">来自<a class="ae kf" href="https://commons.wikimedia.org/wiki/File:Kubernetes_(container_engine).png" rel="noopener ugc nofollow" target="_blank">https://commons . wikimedia . org/wiki/File:Kubernetes _(container _ engine)。png </a></figcaption></figure><p id="6b61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些是我为自己做的笔记，因为在过去的几年里，我一遍又一遍地做这个练习。这个想法是使用<a class="ae kf" href="https://www.weave.works/technologies/gitops/" rel="noopener ugc nofollow" target="_blank"> GitOps </a>将服务部署到Kubernetes集群。在我看来，GitOps的主要优点是它允许团队的所有成员确切地看到正在部署什么，因为所有东西都在Git中。无需在本地笔记本电脑上运行手动<code class="fe le lf lg lh b">helm</code>或<code class="fe le lf lg lh b">kustomize</code>命令。没有偏离系统的“真实状态”。</p><p id="c20a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有几个工具允许您在Kubernetes集群中实现GitOps工作流。我选择了<a class="ae kf" href="https://fluxcd.io/" rel="noopener ugc nofollow" target="_blank">通量</a> (v1，因为v2还在……通量里)和<a class="ae kf" href="https://github.com/fluxcd/helm-operator" rel="noopener ugc nofollow" target="_blank">舵操作员</a>。简而言之，一旦你部署了Flux，它将监视你在Flux配置中指定的Git repo，每5分钟从repo中获取最新代码，并对他们在指定目录及其子目录中找到的清单进行一次大的<code class="fe le lf lg lh b">kubectl apply</code>。赫尔姆操作员是一个CRD，知道如何解释类型<code class="fe le lf lg lh b">HelmRelease</code>的对象。它基本上是在您的集群中为您运行<code class="fe le lf lg lh b">helm upgrade</code>，因此您不必手动操作。我最初的工作是基于来自Weaveworks的Stefan Prodan写的一篇很棒的文章，这家公司首先想到了GitOps这个名字。</p><p id="e671" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也可以配置Flux与Kustomize一起工作。更多细节见本<a class="ae kf" href="https://github.com/fluxcd/flux-kustomize-example" rel="noopener ugc nofollow" target="_blank">示例</a>，本<a class="ae kf" href="https://particule.io/en/blog/flux-kustomize/" rel="noopener ugc nofollow" target="_blank">详细博文</a>。</p><p id="936d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是我关于安装和配置Flux和Helm操作器的注意事项。我将在下面的命令中使用Helm v3。</p><p id="65d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将FluxCD存储库添加到本地舵存储库:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="b3c1" class="lq lr it lh b gy ls lt l lu lv">$ helm repo add fluxcd https://charts.fluxcd.io</span></pre><p id="d0d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在k8s集群中创建fluxcd名称空间:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="45a3" class="lq lr it lh b gy ls lt l lu lv">$ kubectl create ns fluxcd</span></pre><p id="ca15" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获取并扩展通量和舵手-操作员舵手图表:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="9d8b" class="lq lr it lh b gy ls lt l lu lv">$ mkdir charts<br/>$ cd charts<br/>$ helm fetch fluxcd/flux<br/>$ helm fetch fluxcd/helm-operator<br/>$ tar xvfz flux-1.3.0.tgz<br/>$ rm flux-1.3.0.tgz<br/>$ tar xvfz helm-operator-1.0.1.tgz<br/>$ rm helm-operator-1.0.1.tgz</span></pre><p id="7b2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">安装和配置助焊剂</strong></p><p id="4379" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为您的特定k8s集群定制<code class="fe le lf lg lh b">values.yaml</code>通量舵图表<code class="fe le lf lg lh b">mycluster</code>:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="c9ce" class="lq lr it lh b gy ls lt l lu lv">$ cd flux<br/>$ cp values.yaml values_mycluster.yaml</span></pre><p id="67c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行ssh-keyscan来获取git服务器的ssh主机密钥:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="40f8" class="lq lr it lh b gy ls lt l lu lv">$ ssh-keyscan git.mydomain.com</span></pre><p id="341a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">修改自定义<code class="fe le lf lg lh b">values_mycluster.yaml</code>文件:</p><ul class=""><li id="f2f9" class="lw lx it ki b kj kk kn ko kr ly kv lz kz ma ld mb mc md me bi translated">将ssh-keyscan的输出添加到ssh.known_hosts</li><li id="92f2" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">set git . URL:git @ git . my domain . com:cicd/gitops . git</li><li id="0d0a" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">设置git.user和git.email</li><li id="2a34" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">将registry.disableScanning设置为true</li><li id="1e84" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">设置git.path: "clusters/mycluster "</li></ul><p id="0424" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的设置中，我假设您将GitOps清单保存在一个名为<code class="fe le lf lg lh b">gitops</code>的存储库中。我还假设您的特定<code class="fe le lf lg lh b">mycluster</code>集群的清单将存储在那个git repo中的<code class="fe le lf lg lh b">clusters/mycluster</code>下的目录(和子目录)中。</p><p id="3480" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们准备安装通量舵图(我假设你在包含<code class="fe le lf lg lh b">values_mycluster.yaml</code>的目录下):</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="0eea" class="lq lr it lh b gy ls lt l lu lv">$ helm install flux --namespace fluxcd . -f ./values_mycluster.yaml</span></pre><p id="7e71" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，安装<a class="ae kf" href="https://docs.fluxcd.io/en/latest/references/fluxctl/#installing-fluxctl" rel="noopener ugc nofollow" target="_blank"> fluxctl </a>在本地运行各种特定于flux的命令非常有用。例如，让我们检索由flux创建的ssh公钥:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="d77c" class="lq lr it lh b gy ls lt l lu lv">$ fluxctl identity --k8s-fwd-ns fluxcd</span></pre><p id="eecb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您需要将上面命令打印在屏幕上的密钥添加为部署密钥，方法是转到gitops git存储库的设置并粘贴该密钥(具有写访问权限)。</p><p id="40ec" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">安装和配置舵操作员</strong></p><p id="98e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装helmrelease CRD:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="9be6" class="lq lr it lh b gy ls lt l lu lv">$ cd helm-operator<br/>$ wget <a class="ae kf" href="https://raw.githubusercontent.com/fluxcd/helm-operator/master/chart/helm-operator/crds/helmrelease.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/fluxcd/helm-operator/master/chart/helm-operator/crds/helmrelease.yaml</a><br/>$ kubectl apply -f helmrelease.yaml<br/>customresourcedefinition.apiextensions.k8s.io/helmreleases.helm.fluxcd.io created</span></pre><p id="f080" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建一个ssh密钥对和一个名为<code class="fe le lf lg lh b">helm-operator-ssh</code>的k8s秘密。您需要确保秘密中的私有ssh密钥的名称是<code class="fe le lf lg lh b">identity</code>(您可以通过在下面的命令中创建k8s秘密时指定<code class="fe le lf lg lh b">from-file=identity=&lt;PATH_TO_SSH_KEY</code>来做到这一点):</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="2351" class="lq lr it lh b gy ls lt l lu lv">$ ssh-keygen -q -N "" -f $HOME/.ssh/identity-helmoperator<br/>$ kubectl create secret generic helm-operator-ssh --from-file=identity=$HOME/.ssh/identity-helmoperator --namespace fluxcd</span></pre><p id="a772" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为您的特定k8s集群定制<code class="fe le lf lg lh b">values.yaml</code>舵手-操作员舵手图表<code class="fe le lf lg lh b">mycluster</code>:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="a288" class="lq lr it lh b gy ls lt l lu lv">$ cp values.yaml values_mycluster.yaml</span></pre><p id="fda5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行ssh-keyscan来获取git服务器的ssh主机密钥:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="ef28" class="lq lr it lh b gy ls lt l lu lv">$ ssh-keyscan git.mydomain.com</span></pre><p id="553a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">修改自定义<code class="fe le lf lg lh b">values_mycluster.yaml</code>文件:</p><ul class=""><li id="577e" class="lw lx it ki b kj kk kn ko kr ly kv lz kz ma ld mb mc md me bi translated">将ssh-keyscan的输出添加到ssh.known_hosts</li><li id="4cf2" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">将ssh的secretName设置为helm-operator-ssh</li></ul><p id="5262" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装舵-操作员舵图(我假设你在包含<code class="fe le lf lg lh b">values_mycluster.yaml</code>的目录下):</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="7c66" class="lq lr it lh b gy ls lt l lu lv">helm install helm-operator --namespace fluxcd . -f ./values_mycluster.yaml</span></pre><p id="7c0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，您还需要添加$HOME/的内容。ssh/identity-helmoperator作为gitops项目的部署键(不需要写访问)。</p><p id="5246" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在已经安装了flux和helm-operator的舵图，您可以验证它们安装的pod正在fluxcd名称空间中运行:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="e815" class="lq lr it lh b gy ls lt l lu lv">$  kubectl get pods -n fluxcd<br/>NAME                            READY   STATUS    RESTARTS   AGE<br/>flux-57b87fdb6f-pcw28           1/1     Running   0          15m<br/>helm-operator-8d5c65c45-89lhf   1/1     Running   0          53s</span></pre><p id="8f2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查pod的日志以确保没有错误也是一个好主意。我最近在舵操作员日志中遇到了类似以下的错误:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="71a9" class="lq lr it lh b gy ls lt l lu lv">helmVersion=v2 error="failed to prepare chart for release: open /var/fluxd/helm/repository/cache/stable-index.yaml: no such file or directory"</span></pre><p id="96a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我不得不<code class="fe le lf lg lh b">kubectl exec</code>进入helm-operator pod，通过将<code class="fe le lf lg lh b">stable</code> repo指向其新的规范URL <code class="fe le lf lg lh b">charts.helm.sh/stable</code>来更新helm2 repos(显然需要一种更好的方法，通过修改helm-operator配置，但这只是权宜之计):</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="4ae2" class="lq lr it lh b gy ls lt l lu lv">$ kubectl exec -it helm-operator-6cdf868966-x8cdq -n fluxcd -- bash<br/>bash-5.0# helm2 repo add "stable" "https://charts.helm.sh/stable<br/>bash-5.0# helm2 repo update<br/>bash-5.0#  exit</span></pre><p id="7665" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">GitOps部署示例</strong></p><p id="afae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为如何部署GitOps风格的舵图的快速示例，我选择了Stefan Prodan编写的<code class="fe le lf lg lh b">podinfo</code>图。我在<code class="fe le lf lg lh b">gitops</code> repo中创建了两个目录:<code class="fe le lf lg lh b">charts_fetched</code>和<code class="fe le lf lg lh b">charts</code>，然后运行以下命令:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="581d" class="lq lr it lh b gy ls lt l lu lv">$ mkdir charts charts_fetched<br/>$ cd charts_fetched<br/>$ helm repo add podinfo <a class="ae kf" href="https://stefanprodan.github.io/podinfo" rel="noopener ugc nofollow" target="_blank">https://stefanprodan.github.io/podinfo</a><br/>$ helm fetch podinfo/podinfo<br/>$ cp podinfo-5.1.4.tgz ../charts<br/>$ cd ../charts<br/>$ tar xvfz podinfo-5.1.4.tgz<br/>$ rm podinfo-5.1.4.tgz</span></pre><p id="32d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还创建了一个名为<code class="fe le lf lg lh b">clusters/mycluster</code>的目录，并在它下面创建了名为<code class="fe le lf lg lh b">namespaces</code>和<code class="fe le lf lg lh b">releases</code>的目录。</p><p id="61a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe le lf lg lh b">namespaces</code>中，我有一个名为<code class="fe le lf lg lh b">development.yaml</code>的文件，描述了一个<code class="fe le lf lg lh b">Namespace</code> k8s对象。当flux应用时，这将创建一个名为<code class="fe le lf lg lh b">development</code>的名称空间:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="2f3a" class="lq lr it lh b gy ls lt l lu lv">apiVersion: v1<br/>kind: Namespace<br/>metadata:<br/>  name: development</span></pre><p id="cb11" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe le lf lg lh b">releases</code>中，我有一个名为<code class="fe le lf lg lh b">podinfo.yaml</code>的文件，描述了一个<code class="fe le lf lg lh b">HelmRelease</code> k8s对象。当flux应用时，这将由舵操作员CRD解释，并将导致根据本清单中描述的图表执行<code class="fe le lf lg lh b">helm upgrade</code>(或最初的<code class="fe le lf lg lh b">helm install</code>):</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="2d33" class="lq lr it lh b gy ls lt l lu lv">apiVersion: helm.fluxcd.io/v1<br/>kind: HelmRelease<br/>metadata:<br/>  name: podinfo<br/>  namespace: development<br/>  annotations:<br/>    fluxcd.io/automated: "false"<br/>spec:<br/>  releaseName: podinfo<br/>  chart:<br/>    git: git@git.mydomain.com:cicd/gitops.git<br/>    path: charts/podinfo<br/>    ref: master<br/>  values:<br/>    replicaCount: 2</span></pre><p id="9219" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里需要注意一些事情:</p><ul class=""><li id="d182" class="lw lx it ki b kj kk kn ko kr ly kv lz kz ma ld mb mc md me bi translated">我们为这个图表指定了<code class="fe le lf lg lh b">development</code>名称空间——它是通过<code class="fe le lf lg lh b">namespaces</code>目录中的清单创建的</li><li id="dc13" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">我们指定通过git从与清单本身相同的<code class="fe le lf lg lh b">gitops</code>回购中检索<code class="fe le lf lg lh b">podinfo</code>图表；或者，您可以将图表源指定为Helm chart存储库URL(如果有)</li><li id="6557" class="lw lx it ki b kj mf kn mg kr mh kv mi kz mj ld mb mc md me bi translated">我们在<code class="fe le lf lg lh b">podinfo</code>图表中覆盖默认<code class="fe le lf lg lh b">values.yaml</code>文件中的一个值；举个例子，我们将<code class="fe le lf lg lh b">replicaCount</code>设置为<code class="fe le lf lg lh b">2</code>，而不是默认的<code class="fe le lf lg lh b">1</code>。</li></ul><p id="b655" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">重要的是</strong>，在上面清单中的<code class="fe le lf lg lh b">values</code>部分，您可以修改想要通过GitOps/Helm Operator安装的给定图表的任何值。</p><p id="7be7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">有用提示</strong>:我通常从有问题的图表中复制默认<code class="fe le lf lg lh b">values.yaml</code>文件的内容，将它们粘贴到HelmRelease清单的<code class="fe le lf lg lh b">values</code>部分下，将它们向右移动一两个制表符以适当缩进，然后只保留我需要的键并更改它们的值。这将帮助你在缩进问题上保持理智。有些键缩进得很深，如果您错过了缩进级别，它们将不会被正确地覆盖。在那种情况下，可能会引起许多争论。</p><p id="90d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，如果您在<code class="fe le lf lg lh b">gitops</code> repo中提交上面的代码并等待5分钟，那么所有的清单都应该由flux在您的目标<code class="fe le lf lg lh b">mycluster</code> k8s集群中应用。您还可以通过运行以下命令来强制通量同步，这样您就不会等待5分钟:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="75e3" class="lq lr it lh b gy ls lt l lu lv">$ fluxctl sync --k8s-fwd-ns fluxcd</span></pre><p id="6291" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，检查fluxcd名称空间中flux和helm-operator pod的日志。如果一切顺利，您应该会看到在集群的<code class="fe le lf lg lh b">development</code>名称空间中创建了一个名为<code class="fe le lf lg lh b">podinfo</code>的<code class="fe le lf lg lh b">HelmRelease</code>类型的对象。您还应该看到在<code class="fe le lf lg lh b">development</code>名称空间中运行的2个<code class="fe le lf lg lh b">podinfo</code>pod，对应于我们在HelmRelease清单中指定的<code class="fe le lf lg lh b">2</code>的自定义<code class="fe le lf lg lh b">replicaCount</code>:</p><pre class="li lj lk ll gt lm lh ln lo aw lp bi"><span id="761e" class="lq lr it lh b gy ls lt l lu lv">$ kubectl get hr -n development<br/>NAME      RELEASE   PHASE       STATUS     MESSAGE                                                               AGE<br/>podinfo   podinfo   Succeeded   deployed   Release was successful for Helm release 'podinfo' in 'development'.   16m</span><span id="471c" class="lq lr it lh b gy mk lt l lu lv">$ kubectl get pods -n development</span><span id="6fbc" class="lq lr it lh b gy mk lt l lu lv">NAME                       READY   STATUS    RESTARTS   AGE<br/>podinfo-6db7f57595-njrgk   1/1     Running   0          10m<br/>podinfo-6db7f57595-wvn7w   1/1     Running   0          10m</span></pre><p id="1c18" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在另一篇文章中，我将展示一个SonarQube舵图的真实部署，使用与这里描述的相同的方法。</p></div></div>    
</body>
</html>
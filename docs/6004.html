<html>
<head>
<title>Should You Use DynamoDB or MongoDB?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应该用DynamoDB还是MongoDB？</h1>
<blockquote>原文：<a href="https://itnext.io/should-you-use-dynamodb-or-mongodb-e77f013e9914?source=collection_archive---------1-----------------------#2021-07-23">https://itnext.io/should-you-use-dynamodb-or-mongodb-e77f013e9914?source=collection_archive---------1-----------------------#2021-07-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0c15" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从开发者的角度比较NoSQL。</h2></div><p id="0d32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我的职业生涯中，我大部分时间都在使用MongoDB，所以我决定在我当前的项目中使用DynamoDB。这是我的发现。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/46df003bbb435dd9b850c807d7801d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tOIjfl0EtGgG69Fa"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae lu" href="https://unsplash.com/@max_duz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Max Duzij </a>拍照</figcaption></figure><h1 id="1dd1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置</h1><p id="0860" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">DynamoDB或MongoDB的设置相对容易。</p><h2 id="2fe8" class="ms lw it bd lx mt mu dn mb mv mw dp mf kr mx my mh kv mz na mj kz nb nc ml nd bi translated">DynamoDB设置</h2><p id="a7cd" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">设置DynamoDB与其他Amazon服务(如EC2)协同工作非常简单。访问数据库不需要AWS键。相反，为EC2实例分配正确的DynamoDB IAM角色，它将自动拥有对数据库的正确访问权。</p><p id="c052" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到DynamoDB的连接代码再简单不过了，如下面的代码示例所示。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="f023" class="ms lw it bd lx mt mu dn mb mv mw dp mf kr mx my mh kv mz na mj kz nb nc ml nd bi translated">MongoDB设置</h2><p id="4cb0" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">使用MongoDB设置，我们最终会得到稍微多一点的代码语句，但是设置仍然非常简单，正如我们在下面的例子中看到的。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="cba5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">主要区别是MongoDB连接URI需要设置为环境变量，以便应用程序访问数据库。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="a381" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">编写查询</h1><p id="5316" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">MongoDB和DynamoDB库的结构非常不同，这使得一些查询不太方便。</p><p id="7406" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的例子中，我们将使用JavaScript作为编写查询的基础。</p><h1 id="2b33" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用MongoDB编写查询</h1><p id="3036" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">用MongoDB编写查询非常简单，不需要特定的预先设置。唯一要确保的是正确设置索引，以确保高性能的查询。最坏的情况是，索引可以随时添加。</p><p id="f0f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个例子获取查询，获取一个用户的电子邮件地址和电话号码如下:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ne nf l"/></div></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="68dc" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">使用DynamoDB编写查询</h1><p id="1c0e" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">对于DynamoDB，我们需要更加小心。初始设置需要深思熟虑，因为过滤或搜索不同的字段可能最终需要更改初始设置！</p><p id="a64f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更改表的设置需要您删除并重新创建它。可以想象，这并不理想。</p><h2 id="0b7e" class="ms lw it bd lx mt mu dn mb mv mw dp mf kr mx my mh kv mz na mj kz nb nc ml nd bi translated">DynamoDB:使用表键获取用户</h2><p id="19c3" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">通过电子邮件地址和电话号码获取用户的查询示例如下所示。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="2ca8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到目前为止一切顺利，对吧？这似乎很容易获得用户！关键来了。该数据定义了作为查询的一部分发送给DynamoDB的<strong class="kk iu">主键</strong>。这意味着这只适用于主键！</p><p id="e71b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">主键在获取数据时非常有效，但是AWS只允许每个表最多定义2个键，即分区键和排序键。组合起来，这些被称为组合键。</p><h2 id="db8e" class="ms lw it bd lx mt mu dn mb mv mw dp mf kr mx my mh kv mz na mj kz nb nc ml nd bi translated">DynamoDB:使用过滤器表达式获取用户</h2><p id="cad9" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">到目前为止，我们已经确认了使用DynamoDB通过主键获取数据是很容易的。让我们试着复制我们用MongoDB做的例子，其中我们选择的数据不一定是键，而可能是索引列。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="0ce3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这类似于前面的MongoDB查询。有一些关键的区别。使用DynamoDB，我们需要显式地发送类似SQL条件的过滤器表达式。当我们想按主键过滤时，需要在对象的key字段中显式指定键。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="e864" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">将查询与MongoDB进行比较</h1><p id="67ef" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">然而，使用MongoDB，就像根据您的需求传递一个对象一样简单。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="b3b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样，没有多余的大惊小怪。至少，如果DynamoDB有一些API允许我们从一个对象自动生成过滤器表达式就好了。这将是一个非常受欢迎的改进，而不是让每个客户端应用程序都编写过滤器生成代码。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="ee15" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">弥合差距</h1><p id="ce76" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">为了避免反复编写表达式过滤器生成代码，我创建了一个小型开源库，名为<strong class="kk iu"> Dynamongo </strong>。它的目标是为开发人员简化DynamoDB查询语法，以便自动生成表达式过滤器。</p><div class="ns nt gp gr nu nv"><a href="https://github.com/KevinVR/dynamongo" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">GitHub - KevinVR/dynamongo:一个简单的库，可以使用MongoDB风格轻松查询DynamoDB</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">从MongoDB到DynamoDB，有一些抽象可以让我们的生活变得更容易。对于…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj lo nv"/></div></div></a></div><p id="1400" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本的功能已经可用，并使查询DynamoDB数据变得更容易，但是，仍然有许多项目可以添加。如果您发现任何缺失的特性，请随时向存储库发送请求！</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="5c1f" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">定价模型</h1><h2 id="75b1" class="ms lw it bd lx mt mu dn mb mv mw dp mf kr mx my mh kv mz na mj kz nb nc ml nd bi translated">MongoDB Atlas定价</h2><p id="115c" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">MongoDB的定价是在云中运行一个MongoDB服务器的价格。无论查询次数多少，服务器的成本都是一样的，除非升级。</p><p id="2b18" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在撰写本文时，一个专用的MongoDB服务器每月的费用是57美元。</p><p id="0ca1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">MongoDB Atlas正在推出一个名为serverless的新功能，目前正在预览中。MongoDB不会为服务器付费，而是在任何可用的服务上运行您的查询。其定价可降至每百万次读取请求0.30美元，此外还有数据存储和写入请求的额外成本。</p><h2 id="874d" class="ms lw it bd lx mt mu dn mb mv mw dp mf kr mx my mh kv mz na mj kz nb nc ml nd bi translated">AWS DynamoDB定价</h2><p id="82da" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">AWS的DynamoDB类似于MongoDB Atlas的无服务器模式。您不需要支付运行具有特定容量的实例的成本。相反，您只需为进入数据库的请求数量付费。</p><p id="42a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在写这篇文章的时候，在美国东俄亥俄州，价格下降到0.25美元/百万次阅读请求。请记住，除了读取请求，还有更多成本。写请求和存储成本也应该考虑在内。</p><p id="ddce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想了解更多关于典型AWS定价的信息，我们已经专门为此撰写了一篇文章！</p><div class="ns nt gp gr nu nv"><a href="https://aws.plainenglish.io/how-much-does-aws-really-cost-1cf5f30b6a81" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">AWS到底值多少钱？</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">MERN堆栈的典型AWS定价示例</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">aws .平原英语. io</p></div></div><div class="oe l"><div class="ok l og oh oi oe oj lo nv"/></div></div></a></div></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="86cd" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">最终比较</h1><p id="dc1f" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">虽然查询API是AWS仍然可以在DynamoDB上改进的地方，但对于AWS上托管的应用程序来说，它仍然是一个令人惊叹的选择。与AWS服务的集成程度非常高。此外，就成本而言，您实际上只需为您使用的东西付费。</p><p id="1ebf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">MongoDB很棒，提供了非常直观的查询API，然而，MongoDB Atlas的主要产品是一种非常不同的定价策略。您实际上为缩放付费，而不管您实际使用的是什么。除非您使用无服务器MongoDB选项，否则迁移到更昂贵的MongoDB实例在开始时会很昂贵，该选项仍在预览中。我建议快速浏览他们的定价，计算哪一个更适合你的项目，不仅仅是在开始，还要考虑成本的长期影响。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="63a9" class="lv lw it bd lx ly nn ma mb mc no me mf jz np ka mh kc nq kd mj kf nr kg ml mm bi translated">结论</h1><p id="c690" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">这是否意味着，您应该只使用DynamoDB，或者只对您的所有项目使用MongoDB？一点也不。这是我们可以使用的两个伟大的数据库引擎，它们都有各自的优缺点。选择数据库引擎和托管是任何项目的重要技术决策。根据您项目的标准，其中一个可能比另一个更适合。本文中的比较会让您对不同之处有更多的了解。</p><p id="969e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了易用性，我们还是更喜欢MongoDB。对于更复杂的功能，将会有更多的差异，我们可以在下一篇文章中进行比较。至于定价，MongoDB现在提供了一个无服务器选项，尽管它仍处于预览阶段。它不提供AWS与其他AWS服务的紧密集成。</p><p id="e1a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将继续在我的项目中使用DynamoDB，纯粹是为了与AWS紧密集成，以及非常可伸缩的定价模型。这是获得更多DynamoDB经验的绝佳借口！</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to use Angular ngModel and ngForms with WebComponents</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Angular ngModel和ngForms与WebComponents一起使用</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-use-angular-ngmodel-and-ngforms-with-webcomponents-802bd9e1d3d7?source=collection_archive---------5-----------------------#2020-05-19">https://itnext.io/how-to-use-angular-ngmodel-and-ngforms-with-webcomponents-802bd9e1d3d7?source=collection_archive---------5-----------------------#2020-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7f97d38eadd64f4fd60a98d424c1a588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TYylQcOLsEHlS5PhymhFw.png"/></div></div></figure><p id="9de7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Web组件是一个真正有趣的工具，它可以改变我们使用web技术的方式，因为它们使我们能够忘记我们选择的框架，开始考虑框架无关性。</p><p id="1d43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但除了这些好处，有时候很难与我们最喜欢的框架集成，在这种情况下是Angular。我们将需要一些变化，使框架与web组件正常通信。</p><p id="e5c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今天我们将讨论我们想要在角度形式中使用的组件类型，我们将讨论存储值的元素，例如:输入、选择器、日期选择器。一般来说，存储值并通过用户交互发回新结果的任何元素。</p><p id="4682" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了理解如何在我们的web组件中使用指令<code class="fe kw kx ky kz b">ngModel</code>或<code class="fe kw kx ky kz b">formControl</code>，理解angular如何管理<code class="fe kw kx ky kz b">&lt;input/&gt;</code>或<code class="fe kw kx ky kz b">&lt;textarea&gt;&lt;/textarea&gt;</code>的使用是很重要的</p><p id="bafd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们看一看<a class="ae la" href="https://www.w3schools.com/tags/tag_input.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/tags/tag_input.asp</a>我们可以看到这些元素有共同的属性，更具体地说，它们有:</p><ul class=""><li id="0c28" class="lb lc iq ka b kb kc kf kg kj ld kn le kr lf kv lg lh li lj bi translated"><code class="fe kw kx ky kz b">value</code>:作为存储de值的属性</li><li id="76a3" class="lb lc iq ka b kb lk kf ll kj lm kn ln kr lo kv lg lh li lj bi translated"><code class="fe kw kx ky kz b">onChange</code>:作为通知该值变化的输出事件</li></ul><p id="794e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这两个属性在所有HTML表单元素中都很常见，因此认为我们的web组件必须具有这个属性才能使用Angular是有道理的。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="2c42" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">Angular是如何工作的？</h1><p id="5fa2" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">像<code class="fe kw kx ky kz b">ngModel</code>、<code class="fe kw kx ky kz b">formControl</code>和<code class="fe kw kx ky kz b">formControlName</code>这样的角度指令使用Angular中的默认模式来决定对元素的访问逻辑。</p><p id="c371" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们看一下<code class="fe kw kx ky kz b">angular/core </code>代码，我们可以看到指令<strong class="ka ir"> DefaulValueAccesor的实现。</strong></p><blockquote class="mz na nb"><p id="2522" class="jy jz nc ka b kb kc kd ke kf kg kh ki nd kk kl km ne ko kp kq nf ks kt ku kv ij bi translated"><a class="ae la" href="https://github.com/angular/angular/blob/9.1.x/packages/forms/src/directives/default_value_accessor.ts" rel="noopener ugc nofollow" target="_blank">https://github . com/angular/angular/blob/9.1 . x/packages/forms/src/directives/default _ value _ accessor . ts # L47</a></p></blockquote><p id="430e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以在这个文件中找到两个不同部分:</p><h2 id="c8af" class="ng lx iq bd ly nh ni dn mc nj nk dp mg kj nl nm mk kn nn no mo kr np nq ms nr bi translated">选择器:</h2><figure class="ns nt nu nv gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="a08a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们可以看到这个指令影响了女巫元素。</p><h2 id="223a" class="ng lx iq bd ly nh ni dn mc nj nk dp mg kj nl nm mk kn nn no mo kr np nq ms nr bi translated">实施:</h2><figure class="ns nt nu nv gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="637c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们可以看到，Angular是如何管理<code class="fe kw kx ky kz b">value </code>属性和事件<code class="fe kw kx ky kz b">onChange </code>的。</p><p id="40db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然我们知道angular在默认情况下如何管理输入元素，那么是时候使用这个方法来告诉Angular如何管理我们的组件了。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="a7dd" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">如何在我们的web组件中启用ngModel和formControl？</h1><p id="4b06" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">有两种方法可以将<code class="fe kw kx ky kz b">ngModel</code>和<code class="fe kw kx ky kz b">formControl</code>用于我们的web组件。</p><p id="0e07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一个，只要我们使用我们在前面段落中定义的标准方式实现我们的web组件，将只是告诉Angular我们的组件将使用<em class="nc">defaultvalueaccessor</em>，所以Angular试图在我们的组件中找到<code class="fe kw kx ky kz b">value</code>和<code class="fe kw kx ky kz b">onChange</code>。</p><p id="66c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们记得我们解释Angular如何工作的第一段代码，最后一个选择器元素是:<code class="fe kw kx ky kz b">[ngDefaultControl]</code>，这意味着如果你使用<code class="fe kw kx ky kz b">ngModel</code>的任何组件有这个属性，Angular将使用默认行为。</p><figure class="ns nt nu nv gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="747b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但另一方面，在我们所有的组件中添加<code class="fe kw kx ky kz b">ngDefaultControl</code>可能不是最好的方式，或者我们只是想以不同的方式实现我们的组件行为和内部变量。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="4300" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">像专家一样使用ngModel和formControl</h1><p id="4c39" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">正如我们之前提到的，我们可以让我们的组件使用<code class="fe kw kx ky kz b">ngModel</code>或<code class="fe kw kx ky kz b">formControl</code>，而不用告诉Angular使用默认模式，也不用实现标准的<em class="nc">值，onChange </em>系统。</p><p id="4260" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，我们将覆盖DefaultValueAccesor，这样我们将告诉angular witch元素我们想要与<code class="fe kw kx ky kz b">ngModel</code>一起使用，以及元素的哪些输入和输出必须使用angular。</p><figure class="ns nt nu nv gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="71a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们在这段代码中看到的，首先我们要定义哪些HTML标签必须受该指令的影响，然后告诉Angular with property或event必须在我们的组件内部进行监视，以执行成功的数据绑定或利用像onFocus或onDirty这样的formControl特性。</p><p id="3e6e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以从现在开始，我们只需要将这个文件添加到我们想要影响的模块中的数组声明中，并在我们的web组件中使用<code class="fe kw kx ky kz b">[(ngModel)]</code>或<code class="fe kw kx ky kz b">formControl</code>。正如我提到的，ReactiveForm也使用这个选择器，所以它们的所有功能都可以用于web组件。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="3964" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">一些建议</h1><p id="4a92" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">即使您可以为值属性和输出事件使用您想要的名称来创建webComponent，我也强烈建议尝试保持标准的命名约定，这意味着使用值作为属性、onChange、onBlur或onFocus来发出更改、模糊和聚焦事件。通过这样做，您将只需要一个ControlValue覆盖所有的选择器声明。</p></div></div>    
</body>
</html>
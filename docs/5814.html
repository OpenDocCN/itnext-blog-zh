<html>
<head>
<title>How to execute terminal commands with your voice on Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Linux上用你的声音执行终端命令</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-execute-terminal-commands-with-your-voice-on-linux-eb1f6de58bff?source=collection_archive---------0-----------------------#2021-06-01">https://itnext.io/how-to-execute-terminal-commands-with-your-voice-on-linux-eb1f6de58bff?source=collection_archive---------0-----------------------#2021-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cdd62968fd12e3a9ab5894cf976ec844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5NZUOF9aPYWeC3a8zAIq5Q.jpeg"/></div></div></figure><p id="a9e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开源NLP工具<a class="ae kw" href="http://voice2json.org/" rel="noopener ugc nofollow" target="_blank"> voice2json </a>最近在<a class="ae kw" href="https://news.ycombinator.com/item?id=27235970" rel="noopener ugc nofollow" target="_blank">黑客新闻</a>上引起了我的注意:</p><blockquote class="kx ky kz"><p id="c149" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><em class="iq"> voice2json是一个命令行工具集合，用于Linux上的离线语音/意图识别。它是免费的、开源的(MIT)，支持17种人类语言。</em></p></blockquote><p id="ea61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这让我想到，用这个工具只用你的声音来执行终端命令会有多难，事实证明…不是很难！</p><h1 id="4127" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">安装</strong></h1><p id="28e8" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">参见<a class="ae kw" href="http://voice2json.org/install.html" rel="noopener ugc nofollow" target="_blank">文档</a>了解voice2json安装说明的全部细节。</p><p id="6b3a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我的第一次尝试中，我使用了<a class="ae kw" href="http://voice2json.org/install.html#docker-image" rel="noopener ugc nofollow" target="_blank"> Docker映像</a>，但是我确实遇到了<a class="ae kw" href="https://github.com/synesthesiam/voice2json/issues/21" rel="noopener ugc nofollow" target="_blank">音频输入被Docker拾取的问题</a>，所以为了更平稳地启动过程，我推荐使用<a class="ae kw" href="http://voice2json.org/install.html#debian-package" rel="noopener ugc nofollow" target="_blank"> Debian包</a>，你可以在他们的<a class="ae kw" href="https://github.com/synesthesiam/voice2json/releases" rel="noopener ugc nofollow" target="_blank"> GitHub版本</a>中找到它。</p><p id="3482" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你还需要<a class="ae kw" href="http://voice2json.org/install.html#download-profile" rel="noopener ugc nofollow" target="_blank">下载一个简介</a>，对于英语，我去找了他们推荐的<a class="ae kw" href="https://github.com/synesthesiam/en-us_pocketsphinx-cmu" rel="noopener ugc nofollow" target="_blank"> Pocketsphinx </a>，到目前为止它对我很有用。下载。t<a class="ae kw" href="https://github.com/synesthesiam/en-us_pocketsphinx-cmu/releases" rel="noopener ugc nofollow" target="_blank">ar.gz文件</a>并解压到`＄HOME/。config/voice2json `。这本质上就是你训练好的离线机器学习模型。</p><h1 id="c542" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">基本用法</strong></h1><p id="d7e9" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">首先，您需要运行命令:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="2423" class="mq lf iq mm b gy mr ms l mt mu">voice2json train-profile</span></pre><p id="fa89" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">应该只需要一两秒钟。</p><p id="bf26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要检查一切是否正常运行:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="452a" class="mq lf iq mm b gy mr ms l mt mu">voice2json transcribe-stream --open</span></pre><p id="09fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将转录您的讲话，并以json格式将各种相关信息输出到“stdout”。现在，我有北方英语口音，所以对我来说转录当然不是完美的，但是当结合语音识别和意图识别时，这种工具的力量来自于它。</p><p id="11d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以定义一组与给定“意图”相关的短语，因此“打开起居室的灯”可以映射到意图“改变状态”。这些意图映射在文件`$HOME/中定义。你可以在这里看到一个例子<a class="ae kw" href="https://github.com/synesthesiam/en-us_pocketsphinx-cmu/blob/master/sentences.ini" rel="noopener ugc nofollow" target="_blank"/>。更多细节见<a class="ae kw" href="http://voice2json.org/#how-it-works" rel="noopener ugc nofollow" target="_blank">如何工作</a>。</p><p id="ee8e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以下面的命令:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="06c4" class="mq lf iq mm b gy mr ms l mt mu">voice2json transcribe-stream | voice2json recognize-intent</span></pre><p id="d128" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将尝试将您所说的话与最接近的匹配短语匹配，从而匹配意图。我发现当我用满手的短语时，这个工具非常善于发现正确的意图，甚至是我的口音！</p><h1 id="ebb0" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">如何执行命令</strong></h1><p id="26df" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">现在我们已经有了从一组可能性中识别我们意图的工具，我们现在如何使用它来执行终端命令呢？</p><p id="e413" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Fifo命名管道</strong></p><p id="c7a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要做一个fifo(先进先出)<a class="ae kw" href="https://man7.org/linux/man-pages/man7/fifo.7.html" rel="noopener ugc nofollow" target="_blank">命名管道</a>，这将最终允许我们将命令从一个终端传输到另一个终端。让我们创建一个名为`/tmp/mypipe '的管道，它将在以下位置创建一个文件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="0e25" class="mq lf iq mm b gy mr ms l mt mu">mkfifo /tmp/mypipe</span></pre><p id="0bd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">决定你的命令集</strong></p><p id="d5ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我从选择几个基本的git命令开始，我将下面的命令保存到`＄HOME/。config/voice 2 JSON/sentences . ini `:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="e752" class="mq lf iq mm b gy mr ms l mt mu">[~/status.sh]<br/>status</span><span id="45dd" class="mq lf iq mm b gy mv ms l mt mu">[~/fetch.sh]<br/>fetch</span><span id="da7b" class="mq lf iq mm b gy mv ms l mt mu">[~/diff.sh]<br/>diff</span></pre><p id="7e68" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，它将语音“status”映射到intent ` ~/status . sh `, intent实际上是保存到我的机器上的这个位置的一个文件，稍后将执行这个文件。</p><p id="c49e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这三个文件的内容是:</p><p id="16ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">~/status.sh:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="3f3b" class="mq lf iq mm b gy mr ms l mt mu">#!/bin/bash<br/>git status</span></pre><p id="679d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">~/fetch.sh:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8ee0" class="mq lf iq mm b gy mr ms l mt mu">#!/bin/bash<br/>git fetch --verbose</span></pre><p id="0c21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">~/diff.sh:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ad33" class="mq lf iq mm b gy mr ms l mt mu">#!/bin/bash<br/>git diff --exit-code</span></pre><p id="eb37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过在每个文件上运行“sudo chmod +x <file>”来确保这些文件是可执行的。</file></p><p id="d90f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">命令执行</strong></p><p id="3e09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下bash命令将执行写入命名管道`/tmp/mypipe '的任何行，在git存储库中的终端中运行该命令:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6e8b" class="mq lf iq mm b gy mr ms l mt mu">tail -f /tmp/mypipe | sh &amp;</span></pre><p id="adc6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">向命名管道发送意图</strong></p><p id="100f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开第二个终端并运行:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8bd2" class="mq lf iq mm b gy mr ms l mt mu">voice2json transcribe-stream | voice2json recognize-intent | (while read -r LINE; do echo “line is: $LINE”; echo “$LINE” | jq -r ‘.intent.name’ &gt; /tmp/mypipe; done;)</span></pre><p id="05b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实际上，每当voice2json工具识别出一个意图时，json blob就被回显到“stdout ”,但是它也通过管道传送到“jq”工具，该工具提取意图名称，在本例中是文件的名称，并将其发送到命名管道“/tmp/mypipe”。</p><p id="2fdc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果您说出单词“status ”,您应该会看到在第一个终端中运行命令“git status ”!</p><figure class="mh mi mj mk gt jr"><div class="bz fp l di"><div class="mw mx l"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">终端语音命令演示</figcaption></figure><h1 id="3541" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">接下来的步骤</strong></h1><p id="12a2" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">既然我们已经证明了能够只用我们的声音执行一行bash命令的概念，那么这个概念很容易扩展到运行python脚本，启动一个<a class="ae kw" href="https://www.ansible.com/" rel="noopener ugc nofollow" target="_blank"> ansible </a> deploy或者任何您喜欢的东西。</p><p id="bc4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在生产环境中，这种快速破解肯定不是您想要依赖的东西。Voice2json确实提供了通过<a class="ae kw" href="https://mqtt.org/" rel="noopener ugc nofollow" target="_blank"> MQTT </a>向<a class="ae kw" href="https://mosquitto.org/" rel="noopener ugc nofollow" target="_blank"> Mosquitto </a>这样的经纪人<a class="ae kw" href="http://voice2json.org/commands.html#stream-events" rel="noopener ugc nofollow" target="_blank">发布意图识别事件</a>的能力。更健壮的解决方案是使用MQTT客户机来订阅这些事件，以便对它们做出反应。这当然可以将您的力量扩展到通过语音而不仅仅是终端来控制物联网设备的领域。</p><p id="97ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果使用得当，这种设置可以提高开发人员的工作效率。这让我想到用你的声音执行IDE快捷方式会很酷，我选择的IDE是<a class="ae kw" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS Code </a>，为了让IDE能够与voice2json工具交互，我必须编写一个VS Code插件。在此之前，继续深入下去，我做了一个可用的VS代码扩展的快速搜索，看看是否已经存在一个语音命令插件，这时我发现…</p><h1 id="0662" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">Serena de . ai</strong></h1><p id="210b" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated"><a class="ae kw" href="https://serenade.ai/" rel="noopener ugc nofollow" target="_blank">塞拉诺</a>自称:</p><blockquote class="kx ky kz"><p id="b370" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><em class="iq">使用自然语言编程的最有效方法。通过在工作流程中添加语音来提高您的工作效率。</em></p></blockquote><p id="264d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它采用了软件语音控制的概念，并与它一起运行了一英里，有最流行的ide插件和Python，JavaScript，Java，C++，HTML等编程语言支持。这一点的执行完全是专业的，文档<a class="ae kw" href="https://serenade.ai/docs/" rel="noopener ugc nofollow" target="_blank">是该产品质量的良好指标。你不仅可以用它在你的IDE中用你的声音写代码，你还可以使用</a><a class="ae kw" href="https://serenade.ai/docs/chrome/" rel="noopener ugc nofollow" target="_blank"> Chrome扩展</a>用声音命令改变窗口焦点和浏览网页。</p><p id="deab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">除了数据隐私，免费层给了你几乎所有的东西。上机教程真的是一次很愉快的体验，每个微小的细节都考虑到了。你甚至可以编写你自己的<a class="ae kw" href="https://serenade.ai/docs/api/" rel="noopener ugc nofollow" target="_blank">自定义语音命令</a>或者编写你自己的<a class="ae kw" href="https://serenade.ai/docs/protocol/" rel="noopener ugc nofollow" target="_blank">自定义插件</a>与Seranade集成。</p><p id="bc94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我是否会将它集成到我的日常开发工作流程中还有待观察，最多我可以看到自己在这里和那里使用它作为一些快捷方式，而不是扔掉我的键盘。</p><p id="b04a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你像我一样现在在家工作，在工作的时候对着电脑说话会更容易接受一些，但是当我的狗对着我的电脑大喊“去捡球”的时候，它总是认为我有球要扔…</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="63be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="la">最初发表于:</em><a class="ae kw" href="https://www.mitchell-harle.dev/execute-commands-with-voice/" rel="noopener ugc nofollow" target="_blank"><em class="la">【https://www.mitchell-harle.dev/execute-commands-with-voice/】</em></a></p></div></div>    
</body>
</html>
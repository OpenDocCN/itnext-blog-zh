<html>
<head>
<title>Learn how Full-stack apps work by building a simple one using JavaScript (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过使用JavaScript构建一个简单的应用程序来了解全栈应用程序是如何工作的(第1部分)</h1>
<blockquote>原文：<a href="https://itnext.io/learn-how-full-stack-apps-work-by-building-a-simple-one-using-javascript-part-1-38e237694012?source=collection_archive---------1-----------------------#2018-11-17">https://itnext.io/learn-how-full-stack-apps-work-by-building-a-simple-one-using-javascript-part-1-38e237694012?source=collection_archive---------1-----------------------#2018-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7272" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak">通过构建一个简单的假天气API了解全栈应用如何工作</strong></h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d4193627b2c0c71f4431249f759011a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofMfrqFMfpaTH_RMvI_RQA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片由<a class="ae kv" href="https://unsplash.com/@clemhlrdt" rel="noopener ugc nofollow" target="_blank">克莱门特·H</a>拍摄</figcaption></figure><p id="a706" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程将带你完成创建一个简单的假天气API的过程(假是因为我们使用的数据是虚构的)。之后，我们将构建一个简单的前端表单，并从我们的API获取数据。如果您是Node和Express的新手，或者是一名前端开发人员，希望了解API如何从工作中获取数据，那么本文适合您。</p><blockquote class="ls lt lu"><p id="a9f8" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/learn-how-full-stack-apps-work-by-building-a-simple-one-using-javascript-part-2-45b42c1f2e84">第2部分——构建一个可以从后端API获取数据的前端应用程序</a></p></blockquote></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><p id="5e3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我们正在构建的非常简单，但是我们涉及的概念与用于构建更大的应用程序的概念是相同的。</p><p id="cc2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个两部分的系列。你可以在这里找到第二部<a class="ae kv" href="https://medium.com/@maher.alkendi2/learn-how-full-stack-apps-work-by-building-a-simple-one-using-javascript-part-2-45b42c1f2e84" rel="noopener"/>。在这一部分，我们将只是我们的应用程序的后端部分</p><h1 id="e4a4" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">步骤1:项目设置</h1><p id="c61e" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">在深入学习本教程之前，您需要具备以下条件:</p><ul class=""><li id="98eb" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated"><a class="ae kv" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>(我用的是v10.11.0)</li><li id="3cc5" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><a class="ae kv" href="https://www.npmjs.com/get-npm" rel="noopener ugc nofollow" target="_blank"> npm </a>(我用的是6.4.1)</li><li id="af30" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">一个文本编辑器(我用的是<a class="ae kv" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS代码</a></li><li id="fd14" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">一个浏览器(我绝对推荐<a class="ae kv" href="https://www.google.com/chrome/" rel="noopener ugc nofollow" target="_blank"> Chrome </a>或者<a class="ae kv" href="https://www.mozilla.org/en-US/firefox/new/" rel="noopener ugc nofollow" target="_blank"> Firefox </a></li></ul><p id="e259" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，您不需要像我一样拥有Node和npm的确切版本，这样就可以工作。如果你在配置这些方面有任何问题，请在下面评论，我很乐意帮助你。一旦你有了这些设置，就该下载或克隆启动代码了。你可以在我的Github上找到这些文件。如果您不了解存储库中每个文件的功能，请不要担心，我们将介绍每个相关文件及其功能。</p><h1 id="180d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">步骤2:理解启动文件</h1><p id="c4a1" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">如果您成功地克隆了起始代码存储库，那么您应该拥有这样的文件结构:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="b5cf" class="nw mh iq ns b gy nx ny l nz oa">/Fake-Weather-API<br/>  .gitignore<br/>  README.md<br/>  data.js<br/>  index.js<br/>  package-lock.json<br/>  package.json</span></pre><p id="5a51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们看看我们的<code class="fe ob oc od ns b">package.json</code>文件</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="bfdd" class="nw mh iq ns b gy nx ny l nz oa">{<br/>  "name": "fake_weather_api_starter",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "author": "Maher Alkendi",<br/>  "license": "ISC",<br/>  "dependencies": {<br/>    "express": "^4.16.4"<br/>  }<br/>}</span></pre><p id="9df4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个文件包含关于我们的应用程序的主要信息。注意，我们只有一个依赖，就是<code class="fe ob oc od ns b">express</code>。Express是一个Web框架，它使得使用node构建服务器端应用程序变得很容易。点击阅读更多相关信息<a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="e022" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来我们看一下我们的<code class="fe ob oc od ns b">index.js</code>文件</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="09ff" class="nw mh iq ns b gy nx ny l nz oa">const express = require('express'); // import express<br/>const app = express(); // initialize express</span><span id="32d0" class="nw mh iq ns b gy oe ny l nz oa">// Listen on port 3000<br/>app.listen(3000, function() {<br/>  console.log('listening on port 3000...');<br/>})</span></pre><p id="d5b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这段代码所做的只是在端口3000上初始化一个express服务器。随着我们的发展，我们将增加更多的功能。</p><p id="98c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们签出<code class="fe ob oc od ns b">data.js</code>文件</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="853c" class="nw mh iq ns b gy nx ny l nz oa">const fakeWeatherData = [<br/>  {<br/>    'city': 'muscat',<br/>    'temperature (C)': '37 C',<br/>    'temperature (F)': '98.6 F',<br/>  },<br/>  {<br/>    'city': 'tokyo',<br/>    'temperature (C)': '16 C',<br/>    'temperature (F)': '61 F',<br/>  },<br/>  {<br/>    'city': 'moscow',<br/>    'temperature (C)': '18 C',<br/>    'temperature (F)': '64 F',<br/>  },<br/>  {<br/>    'city': 'sydney',<br/>    'temperature (C)': '17 C',<br/>    'temperature (F)': '63 F',<br/>  },<br/>  {<br/>    'city': 'london',<br/>    'temperature (C)': '16 C',<br/>    'temperature (F)': '66 F',<br/>  },<br/>  {<br/>    'city': 'johannesburg ',<br/>    'temperature (C)': '24 C',<br/>    'temperature (F)': '75 F',<br/>  },<br/>];</span><span id="7494" class="nw mh iq ns b gy oe ny l nz oa">module.exports = fakeWeatherData;</span></pre><p id="5436" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个文件包含了我们伪造的天气数据。它包含一个名为<code class="fe ob oc od ns b">fakeWeatherData</code>的对象数组。每个对象都有一个城市的关键字，摄氏温度和华氏温度。在文件的底部，我们正在导出这个数组。请注意，这是我编造的假数据。在实际应用中，这些信息很可能来自数据库。</p><p id="6aea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我们的<code class="fe ob oc od ns b">.gitignore</code>文件忽略了我们的<code class="fe ob oc od ns b">node_modules</code>文件夹。</p><p id="67ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，这些是启动代码的主要文件。现在让我们开始建立我们的假天气API！</p><h1 id="d80b" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">步骤3:构建假天气API</h1><p id="8445" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">在我们开始编写任何代码之前，不要忘记在您的终端上键入<code class="fe ob oc od ns b">npm install</code>来安装所有的依赖项(在这种情况下，它只是express)。现在在你的文本编辑器上打开<code class="fe ob oc od ns b">index.js</code>。让我们首先让我们的应用程序在获得根目录上的GET请求时返回一些json。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="ca8d" class="nw mh iq ns b gy nx ny l nz oa">const express = require('express'); // import express<br/>const app = express();  // initialize express</span><span id="ceab" class="nw mh iq ns b gy oe ny l nz oa">// GET route<br/>app.get('/', function(req, res) {<br/>  res.send({'hello': 'world'})<br/>})</span><span id="3e13" class="nw mh iq ns b gy oe ny l nz oa">// Listen on port 3000<br/>app.listen(3000, function() {<br/>  console.log('listening on port 3000...');<br/>})</span></pre><p id="2848" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你在你的终端输入<code class="fe ob oc od ns b">node index.js</code>，然后打开你的网络浏览器并导航到<code class="fe ob oc od ns b"><a class="ae kv" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a></code>，你应该会得到一些json</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/ad712e91aaa12dec0897eb11e0c3e822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzgOvqRWdb2NpXlU997e7Q.png"/></div></div></figure><p id="8a19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您应该得到相同的数据，但是您的json可能看起来不像上面的图片那么干净。如果你想让你的浏览器格式化json数据，那么看看这个<a class="ae kv" href="https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh" rel="noopener ugc nofollow" target="_blank"> chrome扩展</a>。一旦你得到它，你应该自动得到干净的格式化json。</p><p id="8b7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们尝试使用我们的应用程序发送一些虚假的天气数据。首先，我们需要从我们的<code class="fe ob oc od ns b">data.js</code>文件导入假数据。然后，当发出GET请求时，让我们尝试发出我们的<code class="fe ob oc od ns b">fakeWeatherData</code>数组中的第一个数据项。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="569d" class="nw mh iq ns b gy nx ny l nz oa">const express = require('express');   // import express<br/>const app = express();  // initialize express<br/>const fakeWeatherData = require('./data.js'); // import fake data</span><span id="8ac8" class="nw mh iq ns b gy oe ny l nz oa">// GET route<br/>app.get('/', function(req, res) {<br/>  res.send(fakeWeatherData[0]);<br/>})</span><span id="01af" class="nw mh iq ns b gy oe ny l nz oa">app.listen(3000, function() {<br/>  console.log('listening on port 3000...');<br/>})</span></pre><p id="f9fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成这些更改后，按<code class="fe ob oc od ns b">ctrl + C</code>重启express服务器，然后键入<code class="fe ob oc od ns b">node index.js</code>。您应该看到这个:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/49a29e6d073c1d6ce8e80bb3d04794b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQclaF67IWZGVEkADNGaoQ.png"/></div></div></figure><p id="8a43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不错！现在，当发出GET请求时，我们可以向用户发送假数据。让我们允许用户输入一个城市名称，并获得温度数据，如果它可用的话。我们通过检查URL查询字符串来做到这一点，如果它包含的参数值与我们的城市名称相匹配，那么我们应该返回与该城市相关的数据。</p><p id="6cea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你对URL查询字符串感到困惑，你可以查看这个<a class="ae kv" href="https://howto.caspio.com/parameters/parameters-as-query-string-values/" rel="noopener ugc nofollow" target="_blank">链接</a>。它将帮助你理解一个URL的不同方面。</p><p id="1b1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了使用express访问查询字符串参数，我们需要使用<code class="fe ob oc od ns b">req.query</code>参见下面的代码:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="7d8f" class="nw mh iq ns b gy nx ny l nz oa">const express = require('express');  // import express<br/>const app = express();  // initialize express</span><span id="f210" class="nw mh iq ns b gy oe ny l nz oa">// import our fake weather data<br/>const fakeWeatherData = require('./data.js');</span><span id="775f" class="nw mh iq ns b gy oe ny l nz oa">// GET route<br/>app.get('/weather', function(req, res) {<br/>  // if no city parameter exists  <br/>  if (!req.query.city) {<br/>    res.send({"status": "error", "message": "Please enter a city name"})<br/>  } else {<br/>  res.send(fakeWeatherData[0])<br/>  }<br/>});</span><span id="d582" class="nw mh iq ns b gy oe ny l nz oa">app.listen(3000, function() {<br/>  console.log('listening on port 3000...');<br/>})</span></pre><p id="3a56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我分析上面的代码之前，请注意我将路径改为现在的<code class="fe ob oc od ns b">http://localhost:3000/weather</code>。我这样做是为了让我们的URL更具描述性。</p><p id="5eb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们不为我们的应用程序提供一个带有参数<code class="fe ob oc od ns b">city</code>的查询字符串，那么我们将返回一个json错误消息。您可以通过重新启动express服务器，然后转到下面的路径<code class="fe ob oc od ns b">http://localhost:3000/weather/?city</code>来测试这一点。事实上，如果你去任何/weather路径，你会得到这个错误信息。要解决这个问题，请访问<code class="fe ob oc od ns b">http://localhost:3000/weather/?city=ANYTHING</code>。现在，我们再次看到我们的城市数据，但我们只访问一个城市的信息。让我们研究基于URL查询字符串中的参数<code class="fe ob oc od ns b">city</code>获取数据的逻辑。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="2809" class="nw mh iq ns b gy nx ny l nz oa">const express = require('express');  // import express<br/>const app = express();  // initialize express</span><span id="8661" class="nw mh iq ns b gy oe ny l nz oa">// import our fake weather data<br/>const fakeWeatherData = require('./data.js');</span><span id="6777" class="nw mh iq ns b gy oe ny l nz oa">// GET route<br/>app.get('/weather', function (req, res) {</span><span id="0720" class="nw mh iq ns b gy oe ny l nz oa">// store the query string parameter in cityName variable<br/>  let cityName = req.query.city.toLowerCase();</span><span id="53f1" class="nw mh iq ns b gy oe ny l nz oa">// Loop through our fake data array<br/>  for (let i = 0; i &lt; fakeWeatherData.length; i++) {</span><span id="7078" class="nw mh iq ns b gy oe ny l nz oa">// if no city parameter exists<br/>    if (!cityName) {<br/>      return res.send({"status": "error", "message": "Please enter a city name"})<br/>    } else if (cityName == fakeWeatherData[i].city.toLowerCase()) {<br/>      return res.send(fakeWeatherData[i])<br/>    }<br/>  }</span><span id="b6ac" class="nw mh iq ns b gy oe ny l nz oa">// if city parameter isn't in our fake data set<br/>  res.send({"status": "error", "message": "This city isn't in our database"})</span><span id="958d" class="nw mh iq ns b gy oe ny l nz oa">});</span><span id="2a86" class="nw mh iq ns b gy oe ny l nz oa">app.listen(3000, function () {<br/>  console.log('listening on port 3000...');<br/>})</span></pre><p id="e0f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的逻辑非常简单。我们只是访问用户输入的城市名称，但是是从我们的查询字符串中获取的。该字符串存储在<code class="fe ob oc od ns b">req.query</code>中。然后，我们循环遍历我们的假天气数据数组，检查我们是否有任何匹配。如果我们这样做了，那么我们的API应该用与城市相关的数据来响应。</p><p id="d44e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，现在让我们测试我们的API！如果我们去路径<code class="fe ob oc od ns b">http://localhost:3000/weather/?city=tokyo</code>。这是我们应该看到的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/6e20d3527739ebd88c23959abf97e1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nQZNPYVkVfXI3UW0j8Z4Q.png"/></div></div></figure><p id="03b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以用我们的假数据集中的任何城市测试它，它应该返回城市数据，如果城市数据不可用或者没有输入城市，那么我们应该得到一个适当的错误。</p><p id="843a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然我们接近完成，但我们还没有完全做到。应该考虑的最后一件事。我们将通过位于不同域的另一个应用程序来访问这个API，所以我们必须启用所有跨源资源共享。幸运的是，有一个名为<a class="ae kv" href="https://www.npmjs.com/package/cors" rel="noopener ugc nofollow" target="_blank"> cors </a>的节点包可以帮助我们。要安装它，我们只需在终端中键入以下内容:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="1a11" class="nw mh iq ns b gy nx ny l nz oa">npm i --save cors</span></pre><p id="17e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们最终的<code class="fe ob oc od ns b">package.json</code>现在应该是这样的:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="72b0" class="nw mh iq ns b gy nx ny l nz oa">{<br/>  "name": "fake_weather_api_starter",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "author": "Maher Alkendi",<br/>  "license": "ISC",<br/>  "dependencies": {<br/>    "cors": "^2.8.4",<br/>    "express": "^4.16.4"<br/>  }<br/>}</span></pre><p id="cb97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要启用所有CORS请求，我们只需添加几行代码。我们最终的<code class="fe ob oc od ns b">index.js</code>文件现在应该是这样的:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="e89c" class="nw mh iq ns b gy nx ny l nz oa">const express = require('express');  // import express<br/>const app = express();  // initialize express<br/>const cors = require('cors'); // import cors package</span><span id="dc29" class="nw mh iq ns b gy oe ny l nz oa">// import our fake weather data<br/>const fakeWeatherData = require('./data.js');</span><span id="7d04" class="nw mh iq ns b gy oe ny l nz oa">// Enable all CORS requests<br/>app.use(cors());</span><span id="944d" class="nw mh iq ns b gy oe ny l nz oa">app.get('/weather', function (req, res) {</span><span id="a1ec" class="nw mh iq ns b gy oe ny l nz oa">// store the query string parameter in cityName variable<br/>  let cityName = req.query.city.toLowerCase();</span><span id="c023" class="nw mh iq ns b gy oe ny l nz oa">// Loop through our fake data array<br/>  for (let i = 0; i &lt; fakeWeatherData.length; i++) {</span><span id="ade1" class="nw mh iq ns b gy oe ny l nz oa">// if no city parameter exists<br/>    if (!cityName) {<br/>      return res.send({"status": "error", "message": "Please enter a city name"})<br/>    } else if (cityName == fakeWeatherData[i].city.toLowerCase()) {<br/>      return res.send(fakeWeatherData[i])<br/>    }<br/>  }</span><span id="36fb" class="nw mh iq ns b gy oe ny l nz oa">// if city parameter isn't in our fake data set<br/>  res.send({"status": "error", "message": "This city isn't in our database"})</span><span id="0d24" class="nw mh iq ns b gy oe ny l nz oa">});</span><span id="1cd0" class="nw mh iq ns b gy oe ny l nz oa">app.listen(3000, function () {<br/>  console.log('listening on port 3000...');<br/>})</span></pre><p id="27d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们走吧！我们刚刚创造了一个假的天气预报。但这本身并不令人兴奋。让我们创建一个简单的UI来实际使用这些数据。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><p id="b25d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你能走到这一步，我向你致敬！请记住，这只是这两部分系列的第一部分。如果您想了解我们如何从我们刚刚创建的API和前端应用程序中访问数据。看看第二部分。</p><p id="7191" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您有任何问题或建议，请随时在下面留言或在<a class="ae kv" href="https://twitter.com/maheralkendi" rel="noopener ugc nofollow" target="_blank">我的推特</a>上给我发消息，我将很乐意回复！</p></div></div>    
</body>
</html>
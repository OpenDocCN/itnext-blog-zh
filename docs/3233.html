<html>
<head>
<title>chai-pdf: Awesome Chai Plugin for testing PDF files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">chai-pdf:测试pdf文件的强大chai插件</h1>
<blockquote>原文：<a href="https://itnext.io/chai-pdf-awesome-chai-plugin-for-testing-pdf-files-a0752f42e489?source=collection_archive---------3-----------------------#2019-10-31">https://itnext.io/chai-pdf-awesome-chai-plugin-for-testing-pdf-files-a0752f42e489?source=collection_archive---------3-----------------------#2019-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6c8c2ba644f54797f3dac60e7ac3f527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCeserOuP78Aebvqj9X_tw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">chai-pdf正在运行</figcaption></figure><h1 id="bc07" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">为什么是chai-pdf？</h1><p id="49dc" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">您曾经遇到过项目要求您验证pdf文件的情况吗？你想要一个简单的方法来验证它们吗？如果是这样，那么请继续阅读。</p><p id="6aad" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">通常，我们手动进行这些pdf测试，因为自动化测试可能会很复杂或者成本很高。我见过的一些DIY方法是将它们转换成可读的文本，然后验证特定字符串的存在。然而，我个人更喜欢将pdf页面转换成图像并进行图像比较的方法。通过这种方式，您不仅可以验证想要测试的文本是否存在，还可以验证pdf本身的结构。一举两得。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi md"><img src="../Images/8e934cb9dab046b3914ac135c3457770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*fnIx4vLBt6jN-eXyefYBZw.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">强制性模因</figcaption></figure><p id="1416" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">chai-pdf 提供了打包在一个简单易用的<a class="ae mi" href="https://www.npmjs.com/package/chai" rel="noopener ugc nofollow" target="_blank"> chai </a>插件中的功能，使用您现有的NodeJS测试框架来验证pdf。</p><h1 id="a550" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">给我看看代码！</h1><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">样本chai-pdf测试</figcaption></figure><h1 id="3c16" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">设置</h1><p id="7634" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">首先，您需要安装以下系统依赖项:</p><ul class=""><li id="edc1" class="ml mm iq lc b ld ly lh lz ll mn lp mo lt mp lx mq mr ms mt bi translated"><a class="ae mi" href="https://www.ghostscript.com/" rel="noopener ugc nofollow" target="_blank">代笔</a></li><li id="72b6" class="ml mm iq lc b ld mu lh mv ll mw lp mx lt my lx mq mr ms mt bi translated"><a class="ae mi" href="http://www.graphicsmagick.org/README.html" rel="noopener ugc nofollow" target="_blank">图形魔术</a></li><li id="6f2a" class="ml mm iq lc b ld mu lh mv ll mw lp mx lt my lx mq mr ms mt bi translated"><a class="ae mi" href="https://imagemagick.org/index.php" rel="noopener ugc nofollow" target="_blank"> ImageMagick </a></li></ul><p id="b1fe" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">一旦安装了这些依赖项，您现在就可以将chai插件安装到您的项目中了</p><pre class="me mf mg mh gt mz na nb nc aw nd bi"><span id="0f1f" class="ne kd iq na b gy nf ng l nh ni">npm install chai-pdf</span></pre><p id="503c" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">在NodeJS测试框架中，创建以下文件夹结构，您将在其中放置pdf:</p><ul class=""><li id="11d7" class="ml mm iq lc b ld ly lh lz ll mn lp mo lt mp lx mq mr ms mt bi translated">/数据/实际pdf</li><li id="ddcd" class="ml mm iq lc b ld mu lh mv ll mw lp mx lt my lx mq mr ms mt bi translated">/数据/基线pdf</li></ul><h1 id="392c" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">测试执行</h1><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/092f30ffb95a0c6193c830214d26031e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*bDbcyuRuPsN8-RcZY5lSZg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">实际、基线和差异的示例图像</figcaption></figure><p id="df65" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">当您在后台执行测试时，chai-pdf会将每个pdf转换成png文件，其中每个页面都有自己的索引。测试完成后，如果有差异，将在数据文件夹中保存一个差异图像，并以红色突出显示差异。</p><h1 id="1c8f" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">掩饰</h1><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/eff798a026a62e19014096648c444452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*tLXjlNWMNMfiXxxn1gWRaQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">掩饰</figcaption></figure><p id="25df" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">在某些情况下，pdf文件可能包含动态数据。它可以是唯一的标识符或日期。在这种情况下，<a class="ae mi" href="https://www.npmjs.com/package/chai-pdf" rel="noopener ugc nofollow" target="_blank"> chai-pdf </a>允许您传递可以指示遮罩坐标的选项。这将在比较之前为实际和基线转换图像绘制一个黑色矩形。</p><h1 id="d896" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">下一步是什么？</h1><p id="0030" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">就这样，很简单。</p><p id="b1ec" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我正在考虑实现这个插件的其他功能和配置。如果你有一些建议，请在评论区告诉我你的想法。</p><p id="c43a" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">保持牛逼，下集再见！</p><p id="7171" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">马尔达茨</p></div></div>    
</body>
</html>
<html>
<head>
<title>First steps with React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native的第一步</h1>
<blockquote>原文：<a href="https://itnext.io/first-steps-with-react-native-85d6b4581a00?source=collection_archive---------4-----------------------#2018-02-23">https://itnext.io/first-steps-with-react-native-85d6b4581a00?source=collection_archive---------4-----------------------#2018-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6769d0a14e77cba2ce5333199fb70352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ca5P3D4zUFo3fhC-mw8WYA.jpeg"/></div></div></figure><p id="d321" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">目标受众:任何稍有Javascript经验的人。</p><p id="c0e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么，我们在这里做什么？</p><p id="9452" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我将带领你创建一个简单的应用程序，同时解释这一令人敬畏的技术的一些核心概念。</p><p id="a88c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Ffirst-steps-with-react-native-85d6b4581a00" rel="noopener ugc nofollow" target="_blank"> <em class="kx">点击这里在LinkedIn </em>上分享这篇文章</a></p><h2 id="6152" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">我们开始吧！</h2><p id="cba2" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">当你舒服地坐在电视机前，意识到你已经看完了你最喜欢的电视节目，却不知道接下来该看什么时，没有什么比这种空虚感更糟糕的了，所以，让我们来做一个网飞轮盘赌吧！</p><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/6b662dbb000c61093c6649e3641c7a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*R7Wze_XIR66ZlZjSNhY6jw.png"/></div></figure><p id="2efc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">TL；DR这里是回购的链接</p><div class="mb mc gp gr md me"><a href="https://github.com/nicolas-amabile/NetflixRoulette" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">尼古拉-阿马比尔/网飞轮盘赌</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">在GitHub上创建一个帐户，为NetflixRoulette的发展做出贡献。</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">github.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jw me"/></div></div></a></div><p id="ae72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有几种方法可以生成React原生项目。今天我们将使用create-react-native-app(将在以后的帖子中讨论利弊)。</p><p id="2d55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在终端上键入以下命令:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="51f4" class="ky kz iq mu b gy my mz l na nb">npm install -g create-react-native-app<br/>create-react-native-app NetflixRoulette<br/>cd NetflixRoulette<br/>npm start</span></pre><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/127d10f4c4a534393b91e78a95f70801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODRs6nN1c1j15jWdhL2Etw.png"/></div></div></figure><p id="808e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果一切顺利，您应该会在终端上看到如下内容:</p><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/6935cd502e5960da2ede32ec31e57013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLDKOo8VGIHgDFTV9ByYJw.png"/></div></div></figure><p id="44a4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想在你的真实设备上运行你的应用程序，下载expo客户端(<a class="ae kw" href="https://play.google.com/store/apps/details?id=host.exp.exponent&amp;hl=en" rel="noopener ugc nofollow" target="_blank"> Android </a>或<a class="ae kw" href="https://itunes.apple.com/us/app/expo-client/id982107779?mt=8" rel="noopener ugc nofollow" target="_blank"> iOS </a>)并扫描二维码，就这么简单。</p><p id="1c5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您也可以使用模拟器，键入“a”用于android(这可能需要一些额外的配置)，或者键入“I”用于iOS(如果您在mac上并且安装了XCode，那么一切都准备好了)。</p><p id="af98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">无论您选择哪个选项，我们的应用程序现在看起来都像这样:</p><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/192ff3829b366f1ab1de39a9fe0f18f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q-Ys0T8X53bitgveQgE2fw.png"/></div></div></figure><p id="37b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">入口点是App.js文件。如果您打开它，您将看到生成上面屏幕的代码。包含一些文本的简单视图组件。</p><p id="0587" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在根级别开始编写我们的组件没有多大意义，所以让我们在项目中添加一些结构。</p><p id="dca4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们创建一个'<em class="kx"> src </em>'文件夹，其中包含一个'<em class="kx"> components </em>'文件夹。</p><p id="3eef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在components文件夹中创建一个titleFinder.js文件，并添加以下代码:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="0249" class="ky kz iq mu b gy my mz l na nb">import React, { Component } from 'react'</span><span id="a75e" class="ky kz iq mu b gy nf mz l na nb">import { StyleSheet, Text, View } from 'react-native'</span><span id="c8fc" class="ky kz iq mu b gy nf mz l na nb">export default class TitleFinder extends Component {</span><span id="945b" class="ky kz iq mu b gy nf mz l na nb">   render() {</span><span id="7f61" class="ky kz iq mu b gy nf mz l na nb">      return (</span><span id="a15b" class="ky kz iq mu b gy nf mz l na nb">         &lt;View style={styles.container}&gt;</span><span id="56f5" class="ky kz iq mu b gy nf mz l na nb">            &lt;Text&gt; Netflix Roulette! &lt;/Text&gt;</span><span id="8011" class="ky kz iq mu b gy nf mz l na nb">         &lt;/View&gt;</span><span id="4a98" class="ky kz iq mu b gy nf mz l na nb">      )</span><span id="cc9f" class="ky kz iq mu b gy nf mz l na nb">   }</span><span id="9bb1" class="ky kz iq mu b gy nf mz l na nb">}</span><span id="bf5f" class="ky kz iq mu b gy nf mz l na nb">const styles = StyleSheet.create({</span><span id="f388" class="ky kz iq mu b gy nf mz l na nb">   container: {</span><span id="2c8f" class="ky kz iq mu b gy nf mz l na nb">      flex: 1,</span><span id="0967" class="ky kz iq mu b gy nf mz l na nb">      backgroundColor: '#fff',</span><span id="4b7d" class="ky kz iq mu b gy nf mz l na nb">      alignItems: 'center',</span><span id="3a9b" class="ky kz iq mu b gy nf mz l na nb">      justifyContent: 'center',</span><span id="f326" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="fdd2" class="ky kz iq mu b gy nf mz l na nb">})</span></pre><p id="ecd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后将App.js上的代码替换为以下内容:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="a739" class="ky kz iq mu b gy my mz l na nb">import React from 'react'</span><span id="e1dc" class="ky kz iq mu b gy nf mz l na nb">import TitleFinder from './src/components/titleFinder'</span><span id="74f0" class="ky kz iq mu b gy nf mz l na nb">export default class App extends React.Component {</span><span id="98a4" class="ky kz iq mu b gy nf mz l na nb">   render() {</span><span id="d253" class="ky kz iq mu b gy nf mz l na nb">      return (</span><span id="3fa3" class="ky kz iq mu b gy nf mz l na nb">         &lt;TitleFinder /&gt;</span><span id="c7a2" class="ky kz iq mu b gy nf mz l na nb">      )</span><span id="4880" class="ky kz iq mu b gy nf mz l na nb">   }</span><span id="be21" class="ky kz iq mu b gy nf mz l na nb">}</span></pre><p id="96ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在入口点将创建我们的第一个组件TitleFinder的一个实例，</p><h2 id="4d14" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">什么是组件？</h2><p id="7bae" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">你在屏幕上看到的任何东西都是某种组件。这是一个返回一些JSX来渲染的函数。</p><h2 id="df49" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">JSWhat？JSX</h2><p id="b501" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">JSX是一个用于编写组件的Javascript扩展。与HTML语义相同。在这种情况下，我们不会使用HTML组件(div、p、h1等)，但我们将使用现成的react本地组件，最终将创建本地组件。</p><h2 id="036a" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">巴比伦式的城市</h2><p id="0343" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">JSX →普通Javascript</p><p id="aa1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Babel是一个JavaScript transpiler，它将JSX转换成普通的旧版本ES5 JavaScript，可以在任何浏览器上运行(甚至是旧版本)。</p><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/9e31214d60feae89227954a8e56dd51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dVdYRj3j2iIgZlj-r6Mlyw.png"/></div></div></figure><h2 id="8be7" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">状态</h2><p id="c05f" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">一个组件的变量，如果值发生变化，它将触发重新呈现，因此更新后的值会立即显示在用户界面上。</p><p id="7926" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与常规变量的区别在于，不能直接设置值，需要使用一个名为setState的函数。</p><h2 id="2fe1" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">无状态与有状态组件</h2><p id="c3ba" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">不是在所有的场景中，我们都需要创建我们所谓的有状态组件(具有内部状态的组件)。在某些情况下，我们只想以特定的方式呈现一些信息，但是组件内部没有任何东西可以改变这些值。最好的工具是无状态组件。更多的lightway组件只是在屏幕上呈现信息。</p><p id="10dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看一些例子:</p><p id="9085" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们在草图中看到的，第一个屏幕将包含以下元素:</p><ul class=""><li id="7e27" class="ng nh iq ka b kb kc kf kg kj ni kn nj kr nk kv nl nm nn no bi translated">带有文本“给我一个标题建议”的标题</li><li id="d10f" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">两个标签，一个用于电视节目，另一个用于电影</li><li id="23b3" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">用于选择最小IMDB额定值的滑块</li><li id="3c36" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">旋转规则带的按钮</li></ul><h2 id="2ff2" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">页眉</h2><p id="649f" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">就像TitleFinder一样，让我们创建另一个名为Header的组件。</p><p id="2d52" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，在<em class="kx"> src/components </em>文件夹中，用以下代码创建一个名为<em class="kx"> header.js </em>的文件:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="6100" class="ky kz iq mu b gy my mz l na nb">import React from ‘react’<br/>import { View, Text, Platform, StyleSheet } from ‘react-native’</span><span id="df51" class="ky kz iq mu b gy nf mz l na nb">const Header = ({ title }) =&gt; (<br/> &lt;View style={styles.container}&gt;<br/>    &lt;Text style={styles.title}&gt;{title}&lt;/Text&gt;<br/> &lt;/View&gt;<br/>)</span><span id="23dd" class="ky kz iq mu b gy nf mz l na nb">const styles = StyleSheet.create({<br/> container: {<br/>    height: Platform.OS === ‘ios’ ? 60 : 80,<br/>    width: ‘100%’,<br/>    borderBottomWidth: 1,<br/>    borderBottomColor: ‘#dadadc’,<br/>    justifyContent: ‘flex-end’,<br/>    alignItems: Platform.OS === ‘ios’ ? ‘center’ : ‘flex-start’,<br/>    backgroundColor: Platform.OS === ‘ios’ ? ‘#f8f8f8’ : ‘#3f51b5’<br/> },<br/> title: {<br/>    fontFamily: Platform.OS === ‘ios’ ? “System” : “Roboto”,<br/>    color: Platform.OS === ‘ios’ ? “#000” : “#fff”,<br/>    fontSize: 17,<br/>    fontWeight: ‘bold’,<br/>    paddingBottom: Platform.OS === ‘ios’ ? 10 : 17,<br/>    paddingLeft: Platform.OS === ‘ios’ ? 0 : 25<br/> }<br/>})</span><span id="da4b" class="ky kz iq mu b gy nf mz l na nb">export default Header</span></pre><p id="1650" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，在这种情况下，Header不是一个类，也不是从React.Component继承的。相反，我们将创建一个接收一些参数并返回一些JSX的函数。</p><p id="88ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以防您不熟悉ES6:</p><p id="0a28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">({ title })和(props)完全一样，通过做props.title. Object析构<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" rel="noopener ugc nofollow" target="_blank">这里</a>来访问标题。</p><h2 id="53b9" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">制表符</h2><p id="d26e" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated"><em class="kx"> src/components/tab.js </em></p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="5dac" class="ky kz iq mu b gy my mz l na nb">import React from 'react'<br/>import { TouchableOpacity, Text, StyleSheet } from 'react-native'</span><span id="e309" class="ky kz iq mu b gy nf mz l na nb">const Tab = ({ name, isActive, onPress }) =&gt; (<br/>  &lt;TouchableOpacity<br/>    style={isActive ? [styles.container, styles.active] : styles.container}<br/>    onPress={() =&gt; onPress(name)}&gt;<br/>    <br/>    &lt;Text style={isActive ? [styles.text, styles.textActive] : styles.text}&gt;<br/>      {name}<br/>    &lt;/Text&gt;</span><span id="41a0" class="ky kz iq mu b gy nf mz l na nb">&lt;/TouchableOpacity&gt;<br/>)</span><span id="7d0a" class="ky kz iq mu b gy nf mz l na nb">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    justifyContent: 'center',<br/>    alignItems: 'center',<br/>    height: 40<br/>  },<br/>  active: {<br/>    borderBottomWidth: 3,<br/>    borderBottomColor: '#0479fb'<br/>  },<br/>  text: {<br/>    color: '#9d9d9d'<br/>  },<br/>  textActive: {<br/>    color: '#0479fb',<br/>    fontWeight: 'bold',<br/>    paddingTop: 3<br/>  }<br/>})</span><span id="2f4f" class="ky kz iq mu b gy nf mz l na nb">export default Tab</span></pre><p id="5d26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我们将有这个组件的多个实例，我们需要一种方法让用户知道哪个是活动的，这就是为什么我们发送一个名为<em class="kx"> isActive </em>的标志。这样我们就可以决定需要使用哪种风格。</p><p id="bfb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">稍后我们将返回到按下时的<em class="kx">，但是现在假设它只是一个从外部发送的函数(在其他地方实现的),并且将在有人触摸标签时被触发。</em></p><h2 id="f445" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">滑块</h2><p id="e190" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">在这种情况下，我们不会创建一个组件，我们只是将这些代码作为TitleFinder组件的渲染功能的一部分。</p><p id="d851" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与其直接这么做，不如让我们编写一个函数，确切地返回这段代码:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="b2b8" class="ky kz iq mu b gy my mz l na nb">renderScorePicker () {</span><span id="8de3" class="ky kz iq mu b gy nf mz l na nb">   const scoreToDisplay = this.state.minimumScore === 0 ? 'Any' : `More than ${this.state.minimumScore}`</span><span id="2f14" class="ky kz iq mu b gy nf mz l na nb">   return (</span><span id="9a75" class="ky kz iq mu b gy nf mz l na nb">      &lt;React.Fragment&gt;</span><span id="62b2" class="ky kz iq mu b gy nf mz l na nb">         &lt;Text<br/>            key='scoreLabel'<br/>            style={styles.scoreLabel}&gt;<br/>            IMDB score:<br/>         &lt;/Text&gt;</span><span id="b5bc" class="ky kz iq mu b gy nf mz l na nb">         &lt;Slider</span><span id="72d8" class="ky kz iq mu b gy nf mz l na nb">            key='scorePicker'</span><span id="2216" class="ky kz iq mu b gy nf mz l na nb">            step={1}</span><span id="5aec" class="ky kz iq mu b gy nf mz l na nb">            minimumValue={0}</span><span id="ea65" class="ky kz iq mu b gy nf mz l na nb">            maximumValue={9}</span><span id="33ae" class="ky kz iq mu b gy nf mz l na nb">            onValueChange={(newValue) =&gt; this.setState({minimumScore: newValue})}</span><span id="9355" class="ky kz iq mu b gy nf mz l na nb">            value={this.state.minimumScore}</span><span id="75b8" class="ky kz iq mu b gy nf mz l na nb">            style={styles.scoreSlider}</span><span id="ce1b" class="ky kz iq mu b gy nf mz l na nb">         /&gt;</span><span id="cf0a" class="ky kz iq mu b gy nf mz l na nb">         &lt;Text<br/>            key='scoreValue'<br/>            style={styles.scoreValue}&gt;<br/>            {scoreToDisplay}<br/>         &lt;/Text&gt;</span><span id="9676" class="ky kz iq mu b gy nf mz l na nb">      &lt;/React.Fragment&gt;</span><span id="b53e" class="ky kz iq mu b gy nf mz l na nb">   )</span><span id="5f82" class="ky kz iq mu b gy nf mz l na nb">}</span></pre><p id="8e6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以之前的React版本(&lt;16), we were forced to return exactly one component, so in this case (Text, Slider and another Text) we would have needed something to wrap all the content, a <view>为例。现在，使用React 16可以返回元素数组或使用React。片段不会向组件树添加任何额外的节点。这样，它更平坦，性能更好。</view></p><p id="69b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还记得我们将<em class="kx">状态</em>定义为当值改变时在UI上自动更新的变量吗？它是这样工作的:</p><p id="e3f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将值映射到状态:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="3f61" class="ky kz iq mu b gy my mz l na nb">value={this.state.minimumScore}</span></pre><p id="83fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<em class="kx"> onChange </em>上，我们需要调用<em class="kx"> setState </em>来更新新值:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="6902" class="ky kz iq mu b gy my mz l na nb">onValueChange={(newValue) =&gt; {<br/>   this.setState({minimumScore: newValue})<br/>}}</span></pre><p id="f02b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这样，当输入(本例中为滑块)发生变化时，就会执行<em class="kx"> onValueChange </em>函数，并用新值更新本地状态。由于每次抛出<em class="kx"> setState </em>函数更新一个变量，渲染将再次运行，值将在UI上更新。</p><h2 id="2e02" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">纽扣</h2><p id="2f1b" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">TitleFinder组件中的一个函数button也是如此。</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="d7c3" class="ky kz iq mu b gy my mz l na nb">renderSpinButton () {<br/>   const buttonText = this.state.data ? 'Spin again!' : 'Spin!'<br/>   return (<br/>      &lt;View style={styles.buttonContainer}&gt;</span><span id="0c5b" class="ky kz iq mu b gy nf mz l na nb">         &lt;Button</span><span id="62c2" class="ky kz iq mu b gy nf mz l na nb">            onPress={this.fetchData.bind(this)}</span><span id="5be8" class="ky kz iq mu b gy nf mz l na nb">            title={buttonText} /&gt;</span><span id="ca05" class="ky kz iq mu b gy nf mz l na nb">      &lt;/View&gt;</span><span id="4d43" class="ky kz iq mu b gy nf mz l na nb">   )<br/>}</span></pre><p id="665d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那是什么？</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="32c1" class="ky kz iq mu b gy my mz l na nb">onPress={this.fetchData.bind(this)}</span></pre><p id="a509" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx"> fetchData </em>将是一个函数，它将调用端点并检索数据。但是为什么我们需要做<em class="kx">。绑定</em>的东西？如果你不这样做，你将不能在函数实现(在这个例子中是fetchData)中访问<em class="kx">这个</em>(作为TitleFinder)。在这种情况下<em class="kx">这个</em>将是按钮本身。通过使用<em class="kx">。bind </em>我们定义了函数执行的上下文。当我们一会儿讨论实现时，这将更有意义。</p><p id="fc12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们已经有一些数据要显示，文本将会改变，但是等等，我没有解释本地状态，是吗？</p><h2 id="a5ae" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">把所有的放在一起</h2><p id="43f7" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">跟我说一会儿，我一会儿再解释。让我们在<em class="kx"> src </em>文件夹中创建一个名为<em class="kx"> constants.js </em>的文件，并将该内容粘贴到其中:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="36d2" class="ky kz iq mu b gy my mz l na nb">export const BASE_RECOMMENDATION_URL = 'https://api.reelgood.com/v1/roulette/netflix?'</span><span id="e76b" class="ky kz iq mu b gy nf mz l na nb">export const BASE_IMAGE_URL = 'https://img.reelgood.com/content/show'</span><span id="2305" class="ky kz iq mu b gy nf mz l na nb">export const IMAGE_POSTFIX = 'poster-780.jpg'</span><span id="8f41" class="ky kz iq mu b gy nf mz l na nb">export const BASE_OPTIONS = {</span><span id="759c" class="ky kz iq mu b gy nf mz l na nb">   nocache: true,</span><span id="587f" class="ky kz iq mu b gy nf mz l na nb">   kind: 0,</span><span id="3ada" class="ky kz iq mu b gy nf mz l na nb">   minimumScore: 0,</span><span id="5945" class="ky kz iq mu b gy nf mz l na nb">   sources: [</span><span id="e1ef" class="ky kz iq mu b gy nf mz l na nb">      'amazon_prime',</span><span id="7166" class="ky kz iq mu b gy nf mz l na nb">      'fx_tveverywhere',</span><span id="f439" class="ky kz iq mu b gy nf mz l na nb">      'hbo',</span><span id="5759" class="ky kz iq mu b gy nf mz l na nb">      'netflix',</span><span id="41c2" class="ky kz iq mu b gy nf mz l na nb">      'showtime',</span><span id="da8a" class="ky kz iq mu b gy nf mz l na nb">      'starz'</span><span id="1b29" class="ky kz iq mu b gy nf mz l na nb">   ],</span><span id="6fe2" class="ky kz iq mu b gy nf mz l na nb">   free: true</span><span id="85be" class="ky kz iq mu b gy nf mz l na nb">}</span><span id="16f7" class="ky kz iq mu b gy nf mz l na nb">export const MAX_SCORE = 9</span><span id="68f7" class="ky kz iq mu b gy nf mz l na nb">export const TV_SHOWS = 'TV Shows'</span><span id="b99c" class="ky kz iq mu b gy nf mz l na nb">export const MOVIES = 'Movies'</span></pre><p id="ea30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们稍后会用到它们。</p><p id="8b63" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们编写TitleFinder构造函数方法:</p><p id="abb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是首先导入我们刚刚创建的常量:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="d0e2" class="ky kz iq mu b gy my mz l na nb">import * as Constants from ‘../constants’</span><span id="80ff" class="ky kz iq mu b gy nf mz l na nb">constructor(props) {<br/>    super(props)<br/>    this.state = {<br/>      loading: false,<br/>      error: null,<br/>      data: null,<br/>      minimumScore: 0,<br/>      activeTab: Constants.TV_SHOWS<br/>    }<br/>}</span></pre><p id="13e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">只有在构造函数上我们才直接给状态赋值。我们称之为初始状态。</p><ul class=""><li id="6c15" class="ng nh iq ka b kb kc kf kg kj ni kn nj kr nk kv nl nm nn no bi translated"><em class="kx">加载</em>:我们将使用它来显示一个微调器，同时获取数据。</li><li id="61eb" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated"><em class="kx">错误</em>:有些事情可能会出错，我们需要知道它并做出相应的反应。</li><li id="c708" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated"><em class="kx">数据</em>:我们会得到一个推荐，并且会存储在这里。</li><li id="ae33" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated"><em class="kx"> minumumScore </em>和<em class="kx"> activeTab </em>是我们在用户更改值时需要跟踪的输入。</li></ul><p id="de05" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">关于状态的重要说明</strong></p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="a275" class="ky kz iq mu b gy my mz l na nb">this.setState({someValue: 'new value'})<br/>console.log(this.state.someValue)</span></pre><p id="73d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">猜猜控制台上打印的是什么</p><p id="65ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">世事难料。<em class="kx">设置状态</em>函数是异步的。这意味着在下一行中，你不能确定值是否已经被更新。这就是为什么我们需要使用回调。<em class="kx"> setState </em>的第二个参数是一个回调函数，将在值最终更新后执行。</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="957e" class="ky kz iq mu b gy my mz l na nb">this.setState({someValue: 'new value'}, () =&gt; {</span><span id="2b91" class="ky kz iq mu b gy nf mz l na nb">   console.log(this.state.someValue) // 'new value' <br/>})</span></pre><p id="dda5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还没有包括选项卡。让我们构建一个小组件来处理这两个选项卡:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="52fd" class="ky kz iq mu b gy my mz l na nb">const TypeSelector = ({activeTab, onTabPress}) =&gt; {<br/>  return (<br/>    &lt;View style={{ flexDirection: 'row' }}&gt;<br/>      &lt;Tab <br/>        name={Constants.TV_SHOWS} <br/>        isActive={activeTab === Constants.TV_SHOWS}<br/>        onPress={onTabPress}<br/>      /&gt;<br/>      &lt;Tab <br/>        name={Constants.MOVIES} <br/>        isActive={activeTab === Constants.MOVIES}<br/>        onPress={onTabPress}<br/>      /&gt;<br/>    &lt;/View&gt;<br/>  )<br/>}</span></pre><p id="b075" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在TitleFinder组件上编写这两个函数:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="4ce0" class="ky kz iq mu b gy my mz l na nb">renderType () {<br/>  return (<br/>    &lt;TypeSelector<br/>      activeTab={this.state.activeTab}<br/>      onTabPress={this.onTabPress} /&gt;<br/>  )<br/>}<br/>  <br/>onTabPress = tab =&gt; {<br/>  this.setState({ activeTab: tab })<br/>}</span></pre><p id="0212" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，我们没有使用。<em class="kx">为<em class="kx">按下</em>这次绑定</em>。只是为了向你展示另一种编写函数的方法。胖箭头语法(= &gt;)保留了上下文，所以在这个函数中，<em class="kx"> this </em>表示TitleFinder，而不是TypeSelector组件(触发动作的那个)。</p><p id="990e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后是渲染函数:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="1a50" class="ky kz iq mu b gy my mz l na nb">render() {</span><span id="8085" class="ky kz iq mu b gy nf mz l na nb">   return (</span><span id="a0d4" class="ky kz iq mu b gy nf mz l na nb">      &lt;View style={styles.container}&gt;</span><span id="777d" class="ky kz iq mu b gy nf mz l na nb">         &lt;Header title='Suggest me a title' /&gt;</span><span id="2eee" class="ky kz iq mu b gy nf mz l na nb">         {this.renderType()}</span><span id="b72b" class="ky kz iq mu b gy nf mz l na nb">         {this.renderScorePicker()}</span><span id="dae6" class="ky kz iq mu b gy nf mz l na nb">         {this.renderSpinButton()}</span><span id="5201" class="ky kz iq mu b gy nf mz l na nb">      &lt;/View&gt;</span><span id="c333" class="ky kz iq mu b gy nf mz l na nb">   )</span><span id="1208" class="ky kz iq mu b gy nf mz l na nb">}</span></pre><p id="03fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们查看模拟器/设备之前，还有两件事:</p><ul class=""><li id="7cf8" class="ng nh iq ka b kb kc kf kg kj ni kn nj kr nk kv nl nm nn no bi translated">移除容器的样式(我们稍后会处理)</li><li id="b781" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">为<em class="kx"> fetchData </em>创建一个占位符函数:</li></ul><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="526d" class="ky kz iq mu b gy my mz l na nb">fetchData () { console.log('Fetch data called') }</span></pre><p id="1894" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果一切顺利，您将会看到这样的内容:</p><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/060e78dbbd9e15a9351f710af66254bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HHsmxEv5wCUpa6UhgMOl6g.png"/></div></div></figure><p id="1680" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您选择电视节目或电影，当值改变时，选项卡组件和滑块都会更新。</p><p id="e4a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们首先用下面的代码在<em class="kx"> src </em>文件夹中创建一个名为<em class="kx"> utils.js </em>的文件:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="88df" class="ky kz iq mu b gy my mz l na nb">import * as Constants from './constants'</span><span id="a9a7" class="ky kz iq mu b gy nf mz l na nb">export function getImageURL (id) {<br/>  return `${Constants.BASE_IMAGE_URL}/${id}/${Constants.IMAGE_POSTFIX}`<br/>}</span><span id="90eb" class="ky kz iq mu b gy nf mz l na nb">export function getRecommendationUrl ({activeTab, minimumScore}) {<br/>  let params = ''<br/>  let modifieldFilter = Object.assign({}, Constants.BASE_OPTIONS)<br/>  modifieldFilter.kind = activeTab === Constants.TV_SHOWS ? 1 : 2<br/>  modifieldFilter.minimumScore = minimumScore</span><span id="1ef9" class="ky kz iq mu b gy nf mz l na nb">const keys = Object.keys(modifieldFilter)<br/>  keys.forEach((key, index) =&gt; {<br/>    params += `${key}=${modifieldFilter[key]}`<br/>    if (index &lt; keys.length - 1) {<br/>      params += '&amp;'<br/>    }<br/>  })<br/>  return Constants.BASE_RECOMMENDATION_URL + params<br/>}</span></pre><p id="d516" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并在TitleFinder组件上导入<em class="kx">getrecommendedationurl</em>，以便fetchData函数可以使用它:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="3e39" class="ky kz iq mu b gy my mz l na nb">import { getRecommendationUrl } from '../utils'</span></pre><p id="5bd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是<em class="kx"> fetchData </em>的真实实现:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="1646" class="ky kz iq mu b gy my mz l na nb">fetchData () {<br/>    const { activeTab, minimumScore } = this.state<br/>    const url = getRecommendationUrl({activeTab, minimumScore})<br/>    this.setState({<br/>      loading: true,<br/>      data: null,<br/>      error: false<br/>    }, () =&gt; {<br/>      fetch(url)<br/>      .then((recommendationResponse) =&gt; recommendationResponse.json())<br/>      .then((recommendationJSON) =&gt; {<br/>        this.setState({<br/>          data: recommendationJSON,<br/>          error: false,<br/>          loading: false<br/>        })     <br/>      })<br/>      .catch((error) =&gt; {<br/>        this.setState({<br/>          loading: false,<br/>          error: true,<br/>          data: null<br/>        })<br/>      })<br/>    })<br/>  }</span></pre><p id="8a99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">按下微调按钮时，将执行fetchData </em>,并将执行以下操作:</p><ul class=""><li id="dbe8" class="ng nh iq ka b kb kc kf kg kj ni kn nj kr nk kv nl nm nn no bi translated">为推荐类型(电视节目或电影)和本地州的最低IMDB分数选择选定的值。</li><li id="ed3f" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">调用util函数用这些参数创建url</li><li id="744e" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">更新本地状态，以便没有错误、没有数据并指示正在加载。</li><li id="af6a" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">执行fetch，当它返回时，设置数据，或者如果有错误，在本地状态上设置错误标志。</li></ul><p id="c846" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好了，现在我们有了我们需要的数据！去看网飞吧！</p><p id="2dec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开玩笑的。让我们构建显示这些数据的组件。</p><p id="91cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是首先让我们再添加一个资源:当api上没有时的默认图像。</p><p id="1d81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在src 的同一层，创建一个名为images的文件夹，在里面放置任何你想要的名字为<em class="kx">defaultImage.png</em>的图像</p><p id="48b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在在<em class="kx"> src/components </em>中创建一个名为<em class="kx"> recommendation.js </em>的组件</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="62f4" class="ky kz iq mu b gy my mz l na nb">import React, { Component } from 'react'</span><span id="b92e" class="ky kz iq mu b gy nf mz l na nb">import { ImageBackground, Text, StyleSheet, ActivityIndicator } from 'react-native'</span><span id="39ea" class="ky kz iq mu b gy nf mz l na nb">import { getImageURL } from '../utils'</span><span id="c437" class="ky kz iq mu b gy nf mz l na nb">import defaultImage from '../../images/defaultImage.png'</span><span id="3830" class="ky kz iq mu b gy nf mz l na nb">class Recommendation extends Component {</span><span id="35cf" class="ky kz iq mu b gy nf mz l na nb">   constructor (props) {</span><span id="72f7" class="ky kz iq mu b gy nf mz l na nb">      super(props)</span><span id="cb4d" class="ky kz iq mu b gy nf mz l na nb">      this.state = {</span><span id="1de2" class="ky kz iq mu b gy nf mz l na nb">         errorOnImageLoad: false,</span><span id="9fc0" class="ky kz iq mu b gy nf mz l na nb">         loading: false</span><span id="ba9c" class="ky kz iq mu b gy nf mz l na nb">      }</span><span id="e25c" class="ky kz iq mu b gy nf mz l na nb">   }</span><span id="0fb6" class="ky kz iq mu b gy nf mz l na nb">   renderImage = () =&gt; {</span><span id="66a0" class="ky kz iq mu b gy nf mz l na nb">      if (this.props.has_poster) {</span><span id="c262" class="ky kz iq mu b gy nf mz l na nb">         const uri = getImageURL(this.props.id)</span><span id="21c2" class="ky kz iq mu b gy nf mz l na nb">         const { errorOnImageLoad, loading } = this.state</span><span id="35a5" class="ky kz iq mu b gy nf mz l na nb">         let source</span><span id="b782" class="ky kz iq mu b gy nf mz l na nb">         if (errorOnImageLoad) {</span><span id="6160" class="ky kz iq mu b gy nf mz l na nb">            source = defaultImage</span><span id="acba" class="ky kz iq mu b gy nf mz l na nb">         } else {</span><span id="192c" class="ky kz iq mu b gy nf mz l na nb">            source = { uri }</span><span id="368b" class="ky kz iq mu b gy nf mz l na nb">         }<br/>         return (</span><span id="f2c7" class="ky kz iq mu b gy nf mz l na nb">            &lt;View style={styles.container}&gt;<br/>               &lt;View style={styles.indicatorContainer}&gt;<br/>                  &lt;ActivityIndicator<br/>                     size='small'<br/>                     animating={this.state.loading} /&gt;<br/>               &lt;/View&gt;<br/>               &lt;Image<br/>                  onLoadStart={() =&gt; {<br/>                     this.setState({loading: true})<br/>                  }}<br/>                  onLoadEnd={() =&gt; {<br/>                     this.setState({loading: false})<br/>                  }}<br/>                  onError={() =&gt; {<br/>                     this.setState({errorOnImageLoad: true})<br/>                  }}<br/>                 source={source}<br/>                 style={styles.image}<br/>                 resizeMode='contain'/&gt;<br/>            &lt;/View&gt;</span><span id="819c" class="ky kz iq mu b gy nf mz l na nb">         )</span><span id="c30a" class="ky kz iq mu b gy nf mz l na nb">       }</span><span id="1389" class="ky kz iq mu b gy nf mz l na nb">    }</span><span id="f4d7" class="ky kz iq mu b gy nf mz l na nb">   render () {</span><span id="4207" class="ky kz iq mu b gy nf mz l na nb">      const {id, has_poster, title, imdb_rating, released_on, overview} = this.props</span><span id="514c" class="ky kz iq mu b gy nf mz l na nb">      return (</span><span id="0431" class="ky kz iq mu b gy nf mz l na nb">         &lt;React.Fragment&gt;</span><span id="e30a" class="ky kz iq mu b gy nf mz l na nb">            &lt;Text<br/>               key='title'<br/>               style={styles.title}&gt;<br/>               {title}<br/>            &lt;/Text&gt;</span><span id="00c7" class="ky kz iq mu b gy nf mz l na nb">            {this.renderImage()}</span><span id="1c29" class="ky kz iq mu b gy nf mz l na nb">            &lt;Text<br/>               key='info'<br/>               style={[styles.info, styles.text]}&gt;</span><span id="6d51" class="ky kz iq mu b gy nf mz l na nb">{`IMDB: ${imdb_rating} - ${new Date(released_on).getFullYear()}`}</span><span id="deba" class="ky kz iq mu b gy nf mz l na nb">            &lt;/Text&gt;</span><span id="b180" class="ky kz iq mu b gy nf mz l na nb">            &lt;Text<br/>               key='overview'<br/>               style={[styles.overview, styles.text]}&gt;</span><span id="6571" class="ky kz iq mu b gy nf mz l na nb">               {overview}</span><span id="7c9e" class="ky kz iq mu b gy nf mz l na nb">             &lt;/Text&gt;</span><span id="9896" class="ky kz iq mu b gy nf mz l na nb">         &lt;/React.Fragment&gt;</span><span id="f2aa" class="ky kz iq mu b gy nf mz l na nb">      )</span><span id="109a" class="ky kz iq mu b gy nf mz l na nb">   }</span><span id="b308" class="ky kz iq mu b gy nf mz l na nb">}</span><span id="6ea6" class="ky kz iq mu b gy nf mz l na nb">const styles = StyleSheet.create({</span><span id="7338" class="ky kz iq mu b gy nf mz l na nb">   title: {</span><span id="15a7" class="ky kz iq mu b gy nf mz l na nb">      marginTop: 40,</span><span id="2718" class="ky kz iq mu b gy nf mz l na nb">      marginBottom: 20,</span><span id="487d" class="ky kz iq mu b gy nf mz l na nb">      textAlign: 'center',</span><span id="74b1" class="ky kz iq mu b gy nf mz l na nb">      fontSize: 17,</span><span id="f19e" class="ky kz iq mu b gy nf mz l na nb">      fontWeight: 'bold'</span><span id="1508" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="49c9" class="ky kz iq mu b gy nf mz l na nb">   info: {</span><span id="39ce" class="ky kz iq mu b gy nf mz l na nb">      fontWeight: 'bold',</span><span id="fea3" class="ky kz iq mu b gy nf mz l na nb">      marginHorizontal: 15,</span><span id="05c0" class="ky kz iq mu b gy nf mz l na nb">      marginVertical: 15</span><span id="0e71" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="a8dd" class="ky kz iq mu b gy nf mz l na nb">   text: {</span><span id="4a09" class="ky kz iq mu b gy nf mz l na nb">      marginHorizontal: 15,</span><span id="4dba" class="ky kz iq mu b gy nf mz l na nb">      marginVertical: 5</span><span id="9969" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="b234" class="ky kz iq mu b gy nf mz l na nb">   overview: {</span><span id="f108" class="ky kz iq mu b gy nf mz l na nb">      marginBottom: 5,</span><span id="a12f" class="ky kz iq mu b gy nf mz l na nb">      fontWeight: '100'</span><span id="9048" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="a671" class="ky kz iq mu b gy nf mz l na nb">   container: {</span><span id="6e2d" class="ky kz iq mu b gy nf mz l na nb">      flex: 1,</span><span id="2c56" class="ky kz iq mu b gy nf mz l na nb">      height: 400,</span><span id="78b2" class="ky kz iq mu b gy nf mz l na nb">      position: 'relative',</span><span id="c885" class="ky kz iq mu b gy nf mz l na nb">      justifyContent: 'center',</span><span id="3036" class="ky kz iq mu b gy nf mz l na nb">      alignItems: 'center'</span><span id="43cb" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="78f3" class="ky kz iq mu b gy nf mz l na nb">   image: {</span><span id="c5b0" class="ky kz iq mu b gy nf mz l na nb">      flex: 1,</span><span id="9aa2" class="ky kz iq mu b gy nf mz l na nb">      width: '100%'</span><span id="39a9" class="ky kz iq mu b gy nf mz l na nb">   },</span><span id="6b46" class="ky kz iq mu b gy nf mz l na nb">   indicatorContainer: {</span><span id="4554" class="ky kz iq mu b gy nf mz l na nb">      position:'absolute'</span><span id="9246" class="ky kz iq mu b gy nf mz l na nb">   }</span><span id="2e92" class="ky kz iq mu b gy nf mz l na nb">})</span><span id="79df" class="ky kz iq mu b gy nf mz l na nb">export default Recommendation</span></pre><p id="515a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们给TitleFinder渲染函数添加一些逻辑:</p><ul class=""><li id="1337" class="ng nh iq ka b kb kc kf kg kj ni kn nj kr nk kv nl nm nn no bi translated">将当前渲染实现移动到一个名为<em class="kx"> renderForm的函数中。</em></li><li id="eed1" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">创建一个名为<em class="kx"> renderRecommendation </em>的函数</li><li id="6cbb" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">向呈现添加一些逻辑，以便根据状态显示正确的组件。</li><li id="024f" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">还添加了一个呈现重置按钮的函数，<em class="kx"> renderResetButton </em>加上一个<em class="kx">重置</em>函数，该函数将清除本地状态<em class="kx">上的数据和标志。</em></li><li id="6501" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">别忘了导入推荐组件！</li></ul><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="4ece" class="ky kz iq mu b gy my mz l na nb">import Recommendation from '../components/recommendation'</span><span id="7e04" class="ky kz iq mu b gy nf mz l na nb">renderForm () {  <br/>    return (<br/>      &lt;View style={styles.container}&gt;<br/>        &lt;Header title='Suggest me a title' /&gt;<br/>        {this.renderType()}<br/>        {this.renderScorePicker()}<br/>        {this.renderSpinButton()}<br/>      &lt;/View&gt;<br/>    )<br/>  }</span><span id="9f61" class="ky kz iq mu b gy nf mz l na nb">renderRecommendation (recommendation) {<br/>    const { id } = recommendation<br/>    return (<br/>      &lt;ScrollView style={styles.recommendationContainer}&gt;<br/>        &lt;Recommendation {...recommendation} /&gt;<br/>        {this.renderSpinButton()}<br/>        {this.renderResetButton()}<br/>      &lt;/ScrollView&gt;<br/>    )<br/>}<br/>  <br/>renderResetButton () {<br/>   return (<br/>      &lt;View style={styles.buttonContainer}&gt;</span><span id="6dbf" class="ky kz iq mu b gy nf mz l na nb">         &lt;Button</span><span id="ee8b" class="ky kz iq mu b gy nf mz l na nb">            onPress={this.reset.bind(this)}</span><span id="95d7" class="ky kz iq mu b gy nf mz l na nb">            title='Reset filters!' /&gt;</span><span id="de92" class="ky kz iq mu b gy nf mz l na nb">      &lt;/View&gt;</span><span id="5b00" class="ky kz iq mu b gy nf mz l na nb">   )<br/>}</span><span id="4575" class="ky kz iq mu b gy nf mz l na nb">reset () {<br/>   this.setState({<br/>      loading: false,<br/>      error: false,<br/>      data: null,<br/>      minimumScore: 0,<br/>      activeTab: Constants.TV_SHOWS<br/>   })<br/>}</span><span id="cfd7" class="ky kz iq mu b gy nf mz l na nb">render() {<br/>    const { loading, data, error, activeTab } = this.state<br/>    let content<br/>    if (data) {<br/>      return this.renderRecommendation(data)<br/>    } else if (loading) {<br/>      content = &lt;ActivityIndicator size='large'/&gt;<br/>    } else if (error) {<br/>      content = &lt;Text&gt; Ops! &lt;/Text&gt;<br/>    } else {<br/>      content = this.renderForm()<br/>    }<br/>    <br/>    return (<br/>      &lt;View style={loading ? styles.loaderContainer : styles.container}&gt;<br/>        {content}<br/>      &lt;/View&gt;<br/>    )<br/>  }</span></pre><p id="c6cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种风格还有一个细节💅</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="b14b" class="ky kz iq mu b gy my mz l na nb">const styles = StyleSheet.create({<br/>  scoreLabel: {<br/>    paddingTop: 20,<br/>    paddingLeft: 10<br/>  },<br/>  scoreValue: {<br/>    textAlign: 'center',<br/>    marginBottom: 10<br/>  },<br/>  scoreSlider: {<br/>    margin: 10<br/>  },<br/>  loaderContainer: {<br/>    flex: 1,<br/>    flexDirection: 'column',<br/>    justifyContent: 'center',<br/>    alignItems: 'center'<br/>  },<br/>  recommendationContainer: {<br/>    marginBottom: 10<br/>  },</span><span id="a19b" class="ky kz iq mu b gy nf mz l na nb">  buttonContainer: {</span><span id="1796" class="ky kz iq mu b gy nf mz l na nb">    paddingHorizontal: 20,</span><span id="d2df" class="ky kz iq mu b gy nf mz l na nb">    paddingVertical: 8</span><span id="450c" class="ky kz iq mu b gy nf mz l na nb">  }</span><span id="039f" class="ky kz iq mu b gy nf mz l na nb">})</span></pre><p id="7a5d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们结束了🎉</p><div class="lx ly lz ma gt ab cb"><figure class="nu jr nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/2e5ed5485bfc4a16c1095858aa9014f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*hl_Vx1ej8bjpf8xvFsARDQ.png"/></div></figure><figure class="nu jr nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/c2c7706c1fe5ba45de6ca8150f7576fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-7D9dHMdJC9MvdhG5F00PQ.png"/></div></figure></div><h1 id="e009" class="oa kz iq bd la ob oc od ld oe of og lg oh oi oj lj ok ol om lm on oo op lp oq bi translated">下一步做什么？</h1><p id="9bf1" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">以下是继续这一旅程的有用资源列表:</p><ul class=""><li id="e844" class="ng nh iq ka b kb kc kf kg kj ni kn nj kr nk kv nl nm nn no bi translated"><a class="ae kw" href="https://facebook.github.io/react-native/docs/getting-started.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>:熟悉API和开箱即用组件。</li><li id="9a03" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated"><a class="ae kw" href="https://www.reactiflux.com/" rel="noopener ugc nofollow" target="_blank">react flux</a>社区，加入他们对<a class="ae kw" href="https://discordapp.com/invite/0ZcbPKXt5bZiQhB5" rel="noopener ugc nofollow" target="_blank">的不和谐</a>！如果您刚刚开始，您可能会感到有点不知所措，特别是因为有大量讨论同时发生，但绝对值得，react和react-native核心团队就在那里。了解最新信息的最佳地点。</li><li id="527f" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated"><a class="ae kw" href="https://reactdigest.net/" rel="noopener ugc nofollow" target="_blank"> React digest </a>，每周一封邮件，5个链接。</li><li id="7ef7" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated"><a class="ae kw" href="http://reactjsnewsletter.com/" rel="noopener ugc nofollow" target="_blank"> ReactJS简讯</a></li></ul><h2 id="f22c" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">未来文章:</h2><ul class=""><li id="e0c9" class="ng nh iq ka b kb lr kf ls kj or kn os kr ot kv nl nm nn no bi translated">React Native，幕后是怎么回事？</li><li id="5aa2" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">CRNA vs react-native init，应该用什么？</li><li id="07ba" class="ng nh iq ka b kb np kf nq kj nr kn ns kr nt kv nl nm nn no bi translated">React Native上的导航，呃</li></ul><p id="22c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这篇文章对你有用</p><p id="3476" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢阅读！快乐编码🤘😎</p></div></div>    
</body>
</html>
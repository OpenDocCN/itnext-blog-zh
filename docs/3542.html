<html>
<head>
<title>How to extend the ExpressJS Request object with Typescript 👨🏻‍💻❓</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Typescript扩展ExpressJS请求对象👨🏻‍💻❓</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-extend-the-expressjs-request-object-with-typescript-26675cda0632?source=collection_archive---------4-----------------------#2020-01-06">https://itnext.io/how-to-extend-the-expressjs-request-object-with-typescript-26675cda0632?source=collection_archive---------4-----------------------#2020-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/bc3fe7a9691fd34b5d17e4ee561e2b16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jgi6Esw9Mp6ocdeK0vgFLA.jpeg"/></div></div></figure><div class=""/><p id="91ff" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">🔶最近，我开始着手一个新的NodeJS项目。我们有一个由一个人组成的难以置信的大团队。我有丰富的前端开发经验，有心爱的ReactJS和新的印象深刻的Flutter。看起来很奇怪，那个用React做了很多web开发的家伙提到了Flutter。但是不管这篇文章是关于服务器端开发🧠的</p><p id="9161" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我听说了很多关于Typescript的事情，也看到了许多图表显示了它不可阻挡的受欢迎程度📈，但没试过。所以我决定这是一个绝佳的机会。</p><p id="9774" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">像往常一样，我通过安装最少的必需依赖项来开始我的项目:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="e505" class="li lj je le b gy lk ll l lm ln">npm -g install typescript<br/>npm install express —-save<br/>npm install <a class="ae lo" href="http://twitter.com/types/node" rel="noopener ugc nofollow" target="_blank">@types/node</a> <a class="ae lo" href="http://twitter.com/types/express" rel="noopener ugc nofollow" target="_blank">@types/express</a> —-save-dev<br/>tsc -v //check that Typescript installed correctly<br/>tsc —-init //create ttsconfig.json</span></pre><p id="12fb" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">很好。生成的tsconfig.json:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="099b" class="li lj je le b gy lk ll l lm ln">{</span><span id="cdef" class="li lj je le b gy lp ll l lm ln">"compilerOptions": {</span><span id="b327" class="li lj je le b gy lp ll l lm ln">"target": "es6",</span><span id="8bb4" class="li lj je le b gy lp ll l lm ln">"module": "commonjs",</span><span id="c5cb" class="li lj je le b gy lp ll l lm ln">"outDir": "./dist",</span><span id="0156" class="li lj je le b gy lp ll l lm ln">"rootDir": "./src",</span><span id="90c8" class="li lj je le b gy lp ll l lm ln">"strict": true,</span><span id="b572" class="li lj je le b gy lp ll l lm ln">"moduleResolution": "node",</span><span id="ca85" class="li lj je le b gy lp ll l lm ln">"baseUrl": ".",</span><span id="ed4c" class="li lj je le b gy lp ll l lm ln">"typeRoots": [</span><span id="9cd4" class="li lj je le b gy lp ll l lm ln">"node_modules/@types"</span><span id="c26b" class="li lj je le b gy lp ll l lm ln">],</span><span id="eda5" class="li lj je le b gy lp ll l lm ln">"esModuleInterop": true</span><span id="ed99" class="li lj je le b gy lp ll l lm ln">},</span><span id="b0ca" class="li lj je le b gy lp ll l lm ln">"exclude": ["node_modules", "dist"],</span><span id="f6f4" class="li lj je le b gy lp ll l lm ln">"include": ["src/**/*"]</span><span id="b4db" class="li lj je le b gy lp ll l lm ln">}</span></pre><p id="8824" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">关于“字根”property❗️的心理笔记</p><p id="8573" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我使用ExpressJS编写了一个小型NodeJS服务器，以理解使用Typescript和第三方包时的基本概念。</p><p id="0926" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">⚫️:很好，一切正常。编辑器不会突出显示任何错误。中间件和关键实例代表。👌🏻对于我的项目，需要一些自定义变量。这样的变量是“user”，它包含一个在Request ExpressJS对象中带有用户数据的对象。<br/>我添加了它，并得到了我的第一个错误:</p><p id="c93e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你试图编译，你会得到一个错误。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="2f57" class="li lj je le b gy lk ll l lm ln">Property ‘user’ does not exist on type ‘Request&lt;ParamsDictionary&gt;</span></pre><p id="c31c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">可能文本编辑器突出显示了它:</p><figure class="kz la lb lc gt iv gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/645c09de6221ac566dd31693e51f72d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*bHjcEHN39wQpYi-w9uOvVA.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">d</figcaption></figure><h2 id="e132" class="li lj je bd lv lw lx dn ly lz ma dp mb km mc md me kq mf mg mh ku mi mj mk ml bi translated">声明合并来拯救！🧞‍♂️ 🧞‍♂️ 🧞‍♂️</h2><blockquote class="mm mn mo"><p id="f43a" class="kb kc mp kd b ke kf kg kh ki kj kk kl mq kn ko kp mr kr ks kt ms kv kw kx ky im bi translated">从TS官方文档网站:'<a class="ae lo" href="https://www.typescriptlang.org/docs/handbook/declaration-merging.html" rel="noopener ugc nofollow" target="_blank">声明合并</a> —编译器将两个用相同名称声明的独立声明合并成一个定义。'</p></blockquote><p id="4db1" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">🔵因此，让我们看看这个概念如何帮助我们处理“req.user”</p><p id="3caf" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">创建这个文件夹结构——“src/types/index . ts”——我们把我们的自定义类型。将这些行添加到新创建的文件中:</p><p id="74db" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们需要更新tsconfig.json，告诉编译器包含来自src/types/index.ts文件的自定义类型。</p><p id="5826" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">还记得“typeRoots”属性吗？更新其值。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="6d71" class="li lj je le b gy lk ll l lm ln">"typeRoots": [<br/>    "src/types/index.ts","node_modules/@types"<br/>],</span></pre><p id="89da" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里重要的是在node_module/@types之前包含src/types</p><p id="ad77" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">简单地说。编译器从node_modules/@types/express文件夹中获取我们的自定义类型和请求对象的类型，然后将其合并，并使用我们的“user”字段生成新类型。</p><p id="055c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你试着编译并运行你的应用程序，一切都会好的。编辑器不应突出显示该错误。</p><p id="ec57" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">🔻结论:<br/>我对打字稿有一种复杂的感情。一方面，它提供了自动完成、类型安全和一个巨大的社区。什么叫牛逼！然而，另一方面，我们有Dart lang，其中所有类型检查功能都是现成的。</p><p id="fa38" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢阅读！<a class="ae lo" href="https://emojipedia.org/robot-face/" rel="noopener ugc nofollow" target="_blank">🤖</a> <a class="ae lo" href="https://emojipedia.org/sign-of-the-horns/" rel="noopener ugc nofollow" target="_blank">🤘</a>T9】🤙</p></div></div>    
</body>
</html>
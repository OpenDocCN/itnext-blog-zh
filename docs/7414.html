<html>
<head>
<title>Introduction to Angular Language Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular语言服务简介</h1>
<blockquote>原文：<a href="https://itnext.io/introduction-to-angular-language-service-4d3e67901a77?source=collection_archive---------1-----------------------#2022-09-16">https://itnext.io/introduction-to-angular-language-service-4d3e67901a77?source=collection_archive---------1-----------------------#2022-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/fe2303172a371b8d4ccc8281e4677710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OiPR5-PzM5VekY54oQLpnQ.png"/></div></div></figure><div class=""/><p id="1d21" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Angular有它的缺点，但真正让它开始变得有趣的是它的语言服务。</p><h2 id="50f9" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">什么是语言服务？</h2><p id="c6a5" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">语言服务是一个你输入代码的程序，它会在每个文件的基础上向你报告<strong class="ka jc">完成</strong>、<strong class="ka jc">错误</strong>、<strong class="ka jc">提示</strong>和<strong class="ka jc">诊断</strong>，同时区分每个文件的语法和语义错误。这就是Angular语言服务为Angular项目所做的事情。</p><h2 id="cbdc" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">它对我们有什么帮助？</h2><p id="75ba" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">角度代码文件以<strong class="ka jc">结尾。ts </strong>或<strong class="ka jc">。html </strong>，所以代码编辑器认为我们正在编写Typescript和html代码，但这并不完全正确。因为，除此之外我们还在编写Angular的具体语法，比如:<strong class="ka jc">组件</strong>、<strong class="ka jc">指令</strong>、<strong class="ka jc">属性</strong> / <strong class="ka jc">事件</strong> <strong class="ka jc">绑定</strong>等。代码编辑对它们一无所知。</p><p id="0a8f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是语言服务为我们做的；它知道你在一个Angular项目中，并告诉编辑器Angular的具体语法是什么。</p><blockquote class="lu lv lw"><p id="0b83" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated">VS代码使用<a class="ae mb" href="https://github.com/typescript-language-server/typescript-language-server" rel="noopener ugc nofollow" target="_blank"> Typescript语言服务</a>和<a class="ae mb" href="https://github.com/microsoft/vscode-html-languageservice" rel="noopener ugc nofollow" target="_blank"> HTML语言服务</a>来理解Typescript和HTML文件，因为它们被广泛使用，所以默认情况下它们与VS代码捆绑在一起。</p></blockquote><p id="8cde" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们刚刚安装了VS代码，并使用内联模板打开了一个Angular组件，我们将看到以下内容:</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/27bece0ce1ebe0b0c7fba319d1e402da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tB5FDSAv9bM-00mkeWMUVQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">带内嵌模板的角度组件(无语言服务)</figcaption></figure><p id="ba6f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为编辑器认为这是一个typescript文件，所以它不会为模板部分提供代码突出显示，并且它将像字符串一样显示，即使编辑器支持HTML(这里我们在一个Typescript文件中)。</p><p id="4671" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，我们不会从中获得任何对Angular和HTML语法的支持。因此，如果我们将鼠标悬停在<strong class="ka jc"> div </strong>或<strong class="ka jc">点击绑定</strong>或<strong class="ka jc"> *ngIf指令</strong>上，我们将不会得到任何信息。</p><p id="e573" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">语言服务</strong>告诉编辑器我们在一个<strong class="ka jc"> Angular </strong>组件中，并把模板字段当作一个Angular模板，它实际上是一个具有增强功能的HTML(上面有一些面筋)。</p><p id="8893" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们安装<a class="ae mb" href="https://marketplace.visualstudio.com/items?itemName=Angular.ng-template" rel="noopener ugc nofollow" target="_blank"> Angular语言服务</a>并再次打开那个文件。我们会看到更好的东西。</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/6f5fd3c2f38958ff6afda219f2657929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bRy4x9R3TLVRGhf4yryi7w.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">语法高亮显示的角度组件</figcaption></figure><p id="7e82" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将鼠标悬停在模板中的一些元素上，看看它提供了什么样的信息。</p><h2 id="92db" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">事件绑定</h2><p id="e3be" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">如果我们将鼠标悬停在<strong class="ka jc"> click </strong>事件上，我们会看到该信息只是<strong class="ka jc"> div </strong>元素中的<strong class="ka jc"> addEventListener </strong>(因为这就是点击绑定的作用)。</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/7b745f7217546966d676b6557a48b3ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LP-7gBLNA74PSUOsOjtl_Q.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">事件绑定信息</figcaption></figure><p id="4423" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">而<strong class="ka jc"> $event </strong>值的类型是<strong class="ka jc"> MouseEvent </strong>，因为这是一个<strong class="ka jc"> addEventListener </strong>与<strong class="ka jc"> click事件类型</strong>所分派的。所以，没有神奇的🪄！</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/74d3904ba339f0dc89bd5e31a0264975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUE9puFvBpLYJikJJSX7iA.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">$事件信息</figcaption></figure><p id="5001" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们添加一个具有<strong class="ka jc">输出</strong>的组件，并将其添加到模板中。</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/24450d13e6083763683c1eba85044dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v6ieKDE-Qc4OXfqVZV5NEg.png"/></div></div></figure><p id="21e9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们将鼠标悬停在<strong class="ka jc"> onGameStart </strong>事件上时，我们可以看到这只是一个<strong class="ka jc"> EventEmitter </strong>发出一个<strong class="ka jc">布尔值</strong>，没错！</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/ffbb90a8008ca1ce79b1890cae9a2b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VPlb08guB4ziLBVw9I2ang.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">组件输出中有关事件绑定的信息</figcaption></figure><h2 id="11f8" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">插入文字</h2><p id="a7b2" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">如果我们将鼠标悬停在插入的<strong class="ka jc">版本</strong>变量上，我们可以看到将会显示正确的类型，因此版本只是类型号为的<strong class="ka jc"> LazyComponent </strong>的<strong class="ka jc">属性</strong>。这也适用于复杂类型。</p><blockquote class="lu lv lw"><p id="58b1" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated">一切都显示正确类型的原因是因为Angular模板是严格类型化的，而语言服务只是使用幕后的Angular编译器来获取所有这些信息。</p></blockquote><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/2590c78eecb2d7dcc1557843e775b9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJKWaSjEyFSqdMDazN4K_g.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">插值信息</figcaption></figure><h2 id="be4e" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">数据绑定</h2><p id="4e29" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">让我们向之前创建的组件添加一个<strong class="ka jc">输入</strong>，并从<strong class="ka jc"> LazyComponent </strong>向其传递一些数据。</p><p id="af32" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">游戏版本输入是数字类型的，这里我们传递一个数字类型的属性。一切都很好。</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mm"><img src="../Images/6f2f49bd58f794728e404c8aeaf9c0cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eHdkHWS4xXH2a3523fyHiQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">数据绑定信息</figcaption></figure><p id="bd10" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将LazyComponent上的属性更改为字符串类型，看看我们会得到什么:</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mm"><img src="../Images/9e57a41e39fe86f0ae6aeb7171a3e18d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y51IDVTrZZAZPk4bQ3Vr1A.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">将属性传递给组件时出错(类型错误)</figcaption></figure><p id="3aa7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，我们会得到一个错误，告诉我们传递的属性的类型与输入要求的类型不同。</p><h2 id="8e44" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">指令信息</h2><p id="0836" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">在模板中我们有一个<strong class="ka jc"> *ngIf </strong>指令。如果我们悬停在它上面，我们将看到它来自的类和它的一般类型，在这种情况下，它是一个布尔值。因此，我们需要向<strong class="ka jc"> *ngIf </strong>指令传递一个布尔表达式。</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mn"><img src="../Images/3ed1e2d252c71335821bf8d55b1b91ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yPK9GQZg1dZzWdLYnjh9ng.png"/></div></div></figure><p id="bfd5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们为指令添加一个<strong class="ka jc">NGF，看看编辑器给了我们什么信息。</strong></p><p id="d3bf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，它将向我们展示指令类是NgForOf及其泛型类型。目前为止很棒！</p><figure class="md me mf mg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/e65a0954aeb01f8cceeec8fb0c5cd7c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dOt6TmThgAJJxNkbY14l-A.png"/></div></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="6ccd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些是语言服务提供给我们的一些信息！</p><p id="3379" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但还有更多，耶🥳！</p><h2 id="9e94" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">转到定义</h2><p id="bda1" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">我们可以<strong class="ka jc">在模板中的每个项目上右键单击</strong>，然后单击<strong class="ka jc">转到定义</strong>，它会将我们带到那里！无论是<strong class="ka jc">组件</strong>、<strong class="ka jc">指令</strong>、<strong class="ka jc">输入</strong>、<strong class="ka jc">事件</strong>、<strong class="ka jc"> DOM </strong>元素等。</p><figure class="md me mf mg gt is"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="a1f7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们所见，它将把我们送到正确的地方，无论是在我们的组件、指令、Angular提供的指令，还是DOM元素的类型，如<strong class="ka jc"> lib.dom.ts </strong>等。</p><h2 id="c088" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">转到参考</h2><p id="050e" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">我们也可以使用<strong class="ka jc"> Go to references </strong>选项，它会向我们显示我们使用过所搜索项目的每个地方！</p><figure class="md me mf mg gt is"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h2 id="a314" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">重命名模板中的符号</h2><p id="d124" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">因为Angular中的所有内容都是<strong class="ka jc">类型脚本</strong>，我们可以使用模板中的<strong class="ka jc">重命名符号</strong>，该符号的所有引用都将被重命名。无论是<strong class="ka jc">输入</strong>、<strong class="ka jc">输出</strong>、<strong class="ka jc">类属性</strong>还是<strong class="ka jc">方法</strong>等。</p><figure class="md me mf mg gt is"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="b7fb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们从内部类而不是从模板中重命名符号功能，它将不能100%正确地工作，因为在VS代码本身中有一个<a class="ae mb" href="https://github.com/microsoft/vscode/issues/115354" rel="noopener ugc nofollow" target="_blank">问题还没有解决！</a></p><h2 id="113e" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">代码自动完成</h2><p id="79a8" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">如果我们开始在模板上写东西，语言服务将提供我们可以使用的VS代码自动完成数据，可以是输入、输出、事件、类属性等等。</p><figure class="md me mf mg gt is"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h2 id="fe30" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">代码修复</h2><p id="cca1" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">在最新版本的语言服务中，我们可以利用代码修复。我们可以直接从模板中创建<strong class="ka jc">属性</strong>或<strong class="ka jc">方法</strong>，或者修复我们可能写错的东西。</p><figure class="md me mf mg gt is"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="24e7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们所看到的，它将创建方法并传递我们传递给该方法的事件类型，在本例中是<strong class="ka jc"> MouseEvent </strong>。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="5bb2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">角语服务</strong>有了长足的进步！因为有了Ivy编译器，它被从头开始重写了，这是值得的！因为现在我们有了所有这些以前不可能的好东西。</p><p id="c132" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还会有很多很酷的东西出现，比如为独立组件和NgModules导入组件、指令和管道。</p><p id="59e3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在那之前，去安装语言服务(如果你还没有的话)并充分利用它，它有很多优点，让你的编码更容易！</p><p id="ba60" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这篇文章，给我一个关注，并为下一篇做好准备。👋</p></div></div>    
</body>
</html>
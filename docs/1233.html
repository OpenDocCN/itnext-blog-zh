<html>
<head>
<title>Migrate your app to Android Oreo — Part 3 Notifications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将您的应用迁移到Android Oreo——第3部分通知</h1>
<blockquote>原文：<a href="https://itnext.io/migrate-your-app-to-android-oreo-part-3-notifications-b59d7c6313f9?source=collection_archive---------0-----------------------#2018-08-17">https://itnext.io/migrate-your-app-to-android-oreo-part-3-notifications-b59d7c6313f9?source=collection_archive---------0-----------------------#2018-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/8d4f03b914d7843ede867172b90186d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzvkyQYVRtYITvB9OMN3iA.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片来自<a class="ae jd" href="http://www.pexels.com" rel="noopener ugc nofollow" target="_blank">www.pexels.com</a></figcaption></figure><div class=""/><p id="2f93" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Android Oreo (8.0)带来了许多很酷的新功能，如画中画、智能文本选择等等。但是最重要的变化之一出现在通知领域。</p><ol class=""><li id="eb5e" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/migrate-your-app-to-android-oreo-e0fa794b1d21">服务—背景限制</a></li><li id="afe5" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/migrate-your-app-to-android-oreo-part-2-broadcastreceivers-3f1f12f764fc">广播接收机</a></li><li id="2700" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf jh">通知</strong></li><li id="b1a3" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">运行时权限</li><li id="5f2e" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">警告</li><li id="8567" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Firebase云消息传递(截止日期:2019年4月)</li></ol><p id="724f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在有了Android Oreo，开发者可以通过为每个通知创建不同的<strong class="kf jh">通道</strong>来分离通知的行为。重要的是，没有为通知指定通道，该通知不会出现在状态栏中。</p><p id="dca0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有使用相同通道的通知将具有相同的行为，因此根据通知的重要性创建<strong class="kf jh">不同的通道非常重要。</strong></p><p id="651f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以为我们的应用程序的最紧急通知创建一个频道，每个通知都有振动、警报声音和通知灯。如果我们的应用程序有另一种不太重要的通知，我们可以创建一个更安静的通道，只在状态栏中显示通知，没有声音和灯光。</p><p id="cb1d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，您可以看到Gmail的通知渠道:</p><figure class="lq lr ls lt gt is gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/c95ac6d3647286af1e54148af22bb2de.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*lnX6RP7e5HskeiPTafsaPg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Gmail通知渠道</figcaption></figure><h1 id="f9e9" class="lu lv jg bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><strong class="ak">如何在Android Oreo中显示通知？</strong></h1><ul class=""><li id="58a1" class="lb lc jg kf b kg ms kk mt ko mu ks mv kw mw la mx lh li lj bi translated"><strong class="kf jh">在Android Oreo </strong>之前，当我们想要创建一个通知时，我们必须这样做:</li></ul><figure class="lq lr ls lt gt is"><div class="bz fp l di"><div class="my mz l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">在安卓奥利奥之前显示通知</figcaption></figure><p id="983d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以看到在Android Oreo之前，我们没有指定任何关于渠道的内容。所以所有的通知都有相同的行为。</p><ul class=""><li id="ee43" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la mx lh li lj bi translated"><strong class="kf jh">现在有了Android Oreo </strong>，要显示一个通知，我们必须这样做:</li></ul><figure class="lq lr ls lt gt is"><div class="bz fp l di"><div class="my mz l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">使用Android Oreo显示通知</figcaption></figure><p id="ea0b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果你详细分析代码，区别在于我们要为版本≥ Android Oreo的Android设备创建一个通道。</p><pre class="lq lr ls lt gt na nb nc nd aw ne bi"><span id="bba2" class="nf lv jg nb b gy ng nh l ni nj">if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) { <br/>    val channel = NotificationChannel(channelId,<br/>                    BuildConfig.NOTIFICATION_CHANNEL_ALARMS_NAME,<br/>                    NotificationManager.IMPORTANCE_DEFAULT)<br/>    notificationManager.createNotificationChannel(channel) <br/>}</span></pre><p id="3687" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Android Oreo中引入的另一个变化是通知的重要性，在下表中，您可以检查<strong class="kf jh">通知</strong>的<strong class="kf jh">不同重要性</strong>:</p><figure class="lq lr ls lt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/4bd3ec0ad3a79168d2003f8d488b0ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PAgWOm6alqRA6t7D2r-9SA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">通知的重要性</figcaption></figure><p id="9a19" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想进一步定制您的通道的默认通知行为，您可以在<code class="fe nl nm nn nb b"><a class="ae jd" href="https://developer.android.com/reference/android/app/NotificationChannel.html" rel="noopener ugc nofollow" target="_blank">NotificationChannel</a></code>上调用<code class="fe nl nm nn nb b"><a class="ae jd" href="https://developer.android.com/reference/android/app/NotificationChannel.html#enableLights(boolean)" rel="noopener ugc nofollow" target="_blank">enableLights()</a></code>、<code class="fe nl nm nn nb b"><a class="ae jd" href="https://developer.android.com/reference/android/app/NotificationChannel.html#setLightColor(int)" rel="noopener ugc nofollow" target="_blank">setLightColor()</a></code>和<code class="fe nl nm nn nb b"><a class="ae jd" href="https://developer.android.com/reference/android/app/NotificationChannel.html#setVibrationPattern(long[])" rel="noopener ugc nofollow" target="_blank">setVibrationPattern()</a></code>等方法。</p><h1 id="0deb" class="lu lv jg bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">👮<strong class="ak">重要的</strong>👮</h1><p id="342d" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated"><strong class="kf jh">但是请记住，一旦您创建了频道，您就不能更改这些设置，并且用户可以最终控制这些行为是否处于活动状态。</strong></p><h1 id="e764" class="lu lv jg bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">如何删除通知频道？</h1><p id="7a4d" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">将来，您可能会创建一个通知通道，但是从现在开始我们不想再使用它了。以下示例代码演示了如何删除通知通道:</p><figure class="lq lr ls lt gt is"><div class="bz fp l di"><div class="my mz l"/></div></figure><h1 id="33d0" class="lu lv jg bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">服务必须显示通知</h1><p id="db52" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">在<a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/migrate-your-app-to-android-oreo-e0fa794b1d21">之前的帖子</a>中，我们解释了在Android Oreo中使用服务的局限性。我们说过，如果我们想在后台使用服务，我们必须通过状态栏中的通知来警告用户。</p><p id="f4b8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，如果我们不希望此通知发出声音或振动，我们建议创建一个“无声”频道，并强调以下重要性:</p><pre class="lq lr ls lt gt na nb nc nd aw ne bi"><span id="91c7" class="nf lv jg nb b gy ng nh l ni nj">NotificationManager.IMPORTANCE_LOW</span></pre><p id="0b28" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是<strong class="kf jh">最小重要性</strong>，我们可以在<strong class="kf jh">启动服务</strong>时将其设置为通知，如果您使用“Importance_min ”,当您启动它时将会抛出一个异常。</p><p id="441e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想了解更多信息，你可以查看官方文档<a class="ae jd" href="https://developer.android.com/training/notify-user/channels" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="5959" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望这篇帖子对你有帮助。编码快乐！</p><p id="101b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi">👏😃</p></div></div>    
</body>
</html>
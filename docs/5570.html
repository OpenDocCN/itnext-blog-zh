<html>
<head>
<title>Building your own Maven archetype</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建您自己的Maven原型</h1>
<blockquote>原文：<a href="https://itnext.io/building-your-own-maven-archetype-fa7b9d646efd?source=collection_archive---------5-----------------------#2021-04-06">https://itnext.io/building-your-own-maven-archetype-fa7b9d646efd?source=collection_archive---------5-----------------------#2021-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f1b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Github很容易与他人共享代码，例如我创建了<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank">jakartaee 9-starter-boilerplate</a>作为jakartaee开发人员的项目模板。对于那些熟悉Github的人来说，直接分叉或克隆这个项目就可以很容易地开始他们的新项目。但是很明显，对于一个普通的Jakarta EE应用程序，你不需要所有应用服务器的配置，比如Glassfish/Payara、WildFly、OpenLiberty、Apache TomEE等等。对于大多数Java开发人员，尤其是。Maven用户，简单干净的Maven原型仍然是生成新项目框架的首选，您可以在以后添加所需的配置。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/24cef39b9a00eb0f9fe57e917ca07494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zDxsL3REyJ2m4UkfBNpcZQ.jpeg"/></div></div></figure><p id="fe9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在过去的几年里，我自己也创建了一些maven原型，比如toys，但是我从来没有通过Maven Central repository公开过它们。在这篇文章中，我将重放为Jakarta EE 9 创建<a class="ae kl" href="https://github.com/hantsy/maven-archetype-jakartaee9" rel="noopener ugc nofollow" target="_blank"> Maven原型的步骤，以及随后将它发布到Maven中央存储库并向全世界公开的步骤。</a></p><h2 id="0420" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">一个更好的格式版本发布在dev.to上，<a class="ae kl" href="https://dev.to/hantsy_26/building-your-own-maven-archetype-gm8" rel="noopener ugc nofollow" target="_blank">https://dev . to/hantsy _ 26/building-your-own-maven-archetype-gm8</a></h2><h1 id="4e72" class="lr kz iq bd la ls lt lu ld lv lw lx lg ly lz ma lj mb mc md lm me mf mg lp mh bi translated">生成原型项目框架</h1><p id="7ad4" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">Maven <strong class="jp ir">原型</strong>是用于在Maven构建系统中生成新项目的Maven特定模板。Maven本身提供了一个官方原型(<code class="fe mn mo mp mq b">maven-archetype-archetype</code>)，供你构建自己的Maven原型。</p><p id="c649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://maven.apache.org/guides/introduction/introduction-to-archetypes.html" rel="noopener ugc nofollow" target="_blank">官方原型介绍页面</a>列出了所有官方原型。</p><p id="267b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行以下命令，以交互模式生成原型项目。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="3720" class="ky kz iq mq b gy mv mw l mx my">mvn archetype:generate</span></pre><p id="b231" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您按下<em class="mz"> Enter </em>键时，需要几秒钟来列出所有可用的原型。每个原型都有一个数字。</p><p id="e7e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">键入<code class="fe mn mo mp mq b">maven-archetype-archetype</code>的编号，然后它会要求您填写您的项目的<code class="fe mn mo mp mq b">groupId</code>、<code class="fe mn mo mp mq b">archetypeId</code>、<code class="fe mn mo mp mq b">package</code>和<code class="fe mn mo mp mq b">version</code>。在所有字段都按预期填充后，它将在几秒钟内生成项目。</p><p id="6653" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，您可以在单个命令中生成项目，也称为批处理模式。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="1295" class="ky kz iq mq b gy mv mw l mx my">mvn archetype:generate -B \<br/>-DarchetypeGroupId=org.apache.maven.archetypes \<br/>-DarchetypeArtifactId=maven-archetype-archetype \<br/>-DarchetypeVersion=1.4 \<br/>-DgroupId=io.github.hantsy \<br/>-DartifactId=maven-archetype-jakartaee9 \<br/>-Dversion=1.0-SNAPSHOT</span></pre><p id="f01a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意这里我们使用命令行中的<code class="fe mn mo mp mq b">-B</code>参数来跳过交互式问卷调查步骤，并以<strong class="jp ir">批处理</strong>模式运行该命令。</p><p id="8c63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多关于Maven原型和<code class="fe mn mo mp mq b">maven-archetype-plugin</code>的信息，请查看<a class="ae kl" href="http://maven.apache.org/archetype/" rel="noopener ugc nofollow" target="_blank"> Maven原型</a>。</p><h1 id="7cc5" class="lr kz iq bd la ls lt lu ld lv lw lx lg ly lz ma lj mb mc md lm me mf mg lp mh bi translated">探索项目结构</h1><p id="aa6f" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">将项目导入到您的ide中，如Apache NetBeans、IntelliJ IDEA等。</p><p id="5515" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将看到下面的项目文件结构。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="6719" class="ky kz iq mq b gy mv mw l mx my">├── pom.xml<br/>└── src<br/>    ├── main<br/>    │   └── resources<br/>    │       ├── archetype-resources<br/>    │       │   ├── pom.xml<br/>    │       │   └── src<br/>    │       │       ├── main<br/>    │       │       │   └── java<br/>    │       │       │       └── App.java<br/>    │       │       └── test<br/>    │       │           └── java<br/>    │       │               └── AppTest.java<br/>    │       └── META-INF<br/>    │           └── maven<br/>    │               └── archetype-metadata.xml<br/>    └── test<br/>        └── resources<br/>            └── projects<br/>                └── it-basic<br/>                    ├── archetype.properties<br/>                    └── goal.txt</span></pre><p id="dd63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其结构类似于一般的Maven项目，但有一些不同。</p><ol class=""><li id="08fc" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated"><em class="mz">src/main/resources/architect-resources</em>文件夹存储了用于从这个原型生成项目的所有模板资源。</li><li id="03a6" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated"><em class="mz">src/main/resources/META-INF/maven-archetype-metadata . XML</em>是原型描述文件，包括属性、文件集等。</li><li id="ae32" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated"><em class="mz">src/test/resources/projects</em>包括测试这个原型的资源，包括应用于生成新项目的属性和在主机<code class="fe mn mo mp mq b">integration-test</code>阶段运行的目标。</li></ol><h1 id="8e29" class="lr kz iq bd la ls lt lu ld lv lw lx lg ly lz ma lj mb mc md lm me mf mg lp mh bi translated">准备原型资源</h1><p id="15b8" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">为了简化工作，我重用了来自<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank">jakartaee 9-starter-boilerplate</a>的样本代码。</p><ol class=""><li id="c9ef" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated">将<code class="fe mn mo mp mq b">GreetingMessage</code>、<code class="fe mn mo mp mq b">GreetingService</code>、<code class="fe mn mo mp mq b">GreetingService</code>和<code class="fe mn mo mp mq b">JaxrsActivator</code>复制到<em class="mz">src/main/resources/architect-resources/src/main/Java</em>文件夹中。将包声明更改为以下内容。</li></ol><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="73a7" class="ky kz iq mq b gy mv mw l mx my">package $package; <br/>…</span></pre><p id="efd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.与上一步类似，将<code class="fe mn mo mp mq b">GreetingResourceTest</code>和<code class="fe mn mo mp mq b">GreetingServiceTest</code>复制到<em class="mz">src/main/resources/architect-resources/src/test/Java</em>文件夹中。请记住更改包声明。</p><p id="9c0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.将空的<code class="fe mn mo mp mq b">beans.xml</code>文件添加到<em class="mz">src/main/resources/architect-resources/src/main/resources/META-INF/</em>文件夹中。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="cbbb" class="ky kz iq mq b gy mv mw l mx my">&lt;beans xmlns=”https://jakarta.ee/xml/ns/jakartaee" xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation=”https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/beans_3_0.xsd" version=”3.0"&gt; &lt;/beans&gt;</span></pre><p id="392a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.将一个简单的<code class="fe mn mo mp mq b">arquillian.xml</code>添加到<em class="mz">src/main/resources/architect-resources/src/test/resources</em>文件夹中。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="ad19" class="ky kz iq mq b gy mv mw l mx my">&lt;arquillian xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance" xmlns=”http://jboss.org/schema/arquillian" xsi:schemaLocation=”http://jboss.org/schema/arquillian http://jboss.org/schema/arquillian/arquillian_1_0.xsd"&gt; &lt;defaultProtocol type=”Servlet 5.0"/&gt; </span><span id="47f8" class="ky kz iq mq b gy no mw l mx my">&lt;engine&gt; <br/>  &lt;property name=”deploymentExportPath”&gt;target/&lt;/property&gt; &lt;/engine&gt; <br/>&lt;container qualifier=”glassfish” default=”true”&gt; <br/>&lt;configuration&gt; <br/>  &lt;property name=”adminHost”&gt;localhost&lt;/property&gt;<br/>  &lt;property name=”adminPort”&gt;4848&lt;/property&gt; <br/>  &lt;property name=”adminUser”&gt;admin&lt;/property&gt; &lt;! — if https is enabled via `asadmin enable-secure-admin` on a remote server →<br/>  &lt;! — &lt;property name=”adminHttps”&gt;true&lt;/property&gt; →<br/>  &lt;! — if admin password is changed via `asadmin change-admin-password` → <br/>  &lt;! — &lt;property name=”adminPassword”&gt;adminadmin&lt;/property&gt; →<br/>  &lt;! — default is empty → &lt;property name=”adminPassword”&gt;&lt;/property&gt; <br/>&lt;/configuration&gt; <br/>&lt;/container&gt; <br/>&lt;/arquillian&gt;</span></pre><p id="7d0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.将<code class="fe mn mo mp mq b">pom.xml</code>模板(<em class="mz">src/main/resources/archetype-resources/POM . XML</em>)更改为以下内容。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="f704" class="ky kz iq mq b gy mv mw l mx my">&lt;project  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br/>  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;<br/>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>  &lt;groupId&gt;${groupId}&lt;/groupId&gt;<br/>  &lt;artifactId&gt;${artifactId}&lt;/artifactId&gt;<br/>  &lt;version&gt;${version}&lt;/version&gt;<br/>  &lt;packaging&gt;war&lt;/packaging&gt;<br/><br/>  &lt;name&gt;${artifactId}&lt;/name&gt;<br/>  &lt;description&gt;A Jakarta EE starter boilerplate for Jakarta EE 9&lt;/description&gt;<br/>  &lt;properties&gt;<br/>    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;<br/>    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;<br/>    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;<br/>    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;<br/><br/>    &lt;!-- Official Maven Plugins --&gt;<br/>    &lt;maven-compiler-plugin.version&gt;3.8.1&lt;/maven-compiler-plugin.version&gt;<br/>    &lt;maven-war-plugin.version&gt;3.3.1&lt;/maven-war-plugin.version&gt;<br/>    &lt;maven-dependency-plugin.version&gt;3.1.2&lt;/maven-dependency-plugin.version&gt;<br/>    &lt;maven-surefire-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-plugin.version&gt;<br/>    &lt;maven-failsafe-plugin.version&gt;3.0.0-M5&lt;/maven-failsafe-plugin.version&gt;<br/>    &lt;maven-surefire-report-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-report-plugin.version&gt;<br/><br/>    &lt;!-- Cargo maven plugin --&gt;<br/>    &lt;!-- Since 1.9.0, cargo-maven3-plugin is the default for cargo prefix. --&gt;<br/>    &lt;cargo-maven3-plugin.version&gt;1.9.0&lt;/cargo-maven3-plugin.version&gt;<br/><br/>    &lt;!-- Jakarta EE API --&gt;<br/>    &lt;jakartaee-api.version&gt;9.0.0&lt;/jakartaee-api.version&gt;<br/><br/>    &lt;!-- Arquillian BOM --&gt;<br/>    &lt;arquillian-bom.version&gt;1.7.0.Alpha9&lt;/arquillian-bom.version&gt;<br/>    &lt;junit-jupiter.version&gt;5.7.1&lt;/junit-jupiter.version&gt;<br/><br/>    &lt;!-- Glassfish server --&gt;<br/>    &lt;glassfish.version&gt;6.0.0&lt;/glassfish.version&gt;<br/>    &lt;arquillian-glassfish6.version&gt;1.0.0.Alpha1&lt;/arquillian-glassfish6.version&gt;<br/>    &lt;jersey.version&gt;3.0.1&lt;/jersey.version&gt;<br/><br/>    &lt;!-- by default skip tests --&gt;<br/>    &lt;skipTests&gt;true&lt;/skipTests&gt;<br/>  &lt;/properties&gt;<br/><br/>  &lt;dependencyManagement&gt;<br/>    &lt;dependencies&gt;<br/>      &lt;dependency&gt;<br/>        &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;<br/>        &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;<br/>        &lt;version&gt;${jakartaee-api.version}&lt;/version&gt;<br/>        &lt;scope&gt;provided&lt;/scope&gt;<br/>      &lt;/dependency&gt;<br/>      &lt;dependency&gt;<br/>        &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt;<br/>        &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt;<br/>        &lt;version&gt;${arquillian-bom.version}&lt;/version&gt;<br/>        &lt;scope&gt;import&lt;/scope&gt;<br/>        &lt;type&gt;pom&lt;/type&gt;<br/>      &lt;/dependency&gt;<br/>      &lt;dependency&gt;<br/>        &lt;groupId&gt;org.junit&lt;/groupId&gt;<br/>        &lt;artifactId&gt;junit-bom&lt;/artifactId&gt;<br/>        &lt;version&gt;${junit-jupiter.version}&lt;/version&gt;<br/>        &lt;type&gt;pom&lt;/type&gt;<br/>        &lt;scope&gt;import&lt;/scope&gt;<br/>      &lt;/dependency&gt;<br/>    &lt;/dependencies&gt;<br/>  &lt;/dependencyManagement&gt;<br/><br/>  &lt;dependencies&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;<br/>      &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;org.jboss.arquillian.junit5&lt;/groupId&gt;<br/>      &lt;artifactId&gt;arquillian-junit5-container&lt;/artifactId&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;!-- see: https://github.com/arquillian/arquillian-core/issues/248 --&gt;<br/>    &lt;!-- and https://github.com/arquillian/arquillian-core/pull/246/files --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt;<br/>      &lt;artifactId&gt;arquillian-protocol-servlet-jakarta&lt;/artifactId&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;<br/>      &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;<br/>  &lt;/dependencies&gt;<br/><br/>  &lt;build&gt;<br/>    &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt;<br/>    &lt;pluginManagement&gt;<br/>      &lt;plugins&gt;<br/>        &lt;plugin&gt;<br/>          &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>          &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt;<br/>          &lt;version&gt;${cargo-maven3-plugin.version}&lt;/version&gt;<br/>        &lt;/plugin&gt;<br/>      &lt;/plugins&gt;<br/>    &lt;/pluginManagement&gt;<br/>    &lt;plugins&gt;<br/>      &lt;plugin&gt;<br/>        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;<br/>        &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;<br/>      &lt;/plugin&gt;<br/>      &lt;plugin&gt;<br/>        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;<br/>        &lt;version&gt;${maven-war-plugin.version}&lt;/version&gt;<br/>      &lt;/plugin&gt;<br/>    &lt;/plugins&gt;<br/>  &lt;/build&gt;<br/>  &lt;profiles&gt;<br/>    &lt;profile&gt;<br/>      &lt;id&gt;glassfish&lt;/id&gt;<br/>      &lt;activation&gt;<br/>        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;<br/>      &lt;/activation&gt;<br/>      &lt;build&gt;<br/>        &lt;plugins&gt;<br/>          &lt;plugin&gt;<br/>            &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>            &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt;<br/>            &lt;configuration&gt;<br/>              &lt;container&gt;<br/>                &lt;containerId&gt;glassfish6x&lt;/containerId&gt;<br/>                &lt;artifactInstaller&gt;<br/>                  &lt;groupId&gt;org.glassfish.main.distributions&lt;/groupId&gt;<br/>                  &lt;artifactId&gt;glassfish&lt;/artifactId&gt;<br/>                  &lt;version&gt;${glassfish.version}&lt;/version&gt;<br/>                &lt;/artifactInstaller&gt;<br/>              &lt;/container&gt;<br/>              &lt;configuration&gt;<br/>                &lt;!-- the configuration used to deploy --&gt;<br/>                &lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt;<br/>                &lt;properties&gt;<br/>                  &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br/>                &lt;/properties&gt;<br/>              &lt;/configuration&gt;<br/>            &lt;/configuration&gt;<br/>          &lt;/plugin&gt;<br/>        &lt;/plugins&gt;<br/>      &lt;/build&gt;<br/><br/>      &lt;dependencies&gt;<br/>        &lt;!-- Jersey --&gt;<br/>        &lt;dependency&gt;<br/>          &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br/>          &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt;<br/>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>          &lt;scope&gt;test&lt;/scope&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>          &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br/>          &lt;artifactId&gt;jersey-media-json-binding&lt;/artifactId&gt;<br/>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>          &lt;scope&gt;test&lt;/scope&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>          &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;<br/>          &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;<br/>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>          &lt;scope&gt;test&lt;/scope&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>          &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;<br/>          &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;<br/>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>          &lt;scope&gt;test&lt;/scope&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>          &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;<br/>          &lt;artifactId&gt;arquillian-glassfish-remote-6&lt;/artifactId&gt;<br/>          &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt;<br/>          &lt;scope&gt;test&lt;/scope&gt;<br/>        &lt;/dependency&gt;<br/>      &lt;/dependencies&gt;<br/><br/>    &lt;/profile&gt;<br/>  &lt;/profiles&gt;<br/>&lt;/project&gt; </span></pre><p id="c4ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，这个xml中的<code class="fe mn mo mp mq b">groupId</code>、<code class="fe mn mo mp mq b">artifactId</code>和<code class="fe mn mo mp mq b">version</code>元素的值指的是一个占位符，它可以在生成阶段被截取。</p><p id="75d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.将原型描述符(<em class="mz">src/main/resources/META-INF/maven/archetype-metadata . XML</em>)更改为以下内容。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="c811" class="ky kz iq mq b gy mv mw l mx my">&lt;archetype-descriptor xmlns=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0" xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0 http://maven.apache.org/xsd/archetype-descriptor-1.0.0.xsd" name=”${artifactId}”&gt; &lt;fileSets&gt; <br/>&lt;fileSet filtered=”true” packaged=”true”&gt;<br/> &lt;directory&gt;src/main/java&lt;/directory&gt; <br/>&lt;/fileSet&gt; <br/>&lt;fileSet&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; <br/>&lt;/fileSet&gt; <br/>&lt;fileSet filtered=”true” packaged=”true”&gt; <br/>&lt;directory&gt;src/test/java&lt;/directory&gt; <br/>&lt;/fileSet&gt; <br/>&lt;fileSet&gt; <br/>&lt;directory&gt;src/test/resources&lt;/directory&gt; <br/>&lt;/fileSet&gt; <br/>&lt;/fileSets&gt; <br/>&lt;/archetype-descriptor&gt;</span></pre><p id="d995" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中，当<code class="fe mn mo mp mq b">filtered</code>属性设置为<code class="fe mn mo mp mq b">true</code>时，它将替换占位符(如<code class="fe mn mo mp mq b">$package</code>等)。)您已经在模板文件中设置了执行<code class="fe mn mo mp mq b">mvn archetype:generate</code>生成项目时的参数。当<code class="fe mn mo mp mq b">packaged</code>属性设置为<code class="fe mn mo mp mq b">true</code>时，会将生成的文件移动到相应的包中。</p><p id="c3c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了测试原型资源，在<em class="mz">src/test/resources/projects/it-basic</em>中准备了一个<em class="mz">prototype . properties</em>和一个<em class="mz"> goal.txt </em>文件。在<em class="mz">集成-测试</em>阶段，它将使用原型资源生成一个测试项目，并使用<em class="mz">原型.属性</em>中定义的属性替换占位符，并针对生成的项目执行<code class="fe mn mo mp mq b">goal.txt</code>中的目标。</p><p id="25e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建了一个<a class="ae kl" href="https://github.com/hantsy/maven-archetype-jakartaee9/blob/master/.github/workflows/it-with-arq-glassfish-remote.yml" rel="noopener ugc nofollow" target="_blank"> Github Actions工作流</a>来验证生成的项目。</p><h1 id="bc19" class="lr kz iq bd la ls lt lu ld lv lw lx lg ly lz ma lj mb mc md lm me mf mg lp mh bi translated">发布到Maven中央存储库</h1><blockquote class="np nq nr"><p id="13dd" class="jn jo mz jp b jq jr js jt ju jv jw jx ns jz ka kb nt kd ke kf nu kh ki kj kk ij bi translated"><em class="iq">注意，将您的包发布到Maven中央存储库的步骤有点繁琐，请耐心等待。</em></p></blockquote><p id="91ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦你成功地构建了maven原型项目，下一步就是将它发布到Maven中央存储库并公开，在Google结果中有一些有用的指南。我建议你从下面的列表中选择一个或多个，并首先阅读它。</p><ul class=""><li id="9474" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nv ng nh ni bi translated"><a class="ae kl" href="http://tutorials.jenkov.com/maven/publish-to-central-maven-repository.html" rel="noopener ugc nofollow" target="_blank">将JAR发布到中央Maven仓库</a></li><li id="414e" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nv ng nh ni bi translated"><a class="ae kl" href="https://dzone.com/articles/publish-your-artifacts-to-maven-central" rel="noopener ugc nofollow" target="_blank">如何将您的工件发布到Maven Central </a></li><li id="0b1b" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nv ng nh ni bi translated"><a class="ae kl" href="https://rieckpil.de/create-your-own-maven-archetype-in-5-simple-steps/" rel="noopener ugc nofollow" target="_blank">通过5个简单的步骤创建你自己的Maven原型</a></li></ul><ol class=""><li id="e95a" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated">在<a class="ae kl" href="https://issues.sonatype.org" rel="noopener ugc nofollow" target="_blank"> Sonatype问题跟踪器</a>中注册一个账户。</li><li id="539e" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">在<a class="ae kl" href="https://issues.sonatype.org/projects/OSSRH" rel="noopener ugc nofollow" target="_blank">社区支持</a>上提交一个新问题，以提交您发布工件的请求。查看<a class="ae kl" href="https://issues.sonatype.org/browse/OSSRH-66424" rel="noopener ugc nofollow" target="_blank">我为<a class="ae kl" href="https://github.com/hantsy/maven-archetype-jakartaee9" rel="noopener ugc nofollow" target="_blank">hantsy/maven-archetype-jakartaee9</a>创建的问题#OSSRH-66424 </a>作为例子。</li><li id="dae3" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">根据问题的响应，在Github上创建一个新的空repo(名称是问题id ),用于身份验证需求。例如<a class="ae kl" href="https://github.com/hantsy/OSSRH-66424" rel="noopener ugc nofollow" target="_blank"> OSSRH-66424 </a></li><li id="ca46" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">生成GPG密钥并发送到密钥服务器。</li></ol><p id="792c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Windows 10系统下，你必须先安装GPG工具。如果您使用的是<a class="ae kl" href="https://chocolatey.org/" rel="noopener ugc nofollow" target="_blank"> Chocolatey </a>，只需运行以下命令来安装gpg4win。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="dd48" class="ky kz iq mq b gy mv mw l mx my">choco install gpg4win</span></pre><p id="d50c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">刷新环境。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="1734" class="ky kz iq mq b gy mv mw l mx my">refreshenv</span></pre><p id="4c79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后生成GPG键。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="d80c" class="ky kz iq mq b gy mv mw l mx my"># gpg — full-gen-key <br/>gpg (GnuPG) 2.2.27; Copyright © 2021 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. <br/>Please select what kind of key you want: <br/>(1) RSA and RSA (default) <br/>(2) DSA and Elgamal <br/>(3) DSA (sign only) <br/>(4) RSA (sign only) <br/>(14) Existing key from card Your selection? 1<br/> RSA keys may be between 1024 and 4096 bits long. <br/>What keysize do you want? (3072) <br/>Requested keysize is 3072 bits Please specify how long the key should be valid. 0 = key does not expire &lt;n&gt; = key expires in n days &lt;n&gt;w = key expires in n weeks &lt;n&gt;m = key expires in n months &lt;n&gt;y = key expires in n years Key is valid for? (0) Key does not expire at all Is this correct? (y/N) y <br/>GnuPG needs to construct a user ID to identify your key. <br/>Real name: Hantsy Bai <br/>Email address: hantsy@gmail.com <br/>Comment: <br/>You selected this USER-ID: “Hantsy Bai &lt;hantsy@gmail.com&gt;” </span><span id="7ed2" class="ky kz iq mq b gy no mw l mx my">Change (N)ame, ©omment, (E)mail or (O)kay/(Q)uit? O </span><span id="a0b6" class="ky kz iq mq b gy no mw l mx my">We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: AllowSetForegroundWindow(9152) failed: Access is denied. </span><span id="e2e2" class="ky kz iq mq b gy no mw l mx my">We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: C:/Users/hantsy/AppData/Roaming/gnupg/trustdb.gpg: trustdb created gpg: key E5D9B4272348ADAE marked as ultimately trusted gpg: directory ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d’ created gpg: revocation certificate stored as ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d\03B4C55DDA964D942C756D79E5D9B4272348ADAE.rev’ public and secret key created and signed. </span><span id="f752" class="ky kz iq mq b gy no mw l mx my">pub rsa3072 2021–03–30 [SC] 03B4C55DDA964D942C756D79E5D9B4272348ADAE uid Hantsy Bai &lt;hantsy@gmail.com&gt; <br/>sub rsa3072 2021–03–30 [E]</span></pre><p id="3239" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将密钥发送到公钥服务器。</p><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="45be" class="ky kz iq mq b gy mv mw l mx my"># gpg — send-keys 03B4C55DDA964D942C756D79E5D9B4272348ADAE gpg: sending key E5D9B4272348ADAE to hkps://hkps.pool.sks-keyservers.net</span></pre><p id="09a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.按照使用Apache Maven 将<a class="ae kl" href="https://central.sonatype.org/pages/apache-maven.html" rel="noopener ugc nofollow" target="_blank">部署到OSSRH的步骤来发布您的工件。</a></p><blockquote class="np nq nr"><p id="3003" class="jn jo mz jp b jq jr js jt ju jv jw jx ns jz ka kb nt kd ke kf nu kh ki kj kk ij bi translated"><em class="iq">这里我跳过详细步骤，请仔细阅读Synatype的</em> <a class="ae kl" href="https://central.sonatype.org/pages/apache-maven.html" rel="noopener ugc nofollow" target="_blank"> <em class="iq">文章</em> </a> <em class="iq">。</em></p></blockquote><p id="4147" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.然后回到<a class="ae kl" href="https://issues.sonatype.org/browse/OSSRH-66424" rel="noopener ugc nofollow" target="_blank">问题#OSSRH-66424 </a>，评论并通知版主将您的工件发布到Maven中央存储库。一两个小时后，您的工件将出现在<a class="ae kl" href="https://search.maven.org/search?q=io.github.hantsy" rel="noopener ugc nofollow" target="_blank"> Maven Central Repository搜索索引页面</a>上。</p><h1 id="1078" class="lr kz iq bd la ls lt lu ld lv lw lx lg ly lz ma lj mb mc md lm me mf mg lp mh bi translated">发布到Github包</h1><p id="e896" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated"><a class="ae kl" href="https://docs.github.com/en/packages/guides/configuring-apache-maven-for-use-with-github-packages" rel="noopener ugc nofollow" target="_blank">配置Apache Maven用于Github包</a>页面提供了<a class="ae kl" href="https://docs.github.com/en/packages/guides/configuring-apache-maven-for-use-with-github-packages#publishing-a-package" rel="noopener ugc nofollow" target="_blank">将包</a>发布到GitHub包的详细步骤。</p><ol class=""><li id="8a6a" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated">按照<a class="ae kl" href="https://docs.github.com/en/packages/guides/configuring-apache-maven-for-use-with-github-packages#authenticating-to-github-packages" rel="noopener ugc nofollow" target="_blank">认证Github包</a>的步骤，在您的<em class="mz"> ~/.m2/settings.xml </em>文件中设置Github认证信息。</li><li id="22ed" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">部署到Github包。</li></ol><ul class=""><li id="4834" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nv ng nh ni bi translated">在我们的例子中，我们已经设置了<code class="fe mn mo mp mq b">distributionManagement</code>来使用Maven中央存储库。请改用以下命令。</li></ul><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="94cb" class="ky kz iq mq b gy mv mw l mx my">mvn clean package deploy -DskipTests -DaltDeploymentRepository=github::https://maven.pkg.github.com/hantsy/maven-archetype-jakartaee9</span></pre><ul class=""><li id="c23f" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nv ng nh ni bi translated">默认情况下，Github包不允许任何人未经认证就访问您的存储库。在<a class="ae kl" href="https://github.community/t/how-to-make-github-packages-to-the-public/171321" rel="noopener ugc nofollow" target="_blank">咨询了Github社区</a>之后，有一个解决方案可以很好地解决这个问题，让公众可以访问你的库。</li><li id="a94a" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nv ng nh ni bi translated">生成一个范围为<code class="fe mn mo mp mq b">packages:read</code>的个人访问令牌。</li><li id="4c18" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nv ng nh ni bi translated">运行以下命令来生成存储库配置。</li></ul><pre class="kn ko kp kq gt mr mq ms mt aw mu bi"><span id="aa85" class="ky kz iq mq b gy mv mw l mx my"># docker run ghcr.io/jcansdale/gpr encode &lt;your PAT&gt;</span><span id="49dd" class="ky kz iq mq b gy no mw l mx my">A NuGet `nuget.config` file: <br/>&lt;packageSourceCredentials&gt; <br/>&lt;github&gt; <br/>&lt;add key=”Username” value=”PublicToken” /&gt; <br/>&lt;add key=”ClearTextPassword” value=”&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618" /&gt; <br/>&lt;/github&gt; <br/>&lt;/packageSourceCredentials&gt; </span><span id="4c51" class="ky kz iq mq b gy no mw l mx my">A Maven `pom.xml` file:<br/> &lt;repositories&gt; <br/>&lt;repository&gt; <br/>&lt;id&gt;github-public&lt;/id&gt; &lt;url&gt;https://public:&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618@maven.pkg.github.com/&lt;OWNER&gt;/*&lt;/url&gt; <br/>&lt;/repository&gt; <br/>&lt;/repositories&gt; </span><span id="f474" class="ky kz iq mq b gy no mw l mx my">An npm `.npmrc` file: <br/>@OWNER:registry=https://npm.pkg.github.com //npm.pkg.github.com/:_authToken=”\u003028d0c8f723084e499eb87a6fe173b3af295d618"</span></pre><ul class=""><li id="1272" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nv ng nh ni bi translated">如您所见，现在您可以将上述存储库添加到您的Maven代理服务器或系统中的全局Maven设置(<em class="mz"> ~/.m2/settings.xml </em>)中。</li></ul><p id="be38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查来自我的Github 的<a class="ae kl" href="https://github.com/hantsy/maven-archetype-jakartaee9" rel="noopener ugc nofollow" target="_blank">源代码。</a></p></div></div>    
</body>
</html>
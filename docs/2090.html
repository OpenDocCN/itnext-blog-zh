<html>
<head>
<title>React Context and State Management</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应上下文和状态管理</h1>
<blockquote>原文：<a href="https://itnext.io/react-context-and-state-management-16ed76686803?source=collection_archive---------4-----------------------#2019-03-28">https://itnext.io/react-context-and-state-management-16ed76686803?source=collection_archive---------4-----------------------#2019-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="1f0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">状态管理快速介绍</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/1fd7ffa22f6eb35b50a8c3056e7d605c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CSk3IOFFL35bsPxi"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@finalhugh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">金赛</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d62d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您已经掌握了React的基础知识，并希望提升您的游戏来创建更具凝聚力的应用程序。学习React Context应该是你的下一个目标，因为它是对状态管理的一个很好的介绍。我们大多数人都熟悉通过树将道具传递给子组件，但是当这变得难以管理和阅读时会发生什么呢？React Context允许我们在组件之间共享和更新数据，而不需要通过每个子组件发送props。上下文的一些很好的用例是存储登录用户的信息和维护语言或颜色主题等偏好。</p><h1 id="7ef5" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">上下文. js</h1><h2 id="84a8" class="md lg it bd lh me mf dn ll mg mh dp lp kb mi mj lt kf mk ml lx kj mm mn mb mo bi translated">我们开始吧</h2><p id="dc52" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">React内置了上下文，因此您可以立即开始编码！</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="7e15" class="md lg it mv b gy mz na l nb nc">import React, { Context } from 'react';</span></pre><p id="15a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">React上下文返回一个具有两个属性的对象，一个提供者和一个使用者。首先创建一个新的上下文并将其导出，以便我们以后使用。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="e412" class="md lg it mv b gy mz na l nb nc">export const MyContext = React.createContext();</span></pre><h2 id="2310" class="md lg it bd lh me mf dn ll mg mh dp lp kb mi mj lt kf mk ml lx kj mm mn mb mo bi translated">供应者</h2><p id="130f" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">在Context.js中，我们还可以创建一个新的类组件来管理我们的状态。在返回函数中，我们创建了一个接受值属性的提供者。我们现在可以创建一个对象来保存我们想要访问的状态和其他函数。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="dddb" class="md lg it mv b gy mz na l nb nc">export class MyProvider extends Component {<br/>  state = {<br/>    isAuthenticated: false<br/>  };</span><span id="5552" class="md lg it mv b gy nd na l nb nc">authenticate = () =&gt; {<br/>    this.setState({<br/>      isAuthenticated: true<br/>    });<br/>  };</span><span id="6d99" class="md lg it mv b gy nd na l nb nc">render() {<br/>    return (<br/>      &lt;MyContext.Provider<br/>        value={{<br/>          state: this.state,<br/>          authenticate: this.authenticate<br/>        }}<br/>      &gt;<br/>        {this.props.children}<br/>      &lt;/MyContext.Provider&gt;<br/>    );<br/>  }<br/>}</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="cd2f" class="md lg it bd lh me mf dn ll mg mh dp lp kb mi mj lt kf mk ml lx kj mm mn mb mo bi translated">消费者</h2><p id="9fb3" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">消费者是我们访问存储在上下文中的数据的方式。消费者标签中包含的任何代码都可以访问我们创建的上下文。创建一个新组件，并尝试导入上下文和创建一个消费者。我们需要多少消费者就有多少消费者，这样我们就可以避免通过道具传递数据。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="f176" class="md lg it mv b gy mz na l nb nc">import { MyContext } from "./Context";</span><span id="c821" class="md lg it mv b gy nd na l nb nc">const page = () {<br/>  return(<br/>    &lt;MyContext.Consumer&gt;<br/>      {({ state, authenticate }) =&gt; (<br/>        // component code goes here<br/>        // you now have access to state and values from the provider<br/>        &lt;button onClick={authenticate} /&gt;<br/>      )}<br/>    &lt;/MyContext.Consumer&gt;<br/>  )<br/>}</span></pre><h2 id="e3e6" class="md lg it bd lh me mf dn ll mg mh dp lp kb mi mj lt kf mk ml lx kj mm mn mb mo bi translated">更新上下文</h2><p id="3c25" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">如果您查看上面的代码示例，您可以看到如何更新上下文。单击按钮时，我们调用消费者返回的身份验证方法。在提供程序中，我们创建了一个authenticate方法，该方法将值isAuthenticated更新为true。现在，应用程序的其余部分可以访问更新后的值。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="bcda" class="md lg it mv b gy mz na l nb nc">authenticate = () =&gt; {<br/>    this.setState({<br/>      isAuthenticated: true<br/>    });<br/>  };</span></pre><h2 id="d57a" class="md lg it bd lh me mf dn ll mg mh dp lp kb mi mj lt kf mk ml lx kj mm mn mb mo bi translated">为你的应用提供背景</h2><p id="c79a" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">为了给你的整个应用程序提供上下文，用上下文组件包装你的<App/>。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="fa8e" class="md lg it mv b gy mz na l nb nc">import { MyContext, MyProvider } from "./Context";</span><span id="aa9e" class="md lg it mv b gy nd na l nb nc">ReactDOM.render(<br/>  &lt;MyProvider&gt;<br/>    &lt;MyContext.Consumer&gt;{state =&gt; &lt;App data={state} /&gt;&lt;/MyContext.Consumer&gt;<br/>&lt;/MyProvider&gt;,<br/>rootElement<br/>);</span></pre><p id="3c7d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您不必像这样实现提供者。如果您只需要在一个组件中访问provider中的数据，那么您可以包装该组件。因为我们希望在整个应用程序中访问用户信息，所以用提供者组件包装整个应用程序是有意义的。</p><h2 id="46f5" class="md lg it bd lh me mf dn ll mg mh dp lp kb mi mj lt kf mk ml lx kj mm mn mb mo bi translated">结论</h2><p id="a86c" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">React Context很好地介绍了如何管理状态。在尝试像Redux这样更复杂的解决方案之前，熟悉这些基本概念是很好的。</p><p id="d7aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我已经展示了一个全局状态的例子，但是我建议创建一个更具体的上下文，比如UserContext或AdminContext。开始编码，找到适合你的！</p></div></div>    
</body>
</html>
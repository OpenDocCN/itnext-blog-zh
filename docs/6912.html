<html>
<head>
<title>Flutter Fastlane Deployment to the Firebase App Distribution (Easy Way)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤振浪子部署到Firebase应用程序发行版(简单的方式)</h1>
<blockquote>原文：<a href="https://itnext.io/flutter-fastlane-deployment-to-the-firebase-app-distribution-easy-way-d5ca2fbdcdf9?source=collection_archive---------1-----------------------#2022-04-11">https://itnext.io/flutter-fastlane-deployment-to-the-firebase-app-distribution-easy-way-d5ca2fbdcdf9?source=collection_archive---------1-----------------------#2022-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8f86168f67322e0b8177fdc871b9bda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3JR3iVBRsUvZ4sFPcryug.png"/></div></div></figure><blockquote class="jy jz ka"><p id="0c8a" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因为时间是最重要的，我们都喜欢自动化过程</p></blockquote><p id="d9d1" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">对于Flutter应用程序，有许多ci/cd的方法，但fastlane是免费的，简单的，并为您提供了您需要的每一种可能性，您也可以将spare Mac集成为gitlab runner，并运行dev发行版或单击存储版本。</p><p id="d1ba" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">使用fastlane有些自动和容易是可能的，所以我决定将这篇文章分成三章:</p><p id="3f59" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">第一章</strong>:(这一章)将是部署Firebase应用程序发行版的最简单方式</p><p id="1b45" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">第二章</strong>:将最简单的方式部署到商店</p><p id="e856" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">第三章:</strong>将两者结合在一个多通道的快速文件中，并提供最佳实践</p><p id="e898" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">在上一篇文章<a class="ae ld" href="https://blog.devgenius.io/flutter-new-app-setup-with-flavors-in-one-go-331471b127e3" rel="noopener ugc nofollow" target="_blank">中，我写了如何设置一个新的Flutter应用程序，所以我们将在此基础上创建fastlane部署。</a></p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="d8eb" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">安装fastlane</h1><p id="52cc" class="pw-post-body-paragraph kb kc iq ke b kf mj kh ki kj mk kl km la ml kp kq lb mm kt ku lc mn kx ky kz ij bi translated">我们需要安装浪子本身(我在Mac上，所以我用brew安装Fastlane)，但你可以在<a class="ae ld" href="https://docs.fastlane.tools/getting-started/android/setup/" rel="noopener ugc nofollow" target="_blank"> fastlane文档</a>中找到基于操作系统安装的详细信息。同样按照建议，我使用了版本管理器并安装了ruby版本3.0.2。因为我们已经为我们的flutter应用程序使用了fvm，所以这是它的先决条件。</p><h1 id="de4b" class="ll lm iq bd ln lo mo lq lr ls mp lu lv lw mq ly lz ma mr mc md me ms mg mh mi bi translated">Android部署</h1><p id="9457" class="pw-post-body-paragraph kb kc iq ke b kf mj kh ki kj mk kl km la ml kp kq lb mm kt ku lc mn kx ky kz ij bi translated">转到[project]/android目录并运行fastlane init，您应该会得到如下结果:</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/ad0008536507da5a8d30a9039fe35dea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mRkOLjAxquVVQqx8"/></div></div></figure><p id="7775" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">现在，我们将在当前目录中运行下一个命令，将firebase分发包添加到我们的快速通道中，该命令将安装其他依赖项:</p><p id="5eb0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><em class="kd">fast lane add _ plugin firebase _ app _ distribution</em></p><p id="046b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">然后，我们需要授予对我们的<a class="ae ld" href="https://firebase.google.com/docs/app-distribution/ios/distribute-fastlane#service-acc-fastlane" rel="noopener ugc nofollow" target="_blank"> firebase帐户</a>的访问权限，您可以自己选择，但我选择了firebase服务帐户凭证方法</p><p id="78ea" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">在<a class="ae ld" href="https://console.cloud.google.com/projectselector2/iam-admin/serviceaccounts" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a> e中为您选择的应用程序创建新的服务帐户</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/74ed2220cc5359a84570acd6149afd80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUjckYyRYStsFeSLFbEcPw.png"/></div></div></figure><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/16f49e8dd1a346bc9eeeb43f38283937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8914HGCrmtUqS075yHeeA.png"/></div></div></figure><p id="fb0d" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">然后在这个新的服务帐户下创建一个键，并下载json文件</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/8e5515acc37151176a7605175c951d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eQvVMwj5BUbPtGgr"/></div></div></figure><p id="f638" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">我将该文件命名为google-creds.json，并将其放入<em class="kd"> android/fastlane </em>文件夹中，然后添加到gitignore！</p><p id="25c5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">因为我们有dev和prod风格(现在我们将两者都部署到应用程序发行版，稍后prod将只进行内部测试或试飞)我们需要添加。env文件，所以在fastlane根文件夹中添加. env.development和. env.production:</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><blockquote class="jy jz ka"><p id="6c93" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">重要提示:在为每个应用程序进行部署之前，您需要在Firebase控制台中进入应用程序分发，然后单击开始(对于android和ios，对于开发和生产)</p></blockquote><p id="6768" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">您可以创建相同的. env.development文件，然后将您的Fastfile更新为:</p><ul class=""><li id="f5a7" class="nc nd iq ke b kf kg kj kk la ne lb nf lc ng kz nh ni nj nk bi translated">它将建立APK与选定的颤振版本</li><li id="3ef0" class="nc nd iq ke b kf nl kj nm la nn lb no lc np kz nh ni nj nk bi translated">将它部署到应用程序分发，并为选定的测试人员提供注释</li></ul><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="ebac" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">然后在fastlane目录中运行magic link，瞧，等待android应用程序版本的电子邮件邀请。</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><h1 id="6571" class="ll lm iq bd ln lo mo lq lr ls mp lu lv lw mq ly lz ma mr mc md me ms mg mh mi bi translated">iOS部署</h1><p id="da72" class="pw-post-body-paragraph kb kc iq ke b kf mj kh ki kj mk kl km la ml kp kq lb mm kt ku lc mn kx ky kz ij bi translated">转到<em class="kd"> [project]/ios </em>目录并运行fastlane init，您应该会得到如下结果:</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/3c66d6bd1d8992112aa369c0dcd15797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uUW3CsbRA3k6IrmX"/></div></div></figure><p id="d70e" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">现在，我们将在当前目录中运行下一个命令，将firebase分发包添加到我们的快速通道中，该命令将安装其他依赖项:</p><p id="a7a3" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><em class="kd">fast lane add _ plugin firebase _ app _ distribution</em></p><p id="56b2" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">再一次像在步骤中那样为android添加. env.development和. env.production文件，并添加一些额外的参数。在<em class="kd"> ios/fastlane </em>文件夹中复制谷歌凭证，然后忽略它。</p><p id="fafd" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">我也知道这里有重复的东西，但这样做的唯一目的是更好地理解这里发生的一切。正如我说过的，我们将在上一篇文章中清理这个问题。</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1a02" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">然后以这种方式更新您的Appfile和Fastfile:</p><ul class=""><li id="a1c1" class="nc nd iq ke b kf kg kj kk la ne lb nf lc ng kz nh ni nj nk bi translated">应用文件</li></ul><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><ul class=""><li id="4edd" class="nc nd iq ke b kf kg kj kk la ne lb nf lc ng kz nh ni nj nk bi translated">快速文件(在这里我们设置了最小的ruby版本，清理了所有的构建版本，构建并归档了ipa，并将其发送到应用程序发行版)</li></ul><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e136" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">然后在fastlane目录中运行magic link，瞧，等待ios应用程序版本的电子邮件邀请。</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="2689" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第一章结束</h1><p id="a072" class="pw-post-body-paragraph kb kc iq ke b kf mj kh ki kj mk kl km la ml kp kq lb mm kt ku lc mn kx ky kz ij bi translated">这是通过fastlane自动部署到Firebase应用程序分发的第一个简单设置。您可以使用gitlab runner来处理这个问题，但是在添加商店部署之后的下一篇文章中，我们将创建一个更好的优化流程。在此之前，当你有更新时，只需在pubspec.yaml中提升应用版本，并将此脚本添加到项目根目录中，以便在一个步骤中将其交付给每个人。相信我，这非常值得！</p><p id="59d0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">同样，在上一篇文章中，我写得有点匆忙，所以对于每个问题或误解，请评论或直接联系我。希望会有帮助！</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure></div></div>    
</body>
</html>
<html>
<head>
<title>End to End API Testing via Postman &amp; Newman</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Postman &amp; Newman进行端到端API测试</h1>
<blockquote>原文：<a href="https://itnext.io/end-to-end-api-testing-via-postman-newman-68c99f136d5e?source=collection_archive---------4-----------------------#2018-02-26">https://itnext.io/end-to-end-api-testing-via-postman-newman-68c99f136d5e?source=collection_archive---------4-----------------------#2018-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2678" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Postman是我开发API时的首选工具。它使得测试请求变得容易，最近我发现链接请求来创建端到端测试也非常简单。本演练将向您展示如何通过<a class="ae kl" href="https://www.getpostman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>创建测试，如何在Node和命令行中使用<a class="ae kl" href="https://www.npmjs.com/package/newman" rel="noopener ugc nofollow" target="_blank"> Newman </a>运行API测试，以及如何设置Newman到您的collection &amp;环境的URL，而不是通过JSON手动导入它们。</p><h1 id="a1cf" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">创建邮递员集合和测试</h1><ol class=""><li id="caf8" class="lk ll iq jp b jq lm ju ln jy lo kc lp kg lq kk lr ls lt lu bi translated">安装<a class="ae kl" href="https://www.getpostman.com/" rel="noopener ugc nofollow" target="_blank">邮递员</a></li><li id="c22a" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">设置环境变量</li></ol><ul class=""><li id="ad54" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated">使用左上角的<code class="fe me mf mg mh b">Manage Environments</code>部分</li></ul><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mi"><img src="../Images/519859f8a25772d936ee7fb27e76faac.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/0*RsOM5y6fXOJNf0U6.png"/></div></div></figure><ul class=""><li id="7f9d" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated">使用<code class="fe me mf mg mh b">Tests</code>选项卡和<code class="fe me mf mg mh b">Snippets</code>部分在每个端点上创建测试</li></ul><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f1f6bd43a5fcb9c8fcdff6924d77fa8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/0*iQNQSqRqU3V8vACl.png"/></div></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/f9ba05d0039ff6eda5c148b9de28f45a.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/0*e2bYBEH6nMZguADY.png"/></div></figure><p id="f84c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">示例:</p><pre class="mj mk ml mm gt mw mh mx my aw mz bi"><span id="f607" class="na kn iq mh b gy nb nc l nd ne">pm.test("response is ok", () =&gt; { <br/>  pm.response.to.have.status(200) <br/>})</span></pre><h1 id="a633" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">连锁请求</h1><p id="5720" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy nf ka kb kc ng ke kf kg nh ki kj kk ij bi translated">请求完成后，在<code class="fe me mf mg mh b">Tests</code>选项卡中设置环境/全局变量以链接请求。</p><p id="da22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe me mf mg mh b">pm.response.json()</code>让您访问响应体。示例:</p><pre class="mj mk ml mm gt mw mh mx my aw mz bi"><span id="4603" class="na kn iq mh b gy nb nc l nd ne">var jsonData = pm.response.json(); <br/>var token = jsonData.TOKEN_GUID;<br/>pm.environment.set("inovio_token", token);</span></pre><p id="0a33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在可以在未来的请求中使用<code class="fe me mf mg mh b">inovio_token</code> env变量:</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/57367221d188de0a7bcafa2b600896ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/0*CXXjnKG1iApqM_gt.png"/></div></figure><h1 id="7561" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">在邮递员跑步者中运行测试</h1><ul class=""><li id="d235" class="lk ll iq jp b jq lm ju ln jy lo kc lp kg lq kk md ls lt lu bi translated">点击您的收藏名称-&gt;运行</li><li id="f7b0" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk md ls lt lu bi translated">从步骤1中选择您的env</li></ul><h1 id="64e8" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">在源代码/CI中运行测试</h1><ol class=""><li id="e404" class="lk ll iq jp b jq lm ju ln jy lo kc lp kg lq kk lr ls lt lu bi translated">获取<a class="ae kl" href="https://eazeteam.postman.co/integrations" rel="noopener ugc nofollow" target="_blank"> Postman API键</a>并将其设置为代码库中的env变量</li><li id="3111" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">获取收藏链接</li></ol><ul class=""><li id="f2de" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated">点击收藏名称-&gt;共享-&gt;收藏链接-&gt;获取链接</li></ul><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3216db90bb49570e2518119b6fb2b228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/0*VUQ3bfn0HmddEBd2.png"/></div></figure><ul class=""><li id="2bf0" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated">从<code class="fe me mf mg mh b">Manage Environments</code>点击<code class="fe me mf mg mh b">Share</code>为您的env从步骤1</li><li id="16ab" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk md ls lt lu bi translated">获取所有邮递员环境:</li></ul><p id="c3af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe me mf mg mh b">https://api.getpostman.com/environments?apikey=&lt;postman_key&gt;</code></p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/6e0feb6b06e882745967f3363c3666b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/0*hXU9vrelT7kIsd3S.png"/></div></figure><ul class=""><li id="1b96" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated">保存所需环境的UID</li><li id="207f" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk md ls lt lu bi translated">注意:每次你改变你的env变量或者集合端点时，你必须重新共享链接来更新它们</li></ul><ol class=""><li id="4146" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk lr ls lt lu bi translated">使用<a class="ae kl" href="https://www.npmjs.com/package/newman" rel="noopener ugc nofollow" target="_blank"> Newman </a>在您的代码库中运行测试。</li></ol><ul class=""><li id="04df" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated"><code class="fe me mf mg mh b">npm install --save-dev newman</code>。</li><li id="94ce" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk md ls lt lu bi translated"><code class="fe me mf mg mh b">newman.run()</code>使用上述步骤2 &amp; 3中的URL设置<code class="fe me mf mg mh b">collection</code>和<code class="fe me mf mg mh b">environment</code>选项:</li></ul><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><ul class=""><li id="586c" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated"><code class="fe me mf mg mh b">node test.js</code></li><li id="dae8" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk md ls lt lu bi translated">样本输出:</li></ul><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/7d3ce65dda6358f0b3e41cbe9283aae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/0*OECWv4jlx9Uyx0bQ.png"/></div></figure><ul class=""><li id="eb04" class="lk ll iq jp b jq jr ju jv jy ma kc mb kg mc kk md ls lt lu bi translated">Newman也可以通过命令行脚本运行，即:</li><li id="a959" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk md ls lt lu bi translated"><code class="fe me mf mg mh b">newman -c &lt;collection-url&gt; -e &lt;env-url&gt;</code></li></ul><p id="aac4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上任一选项(节点或命令行)都可用于配置项，具体取决于您选择的配置项服务/配置。大多数关于Newman的文档都关注于通过JSON导入集合和环境，但是我发现用上面的URL设置Newman环境和集合选项使得测试更加简单，并且消除了每次更新集合时重新导入JSON的必要性。</p></div></div>    
</body>
</html>
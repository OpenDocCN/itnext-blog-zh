<html>
<head>
<title>How To Create Your Own CLI — With Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Golang创建自己的CLI</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-your-own-cli-with-golang-3c50727ac608?source=collection_archive---------1-----------------------#2019-03-04">https://itnext.io/how-to-create-your-own-cli-with-golang-3c50727ac608?source=collection_archive---------1-----------------------#2019-03-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0771" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Golang制作命令行界面的介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e5ec8e8d835ce4e5c0560a12e7c75045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a6IE1sqbgR7SHiou"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">安娜斯塔西娅·耶尔马兹在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="a24c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将解释如何用Golang创建一个基本的命令行界面(CLI)。我们将制作一个小型的pizza CLI，在阅读完这篇文章后，你将会知道如何自己创建一个自定义CLI。</p><h2 id="8979" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">先决条件</h2><ul class=""><li id="2a5d" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu mv mw mx my bi translated">对于这个演示，我使用了:go版本1.11。</li></ul><h2 id="c9db" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">让我们开始创建代码</h2><p id="12c0" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">用名为<code class="fe nc nd ne nf b">main.go</code>的文件创建一个文件夹，并在命令行中运行:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="5e88" class="lv lw it nf b gy nk nl l nm nn">go get github.com/urfave/cli</span></pre><p id="99ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们在全球范围内安装了一个知名的<a class="ae ky" href="https://github.com/urfave/cli" rel="noopener ugc nofollow" target="_blank">包</a>来轻松地用Golang制作CLI。这会节省我们很多时间。</p><p id="e712" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的<code class="fe nc nd ne nf b">main.go</code>中，让我们从CLI包中实例化一个<code class="fe nc nd ne nf b">NewApp</code>，并通过调用<code class="fe nc nd ne nf b">Run</code>方法使其能够运行。如果出现问题，我们还希望记录一个错误:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="5209" class="lv lw it nf b gy nk nl l nm nn">var app = cli.NewApp()</span><span id="730d" class="lv lw it nf b gy no nl l nm nn">func main() {<br/>  err := app.Run(os.Args)<br/>  if err != nil {<br/>    log.Fatal(err)<br/>  }<br/>}</span></pre><p id="82c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这足以让您的CLI工作，但没有任何选项。我们还需要一些关于CLI的基本信息。在<code class="fe nc nd ne nf b">main</code>函数之上，制作另一个名为<code class="fe nc nd ne nf b">info</code>的函数，并添加一些细节:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="349b" class="lv lw it nf b gy nk nl l nm nn">func info() {<br/>  app.Name = "Simple pizza CLI"<br/>  app.Usage = "An example CLI for ordering pizza's"<br/>  app.Author = "Jeroenouw" <br/>  app.Version = "1.0.0"<br/>}</span></pre><p id="aaee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将定义一个包含基本句子的新字符串数组，我们将在使用一些自定义命令运行CLI后扩展该数组。请将下一个放在<code class="fe nc nd ne nf b">info</code>功能上方:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="8783" class="lv lw it nf b gy nk nl l nm nn">var pizza = []string{"Enjoy your pizza with some delicious"}</span></pre><p id="b7ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要完成Golang CLI，我们需要做的最后一件事是添加一些自定义命令，我们创建了一个名为<code class="fe nc nd ne nf b">commands</code>的新函数:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="7fcb" class="lv lw it nf b gy nk nl l nm nn">func commands() {<br/>  app.Commands = []cli.Command{<br/>    {<br/>      Name:    "peppers",<br/>      Aliases: []string{"p"},<br/>      Usage:   "Add peppers to your pizza",<br/>      Action: func(c *cli.Context) { <br/>        pe := "peppers"<br/>        peppers := append(pizza, pe)<br/>        m := strings.Join(peppers, " ")<br/>        fmt.Println(m)<br/>      },<br/>    },<br/>    {<br/>      Name:    "pineapple",<br/>      Aliases: []string{"pa"},<br/>      Usage:   "Add pineapple to your pizza",<br/>      Action: func(c *cli.Context) { <br/>        pa := "pineapple"<br/>        pineapple := append(pizza, pa)<br/>        m := strings.Join(pineapple, " ")<br/>        fmt.Println(m)<br/>      },<br/>    },<br/>    {<br/>      Name:    "cheese",<br/>      Aliases: []string{"c"},<br/>      Usage:   "Add cheese to your pizza",<br/>      Action: func(c *cli.Context) { <br/>        ch := "cheese"<br/>        cheese := append(pizza, ch)<br/>        m := strings.Join(cheese, " ")<br/>        fmt.Println(m)<br/>      },<br/>    },<br/>  }<br/>}</span></pre><p id="cf49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nc nd ne nf b">commands</code>函数中，我们从导入的CLI包中调用<code class="fe nc nd ne nf b">Commands</code>方法。然后，我们创建一个包含3个对象的命令数组；我们的自定义命令。</p><p id="055f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们定义了一个<code class="fe nc nd ne nf b">Name</code>、<code class="fe nc nd ne nf b">Aliases</code>、<code class="fe nc nd ne nf b">Usage</code>和一个<code class="fe nc nd ne nf b">Action</code>。在这个包中有更多的选项可以探索，我们正在使用的只是最常见的。</p><ul class=""><li id="2b00" class="mo mp it lb b lc ld lf lg li np lm nq lq nr lu mv mw mx my bi translated">作为<code class="fe nc nd ne nf b">Name</code>你将设置命令名，在这种情况下，为你的比萨饼浇头。</li><li id="ea96" class="mo mp it lb b lc ns lf nt li nu lm nv lq nw lu mv mw mx my bi translated">我们创建了一个字符串数组，它可以包含我们命令的一个或多个别名。</li><li id="71b9" class="mo mp it lb b lc ns lf nt li nu lm nv lq nw lu mv mw mx my bi translated">对于<code class="fe nc nd ne nf b">Usage</code>,我们简要描述了该命令的作用，因此我们可以在<code class="fe nc nd ne nf b">help</code>概述中看到。</li><li id="6add" class="mo mp it lb b lc ns lf nt li nu lm nv lq nw lu mv mw mx my bi translated">在<code class="fe nc nd ne nf b">Action</code>中，我们提供了将要执行的代码。在本例中，我们将浇头添加到比萨饼字符串数组中。然后把它变成一个字符串。</li></ul><h2 id="ea3c" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">本地使用</h2><p id="501d" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">要构建我们的CLI，请运行:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="3333" class="lv lw it nf b gy nk nl l nm nn">go build main.go</span></pre><p id="1551" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此后，您可以运行以下两个现有命令:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="f215" class="lv lw it nf b gy nk nl l nm nn">./main --help<br/>./main --version</span></pre><p id="4870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过运行<code class="fe nc nd ne nf b">./main — help</code>我们的输出现在看起来像这样:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="6776" class="lv lw it nf b gy nk nl l nm nn">NAME:<br/>   Simple pizza CLI - An example CLI for ordering pizza's</span><span id="840c" class="lv lw it nf b gy no nl l nm nn">USAGE:<br/>   main [global options] command [command options] [arguments...]</span><span id="83ad" class="lv lw it nf b gy no nl l nm nn">VERSION:<br/>   1.0.0</span><span id="eb20" class="lv lw it nf b gy no nl l nm nn">AUTHOR:<br/>   Jeroenouw</span><span id="db30" class="lv lw it nf b gy no nl l nm nn">COMMANDS:<br/>     peppers, p     Add peppers to your pizza<br/>     pineapple, pa  Add pineapple to your pizza<br/>     cheese, c      Add cheese to your pizza<br/>     help, h        Shows a list of commands or help for one command</span><span id="9b3e" class="lv lw it nf b gy no nl l nm nn">GLOBAL OPTIONS:<br/>   --help, -h     show help<br/>   --version, -v  print the version</span></pre><p id="7374" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的自定义选项可以用全名来调用:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="1c7f" class="lv lw it nf b gy nk nl l nm nn">./main peppers<br/>./main cheese<br/>./main pineapple</span></pre><p id="2de6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者使用缩写别名:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="9948" class="lv lw it nf b gy nk nl l nm nn">./main p<br/>./main c<br/>./main pa</span></pre><p id="dc2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nc nd ne nf b">./main pa</code>的输出将是这样的:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="124a" class="lv lw it nf b gy nk nl l nm nn">Enjoy your pizza with some delicious pineapple</span></pre><p id="d62e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这只是一个非常基本的命令行界面，你可以做更多的事情。但是现在你知道基本的了。</p><h2 id="68b8" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">全球使用</h2><ol class=""><li id="5e9e" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu nx mw mx my bi translated">运行<code class="fe nc nd ne nf b">go build main.go</code>后，可执行文件“main”被创建</li></ol><p id="77bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.跑<code class="fe nc nd ne nf b">cp main /usr/<strong class="lb iu">local</strong>/bin</code></p><p id="8a00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.要测试:<code class="fe nc nd ne nf b">main peppers</code></p><p id="6848" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可以在全球范围内运行(归功于<a class="ny nz ep" href="https://medium.com/u/dc4c5ebeb5ea?source=post_page-----3c50727ac608--------------------------------" rel="noopener" target="_blank"> Melody Anoni </a></p><h2 id="7e5a" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">最终代码(main.go)</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/910ad2d3a6e968c00c6025082d10f5f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UGrTOOrIuFwvnWGW8PX3tA.png"/></div></div></figure></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h2 id="2afb" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">感谢您的阅读！我的<a class="ae ky" href="https://github.com/jeroenouw/" rel="noopener ugc nofollow" target="_blank"> Github </a>。如果你觉得这篇文章有用，可以考虑看看我的其他文章:</h2><div class="oi oj gp gr ok ol"><a href="https://levelup.gitconnected.com/10-advanced-aws-s3-questions-for-an-interview-with-answers-40316c8eb8ba" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">AWS S3面试的10个高级问题及答案</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">检查您的候选人是否能够回答这些关于AWS S3(简单存储服务)的问题</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ks ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://medium.com/@jeroenouw/how-to-create-your-own-typescript-cli-with-node-js-1faf7095ef89" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">如何使用Node.js创建自己的TypeScript CLI</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">根据这个指南，准备好学习制作一个简单的“披萨”CLI吧</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz ks ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://medium.com/coinmonks/solidity-smart-contract-anatomy-fb8bfb72e7ec" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">可靠智能合同剖析</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">今天，我将向你解释一个样本Solidity智能合同的剖析。本文将就此作一简要说明…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="pb l ow ox oy ou oz ks ol"/></div></div></a></div></div></div>    
</body>
</html>
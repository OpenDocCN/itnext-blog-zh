<html>
<head>
<title>The ins and outs of Angular-*ngIf</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular-*ngIf的来龙去脉</h1>
<blockquote>原文：<a href="https://itnext.io/the-in-and-outs-of-angular-ngif-2bc3ca7bc0fe?source=collection_archive---------6-----------------------#2021-02-13">https://itnext.io/the-in-and-outs-of-angular-ngif-2bc3ca7bc0fe?source=collection_archive---------6-----------------------#2021-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d4cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我在“Angular的来龙去脉”系列中的第一篇文章。今天我们将讨论结构指令*ngIf</p><p id="0fde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管我们都知道如何使用*ngIf/[ngIf]让我们花点时间来回顾一下Angular对它的定义，<br/> " <em class="kl">一个结构化的指令，它有条件地包含一个基于强制为布尔值的表达式的值的模板。</em> " <br/>所以从根本上来说，ngIf是一个简单的指令，它将<strong class="jp ir">通过条件值在运行时呈现</strong>。那么这在实际运行时是如何工作的呢？</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/c1c891e5e0bbe2bd64b2b3cfd716b9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bcHo2AW_dey4pfobnxh4WQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ngIf的基本实现</figcaption></figure><p id="deff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ngIf实际上是一个setter ( <a class="ae lj" href="https://www.typescripttutorial.net/typescript-tutorial/typescript-getters-setters/" rel="noopener ugc nofollow" target="_blank"> link </a>)。一旦一个新的值被发送到setter中，它将开始检查是否需要呈现html元素，通过使用setter而不是ngOnChanges angular可以获得更精确和更不容易出错的代码。仅在ngIf条件的值改变时运行功能。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lk"><img src="../Images/ee9f25eae8d6ffb746ed65f2f5e911f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1quYaUi-5oEdhn1t2_t96A.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">一旦一个新值被发送到ngIf，它将运行_updateView函数</figcaption></figure><p id="7d53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在ngIf指令中，最重要的函数是_updateView() <br/>每个@Input()都会发出这个函数。那么ngIf如何决定呈现html呢？</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ll"><img src="../Images/f237612de75c7b57fb6ffae16eb437eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0Ju3osvQt9hz0GKnBSoAQ.png"/></div></div></figure><p id="0a4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果条件是真值(！！value ),它将首先清除视图中的任何现有代码，如果有要呈现的模板，它将呈现它，请参见下面的图表，以获得上面代码的更直观的解释</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/34f3d87b9cb10ffe2cbd999b37ded8ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*ea_Q5Htddm4Mwr8VIz4gzw.png"/></div></figure><p id="234b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当ngIf决定呈现我们的html时，它使用<strong class="jp ir"> ViewContainerRef </strong>，它表示一个可以附加多个组件的容器，并且知道它在DOM树中的位置(这就是为什么它在正确的位置而不是随机地在页面上呈现它)。<br/>ViewContainerRef的createEmbeddedView函数将相关模板和ngIf的上下文作为参数，并将模板/代码呈现到页面中所需的空间和位置。并且如果需要的话，显然会贯穿其组件的生命周期。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="62f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">需要注意的事项:</p><p id="43b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.如果没有给ngIf一个特定的模板，它将使用它所在的代码块。</p><pre class="ku kv kw kx gt ln lo lp lq aw lr bi"><span id="0516" class="ls lt iq lo b gy lu lv l lw lx">&lt;div *ngIf="condition"&gt; hello world &lt;/div&gt;</span></pre><p id="7dda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ngIf将使用div元素作为模板(这是我们通常使用的方式)</p><p id="46f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.您可以显式地使用两个不同的模板，一个用于then，另一个用于else</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ly"><img src="../Images/1285fb405d966c058b86458829e98100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YY0A7CtgKjdtTUQxXENmOg.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">当对ngIf的<strong class="bd lz"> then </strong>值使用一个模板时，它将断言它是一个有效的模板，如果不是，它将抛出一个错误。</figcaption></figure><p id="f02c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.每当一个类组件作为ngIf条件的结果被呈现时，它将自己重置并运行组件生命周期，如onInit。所以要确保没有内存泄漏。</p></div></div>    
</body>
</html>
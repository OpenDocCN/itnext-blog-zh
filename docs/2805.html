<html>
<head>
<title>Hitchhiker’s guide to Reactive Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应式吊钩的搭便车指南</h1>
<blockquote>原文：<a href="https://itnext.io/hitchhikers-guide-to-reactive-hooks-92c1a708ccfe?source=collection_archive---------3-----------------------#2019-08-06">https://itnext.io/hitchhikers-guide-to-reactive-hooks-92c1a708ccfe?source=collection_archive---------3-----------------------#2019-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/50a86d00e70e67e7cff42d3ad0399fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f45xLyXRnl-KAyubicWLqQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">反应钩子库连接RxJS星系和反应宇宙。</figcaption></figure><p id="44c5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi la translated">电子商务应用程序前端(FE)开发完全是关于事件管理和DOM操作的。RxJS旨在处理具有竞争条件的复杂异步流。React有助于最小化昂贵的DOM操作。在<a class="ae lj" href="https://www.reonomy.com" rel="noopener ugc nofollow" target="_blank">经济学院</a>，我们开发了一个名为反应钩子的库来利用两者的力量。</p><div class="lk ll gp gr lm ln"><a href="https://www.reonomy.com/blog/post/reactive-hooks" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">反应之路:构建反应钩子库</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">为了使这种转变可行，雷诺米的软件工程师Dmitry Doronin创建了一个…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">www.reonomy.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jw ln"/></div></div></a></div><h2 id="9c03" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">什么是反应钩子库？</h2><p id="7497" class="pw-post-body-paragraph kc kd iq ke b kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv mz kx ky kz ij bi translated">这是一个使用<a class="ae lj" href="https://reactjs.org/docs/hooks-reference.html#usestate" rel="noopener ugc nofollow" target="_blank"> React钩子</a>渲染<a class="ae lj" href="https://rxjs-dev.firebaseapp.com/" rel="noopener ugc nofollow" target="_blank"> RxJS </a>可观察物体的库。</p><div class="lk ll gp gr lm ln"><a href="https://www.npmjs.com/package/@reonomy/reactive-hooks" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">@经济/反应-挂钩</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">RxJS React钩子库</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">www.npmjs.com</p></div></div><div class="lw l"><div class="na l ly lz ma lw mb jw ln"/></div></div></a></div><h2 id="97f4" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">如何使用反应钩？</h2><p id="5edc" class="pw-post-body-paragraph kc kd iq ke b kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv mz kx ky kz ij bi translated">这个库提供了一组有用的钩子，可以直接导入到React组件中，例如:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="53e2" class="mc md iq ng b gy nk nl l nm nn">import React from "react";<br/><strong class="ng ir">import { useRxState } from "@reonomy/reactive-hooks";<br/></strong>import { BehaviorSubject } from "rxjs";</span><span id="b5f6" class="mc md iq ng b gy no nl l nm nn">const count$ = new BehaviorSubject(0);</span><span id="0e47" class="mc md iq ng b gy no nl l nm nn">function Example() {<br/><strong class="ng ir">    const [count, setCount] = useRxState(count$);<br/></strong>    return (<br/>        &lt;div&gt;<br/>            &lt;p&gt;You clicked {count} times&lt;/p&gt;<br/>            &lt;button onClick={() =&gt; setCount(count + 1)}&gt;<br/>                Click me<br/>            &lt;/button&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}</span></pre><h1 id="c1cb" class="np md iq bd me nq nr ns mh nt nu nv mk nw nx ny mn nz oa ob mq oc od oe mt of bi translated">API参考</h1><p id="6f95" class="pw-post-body-paragraph kc kd iq ke b kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv mz kx ky kz ij bi translated">这里列出了所有的挂钩，最常用的都标有星号。</p><ul class=""><li id="d2a2" class="og oh iq ke b kf kg kj kk kn oi kr oj kv ok kz ol om on oo bi translated"><em class="op"> useRx(内部)</em></li><li id="caa9" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><em class="op"> useRxDebug </em></li><li id="f5ca" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><strong class="ke ir"><em class="op">userxstate</em></strong>⭐⭐⭐️⭐️⭐️</li><li id="6e57" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><strong class="ke ir"><em class="op"/></strong><em class="op"/>⭐⭐️</li><li id="6b12" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><em class="op">用户状态动作</em></li><li id="aa36" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><strong class="ke ir"><em class="op">userxeffect</em></strong><em class="op"/>⭐️⭐️⭐️</li><li id="ee05" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><strong class="ke ir"><em class="op">userxajax</em></strong><em class="op"/>⭐️⭐️⭐️⭐️</li><li id="cc90" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><em class="op">用户去抖</em></li><li id="4120" class="og oh iq ke b kf oq kj or kn os kr ot kv ou kz ol om on oo bi translated"><strong class="ke ir"> <em class="op">使用安装效果</em> </strong> ⭐️</li></ul><h2 id="7e70" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useRx(内部)</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="6458" class="mc md iq ng b gy nk nl l nm nn">useRx&lt;T&gt;(observable$: Observable&lt;T&gt;, observer: NextObserver&lt;T&gt;):void</span></pre><p id="9617" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当组件被安装时订阅给定的可观察对象，当组件被卸载时取消订阅，并跟踪所有活动的订阅。当URL哈希以<strong class="ke ir">调试</strong>(调试模式)结束时，活动订阅数将被打印到web控制台，例如https://foo.bar# <strong class="ke ir">调试</strong>。这对于性能调优可能很有用。</p><p id="4f59" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个钩子是内部的，所以你可能不想用它。但是知道这一点还是有好处的，因为useRx是所有其他钩子的基础。</p><h2 id="8292" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated"><strong class="ak"> useRxDebug </strong></h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="a89f" class="mc md iq ng b gy nk nl l nm nn">useRxDebug&lt;T&gt;(observable$: Observable&lt;T&gt;, tag: string): void</span></pre><p id="3beb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">订阅给定的可观察值，并将所有更改记录到控制台(调试模式)。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="1e81" class="mc md iq ng b gy nk nl l nm nn">import React from "react";<br/>import { useRxDebug } from "@reonomy/reactive-hooks";<br/>import { interval } from "rxjs";</span><span id="c1cf" class="mc md iq ng b gy no nl l nm nn">const interval$ = interval(1000);</span><span id="1279" class="mc md iq ng b gy no nl l nm nn">function Example() {<br/><strong class="ng ir">    useRxDebug(interval$, "interval$");</strong></span><span id="7c14" class="mc md iq ng b gy no nl l nm nn">    return (<br/>        &lt;div&gt;<br/>            URL should end with #debug<br/>        &lt;/div&gt;<br/>    );<br/>}</span></pre><h2 id="bbe2" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">用户状态</h2><p id="d5af" class="pw-post-body-paragraph kc kd iq ke b kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv mz kx ky kz ij bi translated">让我们从一个例子开始:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="077a" class="mc md iq ng b gy nk nl l nm nn">const [foo, setFoo] = useRxState(foo$);</span></pre><p id="affa" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这种挂钩的简化版本可以描述如下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="fe78" class="mc md iq ng b gy nk nl l nm nn">useRxState&lt;S extends Observable&lt;T&gt;&gt;(subject$: Observable&lt;T&gt;): Out&lt;T&gt;</span></pre><p id="242c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">订阅S类型的给定可观察对象，并基于该类型返回T类型的当前值的元组和设置该值的回调。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="1131" class="mc md iq ng b gy nk nl l nm nn"><em class="op">+--------------------+-------------------------------------+<br/>| Input Type S       | Output Type                         |<br/></em>+--------------------+-------------------------------------+<br/>| BehaviorSubject&lt;T&gt; | [T,             (value: T) =&gt; void] |<br/>| Subject&lt;T&gt;         | [T | undefined, (value: T) =&gt; void] |<br/>| Observable&lt;T&gt;      | [T | undefined ]                    |<br/>+--------------------+-------------------------------------+</span></pre><p id="8935" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它是用Typescript条件类型实现的:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e2ad" class="mc md iq ng b gy nk nl l nm nn">useRxState&lt;<br/>  S extends Observable&lt;any&gt; | <br/>  Subject&lt;any&gt; | <br/>  BehaviorSubject&lt;any&gt;<br/>&gt;(subject$: S): <br/>  S extends BehaviorSubject&lt;infer T&gt; ? [T, (value: T) =&gt; void]: <br/>  S extends Subject&lt;infer T&gt; ? [T | undefined, (value: T) =&gt; void]:  <br/>  S extends Observable&lt;infer T&gt; ? [T | undefined]: <br/>  never</span></pre><p id="0d04" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出类型被动态定义。其背后的算法可以表示如下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="d9d1" class="mc md iq ng b gy nk nl l nm nn">if (S is BehaviorSubject&lt;T&gt;)<br/>    return [T, (value: T) =&gt; void]</span><span id="2187" class="mc md iq ng b gy no nl l nm nn">if (S is Subject&lt;T&gt;)<br/>   return [T | undefined, (value: T) =&gt; void]</span><span id="0fdc" class="mc md iq ng b gy no nl l nm nn">if (S is Observable&lt;T&gt;) {<br/>   return [T | undefined]<br/>}</span></pre><p id="5aa1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是一个用useRxState实现的双向数据绑定的示例:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0c7f" class="mc md iq ng b gy nk nl l nm nn">import React from "react";<br/><strong class="ng ir">import { useRxState } from "@reonomy/reactive-hooks";</strong><br/>import { BehaviorSubject } from "rxjs";</span><span id="f649" class="mc md iq ng b gy no nl l nm nn">const fullName$ = new BehaviorSubject('');</span><span id="1d5b" class="mc md iq ng b gy no nl l nm nn">function FullName() {<br/><strong class="ng ir">    const [fullName, setFullName] = useRxState(fullName$);</strong><br/>    const onChange = e =&gt; <strong class="ng ir">setFullName(e.target.value)</strong>;    <br/>    return (<br/>        &lt;div&gt;<br/>            &lt;p&gt;Full Name: {fullName}&lt;/p&gt;<br/>            &lt;input <br/>                type="text" <br/>                onChange={onChange} <br/>                value={fullName} /&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}</span></pre><h2 id="f390" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useRxStateResult</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="95cb" class="mc md iq ng b gy nk nl l nm nn">useRxStateResult&lt;T&gt;(observable$: Observable&lt;T&gt;): T | undefined</span></pre><p id="1720" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">返回当前值的useRxState的只读版本。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="f738" class="mc md iq ng b gy nk nl l nm nn">import React from "react";<br/><strong class="ng ir">import { useRxStateResult } from "@reonomy/reactive-hooks";</strong><br/>import { interval } from "rxjs";</span><span id="0f23" class="mc md iq ng b gy no nl l nm nn">const interval$ = interval(1000);</span><span id="9b3d" class="mc md iq ng b gy no nl l nm nn">function Interval() {<br/>    <strong class="ng ir">const interval = useRxStateResult(interval$);</strong></span><span id="8e0a" class="mc md iq ng b gy no nl l nm nn">    return (<br/>        &lt;div&gt;<br/>            Interval: {interval}<br/>        &lt;/div&gt;<br/>    );<br/>}</span></pre><h2 id="aebc" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useRxStateAction</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="cc84" class="mc md iq ng b gy nk nl l nm nn">useRxStateAction&lt;T&gt;(subject$: Subject&lt;T&gt;): (value: T) =&gt; void</span></pre><p id="dcbb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">返回修改所提供主题的回调。</p><p id="45f1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是一个将“foo is Foo”打印到web控制台的示例。当你点击一个按钮时，它会变成“foo is Bar”。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="6541" class="mc md iq ng b gy nk nl l nm nn">import React from "react";<br/><strong class="ng ir">import { useRxStateAction } from "@reonomy/reactive-hooks";</strong><br/>import { BehaviorSubject } from "rxjs";</span><span id="1972" class="mc md iq ng b gy no nl l nm nn">const foo$ = new BehaviorSubject('Foo');<br/>foo$.subscribe({<br/>    next: val =&gt; console.log("foo is ", val);<br/>})</span><span id="e474" class="mc md iq ng b gy no nl l nm nn">function FooBar() {<br/>    <strong class="ng ir">const setFoo = useRxStateAction(foo$);</strong></span><span id="0fb3" class="mc md iq ng b gy no nl l nm nn">    return (<br/>        &lt;div&gt;<br/>            &lt;p&gt;{fullName}&lt;/p&gt;<br/>            &lt;button type="button" onClick={() =&gt; setFoo("Bar")}&gt;<br/>                Make it Bar<br/>            &lt;/button&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}</span></pre><h2 id="673a" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useRxEffect</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="ab54" class="mc md iq ng b gy nk nl l nm nn"><br/>useRxEffect&lt;T&gt;(<br/>               observable$: Observable&lt;T&gt;, <br/>               next: (value: T) =&gt; void<br/>): void</span></pre><p id="f012" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">类似于useEffect，但应该用作对可观察到的变化的反应。它让我想起angularJS里的“守望”，所以要小心！</p><p id="985f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">示例:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="278b" class="mc md iq ng b gy nk nl l nm nn">import React from "react";<br/><strong class="ng ir">import { useRxEffect } from "@reonomy/reactive-hooks";</strong><br/>import { interval } from "rxjs";</span><span id="ecb0" class="mc md iq ng b gy no nl l nm nn">const interval$ = interval(1000);</span><span id="9074" class="mc md iq ng b gy no nl l nm nn">function WatchInterval() {<br/>    <strong class="ng ir">useRxEffect(interval$, <em class="op">interval</em> =&gt; {<br/>        </strong>// do something<br/>        console.log("interval is ", <strong class="ng ir"><em class="op">interval</em></strong>);<strong class="ng ir"><br/>    });</strong></span><span id="1b23" class="mc md iq ng b gy no nl l nm nn">    return (<br/>        &lt;p&gt;<br/>            Look at the console!<br/>        &lt;/p&gt;<br/>    );<br/>}</span></pre><h2 id="7230" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useRxAjax</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="1ae9" class="mc md iq ng b gy nk nl l nm nn">useRxAjax&lt;Req, Res&gt;(<br/>                    api$: (req: Req) =&gt; Observable&lt;Res&gt;,<br/>                    next?: (response: Http&lt;Req, Res&gt;) =&gt; void</span><span id="4396" class="mc md iq ng b gy no nl l nm nn">): [Http&lt;Req, Res&gt; | undefined, (req: Req) =&gt; void]</span><span id="7fc8" class="mc md iq ng b gy no nl l nm nn">interface Http&lt;Req, Res&gt; {<br/>  status: Status;  // 'succeeded' | 'failed' | 'pending';<br/>  req: Req;<br/>  res?: Res;<br/>  error?: any;<br/>}</span></pre><p id="274d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">调用数据api调用(获取请求)并返回一个带有响应对象和请求调度程序的元组。还提供了一个回调来对处于挂起、成功或失败状态的请求做出反应。</p><p id="9ada" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">示例:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b869" class="mc md iq ng b gy nk nl l nm nn">import React from 'react';<br/><strong class="ng ir">import { useRxAjax } from '@reonomy/reactive-hooks';</strong><br/>import { ajax } from ‘rxjs/ajax’;</span><span id="2afb" class="mc md iq ng b gy no nl l nm nn">function weatherStatus({ apiKey }) { <br/>    return ajax({<br/>        method: "GET",<br/>        url: `https://api.openweathermap.org/data/2.5/weather?zip=10017,us&amp;appid=${apikey}`)<br/>    };<br/>}</span><span id="aca6" class="mc md iq ng b gy no nl l nm nn">function WeatherWidget() {<br/><strong class="ng ir">    const [weather, getWeather] = useRxAjax(api.weather);</strong><br/>    return (<br/>        &lt;article&gt;<br/>            &lt;h1&gt;Weather Status&lt;/h1&gt;<br/>            &lt;button onClick={() =&gt; getWeather({apiKey: 'xxxxxx'})}&gt;<br/>                Refresh<br/>            &lt;/button&gt;<br/>            &lt;section&gt;</span><span id="e48b" class="mc md iq ng b gy no nl l nm nn">                { weather &amp;&amp; <br/>                  weather.status === 'pending' &amp;&amp; <br/>                  &lt;p&gt;Pending...&lt;/p&gt; }</span><span id="ee7d" class="mc md iq ng b gy no nl l nm nn">                { weather &amp;&amp; <br/>                  weather.status === 'failed' &amp;&amp; <br/>                  &lt;p&gt;Failed: {JSON.stringify(weather.error)}&lt;/p&gt; }</span><span id="bc85" class="mc md iq ng b gy no nl l nm nn">                { weather &amp;&amp; <br/>                  weather.status === 'succeeded' &amp;&amp;<br/>                  &lt;p&gt;Succeeded {JSON.stringify(weather.res)}&lt;/p&gt; }</span><span id="87ef" class="mc md iq ng b gy no nl l nm nn">             &lt;/section&gt;     <br/>       &lt;/article&gt;<br/>    );<br/>}</span></pre><h2 id="5b6c" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useRxDebounce</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="cdd8" class="mc md iq ng b gy nk nl l nm nn">useRxDebounce&lt;In, Out&gt;( </span><span id="dae0" class="mc md iq ng b gy no nl l nm nn">    func$: (input: In) =&gt; Observable&lt;Out&gt;, <br/>    next?: (val: Out) =&gt; void, <br/>    debounce: number = DEBOUNCE</span><span id="ad3d" class="mc md iq ng b gy no nl l nm nn">): [Out | undefined, (input: In) =&gt; void]</span></pre><p id="fa4f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用给定的去抖超时调用回调。适用于自动建议。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="54b7" class="mc md iq ng b gy nk nl l nm nn">import React, { useState } from 'react';<br/><strong class="ng ir">import { useRxDebounce } from '@reonomy/reactive-hooks';</strong><br/>import { ajax } from 'rxjs/ajax';</span><span id="4bb8" class="mc md iq ng b gy no nl l nm nn">function addressLookup({ address }) { <br/>    return ajax({<br/>        method: "GET",<br/>        url: "..."<br/>    };<br/>}</span><span id="ffb7" class="mc md iq ng b gy no nl l nm nn">function AddressAutosuggest() {<br/>    const [address, setAddress] = useState('');<br/><strong class="ng ir">    const [suggestions, updateSuggestions] = <br/>                                      useRxDebounce(addressLookup$);<br/></strong>    const onChange = e =&gt; {<br/>        setAddress(e.target.value);<br/>        updateSuggestions(e.target.value);<br/>    };<br/>    return (<br/>        &lt;article&gt;<br/>            &lt;h1&gt;Search by address&lt;/h1&gt;<br/>            &lt;input type="text" onChange={onChange} value={address}/&gt;<br/>            { suggestions &amp;&amp; <br/>                &lt;ul&gt;<br/>                { suggestions.map({id, text} =&gt; <br/>                    &lt;li key={id}&gt;{text}&lt;/li&gt;<br/>                )}<br/>                &lt;/ul&gt; }<br/>       &lt;/article&gt;<br/>    );<br/>}</span></pre><h2 id="e0ca" class="mc md iq bd me mf mg dn mh mi mj dp mk kn ml mm mn kr mo mp mq kv mr ms mt mu bi translated">useMountEffect</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="ebc6" class="mc md iq ng b gy nk nl l nm nn">useMountEffect(onMountCallback: VoidFunction): void</span></pre><p id="444d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安装组件时调用回调。当您需要在初始渲染时调用http请求时非常有用。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="bbda" class="mc md iq ng b gy nk nl l nm nn">import React from 'react';<br/>import { useRxAjax, useMountEffect } from '@reonomy/reactive-hooks';<br/>import { ajax } from 'rxjs/ajax';</span><span id="7dcc" class="mc md iq ng b gy no nl l nm nn">function weatherStatus({ apiKey }) { <br/>    return ajax({<br/>        method: "GET",<br/>        url: `https://api.openweathermap.org/data/2.5/weather?zip=10017,us&amp;appid=${apikey}`)<br/>    };<br/>}</span><span id="c63f" class="mc md iq ng b gy no nl l nm nn">function WeatherWidget() {<br/>    const [weather, getWeather] = useRxAjax(api.weather);</span><span id="0221" class="mc md iq ng b gy no nl l nm nn"><strong class="ng ir">    useMountEffect(() =&gt; getWeather({apiKey: 'xxxxxx'}));</strong></span><span id="34b7" class="mc md iq ng b gy no nl l nm nn">    return (<br/>        &lt;article&gt;<br/>            &lt;h1&gt;Weather Status&lt;/h1&gt;<br/>            &lt;button onClick={() =&gt; getWeather({apiKey: 'xxxxxx'})}&gt;<br/>                Refresh<br/>            &lt;/button&gt;<br/>            &lt;section&gt;</span><span id="e0d4" class="mc md iq ng b gy no nl l nm nn">                { weather &amp;&amp; <br/>                  weather.status === 'pending' &amp;&amp; <br/>                  &lt;p&gt;Pending...&lt;/p&gt; }</span><span id="38d4" class="mc md iq ng b gy no nl l nm nn">                { weather &amp;&amp; <br/>                  weather.status === 'failed' &amp;&amp; <br/>                  &lt;p&gt;Failed: {JSON.stringify(weather.error)}&lt;/p&gt; }</span><span id="7bb2" class="mc md iq ng b gy no nl l nm nn">                { weather &amp;&amp; <br/>                  weather.status === 'succeeded' &amp;&amp;<br/>                  &lt;p&gt;Succeeded {JSON.stringify(weather.res)}&lt;/p&gt; }</span><span id="76ad" class="mc md iq ng b gy no nl l nm nn">            &lt;/section&gt;     <br/>       &lt;/article&gt;<br/>    );<br/>}</span></pre><h1 id="80f1" class="np md iq bd me nq nr ns mh nt nu nv mk nw nx ny mn nz oa ob mq oc od oe mt of bi translated">RxJS无缝集成</h1><p id="df5c" class="pw-post-body-paragraph kc kd iq ke b kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv mz kx ky kz ij bi translated">React ant RxJS是帮助处理DOM和异步事件的优秀库。有了Reactive Hooks库，它们可以顺畅地协同工作，确保整个应用程序的最优DOM操作和确定性行为。</p></div></div>    
</body>
</html>
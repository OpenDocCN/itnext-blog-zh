<html>
<head>
<title>Custom iOS Device Attributes Using AWS Amplify CLI and Amazon Pinpoint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS Amplify CLI和Amazon Pinpoint定制iOS设备属性</h1>
<blockquote>原文：<a href="https://itnext.io/custom-ios-device-attributes-using-aws-amplify-cli-and-amazon-pinpoint-2ace3ce0fef1?source=collection_archive---------0-----------------------#2018-09-11">https://itnext.io/custom-ios-device-attributes-using-aws-amplify-cli-and-amazon-pinpoint-2ace3ce0fef1?source=collection_archive---------0-----------------------#2018-09-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/16f7ff2939bdb8a775fadd09890d571a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QSRRv8ic6G1fQ7EbhtWkNA.png"/></div></div></figure><p id="f806" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是关于使用<a class="ae kx" href="https://aws-amplify.github.io/media/get_started?utm_source=da&amp;utm_medium=blog&amp;utm_campaign=denhills&amp;utm_term=ios_native" rel="noopener ugc nofollow" target="_blank"><em class="kw">AWS Amplify</em></a><em class="kw">和</em><a class="ae kx" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/welcome.html" rel="noopener ugc nofollow" target="_blank"><em class="kw">Amazon Pinpoint</em></a>将用户分析添加到您的iOS Swift应用程序的3部分系列的第2部分。在第1部分的<a class="ae kx" href="https://medium.com/@dmennis/integrate-analytics-into-your-ios-swift-applications-with-aws-amplify-20d31fe0a20e" rel="noopener">中，我们谈到了在你的iOS应用中收集基本的用户分析(人口统计和应用活动)。在本文中，我们将通过以<strong class="ka ir">设备特定属性</strong>的形式添加自定义用户设备分析来增强这一过程。然后，我们将使用这些额外的属性将我们的应用程序用户划分为共享设备模型特征，以便我们稍后可以通过相关内容吸引这些用户。</a></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h2 id="8bae" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">收集自定义设备特定属性</h2><p id="5d72" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated">首先，我们来关注一下亚马逊Pinpoint在使用iOS版AWS SDK时自动收集的默认人口统计数据。Pinpoint收集的标准默认人口统计属性如下所示:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi md"><img src="../Images/2a928e0ec03dd50e2e09f801a71fb1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*xxZsWp2lLFrTy6LDjwBU-w.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">Amazon Pinpoint收集的标准人口统计属性</figcaption></figure><p id="9239" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是为我的iPhone x收集的标准人口统计数据:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/f5b943faac691da779847b08475e2b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KorouLQtBnhgl-AKFjg5KQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">Pinpoint为我的iPhone X收集的实际标准人口统计属性</figcaption></figure><p id="aa75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意我的iPhone X的人口统计数据是如何丢失标准的<em class="kw"> ModelVersion </em>属性的？iOS的<em class="kw"> ModelVersion </em>人口统计属性应代表特定的iOS型号类型(例如，iPhone 8、iPhone X或iPad Mini 3)。对于任何移动开发人员来说，了解模型版本属性是非常重要的，因为您的应用程序可以从一个模型版本到下一个模型版本执行完全不同的操作。这对于解决Android碎片化问题至关重要，但对于iPhones，开发者在为特定型号添加或取消应用功能时，需要知道这些细节。对于故障诊断，您需要明确知道哪些类型的电话遇到了问题，以便您可以在确切的设备上进行调试，并且还可以只联系那些设备上受影响的用户，希望在他们遇到问题之前。</p><p id="2333" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于Amazon Pinpoint目前没有将<em class="kw"> ModelVersion </em>作为iOS设备的标准人口统计属性进行跟踪，让我们将该属性添加到我们的应用程序中。我们可以使用这个属性来根据特定的iOS iPhone型号对用户进行细分。</p><h2 id="9cf6" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">将DeviceUitlity.swift扩展添加到您的Xcode项目中</h2><p id="3cee" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated">这个<em class="kw"> DeviceUtility.swift </em>类是一个实用程序类，它定义了UIDevice扩展，该扩展将苹果的型号模式解码为可读的iOS设备类型。(例如，“iPhone7，1”指的是“iPhone 6s”)</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="bae4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，如果您还记得，在第一篇文章中，我们添加了一个<em class="kw">awsanalytisservice . swift</em>类，用于向Amazon Pinpoint发送分析事件。在向Pinpoint发送更新之前，我们将采用相同的类并修改它以调用UIDevice扩展并更新用户的设备默认型号版本属性。</p><p id="9aae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将此函数添加到位于<em class="kw"> sendEvent </em>方法下的<em class="kw">awsanalytisservice . swift</em>类中:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="d0b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在iOS项目的<em class="kw"> AppDelegate.swift </em>类中，调用<em class="kw">recordCustomProfileDemographics</em>函数，用UIDevice扩展返回的型号版本更新设备的<em class="kw"> ModelVersion </em>属性。</p><p id="fd67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是使用我们应用的更改运行应用程序后，<a class="ae kx" href="https://console.aws.amazon.com/pinpoint/home" rel="noopener ugc nofollow" target="_blank">亚马逊Pinpoint控制台</a>中人口统计分析页面的<strong class="ka ir">模型</strong>图中的结果:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/254c3757be7679c1e47a73a2730c7949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VqrYBHDc--J29_lqUmXjoA.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated"><strong class="bd lh">亚马逊Pinpoint型号</strong>图表显示更新的iOS型号版本</figcaption></figure><p id="d432" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在添加定制模型版本之前，模型图会显示一个彩色圆圈，其中100%的用户都在一台Apple“iPhone”上。这对于高级分析来说是可以的，但如果我们需要基于特定版本的iPhone联系这些客户，或者当我们需要更好地了解这些用户设备能够利用哪些功能时，这就没有用了。</p><p id="5ae3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们正在收集iOS型号类型，让我们创建一个新的<a class="ae kx" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/segments-building.html" rel="noopener ugc nofollow" target="_blank">亚马逊精确定位细分市场</a>，其中包含基于其iPhone型号版本的用户子集。由于UIDevice扩展可以处理所有iOS设备类型(至少在苹果于9月12日宣布新设备之前)，因此可以采用相同的过程来划分iPad型号。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h2 id="2a7b" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">基于iPhone型号版本属性细分用户</h2><p id="8e16" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated">在本例中，我们的细分市场代表了基于类似iPhone型号的受众子集。例如，为了接触到在iPhone X上运行您的应用程序的用户，您可以为匹配型号版本“iPhone X”的应用程序用户定义一个细分市场。</p><p id="006f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">通过亚马逊Pinpoint控制台创建细分市场</strong></p><ol class=""><li id="2003" class="mq mr iq ka b kb kc kf kg kj ms kn mt kr mu kv mv mw mx my bi translated">在终端的项目目录中，使用AWS Amplify CLI启动Amazon Pinpoint控制台:<em class="kw">$ Amplify analytics Console</em></li><li id="fdc5" class="mq mr iq ka b kb mz kf na kj nb kn nc kr nd kv mv mw mx my bi translated">在导航菜单中，选择<strong class="ka ir">段</strong>。</li><li id="b95a" class="mq mr iq ka b kb mz kf na kj nb kn nc kr nd kv mv mw mx my bi translated">选择<strong class="ka ir">新线段</strong>。</li><li id="baf2" class="mq mr iq ka b kb mz kf na kj nb kn nc kr nd kv mv mw mx my bi translated">对于<strong class="ka ir">段名称</strong>，为您的段键入一个名称，以便以后识别。</li><li id="ba4d" class="mq mr iq ka b kb mz kf na kj nb kn nc kr nd kv mv mw mx my bi translated">对于<strong class="ka ir">您希望如何定义您的细分市场</strong>，选择<strong class="ka ir">构建细分市场</strong>。</li></ol><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/ed30528811eb0d77c1d7bd9cf28e3ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw8WrXtystMMBRGPxxaFgw.png"/></div></div></figure><p id="5cc8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">6.对于<strong class="ka ir">,您希望使用哪种消息传递渠道？</strong>选择你最有可能用来吸引细分用户的<a class="ae kx" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/channels.html" rel="noopener ugc nofollow" target="_blank">渠道</a>。我们将在下一篇文章中讨论建立渠道和活动。对于本教程，我将使用短信。</p><p id="51e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">7.对于<strong class="ka ir">按标准属性过滤</strong>，定义哪些用户正在使用型号为&gt;的iPhone X。您在此处看到的(2)台“iPhone”设备代表尚未使用我们的UIDevice代码更新的应用程序，因此我们只知道这些用户使用的是iPhone。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/79020f614f0bc216c3ba7f6b7b4a16eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jxdcb-r-yPaqUNPARCvo_A.png"/></div></div></figure><p id="c420" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">8.(可选)对于<strong class="ka ir">按自定义属性过滤</strong>和<strong class="ka ir">按用户属性过滤</strong>，根据您添加到Amazon Pinpoint端点资源的自定义属性定义哪些用户属于该细分市场。</p><p id="ff11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">9.选择完标准后，选择<strong class="ka ir">创建分段</strong>。</p><p id="6118" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们根据这些细分用户创建新的营销活动时，请将此细分市场放在手边。</p><h2 id="c12a" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">最后的想法</h2><p id="45cd" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated">在本文中，我们通过添加一个扩展来更新现有的iOS应用程序，以将iOS模型版本映射到人类可读的值，然后使用这些值来更新Amazon Pinpoint收集的标准人口统计属性。然后，我们创建了一个Amazon Pinpoint细分市场，过滤掉特定iOS型号的用户。</p><p id="3471" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下一篇文章中，我们将基于这一细分市场构建一个精确定位的活动，并向这些细分用户发送通知。</p><h2 id="3675" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">资源</h2><p id="ef6b" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated"><a class="ae kx" href="https://aws-amplify.github.io/media/get_started?utm_source=da&amp;utm_medium=blog&amp;utm_campaign=denhills&amp;utm_term=ios_native" rel="noopener ugc nofollow" target="_blank"> AWS Amplify CLI </a></p></div></div>    
</body>
</html>
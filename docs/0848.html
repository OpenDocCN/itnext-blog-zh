<html>
<head>
<title>React, SVG Images and the Webpack Loader to Make Them Play Nice</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React、SVG图像和Webpack加载器，使它们播放得更好</h1>
<blockquote>原文：<a href="https://itnext.io/react-svg-images-and-the-webpack-loader-to-make-them-play-nice-2d177ae34d2b?source=collection_archive---------2-----------------------#2018-06-08">https://itnext.io/react-svg-images-and-the-webpack-loader-to-make-them-play-nice-2d177ae34d2b?source=collection_archive---------2-----------------------#2018-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c33acfdc90271d808043256fcb2f9c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBzkxFGebAWlk48uDqsRsQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">戈兰·艾沃斯在<a class="ae kc" href="https://unsplash.com/search/photos/developer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="41b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这不是一个新问题:让SVG用React正确渲染的困境，但这是一个我直到最近才不得不处理和克服的问题，我想分享我的经验，希望它能为其他人节省几个小时搜索Github、StackOverflow和NPM的时间。</p><p id="7f71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我目前的公司，我为两个独立的开发团队工作，他们都使用JavaScript微服务作为他们的ui——一个使用AngularJS，另一个使用JavaScript MVC。所有的后端服务都是Java Spring Boot应用程序。</p><p id="6afd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当不久前有消息称谷歌将停止支持AngularJS 1.5(我们正在使用的版本)时，很明显我们可以:</p><ol class=""><li id="acad" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">将系统升级到<a class="ae kc" href="https://blog.angular.io/stable-angularjs-and-long-term-support-7e077635ee9c" rel="noopener ugc nofollow" target="_blank"> AngularJS 1.7 </a>(将继续提供3年以上的长期支持)，</li><li id="0e9c" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">将我们的应用程序升级到Angular 2，</li><li id="87aa" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">或者迁移到ReactJS。</li></ol><p id="6022" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我和我的一个同事负责找出哪一个是最佳方向。这种探索是一个值得在自己的博客上发表的过程，但可以说，我最支持冒险进入React，在我们研究了我们的选项并进行修补后，我们决定看看我们是否可以使用React工作进行一次小型的概念验证。</p><p id="4705" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在开始我们的React POC大约4小时后，我们有了一个可以工作的应用程序，尽管不是很漂亮。我们添加了Jest和Enzyme单元测试、Cypress端到端测试等等。但是有一件事困扰了我们将近两个星期:让SVG图形在DOM中正确呈现。</p><h2 id="a4c1" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">为什么选择SVGs？有什么好处？为什么不直接做成PNG呢？</h2><p id="c9bc" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">问得好。使用SVG的好处有很多，如果你不知道，SVG代表<a class="ae kc" href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics" rel="noopener ugc nofollow" target="_blank">可缩放矢量图形</a>。虽然教科书上的定义听起来很深奥:</p><blockquote class="mn mo mp"><p id="7ed3" class="kd ke mq kf b kg kh ki kj kk kl km kn mr kp kq kr ms kt ku kv mt kx ky kz la ij bi translated">“S <!-- --> VG是基于<a class="ae kc" href="https://en.wikipedia.org/wiki/XML" rel="noopener ugc nofollow" target="_blank"> XML </a>的<a class="ae kc" href="https://en.wikipedia.org/wiki/Vector_image_format" rel="noopener ugc nofollow" target="_blank">矢量图像格式</a>，用于支持交互性和动画的<a class="ae kc" href="https://en.wikipedia.org/wiki/Two-dimensional" rel="noopener ugc nofollow" target="_blank">二维</a>图形”——维基百科，可缩放矢量图形</p></blockquote><p id="d6a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们基本上取代了JPEG、PNG、TIFF或GIF等其他格式的传统图像。</p><p id="8c51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是SVG优于其他图像格式的几个原因:</p><ul class=""><li id="4fe1" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la mu lh li lj bi translated"><strong class="kf ir">无论屏幕大小、缩放级别或图像大小，都有清晰的分辨率</strong> —因为SVG是基于矢量路径、形状和填充构建的，所以它们可以缩放到任何大小，而不会损失清晰度。另一方面，png是基于像素的，不会一直看起来清晰明了(尤其是在视网膜显示设备上)。</li><li id="111b" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated"><strong class="kf ir">加载速度更快</strong>——如果你在网站上使用高分辨率图像来迎合那些视网膜显示器，PNG文件可能相当大，而且越大的文件渲染越慢(咄)。SVG只是代码，这意味着文件更小(除非你加载的东西非常详细，有一百万个向量路径)。</li><li id="a5c5" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated"><strong class="kf ir">动画是可能的</strong>——与静态的PNG文件不同——所见即所得，SVG可以用CSS制作动画和样式。动画，不同的颜色，状态的变化(像悬停或点击)，所有这些事情都可以在SVG上完成。</li><li id="7b7b" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated"><strong class="kf ir">可访问性和搜索引擎优化</strong> —谷歌将SVGs编入索引，这意味着你的网站可以获得更好的搜索引擎优化分数，对于访问你网站的有视觉障碍的人来说也更容易访问。</li></ul><h2 id="910f" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">好，那么SVG就是了，现在如何在React中使用它们</h2><p id="d3c7" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在我的项目中，我正在考虑是否可以在React中重新创建一个现有AngularJS应用程序的简单屏幕。这个屏幕包含四个大的、可点击的卡片，将用户带到其他不同的屏幕，每个卡片都有一个漂亮的SVG文件，与单词相关联。</p><p id="f6d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我从原始项目中复制了SVG文件，将它们移动到React中，将文件导入到将呈现它们的组件中，添加</p><p id="5ed2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mv mw mx my b">&lt;Image source={require(‘../img/key.svg’)} /&gt;</code></p><p id="816c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在JSX，添加了CSS样式，等待Webpack进行神奇的解析，但…什么也没有。嗯，不是什么都没有，控制台中出现关于无法识别的文件类型的错误，但肯定没有按键图标显示在UI中。</p><p id="67d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我开始寻找在React中正确呈现SVG所需的库。这是一个长达数天的过程。如果你不知道大约有7，845，923个NPM模块都声称可以让React很好地与SVG配合使用。其中一些可能有用，我尝试的前10个左右没有用。</p><h2 id="ee06" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">然后… SVG内联加载程序</h2><p id="f20f" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">然后，我找到了。一个名为<a class="ae kc" href="https://www.npmjs.com/package/svg-inline-loader" rel="noopener ugc nofollow" target="_blank"> svg-inline-loader </a>的NPM模块，它有不错的文档，它有3200次周下载，它在Github上有325颗星，<em class="mq">它由构建Webpack </em>的核心团队开发和维护，它看起来很有前途。</p><p id="966f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我试了一下，把它保存到我的dev dependencies的<code class="fe mv mw mx my b">package.json</code>文件中。</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="7043" class="lp lq iq my b gy nh ni l nj nk">npm install svg-inline-loader react-inlinesvg --save-dev</span></pre><p id="552b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，将配置对象添加到<code class="fe mv mw mx my b">webpack.config.js</code>文件中:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="5144" class="lp lq iq my b gy nh ni l nj nk">{<br/>    test<strong class="my ir">:</strong> /\.svg<strong class="my ir">$</strong>/,<br/>    loader<strong class="my ir">:</strong> 'svg-inline-loader'<br/>}</span></pre><p id="87e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我已经准备好了。对Webpack的一个简单更新，对JSX语法的一个小调整和…</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="d18b" class="lp lq iq my b gy nh ni l nj nk">import React, { Component } from 'react';<br/>import KeyImage from '../img/key.svg'; <br/>import SVG from 'react-inlinesvg';</span><span id="e794" class="lp lq iq my b gy nl ni l nj nk">class Card extends Component(){<br/>return(<br/>    &lt;div&gt;<br/>      &lt; /* other UI stuff here */ &gt; <br/>      &lt;SVG src={KeyImage} /&gt;<br/>    &lt;/div&gt;  <br/>  )<br/>}</span></pre><p id="fd0c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">BOOM — SVG显示！</p><p id="2a0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我还想补充一下，这个NPM模块有一些非常漂亮的额外功能:它可以从SVG中删除额外的标签信息(当它们是用Sketch或Adobe生成的时候，这种情况经常发生)，它可以添加类或id来防止SVG冲突。很好。</p><p id="c83d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样。没有CSS变化，没有超级怪异的语法，什么都没有。只是svg-inline-loader，Webpack的一个额外的模块加载器，问题就解决了。</p><p id="183b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读，我希望它有所帮助，掌声非常感谢！</p><p id="8af5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">如果你喜欢读这篇文章，你可能也会喜欢我的其他博客:</strong></p><ul class=""><li id="1b5a" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la mu lh li lj bi translated"><a class="ae kc" href="https://medium.com/@paigen11/why-a-cloud-config-server-is-crucial-to-a-good-ci-cd-pipeline-and-how-to-set-it-up-pt-1-fa628a125776" rel="noopener">为什么云配置服务器对良好的CI/CD渠道至关重要以及如何设置(第1部分)</a></li><li id="7392" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated"><a class="ae kc" href="https://medium.com/@paigen11/javascript-array-methods-to-make-you-a-better-developer-4ce42052d54c" rel="noopener"> JavaScript数组方法让你成为更好的开发者</a></li><li id="efcf" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated"><a class="ae kc" href="https://medium.com/@paigen11/what-is-graphql-really-76c48e720202" rel="noopener">graph QL到底是什么？</a></li></ul></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="afee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">参考资料和更多资源:</strong></p><ul class=""><li id="ec32" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la mu lh li lj bi translated">维基百科，可扩展矢量图形:<a class="ae kc" href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Scalable_Vector_Graphics</a></li><li id="2896" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated">SVG内嵌加载器:<a class="ae kc" href="https://www.npmjs.com/package/svg-inline-loader" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/svg-inline-loader</a></li><li id="cb83" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la mu lh li lj bi translated">你应该使用svgs而不是pngs的5个理由:<a class="ae kc" href="https://watb.co.uk/5-reasons-you-should-be-using-svgs-over-pngs/" rel="noopener ugc nofollow" target="_blank">https://watb . co . uk/5-你应该使用SVGs而不是PNGs的理由/ </a></li></ul></div></div>    
</body>
</html>
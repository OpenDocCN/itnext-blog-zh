<html>
<head>
<title>New to PowerShell? Use Classes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PowerShell新手？使用类</h1>
<blockquote>原文：<a href="https://itnext.io/new-to-powershell-use-classes-ab7b1e6f72ec?source=collection_archive---------7-----------------------#2019-05-09">https://itnext.io/new-to-powershell-use-classes-ab7b1e6f72ec?source=collection_archive---------7-----------------------#2019-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9661" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用类避免PowerShell的常见缺陷</h2></div><p id="05ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">在继续之前，先学习使用和定义类的基本语义:</em> <a class="ae lf" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_classes" rel="noopener ugc nofollow" target="_blank"> <em class="le">关于类</em> </a></p><p id="a47b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">PowerShell具有强大但有时不直观的编程功能，这可能会让新用户感到头疼。这些特性使PowerShell成为几乎所有DevOps任务的理想候选，但经常会威胁PowerShell开发新手选择更麻烦的语言，如C#或Python。通过使用类，新的PowerShell开发人员可以迈出他们进入PowerShell生态系统的第一步，而不会从不受欢迎的惊喜中退缩</p><h1 id="eccf" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">类比函数简单？</h1><p id="7a7d" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在大多数语言中，函数比类简单。静态类基本上只是组织函数的方法，但是PowerShell已经支持用于组织函数的模块，所以当我们可以使用模块和函数时，为什么我们要使用静态类呢？</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/1174a062d847e9a645c973e442745ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qWqnobCV6iJx2IckfQctDg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">使用静态方法和函数的平凡函数的等效实现</figcaption></figure><h2 id="3dd2" class="mt lh it bd li mu mv dn lm mw mx dp lq kr my mz ls kv na nb lu kz nc nd lw ne bi translated">简化输入</h2><p id="9c18" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">PowerShell功能极其强大。通过几行参数属性，您可以为您的函数拥有一个全功能的命令行界面。这些接口非常适合面向用户的功能，但是这种面向用户的表示逻辑不应该保留在我们的核心实现逻辑中。</p><p id="6ce1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">方法输入要简单得多，默认情况下每个参数都是强制性的，因此可以保持内部业务逻辑简单。通过隔离业务逻辑，您可以只围绕您的核心业务逻辑实现<a class="ae lf" href="https://github.com/pester/Pester" rel="noopener ugc nofollow" target="_blank">单元测试</a>，并依靠声明性参数验证来保证您的表示性cmdlets上的代码健康。</p><h2 id="aa30" class="mt lh it bd li mu mv dn lm mw mx dp lq kr my mz ls kv na nb lu kz nc nd lw ne bi translated">简化输出</h2><p id="c69b" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">对于学习PowerShell的人来说，最大的惊喜之一是<code class="fe nf ng nh ni b">return</code>语句并不是唯一从函数中输出值的语句——每个非void表达式都向输出中写入一个值。在方法中，只有<code class="fe nf ng nh ni b">return</code>语句输出一个值，这使得它们更容易测试、调试和理解。</p><p id="8c01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">方法还支持方法头中的简单返回类型声明，确保您的函数总是返回您期望的类型(或者抛出类型错误)。</p><h1 id="914f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">毕业</h1><p id="15fa" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">因此，您已经使用静态类完成了最后期限，现在您已经熟悉了基本的PowerShell语义，并准备将您的脚本提升一个档次。以下是你接下来如何成长的方法。</p><h2 id="3e76" class="mt lh it bd li mu mv dn lm mw mx dp lq kr my mz ls kv na nb lu kz nc nd lw ne bi translated">深入研究函数</h2><p id="796c" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">我们避免使用函数，因为它们处理参数和返回的方法可能会令人困惑，但是一旦您了解了这些特性的细微差别，它们会极大地提升您的代码。</p><ul class=""><li id="cb0f" class="nj nk it kk b kl km ko kp kr nl kv nm kz nn ld no np nq nr bi translated">了解<a class="ae lf" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parameters" rel="noopener ugc nofollow" target="_blank">函数参数</a>，这样您就可以快速地以声明方式创建强大的命令行界面，或者通过参数验证使您的脚本更加稳定。</li><li id="327d" class="nj nk it kk b kl ns ko nt kr nu kv nv kz nw ld no np nq nr bi translated">不要把输出看作奇异值，把它们看作一个流。学习如何<a class="ae lf" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection" rel="noopener ugc nofollow" target="_blank">重定向流</a>并在<a class="ae lf" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_pipelines" rel="noopener ugc nofollow" target="_blank">管道</a>中对其进行操作。</li></ul><h2 id="8374" class="mt lh it bd li mu mv dn lm mw mx dp lq kr my mz ls kv na nb lu kz nc nd lw ne bi translated">让课程更上一层楼</h2><p id="8841" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">课程不仅仅是给初学者的。学会利用高级特性，比如通过类实现的隐式和显式类型转换函数，这样你就可以用类来扩展你的功能代码。</p></div></div>    
</body>
</html>
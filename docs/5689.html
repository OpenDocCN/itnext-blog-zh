<html>
<head>
<title>UI-Testing TypeScript React apps with Puppeteer and Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Puppeteer和Jest测试TypeScript React应用程序的用户界面</h1>
<blockquote>原文：<a href="https://itnext.io/ui-testing-typescript-react-apps-with-puppeteer-and-jest-a48684f5d8dc?source=collection_archive---------4-----------------------#2021-05-03">https://itnext.io/ui-testing-typescript-react-apps-with-puppeteer-and-jest-a48684f5d8dc?source=collection_archive---------4-----------------------#2021-05-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="943d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将向您展示如何在React项目中正确配置木偶师。</p><p id="129f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Puppeteer是Google开发的一个库，它帮助我们简化UI测试。</p><p id="12d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们通过运行<code class="fe kl km kn ko b">create-react-app</code>包来创建一个简单的新app。</p><p id="8754" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">$ npx create-react-app my-app --template typescript</code></p><p id="846c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们简单的应用程序:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/6b4b5a141b27c00e879333b99e398196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ZSDTKk9AGk8r7_6vkVsIg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">App.tsx</figcaption></figure><p id="2d5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，我们需要安装一些开发依赖项:</p><p id="8025" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">$ npm i -D jest puppeteer start-server-and-test ts-jest ts-node @types/jest @types/puppeteer</code></p><p id="a741" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以设置Jest。<br/>在项目的根路径下创建一个名为“jest.config.ts”的新文件:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lf"><img src="../Images/bcdc6b6d7eabf75ffb2171694d8410d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BU0yXo6wexXiilgPTYwoKA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">jest.config.ts</figcaption></figure><p id="3fcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在“src”文件夹中创建一个名为“__tests__”的新文件夹:这是我们所有测试的位置。<br/>在这个文件夹中，让我们创建第一个名为“App.test.ts”的测试文件:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lg"><img src="../Images/38a2a6d0b6fda80dffb231a10c675410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZhEpKJGRe7ZbrGLAxvJVQ.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">应用测试</figcaption></figure><p id="1b27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该脚本将:</p><ol class=""><li id="b2b3" class="lh li iq jp b jq jr ju jv jy lj kc lk kg ll kk lm ln lo lp bi translated">在headless(“不可见”)模式下启动一个新的Chromium实例(内置于木偶师包中)</li><li id="a692" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">创建一个指向本地开发服务器的新选项卡</li><li id="66d6" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">点击“增加计数器”按钮10次</li><li id="72fc" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">检查我们计数器的值是否是10</li><li id="f026" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">关闭浏览器实例</li></ol><p id="409d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在启动测试之前，我们需要等待本地服务器启动并运行。</p><p id="9eb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是<code class="fe kl km kn ko b">start-server-and-test</code>图书馆来救援的地方。</p><p id="9f53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开“package.json”:</p><ol class=""><li id="465e" class="lh li iq jp b jq jr ju jv jy lj kc lk kg ll kk lm ln lo lp bi translated">用<code class="fe kl km kn ko b">"test": "jest”</code>替换旧的<code class="fe kl km kn ko b">"test": "react-scripts test”</code></li><li id="3469" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">添加<code class="fe kl km kn ko b">"ci": "BROWSER=none PORT=3000 start-server-and-test start <a class="ae lv" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a> test"</code></li></ol><p id="6816" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意,<code class="fe kl km kn ko b">BROWSER</code>属性被设置为none，这样我们在启动development React服务器时就不会打开浏览器。</p><p id="8fe5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们终于准备好测试我们的应用了:</p><p id="bbc5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">$ npm run ci</code></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lw"><img src="../Images/9be0f209aa84d80e1154dcd6b145ab01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZAnbrj-kRUuOBVVeLsjeQ.png"/></div></div></figure><p id="cae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们想有更多的视觉反馈，我们可以关闭无头模式。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="be6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在GitHub <a class="ae lv" href="https://gist.github.com/matteolobello/a6a9d29bccca4438b0b3b80730da5576" rel="noopener ugc nofollow" target="_blank">这里</a>找到代码。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Overview: Azure load balancing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">概述:Azure负载平衡</h1>
<blockquote>原文：<a href="https://itnext.io/overview-azure-load-balancing-5827da0bf14d?source=collection_archive---------1-----------------------#2022-11-05">https://itnext.io/overview-azure-load-balancing-5827da0bf14d?source=collection_archive---------1-----------------------#2022-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/cec15bd2c6d6e02236e827d716017c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_e76ytRgBCzB3dV0bOjCw.png"/></div></div></figure><div class=""/><div class=""><h2 id="30be" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">有哪些不同类型的Azure负载平衡器服务？</h2></div><h1 id="3df1" class="kq kr jb bd ks kt ku kv kw kx ky kz la kh lb ki lc kk ld kl le kn lf ko lg lh bi translated">为什么要写另一篇负载平衡器的文章呢？</h1><p id="7f78" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">在写这篇文章的时候，我正在准备我的Azure基础考试。现在，我已经作为一名开发人员以专业和个人的身份与Azure一起工作了一段时间。当查看所有类型的服务时，我发现Azure负载平衡和网关产品的命名约定有点令人困惑，它们做什么，以及何时使用它们。</p><figure class="me mf mg mh gt is"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h1 id="0902" class="kq kr jb bd ks kt ku kv kw kx ky kz la kh lb ki lc kk ld kl le kn lf ko lg lh bi translated">谁会觉得这个有用？</h1><p id="471b" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">不熟悉Azure或者只是想快速浏览一下的人。网上有一些很棒的参考资料，Azure门户确实提供了一个向导/问卷来决定一个适合你的解决方案的负载平衡解决方案。</p><h2 id="1e14" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">什么是负载平衡器？</h2><p id="73b6" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">一个基本的使用案例是，假设您有一个虚拟机或一个应用程序实例，并且存在流量高峰时间，或者它是一项关键服务，如果它的唯一实例不可用，将会发生不好的事情。或者您希望在区域或全球级别为所有入站流量设置特定的路由规则和安全性。这就是负载平衡器的用武之地。如果后端服务的一个实例出现故障，流量将被路由并发送到该服务的下一个可用的健康实例，这有助于流量分配。</p><p id="7a4a" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">在最高层次上，它是一个路由入站流量并将其分发到其后端实例的软件。根据服务的不同，它可以公开、私有或两者都公开。使用前端和后端的概念，其中前端是对其进行调用的服务/机器，后端是向负载平衡器注册的服务或虚拟机，以便将流量分配给它们。它还可以充当系统中的单一入口点。请注意，您选择的Azure负载平衡器的类型还取决于您系统的地理分布，如全球、单个或多区域。</p><p id="b280" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">服务流量的协议类型会影响您选择的负载平衡器的类型。这就是OSI模型的用武之地，即使您只是一名开发业务应用程序的开发人员，我也强烈建议您熟悉OSI模型。出于本文的目的，我们只对第4层和第7层感兴趣。</p><p id="868e" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">供参考:</p><figure class="me mf mg mh gt is"><div class="bz fp l di"><div class="nb mj l"/></div></figure></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="6b9a" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">什么会影响解决方案的类型？</h2><p id="f83a" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">决定负载平衡解决方案时要考虑的因素包括:</p><ul class=""><li id="1ec9" class="nj nk jb lk b ll mw lo mx lr nl lv nm lz nn md no np nq nr bi translated">所有服务都在云中运行还是这是一个混合云环境？</li><li id="7b4e" class="nj nk jb lk b ll ns lo nt lr nu lv nv lz nw md no np nq nr bi translated">流量是通过外部(公共互联网)还是内部(在VNet内或通过VNet对等)发送到您的应用程序，或者两者都有？</li><li id="a6ef" class="nj nk jb lk b ll ns lo nt lr nu lv nv lz nw md no np nq nr bi translated">您需要在OSI模型的哪一层(第4层或第7层)平衡流量？</li><li id="e960" class="nj nk jb lk b ll ns lo nt lr nu lv nv lz nw md no np nq nr bi translated">系统的地理分布，即全球、单一或多区域。</li></ul></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="4eea" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">负载平衡器的类型</h2><p id="105e" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">在撰写本文时，这是负载平衡服务的列表，我想指出的是，这些服务中的每一项都有更多的详细信息，我鼓励您参考每项服务的官方文档，如果一起研究，可能会让人不知所措，尤其是如果您以前从未在云环境中工作过。所以现在简短的总结就可以了。</p><h2 id="9cde" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">第4层</h2><figure class="me mf mg mh gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/da42a1d4e8038548d13ca1e747d69c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*Tu_cuK5o_0NU5vz1xP8yoQ.png"/></div></figure><h2 id="2741" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">Azure负载平衡器</h2><p id="78c2" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">最常用于作为后端的虚拟机池，具有路由规则、流量管理器、端口转发和运行状况探测等功能。在这里，您可以根据端口或IP地址来路由流量。它有3个SKU:标准、基本和网关负载平衡器。</p><p id="6494" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">在撰写本文时，有一个<a class="ae ny" href="https://learn.microsoft.com/en-us/azure/load-balancer/cross-region-overview" rel="noopener ugc nofollow" target="_blank">跨区域负载平衡器</a>功能正在预览中，它使负载平衡器能够跨区域而不是单个区域进行平衡。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="317b" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">第7层</h2><figure class="me mf mg mh gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/2c51b7ed4748c260c6306ae531d5b502.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*gTY-OqinTgwfBjbig8uHPA.png"/></div></figure><h2 id="76e5" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">Azure应用程序网关</h2><p id="fa31" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">特定于地区且必须在VNET中部署的服务。它的后端可以是虚拟机、Azure应用服务和变体、IP FQDN，在Kubernetes世界的Standard_v2和WAF _ v2 SKUs上，它可以配置为Azure网关入口控制器，以部署到您的AKS集群中。</p><p id="b7be" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">支持自动扩展、端到端加密、区域冗余、多站点托管URL重写、SSL终止和健康探测，并配置为与Web应用程序防火墙(WAF)一起工作。需要指出的是，应用程序网关是一个单一入口点，可以配置为公共或公共+私有。我的意思是，您不能将应用程序网关部署到您的VNET中，只能让私有VNET服务访问它，而没有公共端点。</p><p id="68cc" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">支持:HTTP/ HTTPS/ HTTP2/ FTP/ SMTP和网络套接字流量。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><figure class="me mf mg mh gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/8480b37811623e125f9c65157c070886.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*TN_Jj_3lthrG5iEXyEwQbQ.png"/></div></figure><h2 id="ec10" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">天蓝色前门</h2><p id="3442" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">它是一个全球负载均衡器，在这里你可以添加Azure CDN和WAF。它有3个SKU:标准、经典和高级。在这里，您可以让它处理全局流量，并将其路由到特定于您所在区域的负载平衡器。它的功能类似于应用负载平衡器，但带有缓存、流量加速、URL重写/重定向、DDOS保护、端到端TLS加密和地理过滤。</p><p id="9fc0" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">这适用于需要多区域支持以及需要管理大量流量的情况，这通常是大中型企业需要高可用性、冗余性、安全性以及来自世界各地的服务的情况。由于成本原因，你不会为非常小的企业或副业项目提供这种服务。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="0f2d" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">域名服务器(Domain Name Server)</h2><figure class="me mf mg mh gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/4c635af46a7d06041ce5d5865e8c5e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*DusJ6meGHQqMZ1QPjZNtxA.png"/></div></figure><h2 id="26f9" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">Azure流量管理器</h2><p id="8d06" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">是一种全球可扩展的DNS路由服务。它会根据配置的路由标准将入站请求路由到您的DNS别名。这里的关键概念是你的目的地需要公开。</p><p id="55aa" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">例如，您在不同地区有多个应用程序，可能还有一些本地域，您希望建立一个DNS记录(通常是一个CNAME ),并让流量管理器将流量路由到每个已配置的下游路由。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="35e8" class="mk kr jb bd ks ml mm dn kw mn mo dp la lr mp mq lc lv mr ms le lz mt mu lg mv bi translated">摘要</h2><p id="74d9" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">负载平衡器协助<strong class="lk jc">安全</strong>、<strong class="lk jc">冗余</strong>、<strong class="lk jc">高可用性</strong>、<strong class="lk jc">扩展</strong>、加密、<strong class="lk jc">健康探测器</strong>和<strong class="lk jc">路由规则</strong>等等。我想说，如果上述属性对您的应用程序或客户很重要，那么在生产环境中应该重点考虑。您可以查看微软解决方案的更详细的<a class="ae ny" href="https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/load-balancing-overview" rel="noopener ugc nofollow" target="_blank">概述</a>以及如何将它们结合起来以获得适合您系统的最佳负载平衡解决方案。</p><p id="4c92" class="pw-post-body-paragraph li lj jb lk b ll mw kc ln lo mx kf lq lr my lt lu lv mz lx ly lz na mb mc md ij bi translated">感谢您在百忙之中抽出时间阅读或浏览本文，非常欢迎您的反馈。</p></div></div>    
</body>
</html>
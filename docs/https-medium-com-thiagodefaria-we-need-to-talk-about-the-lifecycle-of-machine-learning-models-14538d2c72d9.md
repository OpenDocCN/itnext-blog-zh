# 我们需要讨论机器学习模型的生命周期

> 原文：<https://itnext.io/https-medium-com-thiagodefaria-we-need-to-talk-about-the-lifecycle-of-machine-learning-models-14538d2c72d9?source=collection_archive---------2----------------------->

![](img/f0470495c389e6dc5dfad8afcb5fa1a9.png)

JD Hancock 的照片，他知道良好的数据管道的重要性……:-P

在我的职业生涯中，我总是关注事情的最终目标——这通常与给我的客户带来更多的钱有关。也许是因为我读了[《目标》](https://www.amazon.com/Goal-Process-Ongoing-Improvement/dp/0884271951)，并从创造了[《凤凰计划》](https://www.amazon.com/Phoenix-Project-DevOps-Helping-Business/dp/1942788290/ref=sr_1_1?s=books&ie=UTF8&qid=1551024372&sr=1-1&keywords=the+phoenix+project)的简单方法中获得了很多灵感。无论如何，我一直知道，通过创建机器学习模型、实现聊天机器人、建立数据管道或管理团队，我们必须尽快将模型投入生产！

作为 LINKIT 解决方案工程的负责人，我经常去找一些客户，他们认为自己有大量的数据科学家，但相关的几个模型需要很长时间才能投入生产。但是为什么呢？我们能帮上什么忙？

首先，我们必须确定主要问题。很明显，绝大多数数据科学家过于关注算法的内部齿轮(*这并不重要，不要误解我的意思*)，而忘记了这里最重要的事情是:在正确的时间、正确的位置拥有正确的数据。

除非你为一家人工智能初创公司或巨头如优步、脸书、谷歌等工作，否则你的问题可能会被已经在 [Keras](https://github.com/keras-team/keras) 、 [PyTorch](https://github.com/pytorch/pytorch) 、 [Theano](https://github.com/Theano/Theano) 、 [TensorFlow](https://github.com/tensorflow/tensorflow) 、 [MXnet](https://github.com/apache/incubator-mxnet) 、 …许多公司的价值可以通过建立一个可扩展和可靠的数据管道来获得，该管道以一般的线性模型或随机森林为终点…我告诉我团队中的每个人的是，你不仅仅是被支付代码或发现新算法，你还被支付利用你的专业知识赚钱。

我见过有几十个数据科学家的公司构建不同的模型，做着了不起的工作，最终得到惊人的一次性模型，需要 3-12 个月才能看到生产部署的曙光。此外，机器学习开发(一般来说)专注于超参数调整和数据管道的事实并不意味着我们需要重新发明轮子或寻找一种全新的方法来做这件事。市场和 DevOps 运动奠定了坚实的基础:支持实验、持续评估、共享、抽象层、可观察性以及产品和服务工作的文化变革。

> “对我来说，数据工程和数据科学家的辩论就像职业比赛。你不应该雇用 30 名司机和一名工程师，因为这个比例应该是相反的。你应该有 2 名车手在一个团队中驾驶 2 辆车，而 30 名工程师确保赛车适合车手发挥作用。数据科学家是数据工程师制造的汽车的驾驶员！”

![](img/cc96349e8cd05ad958e110d691a0f26c.png)

JD Hancock 拍摄的照片，展示了数据在发展中的重要性……:-P

# 确定性函数与 ML 开发

传统的软件开发依赖于 if/else 循环和确定性函数，它们封装了行业中绝大多数的案例。我们为支持生态系统而构建的工具，我们调试和测试的方式…都是在考虑这些用例的情况下设计的。对于 ML 应用程序，必须有不同的观点！

作为 DevOps 文化的直接结果，数据科学从业者还必须吸收去年的大量行业收益:可部署的工件、可观察性、共享文化、核心的实验/失败，以及产品和服务方面的工作。开发人员带着苦涩的眼神看着我的另一点是:你需要体验“地狱般的操作”，因为你的模型、你的 API 而随叫随到。这将提高从这些实验中产生的代码和产品的质量。

![](img/3baa32256d543b3dc54b11aed1716047.png)

照片由 [JD Hancock](http://jdhancock.com/) 拍摄，展示了你如何犯一个错误，并把 AI & ML 称为同样的东西……:-P

# 人工智能，ML，和炒作的混乱

我对人工智能的定义不是真理，也不是唯一的，远非如此。我通常会在演讲开始时指出这一点，以便与观众有一个共同点，因为我注意到，有时 ML，AI，数据科学，深度学习可以互换使用。

**人工智能**正在让计算机能够做一些人类认为需要独特智能才能完成的事情。

机器学习是构建智能部分的一种方式，确保这些机器可以找到模式，而无需显式编程。

为了使它不那么模糊，特别是对于 ML 部分，我们可以想象下面的灾难——如果你想创建一个规则来识别图片中的猫，你可以尝试用传统的循环 if/else 和规则来做到这一点:

*   数字图像由每个像素的 RGB 值组成，从 0 到 255 不等。
*   当第四个像素的 RGB 值为(24，42，255)而第五个像素的 RGB 值为(28，21，214)等等等等——这是一只猫！
*   你能想象出你必须写作的所有可能性吗？**无限**！还有，当你得到一张新的从未见过的照片时，你会抓住一个从句吗？这让这个世界变得极其二元，难以直视！

机器学习允许我们拥有增加包含猫的图片的机会的算法。这些算法基于统计学习(一个你试图根据你拥有的数据找到一个预测函数的过程)，可以基于数据进行训练。

![](img/2904ccb0aa65f7c566033a5207d46efb.png)

照片由 [JD Hancock](http://jdhancock.com/) 拍摄，表明你可以领先并克服一些 ML 生命周期的挑战……:-P

# ML 生命周期挑战

ML 生命周期与我们为传统开发解决的问题一样，但是现在有了不同的视角:**版本控制、打包、部署、协作和服务**。主要的问题是，我们试图将我们以前在软件开发中使用的解决方案强加到这个生态系统中

去年，我们看到试图解决 ML 开发生命周期的产品(尤其是开源产品)数量显著增加——Spark 运行在 Kubernetes 、 [kubeflow](https://github.com/kubeflow/kubeflow) 、 [MLflow](https://github.com/mlflow/mlflow) 之上，云提供商提供工具来支持模型的培训和服务。我们正在见证这个生态系统的成熟，这是一个不断成长的环境。

我告诉大家的是:没有银弹，工具就在那里。到目前为止，文化变革和优化工作方式以提高工作效率是最难的事情！

![](img/965d97baa3d3b33f8e2ecc8e65522a18.png)

JD Hancock 拍摄的照片—ML bug 不是我们所习惯的… :-P

# ML bugs

关于错误，重要的是要注意机器学习的错误:偏差、漂移和脆弱性。

**偏见**来自用于构建特征的数据集上存在的偏见，可能会产生灾难性的结果，主要是在类似黑盒的模型上使用(*你好，深度学习！*)——[亚马逊废弃“性别歧视人工智能”](https://www.bbc.com/news/technology-45809919) tool 是一个人工智能模型的例子，它通过了一家以高质量工程著称的公司的所有测试。然而，在试图筛选和招聘软件工程师时，数据是有偏见的，因为我们所在的行业中，女性是一个代表性很低的群体。这意味着该算法不利于女性申请人，因为它在训练集上没有很多案例。这也可能发生在抵押贷款评分系统和许多其他业务。[数学毁灭的武器](https://www.amazon.com/Weapons-Math-Destruction-Increases-Inequality/dp/0553418815)是 2016 年的一本书，它提出了许多关于算法的这些问题，这些算法做出了关于雇佣、分类和其他人的关键决策——这是一本很好的读物！

**漂移**发生在模型构建、运行良好和部署时。你可能会认为这项工作已经完成，不需要其他任何东西了，对吗？可惜没有。必须根据使用情况和数据重新校准和同步模型，以保持准确性。否则就会随波逐流，随着时间的推移变得越来越差。

**脆弱性**可能与偏见有关，但更多与团队力所不及的变化有关。定义的变化、变得不可用的数据、不应该存在的空值……您的模型如何处理这些问题，它有多脆弱？

最糟糕的是，ML 中的大多数错误很难在生产前被识别出来— *对于偏差，有很多方法，但不多，因为它被视为一个缓慢的因素。*这就是为什么 DevOps 的其他支柱**监控**和**可观察性**在机器学习组件中发挥着巨大的作用。

您必须衡量那些确定您的 ML 组件应该影响的商业价值的代理。例如，您是否创建了一个推荐引擎，您是否将 AB 测试策略应用于推广？让我们看看两组之间的花费差异。或者，也许你现在有一个图像标签组件，那么人们正在使用它周围的功能吗？您不能直接跟踪 ML 组件，但是您可以在其上分析代理度量。这些类型的度量和对度量的关注可以帮助你在早期发现和接近 ML 缺陷:偏差、漂移和脆弱性。

![](img/83930425453615dc533a539457132c64.png)

JD Hancock 拍摄的照片[——架起 ML 模型和 IT 运营之间的桥梁](http://jdhancock.com/)

# 数据科学家和 IT 运营之间的距离

曾经影响(*现在仍然影响*)商业世界并“催生”DevOps 运动的同一问题也是数据科学团队每天面临的最大问题之一，即业务与所构建内容的实际产业化/运营化之间的距离。

这种差距是由三件事造成的:**缓慢** ( *从想法到生产需要巨大的时间*)，**大量的移交** ( *X 与客户交谈，A 编写用户故事，B 构建，C 验证，D 批准，E 部署，F 运营，G 修复 bug，H 重建，…* )，以及**集群团队致力于项目，而不是产品(** [*加速书*](https://www.amazon.com/Accelerate-Software-Performing-Technology-Organizations/dp/1942788339) *)*。随着组织开始改变他们处理软件开发和交付生命周期的方式，这种距离变得越来越明显。为什么？因为我们可以看到很多组织在采用新的实践、工具和做最难的事情上的胜利:**改变文化**。

改善共享和协作并不容易；这是任何组织能做的最难的事情:改变文化。在 ML 工程师和数据科学家的案例中，一些文化方面会产生很大影响，但我见过的最引人注目的一个与专业人士的背景有关。

他们中的大多数人都有很强的学术背景，这意味着他们习惯于花很长时间研究一个问题，直到它足够好，可以在出版物上发表。这里的标准非常高，不仅仅是一些指标，还包括实验的设计，数学的严谨性等等。在商业环境中，这很重要，但不那么重要…这意味着发布一个准确率为 40%的模型并使其处于可部署状态是可以的。最好现在就准备好并考虑投入生产，而不是等几个月才有“足够好”的东西。也许三个月后，这将不再是一个值得解决的问题。以灵活的可能性快速行动是最好的方式。

![](img/230db67721833d15e9fce42042f56e61.png)

照片由 [JD Hancock](http://jdhancock.com/) 拍摄——行动更快，为您的 ML 模型建立 CI/CD/CE 渠道

# 你应该怎么做才能从 ML 中获得(更多)价值(更快)？

培训数据科学家并从 ML 技术中产生价值以构建 AI 应用程序是极其困难的。为了让它可行、有趣并吸引这些专业人士，我们必须改变它周围的文化。很难设计一条通往这种“最佳文化”的道路，因为每家公司都有自己的方式，互动也很困难。我所看到的一些支持快速上市的文化特征有助于为 ML 项目创造价值，包括:

*   数据科学— **“科学”部分表示实验和失败的尝试**。不是所有的实验都成功，所以数据科学不会一直产生令人兴奋的解决方案。有时候你可以钻进兔子洞。或者，业务可能会发生变化。所以问题是:如果你是一名数据科学家，在一个项目上工作了几天，你看不到它的未来，你有勇气和自主权告诉你的老板/利益相关者吗？同样，反过来说……他们可以随时来找你，告诉你业务发生了变化，我们必须进行转型吗
*   **除了 CI/CD，我们还需要谈谈 CE——持续评估。**每次测试新模型时——它可以是同一算法中的新超参数，也可以是全新的算法——我们必须能够将其与之前的运行进行比较。它有多准确？为什么结果不一样？我们使用的是同一个数据集吗？这是正确使用资源和在公司内部学习的基础。因此，让我们实现 CI/CD/CE 管道！
*   **分享，分享，分享**。不仅要分享你的好榜样，还要分享那些彻底失败的榜样！随时对您的代码和模型进行版本控制！每时每刻都要学会运用！为什么？因为当其他人看到时，他们不会用相同的数据集和参数再次尝试…停止浪费！
*   **为数据科学提供平台和工具，抽象出他们不知道**(他们也不需要知道)的东西。数据科学家可能不知道他们是想在 REST 还是 gRPC 中服务他们的模型，如果应该在 Kubernetes 集群上部署，如何打包模型，或者每秒应该承受多少请求—这不是他们的专业知识。一个团队必须提供一个平台，并有一个管道来做这件事，做决定，做实验，并应用所需的变化..这里的问题是公司“销售银弹平台”。每个公司都有自己的流程、工作方式和想法……不要让文化屈从于工具。
*   **致力于产品和服务，而不是项目**。开发者、安全专家、SRE……每个人都应该参与进来并提供帮助。通过这样做，您可以确保从第一天起就拥有可部署的工件！部署之后，工作还没有结束…你必须操作、监控、重构、校准和处理正在生产中运行的 ML 模型。

我在 2018 年阿姆斯特丹 DevOpsDays 上的讲话启发了这篇文章。
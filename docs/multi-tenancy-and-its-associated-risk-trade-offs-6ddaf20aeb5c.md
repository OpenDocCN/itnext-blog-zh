# 多租户及其相关的风险权衡

> 原文：<https://itnext.io/multi-tenancy-and-its-associated-risk-trade-offs-6ddaf20aeb5c?source=collection_archive---------9----------------------->

我们所说的多租户是什么意思？

这是我们隔离居住在单一环境中的客户(租户/参与者)而不互相干扰的方式。换句话说，通过实施适当的安全规则，在为每个客户定义了固定边界的情况下，客户之间如何共享资源。

环境可以指任何物理和逻辑资源。比如数据服务器，裸机，Kubernetes 集群等等。

**为什么我们需要在租户之间共享资源？**

降低成本！，当然可以。通过与多租户共享资源，我们可以最大限度地高效利用资源。比方说，将一台 20 个 cpu 内核的机器分配给一个实际上只需要 2 个内核的客户会导致 2 种情况:

1.  部署成本更高
2.  资源利用不足

因此，更明智的做法是将资源分配给 10 个客户，每个客户都需要 2 个内核。

**实现这一目标背后的挑战是什么？**

首先是重要的一条:*安全*。

当我们允许不同的客户访问相同的资源时，一个客户可能会错误地或故意地访问其他客户的数据。没有客户愿意将他们的数据暴露给第三方。

接下来，*资源 Quata vs 完整性*。

我们应该能够适当地限制用户，而不是超出他们的分配。以便一个客户操作不会影响其他客户。因此，我们确实需要一个好的机制来执行它。诚信！！

**我们必须从哪一级开始隔离客户？又是怎么做到的？**

让我们假设一个系统，该系统向客户公开用户界面，以便在云上存储他们的数据。为了服务于用户界面，我们将有两个级别的服务:协调请求的 Kubernetes(k8s)集群和存储客户数据的后端数据库。

那么分离它的所有可能方法是什么呢？

1.  我们可以在数据库级别进行隔离，为每个客户维护单独的数据库，并让一个 k8s 群集访问不同的数据库。这里的挑战是，运行在 k8s 集群上的服务应该能够根据请求源判断连接到哪个数据库。这使得应用服务器代码变得不那么复杂。一些有问题的代码会将一个客户的数据暴露给其他人。
2.  接下来，我们可以在 kubernetes(为每个客户使用单独的集群或者使用不同的名称空间)和数据库级别进行隔离。因此每个名称空间将连接到适当的客户数据库。这里的挑战是，我们应该有丰富的基础架构和良好的自动化脚本，以便在新用户加入时为他们提供资源。

选择我们需要隔离客户访问的方式/级别是一个很好的权衡。您做得越多，风险就越小，但需要更好的基础架构来支持。

希望本文有助于对多租户管理有所了解。

> "教师是一个非常崇高的职业，它塑造了一个人的性格、才能和未来."阿卜杜勒·卡拉姆

感谢马努·马修斯，他激励我们不断学习，以达到更高的水平。
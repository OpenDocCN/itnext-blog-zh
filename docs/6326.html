<html>
<head>
<title>Webpack hooks and ng watch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网袋挂钩和ng手表</h1>
<blockquote>原文：<a href="https://itnext.io/webpack-hooks-and-ng-watch-2822ffb35538?source=collection_archive---------7-----------------------#2021-10-17">https://itnext.io/webpack-hooks-and-ng-watch-2822ffb35538?source=collection_archive---------7-----------------------#2021-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6a3465d317ab59c487ba6804977317ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QygWUpk5O2XkWKvP0F23JQ.jpeg"/></div></div></figure><p id="1123" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">“手表”是我们在开发周期中想当然的东西。随着每个文件的改变或保存，我们的应用程序会自动重建/重新渲染，我们会看到最新的版本。但是有一个问题。构建命令永远不会结束…这很烦人。</p><p id="56b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你以前尝试过:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="7b87" class="lf lg iq lb b gy lh li l lj lk">ng build --watch &amp;&amp; node test.js</span></pre><p id="9041" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我很生气你的test.js从来没有真正运行过，这是因为我们给了ng build一个小小的<em class="ll">手表</em>标志。它告诉angular保持进程并监听所有的文件变化(或者我们告诉它监听的文件类型)。</p><p id="05c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我的用例中，我需要在构建后将一个配置文件添加到dist文件夹，我尝试的任何解决方案(run-all，concurrently，postbuild)都失败了，因为命令之间的时间不匹配。每次保存后都强迫我手动运行。(不是最佳实践)<br/>然后…，当所有希望都破灭时，我发现了这一点:</p><h1 id="ae6c" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">Webpack挂钩。</h1><p id="d40e" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">我们有一个我们不喜欢接触的文件，<strong class="ka ir"><em class="ll">web pack . config . js</em></strong>，它很可怕，我们大多数人都不知道它是如何工作的，它是我们用来创建应用程序的无论什么cli命令给定的。一个真正的“黑匣子”。那么Angular是如何使用webpack.config.js文件的呢？</p><p id="8799" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在项目根目录下的Angular.json文件中，我们可以选择将自定义webpack配置传递给项目文件夹中的每个应用程序/库。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="b2da" class="lf lg iq lb b gy lh li l lj lk">"build": {<br/>  "builder": "@angular-builders/custom-webpack:browser",<br/>  "options": {<br/>    "customWebpackConfig": {<br/>      "path": "./custom-webpack.config.js"<br/>    },</span></pre><p id="34f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Angular编译器将在构建时运行我们给它的配置文件，并把原始的webpack配置传递给它。<br/>这允许我们根据需要扩展或/和覆盖配置(除非我们破坏webpack)。参见下面的例子</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/0dcbfbc826d2db085ec6863ba60ae595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_VPNrirZptb6bhO2-P8pA.png"/></div></div></figure><p id="5189" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个例子中，我向webpack的“done”挂钩添加了一个功能，它在每次完成其周期(在我们的例子中是一个ng构建周期)时运行，可以在这里找到所有可用的webpack挂钩的列表<a class="ae mp" href="https://webpack.js.org/api/compiler-hooks/#hooks" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="0a15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每当webpack完成我的angular项目的重建时，上面示例中的行为将运行"<em class="ll"> npm run add:file" </em>。</p><p id="dda2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这只是用webpack配置可以做什么的一个小例子。我很高兴发现这个调整为我的团队解决了一个真正的问题，并给了我们一个更流畅的开发体验。<br/>不幸和幸运的是，Webpack使用了大量的黑魔法，这是我们尝试和学习了解它的时候了，所以我们可以按照我们想要和需要的方式使用这个强大的工具。</p></div></div>    
</body>
</html>
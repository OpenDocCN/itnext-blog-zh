<html>
<head>
<title>How to trigger Python/Pyspark jobs dynamically using ConfigParser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用ConfigParser动态触发Python/Pyspark作业</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-trigger-python-pyspark-jobs-dynamically-using-configparser-c54b1bd3463e?source=collection_archive---------0-----------------------#2022-06-11">https://itnext.io/how-to-trigger-python-pyspark-jobs-dynamically-using-configparser-c54b1bd3463e?source=collection_archive---------0-----------------------#2022-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2f25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让你的spark工作更灵活的有效方法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/55c0828a3853a3cf7fcafc56b6833688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*KevuxcygSwf77rR_3bannQ.png"/></div></figure><p id="66da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Apache spark提供了大量处理大规模大数据的选项，使其成为大数据和数据工程领域最受欢迎的技能之一。</p><p id="23e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几乎所有的在线教程都向我们展示了如何静态地定义spark会话，并根据用例传递配置值，这是一个很好的学习起点。随着您进入数据领域的旅程，在某个时候您会被要求开发生产级代码。</p><p id="737f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在生产环境中部署代码之前，必须在本地开发并在开发环境中测试。</p><p id="ddb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出于演示的目的，让我们讨论一下spark会话，Spark应用程序的入口点</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi kt"><img src="../Images/3700bfd8a29b14ede4fa474eef475032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wIQ4_NVP9BZwlTl_30eXCA.png"/></div></div></figure><p id="fadc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你的工作有极简的功能性，上面的spark会话是合理的，也是可行的。在开发复杂的ETL作业时，您必须考虑很多因素，比如存储、配置、第三方集成、DQ检查等等。</p><p id="3635" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您想在不同的环境中部署它时，您不能每次都简单地浏览代码并手动重构配置，这将非常耗时，并会导致错误配置，使调试成为一场噩梦。</p><p id="6381" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">理想的解决方案是定义一个python函数/方法来从. conf文件中获取这些配置值，如下所示。我们将利用python configparser库。</p><p id="3055" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的代码是不言自明的，并且有效地实现了期望的功能。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ky"><img src="../Images/5866dfd26d486c6df784de1357b11003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ubYVSMH4VQFN-usiPyUOuA.png"/></div></div></figure><p id="3cf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了获取配置值的方法，现在让我们创建spark会话，并在运行时动态获取这些值。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi kz"><img src="../Images/8fdf5aef519f046178953a81555cc1ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lHnKKf_4qtEM_QFavkjbjQ.png"/></div></div></figure><p id="3265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要在。conf文件如下。configparser库如何工作超出了本文的范围。我建议看一下configparser的官方文档。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi la"><img src="../Images/4ab00660e8992aa2bb5e94fe2585e8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*10gdwnR0Y2a_cYyzPMGiWg.png"/></div></figure><p id="3b11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">get_config特性的好处是我们可以在代码中的任何地方使用它。例如，如果我们想要读取和写入S3详细信息，或者设置标志来触发基于特定标志的方法，我们可以使用这个get_config包装器。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lb"><img src="../Images/508dc3a8789a17c67faaaee1dc9716b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPJDOOeSqxYkMB3Mw2NFZw.png"/></div></div></figure><p id="0cf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有。conf文件看起来像这样，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lc"><img src="../Images/5af8d0fe8f669a26e2699bbe277132a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOBMtY_4b8vM8C-aKeTWJA.png"/></div></div></figure><p id="fcc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论:</strong></p><p id="9f50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">建议避免在代码中对值进行硬编码。这很有效，有助于快速部署，并节省大量调试时间。本教程旨在向您展示我们如何在运行时动态传递配置和值。希望这能对外面的人有用，让他们的日常工作变得简单。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Observability, Part 4 — Node Exporter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可观察性，第4部分—节点导出器</h1>
<blockquote>原文：<a href="https://itnext.io/observability-part-4-node-exporter-a79d9c7e53db?source=collection_archive---------4-----------------------#2022-05-20">https://itnext.io/observability-part-4-node-exporter-a79d9c7e53db?source=collection_archive---------4-----------------------#2022-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/086031d5f4b234d70830da7d61cccda2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPT9bNt0Oqx1utXkMcFqfA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">通过Otel收集器的节点导出器</figcaption></figure><p id="3fe7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">Node Exporter收集有关运行它的设备的指标，包括从CPU到内存/交换到网络流量到磁盘的所有信息，以及两者之间的所有信息。如果您试图确定Linux机器的性能，这是一个很好的方法。还有一个Windows导出器，可以让你从Windows机器上提取相同的数据。</p><h1 id="3185" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">远程设备上的节点导出器</h1><p id="5279" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">我们希望监控部署在核心数据中心之外的许多设备。这些设备利用DHCP，因此设置这些设备的标准普罗米修斯刮擦将是一个管理噩梦！</p><h2 id="8082" class="mg le it bd lf mh mi dn lj mj mk dp ln kq ml mm lr ku mn mo lv ky mp mq lz mr bi translated">利用OpenTelemetry收集器</h2><p id="ed6c" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">Prometheus能够接受来自其他Prometheus实例的远程写入。我们将通过OpenTelemetry (otel)收集器利用这一点。Grafana代理在这里也是一个选项，但是在使用OpenTelemetry Collector完成其他任务之后，它似乎是一个合理的选择！</p><p id="500a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">安装otel收集器非常容易，有一个版本可以支持几乎所有主要的操作系统和linux版本。你可以在<a class="ae ms" href="https://github.com/open-telemetry/opentelemetry-collector-releases/releases" rel="noopener ugc nofollow" target="_blank">项目的GitHub发布页面</a>上找到安装。对于这个讨论，我们使用的是ubuntu机器，所以我抓取了。deb版本的otel collector用wget然后用dpkg安装。</p><p id="742f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">OpenTelemetry Collector支持所有三大支柱可观测性:度量、日志和跟踪；然而，对于我当前的用例，我只对指标感兴趣。正在安装它的机器已经使用fluentd fluentd进行日志记录，并且没有提供跟踪数据，所以可以这样配置。</p><p id="71b4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">要调整配置，您需要编辑/etc/otelcol/config.yaml。因为我们只想收集指标，所以我们可以稍微缩减配置，并为节点导出器添加一个额外的scrape_config。除了scrape_config之外，您还需要将“prometheusremotewrite”部分设置为prometheus服务器的正确IP/URL。下面是我正在使用的配置的副本。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="0565" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">普罗米修斯配置</h1><p id="3760" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">默认情况下，Prometheus没有配置为允许远程写入，但这很容易更改。你只需要用一个标志启动Prometheus来启用它:<em class="mz">—web . enable-remote-write-receiver</em></p><p id="ea20" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">一旦使用该标志启动prometheus，默认情况下，它将启用对/api/v1/write URL的远程写入。当然，如果你愿意，你可以通过prometheus.yml文件来改变它。</p><h1 id="6828" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">Grafana仪表板</h1><p id="f661" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">现在，您可以使用任何节点导出器面板来显示数据。我个人更喜欢<a class="ae ms" href="https://grafana.com/grafana/dashboards/1860" rel="noopener ugc nofollow" target="_blank">节点输出器全</a>。您可以像导入任何其他仪表板一样导入该仪表板，它将自动填充。</p><h1 id="dde6" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">摘要</h1><p id="a9fb" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">这是本系列的最后一部分。我希望您喜欢它，并获得了一两个提示，甚至更好地了解了如何为您的环境增加可观察性。</p><p id="f774" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你喜欢这篇文章或这个系列，请关注这篇文章并为之鼓掌。我很感谢你阅读这篇文章！</p></div></div>    
</body>
</html>
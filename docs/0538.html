<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://itnext.io/how-to-use-webpacker-with-npm-instead-of-yarn-a8a764e3a8ab?source=collection_archive---------4-----------------------#2018-03-27">https://itnext.io/how-to-use-webpacker-with-npm-instead-of-yarn-a8a764e3a8ab?source=collection_archive---------4-----------------------#2018-03-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><p id="044f" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><a class="ae jn" href="https://iamdi.dev/blog/tech/2018-03-27-how-to-use-webpacker-with-npm-instead-of-yarn-rails-guide/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir jo">在我的个人博客中阅读文章的最新版本</strong>。</a></p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jp"><img src="../Images/4ba74a8c7aebd463aae4578f30f5594d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L5Ayw7T_yH3KvT2ZqrWraQ.png"/></div></div></figure><h1 id="61bc" class="kb kc iq bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">如何使用带npm而非纱线、导轨的网络打包机</h1><p id="6c63" class="pw-post-body-paragraph io ip iq ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ij bi translated"><a class="ae jn" href="https://iamdi.dev/blog/tech/2018-03-27-how-to-use-webpacker-with-npm-instead-of-yarn-rails-guide/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir jo">在我的个人博客</strong>中阅读文章的最新版本。</a></p><blockquote class="le lf lg"><p id="737b" class="io ip lh ir b is it iu iv iw ix iy iz li jb jc jd lj jf jg jh lk jj jk jl jm ij bi translated"><a class="ae jn" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fhow-to-use-webpacker-with-npm-instead-of-yarn-a8a764e3a8ab%3Futm_source%3Dmedium_sharelink%26utm_medium%3Dsocial%26utm_campaign%3Dbuffer" rel="noopener ugc nofollow" target="_blank">点击这里在LinkedIn </a>上分享这篇文章</p></blockquote><p id="b17a" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">Webpacker 是一个非常棒的工具，是Rails向前端友好开发环境迈出的一大步。但是打包机要求安装<a class="ae jn" href="https://yarnpkg.com" rel="noopener ugc nofollow" target="_blank">纱线</a>。但是如果想要使用npm呢？</p><p id="7995" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">本文将指导您如何为Webpacker gem使用npm替换Yarn。</p><h1 id="324d" class="kb kc iq bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">准备</h1><p id="f4ea" class="pw-post-body-paragraph io ip iq ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ij bi translated">如果你开始一个全新的Rails应用程序，包括<code class="fe ll lm ln lo b">--skip-yarn</code>选项。</p><pre class="jq jr js jt gt lp lo lq lr aw ls bi"><span id="ae68" class="lt kc iq lo b gy lu lv l lw lx">$ rails new try_webpacker_with_npm_app --webpack --skip-yarn</span></pre><p id="4f88" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">即使启用了<code class="fe ll lm ln lo b">--skip-yarn</code>标志，<code class="fe ll lm ln lo b">rails new</code>命令也会尝试通过Yarn安装npm包。如果您安装了Yarn，那么您需要执行以下步骤，通过Yarm移除webpacker安装。否则，会用<code class="fe ll lm ln lo b">Yarn not installed…</code>警告您，并且不需要更多操作。</p><p id="5237" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">如果你已经开始使用webpacker和Yarn，你必须找到并删除<code class="fe ll lm ln lo b">yarn.lock</code>文件和先前安装的节点模块。</p><pre class="jq jr js jt gt lp lo lq lr aw ls bi"><span id="c5ce" class="lt kc iq lo b gy lu lv l lw lx">$ rm yarn.lock<br/>$ rm -rf node_modules</span></pre><p id="9e03" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">您也可以删除<code class="fe ll lm ln lo b">bin/yarn</code>文件。</p><p id="dfa8" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">请注意，您必须使用webpacker 3.4.1或更高版本以及Ruby on Rails 5.1或更高版本。</p><h1 id="0186" class="kb kc iq bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">更换</h1><p id="a20a" class="pw-post-body-paragraph io ip iq ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ij bi translated">首先，你需要禁用网络打包机和纱线完整性检查。将下面一行添加到开发和生产环境配置文件中。</p><pre class="jq jr js jt gt lp lo lq lr aw ls bi"><span id="9a52" class="lt kc iq lo b gy lu lv l lw lx">config.webpacker.check_yarn_integrity = false</span></pre><p id="2fb0" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">第二步，移除所有与Yarn相关的rake任务，并在Rakefile中定义新的npm任务在<code class="fe ll lm ln lo b">Rails.application.load_tasks</code>行之后。</p><p id="09f8" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">最后一部分。新的npm任务将在<code class="fe ll lm ln lo b">lib/tasks/webpacker.rake</code>文件中。<code class="fe ll lm ln lo b">webpacker:check_npm</code>和<code class="fe ll lm ln lo b">webpacker:npm_install</code>将做与移除的<code class="fe ll lm ln lo b">webpacker:yarn_install</code>和<code class="fe ll lm ln lo b">webpacker:check_yarn tasks</code>相同的工作。</p><p id="5920" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">整个解决方案如下所示:</p><figure class="jq jr js jt gt ju"><div class="bz fp l di"><div class="ly lz l"/></div></figure></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><p id="0860" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">喜欢这篇文章请分享。我很想听听您的意见，以及该解决方案如何为您服务。</p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><p id="e5bd" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">查看其他<a class="ae jn" href="https://medium.com/@shvetsovdm" rel="noopener">文章</a>感谢您阅读这篇文章！👏</p><p id="45bd" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><a class="ae jn" href="https://ctt.ec/xa73I" rel="noopener ugc nofollow" target="_blank">在推特上向我问好</a>🐦</p></div></div>    
</body>
</html>
<html>
<head>
<title>Validate Crossplane Compositions with Datree</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Datree验证交叉平面组合</h1>
<blockquote>原文：<a href="https://itnext.io/validate-crossplane-compositions-with-datree-f52061cdb1b7?source=collection_archive---------2-----------------------#2022-09-04">https://itnext.io/validate-crossplane-compositions-with-datree-f52061cdb1b7?source=collection_archive---------2-----------------------#2022-09-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/35593af300d56619f86ee73ebc306d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kIFdGHvDPai3WxZtt7RL_w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">undraw.co</figcaption></figure><div class=""/><p id="0c0c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你已经熟悉Crossplane，你会从这个博客中受益匪浅。查看我的另一个博客<a class="ae la" rel="noopener ugc nofollow" target="_blank" href="/infrastructure-as-code-the-next-big-shift-is-here-9215f0bda7ce?source=your_stories_page-------------------------------------">基础设施代码:下一个大转变在这里</a>和<a class="ae la" href="https://crossplane.io/" rel="noopener ugc nofollow" target="_blank">交叉平面文档</a>了解更多。</p><p id="61e2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于使用这个<a class="ae la" href="https://killercoda.com/decoder/course/crossplane/crossplane-datree-validation" rel="noopener ugc nofollow" target="_blank">自定进度的杀手科达场景</a>的实际演练。如果你喜欢视觉内容，看看这个配套视频。</p><figure class="lb lc ld le gt is"><div class="bz fp l di"><div class="lf lg l"/></div></figure><h2 id="7734" class="lh li jf bd lj lk ll dn lm ln lo dp lp kn lq lr ls kr lt lu lv kv lw lx ly lz bi translated">验证什么以及为什么要验证</h2><p id="df03" class="pw-post-body-paragraph kc kd jf ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">软件中的测试和验证至关重要，这是一个很好的总结:</p><blockquote class="mf"><p id="0f38" class="mg mh jf bd mi mj mk ml mm mn mo kz dk translated">“我不愿意相信。我想知道。”</p><p id="5ece" class="mg mh jf bd mi mj mk ml mm mn mo kz dk translated">卡尔·萨甘</p></blockquote><p id="1cd1" class="pw-post-body-paragraph kc kd jf ke b kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz ij bi translated">我们希望<strong class="ke jg">确信</strong>我们创建和维护的软件会像预期的那样工作，没有bug和错误。这对于支持Crossplane组合等基础设施的软件来说甚至更为关键。当其他一切都取决于这一层的正确性时，赌注就高了！</p><h2 id="448a" class="lh li jf bd lj lk ll dn lm ln lo dp lp kn lq lr ls kr lt lu lv kv lw lx ly lz bi translated">YAML是一种数据序列化语言</h2><p id="95f9" class="pw-post-body-paragraph kc kd jf ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">作文是在YAML写的。不在Go、C#或任何其他<strong class="ke jg">编程</strong>语言中。虽然这很好地以声明的方式表达了我们需要系统做什么，但是如果没有高级语言工具，很难创建和维护它。</p><p id="7ffb" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最终目标是生成组合，并将YAML作为数据序列化媒介，类似于JSON with REST API。今天已经有一些机制可以做到这一点，请查看Chris的这个库或<a class="ae la" href="https://github.com/crossplane-contrib/crossplane-cdk8s" rel="noopener ugc nofollow" target="_blank"> Crossplane cdk8 </a>。</p><blockquote class="mu mv mw"><p id="377e" class="kc kd mx ke b kf kg kh ki kj kk kl km my ko kp kq mz ks kt ku na kw kx ky kz ij bi translated">在我关于创建Kubernetes YAML文件的博客中了解更多关于cdk8s的信息。</p></blockquote><h2 id="7fdd" class="lh li jf bd lj lk ll dn lm ln lo dp lp kn lq lr ls kr lt lu lv kv lw lx ly lz bi translated">验证级别</h2><p id="1132" class="pw-post-body-paragraph kc kd jf ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">有3个级别的测试/验证，以下是Datree docs的解释和我的评论。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/86f88800dfc9e56e0463a5902dc60eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BluOi2B8zvC5kZ34NVIW-Q.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae la" href="https://hub.datree.io/" rel="noopener ugc nofollow" target="_blank">https://hub.datree.io/</a></figcaption></figure><ol class=""><li id="2bae" class="nc nd jf ke b kf kg kj kk kn ne kr nf kv ng kz nh ni nj nk bi translated"><strong class="ke jg">开发测试循环</strong>有助于尽早发现错误，并且必须非常快，如果它与ide或其他开发工具集成，这是额外的好处。</li><li id="1c30" class="nc nd jf ke b kf nl kj nm kn nn kr no kv np kz nh ni nj nk bi translated">CI/CD管道在每次登记时执行相同的验证</li><li id="293c" class="nc nd jf ke b kf nl kj nm kn nn kr no kv np kz nh ni nj nk bi translated"><strong class="ke jg">运行时</strong>在允许YAML进入kube-api之前，使用Kubernetes准入控制器webhook根据一组策略对其进行验证。</li></ol><h2 id="e5cc" class="lh li jf bd lj lk ll dn lm ln lo dp lp kn lq lr ls kr lt lu lv kv lw lx ly lz bi translated">验证的类型</h2><p id="622f" class="pw-post-body-paragraph kc kd jf ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">说到作文，我们对两种类型的验证感兴趣。</p><ul class=""><li id="c28b" class="nc nd jf ke b kf kg kj kk kn ne kr nf kv ng kz nq ni nj nk bi translated">根据XRD进行模式验证</li><li id="8c24" class="nc nd jf ke b kf nl kj nm kn nn kr no kv np kz nq ni nj nk bi translated">自定义策略验证</li></ul><p id="62ff" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Custom policies validation is testing if a composition complies with an arbitrary set of custom rules such as naming convention, required fields otherwise not specified in the schema, or cascading dependencies.</p><blockquote class="mu mv mw"><p id="8da4" class="kc kd mx ke b kf kg kh ki kj kk kl km my ko kp kq mz ks kt ku na kw kx ky kz ij bi translated">For schema validation and testing composition YAML file correctness against build-in rules, you can use a <a class="ae la" href="https://marketplace.visualstudio.com/items?itemName=Upboundio.upbound" rel="noopener ugc nofollow" target="_blank"> VS代码插件</a>(也可以作为LSP与vim/nvim一起工作)。</p></blockquote></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><h1 id="4222" class="ny li jf bd lj nz oa ob lm oc od oe lp of og oh ls oi oj ok lv ol om on ly oo bi translated">演示设置</h1><p id="e141" class="pw-post-body-paragraph kc kd jf ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">互动演示可在<a class="ae la" href="https://killercoda.com/decoder/course/crossplane/crossplane-datree-validation" rel="noopener ugc nofollow" target="_blank">https://killer corda . com/decoder/course/cross plane/cross plane-datree-validation</a>获得，这里有几个亮点，以免重复整个设置。</p><p id="af41" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">“Datree”中的自定义策略表示为基于JSON模式的文档。因为这是JSON模式，所以它在YAML自动可用。我们将与YAML政策合作。</p><p id="415f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是您将在交互式场景中使用的自定义策略。</p><figure class="lb lc ld le gt is"><div class="bz fp l di"><div class="op lg l"/></div></figure><h2 id="2233" class="lh li jf bd lj lk ll dn lm ln lo dp lp kn lq lr ls kr lt lu lv kv lw lx ly lz bi translated">结论</h2><p id="81c9" class="pw-post-body-paragraph kc kd jf ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">DevOps移动和更具体的“左移”，将基础设施置于开发团队的责任之下，但也将软件实践带入了Ops领域。</p><p id="665f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">自动化测试和验证是一项非常重要的实践，深深植根于软件开发世界，平台团队或DevOps实践者正在适应这一点。</p></div></div>    
</body>
</html>
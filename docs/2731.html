<html>
<head>
<title>Creating A Blazing-Fast Gatsby App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个超快的盖茨比应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/creating-a-blazing-fast-gatsby-app-5ccbc9bef377?source=collection_archive---------7-----------------------#2019-07-22">https://itnext.io/creating-a-blazing-fast-gatsby-app-5ccbc9bef377?source=collection_archive---------7-----------------------#2019-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5bae2a10760f52259f7f1248af631e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fkapdl_ysN9ZJzoeGBx2vw.png"/></div></div></figure><div class=""/><div class=""><h2 id="e255" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">从头开始创建一个使用API数据的概述</h2></div><p id="1a08" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">Gatsby是一个速度极快的静态站点生成器。这是一个基于React的开源框架，可用于构建网站和应用。在本文中，我将一步一步地向您展示如何使用Gatsby构建一个应用程序。我将使用一个API为我们的应用程序提供数据。我们将要使用的API是<a class="ae lp" href="https://randomapi.com/" rel="noopener ugc nofollow" target="_blank"> RandomAPI </a>，它提供随机数据。我们将创建一个概述，列出我们将从API获取的数据。</p><h2 id="7da5" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">先决条件</h2><p id="6bef" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">我假设您已经安装了Node.js和npm。注意，Gatsby支持的最低Node.js版本是Node 8。要检查Node.js版本，您可以打开一个终端并输入命令<code class="fe mo mp mq mr b">node -v</code>。</p><p id="4ef2" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在我们开始之前，你最不需要的就是Git。建立您的第一个Gatsby站点需要Git。在安装Gatsby starter站点时，Gatsby在后台使用Git来下载和安装您的starter所需的文件。如果你还没有安装Git，请访问这个网站。</p><h2 id="9ba7" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">安装盖茨比</h2><p id="b6bd" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">现在您已经具备了所有的先决条件，我们实际上可以从安装Gatsby开始。要全局安装Gatsby，请使用以下命令:</p><p id="a6a9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><code class="fe mo mp mq mr b">npm install -g gatsby-cli</code></p><p id="0bec" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">安装完Gatsby后，我们可以创建一个新项目。您可以随意命名您的项目。通过执行以下命令可以做到这一点。</p><p id="e599" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><code class="fe mo mp mq mr b">gatsby new <em class="ms">projectname</em></code></p><p id="209a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">请注意，该命令将为您的项目创建一个文件夹。</p><h2 id="0dfe" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">查看项目文件夹</h2><p id="0281" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">让我们进入项目文件夹，看看Gatsby已经安装了什么。你可以使用<code class="fe mo mp mq mr b">cd <em class="ms">projectname</em></code> <em class="ms"> </em>命令来完成。</p><p id="57f4" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">要启动并运行一切，你可以使用<code class="fe mo mp mq mr b">gatsby develop</code>命令。这将编译您的代码并启动一个服务器。您可以在<a class="ae lp" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8000/ </a>查看您的网站。</p><p id="dec8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如您所见，Gatsby生成了starter网站。</p><figure class="mu mv mw mx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/fe6de00ce7836063b0de3cf22183f8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9neHHJEARUh8e65f7cdLYw.png"/></div></div></figure><p id="1044" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">让我们看一下代码。该项目包含四个文件夹:</p><ul class=""><li id="db05" class="my mz je kv b kw kx kz la lc na lg nb lk nc lo nd ne nf ng bi translated"><em class="ms">。缓存</em> <br/>这个文件夹是Gatsby自动创建的内部缓存。此文件夹中的文件不允许修改。</li><li id="c6bf" class="my mz je kv b kw nh kz ni lc nj lg nk lk nl lo nd ne nf ng bi translated"><em class="ms"> node_modules </em> <br/>这里是安装所有模块和包的地方。</li><li id="b91d" class="my mz je kv b kw nh kz ni lc nj lg nk lk nl lo nd ne nf ng bi translated"><em class="ms">公共</em> <br/>这就是静态网站产生的地方。这个目录将包含所有与你将在网站前端看到的内容相关的代码。</li><li id="b02b" class="my mz je kv b kw nh kz ni lc nj lg nk lk nl lo nd ne nf ng bi translated">这是所有代码的所在地。Src的意思是源代码。</li></ul><p id="be24" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在项目根文件夹中也有很多文件，但是目前唯一相关的文件是<em class="ms"> gatsby-config.js </em>。这是Gatsby站点的主要配置文件。这个文件包含一些关于网站的元数据，以及项目中使用的插件。默认安装了一些插件。</p><p id="7d1d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">由于我们将创建一个概述来列出我们从API中检索的所有用户，我将把站点标题改为<em class="ms">用户列表</em>。您可以通过更改<em class="ms"> siteMetadata </em>对象中的<em class="ms"> title </em>属性来实现这一点。</p><figure class="mu mv mw mx gt iv gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0c95cf7bea235c20f729a6d50ad65d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*sx2QQZ5RccoDQcRzU9JGYg.png"/></div></figure><p id="0d6e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">现在切换回您的网站，注意页面会自动刷新。这是因为Gatsby的开发环境具有热重装功能。</p><h2 id="328c" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">src文件夹</h2><p id="75c2" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">如前所述，src文件夹是代码所在的地方。该文件夹有三个子文件夹:</p><ul class=""><li id="73b1" class="my mz je kv b kw kx kz la lc na lg nb lk nc lo nd ne nf ng bi translated"><em class="ms">组件</em> <br/>这个文件夹包含了所有可以用来构建页面的组件。</li><li id="3af1" class="my mz je kv b kw nh kz ni lc nj lg nk lk nl lo nd ne nf ng bi translated"><em class="ms">图片</em> <br/>所有的图片都存储在这个文件夹中。</li><li id="e7a2" class="my mz je kv b kw nh kz ni lc nj lg nk lk nl lo nd ne nf ng bi translated"><em class="ms">页面</em> <br/>该文件夹中的组件自动变成页面，路径基于其文件名。</li></ul><h1 id="e915" class="nn lr je bd ls no np nq lv nr ns nt ly kk nu kl mb kn nv ko me kq nw kr mh nx bi translated">编码时间到了</h1><p id="0b14" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">为了从API获取数据，我们将创建一个源代码插件。源插件将远程或本地位置的数据“源”到节点中。</p><blockquote class="ny"><p id="91cd" class="nz oa je bd ob oc od oe of og oh lo dk translated">源插件将来自任何源的数据转换成Gatsby可以处理的格式。</p></blockquote><p id="90bc" class="pw-post-body-paragraph kt ku je kv b kw oi kf ky kz oj ki lb lc ok le lf lg ol li lj lk om lm ln lo im bi translated">你可以使用现有的插件，也可以自己创建一个，这就是我们将要做的。</p><h2 id="a447" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">创建插件</h2><p id="ecb1" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">自定义插件放在<em class="ms">插件</em>文件夹中。我们必须创建该文件夹，因为它不是默认创建的。创建文件夹后，移动到文件夹中。</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="d182" class="lq lr je mr b gy or os l ot ou">mkdir plugins<br/>cd plugins</span></pre><p id="bfa7" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">插件的基本要素是一个以你的插件命名的目录，其中包含一个<em class="ms"> package.json </em>文件和一个<em class="ms"> gatsby-node.js </em>文件。</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="7c7d" class="lq lr je mr b gy or os l ot ou">|-- plugins<br/>    |-- gatsby-source-randomapi<br/>        |-- gatsby-node.js<br/>        |-- package.json</span></pre><p id="6ec8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们的插件将被称为<em class="ms">Gatsby-source-random API</em>。创建文件夹并移入该文件夹。</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="4110" class="lq lr je mr b gy or os l ot ou">mkdir gatsby-source-randomapi<br/>cd gatsby-source-randomapi</span></pre><p id="3960" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">接下来，我们创建一个<em class="ms"> package.json </em>文件，它描述了你的插件和它可能依赖的任何第三方代码。Npm有一个命令可以为您创建这个文件。</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="0b3d" class="lq lr je mr b gy or os l ot ou">npm init --yes</span></pre><p id="bf07" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在<em class="ms"> package.json </em>文件被创建后，我们将安装一个插件需要从API获取数据的包:</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="493e" class="lq lr je mr b gy or os l ot ou">npm install node-fetch --save</span></pre><p id="66fd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们需要创建的最后一个文件是<em class="ms"> gatsby-node.js </em>。该文件将包含从API检索数据的所有逻辑。</p><h2 id="74dc" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">添加插件</h2><p id="0003" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">要开始在您的项目中使用这个插件，您必须将它添加到<em class="ms"> gatsby-config.js </em>文件中的<em class="ms">插件</em>数组中。将以下对象添加到<em class="ms">插件</em>数组中:</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="555c" class="lq lr je mr b gy or os l ot ou">{<br/>  resolve: `gatsby-source-randomapi`,<br/>  options: {<br/>    endpoint: `6de6abfedb24f889e0b5f675edc50deb`,<br/>  },<br/>},</span></pre><p id="1f82" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">注意，我添加了一个包含端点的<em class="ms">选项</em>对象。我这样做是为了让您可以轻松地替换掉RandomAPI端点。在本例中，我们将使用的端点是<a class="ae lp" href="https://randomapi.com/api/6de6abfedb24f889e0b5f675edc50deb" rel="noopener ugc nofollow" target="_blank">https://randomapi.com/api/6de6abfedb24f889e0b5f675edc50deb</a>。</p><h2 id="c4f5" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">获取数据</h2><p id="f045" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">要开始从API获取数据，请将以下代码粘贴到您的<em class="ms"> gatsby-node.js </em>文件中。</p><p id="3417" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这段代码使用了我们之前安装的节点获取包。在第9行，我们将Gatsby配置中的端点变量存储到一个变量中。第10行构建了我们将要调用的完整API URL。</p><p id="a7b2" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在这个例子中，我们遍历从API检索的结果，并在控制台中记录每个用户的数据。</p><figure class="mu mv mw mx gt iv"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="2dfe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">您可以通过在项目的根目录下打开一个新的终端并执行<code class="fe mo mp mq mr b">gatsby develop</code>命令来测试这段代码。如果一切正常，您将看到如下内容:</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="5d92" class="lq lr je mr b gy or os l ot ou">[ <br/>  { first: 'Moriah',<br/>    last: 'Kautzer',<br/>    email: '<a class="ae lp" href="mailto:Moriah.Kautzer@yoshiko.biz" rel="noopener ugc nofollow" target="_blank">Moriah.Kautzer@yoshiko.biz</a>',<br/>    address: '017 Langosh Lodge',<br/>    created: 'January 11, 2011',<br/>    balance: '$6,009.47' },<br/>  { first: 'Rolando',<br/>    last: 'Buckridge',<br/>    email: '<a class="ae lp" href="mailto:Rolando.Buckridge@ryan.biz" rel="noopener ugc nofollow" target="_blank">Rolando.Buckridge@ryan.biz</a>',<br/>    address: '414 Heathcote Ways',<br/>    created: 'January 16, 2012',<br/>    balance: '$9,526.45' },<br/>  { first: 'Tianna',<br/>    last: 'McCullough',<br/>    email: '<a class="ae lp" href="mailto:bluerabbit83@gmail.com" rel="noopener ugc nofollow" target="_blank">bluerabbit83@gmail.com</a>',<br/>    address: '25435 Lynch Glens',<br/>    created: 'March 1, 2015',<br/>    balance: '$5,941.26' },<br/>    <br/>    .... <br/>]</span></pre><p id="a96c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于API响应，我们唯一要做的事情就是创建节点。在下面的例子中，我添加了一个助手函数，名为<em class="ms"> processUser </em>，它返回一个节点对象。然后使用<em class="ms"> createNode </em>函数创建这个节点对象。</p><figure class="mu mv mw mx gt iv"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="966e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在更新了<em class="ms"> gatsby-node.js </em>代码之后，再次运行<em class="ms"> gatsby develop </em>命令，并转到<a class="ae lp" href="http://localhost:8000/___graphql" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/_ _ _ graph QL</a>来检查节点是否被正确存储。</p><p id="56ae" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">执行以下查询:</p><pre class="mu mv mw mx gt on mr oo op aw oq bi"><span id="d820" class="lq lr je mr b gy or os l ot ou">query MyQuery {<br/>  randomApiUser {<br/>    internal {<br/>      content<br/>    }<br/>  }<br/>}</span></pre><p id="baeb" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果您已经正确地设置了一切，这个查询将返回用户对象的JSON数据。</p><h2 id="d9d0" class="lq lr je bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">构建概述</h2><p id="9691" class="pw-post-body-paragraph kt ku je kv b kw mj kf ky kz mk ki lb lc ml le lf lg mm li lj lk mn lm ln lo im bi translated">为了构建概述，我们需要在<em class="ms">组件</em>文件夹中创建一个新组件，名为<em class="ms"> overview.js </em>。该组件将创建一个无序列表，显示每个用户的名和姓。</p><figure class="mu mv mw mx gt iv"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="d33b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">因为我们想在主页上显示概述，我们必须将组件添加到<em class="ms"> pages </em>文件夹中的<em class="ms"> index.js </em>文件中。我们刚刚创建的概述被添加到第10行。</p><figure class="mu mv mw mx gt iv"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="b622" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">现在我们已经准备好了一切，是时候检查最终结果了。</p><figure class="mu mv mw mx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/d82de4cc5110a5258b86eff6bc8e5014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vu1aCodu56NmYPEwFpcHcw.png"/></div></div></figure></div><div class="ab cl oy oz hx pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="im in io ip iq"><p id="7549" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">就是这样！您已经成功地创建了一个Gatsby应用程序，它从一个API获取数据并将结果放入一个概览中。如果您有任何反馈、问题或希望我写另一个与编程相关的主题，请随时留下您的评论。</p><p id="ef36" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">感谢阅读！</p></div></div>    
</body>
</html>
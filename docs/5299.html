<html>
<head>
<title>SuperEdge, OpenYurt — Extending Native Kubernetes to Edge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SuperEdge，OpenYurt —将本地Kubernetes扩展到Edge</h1>
<blockquote>原文：<a href="https://itnext.io/superedge-openyurt-extending-native-kubernetes-to-edge-cc59094f92c?source=collection_archive---------4-----------------------#2021-02-04">https://itnext.io/superedge-openyurt-extending-native-kubernetes-to-edge-cc59094f92c?source=collection_archive---------4-----------------------#2021-02-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/6f25af77d62122c655c46cda8f430d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*labLQp70gBrilfIWDzoZ7Q.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">将云原生功能扩展到边缘—云边缘隧道、边缘自治、应用群管理</figcaption></figure><div class=""/><p id="233b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">企业需要一个强大的管理层来有效管理提供动态编排和自动化的边缘流程。然而，整个边缘架构由不同的硬件和软件资源组成。edge生态系统包含分布在多个地区的异构硬件，并根据需求进行定位。据领先的全球研究和咨询组织称，边缘体系结构具有分层结构。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi la"><img src="../Images/bf45aedef8f038962e5cb3965b42b2eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*54u9ImT0R0kbVoZH"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Gartner和IDC —边缘拓扑结构</figcaption></figure><p id="3e9f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">无论层次结构中的硬件是什么，Kubernetes都可以提供一个竞争激烈的基础架构，能够无缝管理在不同计算资源上运行的各种工作负载，提供一组可以集中管理但在边缘环境中执行的通用服务。Kubernetes可以编排和调度资源，因为它们从云反弹到边缘，反之亦然。</p><p id="5c2f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有效的边缘计算模型应该解决延迟和带宽的限制，使用统一的管理系统部署到异构环境，设备群管理，边缘站点的网络自治等。设计集中管理的边缘拓扑有相当大的复杂性:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lf"><img src="../Images/dba4e556074b7e055c6e71d81f3427c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pXkJCy-yCnC2GzBd"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">边缘—复杂性</figcaption></figure><p id="651a" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">带有特定工具的Kubernetes可以有效地解决大多数问题。将边缘节点作为Kubernetes节点进行管理，而不是在每个站点托管一个具有控制平面的成熟集群，这提供了一些优势，如通过仅部署工作组件来最小化边缘站点资源，不必使用任何其他联合机制来集中控制边缘站点，以与本地Kubernetes节点相同的方式控制边缘站点等。但是，使用当前的上游设计(每个节点上的Kubelet将在内存中缓存信息)将节点移动到边缘有很大的局限性，并且主要依赖于节点和托管在不稳定的公共互联网上的云上的主节点之间的连接。</p><p id="d3f0" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae lg" href="https://openyurt.io/en-us/" rel="noopener ugc nofollow" target="_blank"> OpenYurt </a>(阿里巴巴第一个面向边缘计算的开源云原生项目，CNCF <a class="ae lg" href="https://www.cncf.io/sandbox-projects/" rel="noopener ugc nofollow" target="_blank">沙盒项目</a>)和<a class="ae lg" href="https://github.com/superedge/superedge" rel="noopener ugc nofollow" target="_blank"> SuperEdge </a>(由腾讯与英特尔、VMware、虎牙、Cambricon、Captialonline和美团牵头)是两个基于原生Kubernetes构建的同源项目，旨在通过将云原生能力扩展到边缘端来无缝支持边缘计算。简而言之，使用户能够管理在边缘基础架构中运行的应用，就像它们在云基础架构中运行一样。这两个项目都为云边缘隧道、边缘自治、智能和统一应用管理、大规模应用交付等提供了必要的控制器、组件和定制资源。</p><h1 id="7984" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">操作和维护隧道</h1><blockquote class="mf mg mh"><p id="97cf" class="kc kd mi ke b kf kg kh ki kj kk kl km mj ko kp kq mk ks kt ku ml kw kx ky kz ij bi translated"><strong class="ke jg">云上的kube-apiserver和边缘上的kubelet之间的隧道</strong></p></blockquote><p id="b73b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在应用部署、运行和维护的过程中，用户经常需要获取应用日志或者直接登录正在运行的应用进行调试。这通常涉及ku bectl——日志、执行、编辑、修补、获取、描述操作。</p><p id="8831" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从控制平面(apiserver)到节点有两条主要的通信路径。第一个是从apiserver到在集群中每个节点上运行的kubelet进程。第二种是通过apiserver的代理功能从apiserver到任何节点、pod或服务。在kubectl请求的一般设置中，kubelet将作为服务器端，负责处理kube-apiserver (KAS)转发的请求，这需要KAS和kubelet之间的网络路径，以允许KAS主动访问kubelet。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mm"><img src="../Images/3d185d105586f213d6ae7a734c3ea897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RNa2FyvBX_QgqsYW"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">kube-API server-kube let通信</figcaption></figure><p id="3d1d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然而，在边缘节点场景中，边缘节点通常位于本地专用网络中。尽管这确保了边缘节点的安全性，但这可能会给位于云控制节点中的KAS直接访问位于边缘节点的kubelet带来问题。因此，为了支持来自云节点的边缘应用的操作和维护，请求必须被代理到边缘节点，以解决云不能直接访问边缘节点的问题。</p><h1 id="9ed2" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">露天蒙古包—蒙古包隧道</h1><p id="995c" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated"><a class="ae lg" href="https://github.com/alibaba/openyurt/blob/master/docs/tutorial/yurt-tunnel.md" rel="noopener ugc nofollow" target="_blank"> Yurt-tunnel </a>由云中的<a class="ae lg" href="https://pkg.go.dev/github.com/alibaba/openyurt@v0.0.0-20200917165522-b447d2ebcca1/cmd/yurt-tunnel-server?tab=overview" rel="noopener ugc nofollow" target="_blank"> TunnelServer </a>和运行在各个边缘节点上的<a class="ae lg" href="https://pkg.go.dev/github.com/alibaba/openyurt@v0.0.0-20201022001436-cdc6acf7c8ec/cmd/yurt-tunnel-agent" rel="noopener ugc nofollow" target="_blank"> TunnelAgent </a>组成。TunnelServer通过反向代理与运行在各个边缘节点的TunnelAgent守护进程建立连接，在公有云的控制平面和边缘节点之间建立安全的网络访问。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ms"><img src="../Images/190d1844139795d6dbcc0393a142dae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONXosQeIQ2WLYDY0JhpGxw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">露天蒙古包—蒙古包隧道</figcaption></figure><p id="7d41" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Yurt-tunnel使用上游项目<a class="ae lg" href="https://github.com/kubernetes-sigs/apiserver-network-proxy" rel="noopener ugc nofollow" target="_blank">API server-network-proxy(ANP</a>)来实现服务器和代理之间的通信。ANP是1.16中的alpha特性，用来寻址<a class="ae lg" href="https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/apiserver/pkg/server/egressselector/egress_selector.go" rel="noopener ugc nofollow" target="_blank"> EgressSelector </a>，旨在实现Kubernetes集群组件的跨内网通信(例如主组件位于控制VPC，其他组件如kubelet位于用户VPC)。ANP的一个核心设计思想是使用gRPC封装KAS的所有外部HTTP请求。这里选择gRPC主要是因为它支持流和清晰的接口规范。此外，强类型客户端和服务器可以有效地减少运行时错误并提高系统稳定性。</p><p id="995d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">与原生TCP连接相比，ANP不仅可以提供更高的传输稳定性，还可以大大减少公共网络流量。考虑到边缘集群中数万个节点的规模。</p><h1 id="91c7" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">超级边缘— TunnelCloud和TunnelEdge</h1><p id="9912" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">SuperEdge支持自建隧道(目前支持TCP、HTTP、HTTPS)，解决不同网络环境下的云边缘连接问题。隧道由<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/docs/components/tunnel.md" rel="noopener ugc nofollow" target="_blank">隧道-云</a>和<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/docs/components/tunnel.md" rel="noopener ugc nofollow" target="_blank">隧道-边缘</a>组成，能够保持持久的云-边缘网络连接。SuperEdge使用<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/pkg/edgeadm/constant/manifests/tunnel-coredns.go" rel="noopener ugc nofollow" target="_blank"> tunnel-dns </a> (coredns)组件将发往边缘节点的特定请求转发给tunnel-cloud服务。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/5bf1e9766e3c19dcbd968d450c3c3d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FOxEBqSROd23053x"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—隧道边缘和隧道云</figcaption></figure><p id="7499" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">tunnel-cloud负责维护与边缘节点tunnel-edge的网络隧道，tunnel-edge负责建立与cloud edge集群tunnel-cloud的网络隧道，接受API请求，并转发给边缘节点组件(kubelet)。</p><p id="ee06" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦tunnel-edge与tunnel-cloud建立grpc连接，tunnel-cloud会将其podIp和tunnel-edge所在节点的nodeName的映射写入DNS。如果grpc连接断开，tunnel-cloud将从映射中删除podIp和节点名称。当APIServer或其他云应用访问kubelet或边缘节点上的其他应用时，tunnel-dns通过dns劫持将请求转发到tunnel-cloud Pod(通过用tunnel-coredns的集群Ip替换kube-API server的DNS名称服务器，将主机中的节点名称解析为tunnel-cloud的podIp)。</p><h1 id="80ac" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">边缘节点自治</h1><blockquote class="mf mg mh"><p id="1314" class="kc kd mi ke b kf kg kh ki kj kk kl km mj ko kp kq mk ks kt ku ml kw kx ky kz ij bi translated"><strong class="ke jg">在网络断开和其他中断情况下处理边缘节点上的服务(本地自治)</strong></p></blockquote><p id="2ed4" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在Kubernetes扩展到边缘计算场景中，边缘节点将通过公网和云端连接到控制平面。考虑到公网的不稳定性和成本等因素，边缘要求边缘业务能够在断开状态或弱网状态下继续运行。</p><p id="537e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在传统的Kubernetes系统架构中，代理(kubelet)中的容器信息保存在内存中。当网络断开时，无法从云中获取业务数据。如果节点或kubelet重新启动，服务容器将无法恢复。Kubernetes的节点生命周期控制器根据节点的租约和节点状态更新时间决定是否驱逐节点上的pod或设置taint，并将节点就绪状态设置为unknown。</p><p id="030f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">需要边缘节点中的代理连续轮询云主机上的KAS，并在节点上本地缓存信息，其中在网络中断的情况下，该代理可以用作影子apiserver，这还使得边缘节点上的pod能够从代理检索信息，而不是到达控制平面，这显著减少了公共网络上的往返。</p><p id="1988" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当节点被标记为未就绪或未知时，与启用自治的节点相比，通常的流程如下:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/39bef30f3df79414f56f218b55dfc81b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JsPN3U5TDCkK2asf"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">节点管理和自治</figcaption></figure><h1 id="20ba" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">OpenYurt — YurtHub</h1><p id="901a" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated"><a class="ae lg" href="https://www.alibabacloud.com/blog/deep-dive-into-openyurt-yurthub-extended-capabilities_597190" rel="noopener ugc nofollow" target="_blank"> YurtHub </a>是一个具有数据缓存功能的透明网关，边缘节点上的kubelet通过YurtHub与云端通信。它充当节点上的临时配置中心，在网络连接中断时，继续为节点上的所有设备和客户服务提供数据配置服务。</p><p id="74d1" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">YurtHub提供了对大量原生Kubernetes API的支持，并可以在节点和边缘单元的维度上提供“影子Apiserver”能力，这在网络链路较弱的边缘计算场景中尤其有价值。当到云的网络连接被断开并且节点或kubelet被重启时，服务容器的数据被从YurtHub获得以确保边缘自治。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/d32552526c666d755c6dec121cdd467e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*agCfsGaeu1brZkqM"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt — YurtHub</figcaption></figure><p id="7e72" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">YurtHub与其他资源一起将网络配置资源(如服务)缓存在本地存储中，通过提供网络中断前对象的状态和配置信息，使服务在本地访问时不受影响。当YurtHub接管边缘节点和云之间的流量时，它也可以接管节点证书管理。</p><p id="34b2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">YurtHub可以从系统组件和服务容器接管云访问流量，并在云上实现基于节点的节流。在这种情况下，当单个节点对云的并发请求数超过250时，YurtHub会拒绝新的请求。</p><p id="6ea2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae lg" href="https://www.alibabacloud.com/blog/introducing-main-feature-of-openyurt-local-autonomy_596322" rel="noopener ugc nofollow" target="_blank"> Yurt-controller-manager </a>组件为不同的边缘计算用例提供了节点控制器、单元控制器(待发布)等少量控制器。用户可以用“【openyurt.io/autonomy:】真”标记边缘节点，其中<em class="mi"> </em>处于自治模式的节点中的pod将不会被逐出API服务器，即使节点心跳丢失(从控制平面断开)。nodelifecycleController 组件管理自治并控制分离舱的驱逐。</p><h1 id="326a" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">超级— lite-apiserver</h1><p id="3833" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated"><a class="ae lg" href="https://github.com/superedge/superedge/blob/main/docs/components/lite-apiserver.md" rel="noopener ugc nofollow" target="_blank"> lite-apiserver </a>是运行在边缘节点上的kube-apiserver的轻量级版本。它充当从边缘节点上的所有组件和pod到云apiserver的请求的代理，lite-apiserver的请求缓存控制器缓存响应，以在云-边缘网络断开的情况下实现边缘自治。边缘节点上的Kubelet通过lite-apiserver与云端通信。</p><p id="d3f4" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">超级边缘提供L3级边缘自治。当边缘节点不稳定或与云网络断开连接时，边缘节点仍然可以正常运行，不会影响已经部署的边缘服务。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/b8204dc0b39b5d607a4387c31e899bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*00bOSgbcVjroGzG_"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级— Lite-Apiserver</figcaption></figure><p id="2b3b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">SuperEdge提供<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/docs/components/edge-health.md" rel="noopener ugc nofollow" target="_blank">端到端分布式健康检查</a>能力。每个边缘节点都将部署一个边缘健康代理。同一边缘群集中的边缘节点将对彼此执行健康检查，并对节点的状态进行投票。这样，即使云边缘网络出现问题，只要边缘节点之间的连接正常，节点就不会被驱逐。每个边缘节点默认运行<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/docs/components/edge-health.md" rel="noopener ugc nofollow" target="_blank"> edge-health </a>，并引入分布式健康检查，实现对每个节点组的独立健康检查，允许每个节点检测和监控同一组内的节点，消除不稳定的云到边缘网络造成的误报。</p><p id="a10c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">整个设计避免了云侧网络不稳定导致的迁移和重建，保证了边缘站点服务的稳定性。</p><h1 id="433e" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">跨异构边缘节点的应用群管理</h1><blockquote class="mf mg mh"><p id="b51c" class="kc kd mi ke b kf kg kh ki kj kk kl km mj ko kp kq mk ks kt ku ml kw kx ky kz ij bi translated"><strong class="ke jg">智能和拓扑感知的应用程序调度和维护</strong></p></blockquote><p id="a0a0" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在边缘场景中，工作者节点的分布相对分散。同一物理位置可能只有一个工作节点，也可能有多个工作节点。边缘节点通常具有区域性、地带性、硬件特定性或其他逻辑分组特征(例如相同的CPU架构、相同的运营商、云提供商)。</p><p id="b59d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从边缘节点的角度来看，需要将节点分成不同的组/池，以表示同一组功能。这种分组可以通过Kubernetes添加相同标签、注释和污点的本地方式来实现。OpenYurt和SuperEdge都提供了一个健壮的应用程序群管理系统，用户可以添加一个逻辑来根据需求将应用程序部署到特定的站点。</p><h1 id="948f" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">超级边缘—应用网格控制器</h1><p id="c532" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated"><a class="ae lg" href="https://github.com/superedge/superedge/blob/main/pkg/application-grid-controller/controller/service/controller.go" rel="noopener ugc nofollow" target="_blank">应用网格控制器</a>负责管理构成<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/pkg/application-grid-controller/controller/common/deploymentgrid-crd.go" rel="noopener ugc nofollow" target="_blank">部署网格</a>和<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/pkg/application-grid-controller/controller/common/servicegrid-crd.go" rel="noopener ugc nofollow" target="_blank">服务网格</a>的服务组，这两个服务网格是由SuperEdge实现的，用于管理跨边缘节点的应用部署。</p><p id="484d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">SuperEdge使用户能够使用节点单元和节点组将节点隔离到一个池中，其中节点单元是根据标签区分节点的基本对象，节点组可以将多个节点单元分组。这些节点组在ServiceGroup中使用，它提供了两个CR:部署网格和服务网格。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/507cb31bc49d03df5dfdff305ca6c818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G4wZRA55gKg2u8Ye"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级—应用程序管理</figcaption></figure><p id="ee24" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ServiceGroup提供的部署网格(deployment-grid)和服务网格(service-grid)可用于部署和管理边缘应用，控制服务流程，确保每个区域的服务数量和灾难恢复。</p><p id="f248" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">DeploymentGrid的格式类似于部署的格式。“&lt; deployment template &gt;”字段是Kubernetes原始部署对象的模板字段，具体增加的是<em class="mi">gridunikke</em>y字段，表示上面创建的节点组标签的键值。例如，如果用户使用' region:us-** '创建一个节点组，那么gridUniqKey的值将是region。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi my"><img src="../Images/4498d495493cca7b647755005efdd0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5ow751IsvnyBuWyV"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—部署网格和服务网格</figcaption></figure><p id="1687" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ServiceGrid的格式类似于服务的格式。‘&lt; service template &gt;’字段是Kubernetes原始服务的模板字段。在ServiceGrid规范中，可以使用<em class="mi">gridunikke</em>y将特定的节点组分组为服务下的端点。例如，如果用户选择键的值为“region ”,那么服务端点仅构成部署在由区域标签区分的特定节点组中的pod。当服务尝试使用ServiceGrid从节点组中的特定节点创建的服务的ClusterIP访问应用程序时，流量将仅分发到同一节点组中的端点。</p><p id="dc3e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ServiceGrid使用户能够创建本地域，避免跨区域访问服务，控制对特定服务的访问，控制连接阈值，还便于更轻松地发布和管理边缘集群服务。</p><p id="e2ac" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果在部署完DeploymentGrid和ServiceGrid资源后，有新的NodeUnit添加到集群中，系统将自动为新的NodeUnit创建相应的部署和服务。</p><h1 id="eee5" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">open Yurt-Yurt-App-Manager</h1><p id="8f0f" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">Yurt-App-Manager是Kubernetes的标准扩展。它可以与Kubernetes结合使用，提供两个定制资源:<a class="ae lg" href="https://github.com/alibaba/openyurt/blob/54daca0801a8f645c2832390076fac5e0bb70455/pkg/yurtappmanager/client/clientset/versioned/typed/apps/v1alpha1/nodepool.go" rel="noopener ugc nofollow" target="_blank"> NodePool </a>和<a class="ae lg" href="https://github.com/alibaba/openyurt/blob/54daca0801a8f645c2832390076fac5e0bb70455/pkg/yurtappmanager/client/clientset/versioned/typed/apps/v1alpha1/uniteddeployment.go" rel="noopener ugc nofollow" target="_blank"> UnitedDeployment </a>。</p><p id="9505" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">节点池是一个池、一个组或一个节点单元。使用标签对主机进行分类和管理，将具有相同属性的工作节点分组。节点池根据不同边缘区域的相似标签对节点进行分组。当一个节点被添加到节点池时，它继承了节点池规范中定义的注释、标签和污点，并且将添加一个标记'<em class="mi">apps.openyurt.io/nodepool:&lt;节点池名称&gt; ' </em>。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/70f6e4e048787581588d3a8bf93c215f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HB6e8zY3HlMuNjGa"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —节点池</figcaption></figure><p id="4a20" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">UnitedDeployment控制器提供了一个模板来定义应用程序，并根据节点池标签匹配不同的区域。每个UnitedDeployment下每个区域中的工作负载称为池。目前，池支持两种类型的工作负载:状态设置和部署工作负载。控制器基于UnitedDeployment的池配置创建子工作负载资源对象。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/f5293ce20c35ebb7ced6a58a2a7131eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dm1wxtiaBZ-ahNrO"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —统一部署</figcaption></figure><p id="7d03" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">UnitedDeployment使k8s本机部署、Statefulset和Daemonset资源能够根据指定的节点池进行智能部署。通过UnitedDeployment实例，可以自动维护多个部署或状态集资源，并且它还可以具有不同的配置，如副本。用户可以对特定的UD对象规范进行更改，以管理跨多个边缘站点的应用程序配置，而无需更改多个传统部署或状态集对象。</p><h1 id="50ff" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">试验</h1><h1 id="9186" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">集群拓扑</h1><p id="e148" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">该拓扑包括一个运行在具有public_ip的公共云提供商上的主节点和三个连接到家庭网络(私有)的边缘节点(udoo-x86板)。SuperEdge和OpenYurt使用相同的集群，因为它们都是本地Kubernetes扩展，用户可以通过拆除控制平面和边缘组件来重新使用集群。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/922e579063ebfb4fd560a1d6904a9553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rGg79vbLvmg48mNj"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">公共云大师</figcaption></figure><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/103238be6733f6bd35220eb2af382a43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VRYt3wH_396pypUW"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">私有边缘上的节点和云主节点</figcaption></figure><p id="662d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如下图所示，public-cloud-master在public_ip上服务Kubernetes apiserver，所有边缘节点都在私有网络中。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/1a8300e7719b66ee77df8baa84cade60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uSBS1FV_aQySD5wv"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">专用网络上的节点和公共网络上的主节点</figcaption></figure><h1 id="2998" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">OpenYurt</h1><p id="473d" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">OpenYurt在云端和边缘的组件如下图所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/4b1cbebb006cc865293125f51a918c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8s0dT4z082iqKvuc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —建筑</figcaption></figure><p id="b2c6" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">用户可以使用<a class="ae lg" href="https://github.com/alibaba/openyurt/blob/master/cmd/yurtctl/yurtctl.go" rel="noopener ugc nofollow" target="_blank"> Yurtctl </a>，这是一个集中的安装和管理工具，可以快速地将任何Kubernetes集群转换为支持OpenYurt的集群(或者可以手动安装所有组件)。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ef9e6bca260a8f4585911df34d1fa5a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/0*MK4sZ9ALBI-2gxgn"/></div></figure><p id="a2b9" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">OpenYurt依靠一个节点标签'【openyurt.io/is-edge-worker】T4'来安装组件。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/886abf3cc81548b94c1673d42637edae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Iw7NeMm6OTN_vFys"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —标识边缘节点的节点标签</figcaption></figure><p id="185d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">控制器管理器、应用管理器和隧道服务器部署在云上，所有边缘节点都部署有隧道代理和YurtHub。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/7cb0371a6b556aa6c1e06329c44bbfaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*myAE80_Qn6fE6Ej6"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —隧道服务器和隧道代理</figcaption></figure><p id="2cc2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公共云主机上的隧道服务器服务作为节点端口公开，以实现与边缘节点上所有隧道代理的连接。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/20f7d66e5d89d0364094086ff0727e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7_1g7UTgp5Vt7PRo"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">open yurt-TunnelServer服务-节点端口</figcaption></figure><p id="a727" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">显示节点信息的示例应用程序部署在一个边缘节点上。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/6ed97b35e49c592fe12caf3fd7173b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2xlBEiYzk_YiaiIc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">边缘节点上的示例应用程序</figcaption></figure><p id="5c2a" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">可以使用Service:ClusterIP从本地网络访问该服务，如下所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/d64f844a69d8a05f49b6694694bf63bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DMVm_L7KTW9aaUtx"/></div></div></figure><p id="ec13" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">由于在边缘节点上还没有安装OpenYurt组件(没有隧道代理)，当从cloud master访问时，像exec和logs这样的Kubectl操作会失败。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/b0fd519edb06fae543f5b8d121d47af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*99VEx1X_Ew6UFoDr"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">失败—访问边缘节点上的应用程序</figcaption></figure><p id="26d2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦节点被标注了OpenYurt所需的标签，隧道代理就被安装在边缘节点上。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/d0ced2b6eff51a5a8dcb8342ada62ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0gfsGU1P_79ww0IJ"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —隧道</figcaption></figure><p id="f5dc" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">云主机上的隧道服务器接受并批准来自验证证书身份的边缘节点上的隧道代理的隧道。用户可以为反向代理连接生成特定的证书，也可以使用apiserver和kubelet证书。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/df02856ed4545b68f41ce48e73d0ebec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fPEcPmDI4YpOu8ZR"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —隧道服务器</figcaption></figure><p id="1559" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦隧道代理成功连接到云主机上的隧道服务器，就可以从云主机上执行对边缘节点对象的所有Kubectl管理操作，其中边缘节点位于完全隔离的专用网络中。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/c5302aff7da0a3a4dc9ec7c55800a146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WUjY0rRal2Ubqjkc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">通过隧道访问边缘节点上的应用</figcaption></figure><p id="caa0" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">边缘节点部署有YurtHub组件，该组件持续缓存来自云主机的集群状态信息。所有从库伯莱到KAS的通信都将通过该枢纽转发。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/856e2924cfe47172e508b77b1eef1703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yIIsYAEr_Yr2qhOm"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">边缘节点上的YurtHub</figcaption></figure><p id="8079" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">云主机上的yurt-controller-manager维护已注册节点的列表，还通过OpenYurt CRD管理与自治和应用程序管理相关的其他功能。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/7d7c568ae3752227b58edbb89df8df82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZIRb9Xi3lEM3MFsw"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">云主机上的蒙古包-控制器-管理器</figcaption></figure><p id="07de" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">OpenYurt在集群中安装两个定制资源:NodePool和UnitedDeployment，用于应用程序部署和管理。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/25bbc3a9c4113c224810824e82d2e9ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UDM2dpG0eLLTUf7W"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">CRD—open yurt应用管理</figcaption></figure><p id="aeb8" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">创建节点池资源，其中节点池使用标签“apps-pool-r”对节点进行分组。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/4ef25016b80518493af175f0d81a7179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E3WuC_6ssB6dKp38"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —节点池</figcaption></figure><p id="1363" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要分组到节点池下的节点可以通过标记节点添加到池中。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/9b9f5e5b0886e71f37415076643f45a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y78_swQ2IYeexnca"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —节点池—节点标签</figcaption></figure><p id="c533" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">节点池CR的状态部分显示了属于池的所有节点，如下所示。在示例配置中，节点池仅包括边缘节点1和边缘节点3。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/60ab6e68efd08bb04d5b194f4f4d35af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h75GYhxiBGl-2Npk"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —节点池</figcaption></figure><p id="2a40" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">云主机上的yurt-app-manager维护集群中创建的所有节点池和联合部署的信息，并管理资源。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/47454c7811a9fd6b3a8399d1acc49193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kYBKaUmg9D6sMvjE"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —云主机上的Yurt-App-Manager</figcaption></figure><p id="3378" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用workloadTemplate创建UnitedDeployment资源，以便在上面创建的节点池上部署一个示例Nginx应用程序，如下所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/baaaf732f92cbd0fcf6c829b46d0049e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i7unICjU3rUyAbkY"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —统一部署</figcaption></figure><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/a5b887c5807c01dffb69ee93640e873a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OQZjZiptexnBiUrj"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —统一部署控制器</figcaption></figure><p id="671c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">UD创建所需的Kubernetes部署，并将pod放置在节点上，这些节点是上面节点池的一部分。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/1f04ac6ba862620cdc3900f9fc024fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V-UVYWOuJXc-kk-M"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —统一部署</figcaption></figure><p id="d6b3" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如下所示，pod(副本:3)仅放置在边缘节点-1和边缘节点-3上，它们是“<em class="mi">节点池:应用池-r </em>”的一部分。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/f32d21126f68dbd5fd4da3d91276aed5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ehMZnoY474DFj2o9"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —统一部署</figcaption></figure><p id="2ffa" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">UD资源创建的所有部署都可以使用UD进行集中管理，例如编辑UD对象中的副本数量和映像，如下所示。这同样适用于由UD创建的部署的所有吊舱部分。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/195fc8db25f936fc98d6386ab0c62f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XwFO1ogiP208voJf"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —统一部署</figcaption></figure><p id="8b63" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">网络中断场景是通过断开边缘节点3来创建的，如下所示，当节点转换到未就绪状态时，应用荚没有被驱逐，边缘节点中的YurtHub组件继续提供必要的网络信息，使得服务对于本地网络中的应用/用户可用。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/bb0a0511e67d9188841d7c7bd4cbc189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j89q2Js2CnFYOzGz"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">OpenYurt —边缘节点自治</figcaption></figure><h1 id="be77" class="lh li jf bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">超边缘</h1><p id="f8eb" class="pw-post-body-paragraph kc kd jf ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">云边和云边上的SuperEdge的组件如下图所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nl"><img src="../Images/9d04295c3f32860ebddef5ace7e73421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fsxwWITCnE9M0AYc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边缘——建筑</figcaption></figure><p id="0052" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">可以使用<a class="ae lg" href="https://github.com/superedge/superedge/blob/main/docs/installation/install_via_edgeadm.md" rel="noopener ugc nofollow" target="_blank"> edgeadm </a> CLI提供SuperEdge(先决条件是使用Kubeadm引导集群),或者用户可以手动生成所需的证书并使用清单部署组件。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/4c79ffedce677b95c5ea180d546007b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z4plzPI9NVt2VRn4"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边—组件</figcaption></figure><p id="a83c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">SuperEdge在所有边缘节点上部署tunnel-edge，在云主节点上部署tunnel-cloud。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/1dce073f8250610bb58efb2aad912d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-rL9Onyshk4heazA"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—隧道边缘和隧道云</figcaption></figure><p id="536d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安全连接将用于隧道、tunnel-edge-conf和tunnel-cloud-conf配置映射保存配置和证书信息。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/5e0077d3cc9b7f7b6fd64e4cc15325b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zxJVIeQ5u80TMEZG"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—隧道边缘和隧道云</figcaption></figure><p id="bb3c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Kubelet和apiserver针对隧道边缘和隧道云的认证:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/67592a222abe6a6801b6e1e847e7c8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jfkC2KlW6JvmEHyu"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">TunnelEdge和TunnelCloud证书</figcaption></figure><p id="13e9" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">其他配置映射包括tunnel-coredns配置，它用于将代理从kube-apiserver隧道传输到边缘节点。隧道节点配置包括所有注册的边缘节点，隧道云使用这些节点来跟踪和管理隧道边缘站点的连接性。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/14a7c4dc58c64f6ee060f608f778bc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rTM_J1EPIT5HYxEh"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边缘-隧道-核心dns</figcaption></figure><p id="557a" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当隧道建立后，部署在边缘节点上的应用程序可以使用Kubectl操作进行管理，如下所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/51f22158935b3f2ee6632c5ed15ee8eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SZf4E0Y2mEUyAygh"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边缘—访问边缘节点上的应用程序</figcaption></figure><p id="7923" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">SuperEdge安装了两个定制资源:用于应用程序部署和管理的DeploymentGrid和ServiceGrid。这两种资源都是命名空间范围的。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/bffceee5de0483778edcf77c1c346cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0G7lNGBynZXGOlt4"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级CRD的应用管理</figcaption></figure><p id="284c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了测试应用程序管理功能，节点1和节点2标有“<em class="mi">地区1:美国西部</em>”，节点3标有“<em class="mi">地区1:美国东部</em>”。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nm"><img src="../Images/5d67df374aaa948ca5a9c100d46ffd41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DXHcVKWpk5Fs0PzY"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边-节点标签</figcaption></figure><p id="e8af" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">示例<em class="mi"> </em> DeploymentGrid资源中的<em class="mi"> gridUniqKey </em>被映射到上面节点标签中使用的键“region1”。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/d18c6edf023a5319ea8c5734ff3ee651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EwOuXfoqJ8-PK4De"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—部署网格</figcaption></figure><p id="3952" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">DeploymentGrid创建一个Kubernetes部署，每个区域有两个副本，如下所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/7fd6b12a83bfadccf30e1877803a6917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5K5lJl-5BypQ4dt_"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—部署网格</figcaption></figure><p id="1a80" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用相同的<em class="mi"> gridUniqKey:region1 </em>创建一个示例ServiceGrid资源，如下所示。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/bf2151599bc81b5ce2ac22d6e3e7ea9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KFz6SQznHN8f19n5"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—服务网格</figcaption></figure><p id="b72e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ServiceGrid创建了一个Kubernetes服务对象，它映射了在两个区域(3个节点)中运行的所有四个pods(端点)。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/9760aa09ee5d7a00b94e773fe35fa8ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tznhILtyxJfWh1Ba"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—服务网格</figcaption></figure><p id="9bc6" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当使用来自边缘节点1或边缘节点2的集群IP访问服务时，请求仅由“区域:美国西部”中的pod(节点组中节点1和节点2上的pod)提供服务，类似地，来自边缘节点3的流量将仅由“区域:美国东部”中的pod提供服务。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/5fba115349445d0bab14823cc7955aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VZxsAHrqbsgEnEJA"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超级边缘—服务网格</figcaption></figure><p id="14d4" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">网络中断场景是通过断开边缘节点2而创建的，如下所示，当节点转换到NotReady状态时，应用荚没有被驱逐，边缘节点中的lite-apiserver组件继续提供必要的网络信息，使得服务对于本地网络中的应用/用户可用。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/aaf38b3cef9cad7a28e732290c267b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d5E1YQ3fIYmYMdn_"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边——边节点自治</figcaption></figure><p id="a2da" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">默认情况下，edge-health在每个边缘节点上运行，以准确确定边缘节点的实际运行状态和边缘准入:通过提供来自分布在所有边缘工作节点上的边缘健康服务的实时健康检查状态来帮助Kubernetes控制器识别节点的真实状态。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/754fb329df4f32813daf17432bed8341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0nEPdSaJoecqIscm"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">超边——边节点自治</figcaption></figure></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><p id="4001" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae lg" href="https://gokulchandrapr.medium.com/kubeedge-extending-kubernetes-to-edge-dcfedd91f5f9" rel="noopener"><strong class="ke jg">【KubeEdge】</strong></a><strong class="ke jg">，</strong>最初来自华为——CNCF主持的第一个基于Kubernetes的边缘计算项目，与上述项目也有重叠的特点，主要区别在于这些项目是Kubernetes原生的，不会侵入Kubernetes源代码，所以理论上不需要考虑与Kubernetes版本和生态的兼容性。除了特定于边缘的功能，这些项目还提供了边缘自治和拓扑感知的应用管理功能。</p><p id="5e91" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Gartner预测，到2025年，超过75%的企业生成数据将在数据中心或云之外创建和处理。这些项目可以极大地解决大量的edge用例，并支持Kubernetes在edge中的使用。这些项目仍处于开发模式，来自社区的贡献可以极大地提高采用和使用。</p></div></div>    
</body>
</html>
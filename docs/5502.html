<html>
<head>
<title>Opsgenie: integration with AWS RDS and alerting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Opsgenie:与AWS RDS和警报集成</h1>
<blockquote>原文：<a href="https://itnext.io/opsgenie-integration-with-aws-rds-and-alerting-68fe614ee5d7?source=collection_archive---------2-----------------------#2021-03-18">https://itnext.io/opsgenie-integration-with-aws-rds-and-alerting-68fe614ee5d7?source=collection_archive---------2-----------------------#2021-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/3e50a200dd3181b57c40bbb845ef5247.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/0*4BLJSUxAqi8HQ1vh.png"/></div></figure><p id="3349" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们用AWS RDS配置Opsgenie。</p><p id="944f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个想法是从RDS获得关于事件的通知，并将它们发送到Opsgenie，ops genie将它们发送到我们的Slack。</p><p id="ab3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为此，我们需要配置<a class="ae ks" href="https://aws.amazon.com/sns/?whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;whats-new-cards.sort-order=desc" rel="noopener ugc nofollow" target="_blank"> AWS简单通知服务</a>和<a class="ae ks" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html" rel="noopener ugc nofollow" target="_blank"> AWS RDS事件订阅</a>。</p><p id="ce60" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">官方文档是<a class="ae ks" href="https://docs.opsgenie.com/docs/amazon-rds-integration" rel="noopener ugc nofollow" target="_blank">这里&gt; &gt; &gt; </a>。</p><h1 id="c5a7" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">Opsgenie配置</h1><p id="c130" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">转到<em class="lw">集成列表</em>，找到AWS RDS，激活它:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/6e1c69770512300152d1de4ba67a8415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/0*vwO3cg7cloCIc0nu.png"/></div></figure><p id="2f9f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存“添加HTTPS订阅”字段中的URL，并转到您的AWS帐户。</p><h1 id="4551" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">AWS配置</h1><h2 id="1aab" class="mc ku iq bd kv md me dn kz mf mg dp ld kf mh mi lh kj mj mk ll kn ml mm lp mn bi translated">创建AWS SNS</h2><p id="3155" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">这里的文档是<a class="ae ks" href="https://docs.aws.amazon.com/sns/latest/dg/sns-getting-started.html" rel="noopener ugc nofollow" target="_blank">&gt;&gt;&gt;</a>。</p><p id="2dd0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">转到AWS SNS，使用<em class="lw">standard</em>类型创建一个新主题:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/6581ef2ea054434d1a08b531f993ec59.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/0*oSWXRsDqOK6yMPBL.png"/></div></figure><p id="729f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">点击<em class="lw">创建订阅</em>:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/4409b42dffb14ab327145415199da8a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jyGxNXCDUl4w7sLS.png"/></div></div></figure><p id="9fa9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">创建HTTPS类型的订阅，在<em class="lw">端点</em>中指定在激活AWS RDS集成期间创建的Opsgenie的URL:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mu"><img src="../Images/927327bf1b7ea766048f104b74069055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pAJIPsAYjOnHJXnj.png"/></div></div></figure><p id="56d4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在Opsgenie警报中，您必须收到测试通知:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mv"><img src="../Images/193906f514202393205748b029ff1401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P-0E0_Ijs6CsW0To.png"/></div></div></figure><p id="8782" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存并转到RDS。</p><h2 id="69f5" class="mc ku iq bd kv md me dn kz mf mg dp ld kf mh mi lh kj mj mk ll kn ml mm lp mn bi translated">RDS事件订阅配置</h2><p id="caf1" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">这里的文档是<a class="ae ks" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html" rel="noopener ugc nofollow" target="_blank">&gt;&gt;&gt;</a>。</p><p id="5f86" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里，您必须决定您感兴趣的活动，以获得通知，请参见<a class="ae ks" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html#USER_Events.Messages" rel="noopener ugc nofollow" target="_blank"> Amazon RDS活动类别和活动消息</a>页面上的列表。</p><p id="5dac" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，您还可以查看<a class="ae ks" href="https://console.aws.amazon.com/rds/home?region=us-east-1#event-list:" rel="noopener ugc nofollow" target="_blank">事件</a>中已经发生的事件。</p><p id="e0b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">例如，让我们得到关于<em class="lw">实例的通知:可用性、创建、故障转移、失败、维护、通知、读取副本、恢复</em>。</p><p id="c0d3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">点击<em class="lw">创建事件订阅</em>:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mw"><img src="../Images/58b6570ae37718f783da9b7d7720c6aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-DMCBugQXmzHQtS_.png"/></div></div></figure><p id="5913" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">配置字段:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mx"><img src="../Images/6297f41ecc2896f1959fec4f0a1df588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sSNU4EeFwKZ4rjTH.png"/></div></div></figure><p id="1d38" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">省省吧。</p><p id="8a35" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要检查一切是否正常，请重新启动实例:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi my"><img src="../Images/e3462d4d40602ae184ed07433dac900a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*70RyuELb7wnv1eOF.png"/></div></div></figure><p id="eb25" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查RDS事件:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mz"><img src="../Images/63c5301cd732c08e2462dd0d202b0686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KmbfWTmP3UE3PiCJ.png"/></div></div></figure><p id="1d47" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和Opsgenie警报:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi na"><img src="../Images/f815d8157f19f730c79c0c23f329c09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pmlZOHFfgFnfaGPG.png"/></div></div></figure><h2 id="0ab6" class="mc ku iq bd kv md me dn kz mf mg dp ld kf mh mi lh kj mj mk ll kn ml mm lp mn bi translated">高级设置</h2><p id="af34" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">在Opsgenie集成中，您可以点击<em class="lw">高级</em>进行附加配置。</p><p id="e241" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">例如，在这里您可以设置一个规则，如果<code class="fe nb nc nd ne b">sourceId</code>字段包含一个“<em class="lw"> prod </em>”字符串，那么必须创建一个具有<em class="lw">关键</em>优先级的警报:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nf"><img src="../Images/b2878947027af9f454bed0de49e51ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9T0C5EIQDyr-rM8U.png"/></div></div></figure><p id="a632" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们的团队配置中，关键警报不仅会发送给Slack，而且Opsgenie bot会呼叫工程师。</p><p id="ec5e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成了。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="5c1a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lw">最初发布于</em> <a class="ae ks" href="https://rtfm.co.ua/en/opsgenie-integration-with-aws-rds-and-alerting/" rel="noopener ugc nofollow" target="_blank"> <em class="lw"> RTFM: Linux、DevOps、系统管理</em> </a> <em class="lw">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Big Data Quality Assurance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大数据质量保证</h1>
<blockquote>原文：<a href="https://itnext.io/big-data-quality-assurance-635c368a3e28?source=collection_archive---------3-----------------------#2020-09-11">https://itnext.io/big-data-quality-assurance-635c368a3e28?source=collection_archive---------3-----------------------#2020-09-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d331f22df1de1004c505e021cb3097ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P94VhN9KEJ5cKcP8"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">米卡·鲍梅斯特在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="a921" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="5bad" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">本文摘自我的文章<a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/big-data-pipeline-recipe-c416c1782908"> <strong class="lg iu">大数据管道秘方</strong> </a>。在这篇短文中，我将尝试总结适用于您的数据管道的数据质量工具。</p><p id="0361" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="mh">您会在没有测试或代码审查的情况下将代码提交给产品吗？那么，为什么公司不测试他们的数据资产就建立管道呢？</em></p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="1778" class="kg kh it bd ki kj mp kl km kn mq kp kq kr mr kt ku kv ms kx ky kz mt lb lc ld bi translated">数据质量</h1><p id="29d6" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">大数据中一个经常被忽视的重要方面是<strong class="lg iu">数据质量和保证</strong>。由于数据质量问题，公司每年都会损失大量资金。问题是，这在数据科学中仍然是一个不成熟的领域，开发人员已经在这个领域工作了几十年，他们有很好的测试框架和方法，如<a class="ae kf" href="https://en.wikipedia.org/wiki/Behavior-driven_development" rel="noopener ugc nofollow" target="_blank"> BDD </a>或<a class="ae kf" href="https://en.wikipedia.org/wiki/Test-driven_development" rel="noopener ugc nofollow" target="_blank"> TDD </a>，但是你如何测试你的管道呢？</p><p id="9bdd" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这一领域有两个常见问题:</p><ul class=""><li id="8154" class="mu mv it lg b lh mc ll md lp mw lt mx lx my mb mz na nb nc bi translated"><strong class="lg iu">被误解的需求</strong>:转换和编排逻辑经常会变得非常复杂。业务分析师可能使用他们的领域语言编写需求，这些需求需要由经常犯错的开发人员进行解释，并计划、开发、测试和部署技术上正确但需求错误的解决方案。这类错误代价很高。</li><li id="8f3d" class="mu mv it lg b lh nd ll ne lp nf lt ng lx nh mb mz na nb nc bi translated"><strong class="lg iu">数据验证</strong>:流水线测试与代码大不相同。当开发软件时，你测试功能，这是黑盒测试，确定性的。对于给定的输入，你总是得到相同的输出。对于数据资产，测试更加复杂:您需要断言数据类型、值、约束等等。而且，您需要应用聚合来验证数据集，以确保行数或列数是正确的。例如，很难检测某一天数据量是否减少了10%,或者某些值是否被正确填充。</li></ul><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/079b05aadc81853a1a417c750673f66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WNQdFgVnON-AFtaA"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">维多利亚诺·伊斯基耶多在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="cf58" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">公司在数据质量和测试方面仍处于起步阶段</strong>，这造成了<strong class="lg iu">巨大的技术债务</strong>。我真的推荐查看这篇<a class="ae kf" href="https://medium.com/@expectgreatdata/down-with-pipeline-debt-introducing-great-expectations-862ddc46782a" rel="noopener"> <strong class="lg iu">文章</strong> </a>以获得更多关于管道债务的信息。</p><p id="1453" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了缓解这个问题，请尝试遵循<a class="ae kf" href="https://en.wikipedia.org/wiki/Domain-driven_design" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> DDD </strong> </a>原则，并确保设定界限和使用通用语言。使用支持数据<strong class="lg iu">血统</strong>的框架，如<strong class="lg iu"> NiFi </strong>或<strong class="lg iu"> Dagster </strong>。</p><h1 id="64e0" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">工具</h1><p id="ebdf" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">一些专注于数据质量的工具有:</p><h2 id="481e" class="nn kh it bd ki no np dn km nq nr dp kq lp ns nt ku lt nu nv ky lx nw nx lc ny bi translated"><a class="ae kf" href="https://griffin.apache.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">阿帕奇格里芬</strong> </a></h2><p id="df6e" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">作为<strong class="lg iu"> Hadoop </strong>生态系统的一部分，该工具提供了一个统一的流程来从不同角度衡量您的数据质量，帮助您构建可信的数据资产。它提供了一个<strong class="lg iu"> DSL </strong>，您可以使用它来为您的数据创建断言，并作为您的管道的一部分来验证它们。与<strong class="lg iu">火花</strong>为一体。您可以为您的数据集添加规则和断言，然后作为Spark作业运行验证。Griffin的问题是，DSL可能变得难以管理，非技术人员很难理解，这意味着它不能解决被误解的需求问题。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/063e2f31dade55450f35499ffb7fd5cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z14WLdo6s7Xs0IYg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">阿帕奇格里芬进程</figcaption></figure><p id="1807" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然而，Griffin是一个简单而强大的解决方案，可以整合到您当前的Spark数据管道中。很容易实现自动化并添加到您现有的工作中，而无需改变您的操作方式。</p><p id="04f6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Griffin中的示例规则:</p><pre class="nj nk nl nm gt oa ob oc od aw oe bi"><span id="64fa" class="nn kh it ob b gy of og l oh oi">"rules": [<br/>      {<br/>        "dsl.type": "griffin-dsl",<br/>        "dq.type": "accuracy",<br/>        "out.dataframe.name": "accu",<br/>        "rule": "<strong class="ob iu">src.id = tgt.id AND src.age = tgt.age AND src.desc = tgt.desc</strong>",<br/>        "details": {<br/>          "source": "src",<br/>          "target": "tgt",<br/>          "miss": "miss_count",<br/>          "total": "total_count",<br/>          "matched": "matched_count"<br/>        },<br/>        "out": [<br/>          {<br/>            "type": "metric",<br/>            "name": "accu"<br/>          },<br/>          {<br/>            "type": "record",<br/>            "name": "missRecords"<br/>          }<br/>        ]<br/>      }<br/>    ]</span></pre><h2 id="1e6f" class="nn kh it bd ki no np dn km nq nr dp kq lp ns nt ku lt nu nv ky lx nw nx lc ny bi translated"><a class="ae kf" href="https://greatexpectations.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">远大前程</strong> </a></h2><p id="a24b" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是一个用<strong class="lg iu"> Python </strong>编写的新工具，专注于数据质量、管道测试和质量保证。它可以轻松地与Airflow或其他编排工具集成，并提供自动化的数据验证。让这个工具与众不同的是，它是人类可读的，可以被数据分析师、BAs和开发人员使用。</p><p id="39b5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">它提供了一个直观的UI，而且是完全自动化的，因此您可以将验证作为生产流水线的一部分运行，并在一个漂亮的<strong class="lg iu"> UI </strong>中查看结果。这些断言可以由非技术人员使用<a class="ae kf" href="https://jupyter.org/try" rel="noopener ugc nofollow" target="_blank">笔记本</a>编写，这些笔记本提供了开发人员易于理解、翻译成代码并用于测试的文档和正式需求。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/8e12a87d1e8d94170b5b4a5a0ad448a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*wfRnGPzd4-bvpivk.gif"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">远大前程UI</figcaption></figure><p id="4acc" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">BAs或测试人员编写数据断言(<a class="ae kf" href="https://docs.greatexpectations.io/en/latest/reference/glossary_of_expectations.html" rel="noopener ugc nofollow" target="_blank">期望</a>)，这些断言在UI中被转换成人类可读的测试，这样每个人都可以看到并验证它们。它还可以进行数据分析，为您生成一些断言。这些是用Python写的期望的一些例子:</p><pre class="nj nk nl nm gt oa ob oc od aw oe bi"><span id="e19b" class="nn kh it ob b gy of og l oh oi">expect_table_row_count_to_equal(100)</span><span id="4aca" class="nn kh it ob b gy ok og l oh oi">expect_column_values_to_be_between(<br/>    column="percent_agree",<br/>    min_value=10,<br/>    max_value=90,<br/>)</span></pre><p id="3c1a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">有许多期望可供选择，您可以创造自己的期望:</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ol"><img src="../Images/6d4c3f3e7995957bb718192b0aa3559c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Kl97vs8LZwsljOcr.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">你可以设定的一些期望</figcaption></figure><p id="9298" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">它可以直接连接到本地或云中的数据库或文件系统。它非常易于使用和管理。</p><p id="b8e5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">期望可以提交到源代码存储库中，然后集成到您的管道中。<strong class="lg iu"> Great Expectations为参与数据质量的所有各方创造了一个通用语言和框架</strong>，使得自动化和测试您的管道变得非常容易<strong class="lg iu">。</strong></p><p id="bf47" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果您的团队已经熟悉Python，这是一个很好的选择，并且很容易采用。这将给你的团队带来很多信心，并使测试和监控更加容易。</p><h1 id="5fb8" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="5e10" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="lg iu">不要等到灾难发生后才认真对待数据质量</strong>。了解您的数据，理解其流动方式、转换、审核更改并验证每一步。确保在产品负责人、BAs和开发人员之间使用共同的语言，这样就不会在翻译中丢失任何东西。</p><p id="dc93" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果你是一个严重依赖Spark的Scala团队，那么<strong class="lg iu"> Griffin </strong>会更容易被采用。如果你已经在使用<a class="ae kf" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">气流</strong> </a>和/或<strong class="lg iu">蟒蛇</strong>，那么<strong class="lg iu">远大前程</strong>将是你工具带的一个合理补充。</p><p id="0759" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">尽可能使用自动化来避免手工测试，使用与软件开发相同的原则。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="9796" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我希望你喜欢这篇文章。欢迎发表评论或分享这篇文章。跟随<a class="ae kf" href="https://twitter.com/JavierRamosRod" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu"><em class="mh">me</em></strong></a><strong class="lg iu"><em class="mh"/></strong><em class="mh">进行未来岗位。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to slow down promises in javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何减缓javascript中的承诺</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-slow-down-promises-in-javascript-8236f468c3f1?source=collection_archive---------0-----------------------#2018-05-07">https://itnext.io/how-to-slow-down-promises-in-javascript-8236f468c3f1?source=collection_archive---------0-----------------------#2018-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div class="gh gi io"><img src="../Images/f47a568c2d10e3a9e4be945bc135263e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*6rg5U_QQ5G8y-Sqbmq_8yQ.jpeg"/></div></figure><div class=""/><p id="a025" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您必须遍历数组并对数组中的每个对象发出web请求，您可以这样做:</p><figure class="ks kt ku kv gt is"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="f287" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">问题是，如果您的阵列有许多成员，所有这些请求将同时到达服务器。所以，我们需要找到一些方法，不要同时运行所有的东西。</p><p id="3c96" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另外一个问题是，承诺从产生的那一刻起就开始执行。</p><p id="651f" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">是时候开始寻找解决方案了:</p><p id="3f06" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先出现是<a class="ae ky" href="https://www.npmjs.com/package/es6-promise-pool" rel="noopener ugc nofollow" target="_blank"> es6-promise-pool </a>，但是这个库看起来很落后，而且在示例中太复杂了(我需要编写promise producer)</p><p id="05bb" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">他们还推荐了几个其他的库:</p><ul class=""><li id="575d" class="kz la ix jw b jx jy kb kc kf lb kj lc kn ld kr le lf lg lh bi translated"><a class="ae ky" href="https://github.com/vilic/promise-pool" rel="noopener ugc nofollow" target="_blank">承诺池</a> —老得要命，自2015年以来没有更新</li><li id="e40f" class="kz la ix jw b jx li kb lj kf lk kj ll kn lm kr le lf lg lh bi translated">Bluebird's Promise.map() —我使用本地承诺已经有一段时间了</li><li id="bb37" class="kz la ix jw b jx li kb lj kf lk kj ll kn lm kr le lf lg lh bi translated"><a class="ae ky" href="https://github.com/bevacqua/contra#%CE%BBconcurrenttasks-cap-done" rel="noopener ugc nofollow" target="_blank"> contra的concurrent()函数</a> —两年前的最后一次提交，不支持承诺，而是使用回调。</li><li id="7092" class="kz la ix jw b jx li kb lj kf lk kj ll kn lm kr le lf lg lh bi translated"><a class="ae ky" href="https://github.com/kriskowal/q" rel="noopener ugc nofollow" target="_blank">Q</a>with<a class="ae ky" href="https://github.com/suprememoocow/qlimit" rel="noopener ugc nofollow" target="_blank">Q limit</a>—Q limit实际上是Q的插件，现在我需要两个可互操作的库，而且插件4年没更新了，那就很多了。</li><li id="a184" class="kz la ix jw b jx li kb lj kf lk kj ll kn lm kr le lf lg lh bi translated">async with<a class="ae ky" href="https://github.com/caolan/async#queueworker-concurrency" rel="noopener ugc nofollow" target="_blank">queue</a>()function——这个维护良好的库，但是queue function的例子是用回调完成的，这已经过时了。</li></ul><h1 id="8d22" class="ln lo ix bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">救援的极限</h1><p id="f92f" class="pw-post-body-paragraph ju jv ix jw b jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr ij bi translated"><a class="ae ky" href="https://github.com/sindresorhus/p-limit" rel="noopener ugc nofollow" target="_blank"> p-limit </a>是一个非常简单的库，使用起来非常简单:</p><figure class="ks kt ku kv gt is"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="3cca" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，我们的请求按照我们想要的速度执行，因为我们可以将并发性设置为我们想要的任何数量。我增加了进度条作为奖励。</p><p id="b0ed" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">作者不仅创建了p-limit，还创建了一整套<a class="ae ky" href="https://github.com/sindresorhus/promise-fun" rel="noopener ugc nofollow" target="_blank">有用的promise helper函数</a>。</p></div></div>    
</body>
</html>
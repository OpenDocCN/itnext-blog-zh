<html>
<head>
<title>Vue.js and Webpack 4 From Scratch, Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue.js和Webpack 4，第2部分</h1>
<blockquote>原文：<a href="https://itnext.io/vue-js-and-webpack-4-from-scratch-part-2-5038cc9deffb?source=collection_archive---------0-----------------------#2018-03-18">https://itnext.io/vue-js-and-webpack-4-from-scratch-part-2-5038cc9deffb?source=collection_archive---------0-----------------------#2018-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f40f871f01c25ff851984736f60df4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TODhOOKZIjarrlYV."/></div></div></figure><blockquote class="jy jz ka"><p id="418a" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae la" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fvue-js-and-webpack-4-from-scratch-part-2–5038cc9deffb" rel="noopener ugc nofollow" target="_blank">点击这里在LinkedIn上分享这篇文章</a></p></blockquote><h1 id="00b0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">这次要有型！</h1><p id="6db7" class="pw-post-body-paragraph kb kc iq ke b kf lz kh ki kj ma kl km mb mc kp kq md me kt ku mf mg kx ky kz ij bi translated">继续<a class="ae la" rel="noopener ugc nofollow" target="_blank" href="/vuejs-and-webpack-4-from-scratch-part-1-94c9c28a534a">第1部分</a>，在本文中，我将继续构建我们的Vue.js应用程序，添加:</p><ul class=""><li id="331d" class="mh mi iq ke b kf kg kj kk mb mj md mk mf ml kz mm mn mo mp bi translated">用于添加预处理CSS的手写笔</li><li id="99b3" class="mh mi iq ke b kf mq kj mr mb ms md mt mf mu kz mm mn mo mp bi translated">热模块重载和HTML注入</li><li id="6b89" class="mh mi iq ke b kf mq kj mr mb ms md mt mf mu kz mm mn mo mp bi translated">构建我们的脚本的通天塔</li></ul><p id="a732" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated"><a class="ae la" href="https://medium.com/@petrefax66/vue-js-and-webpack-4-from-scratch-part-3-3f68d2a3c127" rel="noopener">第3部分</a>将通过添加以下内容来完成申请:</p><ul class=""><li id="4758" class="mh mi iq ke b kf kg kj kk mb mj md mk mf ml kz mm mn mo mp bi translated">静态资产处理</li><li id="824c" class="mh mi iq ke b kf mq kj mr mb ms md mt mf mu kz mm mn mo mp bi translated">林挺的ESLint</li><li id="1253" class="mh mi iq ke b kf mq kj mr mb ms md mt mf mu kz mm mn mo mp bi translated">使用Jest进行测试</li></ul></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="7022" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">让我们从安装webpack-dev-server开始，这样我们就不需要一直运行构建脚本来查看浏览器中的变化。</p><p id="711a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">我们需要安装npm模块:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="c269" class="nl lc iq nh b gy nm nn l no np">npm install --save-dev webpack-dev-server</span></pre><p id="9f85" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">并更改我们的构建脚本来运行它，而不是webpack，同时我将把命令从build重命名为dev:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="2dfe" class="nl lc iq nh b gy nm nn l no np">"dev": "webpack-dev-server --config build/webpack.config.dev.js"</span></pre><p id="b5b6" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">现在运行这个程序，浏览器在<a class="ae la" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>上启动，我可以看到我的应用程序。全部采用零配置！然而，有一个小问题，如果我把我的App.vue改成“晚上好，圣迪马斯！”而不是“你好，世界！”则浏览器不会更新。</p><p id="d670" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">如果我检查我的控制台，我可以看到应用程序正在建设，那么是什么问题？当我们设置我们的index.html时，我们硬编码了javascript的路径，为了热模块重新加载工作，我们需要允许这个路径被注入，这样开发服务器就可以更新html以包含所做的更改。</p><p id="f1a5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">转到index.html，删除指向dist/main.js的脚本标签，然后安装html-webpack-plugin:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="297a" class="nl lc iq nh b gy nm nn l no np">npm install --save-dev html-webpack-plugin</span></pre><p id="fef3" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">现在我们需要将它添加到我们的webpack配置文件中，所以它看起来像这样:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/91528696bbde9062f6a1f89ab84f464a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*JBb0P_RCJFYSpaS3QIkr0w.png"/></div></figure><p id="cd72" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">如果您现在运行应用程序，您可以在App.vue中更改消息，它会立即在浏览器窗口中重新加载！</p><p id="55bd" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">这太棒了，但是我们还没有得到真正的HMR，如果你在浏览器devtools中查看，你可以看到当我们做出改变时，整个页面都刷新了。要解决这个问题，我们需要再添加一项配置:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="4f52" class="nl lc iq nh b gy nm nn l no np">'use strict'</span><span id="6d31" class="nl lc iq nh b gy nr nn l no np"><em class="kd">const</em> webpack = require('webpack')<br/><em class="kd">const</em> { VueLoaderPlugin } = require('vue-loader')<br/><em class="kd">const</em> HtmlWebpackPlugin = require('html-webpack-plugin')</span><span id="b6d9" class="nl lc iq nh b gy nr nn l no np">module.exports = {<br/>  mode: 'development',<br/>  <br/>  entry: [<br/>    './src/app.js'<br/>  ],</span><span id="c085" class="nl lc iq nh b gy nr nn l no np">  devServer: {<br/>    hot: true,<br/>    watchOptions: {<br/>      poll: true<br/>    }<br/>  },</span><span id="762f" class="nl lc iq nh b gy nr nn l no np">  module: {<br/>    rules: [<br/>      {<br/>        test: /\.vue<em class="kd">$</em>/,<br/>        use: 'vue-loader'<br/>      }<br/>    ]<br/>  },</span><span id="3e55" class="nl lc iq nh b gy nr nn l no np">  plugins: [<br/>    new webpack.HotModuleReplacementPlugin(),<br/>    new VueLoaderPlugin(),<br/>    new HtmlWebpackPlugin({<br/>      filename: 'index.html',<br/>      template: 'index.html',<br/>      inject: true<br/>    })<br/>  ]<br/>}</span></pre><p id="d7d7" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">有了这个，您应该能够看到热加载到页面中的更改，而无需刷新，如下所示:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/b9e89595bed4d1911f8ef196773e2a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zgaKM0YbKFP1TGDL8gWCw.png"/></div></div></figure></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="c5b9" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">现在我们有了应用程序自动更新，我们应该能够移动得更快，所以让我们添加一些CSS。更改App.vue文件，使其如下所示:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="daad" class="nl lc iq nh b gy nm nn l no np">&lt;template&gt;<br/>  &lt;div class="full-width center-content"&gt;<br/>    &lt;h1&gt;Hello World!&lt;/h1&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="2270" class="nl lc iq nh b gy nr nn l no np">&lt;style scoped&gt;<br/>.full-width {<br/>  width: 100%;<br/>}</span><span id="dd6f" class="nl lc iq nh b gy nr nn l no np">.center-content {<br/>  display: flex;<br/>  justify-content: center;<br/>  align-items: center;<br/>}<br/>&lt;/style&gt;</span></pre><p id="3983" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">此更改过去会在浏览器中自动应用，但现在您会看到一条错误消息:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/9d5a948e3eaaaa90c295258449479ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LpExik9-N5lMrZRiUROFtA.png"/></div></div></figure><p id="bf40" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">如果CSS在自己的文件中，也会有类似的问题。在根目录下创建一个名为assets的文件夹，添加一个名为app.css的文件，并将全角和中心内容类复制到其中。要将它包含在我们的应用程序中，我们可以将其导入到我们的app.js中。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="e3e0" class="nl lc iq nh b gy nm nn l no np">import '../assets/app.css'</span></pre><p id="d63f" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">…并从App.vue中移除样式。</p><p id="6284" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">现在，当您尝试运行应用程序时，会出现一个错误:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/4a9e1aaaafec29b3f25fb33405d1ab49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Hwm6aeB_mHgXFH9A7aEAw.png"/></div></div></figure><p id="5a65" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">要解决这个问题，我们需要在我们的webpack配置中配置css加载器，将其添加到规则:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="7a7b" class="nl lc iq nh b gy nm nn l no np">{<br/>  test: /\.css$/,<br/>  use: [<br/>    'vue-style-loader',<br/>    'css-loader'<br/>  ]<br/>}</span></pre><p id="355d" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">并安装样式加载器:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="da35" class="nl lc iq nh b gy nm nn l no np">npm install --save-dev css-loader vue-style-loader</span></pre><p id="a36f" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">然后应该加载css，我们在外部资产和单个文件组件中都有css处理。</p><p id="a95d" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">这里的最后一个变化是，我喜欢使用手写笔进行CSS预处理，所以我安装了加载器:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="05f2" class="nl lc iq nh b gy nm nn l no np">npm install --save-dev stylus stylus-loader</span></pre><p id="dfd3" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">添加了一条规则:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="4890" class="nl lc iq nh b gy nm nn l no np">{<br/>  test: /\.styl(us)?$/,<br/>  use: [<br/>    'vue-style-loader',<br/>    'css-loader',<br/>    'stylus-loader'<br/>  ]<br/>}</span></pre><p id="622b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">并将我的app.css转换为app.styl:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="ebb8" class="nl lc iq nh b gy nm nn l no np">.full-width<br/>  width 100%</span><span id="d01b" class="nl lc iq nh b gy nr nn l no np">.center-content<br/>  display flex<br/>  justify-content center<br/>  align-items center</span></pre><p id="8c53" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">在这一点上，如果你使用VSCode，有一个手写笔扩展可以正确地对你的风格进行颜色编码。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="02b7" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">到目前为止，我们还没有在组件中添加任何脚本部分，因为这是一个如此简单的应用程序，我们不打算做任何太大的事情，让我们只创建一个HelloComponent，它将name作为一个道具，并发出适当的问候。</p><p id="cb83" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">在components文件夹下，添加HelloComponent.vue，它应该如下所示:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="0c17" class="nl lc iq nh b gy nm nn l no np">&lt;template&gt;<br/>  &lt;h1&gt;Hello {{ name }}!&lt;/h1&gt;<br/>&lt;/template&gt;</span><span id="afcd" class="nl lc iq nh b gy nr nn l no np">&lt;script&gt;</span><span id="c12f" class="nl lc iq nh b gy nr nn l no np">export default {<br/>  props: {<br/>    name: {<br/>      type: String,<br/>      required: true<br/>    }<br/>  }<br/>}<br/>&lt;/script&gt;</span><span id="ded1" class="nl lc iq nh b gy nr nn l no np">&lt;style lang="stylus" scoped&gt;<br/>h1<br/>  color red<br/>&lt;/style&gt;</span></pre><p id="3abc" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">然后更改App.vue以使用新组件:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="2e1c" class="nl lc iq nh b gy nm nn l no np">&lt;template&gt;<br/>  &lt;div class="full-width center-content"&gt;<br/>    &lt;hello-component name="World" /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="fc44" class="nl lc iq nh b gy nr nn l no np">&lt;script&gt;<br/>import HelloComponent from './components/HelloComponent.vue'</span><span id="4a57" class="nl lc iq nh b gy nr nn l no np">export default {<br/>  components: {<br/>    HelloComponent<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="c86d" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">这是可行的，但是旧的浏览器可能会与这种ES6语法斗争(这是我们开始测试时会遇到的)，所以我们将安装Babel来将我们的代码转换成所有浏览器都能理解的ES5。</p><p id="92da" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">首先，安装npm模块:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="547c" class="nl lc iq nh b gy nm nn l no np">npm install --save-dev @babel/core babel-loader @babel/preset-env</span></pre><p id="c513" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">然后添加加载器配置:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="fd31" class="nl lc iq nh b gy nm nn l no np">{<br/>  test: /\.js$/,<br/>  use: 'babel-loader'<br/>}</span></pre><p id="8a03" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">在这个阶段，重要的是这个加载器配置在vue-loader之后。在你的配置中，vue-loader将把你的单个文件组件分割成单独的html、js和样式模块，我们希望babel-loader处理js部分。</p><p id="0da9" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">最后在项目的根目录下创建一个名为。babelrc，这是我们放置babel特定配置的地方。目前，我们将尽可能保持简单:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="9057" class="nl lc iq nh b gy nm nn l no np">{<br/>  "presets": [<br/>    ["@babel/env", {<br/>      "modules": false,<br/>      "targets": {<br/>        "browsers": ["&gt; 1%", "last 2 versions", "not ie &lt;= 8"]<br/>      }<br/>    }]<br/>  ]<br/>}</span></pre><p id="a02c" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">我们现在可以运行我们的应用程序，我们看不到表面上的变化，但是在幕后，我们的ES6代码已经转移到ES5，并将在更广泛的浏览器上工作。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="ea82" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mb ko kp kq md ks kt ku mf kw kx ky kz ij bi translated">这就是这一部分的全部内容，在最后一部分，我们将通过查看外部资产处理、林挺和测试来完成应用程序。感谢阅读！</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to create an Instagram Feed module for Vue Storefront</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为Vue Storefront创建Instagram Feed模块</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-an-instagram-feed-module-for-vue-storefront-eaa03019b288?source=collection_archive---------2-----------------------#2019-01-02">https://itnext.io/how-to-create-an-instagram-feed-module-for-vue-storefront-eaa03019b288?source=collection_archive---------2-----------------------#2019-01-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f8c680148725e0aafc13e2e0503faf82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6H10HxJeTgzxlEQPSKGgRQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">随机图库照片</figcaption></figure><p id="b5e7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">过去几个月，我一直在与<a class="ae la" href="https://www.vuestorefront.io/" rel="noopener ugc nofollow" target="_blank"> Vue店面</a>合作，这是一次很棒的经历。它是少数几个在后端使用Magento 2(和许多其他电子商务平台)实现PWAs的开源解决方案之一，因此它为基于web的应用程序的许多常见需求(离线支持、延迟加载、小捆绑包大小、服务器端渲染等)带来了现成的现代解决方案。</p><p id="ab98" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了对Vue Storefront如何工作有一个基本的了解，我认为记录如何在您的商店中实现Instragram提要是一个好主意。这是一个相对简单的任务，但它涉及Vue Storefront的许多核心概念，因此它可以作为“边做边学”的有用案例。</p><h1 id="6181" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">开始之前</h1><p id="4dff" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">理解Vue店面是多个“部分”的集合，而不是一个单一的大实体，这一点很重要。最重要的是:</p><ul class=""><li id="ecd1" class="me mf iq ke b kf kg kj kk kn mg kr mh kv mi kz mj mk ml mm bi translated"><a class="ae la" href="https://github.com/DivanteLtd/vue-storefront" rel="noopener ugc nofollow" target="_blank"> vue-storefront </a>:处理商店的前端，它由(你猜对了)VueJS和许多其他决定数据应该如何显示的包驱动。</li><li id="fe0e" class="me mf iq ke b kf mn kj mo kn mp kr mq kv mr kz mj mk ml mm bi translated">vue-storefront-api :由于Vue Storefront是100%平台不可知的，所以需要这个服务作为前端和后端之间的中间层。在大多数情况下，我们将使用它来连接Magento，但它可以与任何数量的提供商进行交互，例如:WordPress，MailChimp，或者在这种情况下的Instagram。</li></ul><p id="40ea" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你有兴趣了解更多关于Vue Storefront架构的信息，我推荐给<a class="ae la" href="https://www.youtube.com/watch?v=sRSmEP4jva0&amp;feature=youtu.be" rel="noopener ugc nofollow" target="_blank">官方技术截屏</a>一个手表，因为它在解释它背后的所有工具方面做得比我在本文中所能做的更好。</p><h1 id="dc59" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">设置API端点</h1><p id="2fdc" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">为了获取用户的Instagram feed，我们需要使用一个访问令牌来查询脸书的Graph API。在前端公开这种信息并不理想，因为这会导致安全漏洞，所以我们应该在服务器端公开。</p><p id="97ef" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">幸运的是，我们可以很容易地用返回我们需要的数据的自定义端点来扩展vue-storefront-api。🎉</p><p id="1efa" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将从在<code class="fe ms mt mu mv b">src/api/extensions/instagram-api/</code>中创建以下<code class="fe ms mt mu mv b">index.js</code>文件开始:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c308" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">基本上，这是用一个新的<code class="fe ms mt mu mv b">/feed</code>端点扩展Vue Storefront的express路由器，该端点将使用我们的页面ID和访问令牌向脸书的Graph API发出请求。如果有任何错误，它将返回一个带有错误响应的<code class="fe ms mt mu mv b">500</code>状态代码，如果没有，它将以JSON数组的形式返回用户的Instagram feed。</p><blockquote class="nc nd ne"><p id="ba97" class="kc kd nf ke b kf kg kh ki kj kk kl km ng ko kp kq nh ks kt ku ni kw kx ky kz ij bi translated">它还接受一个可选的“limit”参数来指定要返回的最大项数。</p></blockquote><p id="234c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如你所见，我们没有硬编码页面ID或访问令牌，因为它们是特定于项目的，应该存储在<code class="fe ms mt mu mv b">config/local.json</code>文件中。</p><p id="a3a1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">打开<code class="fe ms mt mu mv b">local.json</code>文件，在<code class="fe ms mt mu mv b">extensions</code>列表中添加一个<code class="fe ms mt mu mv b">instagram</code>键，包含以下信息:</p><pre class="mw mx my mz gt nj mv nk nl aw nm bi"><span id="911f" class="nn lc iq mv b gy no np l nq nr">"instagram": {<br/>  "pageId": "FB PAGE ID",<br/>  "accessToken": "FB PAGE ACCESS TOKEN"<br/>}</span></pre><p id="7dbd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">按照以下说明获取您的页面ID:<a class="ae la" href="https://www.facebook.com/help/community/question/?id=378910098941520" rel="noopener ugc nofollow" target="_blank">facebook.com/help/community/question/?id=378910098941520</a></p><p id="7fae" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要获得“永不过期”的访问令牌，请遵循以下答案:<a class="ae la" href="https://stackoverflow.com/a/35481577/455319" rel="noopener ugc nofollow" target="_blank">stackoverflow.com/a/35481577/455319</a></p><p id="f1eb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，为了启用我们的扩展，将“instagram-api”添加到您的<code class="fe ms mt mu mv b">local.json</code>配置文件中的<code class="fe ms mt mu mv b">registeredExtensions</code>列表中。</p><p id="387d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果一切顺利，当您访问我们的定制<strong class="ke ir">vue-store front-API</strong>endpoint<code class="fe ms mt mu mv b">/api/ext/instagram-api/feed</code>时，您应该会看到最新Instagram帖子的列表:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/2b54c09b16dd0f31851decd23da8a7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bg7-rKbo4HmKcVqOLoYmrQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">自定义Instagram API端点</figcaption></figure><h1 id="d550" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">设置前端组件</h1><p id="7835" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">既然我们有了安全检索Instagram提要的方法，我们可以开始考虑如何显示它了。由于1.6版Vue Storefront鼓励使用模块来扩展其功能，因此这是一个很好的使用案例。</p><p id="2596" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们在<code class="fe ms mt mu mv b">src/modules/instagram-feed</code>文件夹中创建以下文件:</p><p id="bac4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">索引. ts </strong></p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e8e8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是我们模块的入口点，它主要是样板代码，设置我们模块所需的所有数据。在我们的例子中，它只是注册了一个名为<code class="fe ms mt mu mv b">instagram-feed</code>的新模块，并注册了<strong class="ke ir"> Vuex存储</strong>。</p><p id="6c4a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> store/index.ts </strong></p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="39ee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">存储/突变类型. ts </strong></p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="edbd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这为Vue Storefront的<strong class="ke ir"> Vuex store </strong>创建了动作、getters和变异。最重要的部分是<code class="fe ms mt mu mv b">get</code>动作，它向我们之前创建的API发出请求，以获取最新的Instagram帖子，因为这个端点可能是可变的，所以将它存储在<code class="fe ms mt mu mv b">config/local.json</code>文件中是个好主意，所以请确保也创建一个新参数:</p><pre class="mw mx my mz gt nj mv nk nl aw nm bi"><span id="f49c" class="nn lc iq mv b gy no np l nq nr">"instagram": {<br/>  "endpoint": "<a class="ae la" href="http://localhost:8080/api/ext/vue-storefront-instagram-api/feed" rel="noopener ugc nofollow" target="_blank">http://your-vue-storefront-api-url.com/api/ext/instagram-api/feed</a>"<br/>}</span></pre><p id="3e66" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">components/instagramfeed . js</strong></p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="97db" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我们可以用作mixin的自定义组件从mount上的<strong class="ke ir"> Vuex </strong> <strong class="ke ir"> store </strong>获取最新的Instagram帖子，并公开一个可以在模板中使用的<code class="fe ms mt mu mv b">feed</code>属性。它还允许我们用定制的<code class="fe ms mt mu mv b">limit</code>道具改变进给限制。</p><p id="4523" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在注册我们的定制模块，我们将它包含在<code class="fe ms mt mu mv b">src/modules/index.ts</code>文件中:</p><pre class="mw mx my mz gt nj mv nk nl aw nm bi"><span id="4dce" class="nn lc iq mv b gy no np l nq nr">// Import module at the top<br/>import { InstagramFeed } from '../modules/instagram-feed'</span><span id="c182" class="nn lc iq mv b gy nt np l nq nr">// Add to "registerModules" array<br/>export const registerModules: VueStorefrontModule[] = [<br/>  ...<br/>  InstagramFeed<br/>]</span></pre><h1 id="5a4f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在前端显示提要</h1><p id="9296" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">要完成它，我们需要做的就是创建标记，以在我们的网站上实际显示提要。</p><p id="8083" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了节省时间，让我们重用呈现默认主题中“获得灵感”部分的代码。在<code class="fe ms mt mu mv b">src/themes/default/components/theme/blocks/InstagramFeed/InstagramFeed.vue</code>中创建一个<code class="fe ms mt mu mv b">InstagramFeed.vue</code>文件:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="d877" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这看起来与默认的<code class="fe ms mt mu mv b">TileLinks.vue</code>文件非常相似，我们在这里所做的就是使用我们的<code class="fe ms mt mu mv b">InstagramFeed</code> mixin并在<code class="fe ms mt mu mv b">feed</code> computed属性上循环来呈现可用的媒体。</p><p id="c96a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们在商店的主页上显示我们的定制组件，在<code class="fe ms mt mu mv b">src/themes/default/pages/Home.vue</code>中打开<code class="fe ms mt mu mv b">Home.vue</code>，并包含我们刚刚创建的元素的标记:</p><pre class="mw mx my mz gt nj mv nk nl aw nm bi"><span id="c0f8" class="nn lc iq mv b gy no np l nq nr">&lt;template&gt;<br/>  ...<br/>  &lt;section class="container pb60 px15"&gt;<br/>    &lt;div class="row center-xs"&gt;<br/>     &lt;header class="col-md-12 pt40"&gt;<br/>        &lt;h2 class="align-center cl-accent"&gt;<br/>          {{ $t('Instagram') }}<br/>        &lt;/h2&gt;<br/>      &lt;/header&gt;<br/>    &lt;/div&gt;<br/>    &lt;instagram-feed limit="8" /&gt;<br/>  &lt;/section&gt;<br/>  ...<br/>&lt;/template&gt;</span><span id="da9d" class="nn lc iq mv b gy nt np l nq nr">&lt;script&gt;<br/>...<br/>import InstagramFeed from 'theme/components/theme/blocks/InstagramFeed/InstagramFeed'</span><span id="991f" class="nn lc iq mv b gy nt np l nq nr">export default {<br/>  components: {<br/>    ...<br/>    InstagramFeed<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="c2db" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果一切正常，我们将能够在主页上看到我们的Instagram feed:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/4a62177b5b444a0d9a12f809cee1e814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkpKB94kE9R0Bl3yuqEFgw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">主页上的Instagram feed</figcaption></figure><p id="cf54" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">很酷的一点是，由于我们重用了<code class="fe ms mt mu mv b">TileLink</code>组件标记，我们可以免费获得延迟加载和CSS转换。</p><h1 id="7c71" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">包扎</h1><p id="32b0" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">我们设法使用了Vue Storefront的一部分技术，但仍有一些地方需要改进，例如:</p><ul class=""><li id="d6a9" class="me mf iq ke b kf kg kj kk kn mg kr mh kv mi kz mj mk ml mm bi translated">TypeScript实现</li><li id="e8c7" class="me mf iq ke b kf mn kj mo kn mp kr mq kv mr kz mj mk ml mm bi translated">缓存源</li><li id="b3f0" class="me mf iq ke b kf mn kj mo kn mp kr mq kv mr kz mj mk ml mm bi translated">在弹性搜索中存储媒体</li><li id="c9d3" class="me mf iq ke b kf mn kj mo kn mp kr mq kv mr kz mj mk ml mm bi translated">还有更多…</li></ul><p id="543d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但作为一个快速介绍，本模块应该展示一些使Vue Storefront成为构建电子商务商店的优秀工具的功能。👋🏽</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="4c4f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">该模块的代码可在GitHub中获得，请随意提交任何问题和请求:</p><div class="oc od gp gr oe of"><a href="https://github.com/jahvi/vue-storefront-instagram-feed" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">Jah VI/vue-店面-instagram-feed</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">Vue店面的Instagram feed组件。通过创建……为Jah VI/vue-store front-insta gram-feed开发做出贡献</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot jw of"/></div></div></a></div><div class="oc od gp gr oe of"><a href="https://github.com/jahvi/vue-storefront-instagram-api" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">Jah VI/vue-store front-insta gram-API</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">Vue Storefront获取用户Instagram feed的API端点-Jah VI/Vue-store front-insta gram-API</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="ou l oq or os oo ot jw of"/></div></div></a></div></div></div>    
</body>
</html>
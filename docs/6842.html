<html>
<head>
<title>Fixing BoxDecoration background animation in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">修复抖动中的盒子装饰背景动画</h1>
<blockquote>原文：<a href="https://itnext.io/fixing-boxdecoration-background-animation-in-flutter-bb935653f884?source=collection_archive---------0-----------------------#2022-03-18">https://itnext.io/fixing-boxdecoration-background-animation-in-flutter-bb935653f884?source=collection_archive---------0-----------------------#2022-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="902e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Container和BoxDecoration是广泛用于颤振开发的两个类。如果你想要的不仅仅是一个彩色的盒子，你可以这样写:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="1810" class="ku kv iq kq b gy kw kx l ky kz">Widget container = Container(<br/>decoration: BoxDecoration(color: color, gradient: gradient, image: image),<br/>child: child,<br/>);</span></pre><p id="62bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">BoxDecoration中还有其他属性，如阴影和边框，但我将在本文中重点介绍背景动画。</p><p id="0ee9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以看到有三种类型的背景可以在BoxDecoration中设置:颜色、渐变和图像。它们是按照这个顺序从下往上画的。如果要在两个BoxDecoration之间制作动画，可以使用DecorationTween类:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="8cbd" class="ku kv iq kq b gy kw kx l ky kz">intermediate = DecorationTween(begin: begin, end: end, t);</span></pre><p id="0fee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中t表示动画的进度(介于0和1之间)。</p><p id="138f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您也可以只使用AnimatedContainer小部件，并向它提供您想要的当前BoxDecoration，它会自动从上一个动画到当前动画:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="42b3" class="ku kv iq kq b gy kw kx l ky kz">Widget container = AnimatedContainer(<br/>duration: duration,<br/>curve: curbe,<br/>decoration: decoration,<br/>child: child<br/>);</span></pre><p id="b803" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AnimatedContainer的接口几乎与Container类相同，除了指定动画细节的两个附加参数duration和curve。</p><p id="7d3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些听起来都很棒，使用起来也很简单。如果您只想在两种颜色或同一类型的两种渐变之间制作动画(Flutter中有三种渐变)，您可以毫无问题地使用AnimatedContainer类。但是在其他场景下会给你一个怪异的白色中间背景。</p><p id="6249" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是两个盒子装饰之间动画的实际实现:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="a6b0" class="ku kv iq kq b gy kw kx l ky kz">static BoxDecoration? <em class="la">lerp</em>(BoxDecoration? a, BoxDecoration? b, double t) {<br/>  ...<br/>  return BoxDecoration(<br/>    color: Color.<em class="la">lerp</em>(a.color, b.color, t),<br/>    image: t &lt; 0.5 ? a.image : b.image, // TODO(ianh): cross-fade the image<br/>    border: BoxBorder.<em class="la">lerp</em>(a.border, b.border, t),<br/>    borderRadius: BorderRadiusGeometry.<em class="la">lerp</em>(a.borderRadius, b.borderRadius, t),<br/>    boxShadow: BoxShadow.<em class="la">lerpList</em>(a.boxShadow, b.boxShadow, t),<br/>    gradient: Gradient.<em class="la">lerp</em>(a.gradient, b.gradient, t),<br/>    shape: t &lt; 0.5 ? a.shape : b.shape,<br/>  );<br/>}</span></pre><p id="52f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以立即发现问题。对于两个图像背景之间的动画，当前的实现只是以50%的进度将背景从第一个图像改变到第二个图像，而没有交叉渐变。我已经盯着这个TODO注释一年了，最后决定自己来做。对于较少使用的场景，比如在一种颜色和一种渐变之间制作动画，或者在两种不同类型的渐变之间制作动画，当前的实现也不能很好地工作。</p><p id="116c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是为什么我实现了SmoothDecorationTween和SmoothAnimatedContainer类。它们与内置的同类产品具有相同的界面。让我们来看一些对比:</p><figure class="kl km kn ko gt lc gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/fef166dca571f451550a09d8c4dd2bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*QdlogKHD_zPAXbhcCfAAiw.gif"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">左:AnimatedContainer，右:SmoothAnimatedContainer</figcaption></figure><figure class="kl km kn ko gt lc gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/8b7d0493e6cf1a24a0a335ec2967cf18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*RRcbY8mY7upsp3h1BCAnwQ.gif"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">左:AnimatedContainer，右:SmoothAnimatedContainer</figcaption></figure><figure class="kl km kn ko gt lc gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/a422c94dab5256fe1e999a48d98fbf27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*sdI766Oeng2VxP_0NDSPSQ.gif"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">左:AnimatedContainer，右:SmoothAnimatedContainer</figcaption></figure><p id="bc4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经在<a class="ae lj" href="https://pub.dev/packages/animated_box_decoration" rel="noopener ugc nofollow" target="_blank"> pub.dev </a>上发布了这个包。如果你的应用程序需要这样的功能，或者在Flutter中需要快乐编码，那就来看看吧！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Laravel and Vue: Creating a Portfolio website with a CRUD admin panel — Chapter 15</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第15章</h1>
<blockquote>原文：<a href="https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-15-40507d27a340?source=collection_archive---------4-----------------------#2020-01-10">https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-15-40507d27a340?source=collection_archive---------4-----------------------#2020-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b474" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">下载简历</h2></div><p id="5023" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第14章中，我们创建了上传简历的功能。现在我们需要一个下载简历的能力。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="6bde" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated">创建下载简历的能力</h1><p id="011f" class="pw-post-body-paragraph ki kj it kk b kl md ju kn ko me jx kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">我们需要遵循以下步骤:</p><ol class=""><li id="7336" class="mi mj it kk b kl km ko kp kr mk kv ml kz mm ld mn mo mp mq bi translated">将<strong class="kk iu">原始文件名</strong>存储在数据库表中</li><li id="e8cc" class="mi mj it kk b kl mr ko ms kr mt kv mu kz mv ld mn mo mp mq bi translated">使原始文件名在路线中可用</li><li id="2a53" class="mi mj it kk b kl mr ko ms kr mt kv mu kz mv ld mn mo mp mq bi translated">接收脚本标签中的原始文件名</li><li id="e54a" class="mi mj it kk b kl mr ko ms kr mt kv mu kz mv ld mn mo mp mq bi translated">使用原始文件名创建'<strong class="kk iu">下载cv' </strong> <strong class="kk iu">链接</strong>(模板标签)</li></ol><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/73fe87526d747a67481d95ef08be6f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hQt5r5NWL1PD_605.png"/></div></div></figure><h2 id="959f" class="ni lm it bd ln nj nk dn lr nl nm dp lv kr nn no lx kv np nq lz kz nr ns mb nt bi translated">1.数据库表中的<strong class="ak">原始文件名</strong></h2><p id="2b2c" class="pw-post-body-paragraph ki kj it kk b kl md ju kn ko me jx kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">像往常一样，我们需要进行迁移</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="e583" class="ni lm it nv b gy nz oa l ob oc">php artisan make:migration CreateAboutTable</span></pre><p id="dc95" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在迁移中，我们需要创建一个名为<strong class="kk iu"> cv_path </strong>的<strong class="kk iu">字符串列</strong></p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="e0df" class="ni lm it nv b gy nz oa l ob oc"><em class="od">public function </em>up()<br/>{<br/>    Schema::create('about', <em class="od">function </em>(Blueprint $table) {<br/>        $table-&gt;bigIncrements('id');<strong class="nv iu"><br/>        $table-&gt;string('cv_path');</strong><br/>        $table-&gt;timestamps();<br/>    });<br/>}</span></pre><p id="4a78" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们迁移并准备好一张桌子</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="d7e8" class="ni lm it nv b gy nz oa l ob oc">php artisan migrate</span></pre><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oe"><img src="../Images/23c943931f36f890a45c602496e8e29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AF_sk8C_JEre8ZSb"/></div></div><figcaption class="of og gj gh gi oh oi bd b be z dk translated">Abel Y Costa 在<a class="ae oj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="b87c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们创建“关于”模型</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="0540" class="ni lm it nv b gy nz oa l ob oc">php artisan make:model About</span></pre><p id="551f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在about模型中，我们需要一个包含<code class="fe ok ol om nv b"><strong class="kk iu">cv_path</strong></code>的可填充数组。</p><p id="f5c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">About.php:👇</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="9165" class="ni lm it nv b gy nz oa l ob oc"><em class="od">&lt;?php<br/><br/>namespace </em>App;<br/><br/><em class="od">use </em>Illuminate\Database\Eloquent\Model;<br/><br/><em class="od">class </em>About <em class="od">extends </em>Model<br/>{<br/>    <em class="od">protected </em>$table = 'about';<br/>    <em class="od">protected </em>$fillable = [<strong class="nv iu">'cv_path'</strong>];<br/>}</span></pre><p id="fb57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在来更改about控制器的postAboutForm()函数，以便它将cv_path存储在数据库表中</p><p id="7571" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">AboutController.php中的postAboutForm():👇</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="40f4" class="ni lm it nv b gy nz oa l ob oc"><em class="od">public function </em>postAboutForm(){<br/>    $file = request()-&gt;file('cv');<br/>    $originalName = $file-&gt;getClientOriginalName();<br/>    $file-&gt;storeAs('public/cvs', $originalName);<br/>    <strong class="nv iu">$about = <em class="od">new </em>About();<br/>    $about-&gt;cv_path = $originalName;<br/>    $about-&gt;save();</strong><br/>}</span></pre><p id="0747" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个函数做两件事，即<strong class="kk iu">上传cv </strong>和<strong class="kk iu">存储cv路径。</strong>简历上传到<strong class="kk iu"> storage/app/public/cvs </strong>文件夹。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/852145324a3617fdc3efd6b3026c56b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RhVvDtQsNzN8PRbk.png"/></div></div></figure><h2 id="df0c" class="ni lm it bd ln nj nk dn lr nl nm dp lv kr nn no lx kv np nq lz kz nr ns mb nt bi translated">2.在路线中可用的原始文件名</h2><p id="b626" class="pw-post-body-paragraph ki kj it kk b kl md ju kn ko me jx kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">让我们创建一条给我们cv_path的路径</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="37c5" class="ni lm it nv b gy nz oa l ob oc">Route::<em class="od">get</em>('/cv_path', 'AboutController@getCVPath');</span></pre><p id="2a69" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于控制器中的功能:👇</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="8b31" class="ni lm it nv b gy nz oa l ob oc"><em class="od">public function </em>getCVPath() {<br/>    <em class="od">return </em>About::<em class="od">all</em>()[0]-&gt;cv_path;<br/>}</span></pre><p id="421c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有了上面的代码，如果我们访问路由，就会看到原来的文件名/ <code class="fe ok ol om nv b">cv_path</code>。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/b2192b6e6a34c91abcf332ad391e4341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WFxlI8SrukJJAZEC.png"/></div></div></figure><h2 id="67be" class="ni lm it bd ln nj nk dn lr nl nm dp lv kr nn no lx kv np nq lz kz nr ns mb nt bi translated">3.使用Vue组件的脚本标签接收原始文件名</h2><p id="cc39" class="pw-post-body-paragraph ki kj it kk b kl md ju kn ko me jx kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">在About.vue的方法块中，我们需要一个接收cv_path的方法</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="7124" class="ni lm it nv b gy nz oa l ob oc">getCVPath() {<br/>    axios.get('/api/cv_path')<br/>        .then(response =&gt; <em class="od">this</em>.cv_path = response.data)<br/>        .catch(error =&gt; <em class="od">console</em>.log(error))<br/>},</span></pre><p id="2b3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并且在安装块中</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="c349" class="ni lm it nv b gy nz oa l ob oc">mounted() {<br/>    <em class="od">this</em>.getCVPath();<br/>},</span></pre><p id="e4fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">data() return {}</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="d94b" class="ni lm it nv b gy nz oa l ob oc">data() {<br/>    <em class="od">return </em>{<br/>        cv_path: '',<br/>    }<br/>},</span></pre><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/35852bc0682eeda66a257e3951e700e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*K2dbcTGSOwomh41G.png"/></div></div></figure><h2 id="c8b3" class="ni lm it bd ln nj nk dn lr nl nm dp lv kr nn no lx kv np nq lz kz nr ns mb nt bi translated">4.使用原始文件名创建'<strong class="ak">下载CV' </strong> <strong class="ak">链接</strong>(模板标签)</h2><p id="a130" class="pw-post-body-paragraph ki kj it kk b kl md ju kn ko me jx kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">下载链接只是一个带有<code class="fe ok ol om nv b"><strong class="kk iu">download</strong></code>属性的锚(<code class="fe ok ol om nv b">&lt;a&gt;&lt;/a&gt;</code>元素)</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="78de" class="ni lm it nv b gy nz oa l ob oc">&lt;a <em class="od">href</em>="#" <strong class="nv iu"><em class="od">download</em></strong>&gt;&lt;/a&gt;</span></pre><p id="ba96" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要这个链接的一些文本，我们可以只使用<code class="fe ok ol om nv b"><strong class="kk iu">cv_path</strong></code></p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="7071" class="ni lm it nv b gy nz oa l ob oc">&lt;a <em class="od">href</em>="#" <em class="od">download</em>&gt;<strong class="nv iu">{{cv_path}}</strong>&lt;/a&gt;</span></pre><p id="263e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以使用<code class="fe ok ol om nv b"><strong class="kk iu">v-bind:</strong></code>并连接cv_path</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="ffd7" class="ni lm it nv b gy nz oa l ob oc">&lt;a <em class="od">v-bind:href</em>="'/storage/cvs/' + <em class="od">this</em>.cv_path" <em class="od">download</em>&gt;{{cv_path}}&lt;/a&gt;</span></pre><p id="f6de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用<code class="fe ok ol om nv b"><strong class="kk iu">v-bind:</strong></code>的较短版本，即<code class="fe ok ol om nv b"><strong class="kk iu">:</strong></code></p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="0f62" class="ni lm it nv b gy nz oa l ob oc">&lt;a <em class="od">:href</em>="'/storage/cvs/' + <em class="od">this</em>.cv_path" <em class="od">download</em>&gt;{{cv_path}}&lt;/a&gt;</span></pre><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi on"><img src="../Images/55664cbcf1f8d330adc000057638f59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pArVapS69MNOm1Z4.png"/></div></div></figure><p id="02c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们确保App.vue有About和AboutEditor组件</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="e443" class="ni lm it nv b gy nz oa l ob oc">&lt;div <em class="od">id</em>="app"&gt;<br/>    &lt;About/&gt;<br/>    &lt;AboutEditor/&gt;<br/>&lt;/div&gt;</span></pre><p id="36b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们向about组件添加一个<code class="fe ok ol om nv b"><strong class="kk iu">h1</strong></code>,并在web浏览器中加载页面</p><pre class="mx my mz na gt nu nv nw nx aw ny bi"><span id="5b34" class="ni lm it nv b gy nz oa l ob oc">&lt;section <em class="od">id</em>="about"&gt;<br/>    &lt;h1&gt;About&lt;/h1&gt;<br/>    &lt;p&gt;About Text&lt;/p&gt;<br/>    &lt;a <em class="od">:href</em>="'/storage/cvs/' + <em class="od">this</em>.cv_path" <em class="od">download</em>&gt;{{cv_path}}&lt;/a&gt;<br/>&lt;/section&gt;</span></pre><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oo"><img src="../Images/4c2537f58d68b4e5835627442b27f6df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POoyShJHETVRR0S5caSMuA.png"/></div></div></figure><p id="e8d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到部分标题😃，关于文本😃但是没有下载链接👎。</p><p id="3008" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们上传简历之前，我们看不到下载链接。所以我们上传一份简历吧。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi op"><img src="../Images/53e372f0903bfd24a33bd2df62478551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTCsTZAqeh8OCJteCJF03g.png"/></div></div></figure><p id="5e78" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们点击提交时，文件将被上传。现在我们需要刷新页面。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oo"><img src="../Images/a823a3f0c57044ae03bf9fb1f252ba9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YujoA5C6xNjko2E-WygeFw.png"/></div></div></figure><p id="33c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以看到用于下载简历的链接。👍</p><p id="c286" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是……</p><p id="6feb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上传更新的简历怎么办？这个简历链接会被替换吗？</p><p id="ca77" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">答案是否定的😦。与我们目前拥有的代码，新的简历将得到上传，但链接不会被取代。然而，我们可以通过创建一个<strong class="kk iu"> CV选择器</strong>来轻松处理这个问题。</p><p id="906d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CV选择器将在下一章(第16章)创建。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Multi-Tenancy and its associated risk trade-offs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多租户及其相关的风险权衡</h1>
<blockquote>原文：<a href="https://itnext.io/multi-tenancy-and-its-associated-risk-trade-offs-6ddaf20aeb5c?source=collection_archive---------9-----------------------#2019-07-25">https://itnext.io/multi-tenancy-and-its-associated-risk-trade-offs-6ddaf20aeb5c?source=collection_archive---------9-----------------------#2019-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="10fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们所说的多租户是什么意思？</p><p id="3f9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们隔离居住在单一环境中的客户(租户/参与者)而不互相干扰的方式。换句话说，通过实施适当的安全规则，在为每个客户定义了固定边界的情况下，客户之间如何共享资源。</p><p id="9b5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">环境可以指任何物理和逻辑资源。比如数据服务器，裸机，Kubernetes集群等等。</p><p id="56ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">为什么我们需要在租户之间共享资源？</strong></p><p id="e19b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">降低成本！，当然可以。通过与多租户共享资源，我们可以最大限度地高效利用资源。比方说，将一台20个cpu内核的机器分配给一个实际上只需要2个内核的客户会导致2种情况:</p><ol class=""><li id="d797" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">部署成本更高</li><li id="b555" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">资源利用不足</li></ol><p id="b69f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，更明智的做法是将资源分配给10个客户，每个客户都需要2个内核。</p><p id="2fef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">实现这一目标背后的挑战是什么？</strong></p><p id="6264" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先是重要的一条:<em class="kz">安全</em>。</p><p id="32bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们允许不同的客户访问相同的资源时，一个客户可能会错误地或故意地访问其他客户的数据。没有客户愿意将他们的数据暴露给第三方。</p><p id="b781" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，<em class="kz">资源Quata vs完整性</em>。</p><p id="cd8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们应该能够适当地限制用户，而不是超出他们的分配。以便一个客户操作不会影响其他客户。因此，我们确实需要一个好的机制来执行它。诚信！！</p><p id="1f94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我们必须从哪一级开始隔离客户？又是怎么做到的？</strong></p><p id="345b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们假设一个系统，该系统向客户公开用户界面，以便在云上存储他们的数据。为了服务于用户界面，我们将有两个级别的服务:协调请求的Kubernetes(k8s)集群和存储客户数据的后端数据库。</p><p id="ed4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么分离它的所有可能方法是什么呢？</p><ol class=""><li id="d037" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">我们可以在数据库级别进行隔离，为每个客户维护单独的数据库，并让一个k8s群集访问不同的数据库。这里的挑战是，运行在k8s集群上的服务应该能够根据请求源判断连接到哪个数据库。这使得应用服务器代码变得不那么复杂。一些有问题的代码会将一个客户的数据暴露给其他人。</li><li id="aacf" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">接下来，我们可以在kubernetes(为每个客户使用单独的集群或者使用不同的名称空间)和数据库级别进行隔离。因此每个名称空间将连接到适当的客户数据库。这里的挑战是，我们应该有丰富的基础架构和良好的自动化脚本，以便在新用户加入时为他们提供资源。</li></ol><p id="66d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择我们需要隔离客户访问的方式/级别是一个很好的权衡。您做得越多，风险就越小，但需要更好的基础架构来支持。</p><p id="57ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望本文有助于对多租户管理有所了解。</p><blockquote class="la lb lc"><p id="fa0d" class="jn jo kz jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated">"教师是一个非常崇高的职业，它塑造了一个人的性格、才能和未来."阿卜杜勒·卡拉姆</p></blockquote><p id="fa54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢马努·马修斯，他激励我们不断学习，以达到更高的水平。</p></div></div>    
</body>
</html>
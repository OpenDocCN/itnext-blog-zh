<html>
<head>
<title>Kubernetes Best Practices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes最佳实践</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-best-practices-d2bfb6fe3c19?source=collection_archive---------1-----------------------#2022-05-25">https://itnext.io/kubernetes-best-practices-d2bfb6fe3c19?source=collection_archive---------1-----------------------#2022-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0b6a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">成功K8s管理的15个最佳实践，包括示例和技巧！</h2></div><p id="0874" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我将介绍一些使用Kubernetes (K8s)的最佳实践。</p><p id="4338" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为最流行的容器编排系统，K8s是现代云工程师需要掌握的事实上的标准。K8s是一个众所周知的使用和维护复杂的系统，所以很好地掌握您应该做什么和不应该做什么，并知道什么是可能的，这将使您的部署有一个坚实的开端。</p><p id="0ba9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些建议涵盖了3大类中的常见问题，即应用程序开发、治理和集群配置。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/024113dad37b0c8e7d85e8f93554b6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t49-NZsv-8SyG4iZcTiRdA.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated"><a class="ae lu" href="https://unsplash.com/@carrier_lost?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">伊恩·泰勒</a>在<a class="ae lu" href="https://unsplash.com/s/photos/container?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><h2 id="b48f" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">最佳实践目录</h2><ol class=""><li id="d51a" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld mv mw mx my bi translated">使用名称空间</li><li id="10ef" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用就绪性和活性探测器</li><li id="39ca" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用资源请求和限制</li><li id="b033" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">将pod作为部署、DaemonSet、ReplicaSet或StatefulSet的一部分跨节点部署。</li><li id="257b" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用多个节点</li><li id="3469" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用基于角色的访问控制(RBAC)</li><li id="3bde" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">在外部托管您的Kubernetes集群(使用云服务)</li><li id="8020" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">升级您的Kubernetes版本</li><li id="aceb" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">监控您的群集资源和审计策略日志</li><li id="1c77" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用版本控制系统</li><li id="5eae" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用基于Git的工作流(GitOps)</li><li id="00e8" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">缩小你的容器的尺寸</li><li id="5459" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">用标签组织您的对象</li><li id="8a71" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用网络策略</li><li id="eecf" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">使用防火墙</li></ol></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="117b" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用名称空间</h2><p id="697f" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">K8s中的名称空间对于组织对象、在集群中创建逻辑分区以及安全目的来说非常重要。默认情况下，K8s集群中有3个名称空间，<code class="fe no np nq nr b">default, kube-public</code>和<code class="fe no np nq nr b">kube-system.</code></p><p id="8108" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RBAC可用于控制对特定名称空间的访问，以限制一个组的访问，从而控制可能发生的任何错误的影响范围，例如，一组开发人员可能只能访问名为<code class="fe no np nq nr b">dev</code>的名称空间，而不能访问<code class="fe no np nq nr b">production</code>名称空间。限制不同团队使用不同名称空间的能力对于避免重复工作或资源冲突很有价值。</p><p id="d33b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还可以针对名称空间配置LimitRange对象，以定义名称空间中部署的容器的标准大小。ResourceQuotas还可以用来限制命名空间中所有容器的总资源消耗。可以针对名称空间使用网络策略来限制pod之间的流量。</p><h2 id="a411" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用就绪性和活性探测器</h2><p id="77d5" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">就绪和活性探测本质上是健康检查的类型。这些是K8s中使用的另一个非常重要的概念。</p><p id="dd15" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">准备就绪探测器确保当pod准备好服务请求时，对pod的请求才被定向到它。如果它没有准备好，那么请求将被定向到其他地方。为每个容器定义就绪探测器很重要，因为K8s中没有为这些容器设置默认值。例如，如果一个pod需要20秒钟才能启动，并且就绪探测丢失，则在启动期间定向到该pod的任何流量都会导致失败。准备就绪探测应该是独立的，不考虑对其他服务的任何依赖，比如后端数据库或缓存服务。</p><p id="c684" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">活性探测器测试应用程序是否正在运行，以便将其标记为健康。例如，可以测试web应用程序的特定路径，以确保它正在响应。否则，pod将不会被标记为健康，探针故障将导致<code class="fe no np nq nr b">kubelet</code>启动新的pod，然后再次进行测试。这种类型的探测器用作恢复机制，以防进程变得无响应。</p><h2 id="3656" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用自动缩放</h2><p id="8210" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">在适当的情况下，可以使用自动扩展来动态调整单元的数量(水平单元自动扩展)、单元消耗的资源量(垂直自动扩展)或群集中的节点数量(群集自动扩展)，具体取决于对资源的需求。</p><p id="d278" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">水平pod自动缩放器还可以根据CPU需求缩放复制控制器、副本集或有状态集。</p><p id="a683" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用缩放也带来了一些挑战，比如不在容器的本地文件系统中存储持久数据，因为这将阻止水平自动缩放。相反，可以使用持久卷。</p><p id="8db6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当集群上存在高度可变的工作负载时，集群自动缩放非常有用，这些工作负载可能会根据需求在不同时间需要不同数量的资源。自动删除未使用的节点也是省钱的好方法！</p><h2 id="58c2" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用资源请求和限制(不使用CPU限制)</h2><p id="d5e8" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">应该设置资源请求和限制(容器中可以使用的最小和最大资源量),以避免容器在没有分配所需资源的情况下启动，或者群集用完可用资源。</p><p id="c785" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果没有限制，pod可以利用比所需更多的资源，导致总可用资源减少，这可能会导致集群上的其他应用程序出现问题。节点可能会崩溃，并且调度程序可能无法正确放置新的单元。</p><p id="15f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在没有请求的情况下，如果不能为应用程序分配足够的资源，它可能会在尝试启动或不稳定地执行时失败。</p><p id="a6f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">资源请求和限制定义了可用的CPU和内存量，单位为毫核心和兆字节。请注意，如果您的进程超出了内存限制，该进程将被终止，因此在所有情况下设置该值并不总是合适的。如果你的容器超过了CPU的限制，进程就会被限制。</p><p id="d8cc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最佳实践建议简而言之:</p><ol class=""><li id="abe8" class="mo mp it kk b kl km ko kp kr ns kv nt kz nu ld mv mw mx my bi translated">对所有东西(CPU和内存)使用请求。</li><li id="76f9" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">将内存限制设置为等于内存请求</li><li id="19d7" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">根本不要使用CPU限制</li></ol><p id="1f3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于这一点的更多解释，请看这篇来自<a class="ae lu" href="https://www.linkedin.com/in/natanyellin/" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">纳坦耶林</strong> </a> <strong class="kk iu">的文章。</strong></p><div class="nv nw gp gr nx ny"><a href="https://home.robusta.dev/blog/stop-using-cpu-limits/" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">看在上帝的份上，停止在Kubernetes上使用CPU限制吧</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">许多人认为Kubernetes需要CPU限制，但这不是真的。在大多数情况下，Kubernetes的CPU限制做得更多…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">home.robusta.dev</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om lo ny"/></div></div></a></div><h2 id="fc42" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">将pod作为部署、DaemonSet、ReplicaSet或StatefulSet的一部分跨节点部署。</h2><p id="90a6" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">不应单独运行单个pod。相反，为了提高容错能力，它们应该始终是部署、DaemonSet、ReplicaSet或StatefulSet的一部分。然后，可以在部署中使用反关联性规则跨节点部署pod，以避免所有pod都在单个节点上运行，这可能会导致停机。</p><h2 id="c695" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用多个节点</h2><p id="bb51" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">如果您想内置容错功能，在单个节点上运行K8s并不是一个好主意。您的集群中应该使用多个节点，这样工作负载就可以在它们之间分散。</p><h2 id="5009" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用基于角色的访问控制(RBAC)</h2><p id="43e5" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">在K8s集群中使用RBAC对于确保系统安全至关重要。可以为用户、组和服务帐户分配权限，以对特定命名空间(角色)或整个群集(ClusterRole)执行允许的操作。每个角色可以有多个权限。为了将定义的角色绑定到用户、组或服务帐户，使用了RoleBinding或ClusterRoleBinding对象。</p><p id="c58b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RBAC角色应设置为使用最小特权原则进行授予，即只授予所需的权限。例如，admins组可以访问所有资源，而operators组可以部署，但不能读取机密。</p><h2 id="faa0" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">在外部托管您的Kubernetes集群(使用云服务)</h2><p id="d2bc" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">在自己的硬件上托管K8s集群可能是一项复杂的任务。云服务提供K8s集群即平台即服务(PaaS)，比如Azure上的AKS (Azure Kubernetes服务)，或者Amazon Web Services上的EKS (Amazon Elastic Kubernetes服务)。利用这一点意味着底层基础设施将由您的云提供商管理，并且围绕扩展您的集群的任务(如添加和删除节点)可以更容易地完成，让您的工程师管理K8s集群本身上运行的内容。</p><h2 id="a6cb" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">升级您的Kubernetes版本</h2><p id="51f5" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">除了引入新功能，新的K8s版本还包括漏洞和安全修复，这使得在您的集群上运行最新版本的K8s变得非常重要。对旧版本的支持可能不如新版本好。</p><p id="0629" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，迁移到新版本应谨慎对待，因为某些功能可能会被削弱，也可能会添加新功能。此外，在升级之前，应该检查集群上运行的应用程序是否与较新的目标版本兼容。</p><h2 id="c05d" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">监控您的群集资源和审计策略日志</h2><p id="43d2" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">监控K8s控制平面中的组件对于控制资源消耗非常重要。控制平面是K8s的核心，这些组件保持系统运行，因此对于正确的K8s操作至关重要。Kubernetes API、kubelet、etcd、控制器-管理器、kube-代理和kube-dns组成控制平面。</p><p id="0f91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">控制平面组件可以以Prometheus(最常见的K8s监控工具)可以使用的格式输出指标。</p><p id="cdd9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">应使用自动化监控工具，而不是手动管理警报。</p><p id="e8b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">K8s中的审计日志可以在启动kube-apiserver时打开，以便使用您选择的工具进行更深入的调查。audit.log将详细描述对K8s API的所有请求，并且应该定期检查集群上可能存在的任何问题。Kubernetes集群默认策略在audit-policy.yaml文件中定义，可以根据需要进行修改。</p><p id="64c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Azure Monitor等日志聚合工具可用于将日志从AKS发送到日志分析工作区，以便将来使用Kusto查询进行询问。在AWS上可以使用Cloudwatch。第三方工具也提供更深入的监控功能，如Dynatrace和Datadog。</p><p id="8c86" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，应该为日志确定一个保留期，通常为30–45天左右。</p><h2 id="f2a9" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用版本控制系统</h2><p id="6f1f" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">K8s配置文件应该在版本控制系统(VCS)中进行控制。这带来了许多好处，包括提高安全性、支持变更的审计跟踪，以及提高集群的稳定性。应该为所做的任何更改设置审批关口，以便团队可以在将更改提交到主分支之前对其进行同行评审。</p><h2 id="3998" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用基于Git的工作流(GitOps)</h2><p id="32fc" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">K8s的成功部署需要对您的团队使用的工作流程进行思考。使用基于git的工作流通过使用CI/CD(持续集成/持续交付)管道实现自动化，这将提高应用程序部署效率和速度。CI/CD还将提供部署的审计跟踪。Git应该是所有自动化的唯一来源，并且将支持K8s集群的统一管理。您还可以考虑使用专用的基础设施交付平台，如最近推出Kubernetes支持的<a class="ae lu" href="https://spacelift.io/" rel="noopener ugc nofollow" target="_blank"> Spacelift </a>。</p><h2 id="b377" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">缩小你的容器的尺寸</h2><p id="a53a" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">较小的映像大小将有助于加快构建和部署，并减少容器在K8s集群上消耗的资源量。在可能的情况下，应该删除不重要的包，应该优先选择Alpine之类的小型操作系统分发映像。较小的图像可以比较大的图像拉得更快，占用的存储空间也更少。</p><p id="0c93" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">遵循这种方法还将提供安全优势，因为对于恶意参与者来说，潜在的攻击媒介会更少。</p><h2 id="b143" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">用标签组织您的对象</h2><p id="389f" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">K8s标签是为了组织集群资源而附加到对象上的键值对。标签应该是有意义的元数据，提供一种机制来跟踪K8s系统中不同组件如何交互。</p><p id="f9c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lu" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/" rel="noopener ugc nofollow" target="_blank">官方K8s文档</a>中推荐的吊舱标签包括<code class="fe no np nq nr b">name, instance, version, component, part-of,</code>和<code class="fe no np nq nr b">managed-by.</code></p><p id="1898" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">标签也可以以类似于在云环境中在资源上使用标签的方式使用，以便跟踪与业务相关的事情，例如对象<code class="fe no np nq nr b">ownership</code>，以及对象应该属于的<code class="fe no np nq nr b">environment</code>。</p><p id="6c96" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还建议使用标签详细说明安全要求，包括<code class="fe no np nq nr b">confidentiality</code>和<code class="fe no np nq nr b">compliance.</code></p><h2 id="1b4e" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用网络策略</h2><p id="148a" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">应该采用网络策略来限制K8s集群中对象之间的流量。默认情况下，所有容器都可以在网络中相互通信，如果恶意行为者获得对容器的访问权限，允许他们遍历集群中的对象，这将带来安全风险。网络策略可以在IP和端口级别控制流量，类似于云平台中安全组的概念来限制对资源的访问。通常，默认情况下应该拒绝所有流量，然后应该制定允许规则来允许所需的流量。</p><h2 id="05c1" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用防火墙</h2><p id="7202" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">除了使用网络策略来限制K8s集群上的内部流量之外，您还应该在K8s集群前面放置一个防火墙，以便限制来自外部世界的对API服务器的请求。IP地址应该列入白名单，开放端口应该受到限制。</p><h2 id="8245" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">摘要</h2><p id="d04e" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">在设计、运行和维护您的Kubernetes集群时，遵循本文中列出的最佳实践将使您在现代化应用程序之旅中走向成功！</p><p id="7f13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想要更多Kubernetes内容？查看我的其他K8S文章<a class="ae lu" href="https://jackwesleyroper.medium.com/kubernetes-k8s-related-articles-index-54718769e390" rel="noopener">这里</a>！</p><p id="9660" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">干杯！🍻</p><div class="nv nw gp gr nx ny"><a href="https://www.buymeacoffee.com/jackwesleyroper" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">Jack Roper正在Azure、Azure DevOps、Terraform、Kubernetes和Cloud tech上写博客！</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">希望我的博客能帮到你，你会喜欢它的内容！我真的很喜欢写技术内容和分享…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om lo ny"/></div></div></a></div><p id="b012" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="oo">原载于</em><a class="ae lu" href="https://spacelift.io/" rel="noopener ugc nofollow" target="_blank"><em class="oo">space lift . io</em></a><em class="oo">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Angular with Eslint, Prettier, husky</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">棱角分明，更漂亮，沙哑</h1>
<blockquote>原文：<a href="https://itnext.io/angular-with-eslint-prettier-husky-6581ecd66fbb?source=collection_archive---------2-----------------------#2022-02-27">https://itnext.io/angular-with-eslint-prettier-husky-6581ecd66fbb?source=collection_archive---------2-----------------------#2022-02-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="47dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们将创建一个新的Angular项目，我们将配置<strong class="jp ir"> eslint，beautiful和husky </strong>。棉绒和git挂钩对于个人和公司项目都是必要的。我将使用没有大量扩展的全新VSCode安装(实际上只需要更漂亮)。</p><p id="1c08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大多数用户在Windows机器上本地安装了Node.js，所以我将遵循完全相同的方法，但是作为Docker爱好者，我将提供等效的命令。如果你像我一样使用一个<a class="ae kl" href="https://medium.com/@stavrosdro/docker-development-environment-angular-full-guide-a38ee34fb651" rel="noopener"> docker开发环境</a>，你会得到同样的结果。</p><p id="8e76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成以下步骤后，我们将准备好:</p><ul class=""><li id="c0ed" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">每次保存文件后自动格式化代码。</li><li id="7b04" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">用代码识别器识别错误。</li><li id="2308" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">在git提交或git推送之前执行linter和测试。</li><li id="2e50" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">享受一致的代码库，减少差异和合并冲突。</li></ul><blockquote class="la lb lc"><p id="fe6a" class="jn jo ld jp b jq jr js jt ju jv jw jx le jz ka kb lf kd ke kf lg kh ki kj kk ij bi translated">本文的目的是让团队可以轻松地克隆一个项目并开始工作，而无需花费时间来配置他们的本地设置。唯一需要的扩展是更漂亮。</p></blockquote></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h2 id="c2cc" class="lo lp iq bd lq lr ls dn lt lu lv dp lw jy lx ly lz kc ma mb mc kg md me mf mg bi translated">创建新项目并安装依赖项</h2><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="06a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">.editorconfig</code>的配置</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="7fa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">.prettierrc</code>的配置</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="04a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">.eslintignore</code>的配置</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="583e" class="lo lp iq bd lq lr ls dn lt lu lv dp lw jy lx ly lz kc ma mb mc kg md me mf mg bi translated">配置linter、package.json和工作空间设置</h2><p id="77b7" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">现在，我们必须配置eslint来使用prettier作为格式化程序，并更新VSCode本地设置。</p><p id="7cdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更新package.json中的脚本</p><pre class="mh mi mj mk gt mx mr my mz aw na bi"><span id="7054" class="lo lp iq mr b gy nb nc l nd ne">"test": "ng test --watch=false --browsers ChromeHeadless",<br/>"lint": "npx eslint \"src/**/*.{js,jsx,ts,tsx,html}\" --quiet --fix",<br/>"format": "npx prettier \"src/**/*.{js,jsx,ts,tsx,html,css,scss}\" --write"</span></pre><p id="119f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用这种eslint配置。与默认值的不同之处在于，我们为typescript和html文件添加了这一行<code class="fe mo mp mq mr b">"plugin:prettier/recommended"</code>。此外，我们创建了一个关于html组件的更具体的规则，我们希望应用linter的规则。</p><p id="6407" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">eslintrc.json</code>的配置</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nf"><img src="../Images/24da2331ba182ca670662b95e37e3ee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LaVpx9_wcPIiYyLaSOhgA.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">仅复制第20和39行</figcaption></figure><p id="689b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">键入<code class="fe mo mp mq mr b">CTRL+SHIFT+P</code>，搜索<code class="fe mo mp mq mr b">workspace settings (JSON)</code>并使用以下设置</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="d78e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以运行<code class="fe mo mp mq mr b">npm run format</code>来格式化您的整个工作空间。从现在起，每次你保存文件时，它将被自动格式化。<br/>同样，我们可以运行<code class="fe mo mp mq mr b">npm run lint</code>来检查我们的代码中的林挺错误。</p><h2 id="02fe" class="lo lp iq bd lq lr ls dn lt lu lv dp lw jy lx ly lz kc ma mb mc kg md me mf mg bi translated"><strong class="ak">安装Husky &amp;增加预推钩</strong></h2><p id="e276" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated"><a class="ae kl" href="https://typicode.github.io/husky/#/" rel="noopener ugc nofollow" target="_blank"> Husky </a>是使用Git钩子的一个很棒的工具。我建议遵循自动安装并运行<code class="fe mo mp mq mr b">npx husky-init &amp;&amp; npm install</code>。这也将创建一个预提交挂钩。您可以通过运行<code class="fe mo mp mq mr b">npx husky add .husky/pre-push "npm test"</code>来创建预推挂钩</p><p id="ec95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的预提交文件</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="015a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的预推送文件</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="2cb4" class="lo lp iq bd lq lr ls dn lt lu lv dp lw jy lx ly lz kc ma mb mc kg md me mf mg bi translated"><strong class="ak">奖金</strong></h2><ul class=""><li id="d4e1" class="km kn iq jp b jq ms ju mt jy nq kc nr kg ns kk kr ks kt ku bi translated">您可以使用工作区设置中的<code class="fe mo mp mq mr b">"editor.codeActionsOnSave": { "source.organizeImports": true }</code>规则对导入进行排序，并删除未使用的导入。这是一个很好的规则，但是请记住，有些关键文件(例如test.ts)必须有特定的顺序。如果你知道这些文件，上述规则将会节省时间。</li><li id="ad8e" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">您可以创建关于导入的更复杂的规则，比如将外部导入放在顶部，用空行将它们与内部导入分开。这些规则应该在<code class="fe mo mp mq mr b">eslintrc.json</code>中定义，但是您需要一个扩展来自动应用它们。</li><li id="c4ff" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">如果你基于某些扩展创建更复杂的规则，你可以使用<code class="fe mo mp mq mr b">extensions.json</code>文件通知团队推荐的扩展。请确保检查您需要的扩展是否已经过时，并相应地更新您的代码库。</li><li id="5251" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">要保存文件而不格式化，输入<code class="fe mo mp mq mr b">CTRL+SHIFT+P</code>并搜索<em class="ld">保存文件而不格式化</em>。</li><li id="0e40" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">您可以通过使用<code class="fe mo mp mq mr b">--no-verify</code>选项绕过git挂钩。</li></ul><blockquote class="la lb lc"><p id="8fac" class="jn jo ld jp b jq jr js jt ju jv jw jx le jz ka kb lf kd ke kf lg kh ki kj kk ij bi translated">就是这个！现在我们有一个最小的设置和巨大的潜力！<br/>在这里找到<a class="ae kl" href="https://github.com/stavrosdro/angular-demo-app" rel="noopener ugc nofollow" target="_blank">的代号</a>。<br/>享受🚀🚀🚀</p></blockquote></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h2 id="7fb5" class="lo lp iq bd lq lr ls dn lt lu lv dp lw jy lx ly lz kc ma mb mc kg md me mf mg bi translated"><strong class="ak">面向Docker爱好者的演练</strong></h2><p id="a635" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">对于码头工人奖学金，我从这个<code class="fe mo mp mq mr b">Dockerfile</code>开始</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="4700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用<code class="fe mo mp mq mr b">docker build -t ng-image .</code>构建docker图像，用<code class="fe mo mp mq mr b">docker run -it -v $(pwd):/app -p 4200:4200 -p 49153:49153 --name ng-container ng-image sh</code>创建你的容器</p><p id="2fed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你一般要按照上面的步骤来。我将指出以下不同之处:</p><p id="940a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建应用程序:<code class="fe mo mp mq mr b">ng new angular-demo-app --skip-git</code></p><p id="0a2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更新package.json中的脚本</p><pre class="mh mi mj mk gt mx mr my mz aw na bi"><span id="e86d" class="lo lp iq mr b gy nb nc l nd ne">"start": "ng serve --host 0.0.0.0 --poll",<br/>"test": "ng test --watch=false",<br/>"lint": "npx eslint 'src/**/*.{js,jsx,ts,tsx,html}' --quiet --fix",<br/>"format": "npx prettier 'src/**/*.{js,jsx,ts,tsx,html,css,scss}' --write"</span></pre><p id="e5dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了运行测试，您必须对<code class="fe mo mp mq mr b">karma.conf.js</code>文件进行一些修改。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nt"><img src="../Images/42bd736ca6f6f0a519d89e9c0a151b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jFBMoTMlb2pYp1-mDfGiug.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">仅复制第1、2行和第36–42行</figcaption></figure><p id="13e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你有了完全相同的配置。最后一个变化是修改钩子以使用工具容器来执行钩子。</p><p id="e03a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe mo mp mq mr b">pre-commit</code>和<code class="fe mo mp mq mr b">pre-push</code>文件。</p><p id="409f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<code class="fe mo mp mq mr b">npm run lint</code>替换为<code class="fe mo mp mq mr b">docker exec -i ng-container sh -c "cd angular-demo-app &amp;&amp; npm run lint"</code></p><p id="7342" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<code class="fe mo mp mq mr b">npm test</code>替换为<code class="fe mo mp mq mr b">docker exec -i ng-container sh -c "cd angular-demo-app &amp;&amp; npm test"</code></p><p id="b128" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在一切准备就绪！您可以使用<code class="fe mo mp mq mr b">docker exec -i ng-container sh -c "cd angular-demo-app &amp;&amp; npm test"</code>在本地运行测试。此外，通过对husky hooks进行上述修改，您可以像以前一样提交和推送代码。</p><blockquote class="la lb lc"><p id="c9f9" class="jn jo ld jp b jq jr js jt ju jv jw jx le jz ka kb lf kd ke kf lg kh ki kj kk ij bi translated">在这里找到代码<a class="ae kl" href="https://github.com/stavrosdro/angular-demo-app" rel="noopener ugc nofollow" target="_blank"/>。<br/>享受🚀🚀🚀</p></blockquote></div></div>    
</body>
</html>
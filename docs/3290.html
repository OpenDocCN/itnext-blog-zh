<html>
<head>
<title>The Two Most Important Challenges with an API Gateway when Adopting Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">采用Kubernetes时，API网关面临的两个最重要的挑战</h1>
<blockquote>原文：<a href="https://itnext.io/the-two-most-important-challenges-with-an-api-gateway-when-adopting-kubernetes-cf2d63bab7e7?source=collection_archive---------4-----------------------#2019-11-14">https://itnext.io/the-two-most-important-challenges-with-an-api-gateway-when-adopting-kubernetes-cf2d63bab7e7?source=collection_archive---------4-----------------------#2019-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a16b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">扩展边缘管理并支持多种需求</h2></div><p id="96e8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用微服务模式构建应用程序并将这些服务部署到Kubernetes上已经成为当今运行云原生应用程序的实际方法。在微服务架构中，单个应用被分解成多个微服务。每个微服务都由一个小团队所有，该团队有权也有责任为特定的微服务做出正确的决策。</p><p id="7efe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种责任通常从用户请求到达的系统边缘开始，一直延伸到服务的业务逻辑，并向下延伸到相关的消息传递和数据存储模式。</p><blockquote class="lb lc ld"><p id="1567" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated"><strong class="kh ir">边缘和Kubernetes入口</strong></p><p id="11a2" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">最终用户需要能够访问微服务。内部微服务和最终用户之间的边界被称为<strong class="kh ir">边缘</strong>。为了让最终用户访问内部应用程序，流量需要跨越边界。在Kubernetes，流量通过一个叫做<strong class="kh ir">入口</strong>的软件越过边界。</p></blockquote><p id="3c03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当将API网关与运行在Kubernetes上的基于微服务的应用程序集成时，您必须考虑两个主要挑战:</p><ul class=""><li id="8c14" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la ln lo lp lq bi translated">如何扩展数百个服务和相关API的管理；和</li><li id="c42c" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">网关如何支持广泛的微服务架构、协议和配置，这些架构、协议和配置通常跨越整个边缘堆栈。</li></ul><h1 id="b215" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">API网关:微服务的焦点</h1><p id="5755" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">API网关是如何管理、保护和呈现API的核心。它作为一个软件组件(或一系列组件)部署在虚拟机上或Kubernetes中，充当系统的单一入口点。API网关的主要职责是让用户能够可靠、安全地访问多个API、微服务和后端系统。</p><p id="0f82" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">微服务和Kubernetes提供了实现灵活性。例如，一个团队可能选择在系统边缘(内部服务和最终用户之间的边界)将基于容器的微服务公开为一组基于HTTP的REST APIs。另一个团队可能会选择Protobufs和gRPC。有实时流需求的团队可以通过WebSocket APIs公开他们的微服务。Kubernetes中部署的任何API网关都必须支持所有这些协议。</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi mt"><img src="../Images/7a1aa2418a59b0a366b419d8929c8d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FBRv0GDRsLezzQOO.png"/></div></div></figure><p id="0b63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个团队不仅可以自由做出这些选择，而且还要对后果负责；这通常解释为“你建造它，你运行它”。虽然不是每个组织都完全赞同这种工作方式，但每个微服务团队都需要能够理解、诊断和配置处理每个服务和每个用户对应用程序的请求的所有方面。与应用和API相关的运行时需求的多样性意味着每个团队将与edge堆栈中的所有层一起工作，例如，动态请求处理、WAF和任何缓存实现。</p><blockquote class="nf"><p id="a7d6" class="ng nh iq bd ni nj nk nl nm nn no la dk translated">微服务的开发范式——独立、授权和负责任的团队——为使用API网关、Kubernetes ingress和edge的微服务团队带来了一系列新的挑战。</p></blockquote><p id="5ca9" class="pw-post-body-paragraph kf kg iq kh b ki np jr kk kl nq ju kn ko nr kq kr ks ns ku kv kw nt ky kz la ij bi translated">在本文中，我们确定了edge面临的两个重要挑战:管理独立的微服务，以及访问全面的edge堆栈。</p><h1 id="f56c" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">挑战#1:扩展边缘管理</h1><p id="c68b" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated"><strong class="kh ir">管理边缘的挑战随着部署的微服务数量的增加而增加</strong></p><p id="a57f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在微服务架构中，工程师将管理更多的服务和应用。每个团队都需要能够独立地管理他们的服务，以便将发布从其他团队的计划中分离出来。在边缘公开应用程序的传统方法通常是通过集中运营或平台团队来完成的。然而，当一个组织拥有数百个微服务时，单个运营团队无法扩展以处理必要的变更量。</p><p id="763d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要修改边缘配置的典型更改:</p><ul class=""><li id="aff8" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la ln lo lp lq bi translated">正在部署的服务的新版本。</li><li id="3f37" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">修改端点、路由指令或相关的后端服务。</li><li id="c25a" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">对身份验证和授权服务的更改。</li><li id="2083" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">修改非功能性需求，如速率限制、超时、重试模式和断路。</li><li id="2b7b" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">用户对新功能的测试，例如，为一小部分beta测试用户启用一个功能。</li></ul><p id="f303" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">采用基于微服务的架构将导致发布数量的显著增加。这种增长只会加剧边缘管理的挑战，并增加集中运营方法的压力。</p><h1 id="31ee" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">挑战#2:支持多样化的边缘需求</h1><p id="1720" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated"><strong class="kh ir">微服务在边缘引入了许多新问题</strong></p><p id="c50a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">微服务架构支持架构灵活性。应用程序开发人员利用这种灵活性来选择最适合服务特定需求的编程语言和架构。无论架构如何，edge都需要支持需要向用户公开的各种功能。这扩展了API网关的传统角色，与边缘整合工具需求相关的一些挑战包括:</p><ul class=""><li id="9dd1" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la ln lo lp lq bi translated">熟练路由各种协议的能力。常见的协议包括HTTP/1.1、HTTP/2、WebSockets、gRPC、gRPC-Web和TCP。</li><li id="1294" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">提供任何特定服务所需的完整的边缘功能集合，范围从流量管理到可观察性到身份验证等等。</li><li id="b17e" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">在应用程序开发人员的自助服务模型中公开这些功能。</li></ul><p id="8905" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">鼓励微服务团队内部实现的多样性允许工程师选择“合适的工作工具”。然而，底层平台的整合提供了许多好处。与其让开发人员为额外的协议支持或安全处理构建定制的实现，不如在边缘为他们提供预先批准的“自助餐”选项，以便他们可以挑选最合适的功能组合，这样更易于管理和扩展。</p><h1 id="9dca" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">摘要</h1><p id="dcdd" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">随着组织采用Kubernetes并转向基于微服务的架构，终端用户和内部微服务之间的边界出现了一系列新的挑战。因此，在采用微服务时，系统的这个“边缘”以及API网关等相关技术是一个焦点。这些新的边缘挑战是由微服务的组织模式驱动的，在这种模式下，独立团队有权并负责为微服务做出正确的架构和实施决策。</p><p id="0d65" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">管理系统的边缘总是很复杂。使用多种架构添加更多服务只会增加对边缘的需求。平台团队必须相应地设计、选择和实现他们的API网关和边缘工具。</p><p id="9230" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="le">这个故事最初出现在</em><a class="ae nu" href="https://www.getambassador.io/resources/challenges-api-gateway-kubernetes" rel="noopener ugc nofollow" target="_blank"><em class="le">https://www . getambassador . io/resources/challenges-API-gateway-kubernetes</em></a></p></div></div>    
</body>
</html>
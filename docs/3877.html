<html>
<head>
<title>Getting started with inlets: an OSS tunnel for HTTP &amp; websockets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">入口入门:HTTP &amp; websockets的OSS隧道</h1>
<blockquote>原文：<a href="https://itnext.io/get-started-with-free-http-and-websocket-tunnels-30c9ac3fd247?source=collection_archive---------2-----------------------#2020-03-17">https://itnext.io/get-started-with-free-http-and-websocket-tunnels-30c9ac3fd247?source=collection_archive---------2-----------------------#2020-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7b5a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可能听说过各种免费提供HTTP隧道的网站，但它似乎总是带有严重的限制或相对较高的价格标签。我想告诉你如何开始一个开源隧道，你可以免费托管自己。</p><p id="6ff3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用HTTP隧道的主要原因是为了获得一个公共端点，您可以与您的团队、客户或第三方API共享该端点来接收webhooks。</p><blockquote class="ko kp kq"><p id="afd0" class="jq jr kr js b jt ju jv jw jx jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kn im bi translated">考虑测试与PayPal或Stripe等支付处理器的计费集成。你将如何把这个网络钩子连接到你的笔记本电脑或本地网络上？这几乎是不可能的，除非你使用HTTP隧道。</p></blockquote><p id="7817" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，在引言中，我提到了很多SaaS隧道都有严重的限制，比如每小时60次浏览，或者在URL改变前7小时的持续时间。大约一年前，我开始着手解决这个问题，并创建了一个开源项目，这意味着你可以托管一个带有公共IP的廉价VPS或VM，并在那里运行你的隧道服务器。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/08e9b86fe194748e9974b36836ac7387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22R8JdwYOLTpm5Tq_hl_9g.png"/></div></div></figure><p id="2e41" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，您可以在笔记本电脑或本地网络上运行您的客户端，它将充当一种路由器。所有客户端从公共IP连接到您的服务，并被重定向到您的本地服务。</p><h1 id="8a55" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">引入入口</h1><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/17f60dca169d7da4d45edbcd4f53fd77.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*HIyxWaoP2lIluUCZdN6vKg.png"/></div></figure><p id="4c06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，Inlets 拥有6k GitHub stars和世界各地的许多用户，还有自己的社区和<a class="ae mg" href="https://slack.openfaas.io/" rel="noopener ugc nofollow" target="_blank"> Slack频道</a>。</p><blockquote class="ko kp kq"><p id="332e" class="jq jr kr js b jt ju jv jw jx jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kn im bi translated">您可以使用自己的Terraform或我们为您创建的免费工具之一来手动配置入口出口服务器。</p></blockquote><p id="ca81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用inlets的免费OSS版本，您可以获得一个HTTP隧道，它可以支持TLS，也可以代理websocket流量。使用专业版，您可以获得内置的标准自动TLS加密，并可以代理任何TCP流量，如数据库、TLS、RDP、VNC、SSH和专有TCP协议。</p><p id="c718" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<a class="ae mg" href="https://github.com/inlets/inlets" rel="noopener ugc nofollow" target="_blank">入口二进制</a>进行手动供应可提供:</p><ul class=""><li id="9b29" class="mh mi it js b jt ju jx jy kb mj kf mk kj ml kn mm mn mo mp bi translated">总量控制</li><li id="616e" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">使用任何云或现有主机</li><li id="805a" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">按照您喜欢的方式配置TLS</li></ul><p id="773c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<a class="ae mg" href="https://github.com/inlets/inletsctl" rel="noopener ugc nofollow" target="_blank"> inletsctl </a>进行自动配置</p><ul class=""><li id="8f4f" class="mh mi it js b jt ju jx jy kb mj kf mk kj ml kn mm mn mo mp bi translated">inletsctl在Azure、DigitalOcean、Civo、Google Cloud、Amazon和Packet中的任意一个上创建云主机</li><li id="1422" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">如果使用专业版，您将获得作为软件包一部分的内置TLS加密</li><li id="b0e6" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">或者您可以通过SSH登录，然后添加TLS</li><li id="168b" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">与OSS或PRO版本配合使用</li></ul><p id="0f95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不需要Kubernetes、Docker或任何与容器有关的东西。</p><p id="62ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">带<a class="ae mg" href="https://github.com/inlets/inlets-operator/" rel="noopener ugc nofollow" target="_blank">入口的自动化-操作员</a></p><ul class=""><li id="bd11" class="mh mi it js b jt ju jx jy kb mj kf mk kj ml kn mm mn mo mp bi translated">inlets-operator是一个Kubernetes集成，它接受集群中的任何负载平衡器服务，并在公共云上为其创建一个虚拟机，然后用该IP更新本地集群</li><li id="6744" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">它也可以支持使用inlets PRO的IngressController</li><li id="5978" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">它自带隧道CRD，便于管理</li><li id="7897" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">共享来自inletsctl的相同配置代码，并且可以与OSS或PRO版本一起使用</li></ul><h1 id="7081" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">尝试一下</h1><p id="2241" class="pw-post-body-paragraph jq jr it js b jt mv jv jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn im bi translated">从GitHub获取<code class="fe na nb nc nd b">inletsctl</code>:</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="f1ef" class="ni li it nd b gy nj nk l nl nm">curl -sSL <a class="ae mg" href="https://inletsctl.inlets.dev" rel="noopener ugc nofollow" target="_blank">https://inletsctl.inlets.dev</a> | sudo sh</span></pre><p id="1241" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您现在可以使用inletsctl下载inlets客户机/服务器二进制文件，稍后我们将使用inlets客户机命令。</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="3669" class="ni li it nd b gy nj nk l nl nm">inletsctl download</span><span id="afce" class="ni li it nd b gy nn nk l nl nm"># Or download the PRO edition</span><span id="30a5" class="ni li it nd b gy nn nk l nl nm">inletsctl download --pro</span></pre><p id="e524" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行一个本地HTTP服务器，这样您就有东西可以代理了:</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="aaec" class="ni li it nd b gy nj nk l nl nm">mkdir -p /tmp/shared-files/<br/>cd /tmp/shared-files/<br/>echo "Welcome to my shared files" &gt; readme.txt</span></pre><p id="aeec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您安装了Python，您可以在这个文件夹中启动一个简单的服务器，它将监听端口8000。</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="062f" class="ni li it nd b gy nj nk l nl nm">python -m SimpleHTTPServer</span></pre><p id="b301" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在使用inletsctl创建一个出口服务器，记住，如果您愿意，您可以手动完成这个操作，然后运行服务器。</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="075b" class="ni li it nd b gy nj nk l nl nm">inletsctl create --provider digitalocean \<br/>  --region lon1 \<br/>  --access-token-file ~/Downloads/access-token</span></pre><p id="1101" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我从我的DigitalOcean dashboard保存了一个访问令牌，它将用于创建我的退出服务器。</p><p id="00aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">几秒钟后，你会得到一个可以用来连接你的客户端的命令。</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="df5d" class="ni li it nd b gy nj nk l nl nm">Using provider: digitalocean<br/>Requesting host: romantic-ritchie0 in lon1, from digitalocean</span><span id="2a95" class="ni li it nd b gy nn nk l nl nm">2020/03/17 17:54:18 Provisioning host with DigitalOcean<br/>Host: 185188454, status:<br/>[1/500] Host: 185188454, status: new<br/>...<br/></span></pre><p id="7b24" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您使用的是inlets-pro，那么您只需再添加一个标志来配置pro服务器:</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="893c" class="ni li it nd b gy nj nk l nl nm">inletsctl create --provider digitalocean \<br/>  --region lon1 \<br/>  --access-token-file ~/Downloads/access-token \<br/>  --remote-tcp 127.0.0.1</span></pre><p id="bffc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">附加标志是<code class="fe na nb nc nd b">--remote-tcp</code>,它告诉服务器在哪里代理TCP流量的传入请求。通常这是您的本地计算机。</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="4634" class="ni li it nd b gy nj nk l nl nm">Inlets OSS exit-node summary:<br/>IP: 206.189.18.72</span><span id="7c00" class="ni li it nd b gy nn nk l nl nm">Auth-token: SLcdRh1nZR1yBNTm1kJsGNJKxu9V40eEwcIx1ZTXl1RiGtUONj70gyvNmMOdeCsf<br/>Command:</span><span id="3422" class="ni li it nd b gy nn nk l nl nm">export UPSTREAM=http://127.0.0.1:8000<br/>inlets client --remote "ws://206.189.18.72:8080" \<br/>--token "SLcdRh1nZR1yBNTm1kJsGNJKxu9V40eEwcIx1ZTXl1RiGtUONj70gyvNmMOdeCsf" \<br/>--upstream $UPSTREAM</span><span id="abc8" class="ni li it nd b gy nn nk l nl nm">To Delete:<br/>inletsctl delete --provider digitalocean --id "185188454"</span></pre><ul class=""><li id="0ea1" class="mh mi it js b jt ju jx jy kb mj kf mk kj ml kn mm mn mo mp bi translated">您的身份验证令牌用于向出口服务器验证您的inlets客户端或inlets PRO客户端。</li><li id="53c2" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">该IP是您的用户将访问的公共IP</li><li id="6946" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">上游URL是将传入请求发送到的地方，在我们的Python服务器示例中，它已经被正确地设置为端口8000，但是正如您所看到的，这可以指向另一台PC。</li></ul><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="6ad6" class="ni li it nd b gy nj nk l nl nm">export UPSTREAM=http://127.0.0.1:8000<br/>inlets client --remote "ws://206.189.18.72:8080" \<br/>--token "SLcdRh1nZR1yBNTm1kJsGNJKxu9V40eEwcIx1ZTXl1RiGtUONj70gyvNmMOdeCsf" \<br/>--upstream $UPSTREAM</span><span id="fbad" class="ni li it nd b gy nn nk l nl nm">2020/03/17 17:57:16 Welcome to inlets.dev! Find out more at <a class="ae mg" href="https://github.com/inlets/inlets" rel="noopener ugc nofollow" target="_blank">https://github.com/inlets/inlets</a><br/>2020/03/17 17:57:16 Starting client - version 2.6.4<br/>2020/03/17 17:57:16 Upstream:  =&gt; <a class="ae mg" href="http://127.0.0.1:8000" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000</a><br/>2020/03/17 17:57:16 Token: "SLcdRh1nZR1yBNTm1kJsGNJKxu9V40eEwcIx1ZTXl1RiGtUONj70gyvNmMOdeCsf"<br/>INFO[0000] Connecting to proxy                           url="ws://206.189.18.72:8080/tunnel"</span></pre><p id="ce2c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，您可以连接到公共IP并与您的同事或朋友分享:</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="a94d" class="ni li it nd b gy nj nk l nl nm">curl 206.189.18.72</span><span id="7c6c" class="ni li it nd b gy nn nk l nl nm">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;&lt;html&gt;<br/>&lt;title&gt;Directory listing for /&lt;/title&gt;<br/>&lt;body&gt;<br/>&lt;h2&gt;Directory listing for /&lt;/h2&gt;<br/>&lt;hr&gt;<br/>&lt;ul&gt;<br/>&lt;li&gt;&lt;a href="readme.txt"&gt;readme.txt&lt;/a&gt;<br/>&lt;/ul&gt;<br/>&lt;hr&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e50f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如你所见，它如预期的那样工作。</p><p id="5ed5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更进一步:</p><ul class=""><li id="ae3c" class="mh mi it js b jt ju jx jy kb mj kf mk kj ml kn mm mn mo mp bi translated">你甚至可以继续添加一个虚名DNS名称，如client-x.example.com。</li><li id="6356" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">您可能希望为inletsctl创建的主机添加TLS加密，您可以使用您最喜欢的反向代理来实现。<a class="ae mg" href="https://blog.alexellis.io/https-inlets-local-endpoints/" rel="noopener ugc nofollow" target="_blank">在我最初的指南中，我用的是Caddy，配置简单得不能再简单了</a>。</li><li id="fdb6" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">尝试使用Socket.io 公开一个依赖于websockets的应用程序，比如一个<a class="ae mg" href="https://socket.io" rel="noopener ugc nofollow" target="_blank"> Node.js应用程序</a></li><li id="6c85" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">将您的<a class="ae mg" href="https://docs.inlets.dev/#/get-started/quickstart-ingresscontroller-cert-manager?id=expose-your-ingresscontroller-and-get-tls-from-letsencrypt" rel="noopener ugc nofollow" target="_blank">Kubernetes Ingres controller暴露在互联网上</a></li><li id="6a09" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated"><a class="ae mg" href="https://docs.inlets.dev/#/get-started/quickstart-tcp-ssh?id=get-ssh-access-from-anywhere" rel="noopener ugc nofollow" target="_blank">用inlets PRO暴露SSH</a></li></ul><h2 id="a586" class="ni li it bd lj no np dn ln nq nr dp lr kb ns nt lv kf nu nv lz kj nw nx md ny bi translated">包扎</h2><p id="b96f" class="pw-post-body-paragraph jq jr it js b jt mv jv jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn im bi translated">因为我已经用完了我的出口服务器，所以我现在要删除它。</p><pre class="kw kx ky kz gt ne nd nf ng aw nh bi"><span id="44aa" class="ni li it nd b gy nj nk l nl nm">inletsctl delete --provider digitalocean --id "185188454" --access-token-file ~/Downloads/access-token</span></pre><p id="4816" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将inlets作为云原生隧道引入，因为它可以与Docker和Kubernetes很好地集成，但是它也可以单独作为简单的二进制文件或与systemd一起工作。它是多拱的，所以也适用于树莓派，并且易于安装。对于那些想要内置加密和TCP支持的人来说，<a class="ae mg" href="https://docs.inlets.dev/#/?id=pricing" rel="noopener ugc nofollow" target="_blank"> inlets-pro可以购买，或者免费试用14天</a>。</p><p id="3428" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你也可以在OpenFaaS Ltd商店购买一个<a class="ae mg" href="https://store.openfaas.com/" rel="noopener ugc nofollow" target="_blank">入口杯、t恤和帽衫。</a></p><p id="72b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">提醒一下，这里有三种口味的入口:</p><ul class=""><li id="fa40" class="mh mi it js b jt ju jx jy kb mj kf mk kj ml kn mm mn mo mp bi translated"><a class="ae mg" href="https://github.com/inlets/inlets" rel="noopener ugc nofollow" target="_blank">入口客户端/服务器二进制</a>用于简单的自我管理隧道</li><li id="7b0a" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated"><a class="ae mg" href="https://github.com/inlets/inletsctl" rel="noopener ugc nofollow" target="_blank"> inletsctl </a>自动化云虚拟机和出口服务器</li><li id="f0aa" class="mh mi it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated"><a class="ae mg" href="https://github.com/inlets/inlets-operator/" rel="noopener ugc nofollow" target="_blank">入口——运营商</a>,可实现Kubernetes服务和云虚拟机创建的自动化</li></ul></div></div>    
</body>
</html>
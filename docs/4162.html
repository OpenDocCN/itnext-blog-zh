<html>
<head>
<title>OutSystems Reactive Security</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">外部系统反应安全</h1>
<blockquote>原文：<a href="https://itnext.io/outsystems-reactive-security-8ca98c3639f9?source=collection_archive---------6-----------------------#2020-05-07">https://itnext.io/outsystems-reactive-security-8ca98c3639f9?source=collection_archive---------6-----------------------#2020-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/5e1dae6e21d2a396321d120a20747361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1__iataz44FvAsKCjABAg.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">确保主动保护您的外部系统反应式应用程序</figcaption></figure><div class=""/><p id="9d8e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">OutSystems Platform于2019年10月发布了一款新的web应用，名为Reactive Web App。从那时起，几个<a class="ae la" href="https://www.outsystems.com/whats-new/" rel="noopener ugc nofollow" target="_blank">更新已经发布</a>，随着每个新版本的推出，反应式网络应用变得越来越好。这让我想知道，我们都习惯于传统Web应用程序的安全功能是否仍然适用于反应式Web应用程序。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lb"><img src="../Images/d96331829184ca3a54ea5230c05c652a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OK_ws72dLgsjBiACHu2mQQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">外部系统中的不同风味</figcaption></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="72ee" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一个反应式Web App由两部分组成，<strong class="ke jg">客户端</strong>和<strong class="ke jg">服务器端</strong>。对双方来说，你需要考虑不同的安全措施。</p><h1 id="015c" class="ln lo jf bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">客户端</h1><p id="e302" class="pw-post-body-paragraph kc kd jf ke b kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz ij bi translated">安全性的经验法则是，一旦代码在客户端，它就可能被最终用户滥用。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mq"><img src="../Images/94f307e9221963691608fac711de18f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQfQSdarOqjdd-Lq7-7pwA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">客户端安全性</figcaption></figure><h2 id="8f69" class="mr lo jf bd lp ms mt dn lt mu mv dp lx kn mw mx mb kr my mz mf kv na nb mj nc bi translated">不要在客户端公开敏感数据</h2><p id="b251" class="pw-post-body-paragraph kc kd jf ke b kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz ij bi translated"><strong class="ke jg">客户端代码</strong> (UI、客户端动作、屏幕和块变量、输入参数)转换成web资源(HTML、JavaScript和CSS)。这意味着它可以被操纵。因此，我们需要确保所有安全敏感的代码和数据都在服务器端。</p><p id="7b6f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当使用<strong class="ke jg">客户端变量</strong>时，记住它们存储在浏览器的本地存储器(<a class="ae la" href="https://www.w3schools.com/html/html5_webstorage.asp" rel="noopener ugc nofollow" target="_blank"> HTML Web存储器</a>)中，并且它们可以在应用程序之间<a class="ae la" href="https://success.outsystems.com/Documentation/11/Developing_an_Application/Use_Data/Share_a_Client_Variable_between_apps" rel="noopener ugc nofollow" target="_blank">共享。确保永远不要将敏感数据存储在客户端变量中，也不要使用它们来控制应用程序的流程，因为它们可以使用</a><a class="ae la" href="https://developers.google.com/web/tools/chrome-devtools" rel="noopener ugc nofollow" target="_blank"> Chrome DevTools </a>进行操作。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/e2ada6f52037e5d1d2d021732b09004a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krcBWrkV1C0cz8m3ThIZjA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">带有密码的客户端变量在本地存储中是可见的</figcaption></figure><p id="cf11" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当你需要数据时，不要提取所有的字段。仅获取屏幕所需的数据。获取太多列带来的风险是最终用户可以看到不应该共享的数据。从最新版本开始，<strong class="ke jg">聚合得到优化</strong>，OutSystems平台为您处理这一安全风险。当您使用旧版本时，请更新您的平台或通过限制从聚合返回的数据来最小化此风险。</p><p id="70eb" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当您<strong class="ke jg">从服务器</strong>获取数据时(查询或API调用)，不要使用对返回数据有影响的输入参数。最终用户可以更改这些值并获取一些其他数据。考虑获取一些属于当前登录用户的特定于客户端的详细信息。</p><p id="9bf9" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以将GetUserId()分配给一个名为UserId的局部变量，并将其用作查询或服务器操作的输入参数来获取用户详细信息。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/74266fa7d2ef7926caec229ba02af107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFzpexaVGGCXWWi8B1mTCw.png"/></div></div></figure><p id="c606" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个确切的功能可以被黑客攻击，如下面的短视频所示。想象一下人们可以用这些选项和自动化脚本做什么…</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/9143d9798e375158c815f60ef2c37af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9TQLGh4VGQH6tq5RG3ObgQ.gif"/></div></div></figure><p id="ab14" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一个简单的解决方法是将GetUserId()放在聚合中。聚合运行在服务器上，服务器是安全的，黑客不能再修改这个查询。</p><p id="97ed" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">同样的解决方法适用于基于用户角色获取数据，或者从服务器获取数据，并将标识符或唯一标识元素的另一个元素作为输入参数发送给服务器。</p><h2 id="e55f" class="mr lo jf bd lp ms mt dn lt mu mv dp lx kn mw mx mb kr my mz mf kv na nb mj nc bi translated">使用角色保护屏幕和聚合</h2><p id="5b42" class="pw-post-body-paragraph kc kd jf ke b kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz ij bi translated">对于客户端的每个<strong class="ke jg">聚合和服务器动作</strong>，有一个<strong class="ke jg"> REST API方法暴露出来</strong>来处理它的请求。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d0a61f3a54ca219c4a724b1c70b083b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*30BulxueBEP_99L-Em15ow.png"/></div></figure><p id="e01c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当聚合或服务器操作所属的屏幕是公共的(选择了匿名角色)时，REST API也是公共的。</p><p id="55c6" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">确保当您在公共屏幕中从服务器获取数据时，输入参数不能以任何方式被操作来获得不同的记录。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/59cf06feca902a89d3dba158b5f38d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*Sxp6JsInXPryrhLJjOaUuQ.png"/></div></figure><p id="5138" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以DoLogin()为例。这个是公开的，但是如果没有有效的用户名和密码组合，就不能使用它。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5b1c70fdfa262759f2c3acf2362e898a.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*pddNiO4TsSeSeO9eB19utw.png"/></div></figure><p id="3f6d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当屏幕不是公共的(分配给除匿名角色以外的一个或多个角色)时，<strong class="ke jg">系统基于登录用户实现一个认证机制</strong>。</p><p id="4169" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">只有登录的用户才能使用这个REST API。</p><p id="80af" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当您有一个基于不同角色的具有不同功能的屏幕时，最简单的方法是为每个角色创建一个具有其自身功能的单独屏幕。在一个屏幕上混合角色会影响应用程序的安全性。</p><h2 id="5a93" class="mr lo jf bd lp ms mt dn lt mu mv dp lx kn mw mx mb kr my mz mf kv na nb mj nc bi translated">实施安全机制来保护公开暴露的屏幕</h2><p id="842b" class="pw-post-body-paragraph kc kd jf ke b kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz ij bi translated">对于公共屏幕，你有时需要做一些特殊的事情，比如创建一个账户，重置忘记的密码等等。</p><p id="0b4b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这些情况下，您需要申请一个<a class="ae la" href="https://en.wikipedia.org/wiki/One-time_authorization_code" rel="noopener ugc nofollow" target="_blank">一次性授权码</a> (OTAC)。为此，用户需要表明自己的身份。</p><p id="9734" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当你忘记密码时，你是怎么做的？使用用户可以接收OTC的第二个设备实现流程。想象一下，在一个短信流程中，您会收到一个令牌、一封带有基于时间的特殊URL的电子邮件或一个返回令牌的验证器应用程序。使用这些流中任何一个的结果来唯一地识别您并登录。此时，您已经登录，可以正常使用服务器操作，因为它是安全的。登录后，您可以将重置密码屏幕显示为强制选项。</p><p id="311e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">作为第二种选择，您可以在同一个请求中进行身份验证和重置密码。您请求一个令牌，然后该令牌用于在密码重置流程中识别您的身份。当令牌不正确时，您的密码将不会更新。</p><p id="fbd2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第三种选择是使用一个<a class="ae la" href="https://jwt.io/introduction/" rel="noopener ugc nofollow" target="_blank"> JWT令牌</a>来加密会话，并且只发送加密的数据。</p><h1 id="d9e9" class="ln lo jf bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">服务器端</h1><h2 id="aa09" class="mr lo jf bd lp ms mt dn lt mu mv dp lx kn mw mx mb kr my mz mf kv na nb mj nc bi translated">验证核心模块的安全性</h2><p id="3deb" class="pw-post-body-paragraph kc kd jf ke b kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz ij bi translated">当您向反应式应用程序公开服务器操作时，您应该始终考虑用户未被正确识别的可能性。开始对用户进行验证的操作；GetUserId()和Role检查<rolename>角色()，查看该用户是否被允许执行该操作。</rolename></p><h1 id="a01c" class="ln lo jf bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">技巧</h1><p id="fa4c" class="pw-post-body-paragraph kc kd jf ke b kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz ij bi translated">与传统网络相比，反应式网络的安全性不再是理所当然的，你必须为它做些实际的事情。按照下面的提示进行快速验证。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/4c53adfbd1a8409e14edde46a6f6e60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*013ih2uqohiCE5A6rVkXFA.png"/></div></div></figure><ol class=""><li id="5e3d" class="nk nl jf ke b kf kg kj kk kn nm kr nn kv no kz np nq nr ns bi translated">牢记<a class="ae la" href="http://gemoc.org/pub/20190625-MLE19/paper9.pdf" rel="noopener ugc nofollow" target="_blank">中的警告，真正改变</a>。他们将指导你克服最大的错误，并帮助你提高客户端代码的质量。</li><li id="b9eb" class="nk nl jf ke b kf nt kj nu kn nv kr nw kv nx kz np nq nr ns bi translated">作为额外的选择，您还可以查看架构仪表板，因为这个工具也有几个<a class="ae la" href="https://success.outsystems.com/Documentation/Architecture_Dashboard/Code_Patterns" rel="noopener ugc nofollow" target="_blank">代码分析模式</a>。</li><li id="ddbe" class="nk nl jf ke b kf nt kj nu kn nv kr nw kv nx kz np nq nr ns bi translated">不要将测试屏幕部署到开发环境之外的其他环境中。它们通常是公共屏幕，具有相当多的功能，您可以使用它们来玩数据库。</li><li id="7dbf" class="nk nl jf ke b kf nt kj nu kn nv kr nw kv nx kz np nq nr ns bi translated">跟踪您正在使用的第三方插件。它们也可能包含漏洞。如果您不定期检查或更新组件，您就有可能通过已知的漏洞受到攻击。</li></ol><p id="1c59" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你从这篇文章中学到了一些东西，当你能够修复一个或多个应用程序中的安全问题时，我希望在下面的回复中看到一个简短的评论。</p><p id="3ae3" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">亲切的问候，</p><p id="0e00" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">雷姆科·德金加</p></div></div>    
</body>
</html>
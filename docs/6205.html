<html>
<head>
<title>Jenkins Tutorial — Part 6 — Pipeline Options</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jenkins教程—第6部分—管道选项</h1>
<blockquote>原文：<a href="https://itnext.io/jenkins-tutorial-part-6-pipeline-options-5ccd05035aaf?source=collection_archive---------2-----------------------#2021-09-19">https://itnext.io/jenkins-tutorial-part-6-pipeline-options-5ccd05035aaf?source=collection_archive---------2-----------------------#2021-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c518273176f996c36d381a98cf53ea9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isD_dDi7u493JTm4ZudxOw.jpeg"/></div></div></figure><p id="bc5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Jenkins教程系列的这一部分中，我们将深入研究Jenkins管道选项。使用这些选项，您可以配置管道并更改一些管道行为。建议你先看前面的文章再继续看。你可以在下面的GitHub repo中找到所有发表的文章。</p><p id="788a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你对这个系列教程感兴趣，<strong class="ka ir">之星</strong>凝视这个回购:</p><div class="kw kx gp gr ky kz"><a href="https://github.com/ssbostan/jenkins-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">GitHub——ssbo stan/jenkins——教程:Jenkins参考和管道代码示例</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">如果你觉得有用，就看星星。Jenkins系列教程的参考和示例库。版权所有2021…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><h1 id="e78f" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">Jenkins管道选项:</h1><p id="66c8" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">Jenkins CI中有几个渠道选项。有些是原生选项，有些是由于安装插件而添加的。我打算解释Jenkins堆栈中可用的选项。您可以在Kubernetes和Docker环境中部署这个堆栈。以下存储库是部署Jenkins完整堆栈所需的一切。</p><div class="kw kx gp gr ky kz"><a href="https://github.com/ssbostan/jenkins-stack-kubernetes" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">GitHub-ssbo stan/jenkins-stack-kubernetes:在Kubernetes上部署Jenkins的脚本和清单</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">注意:此存储库是“DevOps with Saeid”类的一部分。部署Jenkins的脚本和清单…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="mr l lk ll lm li ln jw kz"/></div></div></a></div><div class="kw kx gp gr ky kz"><a href="https://github.com/ssbostan/jenkins-stack-docker" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">GitHub-ssbo stan/Jenkins-stack-Docker:Docker-compose版本的jenkins-stack-kubernetes</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">Permalink无法加载最新的提交信息。docker-撰写版本的詹金斯-栈-kubernetes。要查看…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="ms l lk ll lm li ln jw kz"/></div></div></a></div><h1 id="62b9" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">如何配置管道选项:</h1><p id="0c10" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">管道选项设置在管道的<code class="fe mt mu mv mw b">options</code>块内。</p><p id="7b15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有一个例子:</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="e190" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么我们来介绍一下可用的选项及其作品。</p><p id="b8ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的例子中显示的<strong class="ka ir"> buildDiscarder </strong>，用于删除旧的构建和工件。您可以根据构建和工件的日期和数量来设置旋转器。看上面的例子。</p><p id="12a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> checkoutToSubdirectory </strong>用于将<code class="fe mt mu mv mw b">checkout scm</code>命令的目录更改为管道工作区的子目录。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="3515" class="nh lp iq mw b gy ni nj l nk nl">checkoutToSubdirectory("mycheckout")</span></pre><p id="0a15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> copyArtifactPermission </strong>用于定义允许他们复制该作业工件的项目列表。您可以从它的<a class="ae nm" href="https://plugins.jenkins.io/copyartifact" rel="noopener ugc nofollow" target="_blank">插件</a>(复制工件插件)文档中了解更多关于复制工件的信息。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="ec99" class="nh lp iq mw b gy ni nj l nk nl">copyArtifactPermission("job1,myjob,testjob5")</span></pre><p id="0e39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">disableConcurrentBuilds</strong>用于禁用并发构建。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="7c64" class="nh lp iq mw b gy ni nj l nk nl">disableConcurrentBuilds()</span></pre><p id="235e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">禁用恢复</strong>如果Jenkins的控制器重启，则禁用构建恢复功能。控制器正是詹金斯的主人。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="b2b9" class="nh lp iq mw b gy ni nj l nk nl">disableResume()</span></pre><p id="abb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">耐久性提示</strong>用于覆盖作业的速度/耐久性选项。您可以使作业在控制器停机后可恢复(这会消耗更多时间和更多磁盘写入)，或者使作业更快(在计划外停机的情况下无法恢复)此选项是高级的。</p><ul class=""><li id="b759" class="nn no iq ka b kb kc kf kg kj np kn nq kr nr kv ns nt nu nv bi translated"><strong class="ka ir">最大_生存能力</strong>:最大耐久力但最慢。</li><li id="6a2a" class="nn no iq ka b kb nw kf nx kj ny kn nz kr oa kv ns nt nu nv bi translated"><strong class="ka ir"> SURVIVABLE_NONATOMIC </strong>:耐用性和更快速度的结合。</li><li id="5e99" class="nn no iq ka b kb nw kf nx kj ny kn nz kr oa kv ns nt nu nv bi translated"><strong class="ka ir">性能_优化</strong>:像兔子一样奔跑。</li></ul><p id="b606" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">性能优化</strong>的情况下，Jenkins控制器应正常关闭，以保存正在运行的流水线。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="4eb5" class="nh lp iq mw b gy ni nj l nk nl">durabilityHint("PERFORMANCE_OPTIMIZED")</span></pre><p id="5908" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> newContainerPerStage </strong>与<strong class="ka ir"> docker </strong>和<strong class="ka ir"> dockerfile </strong>顶层代理配合使用。运行作业阶段的正常行为是所有阶段都在一个容器中运行，但是使用此选项，每个阶段都在同一节点中的单独容器中运行。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="9941" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">parallelsAlwaysFailFast</strong>用于失效保护所有并行级。如果任何并行阶段失败，其他阶段也会中止，并且构建状态将设置为失败。这是一个高级选项。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="4f75" class="nh lp iq mw b gy ni nj l nk nl">parallelsAlwaysFailFast()</span></pre><p id="691d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">保存隐藏文件</strong>用于保存隐藏的文件。在构建作业的过程中，可能会创建一些文件，在构建结束时会删除这些文件。在某些情况下，您需要从特定阶段重新开始构建。在这种情况下，您需要在之前的构建过程中创建的临时文件。Stash就是为了实现这个需求而来的。</p><p id="f9ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以后的文章会深入讲解。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="5bdd" class="nh lp iq mw b gy ni nj l nk nl">preserveStashes()</span></pre><p id="ca20" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> quietPeriod </strong>用来指在特定的一段时间内相当长的一段时间。当一个作业被触发时，一个新的构建被放入队列，但是在这个选项设置的一段时间内，Jenkins不会启动它。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="b111" class="nh lp iq mw b gy ni nj l nk nl">quietPeriod(30)</span></pre><p id="9ed7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如有异常，重试</strong>N次管道本体。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="7940" class="nh lp iq mw b gy ni nj l nk nl">retry(3)</span></pre><p id="8284" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> skipDefaultCheckout </strong>用于在输入新代理时停止自动结帐。您必须使用<code class="fe mt mu mv mw b">checkout scm</code>命令手动检查。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="d8fb" class="nh lp iq mw b gy ni nj l nk nl">skipDefaultCheckout(true)</span></pre><p id="fc97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果构建状态变得不稳定，则跳过更多阶段。它用于停止整个管道。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="db1e" class="nh lp iq mw b gy ni nj l nk nl">skipStagesAfterUnstable()</span></pre><p id="f599" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">超时</strong>用于指定构建超时。默认情况下，构件没有任何超时限制。超时后，抛出<strong class="ka ir">flowtruptedexception</strong>，流水线中止。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="105b" class="nh lp iq mw b gy ni nj l nk nl">timeout(time: 300, unit: "SECONDS")</span></pre><h1 id="56c3" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">最后的话:</h1><p id="5bf2" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">詹金斯有很多选择。其中一些是本地选项，许多是插件添加的。在本文中，我试图解释其中的一些，但是我打算在以后的文章中深入研究每一个。如果您有任何问题，请在教程GitHub repo上提交问题。</p><p id="6101" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关注我的LinkedIn<a class="ae nm" href="https://www.linkedin.com/in/ssbostan" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/ssbostan</a></p></div></div>    
</body>
</html>
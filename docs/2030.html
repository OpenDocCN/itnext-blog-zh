<html>
<head>
<title>GraphQL API for SQL Database in .NET</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">中SQL数据库的GraphQL API。网</h1>
<blockquote>原文：<a href="https://itnext.io/graphql-api-for-sql-database-in-net-af2fe322fe28?source=collection_archive---------1-----------------------#2019-03-19">https://itnext.io/graphql-api-for-sql-database-in-net-af2fe322fe28?source=collection_archive---------1-----------------------#2019-03-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c1df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能听说过GraphQL技术作为REST APIs的替代技术。然而，让我们简短地回忆一下GraphQL是什么，它的主要用途，以及我们如何在现实生活中使用它。</p><p id="d4f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GraphQL由脸书于2015年发布，定位为众所周知的RESTful架构风格的替代方案。与数百个web API方法(显然可以有不同的版本)不同，您只有一个Web API端点，它允许您获得关于字段的所有信息(一种类型的字段，是否需要，等等)。).本质上，GraphQL接受查询——这是一种JSON格式的数据——并尝试将其解析为之前定义的模式。</p><p id="0cd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以发布两种类型的查询:</p><ul class=""><li id="cfb7" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">查询—用于获取多个数据以及查询中定义的字段</li><li id="f45d" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">突变—用于创建、更新或删除数据</li></ul><p id="af17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们关注基于轻量级ORM <a class="ae kz" href="https://www.nrecosite.com/dalc_net.aspx" rel="noopener ugc nofollow" target="_blank"> NReco的获取数据方法。Data </a>(它有广泛的数据库适配器，允许连接到任何流行的数据库——MSSQL、PostgreSQL、MySQL、Elasticsearch等。)并看看我们如何直接从数据库中获取数据。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/37b8b1e6f054371df2d461a3730bb5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DJ0d4qNYhOcqWhfDXcuoyQ.png"/></div></div></figure><p id="93f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">SQL-db的组件<a class="ae kz" href="https://www.nrecosite.com/graphql_to_sql_database.aspx" rel="noopener ugc nofollow" target="_blank">GraphQL.Net API</a>允许我们在JSON格式的文件中定义所有模式(甚至关系)。让我们配置模式并运行几个查询。NET Core Web应用程序分步指南:</p><ol class=""><li id="9688" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lm kr ks kt bi translated">首先，让我们在Startup.cs中设置一个数据库配置字符串和模式定义:</li></ol><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi ln"><img src="../Images/40fdbaef2a4877f3e391c7db03dface7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjrjH7lWSEoB2tkn5sybaA.png"/></div></div></figure><p id="5284" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.第二步是定义一个“schemaDbDefinition.json”文件，其中包含以下属性:</p><ul class=""><li id="d221" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">默认情况下，分页是启用的，用于定义查询中的排序参数(sortBy，direction)。</li><li id="cbca" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">默认情况下，Sort是启用的，用于定义查询中的排序参数(sortBy，direction)。</li><li id="1edb" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">默认情况下，Filter处于启用状态，用于定义查询中的筛选参数(默认为“filter”)。</li><li id="9f9b" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">SingleName—graph QL查询中单个对象的名称</li><li id="ed00" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">ListName—graph QL查询中对象列表的名称</li><li id="3f3e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">表-数据库表名</li><li id="b5bb" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">描述—可选字段；出现在GraphiQL IDE中并包含简短描述</li><li id="29a3" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">字段GraphQL查询中可用的所有字段</li><li id="fddc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">RelatedObjects —相关对象的数组；只能由架构中定义的对象使用</li><li id="128e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">Relex —字符串表达式(阅读更多信息<a class="ae kz" href="https://github.com/nreco/data/wiki/Relex" rel="noopener ugc nofollow" target="_blank"> NReco。Relex </a>)，其中所有字段值都取自父模式对象，并且可以在条件中使用。</li></ul><p id="32d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终，应该是这样的:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lo"><img src="../Images/8338eda7d7ffb51028e8232189769a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDufaVwV6QRxdIWLHNvK-Q.png"/></div></div></figure><p id="45e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.让我们向API方法的控制器添加一个GraphQL适配器:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lp"><img src="../Images/876c8e9d3d952223d0937cbe001bfa90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPLn56J48PDI-scfvsPjpg.png"/></div></div></figure><p id="c07e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.让我们让所有的顾客都下订单:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lq"><img src="../Images/eb1a7bc3f97d52cc7a7e4d4f50616dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*FvguyFZoRJm3mCV64lB88Q.gif"/></div></div></figure><p id="f790" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.或者获取特定客户最近两个订单的数据:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lr"><img src="../Images/4ed390ab40a7311751b774b203e96369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*knwIZqW4o-34qMQ98LdDSw.png"/></div></div></figure><p id="4e66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.应用过滤器并获取运费高于870的所有订单:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lr"><img src="../Images/d126c1d81e50e94b21310d609ddd9179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvsnl9j_5Ow1COEq06pwdQ.png"/></div></div></figure><p id="94a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和NReco一起。GraphQL定义模式，数据提取非常容易，只需要几个步骤。您不再需要创建类来定义GraphQL方案，也不再需要在更新后重新构建整个解决方案——您所需要做的只是稍微修改一个JSON文件。NReco的另一个优点是。GraphQL的优势在于这种DB适配器可以很容易地连接到任何流行的数据库。</p><p id="3362" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请在评论中告诉我们你的想法。</p><p id="552d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二部分—设置GraphQL <a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/graphql-api-for-sql-database-in-net-setting-up-access-to-the-data-e7be91326576">访问数据</a></p></div></div>    
</body>
</html>
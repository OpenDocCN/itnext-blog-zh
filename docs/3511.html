<html>
<head>
<title>Flutter with WSL 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与WSL 2一起颤动</h1>
<blockquote>原文：<a href="https://itnext.io/flutter-with-wsl-2-69ba8fc7682f?source=collection_archive---------1-----------------------#2019-12-31">https://itnext.io/flutter-with-wsl-2-69ba8fc7682f?source=collection_archive---------1-----------------------#2019-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ebf199e6eb6120a033633d77b24a65ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-YxlOmr_Sp4RHi0U7dp3Q.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">成功就像一场派对。</figcaption></figure><p id="65b5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在假期中，我有时间查看我的开发环境，并决定是时候使用WSL2了。</p><p id="875a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">WSL2确实给了我承诺的性能改进，但我在用flutter进行前端开发时遇到了一个问题(我认为这也会影响react native)，所以我想我应该帮助其他想实现这一飞跃的人。</p><h1 id="4516" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">环境设置</h1><p id="a5d9" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">因为有很多关于不同部分的文章，所以我不打算花时间重复细节，只是给你一个我的开发环境的概要。</p><ul class=""><li id="3acc" class="md me iq ke b kf kg kj kk kn mf kr mg kv mh kz mi mj mk ml bi translated">Windows 10专业版</li><li id="b344" class="md me iq ke b kf mm kj mn kn mo kr mp kv mq kz mi mj mk ml bi translated">WSL 2 (Ubuntu 19.04)</li><li id="e701" class="md me iq ke b kf mm kj mn kn mo kr mp kv mq kz mi mj mk ml bi translated">VS代码(1.41.1)</li><li id="95b9" class="md me iq ke b kf mm kj mn kn mo kr mp kv mq kz mi mj mk ml bi translated">安卓工作室(3.5.3)</li></ul><h1 id="c19e" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Visual Studio代码远程WSL</h1><p id="203f" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">我使用Visual Studio代码进行大部分开发，所以当我找到访问远程WSL的扩展时，我非常兴奋。如果您想使用WSL 2并获得文件系统性能提升，这是绝对必要的。</p><div class="mr ms gp gr mt mu"><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">远程- WSL</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">Remote - WSL extension扩展允许您将Windows Subsystem for Linux (WSL)用作您的全职开发…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">marketplace.visualstudio.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni jw mu"/></div></div></a></div><h1 id="fcf4" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Android SDK</h1><p id="1fbb" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">我想让所有东西都在WSL 2容器中运行，所以我在Ubuntu中安装了Android SDK。它也设置在我的Windows端，但我的目标是尽可能不使用它。</p><p id="49ed" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是我做的设置。您需要将导出内容移动到您的。bash_profile一旦你得到这个工作。</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="2809" class="ns lb iq no b gy nt nu l nv nw">cd ~<br/>sudo apt-get install unzip zip<br/>wget https://dl.google.com/android/repository/sdk-tools-linux-4333796.zip<br/>unzip sdk-tools-linux-4333796.zip -d Android<br/>rm sdk-tools-linux-4333796.zip<br/>sudo apt-get install -y lib32z1 openjdk-8-jdk<br/>export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64<br/>export PATH=$PATH:$JAVA_HOME/bin<br/>printf "\n\nexport JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64\nexport PATH=\$PATH:\$JAVA_HOME/bin" &gt;&gt; ~/.bashrc<br/>cd Android/tools/bin<br/>./sdkmanager --install "platform-tools" "platforms;android-26" "build-tools;26.0.3"<br/>export ANDROID_HOME=~/Android<br/>export PATH=$ANDROID_HOME/tools:$PATH<br/>export PATH=$ANDROID_HOME/tools/bin:$PATH<br/>export PATH=$ANDROID_HOME/platform-tools:$PATH<br/>printf "\n\nexport ANDROID_HOME=~/Android\nexport PATH=\$PATH:\$ANDROID_HOME/tools\nexport PATH=\$PATH:\$ANDROID_HOME/platform-tools" &gt;&gt; ~/.bashrc<br/>sdkmanager --update<br/>curl -s "https://get.sdkman.io" | bash<br/>source "$HOME/.sdkman/bin/sdkman-init.sh"<br/>sdk install gradle 5.5.1<br/>gradle -v</span></pre><h1 id="6f17" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">摆动</h1><p id="e1ba" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">我需要的最后一件事是让flutter linux安装运行起来。仅仅使用标准的linux flutter安装对我来说就足够了。</p><div class="mr ms gp gr mt mu"><a href="https://flutter.dev/docs/get-started/install/linux" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">Linux安装</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">要安装和运行Flutter，您的开发环境必须满足这些最低要求:操作系统:Linux…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">颤振. dev</p></div></div><div class="nd l"><div class="nx l nf ng nh nd ni jw mu"/></div></div></a></div><p id="1e17" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安装完成后，请务必运行flutter doctor，看看您是否有任何问题。我不得不更正SDK的位置并接受一些许可，但不需要安装Android Studio。</p><p id="d4cd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此外，确保启动VS代码并使用远程WSL扩展连接到您的环境。一旦你连接上了，你就需要安装flutter扩展以及你想要运行的任何其他扩展，看起来远程WSL扩展在ubuntu环境中单独设置vs代码。</p><h1 id="06be" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Android模拟器</h1><p id="90ff" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">到目前为止，一切都很顺利。我能够拥有一个正常工作的flutter环境，但却无法将我的应用程序编译到仿真器或设备上。我找到了两个解决方案，一个是如果你愿意使用真实的设备，另一个是如果你想使用模拟器。</p><h1 id="c095" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">亚行TCPIP</h1><p id="7433" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">如果你正在使用一个真实的设备进行测试，这是一个非常有用的设置方法。它让你告诉设备，客户端连接到它将通过TCP来代替USB。要进行设置，您只需将您想要测试的设备连接到windows。在Windows cmd提示符下，确保使用以下命令连接设备</p><blockquote class="ny nz oa"><p id="06cd" class="kc kd ob ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz ij bi translated">adb设备</p></blockquote><p id="a97a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您看到想要连接的设备，请按</p><blockquote class="ny nz oa"><p id="3653" class="kc kd ob ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz ij bi translated">亚行tcpip 5555</p></blockquote><p id="39e3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这样做将使设备准备好通过wifi接收adb命令。在WSL方面，您将发出命令</p><blockquote class="ny nz oa"><p id="8fbf" class="kc kd ob ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz ij bi translated">亚行连接<ip of="" phone=""> :5555</ip></p></blockquote><p id="65cc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你成功连接，你就可以开始了。您可以通过查看VSCode来验证这一点，注意它现在在右下角状态栏中显示一个设备。</p><h1 id="6411" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">用于仿真器的ADB</h1><p id="b0e5" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">因此，我将告诫这一点，即使我有它的工作，它是非常缓慢的建立在模拟器上，但想添加我的发现，以防别人已经使它运行得更好。</p><p id="86be" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个设置基本上使Ubuntu adb连接到运行在windows主机上的adb服务器。这工作，但正如我所说的是非常缓慢。</p><p id="c658" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在windows主机上，您需要让adb监控传入连接的端口</p><blockquote class="ny nz oa"><p id="9b7c" class="kc kd ob ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz ij bi translated">adb -a -P 5037 nodaemon服务器</p></blockquote><p id="3b13" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦从Ubuntu端完成了这些，你需要添加一个新的环境变量来设置adb连接到远程服务器而不是本地服务器。</p><blockquote class="ny nz oa"><p id="3bde" class="kc kd ob ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz ij bi translated">导出ADB _ SERVER _ SOCKET = TCP:192 . 168 . 1 . 97:5037<br/>ADB kill-SERVER</p></blockquote><p id="099b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦完成，你应该能够运行adb设备，并看到你的设置的windows端托管的设备。</p><p id="670a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">需要注意的一点是，您只能通过CLI运行flutter应用程序，而不能使用VSCode调试选项。和调试用的天文台URL有关系。</p><h1 id="3be1" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结论</h1><p id="b654" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">WSL 2中的开发设置非常好。它很快，很容易使用，但就像我说的adb设置使用模拟器非常慢。一个构建可能需要30分钟才能成功传输到模拟器。我的希望是，当其他人试图建立这种联系时，我们可以找到一种更好的方法来建立这种联系，使它成为一个更加无缝的过程。理想情况下，WSL 2将能够直接连接到设备，但我相信这是一个长期的梦想。</p></div></div>    
</body>
</html>
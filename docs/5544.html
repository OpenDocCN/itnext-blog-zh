<html>
<head>
<title>Quickly find bad commits using git bisect</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用git二等分快速找到错误的提交</h1>
<blockquote>原文：<a href="https://itnext.io/quickly-find-bad-commits-using-git-bisect-610dcbbc29e1?source=collection_archive---------1-----------------------#2021-03-29">https://itnext.io/quickly-find-bad-commits-using-git-bisect-610dcbbc29e1?source=collection_archive---------1-----------------------#2021-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/566b33e16efc2ae6f33bdb88b65c9aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j31WPdspLECdSfsK"/></div></div></figure><p id="0285" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你是否曾经被报告过一个回归错误，你怀疑这个错误是在很多次提交之前引入的？</p><p id="9042" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你认为找到罪魁祸首将是一个漫长而痛苦的过程，先不要翻白眼。您可以使用<code class="fe kz la lb lc b">git bisect</code>命令更快地找到违规提交。</p><p id="72ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本教程中，我们将通过动手练习来复习<code class="fe kz la lb lc b">git bisect</code>的基础知识。</p><h1 id="67c6" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">git平分是什么？</h1><p id="01b8" class="pw-post-body-paragraph kb kc it kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky im bi translated">简而言之，<code class="fe kz la lb lc b">git bisect</code>是一个命令行工具，用于分析提交历史并找出错误的提交。Git二等分使用二分搜索法算法。二分搜索法使得查找错误提交变得相当快，即使在很长的提交历史中。</p><p id="4b2a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，让我们开始吧！我建议跟随这篇文章，以便更好地理解这个主题。为了确保我没有捏造事实。你可以克隆这个回购<a class="ae mg" href="https://github.com/iskenxan/git-bisect-sample" rel="noopener ugc nofollow" target="_blank">来跟进。</a></p><h1 id="de79" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">使用git二等分</h1><p id="b097" class="pw-post-body-paragraph kb kc it kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky im bi translated"><code class="fe kz la lb lc b">git bisect</code>使用好/坏提交方法。当git遍历提交时，您需要告诉git当前的提交是好是坏。这样做将有助于<code class="fe kz la lb lc b">git bisect</code>快速缩小目标提交范围。</p><p id="9583" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦开始git二等分，步骤就很简单了:</p><ol class=""><li id="1a9e" class="mh mi it kd b ke kf ki kj km mj kq mk ku ml ky mm mn mo mp bi translated">测试当前提交并检查您正在追踪的bug是否存在。</li><li id="c5c1" class="mh mi it kd b ke mq ki mr km ms kq mt ku mu ky mm mn mo mp bi translated">根据第一步，将当前提交标记为好或坏。</li></ol><p id="42e4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在让我们看看实际情况。如果您在本地运行该应用程序，您可以清楚地看到错误:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/bfbf2324d2b7b353fbd9bdcf14f28a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o7vhP-S-lGvwJPdt"/></div></div></figure><p id="46d8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，让我们运行<code class="fe kz la lb lc b">git log</code>命令来查看提交历史:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/f1aadbe07a1322072e2db12cf1216210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sa1kPp3PRg7-1Wlu"/></div></div></figure><p id="e230" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">引入错误的提交是<code class="fe kz la lb lc b">introduce error</code>。但是让我们假装不知道。对于第一个好的提交，我们将选择<code class="fe kz la lb lc b">switch front picture and body style</code>。据我们所知，这是没有错误的最新提交。对于第一个糟糕的提交，我们来挑选最新的一个，<code class="fe kz la lb lc b">filler commin #6</code>(请忽略错别字)。</p><p id="eaea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在让我们运行<code class="fe kz la lb lc b">git bisect</code>命令，并提供初始的错误和正确提交。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/ecfe0da2ca849ef7be633ba0d3b157af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fKD9m8JLfNCQGMd0"/></div></div></figure><p id="1f84" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">多亏了二分搜索法，看起来我们只剩下两次迭代要测试了。你现在的当前活动提交是<code class="fe kz la lb lc b">1c98d89</code>，也就是<code class="fe kz la lb lc b">filler commin #1</code>。现在你需要手动测试应用程序，看看bug是否还在。在我们的例子中，<code class="fe kz la lb lc b">1c98d89</code>仍然包含错误，所以我们使用<code class="fe kz la lb lc b">git bisect bad</code>将这个提交标记为坏的。以下是控制台输出:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/cefa934626763ce27f478fa4b9f89f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/0*XFupLCgFVGGSOnMo"/></div></figure><p id="1396" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">继续下一次迭代。现在我们再次测试，看起来这个提交没有我们正在跟踪的错误。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/765213b46a8186fb982fb3a359f12873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*orC32fdxPdB9dpda"/></div></div></figure><p id="2677" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以我们使用<code class="fe kz la lb lc b">git bisect good</code>将其标记为好的:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/ed8158d427d635138d86f6caf81c28ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/0*RstRtXKw--ZTK3JJ"/></div></figure><p id="3bbb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从控制台输出中，您可以看到没有更多要测试的修订。这意味着我们找到了违规的提交，在我们的例子中是<code class="fe kz la lb lc b">introduce error</code>。干得好！</p><p id="6316" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦您完成了测试，您可以使用<code class="fe kz la lb lc b">git bisect reset</code>重置git等分。</p><h1 id="3f13" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">自动搜索</h1><p id="c3fc" class="pw-post-body-paragraph kb kc it kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky im bi translated">手动运行<code class="fe kz la lb lc b">git bisect</code>通常是一个不错的解决方案。但是如果你有一个测试脚本，你可以运行它来验证提交，你可以用它来自动化整个事情。</p><p id="2759" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是我如何使用样例repo中的测试脚本让<code class="fe kz la lb lc b">git bisect</code>为我找到目标提交:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/22c45e399475a33bd609d49f34f2f4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6_bVWdbdkNYl8c8q"/></div></div></figure><p id="9b9f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将开始搜索，并将在每次迭代中运行测试脚本。下面是最终结果:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/f901ca7f936aef588029616959c26dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fDsPB-QthvFsdSGz"/></div></div></figure><p id="107f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我不再需要每次都手动测试提交。命令工具和测试脚本为我完成了工作！</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="4e95" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe kz la lb lc b">git bisect</code>是一个方便的小工具，可以快速找到棘手的提交。它与好的测试脚本配合得特别好，这是支持在您的项目中拥有健壮的测试套件的另一点。编码快乐！</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="affd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="nn">原载于2021年3月29日https://isamatov.com</em><em class="nn">的</em> <a class="ae mg" href="https://isamatov.com/git-bisect/" rel="noopener ugc nofollow" target="_blank"> <em class="nn">。</em></a></p></div></div>    
</body>
</html>
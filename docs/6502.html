<html>
<head>
<title>Push Notifications with Firebase on Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter上使用Firebase推送通知</h1>
<blockquote>原文：<a href="https://itnext.io/push-notifications-with-firebase-on-flutter-df68cc830c89?source=collection_archive---------1-----------------------#2021-12-05">https://itnext.io/push-notifications-with-firebase-on-flutter-df68cc830c89?source=collection_archive---------1-----------------------#2021-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7e71" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Flutter上的Firebase云消息传递</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f8d8623e50cb39ea674814b3405f1453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gi2RIRI-hpAMg5wPP2qa5w.png"/></div></div></figure><p id="443f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">推送通知是移动开发的一个重要方面。我们可以使用弹出消息媒介，提醒应用程序用户应用程序中正在发生的事情。它们也是增强用户参与你的应用的重要方式。例如，用户一旦安装了应用程序，就会忘记它。然后，您可以使用推送通知作为一种机制来重新获得并保持他们的兴趣。推送通知也有助于增加你的应用流量。今天，我将向您展示如何使用firebase cloud messaging通过<code class="fe ln lo lp lq b">firebase_messaging</code>包在Flutter中推送通知。</p><div class="lr ls gp gr lt lu"><a href="https://pub.dev/packages/firebase_messaging" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">firebase_messaging | Flutter包</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">一个使用Firebase云消息API的Flutter插件。要了解有关Firebase云消息传递的更多信息，请访问…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">公共开发</p></div></div><div class="md l"><div class="me l mf mg mh md mi kp lu"/></div></div></a></div><h1 id="d82a" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">开始</h1><ul class=""><li id="7dcc" class="nb nc iq kt b ku nd kx ne la nf le ng li nh lm ni nj nk nl bi translated">首先，我们需要将<code class="fe ln lo lp lq b">firebase_core</code>包添加到<code class="fe ln lo lp lq b">pubspec.yaml</code></li></ul><pre class="kg kh ki kj gt nm lq nn no aw np bi"><span id="5e54" class="nq mk iq lq b gy nr ns l nt nu">dependencies:<br/>  ...<br/>  firebase_core: ^1.10.0</span></pre><ul class=""><li id="8dbf" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">然后，我们把<code class="fe ln lo lp lq b">firebase_messaging</code>包加到<code class="fe ln lo lp lq b">pubspec.yaml</code>里</li></ul><pre class="kg kh ki kj gt nm lq nn no aw np bi"><span id="792b" class="nq mk iq lq b gy nr ns l nt nu">dependencies:<br/>  ...<br/>  <!-- -->firebase_core: ^1.10.0<br/>  firebase_messaging: ^11.1.0</span></pre><p id="b1dd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了这个，我们不需要添加任何包，所以现在我们可以设置我们的firebase项目。让我们从Android实现开始。</p><h2 id="203f" class="nq mk iq bd ml ny nz dn mp oa ob dp mt la oc od mv le oe of mx li og oh mz oi bi translated">Android实现</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/1cd25fb676dff8a71e92bcd57ce92a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggqzDgWRhl1MMjA2DxS4SQ.png"/></div></div></figure><ul class=""><li id="112a" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">你可以在applicationId下找到你的Android包名<code class="fe ln lo lp lq b">android/app/build.gradle</code>。你可以给任何你想给app起的昵称。目前，您不需要添加SHA-1证书。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/f1996b6898ec818fff665a11b4de4f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SW5ctO4smHITc7X9VGc3dA.png"/></div></div></figure><ul class=""><li id="ae37" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">下载<code class="fe ln lo lp lq b">google-services.json</code>并将其放入我们的项目<code class="fe ln lo lp lq b"> /android/app</code></li><li id="b82d" class="nb nc iq kt b ku ol kx om la on le oo li op lm ni nj nk nl bi translated">现在我们需要将firebase SDK添加到我们的项目中。在<code class="fe ln lo lp lq b">android/build.gradle</code>中添加以下一行。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/22bd7c03ccc6777653011a57f3ef737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHZec817g1XGjm3VlAPsxw.png"/></div></div></figure><ul class=""><li id="c03c" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">然后在<code class="fe ln lo lp lq b">android/app/build.gradle</code>中添加以下几行。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/393da21cc5324af20f812db90180b089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*20YFLmpmQrUSmurF6NQSRg.png"/></div></div></figure><ul class=""><li id="6386" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">然后从该网站查看最新版本的云消息。</li></ul><div class="lr ls gp gr lt lu"><a href="https://firebase.google.com/support/release-notes/android#latest_sdk_versions" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">Firebase Android发行说明| Firebase文档</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">要查看Firebase控制台和其他Firebase平台以及相关SDK的发行说明，请参考…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">firebase.google.com</p></div></div><div class="md l"><div class="os l mf mg mh md mi kp lu"/></div></div></a></div><ul class=""><li id="606e" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">像这样增加依赖性。</li></ul><pre class="kg kh ki kj gt nm lq nn no aw np bi"><span id="8ef6" class="nq mk iq lq b gy nr ns l nt nu">implementation 'com.google.firebase:firebase-messaging:23.0.0'</span></pre><ul class=""><li id="b99a" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">这是可选的，但是我强烈建议如果您想在用户点击通知时得到通知，将这一行添加到您的<code class="fe ln lo lp lq b">android/app/src/main/AndroidManifest.xml</code>的<code class="fe ln lo lp lq b">&lt;activity&gt;</code>标签内的<code class="fe ln lo lp lq b">AndroidManifest.xml</code>中。</li></ul><pre class="kg kh ki kj gt nm lq nn no aw np bi"><span id="2839" class="nq mk iq lq b gy nr ns l nt nu">&lt;intent-filter&gt;<br/>   &lt;action android:name="FLUTTER_NOTIFICATION_CLICK" /&gt;<br/>   &lt;category android:name="android.intent.category.DEFAULT" /&gt;<br/>&lt;/intent-filter&gt;</span></pre><p id="da9a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就是这样。我们在项目中成功实现了Firebase for Android。</p><h2 id="737d" class="nq mk iq bd ml ny nz dn mp oa ob dp mt la oc od mv le oe of mx li og oh mz oi bi translated">IOS实施</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/5f93326a8cfa3da65c17dc6cd47f479a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCSSEtK54dekJ6CvKqVH3g.png"/></div></div></figure><ul class=""><li id="2b5f" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">您可以通过搜索<code class="fe ln lo lp lq b">“PRODUCT_BUNDLE_IDENTIFIER.”</code>找到<code class="fe ln lo lp lq b">ios/Runner.xcodeproj/project.pbxproj</code>中的包ID</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/2a295bf5883f528d6752f9c544d02825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKUOCtozh_ykPJRWp1RTFw.png"/></div></div></figure><ul class=""><li id="5f70" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">在Xcode中打开项目目录的<code class="fe ln lo lp lq b">ios</code>文件夹。将下载的文件拖放到<code class="fe ln lo lp lq b">Runner</code>子文件夹中。当出现对话框时，确保勾选了<code class="fe ln lo lp lq b">Destination</code>属性的<strong class="kt ir">复制项目(如果需要的话)</strong>，并且在<strong class="kt ir">添加到目标</strong>框中选择了<strong class="kt ir">流道</strong>。然后，点击<strong class="kt ir">完成</strong>。</li></ul><p id="655b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就是这样。在我们的项目中，我们成功地实现了Firebase for IOS。</p><h2 id="31ef" class="nq mk iq bd ml ny nz dn mp oa ob dp mt la oc od mv le oe of mx li og oh mz oi bi translated">使用</h2><ul class=""><li id="2b8d" class="nb nc iq kt b ku nd kx ne la nf le ng li nh lm ni nj nk nl bi translated">让我们创建<code class="fe ln lo lp lq b">notification.dart</code>并在那里处理消息传递操作。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><ul class=""><li id="7a7e" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">然后让我们在我们的应用程序中显示它，这样我们就可以看到变化。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><ul class=""><li id="84db" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">现在，我们已经准备好为我们的应用程序发送第一个通知。让我们看看Firebase控制台和云消息传递。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/b175645fee114d25696c36875846e906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGkPgP_Foh4-oYL0byo9gA.png"/></div></div></figure><ul class=""><li id="6df6" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">让我们点击发送测试消息，这样我们就只能在我们的手机上使用它。</li><li id="c240" class="nb nc iq kt b ku ol kx om la on le oo li op lm ni nj nk nl bi translated">然后运行我们的手机，这样我们就可以为我们的手机获取一个特定的令牌。</li><li id="0cd6" class="nb nc iq kt b ku ol kx om la on le oo li op lm ni nj nk nl bi translated">获得令牌后，让我们添加令牌并单击test。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/3efccac9666203c7b29a8c1e0ba78fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*gnMSh4FPRBPa_Mix_QGMgw.png"/></div></figure><ul class=""><li id="41f3" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">这是我们想要的通知显示在屏幕上。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/773b2741a2496a1d203d431eff2538fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*qTFOBZQXlyFwVuVvzi1f-Q.jpeg"/></div></figure><ul class=""><li id="1dc5" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">然后让我们在后台测试它，这样我们也可以看到我们的通知。让我们把应用程序放在后台。并再次发送测试消息。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/dac7d7f3ac83f98135a9c220a39190c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*rGvlP5aXaQlsxGo2tc3beA.jpeg"/></div></figure><ul class=""><li id="d6a6" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">如您所见，我们可以毫无问题地看到我们的通知。🎉🎉</li></ul><h2 id="7c1f" class="nq mk iq bd ml ny nz dn mp oa ob dp mt la oc od mv le oe of mx li og oh mz oi bi translated">奖金</h2><ul class=""><li id="9fa9" class="nb nc iq kt b ku nd kx ne la nf le ng li nh lm ni nj nk nl bi translated">您可以将图像添加到通知中。在IOS上，您需要做一些事情。你可以在这里找到如何做👇👇</li></ul><div class="lr ls gp gr lt lu"><a href="https://firebase.flutter.dev/docs/messaging/apple-integration/#advanced-optional-allowing-notification-images" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">通过APNs集成的| FlutterFire</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">本指南适用于iOS和macOS Flutter应用程序，针对您需要的平台重复每个步骤。例如，如果你…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">firebase.flutter.dev</p></div></div><div class="md l"><div class="oz l mf mg mh md mi kp lu"/></div></div></a></div><ul class=""><li id="a059" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">您可以向某些主题发送通知。要订阅一个主题，你需要做的就是添加这一行。</li></ul><pre class="kg kh ki kj gt nm lq nn no aw np bi"><span id="7b46" class="nq mk iq lq b gy nr ns l nt nu"><em class="pa">await</em> FirebaseMessaging.instance.subscribeToTopic('weather');</span></pre><ul class=""><li id="6e3e" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">然后在目标步骤上发送通知时，添加到您想要发送通知的主题中。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/1bcc3b2e81417abe101cce65051ed600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdjQ_VdoSbr40RwMv_uaiQ.png"/></div></div></figure><ul class=""><li id="1c00" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">要取消订阅某个主题，您只需添加这一行。</li></ul><pre class="kg kh ki kj gt nm lq nn no aw np bi"><span id="5707" class="nq mk iq lq b gy nr ns l nt nu"><em class="pa">await</em> FirebaseMessaging.instance.unsubscribeFromTopic('weather');</span></pre><ul class=""><li id="332e" class="nb nc iq kt b ku kv kx ky la nv le nw li nx lm ni nj nk nl bi translated">您还可以在通知中发送键值变量。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/cc925133e74015b47fbab540b0afad1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ku1JYszojdLj9jQLFT7bDQ.png"/></div></div></figure><p id="7df2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文到此为止。感谢您的阅读。</p><p id="bbd0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你有任何问题，请随时评论。👏👏👏</p></div></div>    
</body>
</html>
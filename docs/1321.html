<html>
<head>
<title>Debugging 101: Locating The Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">调试101:定位问题</h1>
<blockquote>原文：<a href="https://itnext.io/debugging-101-locating-the-problem-4201da859a73?source=collection_archive---------5-----------------------#2018-09-10">https://itnext.io/debugging-101-locating-the-problem-4201da859a73?source=collection_archive---------5-----------------------#2018-09-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/975afc8319a6b2228ab1f1df2c0815cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*aegQvxh4CNG0eZTF-77Ltg.png"/></div></figure><p id="df9b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我最近观察了几个程序员试图修复一个bug，并(带着相当大的紧张)观察了他们在黑暗中调整和更改不同代码行的艰苦努力。</p><p id="f68f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我立刻知道我要做什么，这更像是一个二分搜索法(见下面的例子),可以快速解决我遇到的几乎每一个bug。</p><p id="20bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它包括3个步骤:</p><ol class=""><li id="2006" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">重现问题</li><li id="9e6e" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">遵循请求顺序</li><li id="4458" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">适当调整代码</li></ol><p id="6f69" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请注意，这是<em class="lg">语言不可知的</em>:从Javascript到GoLang的概念是相同的<em class="lg">。</em>经验和熟悉程度主要有助于您理解步骤3，以及与本文更相关的请求顺序。</p><p id="f746" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我将展示这如何应用于一个报告错误“登录不工作”的用户。让我们来看看这些步骤。</p><h1 id="e4fb" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">重现问题</h1><p id="7532" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">简说“登录不起作用”。这不是很有帮助(希望我们指导人们给出更好的错误报告)。</p><p id="8809" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lg">如果你不能复制它，几乎不可能解决任何问题或缺陷。</em></p><p id="21bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们尝试登录并成功了。我们尝试用一个新帐户登录…并且成功了。这不是很有帮助。我们需要能够始终如一地复制它，或者理解如何复制它(如果它依赖于计时器，而我们只能每X个小时复制一次，那么理解就足以解决这个问题)。</p><p id="0266" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">假设我们回头从Jane那里获得更多详细信息:她告诉我们她试图使用Google身份验证，这发生在她注销Gmail并重新登录之后。</p><p id="1907" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们用自己的帐户尝试了一下，瞧，我们得到了一个“未授权登录”的错误。</p><p id="81de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以复制这个问题，进行下一步。</p><h1 id="9433" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">遵循请求顺序</h1><p id="9323" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">让我首先定义我所说的“请求序列”是什么意思。我指的是从你最后一次重现错误到错误发生之间发生的所有事情。这可以是后端、前端、第三方服务、API调用、JSON解释器、开发操作等。</p><p id="e5cd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我见过的最好的例子是对这个问题的回答:</p><blockquote class="mk ml mm"><p id="7437" class="ju jv lg jw b jx jy jz ka kb kc kd ke mn kg kh ki mo kk kl km mp ko kp kq kr ij bi translated">"当你在浏览器中输入google.com，然后按回车键，会发生什么？"<br/>-<a class="ae mq" href="https://github.com/alex/what-happens-when" rel="noopener ugc nofollow" target="_blank">github.com/alex/what-happens-when</a></p></blockquote><p id="4903" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这种方法可以有几乎无限的深度，但我们从来不需要潜得比必要的更远。</p><p id="a0e3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">再来看登录问题。我们可以概括这些事件。</p><ol class=""><li id="ac35" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">点击“使用谷歌登录”</li><li id="ba22" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">重定向至谷歌认证页面</li><li id="5c10" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">在谷歌的登录界面输入电子邮件和密码，然后点击“登录”</li><li id="7975" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">重定向回我们的网站</li><li id="2d0c" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">登录</li></ol><p id="b6bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者，在我们的情况下:</p><p id="accd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">5.收到“未授权登录”错误。</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mr"><img src="../Images/5e52490be85dbcd3d0c0b8a61c26ad83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dSirFTvL0z6Cf9wIJC2uQ.png"/></div></div></figure><p id="e047" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们开始我们的“二分搜索法”。这就是我所说的二分搜索法(因为我用得有点不典型):如果我们正在浏览从1到71的一系列数字，我们想找到数字“7”，你可以从中间开始，简单地问，“它是更低还是更高？”并重复。</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/4874ee99de642f64354b806325c34343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HxVKodoqOj_GmSeSSbUr9A.png"/></div></div></figure><p id="c42c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们的例子中，我们想要同样的方法，但是问题是:“在请求链中，问题是在前面还是在后面？”</p><p id="af40" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们有5个步骤，最后一步是问题。我们需要找到错误开始的地方。在这种情况下，我们只能完全控制1、2和5。我们对第4步有部分控制权(我们告诉Google重定向回哪里)，对第3步没有控制权。</p><p id="a1cc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">既然不能勾选3，那就要么从2开始，要么从4开始。因为第4步更接近问题，所以我就从这里开始。</p><p id="7f15" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，我们需要做一些检查，看看在这一点上是否一切正常(“问题是早还是晚？”).第4步的第一部分是看我们是否到达重定向链接。</p><p id="6835" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们查看我们所在的错误页面，是的，我们在重定向链接上。这表明步骤1-3正在成功运行，而步骤4和5之间出现了问题。</p><p id="64b9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这意味着进一步分解它。第4步包括:</p><p id="89aa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">a)从Google <br/>接收信息b)检查我们的系统中是否有一个用户拥有匹配的Google令牌<br/> c)用来自Google <br/>的错误消息登录或拒绝该用户d)重定向到仪表板</p><p id="58b1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">二分搜索法:同样，我们应该在<em class="lg">b)</em>之后检查，我们的a系统中是否有用户拥有匹配的谷歌令牌？</p><p id="ece9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">不，我们没有。</p><p id="9b3f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然而，我们知道<em class="lg">我们应该</em>在我们的系统中有一个匹配的用户。你的系统大概是相当稳定的，人们一直登录得很好。</p><p id="38e4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">太好了，现在我们知道问题出在4a还是4b。</p><p id="667a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查4a是否有正确的数据—它有。</p><p id="0659" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们的问题出在4b。</p><p id="6979" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="lg">并重复… </em> </strong></p><p id="a69a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我将总结一下整个过程，而不是让你厌烦。4b当在请求序列中被分成进一步的步骤时，显示我们在那个电子邮件地址下确实有一个用户，但是它有一个不同的、不匹配的令牌。</p><p id="94ff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们的发现如下:<em class="lg">当您退出Gmail并重新登录时，下次登录时，Google会为系统提供一个与我们不同的令牌。</em></p><h1 id="59c8" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">适当调整代码</h1><p id="4afa" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">这通常包括你作为程序员的知识和经验，以及你谷歌和搜索StackOverflow的能力。本文的目的不是深入探讨这个问题。在我们的人工调试中，我们发现我们需要一个为用户更新令牌的过程，并实现它，瞧！我们完了。</p><h1 id="e870" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">了解请求链</h1><p id="9b4a" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">在公司里，对需求链的了解经常被低估。谁需要知道所有的细节？</p><p id="3609" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在之前的一家公司，我问我的首席技术官，我们是否可以获得一些关于我们的请求生命周期*的文档，他们给出了一个非常高的概述，但有些拒绝。这使得调试变得非常困难，并且经常回到无中生有的方法。</p><p id="81bb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">*请求生命周期与请求链:生命周期是特定于一个域的请求链(HTTP请求生命周期，Laravel请求生命周期)，而不是您的操作和另一个事件之间的每个请求链，它可能跨域。</p><h1 id="80bf" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">摘要</h1><p id="444f" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">解决bug包括三个步骤:</p><ol class=""><li id="af54" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">重现问题</li><li id="acff" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">按照请求顺序</li><li id="a7f0" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">适当调整代码</li></ol><p id="4dc4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请求序列由您的请求和您复制的问题之间发生的每个事件组成。要找到一个bug，你所要做的就是跟踪这个链(我使用二分搜索法方法)。</p><p id="e3c9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">语言和框架的知识和经验有助于快速定位bug可能在请求链的哪个部分，但是方法是相同的。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><h1 id="6210" class="lh li iq bd lj lk ni lm ln lo nj lq lr ls nk lu lv lw nl ly lz ma nm mc md me bi translated">如果你快乐并且你知道它…</h1><p id="188b" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">如果你喜欢这篇文章，并且觉得它很有用，请告诉我并<em class="lg">鼓掌</em>或者在下面写评论！我很乐意进一步阐述你可能有的任何问题。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="77a7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae mq" href="https://medium.com/@kerryjones12" rel="noopener">凯瑞·琼斯</a>是公司创始人兼首席技术官，最近被授予福布斯30位30岁以下成就奖。我对一切创业都充满热情，从文化优先的环境到技术堆栈和范例的利弊。在<a class="ae mq" href="https://www.linkedin.com/in/kerryrjones/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和我联系，或者在<a class="ae mq" href="https://twitter.com/kerryjones" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上和我打招呼。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Git: Fixup Your Commit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Git:修复您的提交</h1>
<blockquote>原文：<a href="https://itnext.io/git-fixup-your-commit-e1047f2fb966?source=collection_archive---------2-----------------------#2022-11-14">https://itnext.io/git-fixup-your-commit-e1047f2fb966?source=collection_archive---------2-----------------------#2022-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f552" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Git周刊 #22 <br/>级别:中级🥈</p><p id="b858" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">很多时候，我做了几次提交请求，然后有人留下了这样的评论:“在你的第一次提交中有一个打字错误”。我可以创建另一个提交来修复打字错误，但最好是在提交本身中修复打字错误。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/4d8c02a2c8c5cdcc277a87d12bf2f29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZocE4KtBSECqcbLz96MJWg.png"/></div></div></figure><h1 id="1065" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">修正提交</h1><p id="9aa1" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">让我们假设在我的分支<code class="fe me mf mg mh b">aerabi/test</code>中有两个提交。让我们通过git日志来看看它们:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="f536" class="mm lc it mh b be mn mo l mp mq">git log --oneline</span></pre><p id="5140" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出如下所示:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="c854" class="mm lc it mh b be mn mo l mr mq">3963089 (HEAD -&gt; aerabi/test) Add Test2.md<br/>56b4c6d Add Test.md</span></pre><p id="1614" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我想修复文件<code class="fe me mf mg mh b">Test.md</code>中的一个错别字。其工作方式如下。我在文件<code class="fe me mf mg mh b">Test.md</code>中做了更改，然后将它登台:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="22ec" class="mm lc it mh b be mn mo l mp mq">git add Test.md</span></pre><p id="5331" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我做一个“修正”提交，用散列值<code class="fe me mf mg mh b">56b4c6d</code>修正第一个提交:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="fc6e" class="mm lc it mh b be mn mo l mp mq">git commit --fixup 56b4c6d</span></pre><p id="b47c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建一个新的提交。但是因为我们没有指定提交消息，所以让我们做另一个日志来查看它:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="7eac" class="mm lc it mh b be mn mo l mr mq">5607ce2 (HEAD -&gt; aerabi/test) fixup! Add Test.md<br/>3963089 Add Test2.md<br/>56b4c6d Add Test.md</span></pre><p id="0740" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">消息是<code class="fe me mf mg mh b">fixup! Add Test.md</code>。因此，与我们试图修复的提交消息相同，只是前缀是<code class="fe me mf mg mh b">fixup!</code>。</p><p id="016f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们不希望这个提交像这样搁置，所以我们做了一个rebase:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="de17" class="mm lc it mh b be mn mo l mp mq">git rebase -i --autosquash HEAD~3</span></pre><p id="36f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将打开一个编辑器，显示以下内容:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="37de" class="mm lc it mh b be mn mo l mr mq">pick 56b4c6d Add Test.md<br/>fixup 5607ce2 fixup! Add Test.md<br/>pick 3963089 Add Test2.md</span></pre><p id="1d0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意，最后一次提交被移动，并被放置在它正在修复的提交之后。并且todo动词已经被设置为<code class="fe me mf mg mh b">fixup</code>。保存文件并关闭它，不要修改它。最后的结果是这样的:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="9fa0" class="mm lc it mh b be mn mo l mr mq">b8158e4 (HEAD -&gt; aerabi/test) Add Test2.md<br/>487cddb Add Test.md</span></pre><p id="3245" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后一次提交被合并到第一次提交中，并且它的散列也因此而改变。现在我们把它推进一步审查:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="4d41" class="mm lc it mh b be mn mo l mp mq">git push --force-with-lease</span></pre><h1 id="74eb" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">笔记</h1><p id="2f50" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">在rebasing上下文中，修正类似于挤压，只是它的提交消息被丢弃了。在squash的情况下，git会要求您合并提交消息。</p><p id="a339" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意，我们已经将标志<code class="fe me mf mg mh b">--autosquash</code>传递给了rebase命令。我们可以通过设置git配置使其默认:</p><pre class="kq kr ks kt gt mi mh mj bn mk ml bi"><span id="c7bc" class="mm lc it mh b be mn mo l mp mq">git config rebase.autosquash true</span></pre><p id="f1e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此命令以及有关挤压的更多内容在以下内容中进行了讨论:</p><ul class=""><li id="87ca" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated"><a class="ae ko" rel="noopener ugc nofollow" target="_blank" href="/16-git-tips-and-tricks-bf08d0602d3b"> 16个Git技巧和窍门</a></li></ul><p id="dbd7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，我们不得不推进<code class="fe me mf mg mh b">--force-with-lease</code>，因为我们通过重定基数改变了历史。更多关于武力与武力租赁的区别:</p><ul class=""><li id="e5b1" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated"><a class="ae ko" rel="noopener ugc nofollow" target="_blank" href="/git-force-vs-force-with-lease-9d0e753e8c41">Git Force vs Force with Lease</a></li></ul><h1 id="df27" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">遗言</h1><p id="434c" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我每周都会在git上写一篇博文。</p><ul class=""><li id="3290" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated"><a class="ae ko" href="https://medium.com/subscribe/@aerabi" rel="noopener">订阅</a>my Medium publishes，以便在新的Git周刊发布时获得通知。</li><li id="c245" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn mx my mz na bi translated">在Twitter上关注<a class="ae ko" href="https://twitter.com/MohammadAliEN" rel="noopener ugc nofollow" target="_blank">我</a>以获取更多其他平台上发布的更新和文章。</li></ul></div></div>    
</body>
</html>
# 通知 8——从老派到现代:大结局

> 原文：<https://itnext.io/notific8-from-old-school-to-modern-the-finale-6a8814b4c9af?source=collection_archive---------2----------------------->

![](img/86f2827e496f1f9463052c498ed82794.png)

重写 Notific8 是一次很棒的经历。web 开发的世界发展很快，自库最初创建以来，前端开发领域发生了很多变化。这次重写让我有机会在改进库的同时应用其中的很多内容。

在这篇总结性的文章中，我想强调一些重大的变化和它们背后的想法。

# 以打字打的文件

选择 Typescript 对我来说是一个相当容易的决定。ES2015+增加了许多新功能和语法增强，改善了开发体验。添加了类型和实验特性，Typescript 更进了一步。

我喜欢使用 typescript 有几个主要原因:

1.  有了打字功能，我就不会在代码中犯引入 bug 的愚蠢错误
2.  虽然没有在这个项目中使用，但它经常为新版本的 es(如 decorators)引入实验性的特性和建议
3.  许多 ide，如 Visual Studio Code(在重写开发过程中使用的工具)可以选择用于自动完成的类型和建议，以帮助加速开发

# 承诺

利用承诺是另一个很容易做出的决定。虽然要弄清楚它们到底属于哪里可能是一个挑战，但我从一开始就知道它们会使处理通知变得更容易。

# CSS 自定义属性(CSS 变量)

该库在其开发的早期就使用了 Sass。原因之一是允许使用变量来使开发更容易。

然而，CSS 自定义属性在几年前被引入 CSS 规范，并从此获得了相当广泛的浏览器支持。利用自定义属性可以更自然地使用浏览器功能，并减少所需的代码量。这也意味着消费者开发人员可以使用开发人员工具在浏览器中调整颜色值，而不必在进行最终更改之前测试组合时重新编译 CSS。

Notific8 的未来版本将更多地构建这一功能，使开发人员能够更容易地引入已经编译过的主题版本，然后更容易地从他们自己的样式表中定义自定义颜色。

# 可重复使用的通知

很久以前我就意识到有必要多次显示同一个通知。过去，开发人员每次都必须创建一个新的实例，这是一件痛苦的事情。在旧代码中很难确定如何正确地做到这一点，但重写给了我从一开始就这样做的机会。

利用 ES2015+类使这变得容易得多。现在，一个通知可以重复使用多次。这意味着当同一个通知需要显示多次时，它只在内存中创建一个实例，并且通知中的事件处理程序只被附加一次。可以在开发人员的代码库中跟踪同一个实例，然后稍后再次调用`open`函数来重新打开通知。

# 构建工具链

该项目在使用什么工具进行构建方面有了一些变化。直到重写之前，该工具一直使用 Grunt。然而，Grunt 最近似乎很少看到像 Webpack 这样的工具接管了它的职责。

这个项目比较小，比较简单。需要任何类型的构建的唯一两件事是源 Sass 文件和源 Typescript 文件。只需使用基本的工具并创建简单的命令在 package.json 文件中运行就足够了，这使得完全消除构建设置的需要成为可能。还有一个变化是，输出 JavaScript 是一个 ES2015+模块，旨在由最终开发人员使用构建工具导入到现代项目或转换，因此库的构建系统不再进行缩小或混淆。

# 演示页面

旧的演示页面只是:旧。它使用了帕格，意味着又一件需要澄清的事情。它还引入了一个 CSS 库，看起来很棒，但经常与 Notific8 风格冲突。决定改变它意味着删除了另一组构建步骤，使得旧的工具链不再有用。

新的演示使用了 Vue。这是一个非常轻量级的库，易于使用。Vue 还提供了一个使用现代库或框架在项目中实现 Notific8 的例子。这也意味着能够为演示抛弃对 jQuery 的需求。

# 放弃 IE 支持

出于某种原因，仍然有一些人选择使用 Internet Explorer(或者我喜欢称之为 Internet Exploder)。它已经过时多年，目前只收到安全补丁，但也即将结束。

我和我的同事每天都在试图支持它时遇到问题。就在最近，我不得不在工作中专门为 IE 写一些代码，这让我有些畏缩，但这是唯一能工作并让包变大的东西。

此时，已是 2019 年。微软多年来一直告诉人们停止使用它，在撰写本文时，他们正在更换 Edge，使用 Chromium 作为其核心。Chrome(和其他 chrome 衍生产品)和 Firefox 特别添加了一个很棒的网络浏览环境，并且定期快速更新。考虑到其他浏览器经常推出的新功能，用非常非常有限的功能集来支持一个不断缩小的浏览器是没有意义的。

# 最后的想法

最终，重写库可能需要一年多的时间，但从长远来看，这是值得的。我对最终结果非常满意，并认为它在一个更好的地方继续发挥它的作用。我对未来有一些计划和实验，但这些会在适当的时候到来。

感谢您关注本系列。这可能花了很长时间，但我希望这是值得的，我感谢你花时间通读所有的帖子。

# 最终代码

最终代码存放在 https://github.com/willsteinmetz/notific8 的 GitHub 上。完整的代码发布在版本 [5.0.0](https://github.com/willsteinmetz/notific8/tree/5.0.0) 中，是查看整个系列中工作的代码示例的版本。
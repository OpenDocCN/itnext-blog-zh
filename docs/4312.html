<html>
<head>
<title>Setting up GitHub packages for NPM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为NPM设置GitHub包</h1>
<blockquote>原文：<a href="https://itnext.io/setting-up-github-packages-for-npm-2bc9f8e4b11e?source=collection_archive---------1-----------------------#2020-06-05">https://itnext.io/setting-up-github-packages-for-npm-2bc9f8e4b11e?source=collection_archive---------1-----------------------#2020-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5871" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Github软件包于去年5月推出，但直到我开始新工作后，它才出现在我的视野中。因为我们的代码已经存储在Github上的仓库中，所以在没有额外成本的情况下，将我们的包也存储在那里是有意义的。</p><p id="4fb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事不宜迟，下面是如何设置。</p><h1 id="a154" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">发布包</h1><p id="6ed2" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">首先，在你的<code class="fe lp lq lr ls b">package.json</code>中命名你的包，并添加一个<code class="fe lp lq lr ls b">publishConfig</code>属性告诉<code class="fe lp lq lr ls b">npm</code>你正在发布到Github的注册表中。最后，确保<code class="fe lp lq lr ls b">repository</code>字段是正确的，因为它必须匹配您的存储库的url。</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="439e" class="mb kn iq ls b gy mc md l me mf">{<br/>  "name": "@companyname/package-name"<br/>  "publishConfig": {<br/>    "registry": "https://npm.pkg.github.com/"<br/>  },<br/>  "repository": "git://github.com/companyname/package-name.git" <br/>}</span></pre><p id="1c06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行publish，你的包应该成功发布到github包！</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="a48a" class="mb kn iq ls b gy mc md l me mf">npm publish</span></pre><p id="c1b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您应该看到您的包列在项目主页的顶部栏中:</p><figure class="lt lu lv lw gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mg"><img src="../Images/0b35bc2937231f1d0651f35218a1d9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tL27iInxGJ7PeaRJYhq2xA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">您的存储库栏中有1个新包！</figcaption></figure><h1 id="d520" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">安装软件包</h1><p id="5607" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">首先，在你的项目的根目录下添加一个<code class="fe lp lq lr ls b">.npmrc</code>。</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="02ea" class="mb kn iq ls b gy mc md l me mf">@yourcompany:registry=https://npm.pkg.github.com</span></pre><p id="2f57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这告诉<code class="fe lp lq lr ls b">npm</code>安装Github包中名称空间为<code class="fe lp lq lr ls b">@yourcompany</code>的任何包。</p><p id="1565" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装，您需要在Github中创建一个<a class="ae kl" href="https://github.com/settings/tokens" rel="noopener ugc nofollow" target="_blank">个人访问</a>令牌。授予它对包的读写权限。如果您的帐户可以访问该组织，那么它将可以访问其软件包。</p><p id="ac9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建令牌后，运行以下命令:</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="4061" class="mb kn iq ls b gy mc md l me mf">npm login --registry=https://npm.pkg.github.com</span></pre><p id="0228" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的用户名将是您的github用户名，您的密码将是令牌。之后，你应该可以安装你的软件包了！</p><h1 id="c40f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">在CI/CD中运行它</h1><p id="ff93" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">要在您的持续集成/部署设置中运行它，首先在您的平台中添加您的个人访问令牌作为环境变量(在下面的例子中命名为<code class="fe lp lq lr ls b">$GITHUB_ACCESS_TOKEN </code>)。</p><p id="f228" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在安装之前运行以下命令:</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="a94b" class="mb kn iq ls b gy mc md l me mf">echo //npm.pkg.github.com/:_authToken=$GITHUB_ACCESS_TOKEN &gt;&gt; ~/.npmrc</span></pre><p id="ba14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">唯一奇怪的是在环境变量中存储了一个特定于Github用户的令牌。到目前为止，看起来该组织自己还不能创造一个可以使用的代币。</p><h1 id="4f8b" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">总结</h1><p id="7bba" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">到目前为止，使用Github包是轻而易举的事情，将源代码和包存储在同一个地方也很好。</p></div></div>    
</body>
</html>
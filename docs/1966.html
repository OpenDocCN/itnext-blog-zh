<html>
<head>
<title>Display inline form validation message from server side validation in SAPUI5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SAPUI5中显示来自服务器端验证的内嵌表单验证消息</h1>
<blockquote>原文：<a href="https://itnext.io/sapui5-display-form-validation-from-server-side-validation-8323ceec9ade?source=collection_archive---------4-----------------------#2019-03-04">https://itnext.io/sapui5-display-form-validation-from-server-side-validation-8323ceec9ade?source=collection_archive---------4-----------------------#2019-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3dc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">UI5有很好的客户端内联验证。但是当涉及到服务器端验证时，尤其是在构建视图代码xml文件时，就不那么好了。</p><p id="811c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将讨论如何在服务器端进行表单验证，并在表单域中显示验证消息。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="6dca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设有一个类似下图的用户界面:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/1cc489ebe9fd6bb80f0a8671403f4196.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*43olaPMz1-Iww26MtJ2sKg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">演示用户界面</figcaption></figure><p id="f877" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">UI由输入 的<strong class="jp ir"> <em class="le">标题和输入</em> </strong>的<strong class="jp ir"> <em class="le">内容组成列表。这个UI是由一个模型动态呈现的。ui是在XML视图中定义的，这意味着您不能为每个输入字段定义ID。当用户点击保存，前端发送数据到后端。后端基于业务逻辑进行某些验证，然后将错误信息发送回前端。前端在相应的输入字段内显示错误。出于演示目的，表单验证的逻辑非常简单，如果<strong class="jp ir"> <em class="le">标题输入</em> </strong>的值不是“UI5”或者<strong class="jp ir"> <em class="le">内容输入</em> </strong>的值不是“SAP”就会显示错误。</em></strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lf"><img src="../Images/85275e20204cff85e79feafb2a5c27b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0pPlx-DJXygHjfuIKMDIQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">演示UI显示错误</figcaption></figure></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="502f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题是前端如何知道哪个错误属于哪个输入字段？一切以模型为基础。因此，每个错误都通过“路径”与输入字段相关联。把路径想象成模型的面包屑。例如，我们有一个如下所示的模型:</p><pre class="kt ku kv kw gt lk ll lm ln aw lo bi"><span id="82ea" class="lp lq iq ll b gy lr ls l lt lu">{<br/> form: [{<br/>   title: "title1",<br/>   content: "cc1"<br/> }, {<br/>   title: "UI5",<br/>   content: "SAP"<br/> }, {<br/>   title: "title3",<br/>   content: "cc3"<br/> }],<br/> createdBy: "Hao"<br/>}</span></pre><p id="3a2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而你想告诉前端值等于“cc1”的<strong class="jp ir"> <em class="le">内容属性</em> </strong>是错误的。该属性的路径将是<strong class="jp ir">“表单/0/内容”。</strong>如果将此路径作为目标属性传递给MessageManager，</p><pre class="kt ku kv kw gt lk ll lm ln aw lo bi"><span id="561a" class="lp lq iq ll b gy lr ls l lt lu">sap.ui.getCore().getMessageManager().addMessages(<br/> new sap.ui.core.message.Message({<br/> type: sap.ui.core.MessageType.Error,<br/> message: <strong class="ll ir">path</strong>,<br/> processor: this.getView().getModel(‘forms’)<br/> })<br/>);</span></pre><p id="5b00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">行内错误将显示在值为“cc1”的输入字段上。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="5006" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在后端开始验证表单之前，我在模型的每一层添加了“<strong class="jp ir"><em class="le">currentLevelPah</em></strong>”。这可以由前端或后端来完成。看看"<strong class="jp ir">currentlevelpath</strong>"是什么样子:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/4e45e578bcbde960f56747cfe2a99480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*ovE8s8cKxvViF34uVur52w.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">在开始验证表单之前，添加了<strong class="bd lw"> currentLevelPath </strong></figcaption></figure><p id="e4b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">后端进行表单验证，并将错误信息发送给前端。看看错误信息是什么样子的:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/de26df1e1dc479d85fe3cbc9ecebb36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*-yhBif-oMV0N53s7FqmJGQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来自后端的错误信息，请注意“路径”属性</figcaption></figure></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="f0aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以从https://github.com/haojia321/server-side-validation-in-ui5找到这个演示的代码</p><p id="816d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您有任何问题或建议，请告诉我。</p></div></div>    
</body>
</html>
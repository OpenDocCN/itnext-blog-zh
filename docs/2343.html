<html>
<head>
<title>Kubernetes Journey — Up and running out of the cloud — Architecture Overview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes之旅—启动并运行云计算—架构概述</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-journey-up-and-running-out-of-the-cloud-architecture-overview-e75763b54922?source=collection_archive---------4-----------------------#2019-05-08">https://itnext.io/kubernetes-journey-up-and-running-out-of-the-cloud-architecture-overview-e75763b54922?source=collection_archive---------4-----------------------#2019-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/21390ed9935400f2dfd942cb7b8504c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dsOydvgmyi96E3nmp2mQjQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">迪伦·诺尔特在<a class="ae kc" href="https://unsplash.com/search/photos/computers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="30e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将定义集群的架构。我们还将看到行业中使用的不同类型的集群，并确定Kubernetes属于哪个类别。</p><p id="17a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae kc" href="https://medium.com/@mtvallim/kubernetes-journey-up-and-running-out-of-the-cloud-introduction-f04a811c92a5" rel="noopener">的上一篇文章</a>中，我们谈到了应用程序开发的演变，并设置了我们旅程所基于的背景(在云之外设置一个Kubernetes集群)。</p><p id="4334" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些文章是我们<a class="ae kc" href="https://medium.com/@mtvallim/kubernetes-journey-up-and-running-out-of-the-cloud-introduction-f04a811c92a5" rel="noopener"> Kubernetes之旅</a>的一部分。我希望您对深入研究如何从云中安装和配置Kubernetes感到兴奋！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="40aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你不想等到所有的文章都发表了，又想马上动手，可以随意克隆项目的Github repo。它完全实用，文档也在不断改进:</p><div class="li lj gp gr lk ll"><a href="https://github.com/mvallim/kubernetes-under-the-hood" rel="noopener  ugc nofollow" target="_blank"><div class="lm ab fo"><div class="ln ab lo cl cj lp"><h2 class="bd ir gy z fp lq fr fs lr fu fw ip bi translated">罩下的姆瓦利姆/库伯内特斯</h2><div class="ls l"><h3 class="bd b gy z fp lq fr fs lr fu fw dk translated">本教程是有人计划安装一个Kubernetes集群，并希望了解一切如何配合在一起…</h3></div><div class="lt l"><p class="bd b dl z fp lq fr fs lr fu fw dk translated">github.com</p></div></div><div class="lu l"><div class="lv l lw lx ly lu lz jw ll"/></div></div></a></div></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="2793" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">架构图</h1><figure class="mz na nb nc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/b9342ea951e1351d7bf1417b8cc23e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n3zXDLg-A8iHaKjwFQiGyA.png"/></div></div></figure><h1 id="c72d" class="ma mb iq bd mc md nd mf mg mh ne mj mk ml nf mn mo mp ng mr ms mt nh mv mw mx bi translated">单羟基团簇</h1><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ef14f3ce0d33e9b2e7975c5c16e2f097.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*qg4veKrWOGyaXKOp90-YHA.png"/></div></figure><p id="334c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由<strong class="kf ir">浮动IP </strong>和<a class="ae kc" href="https://clusterlabs.org/corosync.html" rel="noopener ugc nofollow" target="_blank">Corosync</a>/<a class="ae kc" href="https://clusterlabs.org/pacemaker/" rel="noopener ugc nofollow" target="_blank">Pacemaker</a>集群堆栈支持的高可用性HAProxy负载平衡器。</p><p id="5108" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">浮动IP也称为“共享”或“虚拟”IP地址。浮动IP是分配给最终可能出现故障的节点的正常IP地址。对于故障转移，具有相似特征(被动)的节点与主(主动)节点一起以主动/被动模式运行。如果发生故障，这个浮动IP将自动透明地分配给被动节点，使其成为主动节点，从而避免停机。</p><p id="75dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个HAProxy负载平衡器将被配置为在后端应用服务器之间分割流量。如果主负载平衡器关闭，浮动IP将自动移动到第二个负载平衡器，允许它继续服务而不停机。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/1cadba133a863877962b62d88e42f65e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*wNBVXXzIJAIz86avA_sTGQ.gif"/></div></figure><h1 id="c5ca" class="ma mb iq bd mc md nd mf mg mh ne mj mk ml nf mn mo mp ng mr ms mt nh mv mw mx bi translated">库伯内特星团</h1><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/379f48661f7a883a83c651861018bc5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*Vwz3H34tEt4AWsxQrs-uXg.png"/></div></figure><p id="df13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://kubernetes.io/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> Kubernetes </strong> </a> <strong class="kf ir">协调连接在一起作为一个单元工作的高可用性计算机集群。</strong>Kubernetes中的抽象允许您将容器化的应用程序部署到集群中，而不需要将它们专门绑定到单独的机器上。为了利用这种新的部署模式，应用程序需要以一种与单个主机分离的方式打包:它们需要容器化。与过去的部署模型相比，容器化的应用程序更加灵活和可用，在过去的部署模型中，应用程序被直接安装到特定的机器上，作为深度集成到主机中的包。<strong class="kf ir"> Kubernetes以一种更有效的方式自动化了应用容器在集群中的分发和调度。</strong></p><p id="7e5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Kubernetes是一个开源平台，可以投入生产。</p><h1 id="1e66" class="ma mb iq bd mc md nd mf mg mh ne mj mk ml nf mn mo mp ng mr ms mt nh mv mw mx bi translated">格鲁斯特</h1><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ae79cc0cb596d93d5a831f4379dd786d.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*iIGmEr6yBRTGuOBovi2T6w.png"/></div></figure><p id="2c55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://docs.gluster.org/en/latest/Administrator%20Guide/GlusterFS%20Introduction/" rel="noopener ugc nofollow" target="_blank"> GlusterFS </a>是一个可扩展的网络文件系统，适用于云存储和媒体流等数据密集型任务。GlusterFS是免费的开源软件，可以利用常见的现成硬件。Gluster的主要目的是为Kubernetes Pods提供容量。它将像Kubernetes中的任何其他应用程序一样被管理和协调。这是释放Kubernetes中动态提供的持久GlusterFS卷的能力的一种便捷方式。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/374e9e10d75c058e8a7045ea5c873468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*-kkyhdXPHaH60PICzjnM_g.gif"/></div></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="7a15" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">聚类定义</h1><p id="99c4" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">Cluster是一个英文术语，意思是“凝聚”或“凝聚”，可以应用在各种上下文中。在计算环境中，该术语定义了能够将几台计算机组合在一起工作的系统架构。</p><p id="1092" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个工作站被称为一个“节点”,组合在一起形成集群。在某些情况下，可能会看到相同场景的“超级计算机”或“集群计算”等参考，代表所使用的硬件或专门开发的软件，以便能够组合这些设备。</p><blockquote class="nq nr ns"><p id="103b" class="kd ke nt kf b kg kh ki kj kk kl km kn nu kp kq kr nv kt ku kv nw kx ky kz la ij bi translated">参考:<a class="ae kc" href="https://en.wikipedia.org/wiki/Computer_cluster" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Computer_cluster</a></p></blockquote><h1 id="570b" class="ma mb iq bd mc md nd mf mg mh ne mj mk ml nf mn mo mp ng mr ms mt nh mv mw mx bi translated">集群是如何形成的？</h1><p id="c098" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">将多台计算机聚合在一起执行任务似乎非常简单，但事实并非如此。1960年，IBM开始致力于有效地构建这种用途，并且一直在不断发展。目标始终是提高融合的效率，即优化充分利用所有节点的资源，动态地进化集群。</p><h1 id="3d8d" class="ma mb iq bd mc md nd mf mg mh ne mj mk ml nf mn mo mp ng mr ms mt nh mv mw mx bi translated">所有的集群都一样吗？</h1><p id="eabd" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">不会。有不同类型的集群专注于合并的不同好处，因此更适合某些任务和市场。参见下面四种主要类型的集群:</p><h2 id="6246" class="nx mb iq bd mc ny nz dn mg oa ob dp mk ko oc od mo ks oe of ms kw og oh mw oi bi translated">故障转移或高可用性(HA)</h2><p id="afcd" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">顾名思义，开发这种类型的集群的目的是让应用程序始终保持活动和响应。不管每个节点上发生了什么，系统保持在线是非常重要的。为此，几个节点在用户不可见的冗余模式上工作。为了说明这个概念，想象一场篮球比赛，其中一名替补球员与首发球员具有完全相同的特征——实际上是原版的克隆——总是热情地站在球场边缘。如果首发球员因为任何原因需要离场，替补球员立即采取行动，裁判、公众和队友都没有意识到。这是一种常用于电子邮件等服务的群集类型，在这些服务中，停止服务是完全不可接受的。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/5d4a206d132fca377d4ccf1a1fc2f3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBr6nVXrWyLe7DEqTpqwAQ.png"/></div></div></figure><h2 id="9e2f" class="nx mb iq bd mc ny nz dn mg oa ob dp mk ko oc od mo ks oe of ms kw og oh mw oi bi translated">负载平衡</h2><p id="fd25" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">在这种类型的架构中，所有节点负责执行任务。无论是响应传入的流量请求还是提供资源，任务总是被分配给组成系统的机器。这实际上是一种“人人为我”的方法。从最简单到最复杂的任务都是利用所有可用资源的联合所产生的计算能力来执行的。在这个模型中，性能是优先考虑的因素，如果任何一个节点出现故障，它将从系统中删除，任务将在剩余的节点中重新分配。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/e6df178fd02bd351f48d5e3994ef3b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EzXO2bASWqCtQL2morOCeA.png"/></div></div></figure><h2 id="3fbd" class="nx mb iq bd mc ny nz dn mg oa ob dp mk ko oc od mo ks oe of ms kw og oh mw oi bi translated">并行处理</h2><p id="9fe0" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">在这种类型的集群中，大型任务被划分到不太复杂的活动中，由系统分配，并由组成集群的各个节点并行执行。因此，这种类型的集群非常适合非常复杂的计算任务。粗略地说，这就像在十个朋友之间分割五千块拼图，让每个朋友负责组装包含五百块的拼图。在每个朋友完成自己的部分后，这些组块被组合起来解决主要的难题(有人知道吗？)</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/c171d4df5408458fe463795dad67fd49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nksjhKvdf6SCOM49pxaQ9A.png"/></div></div></figure><h2 id="72f8" class="nx mb iq bd mc ny nz dn mg oa ob dp mk ko oc od mo ks oe of ms kw og oh mw oi bi translated">组合模型</h2><p id="5d39" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">在某些情况下，不可能将性能置于稳定性之上，反之亦然。例如，MTA服务器或电子邮件服务器需要这两种功能具有相同的优先级。因此，这些公司使用能够结合负载平衡和高可用性的集群。这导致系统能够组合不同机器的功率，同时具有冗余节点的内部网络以避免中断。</p><h2 id="bff8" class="nx mb iq bd mc ny nz dn mg oa ob dp mk ko oc od mo ks oe of ms kw og oh mw oi bi translated">Kubernetes属于哪一类？</h2><p id="62e6" class="pw-post-body-paragraph kd ke iq kf b kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">Kubernetes采用了一种综合的方法。故障转移和高可用性，因此it部门能够(重新)安排PODs在不同的节点上运行，即使一个(或多个)PODs出现故障，也能保持应用程序正常运行。和负载平衡，因此它能够将请求分发到在不同节点上运行的pod，避免特定节点成为热点并最终影响应用程序的性能。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="1637" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这篇文章以及这个系列的其他文章。在下一篇文章中，我们将讨论我们的技术堆栈，解释每个组件如何适应我们的架构。</p><p id="2a51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不要忘记在下面的评论中留下你的反馈。不断完善这一系列的内容非常重要。</p><p id="9e1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我再次强烈推荐您关注我的Medium，这样您就不会错过本系列中发表的任何新文章。如果你错过了第一篇文章，你可以查看这里的<a class="ae kc" href="https://medium.com/@mtvallim/kubernetes-journey-up-and-running-out-of-the-cloud-introduction-f04a811c92a5" rel="noopener"/>。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="fe1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回头见！！</p><p id="75f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">再见。</p></div></div>    
</body>
</html>
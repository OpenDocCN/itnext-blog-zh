<html>
<head>
<title>Kotlin: Sealed Classes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kotlin:密封类</h1>
<blockquote>原文：<a href="https://itnext.io/kotlin-sealed-classes-70f83d6ab567?source=collection_archive---------6-----------------------#2019-07-29">https://itnext.io/kotlin-sealed-classes-70f83d6ab567?source=collection_archive---------6-----------------------#2019-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ece0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">通过实例学习</h2><div class=""/><div class=""><h2 id="1f9b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Android中何时使用密封类的一个具体例子</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/4ed8651c9c4df76db7518d60a6692c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAOQGxjh4rooJcEQYjyoHQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">密封类，不是密封类！</figcaption></figure><p id="5180" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi md translated">这里已经有<a class="ae mm" href="https://medium.com/search?q=kotlin%20sealed%20classes" rel="noopener">很多关于Kotlin密封类</a>的文章，所以我不打算在这里重复我认为其他人已经充分涉及的内容。相反，本文将展示一个在Android代码中使用密封类的实际例子，以便您可以更好地了解如何以及何时利用它们。</p><p id="409a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们的例子中，我们将基于我上个月写的<a class="ae mm" href="https://medium.com/swlh/creating-an-android-app-launcher-20519adcda10" rel="noopener"> <em class="mn">创建一个Android应用启动器</em> </a>的文章。在那篇文章中，我展示了如何在自己的应用中创建一个功能来启动其他第三方应用。如果你还没有看过那篇文章，那么你可能想跳过去快速阅读一下。如果您已经阅读了这篇文章，并且查看了GitHub示例项目附带的<a class="ae mm" href="https://github.com/ThomasSunderland/demo_applauncher" rel="noopener ugc nofollow" target="_blank">，那么您可能已经注意到在</a><a class="ae mm" href="https://github.com/ThomasSunderland/demo_applauncher/blob/master/app/src/main/kotlin/com/babybillssoftwarefactory/applauncherdemo/viewmodel/AppLauncherViewModel.kt" rel="noopener ugc nofollow" target="_blank">appancherviewmodel</a>类内部有一个名为<em class="mn"> App </em>的内部密封类和一个名为<em class="mn"> AppInfo </em>的<em class="mn"> App </em>的具体子类。为了方便起见，它们又出现在这里:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="34a1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有了我们的密封类<em class="mn"> App </em>及其唯一的具体实现类<em class="mn"> AppInfo </em>之后，我们现在能够在我们的<a class="ae mm" href="https://github.com/ThomasSunderland/demo_applauncher/blob/master/app/src/main/kotlin/com/babybillssoftwarefactory/applauncherdemo/view/adapters/AppLauncherAdapter.kt" rel="noopener ugc nofollow" target="_blank"><em class="mn">appan cheradapter</em></a><em class="mn"/>类<em class="mn"> </em> <a class="ae mm" href="https://kotlinlang.org/docs/reference/control-flow.html#when-expression" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">中执行以下操作，当</strong> </a>确定如何在我们的小app launcher对话框中呈现和处理<em class="mn"> App </em>的实例时，如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="7092" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在这已经足够好了，但让我们继续想象我们的产品负责人后来对我们说<em class="mn">嘿，&lt;在这里插入你的名字&gt;，如果除了第三方应用程序之外，我们还可以直接从我们的应用程序启动对话框中显示一些新奇的</em> <a class="ae mm" href="https://developer.android.com/preview/features#settings-panels" rel="noopener ugc nofollow" target="_blank"> <em class="mn"> Android Q设置面板</em> </a> <em class="mn">，这肯定会很酷。</em></p><p id="db9e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有趣的想法假设产品所有者！我们知道当前的<em class="mn"> AppInfo </em>类允许我们指定一个标签和一个图标，这两个标签和图标可能也是我们显示设置面板的快捷方式所需要的，但不幸的是，当前为我们的<em class="mn"> AppInfo </em>对象调用的点击处理程序导致我们使用底层应用程序包的启动意图来启动应用程序，而这根本不是我们显示设置面板所需要的。</p><p id="71da" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">那么我们该如何着手实施呢？让我们扩展我们的密封类层次结构，好吗？现在，不仅仅是<em class="mn"> App </em>的一个子类，我们将有如下的类层次结构:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mq"><img src="../Images/cf0f0029dfefc054ddeca476dde984df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3lF7veAEA_dSpfiYEdZaaA.png"/></div></div></figure><p id="aff6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">代表上述类层次结构的更新代码在以下要点中详细显示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="8d2b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">正如你所看到的，我们简单地创建了<em class="mn"> App </em>的第二个子类，名为<em class="mn"> SettingsPanel </em>，它接受一个标签和图标，类似于<em class="mn"> AppInfo </em>，但也接受一个表示要显示的设置面板的字符串。该字符串应该是设置之一。由Android SDK提供的面板常量在这里找到<a class="ae mm" href="https://developer.android.com/reference/android/provider/Settings.Panel.html#constants_2" rel="noopener ugc nofollow" target="_blank">。还要注意，app icon字段被移到了<em class="mn"> App </em>类中，因为它已经被证明是两个子类中的一个公共属性。</a></p><p id="cacf" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有了这个更新的类层次结构，我们现在可以更新我们的适配器类，以支持应用程序和设置面板，如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="e701" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">值得注意的是，如果我们事先知道我们唯一支持的设置面板是音量设置面板，那么我们可以只创建一个继承自<em class="mn">应用</em>的<em class="mn">设置面板音量</em> <a class="ae mm" href="https://kotlinlang.org/docs/reference/object-declarations.html#object-expressions" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">对象</strong> </a> (singleton ),而不是更通用的<em class="mn">设置面板</em>数据类。在本例中，我们采用了数据类的方式，这样我们就可以支持现在和将来都支持的任何设置面板。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="3161" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">结论<br/>  Kotlin密封类不仅允许类设计者有效地限制类的层次结构，还允许开发者进一步利用非常强大的Kotlin <a class="ae mm" href="https://kotlinlang.org/docs/reference/control-flow.html#when-expression" rel="noopener ugc nofollow" target="_blank"> when </a>表达式。希望这个利用Kotlin密封类的具体例子能让你超越理论，进入实践。</p><p id="f415" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">编码快乐！托马斯·桑德兰</p><div class="my mz gp gr na nb"><a href="https://www.linkedin.com/in/thomas-sunderland/" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd jd gy z fp ng fr fs nh fu fw jc bi translated">托马斯·桑德兰-安卓开发者| LinkedIn</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">加入LinkedIn我叫Thomas Sunderland，是一名软件工程师，专注于原生Android开发。我…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.linkedin.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np lb nb"/></div></div></a></div></div></div>    
</body>
</html>
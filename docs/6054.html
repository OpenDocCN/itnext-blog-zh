<html>
<head>
<title>Deploying Smart Contracts to Binance Smart chain with Truffle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将智能合约部署到币安松露智能连锁店</h1>
<blockquote>原文：<a href="https://itnext.io/deploying-smart-contracts-to-binance-smart-chain-with-truffle-c57a7d1eb6ed?source=collection_archive---------3-----------------------#2021-08-03">https://itnext.io/deploying-smart-contracts-to-binance-smart-chain-with-truffle-c57a7d1eb6ed?source=collection_archive---------3-----------------------#2021-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4ae80a4ff2c14b8626bd9fdf97be0072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*beNNk4dNgWcVyjA6L7uWJg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">珀西·博尔默拍摄的图片</figcaption></figure><p id="dcce" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这是我们使用定制的BEP-20智能合约从头开始构建DApp系列的第四篇也是最后一篇文章。<br/>在本文中，我们将看看如何将智能合约部署到币安测试网，而不是我们的本地Ganache实例。</p><ol class=""><li id="4c5d" class="lf lg it kj b kk kl ko kp ks lh kw li la lj le lk ll lm ln bi translated"><a class="ae lo" href="https://medium.com/@percybolmer1/building-a-decentralized-application-with-bep-20-contract-in-solidity-d2c066447aa6" rel="noopener"> <strong class="kj iu">【在Solidity中用BEP-20契约构建一个去中心化的应用】</strong> </a> —这篇文章将帮助你理解Solidity的基础知识</li><li id="fee4" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le lk ll lm ln bi translated"><a class="ae lo" href="https://medium.com/@percybolmer1/creating-a-inheritable-staking-contract-in-solidity-7804ae2d7a32" rel="noopener"> <strong class="kj iu">【在Solidity中创建可继承的赌注契约】</strong> </a> —第二篇文章，我们将介绍更高级的Solidity项目并实现赌注和奖励</li><li id="efdb" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le lk ll lm ln bi translated"><a class="ae lo" href="https://medium.com/@percybolmer1/using-a-smart-contract-in-an-web-application-78432ed68527" rel="noopener"> <strong class="kj iu">【在Web应用中使用智能合约】</strong> </a> —本系列的第三篇文章，我们将学习如何使用元掩码通过Web应用连接到区块链</li><li id="6ee3" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le lk ll lm ln bi translated"><strong class="kj iu">【用松露将智能合约部署到币安智能连锁店】</strong> —第四篇也是最后一篇文章，我们将学习如何将智能合约部署到真实网络中</li></ol><p id="199a" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">你可以在这里找到前面部分<a class="ae lo" href="https://github.com/percybolmer/DevToken/tree/dapp" rel="noopener ugc nofollow" target="_blank">使用的完整代码。</a></p><p id="7c74" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">我们将从更新我们的<strong class="kj iu"> truffle-config.js中的Truffle配置开始。</strong>我们将开放三个网络，以便我们可以将它们部署到所有三个网络。最新的部署信息可以在<a class="ae lo" href="https://docs.binance.org/smart-chain/developer/deploy/truffle.html" rel="noopener ugc nofollow" target="_blank">这里找到。我们还需要使用你必须下载的truffle/hdwallet提供程序。</a></p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="673a" class="md me it lz b gy mf mg l mh mi">npm install @truffle/hdwallet-provider</span></pre><p id="a9e2" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">之后，我们需要取消对module.exports字段的注释，并添加以下三个网络。</p><figure class="lu lv lw lx gt ju"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">Truffle —允许我们部署到所有三个网络的配置</figcaption></figure><p id="d201" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">在此工作之前，你需要注意我们正在读取一个名为<strong class="kj iu"> .secret. </strong>的文件，这个文件应该只包含一个东西，你的<a class="ae lo" href="https://academy.binance.com/en/glossary/seed-phrase" rel="noopener ugc nofollow" target="_blank">助记符</a>。</p><p id="e36e" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这是一个用来访问你的钱包的单词列表。就当是密码吧，不过长。当你在MetaMask中创建你的帐户时，你应该已经得到了种子短语。但是如果你忘记了，你可以通过点击这个<a class="ae lo" href="https://metamask.zendesk.com/hc/en-us/articles/360015290032-How-to-reveal-your-Seed-Phrase-Secret-Recovery-Phrase" rel="noopener ugc nofollow" target="_blank">链接</a>来查看。</p><h2 id="0200" class="md me it bd ml mm mn dn mo mp mq dp mr ks ms mt mu kw mv mw mx la my mz na nb bi translated">部署到TestNet</h2><p id="e85f" class="pw-post-body-paragraph kh ki it kj b kk nc km kn ko nd kq kr ks ne ku kv kw nf ky kz la ng lc ld le im bi translated">如果您已经将助记符粘贴到。秘密文件是时候尝试部署智能合同了。我们将开始把它部署到TestNet，看看它有多容易部署。现在，部署到TestNet的原因是，它将像测试一样工作，以查看智能合约是否按预期工作。</p><p id="36ae" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">测试网是真实生产网络的完全复制品，所以这是一个尝试一切的好方法。使用它将允许我们也有一个开发环境(Ganache)，测试(Testnet)，生产(真正的币安智能链)。</p><p id="9946" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">还记得我们如何运行<strong class="kj iu">块菌迁移</strong>部署到加纳切吗？<br/>这里的美妙之处在于，要部署到测试或生产环境，我们可以使用相同的过程，只需在命令中添加一个— network标志，并指定要部署到哪个网络。请记住，为了推动测试和生产，您将不得不<strong class="kj iu">支付天然气</strong>。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8d5b" class="md me it lz b gy mf mg l mh mi">truffle migrate --network testnet</span></pre><p id="8ac1" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">尝试运行该命令，看看会发生什么。如果您像我在本系列中所做的那样使用新的元掩码帐户，您将看到以下内容。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/cacab563989d5653825287f207b4268e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BeWDhkRBY9y-2rcNQ7QgdA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">块菌迁移——由于气体不足而失败</figcaption></figure><p id="f63b" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">原因是，正如我现在多次重复的那样，部署智能合同需要成本。记住这一点，如果你把智能合同推给真正的币安智能链，它会抽走你的钱。</p><blockquote class="ni"><p id="d703" class="nj nk it bd nl nm nn no np nq nr le dk translated">但是我不要花钱去部署测试！—廉价的开发人员</p></blockquote><p id="037f" class="pw-post-body-paragraph kh ki it kj b kk ns km kn ko nt kq kr ks nu ku kv kw nv ky kz la nw lc ld le im bi translated">幸运的是，testnet有水龙头，允许我们免费测试以太坊。让我们通过添加另一个网络将MetaMask连接到Testnet。该网络是官方的币安测试网。如果您忘记了如何添加网络，请阅读本系列的第三篇文章或阅读此处的<a class="ae lo" href="https://academy.binance.com/en/articles/connecting-metamask-to-binance-smart-chain" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="0fbe" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">添加自定义RPC时要使用的网络数据如下</p><p id="b951" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated"><strong class="kj iu">网络名称:</strong>智能链— Testnet <br/> <strong class="kj iu">新建RPC URL:</strong><a class="ae lo" href="https://data-seed-prebsc-1-s1.binance.org:8545/" rel="noopener ugc nofollow" target="_blank">https://data-seed-prebsc-1-s1.binance.org:8545/</a><br/><strong class="kj iu">Chain id:</strong>97<br/><strong class="kj iu">符号:</strong>BNB<br/><strong class="kj iu">Block Explorer URL:</strong><a class="ae lo" href="https://testnet.bscscan.com" rel="noopener ugc nofollow" target="_blank">https://testnet.bscscan.com</a></p><p id="09b5" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">添加后，通过点击MetaMask中的帐户获取您的帐户地址。</p><p id="adc4" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">访问<a class="ae lo" href="https://testnet.binance.org/faucet-smart" rel="noopener ugc nofollow" target="_blank">官方测试网</a>智能水龙头，它给你代币使用。只需输入您的地址，然后按“<strong class="kj iu">给我BNB </strong>”。等待几秒钟，你的帐户应该被资助。现在，您应该看到元掩码中有1个BNB。是时候给松露迁移一个新的旋转了。</p><p id="b638" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">注意。如果您在元掩码中有多个帐户，并且将免费令牌给了除第一个帐户之外的其他帐户，则您需要指定迁移时要使用的帐户。Truffle将默认为第一个可用的帐户。在testnet配置中添加以下内容。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="411a" class="md me it lz b gy mf mg l mh mi">from: "0xyouraccount"</span></pre><p id="7409" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">使用您获得资金的帐户再次运行migrate命令到testnet。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nx"><img src="../Images/9590e037a00ed9f4a56c8eacbb58822c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8c3rGr5Mqf8-B2bjgSEcLg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">块菌迁移—部署到测试网</figcaption></figure><p id="b41d" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">祝贺您，您已经部署到Testnet。你可以复制<strong class="kj iu">合同地址。</strong>然后你可以在<a class="ae lo" href="https://testnet.bscscan.com/token/0x083863013a6b34a4a265eb6ff696daf35071c48e#balances" rel="noopener ugc nofollow" target="_blank">测试网络浏览器</a>上搜索它。现在，您可以将令牌添加到元掩码，以查看您当前的帐户余额。选择“添加令牌”并输入请求的信息，该信息应为合同地址。要迁移到mainnet，只需将migrate命令中的网络更改为mainnet，但请记住您的帐户上要有足够的汽油。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ny"><img src="../Images/880fc710ce5e9f648854147948d1e9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*blZtikPmGONtyzYKs9-r5w.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">dev Token——区块链探险家展示我们的令牌</figcaption></figure><h2 id="be6a" class="md me it bd ml mm mn dn mo mp mq dp mr ks ms mt mu kw mv mw mx la my mz na nb bi translated">在测试网中测试DApp</h2><p id="5ee6" class="pw-post-body-paragraph kh ki it kj b kk nc km kn ko nd kq kr ks ne ku kv kw nf ky kz la ng lc ld le im bi translated">让我们试试我们在本系列第3部分中构建的DApp，看看它是否有效。</p><p id="e701" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">转到App.js中可怕的硬编码getContractAddress函数，替换它返回的契约，以匹配您的智能契约地址。</p><figure class="lu lv lw lx gt ju"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">DApp —更改返回的智能合约以匹配您的智能合约地址</figcaption></figure><p id="fade" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">如果您在MetaMask和您的帐户中选择了TestNet network，请使用以下命令再次启动DApp</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="98d4" class="md me it lz b gy mf mg l mh mi">npm start</span></pre><p id="59e2" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">并访问<a class="ae lo" href="http://localhost:3000/dashboard" rel="noopener ugc nofollow" target="_blank"> localhost:3000 </a>。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/6377d1fe17099ad6a9a6ae455b0492da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9snKDLHD-41PIMvikUaCA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">DApp——在测试网上工作</figcaption></figure><h2 id="10f1" class="md me it bd ml mm mn dn mo mp mq dp mr ks ms mt mu kw mv mw mx la my mz na nb bi translated">在币安测试网浏览器中查看事务和事件。</h2><p id="d40e" class="pw-post-body-paragraph kh ki it kj b kk nc km kn ko nd kq kr ks ne ku kv kw nf ky kz la ng lc ld le im bi translated">让我们执行一个Stake并访问testnet explorer来查看信息，就像在Ganache中一样。</p><p id="d471" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">按下按钮时，应该会提示您元掩码请求。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/99f571aceccc1aa19c20623c46341d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SNwA9haNjN_Zqc4cP4PBQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">元掩码——在测试网上打桩</figcaption></figure><p id="ca46" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">现在，等待MetaMask弹出窗口，显示交易成功。当它出现时，要么单击它以打开浏览器，要么访问浏览器并搜索令牌地址。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/5cf6fb9cbc9369eb06d757f13cf7e227.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1k1w7To6Is-ERZ2hHs-lLQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">元掩码—单击弹出窗口进行查看</figcaption></figure><p id="7aa2" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这将把您带到浏览器，您可以在其中查看智能合约上发生的所有交易以及所有事件。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/832655d9397c881e2d5293234d767291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jts5cdpvPj2a2W5-A0G5kg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">DApp —显示所有交易和事件的Testnetwork explorer。</figcaption></figure><p id="b9aa" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">如果导航到Events选项卡，您还应该能够看到已经触发的Staked事件。</p><h2 id="2523" class="md me it bd ml mm mn dn mo mp mq dp mr ks ms mt mu kw mv mw mx la my mz na nb bi translated">结论</h2><p id="510d" class="pw-post-body-paragraph kh ki it kj b kk nc km kn ko nd kq kr ks ne ku kv kw nf ky kz la ng lc ld le im bi translated">恭喜你！如果你已经完成了这个系列的所有部分，那么你现在已经完成了你的第一个DApp。</p><p id="d2a5" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">在这个系列中，我们了解到</p><ul class=""><li id="b2b5" class="lf lg it kj b kk kl ko kp ks lh kw li la lj le od ll lm ln bi translated">基本坚固性</li><li id="69cd" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le od ll lm ln bi translated">实现了一个简单的锁定机制</li><li id="2140" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le od ll lm ln bi translated">实施奖励制度</li><li id="4224" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le od ll lm ln bi translated">使用和控制合同的web用户界面</li><li id="e5e8" class="lf lg it kj b kk lp ko lq ks lr kw ls la lt le od ll lm ln bi translated">如何部署到testnet和mainnet？</li></ul><p id="a677" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">希望你已经学到了一些东西。感谢您的阅读！</p><p id="2cdf" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">如果有任何问题或反馈，请随时评论或给我发消息。</p></div></div>    
</body>
</html>
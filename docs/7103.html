<html>
<head>
<title>Triggering AWS Lambda Functions from Serverless Kafka</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从无服务器Kafka触发AWS Lambda函数</h1>
<blockquote>原文：<a href="https://itnext.io/triggering-aws-lambda-functions-from-serverless-kafka-478563393230?source=collection_archive---------0-----------------------#2022-06-14">https://itnext.io/triggering-aws-lambda-functions-from-serverless-kafka-478563393230?source=collection_archive---------0-----------------------#2022-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/73b6797a31ed3ab26151588930e6c471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pNFVKTnTIjhKz2TX"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@kelvin1987?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kelvin Ang </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9eed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天，我们将连接两个世界。一个世界是无服务器的卡夫卡，另一个世界是无服务器的功能。</p><p id="ba58" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本教程将演示如何生成触发Lambda函数的Kafka消息。Kafka实例将在<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank">上运行，而对于Lambda函数，我们将使用AWS。</a></p><p id="d0f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Upstash 是一个按需付费的解决方案，无需摆弄硬件、虚拟机或docker容器等东西。不用的时候不花什么钱。它实际上缩小到0，而0意味着没有任何成本。</p><p id="730b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们将消息从本地机器发送到<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank"> Upstash </a>上的Kafka之前，需要完成几个步骤，然后消息将被AWS接收并触发我们的Lambda函数。</p><p id="fc6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你更喜欢使用你自己的或任何其他的Kafka实例，你只需要相应地修改本教程的不同步骤。</p><p id="bfe4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">具体来说，这些步骤是:</p><ul class=""><li id="30e3" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">在<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank">上方</a>创建一个Kafka集群和主题</li><li id="b989" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">启动生产者和消费者来测试集群</li><li id="5002" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">创建秘密</li><li id="8749" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">创建Lambda函数</li><li id="ea73" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">创建Lambda角色</li><li id="f26e" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">创建触发器</li><li id="c869" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">测试设置</li></ul><p id="c4ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有许多事情要做，让我们不要浪费时间，马上开始工作吧。</p><h2 id="1ba3" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">在Upstash上创建一个Kafka集群和主题</h2><p id="560c" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">如果还没有这样做，请前往<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank">后台</a>创建一个帐户。完成后，转到<a class="ae kf" href="https://console.upstash.com" rel="noopener ugc nofollow" target="_blank">控制台</a>并创建一个新的集群。</p><p id="0fe0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们提供集群及其区域的名称。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/2f94a33895de493ed0f19fd360718da8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HX7jJs7GxQozkYIAm_aS3Q.png"/></div></figure><p id="b217" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步，我们将创建接收消息的主题。基本上，我只是提供了名称，一切都保持默认。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/1e0bc858f2d06ee95676138c5d3302bf.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Vn3U44gmwfNAJW65WMM-Ww.png"/></div></figure><p id="7155" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成后，将显示集群的概览页面。此页面提供了连接到集群所需的所有必要信息。我们将在下一节中用到它。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/5e090eea4a6aa2d296ecab82da2b4079.png" data-original-src="https://miro.medium.com/v2/format:webp/1*FUK2bemetdzlmGq03xRhpg.png"/></div></figure><p id="c72a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们的Kafka集群已经就位，我们将对其进行测试。</p><h2 id="a573" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">启动生产者和消费者来测试集群</h2><p id="df1e" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">Kafka自带命令行工具，对于查询和测试Kafka集群非常有用。这些既可以直接安装在本地机器上，也可以通过官方的Kafka Docker镜像使用。</p><p id="f529" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">特别是，我们将使用命令<code class="fe mv mw mx my b">kafka-console-producer</code>和<code class="fe mv mw mx my b">kafka-console-consumer</code>。为了简单起见，我使用这些命令，就好像它们在我的本地机器上一样。</p><p id="0456" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有一个例子来说明不同之处。如果用户已经直接安装在您的计算机上，启动用户的基本方法是:</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="ef97" class="ls lt it my b gy nd ne l nf ng">kafka-console-consumer --topic planes --from-beginning --bootstrap-server kafka:9092</span></pre><p id="1a42" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">做着同样的事情，但这一次借助了官方的卡夫卡码头工人形象，看起来是这样的:</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="1749" class="ls lt it my b gy nd ne l nf ng">docker-compose exec kafka bash -c 'kafka-console-consumer.sh --topic planes --from-beginning --bootstrap-server kafka:9092'</span></pre><p id="3a8b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于Upstash，我们需要添加一些配置，因为我们需要进行身份验证。不应该让每个人都连接到您的集群，对吗？</p><p id="11ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本地机器的工作目录下创建一个名为<code class="fe mv mw mx my b">upstash.config</code>的文件，并将<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank">控制台上的</a>属性放入其中。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/ab8c0a3ef50759c7611f8fbbc0581e31.png" data-original-src="https://miro.medium.com/v2/format:webp/1*d-oVgKjOFK0RnE_E_5_-PA.png"/></div></figure><p id="63f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不需要属性<code class="fe mv mw mx my b">bootstrap.servers</code>。这是它应该看起来，除了凭据不同于我的。</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="1ea4" class="ls lt it my b gy nd ne l nf ng">sasl.mechanism=SCRAM-SHA-256<br/>security.protocol=SASL_SSL<br/>sasl.jaas.config=org.apache.kafka.common.security.scram.ScramLoginModule required username=\"YXBwYXJlbnQtYXNwLTExNjU2JMPd9pk9KbaNkvMiqW7h0l3FOHgPks2Ia3lgup4\" password=\"WcsQuBndTvo1zRYIHffSj5ZwN5A8G6sryjeG2k_1JyThzOzMDTURls2Fo-pboUX4hoza9g==\";"</span></pre><p id="6433" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后启动制作人。</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="ce2e" class="ls lt it my b gy nd ne l nf ng">kafka-console-producer --bootstrap-server apparent-asp-11656-eu1-kafka.upstash.io:9092 --producer.config upstash.config --topic tutorial-topic</span></pre><p id="0d85" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在另一个控制台中，启动消费者。</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="b375" class="ls lt it my b gy nd ne l nf ng">kafka-console-consumer --bootstrap-server apparent-asp-11656-eu1-kafka.upstash.io:9092 --consumer.config upstash.config --from-beginning --topic tutorial-topic</span></pre><p id="a17b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们可以从生产者那里发送一些消息，并在消费者那里接收它们。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/c18248e70aee76feb378aaf449be26d2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JRqm6rNnlpVkbpgmPFGBmw.png"/></div></figure><p id="9ec3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，是时候去Amazon AWS创建和设置不同的部分了，我们需要用Kafka消息触发我们的Lambda函数。</p><h2 id="c899" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">创建AWS机密</h2><p id="8e17" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">转到AWS秘密管理器，点击“存储新的秘密”。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/548a2f1f6d9576db71d350861cb82e00.png" data-original-src="https://miro.medium.com/v2/format:webp/1*e--mIawVtWliWq_1AzFW9w.png"/></div></figure><p id="2f96" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">选择“其他类型的秘密”并为您的<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank"> Upstash </a>用户名和密码添加以下密钥/值对。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/ca1108da1ed78d9c0676ff1e1567740f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*bkQAikb0i3yCDYheiGt8ZQ.png"/></div></figure><p id="d3c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">单击“下一步”,并提供密码的名称。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/9f17e81aa4adf528640a09d4a89b7ef1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*E-0R23ESoBPhiTNfsiDb5A.png"/></div></figure><p id="ca5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后点击“下一步”，然后在“存储新的秘密”-页面也点击“下一步”，然后“存储”，不做任何更改。</p><p id="8125" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成后，让我们继续下一部分，创建Lamdba函数。</p><h2 id="82ae" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">创建Lambda函数</h2><p id="2f15" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">在AWS Lambda中，单击“创建函数”。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/0bc406e0a9f2bc374e4af3dda29e8f64.png" data-original-src="https://miro.medium.com/v2/format:webp/1*tJXc63jP6mfT2T5qh7HA0Q.png"/></div></figure><p id="d646" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在那里，我们将创建一个名为“kafka-consumer”的Node.js函数。完成后，再次单击“创建函数”。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/a0c9a99b9ca95dca7b8cdd2c4e740809.png" data-original-src="https://miro.medium.com/v2/format:webp/1*neYHr95nsHyPOH130RyEoQ.png"/></div></figure><p id="bf39" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将<code class="fe mv mw mx my b">index.js</code>的内容替换为</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="714b" class="ls lt it my b gy nd ne l nf ng">exports.handler = async (event) =&gt; {<br/>    for (let key in event.records) {<br/>      console.log('Key: ', key)<br/>      event.records[key].map((record) =&gt; {<br/>        console.log('Record: ', record)<br/>        const msg = Buffer.from(record.value, 'base64').toString()<br/>        console.log('Message:', msg)<br/>      }) <br/>    }<br/>}</span></pre><p id="2b25" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个函数基本上只打印触发它的Kafka事件的内容。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/14430a1e371f320c9fec586f2fdabbcb.png" data-original-src="https://miro.medium.com/v2/format:webp/1*eWDtGTdlxNZ9XUlCFzNCGw.png"/></div></figure><p id="b5aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后单击“部署”。</p><h2 id="6e84" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">创建Lambda角色</h2><p id="5454" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">点击“配置”，然后点击“权限”，选择角色名称，这里是“Kafka-consumer-role-eov2 kfe”。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/99081a67d29d2f5d3716bfc7fa08b105.png" data-original-src="https://miro.medium.com/v2/format:webp/1*VB12X1gy8AcBOc9s4UPS8g.png"/></div></figure><p id="e061" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，“身份和访问管理(IAM)”控制台已经打开。</p><p id="0a89" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在“添加权限”下，选择“创建内嵌策略”</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/bd9fe5685be67886ad4223bb3a0e4a1d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*agKdUta0tIRfwSKRa9JLtg.png"/></div></figure><p id="6a21" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在“JSON”选项卡中添加以下内容。</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="1daf" class="ls lt it my b gy nd ne l nf ng">{<br/>    "Version": "2012-10-17",<br/>    "Statement": [<br/>        {<br/>            "Effect": "Allow",<br/>            "Action": [<br/>                "secretsmanager:GetSecretValue"<br/>            ],<br/>            "Resource": "arn:aws:secretsmanager:eu-west-1:450055871228:secret:upstash-xcYDmy"<br/>        }<br/>    ]<br/>}</span></pre><p id="fe0c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请确保替换您可以在lambda函数的概述页面上找到的函数ARN。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/ce5fb13c79cae0728f9eb21413669997.png" data-original-src="https://miro.medium.com/v2/format:webp/1*j32XtNQG4zTEBUkr1Qqi_g.png"/></div></figure><p id="3f3c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成后，策略应该是这样的。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/f7cc6a2350384f0158f0229750ebb6c9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*AWAtD3GH2dZQG4dzf_rAqQ.png"/></div></figure><p id="d3d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">点击“审查政策”。</p><p id="6f95" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在“审查策略”下添加名称，例如“SelfHostedKafkaPolicy”，然后单击“创建策略”。</p><p id="1d15" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一切正常，该策略现在会列在IAM角色页面下</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/bff97ba51c42c47faa7275c9e40c28d0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*x0_BZhDoELzJMmKBfZPoww.png"/></div></figure><p id="1efd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是教程中最棘手的部分。如果你能走到这一步，那就太好了。在我们测试所有东西之前，只剩下一小步了。</p><h2 id="f0ba" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">创建触发器</h2><p id="94eb" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">点击“添加触发器”并选择“阿帕奇卡夫卡”-触发器。</p><p id="1f5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在“Bootstrap servers”下添加Kafka集群的端点名称和主题名称。</p><p id="5283" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在“身份验证”下，单击“添加”并提供上面的密码。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/291e94550a0ffa4f3404a015abc0bc0d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-A3PtG59QfpkNkkC9J_bAQ.png"/></div></figure><p id="0161" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后点击“添加”。如果一切顺利，我们将返回到函数页面。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/fdd56bbe5d4457643db33e22dfd910e7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*McxeXxOigLkoOM9kTOr7WQ.png"/></div></figure><p id="943e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在完成了所有的设置工作。我希望这对你有用。</p><p id="b1e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是检验一切的时候了。</p><h2 id="89fc" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">测试设置</h2><p id="8257" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">在AWS中，点击“监控”</p><p id="3c8f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果不再运行，在本地机器上再次启动<code class="fe mv mw mx my b">kafka-console-producer</code>。</p><pre class="mq mr ms mt gt mz my na nb aw nc bi"><span id="eed7" class="ls lt it my b gy nd ne l nf ng">kafka-console-producer --bootstrap-server apparent-asp-11656-eu1-kafka.upstash.io:9092 --producer.config upstash.config --topic tutorial-topic</span></pre><p id="fb62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后发送一条或多条消息。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/10361647c8f5921a99cc44b137e8e3a0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Qs_2Xa26cldMr1gM9KqGqQ.png"/></div></figure><p id="0117" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在您的AWS CloudWatch指标下，您应该看到Lambda函数的调用。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/a5e0655e032eb21b739610f2400d99c4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*rNt5XqKkMcHt2iWP7oAYbQ.png"/></div></figure><p id="5c2b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">点击“查看CloudWatch中的日志”,进入此页面。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/9179c70b75a9c03bb7c1d74bbd2c5f6b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*NWSyYmXHJAJoccfwjIwvBw.png"/></div></figure><p id="ce4d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，选择日志流，这将打开一个显示日志流内容的页面。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="ab gu cl mu"><img src="../Images/6a4f6aaa3c963eae0c72e6963e9c93b0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*66ysCflbIB2xLZiWRyFr6Q.png"/></div></figure><p id="2253" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在那里！倒数第三行是我发送的消息“你好”。根据您发送的内容，您也可以在这里找到您的消息。</p><h2 id="ed6d" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">结论</h2><p id="af84" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">多棒的旅行啊！我们从在本地机器上生成Kafka消息开始，然后这些消息被发送到位于<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank">upshort</a>上的Kafka实例，最后由Amazon AWS上的Lambda函数接收以执行操作。</p><p id="2e8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你喜欢这个教程，它会对你有用。如果你有任何问题，关于如何改进本教程的建议，或者如果你有一个想在我的博客上看到的新主题或教程的想法，请随时在评论区给我打电话。</p><p id="e821" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读！</p><ul class=""><li id="40ff" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">如果你喜欢这个，请<a class="ae kf" href="https://twissmueller.medium.com/" rel="noopener">跟随我在媒体</a></li><li id="de3e" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">给我买杯咖啡让我继续前进</li><li id="162c" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">在这里注册<a class="ae kf" href="https://twissmueller.medium.com/membership" rel="noopener">支持我和其他媒体作者</a></li></ul><div class="nh ni gp gr nj nk"><a href="https://twissmueller.medium.com/membership" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">通过我的推荐链接加入媒体</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">twissmueller.medium.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny jz nk"/></div></div></a></div><p id="cb5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章包含附属链接，由<a class="ae kf" href="http://upstash.com/?utm_source=tobias_tobias4" rel="noopener ugc nofollow" target="_blank"> Upstash </a>赞助。</p><h2 id="b861" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">资源</h2><ul class=""><li id="ea43" class="le lf it ki b kj ml kn mm kr nz kv oa kz ob ld lj lk ll lm bi translated"><a class="ae kf" href="https://docs.upstash.com/kafka/howto/kafka-with-lambda?utm_source=tobias4" rel="noopener ugc nofollow" target="_blank">使用无服务器Kafka作为AWS Lambda的事件源</a></li><li id="b62d" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae kf" href="https://docs.aws.amazon.com/lambda/latest/dg/with-kafka.html" rel="noopener ugc nofollow" target="_blank">使用Lambda和自我管理的Apache Kafka </a></li><li id="222c" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae kf" href="https://aws.amazon.com/blogs/compute/using-self-hosted-apache-kafka-as-an-event-source-for-aws-lambda/" rel="noopener ugc nofollow" target="_blank">使用自托管的Apache Kafka作为AWS Lambda的事件源</a></li></ul></div></div>    
</body>
</html>
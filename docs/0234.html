<html>
<head>
<title>Angular4 + Apollo + GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular4 + Apollo + GraphQL</h1>
<blockquote>原文：<a href="https://itnext.io/angular4-apollo-graphql-49994a2e943c?source=collection_archive---------0-----------------------#2018-01-20">https://itnext.io/angular4-apollo-graphql-49994a2e943c?source=collection_archive---------0-----------------------#2018-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/58fde9aee813ac4849befa919f3ec195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VYsRfL-hlyV0LK9W.png"/></div></div></figure><h1 id="8a60" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">阿波罗客户端是什么？</h1><p id="c52f" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">Apollo是一个GraphQL客户端，它使得用React和Angular开发GraphQL应用程序变得非常容易。它将帮助您获取数据，并保持您的客户端状态与服务器同步。</p><h1 id="0fef" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">为什么我们应该使用阿波罗客户端？</h1><p id="d3b2" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">Apollo坚持在我们的应用程序中使用以下几点。</p><ol class=""><li id="13e4" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">较少的网络请求</li><li id="314d" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">请求中的数据较少</li><li id="3436" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">基于组件的API</li><li id="d4ee" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">实时通信</li><li id="766d" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">乐观UI</li><li id="ee47" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">贮藏</li><li id="8985" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">预取</li></ol><p id="6ece" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">现在让我们来深潜…要开始使用阿波罗和Angular，让我们从安装开始:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/90f7af510a961c508cfe4b8913a01b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/0*fKhnfc14nmP1Tfsb.png"/></div></figure><h1 id="26c3" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">装置</h1><p id="1e9d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">让我们从安装NPM所需的包(apollo-client、apollo-angular和graphql-tag以及许多其他包)开始:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="042e" class="mx jz iq mt b gy my mz l na nb">npm install apollo-angular apollo-angular-link-http apollo-client apollo-cache-inmemory graphql-tag graphql --save</span></pre><ul class=""><li id="d528" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt nc mc md me bi translated">apollo-client是适用于任何平台的客户端库。</li><li id="697c" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt nc mc md me bi translated">阿波罗角度是阿波罗客户端的角度集成。</li><li id="dfd5" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt nc mc md me bi translated">graphql-tag是解析graphql查询/变异的标签。</li></ul><p id="c37b" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">现在，您可以在应用程序中使用Apollo了。要开始使用Apollo和Angular，我们需要导入两个NgModules，ApolloModule和HttpLinkModule。* ApolloModule是在你的app中使用GraphQL的中心！它包括允许使用ApolloClient功能的所有需要的服务。</p><p id="373d" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">* HttpLinkModule使得以Angular方式获取数据变得很容易。</p><h1 id="c6be" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">创建客户端</h1><p id="0633" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">首先，注入Apollo和HttpLink服务(如果您决定使用它),然后创建一个客户机:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="a1c2" class="mx jz iq mt b gy my mz l na nb">constructor(apollo: Apollo, httpLink: HttpLink) {<br/>    //localhost<br/>    const uri = 'http://localhost:3000/graphiql';<br/>    const http = httpLink.create({ uri });<br/><br/>    apollo.create({<br/>      link: http,<br/>      cache: new InMemoryCache()<br/>    });<br/>}</span></pre><p id="5a60" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">(注意:你可以在下面找到完整的代码。)</p><p id="c7a8" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">使用graphql-tag <br/>创建操作<code class="fe nd ne nf mt b">import gql from 'graphql-tag';</code></p><p id="da4a" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">gql模板标记是用来在Apollo应用程序中定义GraphQL查询的。它将GraphQL查询解析成GraphQL.js AST格式，然后由Apollo方法使用。</p><p id="4f72" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated"><strong class="ky ir">查询:</strong>您可以学习如何使用Apollo将GraphQL查询结果附加到</p><p id="0be3" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">你棱角分明的UI。</p><p id="dae7" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">首先创建一个<strong class="ky ir"> apollo.config.ts </strong>文件。<br/>/app/阿波罗. config.ts</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="354e" class="mx jz iq mt b gy my mz l na nb">import {NgModule} from '@angular/core';<br/>import {HttpClientModule} from '@angular/common/http';<br/>import {Apollo, ApolloModule} from 'apollo-angular';<br/>import {HttpLink, HttpLinkModule} from 'apollo-angular-link-http';<br/>import {InMemoryCache} from 'apollo-cache-inmemory';<br/><br/>@NgModule({<br/>  exports: [<br/>    HttpClientModule,<br/>    ApolloModule,<br/>    HttpLinkModule<br/>  ]<br/>})<br/>export class GraphQLModule {<br/>  constructor(apollo: Apollo, httpLink: HttpLink) {<br/>    //localhost<br/>    const uri = 'http://localhost:3000/graphiql';<br/>    const http = httpLink.create({ uri });<br/><br/>    apollo.create({<br/>      link: http,<br/>      cache: new InMemoryCache()<br/>    });<br/>}<br/>}</span></pre><p id="ab66" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">现在转到<strong class="ky ir"> app.module.ts </strong>文件，添加下面的代码。</p><p id="fc24" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated"><code class="fe nd ne nf mt b">import {GraphQLModule} from './apollo.config';</code></p><p id="5011" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">在<strong class="ky ir">进口</strong>部分，</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="8841" class="mx jz iq mt b gy my mz l na nb">imports: [<br/>    BrowserModule,<br/>    HttpModule,<br/>    GraphQLModule<br/>  ],</span></pre><p id="dfb1" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">现在让我们创建一个新组件，<br/>，即:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="e5de" class="mx jz iq mt b gy my mz l na nb">ng g c apollo-test</span></pre><p id="694c" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">您可以在app/apollo-test文件夹中找到以下文件。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="2947" class="mx jz iq mt b gy my mz l na nb"># apollo-test.component.css<br/>&lt;&gt; apollo-test.component.html<br/>TS apollo-test.component.spec.ts<br/>TS apollo-test.component.ts</span></pre><p id="b914" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">打开<strong class="ky ir">Apollo-test . component . ts</strong>并在文件中添加以下代码。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="48b5" class="mx jz iq mt b gy my mz l na nb">import { Component, OnInit } from '@angular/core';<br/>import { Apollo } from 'apollo-angular';<br/>import gql from 'graphql-tag';<br/>import { ApolloQueryResult } from 'apollo-client';<br/>import { InMemoryCache } from 'apollo-cache-inmemory';<br/>import { Observable } from 'rxjs/Observable';<br/><br/>const PostsGetQuery = gql`<br/>  query PostsGetQuery{<br/>    posts_list {<br/>        id<br/>        title<br/>        body<br/>        user {<br/>          id<br/>          firstName<br/>          lastName<br/>          bio<br/>        }<br/>      }<br/>  }<br/>`;<br/><br/><br/>@Component({<br/>  selector: 'app-apollo-test’,<br/>  templateUrl: './apollo-test.component.html',<br/>  styleUrls: ['./apollo-test.component.css']<br/>})<br/>export class ApolloTestComponent implements OnInit {<br/>  data: Observable&lt;any&gt;;<br/><br/>  constructor(private apollo: Apollo ) { }<br/><br/>  ngOnInit() {<br/>    this.apollo.watchQuery&lt;any&gt;({<br/>      query: PostsGetQuery<br/>    })<br/>      .valueChanges<br/>      .subscribe(({data}) =&gt; {<br/>        this.data = data.posts_list;<br/>      });<br/>  }<br/>}</span></pre><p id="f884" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">现在，您的数据对象中有了一个帖子列表。让我们在表单中显示数据。</p><p id="5d90" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">转到你的<strong class="ky ir">apollo-test.component.html</strong>文件，</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="df6d" class="mx jz iq mt b gy my mz l na nb">&lt;p&gt;<br/>  apollo-test works! DONE<br/>&lt;/p&gt;<br/>&lt;h1&gt;Posts&lt;/h1&gt;<br/>&lt;div *ngFor="let post of data"&gt;<br/>  &lt;table&gt;<br/>    &lt;tr&gt;<br/>        &lt;td&gt;<br/>          User Name: {{post.user.firstName}}<br/>        &lt;/td&gt;<br/>      &lt;td&gt;<br/>          Post ID: {{post.id}}<br/>      &lt;/td&gt;<br/>      &lt;td&gt;<br/>          Title: {{post.title}}<br/>      &lt;/td&gt;<br/>    &lt;/tr&gt;<br/>  &lt;/table&gt;<br/>&lt;/div&gt;</span></pre><p id="1509" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">就是这样。现在，您可以享受应用程序的快速响应，而不会有任何问题。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/2562645383e8a3502d7eded98e8088c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T7GJlQ1-zN0GUo7j.png"/></div></div></figure><p id="5e79" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">详情请点击下面的链接。<br/><a class="ae nh" href="https://www.apollographql.com/docs/angular/" rel="noopener ugc nofollow" target="_blank">https://www.apollographql.com/docs/angular/</a></p><p id="11b5" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">下面是设置指南:<br/><a class="ae nh" href="https://www.apollographql.com/docs/angular/basics/setup.html" rel="noopener ugc nofollow" target="_blank">https://www . apollographql . com/docs/angular/basics/setup . html</a></p><p id="bac4" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">感谢您的阅读。我希望这篇文章能对你有所帮助。</p><p id="b37f" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">享受编码。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/4da75672267e54f09f7c1b97e52d7ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*49q2Ap2GwPmh7FXx.png"/></div></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5d8d818113fbdf0d2bac1728b05c84b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*nt5o66Esy7e4BNY0.png"/></div></figure><p id="3c4b" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated"><strong class="ky ir">感谢&amp;问候，<br/>阿洛拉瓦特</strong></p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><p id="7b8f" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated"><em class="nq">原载于</em><a class="ae nh" href="https://qiita.com/alokrawat050/items/7fc8a240e047ea6c2e06" rel="noopener ugc nofollow" target="_blank"><em class="nq">qiita.com</em></a><em class="nq">。</em></p></div></div>    
</body>
</html>
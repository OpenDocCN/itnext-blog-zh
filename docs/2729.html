<html>
<head>
<title>Create an Azure Function App from Visual Studio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Visual Studio创建Azure函数应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/create-an-azure-function-app-from-visual-studio-477c16a184d9?source=collection_archive---------5-----------------------#2019-07-22">https://itnext.io/create-an-azure-function-app-from-visual-studio-477c16a184d9?source=collection_archive---------5-----------------------#2019-07-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="23f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我开始在帖子中查看Azure功能应用时，<a class="ae kl" href="https://elanderson.net/2019/06/azure-functions-introduction/" rel="noopener ugc nofollow" target="_blank"> Azure功能介绍</a>，我使用Azure门户创建了帖子中使用的示例功能应用。在后续的文章中，<a class="ae kl" href="https://elanderson.net/2019/07/open-an-azure-portal-created-function-in-visual-studio/" rel="noopener ugc nofollow" target="_blank">在Visual Studio中打开Azure门户创建的函数</a>，我展示了如何在Visual Studio中打开门户创建的函数。从Azure门户网站下载的代码是csx格式，而不是Visual Studio通常处理的cs格式，所以很多Visual Studio都无法工作。</p><p id="34df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章将介绍如何在Visual Studio中创建一个新的Azure函数应用。我希望从Visual Studio开始会产生对Visual Studio更友好的代码。本帖将使用Visual Studio 2019。</p><h2 id="d893" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">应用程序创建</h2><p id="50c8" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">打开Visual Studio，在开始对话框中点击<strong class="jp ir">创建新项目</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/fe73c9b78c5a94a87485f6db94ef997f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8fge1dlRpEFqCS9v.png"/></div></div></figure><p id="48c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一个屏幕上搜索来自<strong class="jp ir"> Azure Functions </strong>。点击<strong class="jp ir"> Azure Functions </strong>项，点击<strong class="jp ir">下一步</strong>按钮。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/4b42bf8d73b5b5d1133eaf988ee0e574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TxB6Sxwggx4fvm3z.png"/></div></div></figure><p id="eda2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入一个<strong class="jp ir">项目名称</strong>，并根据需要更改任何其他设置，然后点击<strong class="jp ir">创建</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/ab74698a7cfbe9915bddfe1e86167774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BnHISxFAgdQZEV_G.png"/></div></div></figure><p id="fdad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个对话框将询问要使用的触发器类型。为了匹配我们几周前在Azure门户上创建的功能，我们将使用一个<strong class="jp ir"> Http触发器</strong>并点击<strong class="jp ir"> Create </strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/a709000ff47a78c53078d032906fff2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pGammzm1ASCSDdDg.png"/></div></div></figure><p id="2850" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击最后一个创建按钮将启动项目创建过程。完成后，你将有一个项目，其中有一个函数与文件<strong class="jp ir"> Function1.cs </strong>中的以下内容相匹配。</p><pre class="ll lm ln lo gt lw lx ly lz aw ma bi"><span id="a2ad" class="km kn iq lx b gy mb mc l md me">public static class Function1<br/>{<br/>    [FunctionName("Function1")]<br/>    public static async Task&lt;IActionResult&gt; Run(<br/>        [HttpTrigger(AuthorizationLevel.Function, "get", "post", Route = null)] HttpRequest req,<br/>        ILogger log)<br/>    {<br/>        log.LogInformation("C# HTTP trigger function processed a request.");<br/><br/>        string name = req.Query["name"];<br/><br/>        string requestBody = await new StreamReader(req.Body).ReadToEndAsync();<br/>        dynamic data = JsonConvert.DeserializeObject(requestBody);<br/>        name = name ?? data?.name;<br/><br/>        return name != null<br/>            ? (ActionResult)new OkObjectResult($"Hello, {name}")<br/>            : new BadRequestObjectResult("Please pass a name on the query string or in the request body");<br/>    }<br/>}</span></pre><p id="1999" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是几周前门户网站创建的功能。</p><pre class="ll lm ln lo gt lw lx ly lz aw ma bi"><span id="0081" class="km kn iq lx b gy mb mc l md me">public static async Task&lt;IActionResult&gt; Run(HttpRequest req, ILogger log)<br/>{<br/>    log.LogInformation("C# HTTP trigger function processed a request.");<br/><br/>    string name = req.Query["name"];<br/><br/>    string requestBody = await new StreamReader(req.Body).ReadToEndAsync();<br/>    dynamic data = JsonConvert.DeserializeObject(requestBody);<br/>    name = name ?? data?.name;<br/><br/>    return name != null<br/>        ? (ActionResult)new OkObjectResult($"Hello, {name}")<br/>        : new BadRequestObjectResult("Please pass a name on the query string or in the request body");<br/>}</span></pre><p id="8f55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你会注意到两者的身体是一样的。Visual Studio版本使用属性来让Azure知道名称、触发器类型以及一旦函数发布到Azure将需要的其他信息。</p><h2 id="ae38" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">本地测试</h2><p id="be9b" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">使用Visual Studio进行函数开发的一个非常好的地方是，您可以在本地调试它们。如果您点击播放按钮(或F5 ), Visual Studio将在本地启动您的功能。您将看到如下所示的内容。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mf"><img src="../Images/d05da2c91eced5da1ba877691c9c8a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hdEIMQ5RSjV6fngQ.png"/></div></div></figure><p id="fe1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">突出显示的部分列出了应用程序中的所有Http函数以及可用于测试它们的URL。对于这个例子，下面的URL可以用来获得响应“Hello，Eric”。</p><pre class="ll lm ln lo gt lw lx ly lz aw ma bi"><span id="8b40" class="km kn iq lx b gy mb mc l md me"><a class="ae kl" href="http://localhost:7071/api/Function1?name=Eric" rel="noopener ugc nofollow" target="_blank">http://localhost:7071/api/Function1?name=Eric</a></span></pre><p id="ac26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">据我所知，到目前为止，Visual Studio的所有正常调试功能在本地运行函数时似乎都工作正常。</p><h2 id="168a" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">应用程序发布</h2><p id="9dbe" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">现在，我们已经在本地创建并测试了我们的函数应用程序，是时候将它发布到Azure了。在解决方案资源管理器中右键单击项目文件，然后单击<strong class="jp ir"> Publish </strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/d7ae67e67392a1eee1448ff62adcf243.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/0*7mLNXxPdR3wDniwW.png"/></div></figure><p id="68fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在发布对话框中，我们将从程序包文件中<strong class="jp ir">创建新的</strong>和<strong class="jp ir">运行，因为建议这样做(参见<a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/run-functions-from-deployment-package" rel="noopener ugc nofollow" target="_blank">文档</a>了解为什么建议这样做)。最后，点击<strong class="jp ir">发布</strong>按钮。</strong></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mh"><img src="../Images/5df2bbd901cc49bc508ae61a95b6b058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G47dq9bgN6rmowE-.png"/></div></div></figure><p id="17bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个对话框是将在Azure中创建的应用服务的配置。您可以使用默认设置并点击<strong class="jp ir"> Create </strong>，但是我总是花费额外的时间来创建一个新的资源组，这样当我使用完我的示例时，就可以很容易地删除它们。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mh"><img src="../Images/61e2a14c5e24c5bbc350ce65176defc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f8w-1M7o8f9p8UQx.png"/></div></div></figure><p id="a5a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击“创建”按钮将开始部署到Azure，这将需要几分钟时间。部署完成后，您可以使用Azure门户来测试您的功能App。关于从Azure门户运行一个函数的更多信息可以在<a class="ae kl" href="https://elanderson.net/2019/06/azure-functions-introduction/" rel="noopener ugc nofollow" target="_blank"> Azure函数介绍</a>帖子中找到。</p><h2 id="0893" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">包扎</h2><p id="46d9" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">虽然通过Azure门户创建功能是最快的入门方式，但我建议您从本地开始。稍微长一点的入门时间对于它提供的更好的工具和灵活性来说是值得的。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="7cf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mp">最初发表于</em> <a class="ae kl" href="https://elanderson.net/2019/07/create-an-azure-function-app-from-visual-studio/" rel="noopener ugc nofollow" target="_blank"> <em class="mp">埃里克·安德森</em> </a> <em class="mp">。</em></p></div></div>    
</body>
</html>
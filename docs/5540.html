<html>
<head>
<title>Why and How to Run Your Development Database With Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么以及如何使用Docker运行您的开发数据库</h1>
<blockquote>原文：<a href="https://itnext.io/why-and-how-to-run-your-development-database-with-docker-2e0eab13b733?source=collection_archive---------4-----------------------#2021-03-27">https://itnext.io/why-and-how-to-run-your-development-database-with-docker-2e0eab13b733?source=collection_archive---------4-----------------------#2021-03-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/804967fcc41d241d166e246515b10151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hcKZe4hkZyfRbDcQlEgogw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">扬·安东宁·科拉尔在<a class="ae kf" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="83be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为开发人员，我们通常同时工作和管理多个应用程序，即使这些应用程序可能有相同的技术堆栈，它们也可能使用不同版本的技术。</p><p id="f0e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，能够快速调整您的本地开发环境以适应您想要关注的应用程序变得至关重要。</p><p id="a924" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从一个版本的编程语言或框架切换到另一个版本可能相对简单，但是对数据库做同样的事情就变得困难了。</p><p id="c6e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，使用Docker在容器中运行数据库服务器，而不是将其直接安装在本地计算机上，可以轻松解决这个问题。</p><p id="97a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一般来说，docker不是为有状态服务设计的，所以不建议在生产环境中运行Docker容器中的数据库。但是，我们将它用于本地开发，因此所有可能出现的关于数据完整性和持久性的问题都已消失，因为我们用于开发的数据是不相关的，对应用程序没有影响。</p><p id="def6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是在Docker容器中使用数据库的步骤。</p><h1 id="0b0f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">带Docker的MongoDB</strong></h1><h2 id="fbdd" class="mc lf it bd lg md me dn lk mf mg dp lo kr mh mi ls kv mj mk lw kz ml mm ma mn bi translated">步骤1 —创建卷</h2><p id="a1ac" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">Docker容器是短暂的，这意味着每次我们启动容器时，它都会重新开始，而在容器运行时创建的数据将会丢失。</p><p id="a8ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决这个问题并在运行之间持久化数据，我们需要为我们的容器创建一个卷。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="160e" class="mc lf it my b gy nc nd l ne nf">docker volume create --name=mongodata</span></pre><blockquote class="ng nh ni"><p id="3009" class="kg kh nj ki b kj kk kl km kn ko kp kq nk ks kt ku nl kw kx ky nm la lb lc ld im bi translated"><strong class="ki iu">边注:</strong>运行<code class="fe nn no np my b">docker volume ls</code>列出所有卷。</p></blockquote></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="066f" class="mc lf it bd lg md me dn lk mf mg dp lo kr mh mi ls kv mj mk lw kz ml mm ma mn bi translated">步骤2 —下载MongoDB的Docker映像</h2><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="432e" class="mc lf it my b gy nc nd l ne nf">docker pull mongo</span></pre><p id="ce15" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该命令将下载最新版本。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d0c0663eca42e211303fd552f353ac26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*3jxcnuOjjiak931wVpWr_g.png"/></div></figure><p id="ea84" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要下载特定版本的MongoDB，可以使用附加了version标记的相同命令。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="e2c9" class="mc lf it my b gy nc nd l ne nf">docker pull mongo:X.Y.Z</span></pre><p id="3797" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<code class="fe nn no np my b">X.Y.Z</code>代表您想要下载的版本。</p><blockquote class="ng nh ni"><p id="a2eb" class="kg kh nj ki b kj kk kl km kn ko kp kq nk ks kt ku nl kw kx ky nm la lb lc ld im bi translated"><strong class="ki iu">边注:</strong>运行<code class="fe nn no np my b"><em class="it">docker image ls</em></code>列出所有下载的docker图片。</p></blockquote></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="c781" class="mc lf it bd lg md me dn lk mf mg dp lo kr mh mi ls kv mj mk lw kz ml mm ma mn bi translated">步骤3 —创建并运行容器</h2><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="fc0a" class="mc lf it my b gy nc nd l ne nf">docker run --name mongodb -v mongodata:/data/db -d -p 27017:27017 mongo</span></pre><p id="3093" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np my b">--name</code>代表容器的名称；</p><p id="9636" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np my b">-v</code>是我们创建的卷，我们将其用于文件夹<code class="fe nn no np my b">/data/db</code>，这是MongoDB用来存储数据的文件夹；</p><p id="8dde" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np my b">-d</code>以分离模式启动容器，作为后台进程；</p><p id="24a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np my b">-p</code>指定如何映射端口，我们将本地端口<strong class="ki iu"> 27017 </strong>映射到容器的端口<strong class="ki iu"> 27017 </strong>，这是MongoDB将用来启动数据库服务器的端口</p><blockquote class="ng nh ni"><p id="6a24" class="kg kh nj ki b kj kk kl km kn ko kp kq nk ks kt ku nl kw kx ky nm la lb lc ld im bi translated"><strong class="ki iu">边注:</strong>运行<code class="fe nn no np my b"><em class="it">docker contaienr ls</em></code>列出所有运行中的容器，<code class="fe nn no np my b">docker container ls -a</code>列出所有容器(运行或不运行)</p></blockquote></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="8e37" class="mc lf it bd lg md me dn lk mf mg dp lo kr mh mi ls kv mj mk lw kz ml mm ma mn bi translated">步骤4 —连接到容器</h2><p id="5104" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">当容器作为一个分离的进程运行时，我们可以执行下面的命令来连接它并与数据库交互。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="3c35" class="mc lf it my b gy nc nd l ne nf">docker exec -it mongodb bash</span></pre><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/56762c5e5fae16f06c93c4744515c3dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*lsyF1SMbj3UlUiDqkAnQ0A.png"/></div></figure><p id="71be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们可以运行<code class="fe nn no np my b">mongo</code>命令来启动MongoDB shell，或者运行<code class="fe nn no np my b">exit</code>命令来关闭容器的终端。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="beaa" class="mc lf it bd lg md me dn lk mf mg dp lo kr mh mi ls kv mj mk lw kz ml mm ma mn bi translated">步骤5 —停止并重新启动数据库</h2><p id="091b" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">如果我们想停止数据库容器，只需运行以下命令:</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="fb5e" class="mc lf it my b gy nc nd l ne nf">docker stop mongodb</span></pre><p id="cce9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">开始吧:</p><p id="5c73" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np my b">docker start mongodb</code></p><h1 id="5270" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="a992" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">在Docker容器中使用数据库进行开发可以大大提高速度和生产率。</p><p id="1eb9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然本文是以MongoDB为例编写的，但它可以很容易地扩展到任何数据库，因为步骤是相同的。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Express server for an Angular application part 4: redirect http to https requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular应用程序的快速服务器第4部分:将http重定向到https请求</h1>
<blockquote>原文：<a href="https://itnext.io/express-server-for-an-angular-application-part-4-redirect-http-to-https-requests-d4f6e7ed7e93?source=collection_archive---------4-----------------------#2019-05-15">https://itnext.io/express-server-for-an-angular-application-part-4-redirect-http-to-https-requests-d4f6e7ed7e93?source=collection_archive---------4-----------------------#2019-05-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="de64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Express.js是为构建web应用程序而设计的Node.js的web应用程序框架，在这一系列文章中，我将一步一步地解释我是如何实现一个具有一些高级功能的Express服务器的，我将这些功能用于我用Angular 7制作的单页面应用程序。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/11a07bce7a848ddeeb645099ece3969a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91q9yl9utgje8pKNhcS5lA.png"/></div></div></figure><p id="2944" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将讨论我在不同文章中解决的7个主要问题:</p><ol class=""><li id="e1b7" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-1-getting-started-2cd27de691bd?fbclid=IwAR0FqPoqKeBps4QUM3E09aSGKDwjUNKcoZHxPKAB5iBt8dwUbuEol3b7IZ8" rel="noopener">入门</a></li><li id="bf53" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-2-serve-files-from-a-bucket-ae14d23e7cde" rel="noopener">从桶里取文件</a></li><li id="9f67" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-3-redirect-routes-to-an-external-service-d4658ed575cb" rel="noopener">将一些呼叫重定向到外部服务</a></li><li id="7546" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-4-redirect-http-to-https-requests-d4f6e7ed7e93" rel="noopener">将http重定向到https请求</a></li><li id="7343" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-5-redirect-non-www-to-www-requests-b81a7794a4d7" rel="noopener">将非www请求重定向到www请求</a></li><li id="8736" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-5-limit-connections-and-prevent-ddos-e27902cc702b" rel="noopener">限制连接并阻止DDoS </a></li><li id="f65a" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-7-add-cache-f11e8060a2e3" rel="noopener">处理一些缓存</a></li></ol><p id="f8a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第四篇文章中，我将讨论如何将http重定向到https请求。</p><h1 id="ef3b" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">参考知识库</h1><p id="47a9" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">该项目的一个工作示例可从以下网址获得:</p><p id="19a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lg" href="https://github.com/mzuccaroli/express_server_for_angular_example" rel="noopener ugc nofollow" target="_blank">https://github . com/mzuccaroli/express _ server _ for _ angular _ example</a>主分支包含最终的完整项目，但每篇文章都有一个专用分支，对于这一篇文章，引用是:<a class="ae lg" href="https://github.com/mzuccaroli/express_server_for_angular_example/tree/feature/http_to_https_redirects" rel="noopener ugc nofollow" target="_blank">https://github . com/mzuccaroli/express _ server _ for _ angular _ example/tree/feature/http _ to _ https _ redirects</a></p><h1 id="3945" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">关于环境的快速说明</h1><p id="e70b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">处理https请求和重定向http请求是现代应用程序的必备功能<strong class="jp ir">，但是在您的<strong class="jp ir">本地机器</strong>上开发应用程序时，处理https可能会很棘手。我用一些环境变量解决了这个问题:用node你可以很容易地处理<strong class="jp ir">环境变量</strong>并设置一个“_环境”变量，然后你可以取消本地开发的重定向选项。<br/>您可以通过如下方式运行您的应用程序来手动设置环境变量:</strong></p><blockquote class="mp mq mr"><p id="a3f4" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">环境=dev节点server.js</p></blockquote><p id="7c9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后通过添加以下内容在代码中使用该变量:</p><blockquote class="mp mq mr"><p id="71f2" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">const _ environment = process . env . environment；</p></blockquote><p id="b067" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以通过docker处理这些变量或者在你的IDE中设置它们，下图是我的webstorm设置。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mw"><img src="../Images/315622dd39d7eaccc8f686fafc8575db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfkYpyfHQbsuyvQ57fk66A.png"/></div></div></figure><h1 id="1599" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">将http请求重定向到https</h1><p id="d724" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">一旦决定了环境变量，就可以将以下代码添加到服务器中:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="e6f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，您需要在您的应用程序中启用信任代理，然后您将能够<strong class="jp ir">区分https请求和http </strong>。</p><p id="ae2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个简单的改进，您可以将它添加到您的服务器中，不必再担心不安全的请求。</p><p id="2b58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇文章中，我将讨论一个类似的改进，<strong class="jp ir">如何处理www和非www的URL。</strong></p></div></div>    
</body>
</html>
<html>
<head>
<title>Dealing with TypeScript configs for the mono-repo application.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理mono-repo应用程序的类型脚本配置。</h1>
<blockquote>原文：<a href="https://itnext.io/defining-typescript-config-types-for-the-mono-repo-application-a39a5b8c7bc2?source=collection_archive---------3-----------------------#2021-10-20">https://itnext.io/defining-typescript-config-types-for-the-mono-repo-application-a39a5b8c7bc2?source=collection_archive---------3-----------------------#2021-10-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/66fdc967787f25cb074c066ab16819ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CA86jQbKC-TgN_0S"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@corinnekutz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Corinne Kutz </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f8c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设你正在构建一个<strong class="kf ir">单一回购</strong>应用。该结构正在划分一些服务，如<code class="fe lb lc ld le b">fronted</code>、<code class="fe lb lc ld le b">backend</code>和<code class="fe lb lc ld le b">docs</code>。这个应用程序和结构可以由<a class="ae kc" href="https://github.com/lerna/lerna" rel="noopener ugc nofollow" target="_blank"> Lerna </a>来处理——一个管理带有多个包的JavaScript项目的工具。Lerna所做的(作为许多特性的一部分)是能够解析本地和全局<em class="lf"> package.json </em>文件，以使用一个正确的包列表和依赖关系表示。这意味着你可以在你所有的服务中使用全局包，但是如果你在前端程序中使用一些包，你不需要为后端程序安装它。借助Lerna <code class="fe lb lc ld le b">boostrap</code>特性，您可以使用一个命令和流程来安装和管理所有服务的依赖关系。</p><p id="fba3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，看一下回购结构。</p><pre class="lg lh li lj gt lk le ll lm aw ln bi"><span id="77fb" class="lo lp iq le b gy lq lr l ls lt">|root<br/>|--- frontend<br/>|--- backend<br/>|--- docs</span></pre><p id="c92d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们假设您想要设置一些全局TypeScript配置，但是只为一个服务使用它。例如，你正在用TypeScript构建一些前端应用程序，但是后端应用程序是用普通的JavaScript编写的。然而，在将来，你可能也想使用TS作为后端。我们能做什么？</p><p id="059f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将您的TypeScript config(<em class="lf">ts config . JSON</em>)放到根文件夹中。然后定义<code class="fe lb lc ld le b">rootDir</code>并在那里放置前端应用程序的文件夹名，就像这样。</p><pre class="lg lh li lj gt lk le ll lm aw ln bi"><span id="9323" class="lo lp iq le b gy lq lr l ls lt">{<br/>  "compilerOptions": {<br/>    "rootDir": "frontend",<br/>    "types": [<br/>      "@types",<br/>    ]<br/>  },<br/>}</span></pre><p id="598f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在。当然，你需要一些额外的类型定义。通常，您可以通过在<strong class="kf ir"> <em class="lf">类型</em> </strong>对象中添加包名来定义它们。这是你会遇到一些问题的时刻。由于TypeScript配置使用您的前端服务的根目录，因此没有符号表明您的类型是全局安装的，TypeScript正在您的前端服务<em class="lf"> node_modules中查找它们。</em></p><pre class="lg lh li lj gt lk le ll lm aw ln bi"><span id="3e21" class="lo lp iq le b gy lq lr l ls lt">TS2688: Cannot find type definition file for '<a class="ae kc" href="http://twitter.com/nuxt/image" rel="noopener ugc nofollow" target="_blank">@</a>types'. The file is in the program because: Entry point of type library '<a class="ae kc" href="http://twitter.com/nuxt/image" rel="noopener ugc nofollow" target="_blank">@</a>types' specified in compilerOptions.</span></pre><p id="75b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如何处理这个问题？超级简单。只需在您的<em class="lf"> tsconfig.json </em>文件中定义<code class="fe lb lc ld le b">typeRoots</code>属性，并将您的本地<em class="lf"> node_modules </em>路径传递到那里。您也可以为别名设置它。就像那样。</p><pre class="lg lh li lj gt lk le ll lm aw ln bi"><span id="7927" class="lo lp iq le b gy lq lr l ls lt">{<br/>  "compilerOptions": {<br/>    "rootDir": "frontend"<br/>    "paths": {<br/>      "~/*": ["./frontend/*"]<br/>    },<br/>    <strong class="le ir">"typeRoots": ["./frontend/node_modules/"],</strong><br/>    "types": [<br/>      "@types",<br/>    ]<br/>    "exclude": ["./*.config.js"]  },<br/>}</span></pre><p id="94b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">…或者没有<code class="fe lb lc ld le b">types</code>，就这样。</p><pre class="lg lh li lj gt lk le ll lm aw ln bi"><span id="6464" class="lo lp iq le b gy lq lr l ls lt">{<br/>  "compilerOptions": {<br/>    <strong class="le ir">"typeRoots": ["./frontend/node_modules/@types"],<br/>  </strong>}<br/>}</span></pre><p id="0953" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里值得一提的是，TypeScript可能会寻找一些全局定义的配置，如<code class="fe lb lc ld le b">commitlint</code>或<code class="fe lb lc ld le b">stylelint</code>。因为它们在大多数情况下是<code class="fe lb lc ld le b">.js</code>文件，所以你可以在<em class="lf"> tsconfig.json </em>文件中排除它们。</p><p id="b805" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，您需要为您的服务定义一些虚拟的<em class="lf"> tsconfig.json </em>。为此，创建它并添加这个简单的配置—在<code class="fe lb lc ld le b">frontend</code>文件夹/服务中。</p><pre class="lg lh li lj gt lk le ll lm aw ln bi"><span id="6ee2" class="lo lp iq le b gy lq lr l ls lt">{<br/>  "extends": "../tsconfig.json",<br/>  "compilerOptions": {}<br/>}</span></pre><p id="8e64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">您还可以为所有服务创建一个TypeScript配置文件，并在整个mono-repo中使用它。通过这种方式，您可以确信您的整个代码库遵循一个标准。</strong></p><p id="4e5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">仅此而已。简单又很有帮助。享受吧。</p></div></div>    
</body>
</html>
<html>
<head>
<title>External Core Services Pattern Variations in Practice</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">外部核心服务模式在实践中的变化</h1>
<blockquote>原文：<a href="https://itnext.io/external-core-services-pattern-variations-in-practice-bdcb1da07b5b?source=collection_archive---------2-----------------------#2018-10-27">https://itnext.io/external-core-services-pattern-variations-in-practice-bdcb1da07b5b?source=collection_archive---------2-----------------------#2018-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="921f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当在企业架构中安装外部系统时，您面临着如何将企业数据与外部系统应用程序集成的挑战。如OutSystems  在线培训中的<a class="ae kl" href="https://www.outsystems.com/learn/courses/68/architecture-patterns-in-outsystems/" rel="noopener ugc nofollow" target="_blank"> <em class="km">架构模式所述，来自外部系统的实体被称为<strong class="jp ir">外部核心实体</strong>，我们可以使用<strong class="jp ir">外部核心服务模式</strong>来消费该实体。本文通过示例解释了外部核心服务(ECS)的变化。</em></a></p><p id="7570" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">外部实体可能暴露给具有以下模式的外部系统:</p><ul class=""><li id="5fba" class="kn ko iq jp b jq jr ju jv jy kp kc kq kg kr kk ks kt ku kv bi translated"><strong class="jp ir">扩展</strong>模式:使用扩展来包装外部库或包装外部数据库中的实体</li><li id="842c" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><strong class="jp ir">连接器模式:</strong>为消费者创建一个包装器模块和一个扩展来封装外部API。</li><li id="e0c3" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><strong class="jp ir">服务外观</strong>模式:为消费者创建一个包装器模块和一个集成服务模块来消费服务。</li></ul><h2 id="008e" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">示例简介</h2><p id="1402" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">为了说明这些模式，我使用了OSMDb的一个变体，我们都从如何成为一名web开发人员的培训中了解到了这个变体。电影数据现在的来源是ACME的外部系统，该系统通过电影API公开电影记录。我们使用集成服务(AcmeFilmIS)来使用电影API。</p><p id="bac2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在OSMDb中，电影的概念被称为Movie，因此我们引入MovieStruct作为OSMDb <a class="ae kl" href="http://soapatterns.org/design_patterns/canonical_schema" rel="noopener ugc nofollow" target="_blank">规范模式</a> (OSMDbSchema)的一部分。这使得该结构可以在任何(未来)集成中重用。为了启用<a class="ae kl" href="http://serviceorientation.com/serviceorientation/service_loose_coupling" rel="noopener ugc nofollow" target="_blank">服务松耦合</a>，Films API数据结构被映射到MovieStruct。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/6dd35d34b008636c8be155a2a52d0589.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*mT5kuhSMS8AHWzeAtzfu1A.png"/></div></figure><h1 id="4673" class="mh lc iq bd ld mi mj mk lg ml mm mn lj mo mp mq lm mr ms mt lp mu mv mw ls mx bi translated">外部核心服务模式</h1><p id="20b8" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">外部系统提供了一个必须支持所有用例的集成API。例如CRUD服务。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi my"><img src="../Images/da71d19646a817c5e8e01cd5be92718b.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*PIc1iqOyGqgwDOmtE7pD4w.png"/></div></figure><p id="f206" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里使用<a class="ae kl" href="http://soapatterns.org/design_patterns/service_facade" rel="noopener ugc nofollow" target="_blank"> <em class="km">服务外观模式</em> </a>为消费者提供一个包装器模块。Films rest方法映射到MovieStruct服务器操作:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/a9621d545528f14fd693f3d0e235a2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*_g249ozXl_rQ-YhjFssWgQ.png"/></div></figure><p id="9641" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模块MovieCS使用FilmIS中的公共操作，并公开集中创建/更新业务逻辑的服务器操作。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi na"><img src="../Images/dd3c24847509c7eb2f2fbcd9ad4e2f52.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*C5Rxj_5fQXCaAi_dMvEeWg.png"/></div></figure><p id="9bc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种模式的优点是易于实现。缺点是它没有利用实体的使用。例如，没有聚合、查询、脚手架等。</p><h1 id="ca21" class="mh lc iq bd ld mi mj mk lg ml mm mn lj mo mp mq lm mr ms mt lp mu mv mw ls mx bi translated">具有本地副本的ECS</h1><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/e6e03840edf2674f295a3f87d6fc513c.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*qhlJE8Y4yXFUWK87kEQfNg.png"/></div></div></figure><p id="3d61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一种变化是“创建外部实体的本地副本”。这不是外部实体的精确副本，而是标准化的业务概念。</p><p id="89c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个场景中，MovieCS包含映射到MovieStruct的实体Movie。服务器操作现在作用于电影实体，而不是电影结构。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c34bd82595b3c80414815648145be896.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*2PKGG0PfkEPy7QBgTaAc8w.png"/></div></figure><p id="bff5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">电影保存动作现在更新外部数据和电影</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/c610beb9893f998389d95a8a9df00b00.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*zkTxMCyZXJfxctHfeGz6Vw.png"/></div><figcaption class="ni nj gj gh gi nk nl bd b be z dk translated">电影保存逻辑</figcaption></figure><p id="56c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，MovieCS现在还包含一个计时器和逻辑，用于将外部系统中的任何更改同步到副本。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/4d68f42f4580a7f7a1b0760e681c2140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*jEynyzh_AMAq-q7huJBc_A.png"/></div><figcaption class="ni nj gj gh gi nk nl bd b be z dk translated">电影同步逻辑</figcaption></figure><h1 id="7313" class="mh lc iq bd ld mi mj mk lg ml mm mn lj mo mp mq lm mr ms mt lp mu mv mw ls mx bi translated">带隔离同步逻辑的ECS</h1><p id="5ffd" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">另一种变化是将同步逻辑与先前的模式隔离开来。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/91ce953a18d84517a052ca4319bad29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*8pDKGbo3ajnf-2on53WNAw.png"/></div></figure><p id="5583" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种模式的优点是:</p><ul class=""><li id="85fe" class="kn ko iq jp b jq jr ju jv jy kp kc kq kg kr kk ks kt ku kv bi translated">代码独立性</li><li id="f4ea" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated">CS的消费者不受同步的影响</li><li id="1e13" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated">Sync可以协调几个(相关的)CS</li></ul><h1 id="5b5d" class="mh lc iq bd ld mi mj mk lg ml mm mn lj mo mp mq lm mr ms mt lp mu mv mw ls mx bi translated">具有直接集成和发布/订阅功能的ECS</h1><p id="f2dc" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">当要求数据必须总是同步时，我们可以使用直接积分来代替同步。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi no"><img src="../Images/5e88247fbd59e0295ebfd3429a2646ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*DpOCyEnET7ydvHWaF7__kA.png"/></div></figure><p id="c9df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种模式中，副本的API被构建到外部系统中，因此更改可以立即反映出来。在ACME Film中更新记录时，会调用MovieAPI来更新电影记录。</p><p id="1f5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果企业服务总线(ESB)可用，这种模式也可以通过发布/订阅机制来实现。</p><p id="84bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种模式的优点是外部系统副本和外部实体中的变化总是同步的。</p><p id="3c97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果在外部系统中删除了记录，并且存在对副本的引用，则必须提供特殊处理。对于更复杂的数据同步问题，您可以查看这篇文章。</p><h1 id="03fb" class="mh lc iq bd ld mi mj mk lg ml mm mn lj mo mp mq lm mr ms mt lp mu mv mw ls mx bi translated">总结和结论</h1><p id="d172" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这里描述的每种ECS变体都有其优点和缺点。在选择最适合您需求的ECS变体时，请慎重考虑。</p><h2 id="267a" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">参考</h2><ul class=""><li id="215b" class="kn ko iq jp b jq lu ju lv jy np kc nq kg nr kk ks kt ku kv bi translated"><a class="ae kl" href="https://www.outsystems.com/learn/courses/68/architecture-patterns-in-outsystems/" rel="noopener ugc nofollow" target="_blank">外部系统的架构模式</a></li><li id="d4ee" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://www.arcitura.com/book/soa-principles-of-service-design/overview/" rel="noopener ugc nofollow" target="_blank"> SOA服务设计原则</a></li><li id="4e35" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://www.arcitura.com/book/soa-design-patterns/overview/" rel="noopener ugc nofollow" target="_blank"> SOA设计模式</a></li></ul></div></div>    
</body>
</html>
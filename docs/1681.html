<html>
<head>
<title>Real-time Unique Input Validation with VueJS and Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用VueJS和Laravel进行实时唯一输入验证</h1>
<blockquote>原文：<a href="https://itnext.io/vuejs-and-laravel-realtime-unique-input-validation-a6d9220be1c5?source=collection_archive---------2-----------------------#2019-01-01">https://itnext.io/vuejs-and-laravel-realtime-unique-input-validation-a6d9220be1c5?source=collection_archive---------2-----------------------#2019-01-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/05fda0b8f2ea04385325c14a26d3d447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NfBTJMLFR_ANLo0e"/></div></div></figure><blockquote class="jy jz ka"><p id="2cfb" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我最近遇到了一个问题，我需要实时验证文本输入的唯一性。当您需要创建用户名时，这在注册表单中很常见。对于用户来说，不断地提交表单来查看他们的输入是否被接受是非常烦人的。这就是服务器端验证发挥作用的地方。</p></blockquote><p id="9643" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">在我的项目中，我已经使用了Vuetify和VeeValidate，所以我将围绕这两个工具来设计我的解决方案。这里讨论的概念可以用于其他包，但是可能需要一些修改。</p><p id="57aa" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">我将使用我正在制作的关于多租户web应用程序系列中的演示项目。您可以在下面找到本系列第1部分和github repo的链接。</p><div class="ld le gp gr lf lg"><a href="https://github.com/sadnub/laravel-tenancy-passport-demo" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd ir gy z fp ll fr fs lm fu fw ip bi translated">sad nub/laravel-租赁-护照-演示</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">带护照和租约的Laravel演示。为sad nub/laravel-tenancy-passport-demo开发做出贡献，创建一个…</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">github.com</p></div></div><div class="lp l"><div class="lq l lr ls lt lp lu jw lg"/></div></div></a></div><div class="ld le gp gr lf lg"><a href="https://medium.com/@sadnub/hyn-tenancy-5-2-and-laravel-passport-a0d11c5a08eb" rel="noopener follow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd ir gy z fp ll fr fs lm fu fw ip bi translated">Laravel护照和Hyn \租赁-第1部分</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">这是你们期待已久的帖子。我已经花了三个月的时间来构建我的SaaS应用程序…</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">medium.com</p></div></div><div class="lp l"><div class="lv l lr ls lt lp lu jw lg"/></div></div></a></div><p id="d4d1" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">现在来点好的！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="b3a0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">因此，在这个特定的应用程序中，每个租户都注册了一个子域，这将使他们进入自己的控制面板。这个子域是在注册期间选择的，并且需要是唯一的。因此，我们的目标是让他们能够实时看到他们输入的值是否有效。这将使用一个API端点来完成，该端点简单地检查数据库中的值。如果值存在，则返回false，反之亦然。</p><p id="76f5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">如前所述，我将使用VeeValidate包进行验证。查看文档！</p><div class="ld le gp gr lf lg"><a href="https://baianat.github.io/vee-validate/" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd ir gy z fp ll fr fs lm fu fw ip bi translated">VeeValidate</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">基于模板的Vue.js验证框架</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">baianat.github.io</p></div></div></div></a></div><p id="3898" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">Vuetify对于UI组件来说是非常棒的，并且可以减少开发中的大量工作。看看这些文件！</p><div class="ld le gp gr lf lg"><a href="https://vuetifyjs.com/en/getting-started/quick-start" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd ir gy z fp ll fr fs lm fu fw ip bi translated">快速入门- Vuetify.js</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">立即开始使用Vue和Vue化。支持vue-cli-3、现有项目等。</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">vuetifyjs.com</p></div></div><div class="lp l"><div class="md l lr ls lt lp lu jw lg"/></div></div></a></div><h1 id="f7cb" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">vee验证配置</h1><p id="67db" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km la ne kp kq lb nf kt ku lc ng kx ky kz ij bi translated">使用这个包非常容易。你只需要把它作为一个插件来添加，并配置一些选项。这是我的<code class="fe nh ni nj nk b">app.js</code>文件。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="4cb8" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">需要<code class="fe nh ni nj nk b">inject: false</code>配置，因为我们将在Vue之外添加验证错误。稍后我会分享我的axios配置来解释这一点。我们只需要记住在需要验证字段的组件中注入根<code class="fe nh ni nj nk b">$validator</code>实例。查看文档了解更多信息。</p><h1 id="4c30" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">API端点</h1><p id="cb04" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km la ne kp kq lb nf kt ku lc ng kx ky kz ij bi translated">对于这一部分，我创建了一个API post route，它调用注册控制器中的一个方法。很标准的东西。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="fa2c" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">注册控制器</h1><p id="ddc9" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km la ne kp kq lb nf kt ku lc ng kx ky kz ij bi translated"><code class="fe nh ni nj nk b">checkDomain</code>方法将把租户URL附加到请求中，然后通过验证器检查其唯一性。如果验证失败，422响应将与验证消息一起发回。我有一个axios拦截器，它捕获这422条消息，并将它们添加到VeeValidate错误包中，因此我们不必担心处理这些消息。</p><p id="6e99" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">当验证成功时，将以VeeValidate期望的格式发回一个json响应。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2c87" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">这是我正在使用的axios拦截器。它需要Vue根实例来添加验证错误，所以请确保执行<code class="fe nh ni nj nk b">export const vm = new Vue()</code>以便您可以导入它。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="8550" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">授权API文件</h1><p id="88ac" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km la ne kp kq lb nf kt ku lc ng kx ky kz ij bi translated">我在我们的api.js文件中添加了一个函数来检查域。这是我们可以导入到组件中的文件。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="8456" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">注册页面</h1><p id="5a82" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km la ne kp kq lb nf kt ku lc ng kx ky kz ij bi translated">这是所有验证逻辑的位置。如果你需要在应用程序的其他部分使用相同的逻辑，你可以把它移到你的<code class="fe nh ni nj nk b">app.js</code>文件中。</p><p id="f91e" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">有一个名为isUnique的函数，每次触发验证时都会调用它。然后我们使用Validator.extend()方法创建一个新的验证规则。然后，我们可以在字段上指定这个验证规则。我在<code class="fe nh ni nj nk b">mounted()</code>钩子中指定了所有这些。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8f39" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">看一下fqdn字段。添加了unique规则，并且有一些逻辑根据验证状态切换图标。我使用Vuetify v-text-field append槽将图标放在输入中。然后我们可以使用v-if语句来呈现正确的图标。最后，我使用VeeValidate <code class="fe nh ni nj nk b">data-vv-delay</code>属性将验证次数限制为每500毫秒1次。这将减轻我们的API的一些负担。</p><h1 id="4b6b" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">包扎</h1><p id="2c5e" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km la ne kp kq lb nf kt ku lc ng kx ky kz ij bi translated">现在，您有了一个全功能的解决方案来实时验证数据的唯一性！你的用户会非常感激的。</p><p id="6610" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">希望这对你有所帮助！如果你有任何问题、意见和建议，请在评论中告诉我。</p><p id="2d3a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><em class="kd">看看我下面的其他文章吧！</em></p><p id="198a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><a class="ae nr" href="https://medium.com/@sadnub/laravel-multi-tenant-app-setup-part-0-ee4c730f4c2a" rel="noopener">第0部分</a> — Laravel多租户应用设置</p><p id="3120" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">第一部分 — Laravel护照和Hyn \租赁</p><p id="f084" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><a class="ae nr" href="https://medium.com/@sadnub/vuejs-and-laravel-api-part-2-711c4986281c" rel="noopener">第二部分</a> — VueJS和Laravel API</p><p id="1cbb" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><a class="ae nr" href="https://medium.com/@sadnub/laravel-multi-tenant-testing-part-3-a37901054ec6" rel="noopener">第3部分</a> — Laravel多租户测试</p></div></div>    
</body>
</html>
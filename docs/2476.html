<html>
<head>
<title>Maven Tips and Tricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Maven提示和技巧</h1>
<blockquote>原文：<a href="https://itnext.io/maven-tips-and-tricks-127ca293df50?source=collection_archive---------3-----------------------#2019-05-30">https://itnext.io/maven-tips-and-tricks-127ca293df50?source=collection_archive---------3-----------------------#2019-05-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/d498c619e87ebbebbd6cab4185044062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*XTmUH0MHhLc3wrb_obNNRQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">图片由<a class="ae kb" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=998958" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的Gerd Altmann 提供</figcaption></figure><p id="0984" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我写Maven pom已经超过10年了。在那段时间里，我学会了许多技巧，让maven按照我想要的方式工作，并为我的开发人员提供出色的体验。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="1ed1" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">Maven包装</h1><p id="82ea" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">Maven包装器很像Gradle包装器。包装器提供了一个可执行的shell脚本，如果需要的话，它会下载Maven，然后使用它来完成构建。</p><p id="1596" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这允许您在代码中配置maven版本。这在大型团队中是非常宝贵的，因为不是每个人的系统上都安装了相同版本的Maven。</p><p id="5f04" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">要将maven包装器添加到项目中，请运行</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="2714" class="mt li it mp b gy mu mv l mw mx">mvn -N io.takari:maven:0.7.6:wrapper</span></pre><h2 id="7bee" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">进一步阅读</h2><ul class=""><li id="1122" class="nj nk it ke b kf mf kj mg kn nl kr nm kv nn kz no np nq nr bi translated"><a class="ae kb" href="https://github.com/takari/maven-wrapper" rel="noopener ugc nofollow" target="_blank"> Maven包装</a></li></ul></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="1548" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">执行单元的配置</h1><p id="6516" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">当你添加一个插件到你的构建中时，你有时可以依赖它的默认配置，但是更多的时候你会想要为你的特定项目需求配置它。这意味着提供一个配置块和可能的执行块。</p><p id="1dd6" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">执行块是将配置隔离到特定环境的好方法。这样想吧。</p><p id="a6dc" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">根配置块用于全局配置。</p><p id="84fc" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">内部执行配置块用于本地范围的配置。</p><p id="fd98" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">例如:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="46ae" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>    &lt;<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;<strong class="mp iu">globalValue</strong>&gt;someValue&lt;<strong class="mp iu">/globalValue</strong>&gt;<br/>    &lt;<strong class="mp iu">/configuration</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;generate-sources&lt;/<strong class="mp iu">phase</strong>&gt;<br/>            &lt;<strong class="mp iu">goals</strong>&gt;<br/>                &lt;<strong class="mp iu">goal</strong>&gt;runIt&lt;/<strong class="mp iu">goal</strong>&gt;<br/>            &lt;/<strong class="mp iu">goals</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">localValue</strong>&gt;otherValue&lt;/<strong class="mp iu">localValue</strong>&gt;<br/>                &lt;<strong class="mp iu">globalValue</strong>&gt;override&lt;/<strong class="mp iu">globalValue</strong>&gt;<br/>            &lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomethingElse&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;generate-sources&lt;/<strong class="mp iu">phase</strong>&gt;<br/>            &lt;<strong class="mp iu">goals</strong>&gt;<br/>                &lt;<strong class="mp iu">goal</strong>&gt;runIt&lt;/<strong class="mp iu">goal</strong>&gt;<br/>            &lt;/<strong class="mp iu">goals</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">localValue</strong>&gt;otherValue2&lt;/<strong class="mp iu">localValue</strong>&gt;<br/>            &lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt;    <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre><p id="cba0" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这里我们有同一个插件的两个执行。属性<strong class="ke iu"> globalValue </strong>的全局值被指定为<strong class="ke iu"> someValue </strong>。</p><p id="c2be" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">第一次执行<em class="ns"> doSomething </em>将<strong class="ke iu"> localValue </strong>属性分配给<strong class="ke iu"> otherValue </strong>，并用<strong class="ke iu"> override的值覆盖<strong class="ke iu"> globalValue </strong>。</strong></p><p id="d8fa" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">第二次执行<em class="ns"> doSomethingElse </em>也给<strong class="ke iu"> otherValue2 </strong>分配了一个<strong class="ke iu"> localValue </strong>属性，然后继承了<strong class="ke iu"> globalValue。</strong></p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="3c7a" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">执行执行块</h1><p id="1d06" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">使用执行块，您还可以执行单个步骤。例如，如果我只想运行上例中的第二个执行块，我会运行:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="2563" class="mt li it mp b gy mu mv l mw mx">mvn org.example:example-plugin@doSomethingElse</span></pre><p id="19b7" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">现在，对于开发人员来说，查找您选择的执行id可能有些繁琐。尤其是当这个执行存在于其他父pom中时。谢天谢地，有一个解决办法。</p><p id="da77" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">如果您有一个希望容易地向开发人员公开的执行，那么将执行id设置为<em class="ns"> default-cli。</em></p><p id="3151" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这是一个特殊的ID，当有人执行一个没有执行ID的插件时，maven会寻找这个ID。</p><p id="2b38" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">例如:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="e2e8" class="mt li it mp b gy mu mv l mw mx">mvn org.example:example-plugin</span></pre><p id="9147" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这里隐含了<em class="ns">默认cli </em>的ID。</p><p id="4200" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">现在，在一般执行中，不需要ID。但是它们非常有用，我建议你总是提供一个。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="e9fb" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">插件管理</h1><p id="b072" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">你也可以使用插件管理部分来配置一个插件，而不用执行它。现在你也可以用概要文件来做这件事，但是使用<em class="ns">插件管理</em>部分来确保全局共享配置。</p><p id="936f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">例如，我可以将之前的插件配置放入<em class="ns">插件管理</em>部分，如下所示:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="b0c4" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">pluginManagement</strong>&gt;<br/>  &lt;<strong class="mp iu">plugins&gt;<br/>    </strong>&lt;<strong class="mp iu">plugin</strong>&gt;<br/>      &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>      &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>      &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>      &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;generate-sources&lt;/<strong class="mp iu">phase</strong>&gt;<br/>            &lt;<strong class="mp iu">goals</strong>&gt;<br/>                &lt;<strong class="mp iu">goal</strong>&gt;runIt&lt;/<strong class="mp iu">goal</strong>&gt;<br/>            &lt;/<strong class="mp iu">goals</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">localValue</strong>&gt;otherValue&lt;/<strong class="mp iu">localValue</strong>&gt;<br/>                &lt;<strong class="mp iu">globalValue</strong>&gt;override&lt;/<strong class="mp iu">globalValue</strong>&gt;<br/>            &lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt;<br/>        ...   <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>    &lt;/<strong class="mp iu">plugin</strong>&gt;<br/>  &lt;/<strong class="mp iu">plugins</strong>&gt;<br/>&lt;/<strong class="mp iu">pluginManagement</strong>&gt;</span></pre><p id="f67c" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">现在，即使我们插件的阶段被设置为生成源代码，如果我运行:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="7eb2" class="mt li it mp b gy mu mv l mw mx">mvn generate-sources</span></pre><p id="0f05" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我们的插件不会运行。这是因为通过将我们的插件配置放在<em class="ns"> pluginManagement </em>部分，我们给了maven一个执行的模板，但没有告诉它执行它。</p><p id="d38d" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">你为什么想这么做？</p><p id="c532" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这是一个跨所有执行类型共享配置的好方法。我发现这对于配置静态代码分析工具特别有用，比如check-style，我希望在所有执行、命令行和部分构建中共享配置。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="27ce" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">无阶段</h1><p id="b926" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">假设你有一个插件，它有一个默认的执行阶段，但是你不想让它运行。您可以用自己的阶段覆盖默认阶段，但它仍然会运行。</p><p id="4acc" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">如果你根本不想让它运行呢？</p><p id="48db" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">然后将相位设置为<strong class="ke iu">无。</strong></p><p id="7902" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">无</strong>相，没听说过。猜猜看，美文也没有！所以它不会执行你的插件。这不是错误，maven只是不会执行，因为没有<em class="ns"> none </em>阶段。</p><p id="bbe7" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这是一个禁用插件执行的好技巧。例如，假设之前的配置在父pom中。我可以像这样禁用<strong class="ke iu"> doSomething </strong>的执行:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="a3cb" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;none&lt;/<strong class="mp iu">phase</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt;   <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="5e52" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">插件配置继承</h1><p id="a3a7" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">说到父pom，有些情况下我想改变或添加父插件的配置。如果我要改变单个元素的值，这很容易。</p><p id="bdc8" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">例如，我在这里向<strong class="ke iu"> doSomething </strong>的父执行添加了一个配置元素:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="6e72" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">newValue</strong>&gt;otherValue&lt;/<strong class="mp iu">newValue</strong>&gt;<br/>            &lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt;   <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre><p id="f48f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这里父配置保持不变。如果我想覆盖父配置，我可以遵循相同的策略。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="972c" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">localValue</strong>&gt;childValue&lt;/<strong class="mp iu">localValue</strong>&gt;<br/>            &lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt;   <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre><p id="fc91" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这里我用<strong class="ke iu">子值</strong>覆盖了<strong class="ke iu">本地值</strong>的父值。</p><blockquote class="nt nu nv"><p id="c01a" class="kc kd ns ke b kf kg kh ki kj kk kl km nw ko kp kq nx ks kt ku ny kw kx ky kz im bi translated">注意:您只能在同一范围内覆盖元素</p></blockquote><p id="86c3" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这意味着我不能在子pom中为localValue提供一个全局配置元素，并期望它覆盖所有父执行配置中的值。如果我想覆盖所有父执行配置中的值，我需要在我的子pom中列出每个父执行，并在每个子POM中提供一个配置。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="aec4" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">插件配置继承:列表和映射</h1><p id="95fa" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">有时配置提供列表或地图元素。maven的默认行为是尝试<em class="ns">合并</em>这些定义。</p><p id="ddbd" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">假设您的父级具有以下带有列表和地图元素的配置:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="9767" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>    &lt;<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;<strong class="mp iu">globalValue</strong>&gt;someValue&lt;<strong class="mp iu">/globalValue</strong>&gt;<br/>    &lt;<strong class="mp iu">/configuration</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;generate-sources&lt;/<strong class="mp iu">phase</strong>&gt;<br/>            &lt;<strong class="mp iu">goals</strong>&gt;<br/>                &lt;<strong class="mp iu">goal</strong>&gt;runIt&lt;/<strong class="mp iu">goal</strong>&gt;<br/>            &lt;/<strong class="mp iu">goals</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">listValues</strong>&gt;<br/>                  &lt;<strong class="mp iu">value</strong>&gt;hello&lt;/<strong class="mp iu">value&gt;<br/>                </strong>&lt;/<strong class="mp iu">listValues</strong>&gt;<br/>                &lt;<strong class="mp iu">mapValues</strong>&gt;<br/>                  &lt;<strong class="mp iu">key1</strong>&gt;value1&lt;/<strong class="mp iu">key1&gt;<br/>                  </strong>&lt;<strong class="mp iu">key2</strong>&gt;value2&lt;/<strong class="mp iu">key2&gt;<br/>                </strong>&lt;/<strong class="mp iu">mapValues&gt;<br/>            </strong>&lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt; <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre><h2 id="ddfc" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">我如何向列表中添加元素？</h2><p id="772d" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">将以下属性添加到列表元素中:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8129" class="mt li it mp b gy mu mv l mw mx">combine.children=”append”</span></pre><h2 id="84a5" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">我该如何覆盖地图？</h2><p id="d08e" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">将以下属性添加到地图元素中:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="14c2" class="mt li it mp b gy mu mv l mw mx">combine.self="override"</span></pre><p id="b9b9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">例如配置:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="2557" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>    &lt;<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;<strong class="mp iu">globalValue</strong>&gt;someValue&lt;<strong class="mp iu">/globalValue</strong>&gt;<br/>    &lt;<strong class="mp iu">/configuration</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;generate-sources&lt;/<strong class="mp iu">phase</strong>&gt;<br/>            &lt;<strong class="mp iu">goals</strong>&gt;<br/>                &lt;<strong class="mp iu">goal</strong>&gt;runIt&lt;/<strong class="mp iu">goal</strong>&gt;<br/>            &lt;/<strong class="mp iu">goals</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">listValues combine.children="append"</strong>&gt;<br/>                  &lt;<strong class="mp iu">value</strong>&gt;world&lt;/<strong class="mp iu">value&gt;<br/>                </strong>&lt;/<strong class="mp iu">listValues</strong>&gt;<br/>                &lt;<strong class="mp iu">mapValues combine.self="override"</strong>&gt;<br/>                  &lt;<strong class="mp iu">key3</strong>&gt;value1&lt;/<strong class="mp iu">key3&gt;<br/>                </strong>&lt;/<strong class="mp iu">mapValues&gt;<br/>            </strong>&lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt; <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre><p id="d55b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">将导致以下效果:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="577d" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">plugin</strong>&gt;<br/>    &lt;<strong class="mp iu">groupId</strong>&gt;org.example&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;example-plugin&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>    &lt;<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;<strong class="mp iu">globalValue</strong>&gt;someValue&lt;<strong class="mp iu">/globalValue</strong>&gt;<br/>    &lt;<strong class="mp iu">/configuration</strong>&gt;<br/>    &lt;<strong class="mp iu">executions</strong>&gt;<br/>        &lt;<strong class="mp iu">execution</strong>&gt;<br/>            &lt;<strong class="mp iu">id</strong>&gt;doSomething&lt;/<strong class="mp iu">id</strong>&gt;<br/>            &lt;<strong class="mp iu">phase</strong>&gt;generate-sources&lt;/<strong class="mp iu">phase</strong>&gt;<br/>            &lt;<strong class="mp iu">goals</strong>&gt;<br/>                &lt;<strong class="mp iu">goal</strong>&gt;runIt&lt;/<strong class="mp iu">goal</strong>&gt;<br/>            &lt;/<strong class="mp iu">goals</strong>&gt;<br/>            &lt;<strong class="mp iu">configuration&gt;</strong><br/>                &lt;<strong class="mp iu">listValues combine.children="append"</strong>&gt;<br/>                  &lt;<strong class="mp iu">value</strong>&gt;hello&lt;/<strong class="mp iu">value&gt;<br/>                  </strong>&lt;<strong class="mp iu">value</strong>&gt;world&lt;/<strong class="mp iu">value&gt;<br/>                </strong>&lt;/<strong class="mp iu">listValues</strong>&gt;<br/>                &lt;<strong class="mp iu">mapValues combine.self="override"</strong>&gt;<br/>                  &lt;<strong class="mp iu">key3</strong>&gt;value1&lt;/<strong class="mp iu">key3&gt;<br/>                </strong>&lt;/<strong class="mp iu">mapValues&gt;<br/>            </strong>&lt;/<strong class="mp iu">configuration</strong>&gt;<br/>        &lt;/<strong class="mp iu">execution</strong>&gt; <br/>     &lt;/<strong class="mp iu">executions</strong>&gt;<br/>&lt;/<strong class="mp iu">plugin</strong>&gt;</span></pre><h2 id="ebcf" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">进一步阅读</h2><ul class=""><li id="e2c7" class="nj nk it ke b kf mf kj mg kn nl kr nm kv nn kz no np nq nr bi translated"><a class="ae kb" href="https://maven.apache.org/pom.html#Plugins" rel="noopener ugc nofollow" target="_blank"> Maven文档</a></li></ul></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="412e" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">Maven BOM</h1><p id="1250" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">当您构建一个拥有多个不同模块的库时，您通常会希望所有相同版本的模块一起使用。你可以依靠消费者来做这件事，或者你可以通过创建一个BOM来帮助他们。</p><p id="01a7" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">传统上，如果您想为一个特定的依赖项或一组依赖项定义一个版本，您应该在父pom中设置一个dependencyManagement块。然而，父pom使用继承模型，当您想要使用不同的库时，很快就会遇到问题。</p><p id="fe54" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">maven材料清单或BOM是一种特殊的包装，允许您组成<em class="ns">依赖管理</em>模块。</p><p id="ac78" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">要创建一个BOM，只需创建一个maven模块来打包<strong class="ke iu"> pom </strong>并像平常一样设置<em class="ns"> dependencyManagement </em>块:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="21f5" class="mt li it mp b gy mu mv l mw mx"><em class="ns">&lt;?</em><strong class="mp iu">xml version="1.0" encoding="UTF-8"</strong><em class="ns">?&gt;<br/></em>&lt;<strong class="mp iu">project <br/>        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br/>        xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</strong>&gt;<br/>    &lt;<strong class="mp iu">modelVersion</strong>&gt;4.0.0&lt;/<strong class="mp iu">modelVersion</strong>&gt;<br/><br/>    &lt;<strong class="mp iu">groupId</strong>&gt;io.github.efenglu.examples&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>    &lt;<strong class="mp iu">artifactId</strong>&gt;examples-bom&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>    &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>    &lt;<strong class="mp iu">packaging</strong>&gt;pom&lt;/<strong class="mp iu">packaging</strong>&gt;<br/><br/>    &lt;<strong class="mp iu">properties</strong>&gt;<br/>        &lt;<strong class="mp iu">examples.version</strong>&gt;${project.version}&lt;/<strong class="mp iu">examples.version</strong>&gt;<br/>    &lt;/<strong class="mp iu">properties</strong>&gt;<br/><br/>    &lt;<strong class="mp iu">dependencyManagement</strong>&gt;<br/>        &lt;<strong class="mp iu">dependencies</strong>&gt;<br/>            &lt;<strong class="mp iu">dependency</strong>&gt;<br/>                &lt;<strong class="mp iu">groupId</strong>&gt;io.github.efenglu.examples&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>                &lt;<strong class="mp iu">artifactId</strong>&gt;example-1&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>                &lt;<strong class="mp iu">version</strong>&gt;${examples.version}&lt;/<strong class="mp iu">version</strong>&gt;<br/>            &lt;/<strong class="mp iu">dependency</strong>&gt;<br/>            &lt;<strong class="mp iu">dependency</strong>&gt;<br/>                &lt;<strong class="mp iu">groupId</strong>&gt;io.github.efenglu.examples&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>                &lt;<strong class="mp iu">artifactId</strong>&gt;example-2&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>                &lt;<strong class="mp iu">version</strong>&gt;${examples.version}&lt;/<strong class="mp iu">version</strong>&gt;<br/>            &lt;/<strong class="mp iu">dependency</strong>&gt;</span><span id="d057" class="mt li it mp b gy nz mv l mw mx">...</span><span id="1852" class="mt li it mp b gy nz mv l mw mx">        &lt;/<strong class="mp iu">dependencies</strong>&gt;<br/>    &lt;/<strong class="mp iu">dependencyManagement</strong>&gt;<br/><br/>&lt;/<strong class="mp iu">project</strong>&gt;</span></pre><p id="0d05" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">然后，为了使用BOM，将以下内容添加到您自己的<em class="ns"> dependencyManagement </em>块中:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8648" class="mt li it mp b gy mu mv l mw mx">&lt;<strong class="mp iu">dependencyManagement</strong>&gt;<br/>    &lt;<strong class="mp iu">dependencies</strong>&gt;<br/><em class="ns"><br/>        </em>&lt;<strong class="mp iu">dependency</strong>&gt;<br/>            &lt;<strong class="mp iu">groupId</strong>&gt;io.github.efenglu.examples&lt;/<strong class="mp iu">groupId</strong>&gt;<br/>            &lt;<strong class="mp iu">artifactId</strong>&gt;examples-bom&lt;/<strong class="mp iu">artifactId</strong>&gt;<br/>            &lt;<strong class="mp iu">version</strong>&gt;1.0.0&lt;/<strong class="mp iu">version</strong>&gt;<br/>            &lt;<strong class="mp iu">type</strong>&gt;pom&lt;/<strong class="mp iu">type</strong>&gt;<br/>            &lt;<strong class="mp iu">scope</strong>&gt;import&lt;/<strong class="mp iu">scope</strong>&gt;<br/>        &lt;/<strong class="mp iu">dependency</strong>&gt;<br/>...<br/>    &lt;/<strong class="mp iu">dependencies</strong>&gt;<br/>&lt;/<strong class="mp iu">dependencyManagement</strong>&gt;</span></pre><p id="d435" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">注意类型是<strong class="ke iu"> pom </strong>，范围是<strong class="ke iu"> import </strong>。这将导致BOM的<em class="ns"> dependencyManagement </em>块中的所有依赖项被导入到您的<em class="ns"> dependencyManagement </em>块中。</p><h2 id="3a1e" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">进一步阅读</h2><ul class=""><li id="b231" class="nj nk it ke b kf mf kj mg kn nl kr nm kv nn kz no np nq nr bi translated">梅文·博姆</li></ul></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="7c42" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">设置版本</h1><p id="b149" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">设置单个pom的版本是微不足道的。只需更改version元素中的值。然而，在有父项目和多个模块的大型项目中，手动更改版本可能会很繁琐并且容易出错。幸运的是，maven有一个工具可以让修改版本变得非常简单，即使是在大型项目中。</p><p id="e9e4" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">运行以下命令:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="89e9" class="mt li it mp b gy mu mv l mw mx">mvn versions:set</span></pre><p id="a227" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">Maven随后会提示您想要将项目更改为哪个版本。如果这是一个父pom，所有子POM的版本都会相应地更新。</p><h2 id="bef3" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">进一步阅读</h2><ul class=""><li id="44a0" class="nj nk it ke b kf mf kj mg kn nl kr nm kv nn kz no np nq nr bi translated"><a class="ae kb" href="https://www.mojohaus.org/versions-maven-plugin/" rel="noopener ugc nofollow" target="_blank"> Maven版本插件</a></li></ul></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="e9b1" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">有效POM</h1><p id="5541" class="pw-post-body-paragraph kc kd it ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz im bi translated">我如何更好地了解maven将要做什么，或者它为什么要做什么？</p><p id="1006" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">最好的方法是生成有效的pom。</p><p id="fca4" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">有效的pom是在替换了所有属性、继承了所有配置之后，maven如何看待您的pom文件的完整视图。以及必要时合并或附加的配置。</p><p id="3eb4" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这在调试插件配置时非常有用，应该是您解决maven配置问题的首选。</p><p id="e474" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">要生成有效的pom，只需运行:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="321a" class="mt li it mp b gy mu mv l mw mx">mvn help:effective-pom</span></pre><h2 id="264d" class="mt li it bd lj my mz dn ln na nb dp lr kn nc nd lv kr ne nf lz kv ng nh md ni bi translated">延伸阅读:</h2><ul class=""><li id="18fc" class="nj nk it ke b kf mf kj mg kn nl kr nm kv nn kz no np nq nr bi translated"><a class="ae kb" href="https://maven.apache.org/plugins/maven-help-plugin/usage.html" rel="noopener ugc nofollow" target="_blank"> Maven帮助插件</a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Inverno Framework performance benchmark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Inverno框架性能基准</h1>
<blockquote>原文：<a href="https://itnext.io/inverno-framework-performance-benchmark-e3210c1a60d7?source=collection_archive---------2-----------------------#2022-03-01">https://itnext.io/inverno-framework-performance-benchmark-e3210c1a60d7?source=collection_archive---------2-----------------------#2022-03-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/41d7a8d54f7533c6e49201df136aa7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_f-l4WWJY5iGlqNqG5LhA.png"/></div></div></figure><p id="62f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我对<a class="ae kw" href="https://inverno.io" rel="noopener ugc nofollow" target="_blank"> Inverno框架</a>的<a class="ae kw" href="https://invernoframework.medium.com/introducing-the-inverno-framework-6ade9d84b0c3" rel="noopener">介绍</a>中，我讨论了随着云转型，性能如何变得越来越重要。事实上，为了降低运营成本，现代应用程序必须能够支持非常高的吞吐量，同时优化硬件资源的使用。</p><p id="e2e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一个开发阶段包括IoC/DI、配置模块、HTTP服务器模块、Web开发模块和RDBMS客户端模块等核心功能，在此阶段结束后，我将Inverno Framework提交给<a class="ae kw" href="https://www.techempower.com/benchmarks" rel="noopener ugc nofollow" target="_blank">tech empower Framework Benchmarks</a>，以便了解Inverno与其他Web应用程序框架相比处于什么位置。结果还不是官方的，应该会出现在下一轮，但我们已经可以分析非官方的结果。</p><p id="41fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Inverno Framework的目标一直是为现代Java应用程序开发提供尽可能好的平台，因此，在评估性能时牢记这一点非常重要。我通常说，性能是一个多方面的话题，不能简化为单一的原始性能。如果速度是唯一的标准，我们都将驾驶火箭车，这将忽视实用性、安全性、环境以及不是每个人都可以或应该驾驶这种车的事实。因此，在分析原始性能时，正确看待事物是很重要的。尤其是因为基准测试规则允许许多优化，而这些优化在开发实际应用程序时有时是不合适的。</p><p id="b0e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，让我们看看截至<a class="ae kw" href="https://www.techempower.com/benchmarks/#section=test&amp;runid=79350aca-3138-4f06-9f2a-d9ca470028f6" rel="noopener ugc nofollow" target="_blank">2022–02–21</a>的基准测试，看看Inverno框架与竞争对手相比如何。</p><p id="649e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将首先考虑直接的主要竞争对手，它们都是基于Java的、业内公认的参与者，然后我将把分析扩展到所有基于JVM的框架，最后扩展到所有框架，而不考虑底层技术。</p><p id="e9cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我认为以下框架是Inverno Framework的主要竞争对手:</p><ul class=""><li id="af30" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">在过去的15年里，Spring Framework已经成为企业应用程序开发的事实标准。</li><li id="cd5a" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">这是红帽对Spring Boot在JEE终结后的回应。</li><li id="c604" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">Micronaut是现代应用开发中一个新兴的应用框架。</li><li id="3018" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://vertx.io" rel="noopener ugc nofollow" target="_blank"> Vert.x </a>这已经成为Java性能领域的参考。</li><li id="9b0b" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://netty.io" rel="noopener ugc nofollow" target="_blank"> Netty </a>它实际上并不是一个应用框架，但包括Inverno和Vertx在内的许多框架都基于它，用于底层I/O和线程模型。</li></ul><p id="bdeb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是综合结果:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/263a4d1c7169904186f5ff65525bea60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATwyTyLbgbAmOf1vbYweyA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">Inverno框架主要竞争对手</figcaption></figure><p id="df56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，Netty没有出现在该列表中，因为它没有实现DB测试。它在JSON和明文测试中的成绩分别是1，094，575tps和4，028，882tps。</p><p id="4537" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据这些结果，我们可以确定两个组:第一组由Vert.x、Inverno和Quarkus(和Netty)组成，第二组由Spring和Micronaut组成。这两个群体之间的差异是巨大的，Spring和Micronaut都无法抗拒与其他群体的比较。例如，考虑原始HTTP性能，Inverno比Spring好2274%。</p><p id="c9aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们应该注意，这些测试中使用的Spring boot应用程序没有使用Spring WebFlux，这可能会提高性能，但可能不足以赶上原始HTTP性能和数据库访问性能，因为Spring仍然依赖于JDBC，它没有使用非阻塞I/O，也没有利用管道。</p><p id="93bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第一组中，我们可以看到Inverno和Vert.x之间的差异很小，Vert.x具有更好的DB访问性能，而Inverno具有更好的原始HTTP性能。夸库斯以略低的表现完成了这个三重奏。考虑到Vert.x和Inverno都基于Netty进行低级网络I/O，Inverno依赖Vert.x SQL客户端进行数据库访问，Quarkus使用Vert.x进行HTTP服务器和数据库访问，这些结果并不令人惊讶。Inverno和Vert.x在DB访问性能上的差异可以用Vert.x SQL客户端的集成所带来的开销来解释，这是为了使其具有反应性并与框架的其余部分保持一致。</p><p id="9153" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有趣的是，Inverno的HTTP服务器性能非常好，比Vert.x好11%,甚至比Netty更好。</p><p id="ad94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们扩大范围，考虑所有基于JVM的框架，包括Java、Kotlin和Scala。</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/56c0417ca682416c30bf4b22f80ef044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3zI5ajTvHMKNCansG5J4KA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架</figcaption></figure><p id="f35a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因弗诺出现在Vert.x和<a class="ae kw" href="https://officefloor.net/" rel="noopener ugc nofollow" target="_blank"> Officefloor </a>之后的第三位，<a class="ae kw" href="https://jooby.io" rel="noopener ugc nofollow" target="_blank"> Jooby </a>出现在第四位，我们发现Quarkus在第五位。在列表的更下方，差距有所扩大，但我们仍然有相当高性能的框架，如<a class="ae kw" href="https://github.com/oci-pronghorn/GreenLightning" rel="noopener ugc nofollow" target="_blank"> Greenlightning </a>，它像Officefloor一样，实现了自己的网络堆栈。</p><p id="8ea4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Officefloor似乎是性能最高的，其原始HTTP性能和数据库访问性能令人印象深刻，可与Vert.x相媲美，这是合理的，因为它使用Vert.x PgClient进行数据库访问。然而，如果我们看一下基准测试应用程序本身，每次测试中用于获得这些结果的优化和特定配置的数量要比其他测试高得多。它也没有使用模板引擎，这允许更好的优化，并可以解释在财富测试中的好成绩。因此，我不确定我们是否会用常规应用程序得到相同的结果，即使它们应该保持很高。最后，为了获得这样的原始HTTP性能，它使用自己的HTTP服务器，该服务器似乎不支持HTTP/2协议，这在开发实际的Web应用程序时并不理想。</p><p id="0a53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如前所述，Vert.x、Inverno和Jooby之间的差距非常小，这是可以理解的，因为这些框架都是基于反应式线程模型(使用Netty或Undertow)并使用Vert.x PgClient进行数据库访问。Quarkus落后于较低的原始HTTP性能，可能是由于Vert.x集成开销。如果我们现在看代码，我们可以看到所有基准测试项目都使用了合理的优化，并且接近我们在常规应用程序中看到的情况。为了完全公平，我必须承认，与Jooby和Quarkus不同，Vert.x和Inverno都是使用简单的开关来路由请求。这是一个诚实的优化，这些框架的架构提供了可插拔的网络路由器。所有这些框架都支持HTTP压缩、HTTP/2协议，并提供特定的特性来创建REST APIs，使它们有资格进行Web应用程序开发。</p><p id="568a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一些框架没有出现在综合框架得分中，因为它们没有实现所有的测试，但是它们表现得非常好，也应该被考虑。让我们来看看Inverno在单独考虑每项测试时的表现:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/948f496c4baeac6b305cf26c0c90f732.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gmTI1Ppl6J13K5k37GUogw.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架:JSON测试(满分120分)</figcaption></figure><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/7d8ba27c1b39cd95129fe8dae2393590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YgzmOivfFuh8oQ111cxKqQ.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架:单一查询测试(共111项)</figcaption></figure><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/0603ffc21aad7feba191b2821c99a567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QN7iCl3-FOx4SUbtQ5OIbg.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架:多重查询测试(满分108分)</figcaption></figure><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/d0ff1e9e7a125c5a2d03a412be58bd90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhhftcboOqmDC6SDlG8Nww.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架:运气测试(满分114分)</figcaption></figure><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/e1acc66029ad16502f47ce84bb8192f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oi54igv8gt8Rf8o39q9avA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架:更新测试(共99个)</figcaption></figure><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/7e0e6c3eb2f02f315587a1008a5cfd28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l298BM3xXi9TzyAkcTIN-w.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">基于JVM的框架:明文测试(满分119分)</figcaption></figure><p id="205d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以看到，在所有的DB访问测试中，Inverno都是前5名。有趣的是，前五名中的所有框架都使用Vert.x PgClient。考虑到原始HTTP性能，Inverno出现在前15名(删除重复项后)。前面的框架都不是基于Netty的，这使得Inverno成为最快的基于Netty的HTTP服务器。我们还可以注意到，这其中，似乎只有基于<a class="ae kw" href="https://undertow.io/" rel="noopener ugc nofollow" target="_blank">暗流</a>的<a class="ae kw" href="https://github.com/noboomu/proteus" rel="noopener ugc nofollow" target="_blank"> Proteus </a>支持HTTP/2。也就是说，像<a class="ae kw" href="https://github.com/redkale/redkale" rel="noopener ugc nofollow" target="_blank"> Redkale </a>、<a class="ae kw" href="https://activej.io/" rel="noopener ugc nofollow" target="_blank"> Activej </a>或<a class="ae kw" href="https://github.com/rapidoid/rapidoid" rel="noopener ugc nofollow" target="_blank"> Rapidoid </a>这样的框架的HTTP性能仍然令人印象深刻。</p><p id="d9c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，让我们看看不考虑技术的复合框架分数。</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/d0be8b5caacd69c1eb232b24f7af8c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z6TZJiAeBCJ2Q4byCRui9Q.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">所有框架</figcaption></figure><p id="86f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Inverno总体排名第12位(满分120分),仅次于Vert.x。不出所料，我们发现大多数基于C/C++和Rust的框架位于顶部。</p><h1 id="a552" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">减去</h1><p id="e222" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">凭借与Vert.x相当的全局性能，<a class="ae kw" href="https://inverno.io" rel="noopener ugc nofollow" target="_blank"> Inverno Framework </a>正是我想要的，它是世界上性能最好的Java Web应用程序框架之一，超过了Spring或Quarkus等行业标准。</p><p id="412e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择Netty作为网络I/O框架使得创建高性能和稳定的HTTP服务器成为可能，该服务器支持HTTP压缩、HTTP/1.1和HTTP/2协议，并有助于集成其他基于Netty的库，如Vert.x SQL client或<a class="ae kw" href="https://lettuce.io" rel="noopener ugc nofollow" target="_blank">莴苣</a>。Inverno框架看起来是性能最好的基于Netty的HTTP服务器，然而，当涉及到原始HTTP性能时，基于特定网络I/O库的框架可能性能更好，这表明Netty可能还有改进的空间。</p><p id="c86f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还需要指出的是，性能虽然至关重要，但并不是专为现代应用程序开发而设计的Inverno框架的主要目标。它包含了反应式和模块化编程，并提供了一些功能，如编译时IoC/DI、高级配置、编程式和声明式Web路由定义、RDBMS和Redis客户端、反应式模板引擎以及用于构建和打包云应用程序的构建工具。所有这些共同产生了一种流畅而高效的开发体验，以创建快速的模块化可维护的云原生应用程序。</p></div></div>    
</body>
</html>
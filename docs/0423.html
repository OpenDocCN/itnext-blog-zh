<html>
<head>
<title>Create your first Ethereum dAPP with Web3 and Vue.JS (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Web3和Vue创建您的第一个以太坊dAPP。JS(第三部分)</h1>
<blockquote>原文：<a href="https://itnext.io/create-your-first-ethereum-dapp-with-web3-and-vue-js-part-3-dc4f82fba4b4?source=collection_archive---------2-----------------------#2018-03-08">https://itnext.io/create-your-first-ethereum-dapp-with-web3-and-vue-js-part-3-dc4f82fba4b4?source=collection_archive---------2-----------------------#2018-03-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="37fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fcreate-your-first-ethereum-dapp-with-web3-and-vue-js-part-3-dc4f82fba4b4" rel="noopener ugc nofollow" target="_blank"> <em class="km">点击这里在LinkedIn </em>上分享这篇文章</a></p><p id="83a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，欢迎来到这个系列的最后一部分。如果你正在收听，我们正在为以太坊区块链创建一个简单的分散式应用程序。请随意查看第1部分和第2部分！</p><div class="kn ko gp gr kp kq"><a rel="noopener  ugc nofollow" target="_blank" href="/create-your-first-ethereum-dapp-with-web3-and-vue-js-c7221af1ed82"><div class="kr ab fo"><div class="ks ab kt cl cj ku"><h2 class="bd ir gy z fp kv fr fs kw fu fw ip bi translated">使用Web3和Vue创建您的第一个以太坊dAPP。JS(第一部分)</h2><div class="kx l"><h3 class="bd b gy z fp kv fr fs kw fu fw dk translated">欢迎来到另一个教程！在本教程中，我们将深入创建一个简单的反应式分散应用程序…</h3></div><div class="ky l"><p class="bd b dl z fp kv fr fs kw fu fw dk translated">itnext.io</p></div></div><div class="kz l"><div class="la l lb lc ld kz le lf kq"/></div></div></a></div><div class="kn ko gp gr kp kq"><a rel="noopener  ugc nofollow" target="_blank" href="/create-your-first-ethereum-dapp-with-web3-and-vue-js-part-2-52248a74d58a"><div class="kr ab fo"><div class="ks ab kt cl cj ku"><h2 class="bd ir gy z fp kv fr fs kw fu fw ip bi translated">使用Web3和Vue创建您的第一个以太坊dAPP。JS(第二部分)</h2><div class="kx l"><h3 class="bd b gy z fp kv fr fs kw fu fw dk translated">欢迎回到这个令人敬畏的教程系列的第2部分，在这里我们动手构建我们的第一个去中心化的…</h3></div><div class="ky l"><p class="bd b dl z fp kv fr fs kw fu fw dk translated">itnext.io</p></div></div><div class="kz l"><div class="lg l lb lc ld kz le lf kq"/></div></div></a></div><h1 id="4a73" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">从我们离开的地方继续</h1><p id="9902" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">因此，在这一阶段，我们的应用程序能够从metamask获取我们的帐户数据并显示它。但是，当更改帐户时，如果不重新加载页面，数据不会更新。这不是最佳选择，我们希望确保这些变化能够反应性地显示出来。</p><p id="f92c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的方法与简单注册web3实例略有不同。Metamask还不支持websockets，所以我们必须定期轮询变化。我们不希望在没有变化时调度动作，因此只有在满足某个条件(某个变化)时，我们的动作才会与它们各自的有效负载一起被调度。</p><p id="a61c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可能有几种方法，这可能不是最漂亮的一种，它在严格模式的约束下工作，但是我们很好。在<em class="km"> util </em>文件夹中新建一个名为<em class="km"> pollWeb3.js </em>的文件。这是我们要做的:</p><ul class=""><li id="16df" class="mk ml iq jp b jq jr ju jv jy mm kc mn kg mo kk mp mq mr ms bi translated">导入Web3，这样我们就不依赖于元掩码实例了</li><li id="3f1c" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">导入我们的商店，以便我们可以比较价值和调度行动，如果需要的话</li><li id="8a9c" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">创建我们的web3实例</li><li id="a577" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">设定一个时间间隔来检查地址是否改变，如果不是，检查余额是否改变</li><li id="5575" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">如果地址或余额有变化，我们将更新我们的商店。因为我们的<em class="km"> hello-metamask组件</em>有一个<em class="km">计算属性</em>，所以这个数据更改是被动的</li></ul><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e083" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们只需要在web3Instance初始注册后开始轮询更新。因此，打开<em class="km"> store/index.js </em>，导入我们的<em class="km"> pollWeb3.js </em>文件，并将其添加到我们的<em class="km">register web 3 instance()variation</em>的底部，以便在状态更改后执行。</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="b570" class="nk li iq ng b gy nl nm l nn no">import pollWeb3 from '../util/pollWeb3'</span><span id="6626" class="nk li iq ng b gy np nm l nn no">registerWeb3Instance (state, payload) {<br/> console.log('registerWeb3instance Mutation being executed', payload)<br/> let result = payload<br/> let web3Copy = state.web3<br/> web3Copy.coinbase = result.coinbase<br/> web3Copy.networkId = result.networkId<br/> web3Copy.balance = parseInt(result.balance, 10)<br/> web3Copy.isInjected = result.injectedWeb3<br/> web3Copy.web3Instance = result.web3<br/> state.web3 = web3Copy<br/><strong class="ng ir"> pollWeb3()</strong><br/> }</span></pre><p id="22b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们正在调度操作，所以我们需要将它添加到我们的存储中，以及一个变异来提交更改。我们可以直接提交一个变更，但是让我们保持我们的模式一致。我们将添加一些console.logs，以便您可以在控制台中观看精彩的过程。在actions对象中添加:</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="13a5" class="nk li iq ng b gy nl nm l nn no">pollWeb3 ({commit}, payload) {<br/> console.log('pollWeb3 action being executed')<br/> commit('pollWeb3Instance', payload)<br/> }</span></pre><p id="1690" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们只需要对我们传递的可能的两个变量进行突变</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="c2d8" class="nk li iq ng b gy nl nm l nn no">pollWeb3Instance (state, payload) {<br/> console.log('pollWeb3Instance mutation being executed', payload)<br/> state.web3.coinbase = payload.coinbase<br/> state.web3.balance = parseInt(payload.balance, 10)<br/> }</span></pre><p id="cc2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">搞定了。如果我们现在更改Metamask中的地址或我们的余额发生变化，我们将在我们的应用程序中看到这一更新，而无需重新加载页面。当我们更改网络时，页面将重新加载，我们将从头注册一个新实例。然而，在生产中，我们希望显示一个警告，以更改我们的合同部署到的正确网络。</p><p id="53a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我知道这是一条漫长的道路，但在下一部分，我们将最终将智能合约连接到我们的应用程序。与我们已经做的相比，这实际上非常容易。</p><h1 id="7950" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">实例化我们的合同</h1><p id="2e09" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们将从编写代码开始，稍后我们将部署我们的合同并将ABI和地址插入到我们的应用程序中。我们几乎已经准备好创建我们期待已久的赌场组件，它具有以下功能:</p><ul class=""><li id="6700" class="mk ml iq jp b jq jr ju jv jy mm kc mn kg mo kk mp mq mr ms bi translated">我们需要一个输入字段，以便用户可以输入下注金额</li><li id="f5c7" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">我们需要按钮，代表要下注的数字，当用户点击一个数字时，他将在这个数字上下注他输入的金额。</li><li id="7a5c" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">点击函数将调用我们的智能合约上的bet()函数。</li><li id="a1ef" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">我们将显示一个装载微调器，以显示事务正在进行中</li><li id="9d8e" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">当交易完成后，我们将显示用户是否已经赢得和金额</li></ul><p id="6c08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们需要我们的应用程序能够与我们的智能合同对话。我们将采用与之前相同的方式处理此事。在<em class="km"> util </em>文件夹中创建一个名为<em class="km"> getContract.js </em>的新文件。</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="0aeb" class="nk li iq ng b gy nl nm l nn no">import Web3 from ‘web3’<br/>import {address, ABI} from ‘./constants/casinoContract’</span><span id="1dbf" class="nk li iq ng b gy np nm l nn no">let getContract = new Promise(function (resolve, reject) {<br/> let web3 = new Web3(window.web3.currentProvider)<br/> let casinoContract = web3.eth.contract(ABI)<br/> let casinoContractInstance = casinoContract.at(address)<br/> // casinoContractInstance = () =&gt; casinoContractInstance<br/> resolve(casinoContractInstance)<br/>})</span><span id="87b7" class="nk li iq ng b gy np nm l nn no">export default getContract</span></pre><p id="5534" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先要注意的是，我们正在导入一个尚不存在的文件，我们将在稍后部署合同时修复它。</p><p id="fbde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们通过将ABI(我们将在后面讨论)传入<em class="km"> web3.eth.contract() </em>，为可靠性契约创建一个契约对象。然后我们可以在一个地址初始化这个对象。正是在这种情况下，我们可以调用我们的方法和事件。</p><p id="42ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，如果没有动作和突变，这是不完整的。<br/>因此在<em class="km"> casino-component.vue </em>的脚本标签中添加以下内容。</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="2c8b" class="nk li iq ng b gy nl nm l nn no">export default {<br/> name: ‘casino’,<br/> mounted () {<br/> console.log(‘dispatching getContractInstance’)<br/> this.$store.dispatch(‘getContractInstance’)<br/> }<br/>}</span></pre><p id="39bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们在商店里的行动和变化。首先导入我们的<em class="km"> getContract.js </em>文件，我相信你现在已经知道怎么做了。然后在我们创造的行动中，呼唤它:</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="7609" class="nk li iq ng b gy nl nm l nn no">getContractInstance ({commit}) {<br/> getContract.then(result =&gt; {<br/> commit(‘registerContractInstance’, result)<br/> }).catch(e =&gt; console.log(e))<br/> }</span></pre><p id="dd41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将结果传递给我们的突变:</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="a199" class="nk li iq ng b gy nl nm l nn no">registerContractInstance (state, payload) {<br/> console.log(‘Casino contract instance: ‘, payload)<br/> state.contractInstance = () =&gt; payload<br/> }</span></pre><p id="213a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将把我们的契约实例存储在商店中，供我们在组件中使用。</p><h1 id="4a2f" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">与我们的合同互动</h1><p id="03fe" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">首先，我们将向赌场组件添加一个数据属性(在导出中),这样我们就可以拥有具有反应属性的变量。这些值将是winEvent、amount和pending。</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="c8c2" class="nk li iq ng b gy nl nm l nn no">data () {<br/> return {<br/> amount: null,<br/> pending: false,<br/> winEvent: null<br/> }<br/> }</span></pre><p id="4603" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将为用户点击一个数字创建onclick函数。这将触发我们契约上的<em class="km"> bet() </em>函数，显示微调器，当它接收到事件时隐藏微调器并显示事件参数。在data属性下添加一个名为methods的属性，该属性接受一个我们将在其中放置函数的对象。</p><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e61e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的<em class="km"> bet() </em>函数采用的第一个参数是我们在契约中定义的参数u number。<em class="km"> event.target. innerHTML </em>引用了我们接下来要创建的列表标签中的数字。然后是一个定义交易参数的对象，这是我们输入用户下注金额的地方。第三个参数是回调。一旦成功，我们将关注这一事件。</p><p id="fb8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将为组件创建html和css。复制粘贴就行了，我觉得不言自明。之后，我们将部署合同并获取ABI和地址。</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="b104" class="nk li iq ng b gy nl nm l nn no">&lt;template&gt;<br/> &lt;div class=”casino”&gt;<br/>   &lt;h1&gt;Welcome to the Casino&lt;/h1&gt;<br/>   &lt;h4&gt;Please pick a number between 1 and 10&lt;/h4&gt;<br/>   Amount to bet: &lt;input v-model=”amount” placeholder=”0 Ether”&gt;<br/>   &lt;ul&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;1&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;2&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;3&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;4&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;5&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;6&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;7&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;8&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;9&lt;/li&gt;<br/>     &lt;li v-on:click=”clickNumber”&gt;10&lt;/li&gt;<br/>  &lt;/ul&gt;<br/>  &lt;img v-if=”pending” id=”loader” src=”<a class="ae kl" href="https://loading.io/spinners/double-ring/lg.double-ring-spinner.gif" rel="noopener ugc nofollow" target="_blank">https://loading.io/spinners/double-ring/lg.double-ring-spinner.gif</a>”&gt;<br/>  &lt;div class=”event” v-if=”winEvent”&gt;<br/>    Won: {{ winEvent._status }}<br/>    Amount: {{ winEvent._amount }} Wei<br/>  &lt;/div&gt;<br/> &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="69d1" class="nk li iq ng b gy np nm l nn no">&lt;style scoped&gt;<br/>.casino {<br/> margin-top: 50px;<br/> text-align:center;<br/>}<br/>#loader {<br/> width:150px;<br/>}<br/>ul {<br/> margin: 25px;<br/> list-style-type: none;<br/> display: grid;<br/> grid-template-columns: repeat(5, 1fr);<br/> grid-column-gap:25px;<br/> grid-row-gap:25px;<br/>}<br/>li{<br/> padding: 20px;<br/> margin-right: 5px;<br/> border-radius: 50%;<br/> cursor: pointer;<br/> background-color:#fff;<br/> border: -2px solid #bf0d9b;<br/> color: #bf0d9b;<br/> box-shadow:3px 5px #bf0d9b;<br/>}<br/>li:hover{<br/> background-color:#bf0d9b;<br/> color:white;<br/> box-shadow:0px 0px #bf0d9b;<br/>}<br/>li:active{<br/> opacity: 0.7;<br/>}<br/>*{<br/> color: #444444;<br/>}<br/>&lt;/style&gt;</span></pre><h1 id="663d" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">Ropsten网络和元掩码(针对首次用户)</h1><p id="d77b" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">如果你不熟悉metamask或以太坊网络，不要担心。</p><ol class=""><li id="9507" class="mk ml iq jp b jq jr ju jv jy mm kc mn kg mo kk nq mq mr ms bi translated">打开你的浏览器和metamask插件。接受使用条款并创建密码。</li><li id="83a8" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk nq mq mr ms bi translated">将种子短语存储在安全的地方(这是为了在您丢失钱包时恢复钱包)</li><li id="d294" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk nq mq mr ms bi translated">点击“以太坊主网”，切换到Ropsten测试网。</li><li id="aa22" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk nq mq mr ms bi translated">点击“购买”，然后点击“Ropsten Testnet水龙头”。这是我们将得到一些免费测试醚的地方</li><li id="16d3" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk nq mq mr ms bi translated">在水龙头网站上，点击“从水龙头请求1乙醚”几次。</li></ol><p id="93c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当该说的都说了，该做的都做了，你的元掩码应该是这样的:</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b8257e3c9a60d467d156f4a1327ed056.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*IT3Lpfh2FiPSMEvVUl4ffA.png"/></div></figure><h1 id="d0a0" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">部署和连接</h1><p id="06e3" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">再次打开混音，我们的合同应该还在。如果不是，去<a class="ae kl" href="https://gist.github.com/anonymous/6b06bef626928589e3a53a70c021ec02" rel="noopener ugc nofollow" target="_blank">这个要点</a>复制粘贴。在remix的rop右侧，确保我们的环境设置为“Injected Web3 (ropsten)”，并选择我们的地址。</p><p id="7a9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">部署如<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/create-your-first-ethereum-dapp-with-web3-and-vue-js-c7221af1ed82">第一部分</a>所示。我们在value字段中输入两个Ethers来预加载契约，输入我们的构造函数参数，然后单击create。这一次元掩码将提示接受/拒绝事务(契约部署)。点击“接受”,等待交易完成。</p><p id="8349" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当TX完成后，点击它，这将带您到该TX的ropsten区块链浏览器。我们可以在“收件人”栏下找到合同地址。你的当然会不同，但看起来相似。</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi nt"><img src="../Images/b78072f4aaa637369e9b59500bd25fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_l_EVygtbwHgway4sxwOjQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">我们的合同地址在“收件人”栏中</figcaption></figure><p id="1d01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这给了我们地址，现在是ABI。回到混音，切换到“编译”标签(右上角)。在我们的合同名称旁边，我们会看到一个名为“详细信息”的按钮，单击它。第四个领域是我们的ABI。</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oc"><img src="../Images/6d549a02d0c724fc54021ec1e68a9dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gGPKAotB7qmUY70ZdZDDyA.png"/></div></div></figure><p id="9125" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">干得好，现在我们只需从上一节创建一个尚不存在的文件。所以在<em class="km"> util/constants </em>文件夹中创建一个名为<em class="km"> casinoContract.js </em>的新文件。创建两个变量，粘贴必要的内容并导出变量，这样我们上面的导入就可以访问它们。</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="67f9" class="nk li iq ng b gy nl nm l nn no">const address = ‘0x…………..’<br/>const ABI = […]<br/>export {address, ABI}</span></pre><h1 id="274d" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">惊人的工作！</h1><p id="ab78" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们现在可以通过在终端中运行<em class="km"> npm start </em>并在浏览器中转至<em class="km"> localhost:8080 </em>来测试我们的应用程序。输入一个金额，然后单击一个数字。Metamask将提示您接受事务，微调器将启动。30秒到1分钟后，我们得到第一次确认，因此事件也是如此。我们的余额改变了，所以pollweb3触发它的动作来更新余额:</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oc"><img src="../Images/3f051dcf63dea6e905150cbfa1b3248f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GvWC8YzcuzWBs8TdSphiQw.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">最终结果(左)和生命周期(右)</figcaption></figure><p id="14b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在这个系列赛中走到了这一步，我为你喝彩。我不是专业作家，所以有时阅读起来并不容易。我们应用程序的主干已经设置好了，我们只需要让它变得更加漂亮和用户友好。我们将在下一节中这样做，尽管这是完全可选的。</p><h1 id="12d7" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">眼睛想要它的一部分</h1><p id="1107" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们会很快过一遍。它只是一些html，css和带有v-if/v-else的vue-conditional。</p><p id="cd7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在App.vue </strong>中添加容器类到我们的div元素中，在我们的css中定义这个类:</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="e779" class="nk li iq ng b gy nl nm l nn no">.container {<br/> padding-right: 15px;<br/> padding-left: 15px;<br/> margin-right: auto;<br/> margin-left: auto;<br/>}<br/><a class="ae kl" href="http://twitter.com/media" rel="noopener ugc nofollow" target="_blank">@media</a> (min-width: 768px) {<br/> .container {<br/> width: 750px;<br/> }<br/>}</span></pre><p id="be6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在main.js中导入我们已经安装的字体库(我知道，这不是我们需要的两个图标的最佳方式):</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="2f00" class="nk li iq ng b gy nl nm l nn no">import ‘font-awesome/css/font-awesome.css’</span></pre><p id="9278" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在hello-metamask.vue中，我们将做一些改变。我们将在我们的<em class="km">计算的</em>属性中使用mapState帮助器，而不是当前函数。我们还将使用v-if来检查<em class="km">是否被注入</em>，并基于此显示不同的HTML。这是最终组件的样子:</p><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="78a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用相同的v-if/v-else方法来设计在casino-component.vue 中返回的事件的样式:</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="790f" class="nk li iq ng b gy nl nm l nn no">&lt;div class=”event” v-if=”winEvent”&gt;<br/> &lt;p v-if=”winEvent._status” id=”has-won”&gt;&lt;i aria-hidden=”true” class=”fa fa-check”&gt;&lt;/i&gt; Congragulations, you have won {{winEvent._amount}} wei&lt;/p&gt;<br/> &lt;p v-else id=”has-lost”&gt;&lt;i aria-hidden=”true” class=”fa fa-check”&gt;&lt;/i&gt; Sorry you lost, please try again.&lt;/p&gt;<br/> &lt;/div&gt;</span><span id="f99f" class="nk li iq ng b gy np nm l nn no">#has-won {<br/>  color: green;<br/>}<br/>#has-lost {<br/>  color:red;<br/>}</span></pre><p id="6e60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，在我们的<em class="km"> clickNumber() </em>函数中，在<em class="km">this . winevent = result . args</em>下面添加一行:</p><pre class="my mz na nb gt nf ng nh ni aw nj bi"><span id="9eec" class="nk li iq ng b gy nl nm l nn no">this.winEvent._amount = parseInt(result.args._amount, 10)</span></pre><h1 id="540e" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">你已经到达终点了，祝贺你！</h1><p id="2836" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated"><strong class="jp ir">首先，项目的完整代码现在可以在主分支下找到:【https://github.com/kyriediculous/dapp-tutorial/tree/master】<a class="ae kl" href="https://github.com/kyriediculous/dapp-tutorial/tree/master" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/></a><strong class="jp ir">！</strong></strong></p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi od"><img src="../Images/d6ee95a510f6cf6da3fb9e3a7d551d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jb6ety7sf_MxbbAR30NIxQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">赌输后的最后申请:(。</figcaption></figure><p id="df60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的申请中仍然有一些注意事项。我们没有在任何地方正确处理错误，我们不需要所有的控制台日志语句，它不是一个非常漂亮的应用程序(我不是一个设计师)，等等。然而，这个应用程序做得很好。</p><p id="ff1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望本系列教程可以帮助您构建更多更好的分散式应用程序。我真诚地希望你能像我写作时一样喜欢阅读这篇文章。</p><p id="ae5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不是一个有20多年经验的软件工程师。因此，如果您有任何建议或改进，请随时留下您的评论。我喜欢学习新东西，尽我所能提高自己。谢了。</p><p id="cd7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更新:<a class="ae kl" href="https://github.com/kyriediculous/dapp-tutorial/commit/a07edf3182a3d6c7284e830f709d79b61a40ab0e" rel="noopener ugc nofollow" target="_blank">增加乙醚平衡显示</a></p><p id="0168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">如果你喜欢这个教程，请随时在twitter上关注我们，访问我们的网站或者留下你的建议！</strong></p><div class="kn ko gp gr kp kq"><a href="https://twitter.com/Alt_Strt" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab fo"><div class="ks ab kt cl cj ku"><h2 class="bd ir gy z fp kv fr fs kw fu fw ip bi translated">Alt Street (@Alt_Strt) | Twitter</h2><div class="kx l"><h3 class="bd b gy z fp kv fr fs kw fu fw dk translated">Alt街的最新推文(@Alt_Strt)。区块链是爱情，区块链是生命。我们开发概念证明，并…</h3></div><div class="ky l"><p class="bd b dl z fp kv fr fs kw fu fw dk translated">twitter.com</p></div></div><div class="kz l"><div class="oe l lb lc ld kz le lf kq"/></div></div></a></div><div class="kn ko gp gr kp kq"><a href="https://altstreet.io" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab fo"><div class="ks ab kt cl cj ku"><h2 class="bd ir gy z fp kv fr fs kw fu fw ip bi translated">Alt Street -区块链顾问</h2><div class="kx l"><h3 class="bd b gy z fp kv fr fs kw fu fw dk translated">区块链概念证明和代币销售</h3></div><div class="ky l"><p class="bd b dl z fp kv fr fs kw fu fw dk translated">altstreet.io</p></div></div><div class="kz l"><div class="of l lb lc ld kz le lf kq"/></div></div></a></div><p id="11de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">tip jar:ETH—</em>0x 6d 31 CB 338 b 5590 adafec 46462 a1 b 095 ebdc 37d 50</p></div></div>    
</body>
</html>
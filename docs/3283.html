<html>
<head>
<title>Powering up your OutSystems Applications — Part 1 — Integrating Web APIs to OutSystems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">启动您的外部系统应用程序—第1部分—将Web APIs集成到外部系统</h1>
<blockquote>原文：<a href="https://itnext.io/powering-up-your-outsystems-applications-part-1-integrating-web-apis-to-outsystems-c4c41125e7a?source=collection_archive---------5-----------------------#2019-11-13">https://itnext.io/powering-up-your-outsystems-applications-part-1-integrating-web-apis-to-outsystems-c4c41125e7a?source=collection_archive---------5-----------------------#2019-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/5bcab95e747819af91d3d05bcc801190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Suxz7DX_upaXtnMhqP3s_w.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">没必要那么难，让它变得愉快。</figcaption></figure><p id="8eee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我再次鼓励你们所有人尝试一下Javascript，改进你们的外部系统应用程序。所以，我们从简单的开始吧。</p><p id="2f16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你听说过Web APIs吗？你可能没有听说过，但是你可能已经使用过了。</p><p id="75b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">什么是Web APIs？</p><p id="d213" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Web APIs是Javascript中现成的功能。这意味着当你开发一个Javascript代码时，你可以使用许多可重用的库来加速你的开发。</p><p id="4967" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/API" rel="noopener ugc nofollow" target="_blank"> Mozilla的文档</a>中找到可用的内置Web APIs列表。</p><h1 id="0494" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">如何在您的外部系统应用程序中使用Web APIs？</h1><p id="76d5" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在本文中，作为在应用程序中使用Web APIs的一个例子，我将向您展示如何实现页面可见性API。</p><blockquote class="ma mb mc"><p id="c161" class="jy jz md ka b kb kc kd ke kf kg kh ki me kk kl km mf ko kp kq mg ks kt ku kv ij bi translated">页面可见性API提供了一些事件，您可以通过观察这些事件来了解文档何时变得可见或隐藏，还提供了查看页面当前可见性状态的功能。</p></blockquote><p id="093c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">页面可见性API有哪些用例？</p><p id="215a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，很多开发者抱怨谷歌Chrome消耗大量内存。让我告诉你，谷歌浏览器不是唯一的责任。</p><p id="aadd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">许多应用程序消耗大量内存，显示动画，运行ajax调用以保持数据最新，沉重的全局对象等等。如果你用这种应用程序保存5到10个标签，你会有内存问题。</p><p id="c8e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是页面可见性API帮助开发人员并改善用户体验的一个用例。通过使用页面可见性API，你可以在用户切换到另一个标签页并最小化窗口时触发，并停止那些繁重的任务。</p><p id="aa46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如何在OutSystems中实现页面可见性API？</strong></p><p id="dcf1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个例子中，我创建了一个新的传统web应用程序模块，并添加了一个名为“PageVisibility”的块。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/5081187a03acde8055bf92b6fc510f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyOtn2ky3_WOeluNYuCFZg.png"/></div></div></figure><p id="c282" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，我在WebBlock的Javascript属性中添加了以下代码:</p><pre class="mi mj mk ml gt mq mr ms mt aw mu bi"><span id="4589" class="mv ky iq mr b gy mw mx l my mz">document.addEventListener('visibilitychange', function () {<br/>    if (document.hidden) {<br/>        // the page has lost focus<br/>    } else {<br/>        // the page got focused<br/>    }<br/>});</span></pre><p id="f867" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这段代码向DOM添加了一个新的监听器，这个监听器叫做“visibilitychange”。定义触发器后，您可以指定侦听器在被触发时应该执行什么操作。</p><p id="91ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个例子中，我检查页面是否隐藏。在页面可见性API中，您可以访问两个属性:</p><ul class=""><li id="890e" class="na nb iq ka b kb kc kf kg kj nc kn nd kr ne kv nf ng nh ni bi translated">Document.hidden(布尔值)</li><li id="06ab" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated">Document.visibilityState(四个可能的值:可见、隐藏、预呈现或卸载)</li></ul><p id="7f7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于这个演示，我还创建了一个Web屏幕，其中包含两个容器，分别表示以下内容。</p><pre class="mi mj mk ml gt mq mr ms mt aw mu bi"><span id="ea11" class="mv ky iq mr b gy mw mx l my mz">&lt;video id=”videoElement” style=”width:400px;”&gt;<br/>&lt;source id=”SourceTag” src=”https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-576p.mp4" type=”video/mp4"&gt;<br/>&lt;/video&gt;</span></pre><p id="756b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是你如何把它翻译成外部系统:</p><ul class=""><li id="2838" class="na nb iq ka b kb kc kf kg kj nc kn nd kr ne kv nf ng nh ni bi translated">视频标签</li></ul><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi no"><img src="../Images/f73f669125a8fbb5cae54300ff998f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrLYfKK9olszLVmO6il35w.png"/></div></div></figure><ul class=""><li id="878a" class="na nb iq ka b kb kc kf kg kj nc kn nd kr ne kv nf ng nh ni bi translated">视频标签内的源标签:</li></ul><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi np"><img src="../Images/cd3918aee7d54670c25d45864df75a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-uE21WzroEEhkRz2rj55hQ.png"/></div></div></figure><p id="d950" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于OSTagName扩展属性，这是可能的。您可以在<a class="ae kw" href="https://success.outsystems.com/Documentation/Development_FAQs/How_to_generate_HTML_tags" rel="noopener ugc nofollow" target="_blank">文档</a>中找到关于该属性的更多信息。它看起来比包含HTML代码的表达式要好。</p><p id="fad6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在您需要定义当它被触发时您的侦听器应该做什么。让它根据当前窗口的可见性播放或暂停视频的代码应该是这样的:</p><pre class="mi mj mk ml gt mq mr ms mt aw mu bi"><span id="57b7" class="mv ky iq mr b gy mw mx l my mz">function handleVisibilityChange() {<br/>var videoElement = document.getElementsByClassName("videoElement")[0];<br/>  if (document["hidden"]) {<br/>    videoElement.pause();<br/>    document.title = "Paused";<br/>  } else {<br/>    videoElement.play();<br/>    document.title = "Playing";</span><span id="b9a4" class="mv ky iq mr b gy nq mx l my mz">}<br/>}</span><span id="9842" class="mv ky iq mr b gy nq mx l my mz">document.addEventListener('visibilitychange', function () {<br/>    handleVisibilityChange();    <br/>});</span></pre><p id="d49b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，首先，这段代码根据我们给它的类名获取DOM中的video元素。然后检查它的隐藏属性。</p><p id="c09d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果页面是隐藏的，它调用视频元素的函数pause否则，页面是活动的，它将播放视频。</p><p id="ce04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它还会更改标签的标题，以便在视频暂停或播放时更容易看到。</p><p id="596c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在WebBlock中插入此代码后，它看起来是这样的:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nr"><img src="../Images/6a26219e9197c65b6b7e74a36379f304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1jev75hOCfTcr4X8ipeag.png"/></div></div></figure><p id="5575" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们有了一个工作的Javascript代码，我们可以将Web块拖到屏幕上，就在我们已经插入的标签之后，然后发布您的模块。<br/>最后，你可以测试应用程序，当你播放视频并切换到另一个标签时，视频会暂停。</p><p id="e8c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个简单的例子，说明如何通过添加一些很酷且容易实现的东西来改进您的外部系统应用程序。</p></div></div>    
</body>
</html>
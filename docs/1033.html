<html>
<head>
<title>Working with Angular 2+ Form: Reactive Forms Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用角度2+形式:反应形式方法</h1>
<blockquote>原文：<a href="https://itnext.io/working-with-angular-2-form-reactive-forms-approach-37e19a3af995?source=collection_archive---------4-----------------------#2018-07-09">https://itnext.io/working-with-angular-2-form-reactive-forms-approach-37e19a3af995?source=collection_archive---------4-----------------------#2018-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2aa5be02bab70bd2f7cfab3783eefea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMGBn-NGcKCzGI3z1s7vDg.png"/></div></div></figure><p id="2429" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上一篇文章中，我向你介绍了在Angular中使用表单时的<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/working-with-angular-2-form-template-driven-approach-58182fc73150">模板驱动方法</a>。使用模板驱动方法的优点是它易于使用并且适合简单的场景。然而，对于更加灵活和复杂的情况，您可能希望实现反应式表单方法，以便通过您的组件对表单进行更多的控制。</p><p id="7aae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于这个示例项目，您可以在https://next.plnkr.co/plunk/x47O6Cc4vJUnUEo8<a class="ae kw" href="https://next.plnkr.co/plunk/x47O6Cc4vJUnUEo8" rel="noopener ugc nofollow" target="_blank">的</a>处看到演示</p><p id="54c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要一个有角度的项目。您可以通过创建新项目或使用现有的Angular项目来实现这一点。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="7e05" class="lg lh iq lc b gy li lj l lk ll">// Create a new project through angular cli<br/>sudo npm install -g @angular/cli@latest<br/>ng new Project_Name</span></pre><ol class=""><li id="0bf7" class="lm ln iq ka b kb kc kf kg kj lo kn lp kr lq kv lr ls lt lu bi translated"><strong class="ka ir">进口反应式模块</strong></li></ol><p id="67aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，您需要将<strong class="ka ir"> ReactiveFormsModule </strong>导入到您的<strong class="ka ir"> app.module.ts </strong>中</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="972f" class="lg lh iq lc b gy li lj l lk ll">import { <strong class="lc ir">FormsModule </strong>} from '@angular/forms';<br/>...</span><span id="7f52" class="lg lh iq lc b gy lv lj l lk ll">@NgModule({<br/>  declarations: [...],<br/>  imports: [<br/>    ...<br/>    <strong class="lc ir">ReactiveFormsModule</strong><br/>  ],<br/>})</span></pre><p id="990d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.<strong class="ka ir">添加您的表单</strong></p><p id="3faf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么您的模板中应该有一个表单:</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="17a9" class="lg lh iq lc b gy li lj l lk ll">&lt;form&gt;<br/> First name: <br/> &lt;input <br/>   type="text"<br/>   name="firstName"&gt;&lt;br&gt;</span><span id="6462" class="lg lh iq lc b gy lv lj l lk ll">Last name: <br/> &lt;input <br/>   type="text" <br/>   name="lastName"&gt;&lt;br&gt;</span><span id="468d" class="lg lh iq lc b gy lv lj l lk ll">Age:<br/> &lt;input <br/>   type="number" <br/>   name="age"&gt;&lt;br&gt;</span><span id="49a8" class="lg lh iq lc b gy lv lj l lk ll">&lt;input type="submit" value="Submit"&gt;<br/>&lt;/form&gt;</span></pre><p id="5baa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这只是一个简单的表格，收集你的名字，姓氏和年龄。</p><p id="7ad9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以随意设置样式，也可以使用这个临时CSS</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="79c6" class="lg lh iq lc b gy li lj l lk ll">input[type=text], input[type=number], select {<br/>    width: 100%;<br/>    padding: 12px 20px;<br/>    margin: 8px 0;<br/>    display: inline-block;<br/>    border: 1px solid #ccc;<br/>    border-radius: 4px;<br/>    box-sizing: border-box;<br/>}</span><span id="5511" class="lg lh iq lc b gy lv lj l lk ll">input[type=submit] {<br/>    width: 100%;<br/>    background-color: #4CAF50;<br/>    color: white;<br/>    padding: 14px 20px;<br/>    margin: 8px 0;<br/>    border: none;<br/>    border-radius: 4px;<br/>    cursor: pointer;<br/>}</span><span id="66db" class="lg lh iq lc b gy lv lj l lk ll">input[type=submit]:hover {<br/>    background-color: #45a049;<br/>}</span><span id="012e" class="lg lh iq lc b gy lv lj l lk ll">input[disabled][type=submit] {<br/>    background:grey;<br/>}</span><span id="17d8" class="lg lh iq lc b gy lv lj l lk ll">div {<br/>    border-radius: 5px;<br/>    background-color: #f2f2f2;<br/>    padding: 20px;<br/>}</span></pre><p id="07aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 3。</strong> <strong class="ka ir">应用反应式表单方法</strong></p><p id="b205" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将从组件内部声明我们的</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="5ef8" class="lg lh iq lc b gy li lj l lk ll">import { FormGroup, FormControl } from '<a class="ae kw" href="http://twitter.com/angular/forms" rel="noopener ugc nofollow" target="_blank">@angular/forms</a>';</span><span id="8e85" class="lg lh iq lc b gy lv lj l lk ll">export class App {</span><span id="bcae" class="lg lh iq lc b gy lv lj l lk ll">  contactForm: FormGroup;<br/>  constructor() {<br/>    this.contactForm = new FormGroup({<br/>      'firstName': new FormControl(''),<br/>      'lastName': new FormControl(''),<br/>      'age': new FormControl(''),<br/>    })<br/>  }<br/>  <br/>}</span></pre><p id="4287" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，我们将联系表单映射到我们的模板。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="3794" class="lg lh iq lc b gy li lj l lk ll">&lt;form <strong class="lc ir">[formGroup]="contactForm"</strong>&gt;<br/> First name: <br/> &lt;input <br/>   type="text" <br/>   name="firstName"<br/>   <strong class="lc ir">formControlName="firstName"</strong>&gt;&lt;br&gt;</span><span id="df5a" class="lg lh iq lc b gy lv lj l lk ll"> Last name: <br/> &lt;input <br/>   type="text" <br/>   name="lastName"<br/>   <strong class="lc ir">formControlName="lastName"</strong>&gt;&lt;br&gt;<br/> <br/> Age:<br/> &lt;input <br/>   type="number" <br/>   name="age" <br/>   <strong class="lc ir">formControlName="age"</strong>&gt;&lt;br&gt;<br/> &lt;input <br/>   type="submit" <br/>   value="Submit"&gt;<br/>&lt;/form&gt;</span></pre><p id="4eae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 4。控制表单提交</strong></p><p id="995a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要组件中的一个函数来控制表单提交。表单值可以通过<strong class="ka ir"> this.contactForm.value </strong>访问。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="bcfa" class="lg lh iq lc b gy li lj l lk ll">onSubmit() {    <br/> console.log(this.contactForm.value)<br/> // POST request or whatever<br/>}</span></pre><p id="48c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在你的模板里面</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="efca" class="lg lh iq lc b gy li lj l lk ll">&lt;form <strong class="lc ir">(ngSubmit)="onSubmit()"</strong> [formGroup]="contactForm"&gt;</span></pre><p id="2b6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 5。添加一些验证</strong></p><p id="3864" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所有的验证都可以在组件内部完成。例如，这会将<strong class="ka ir">所需的</strong>规则添加到所有输入中。你可以从<a class="ae kw" href="https://angular.io/api/forms/Validators" rel="noopener ugc nofollow" target="_blank"> Angular.io </a>中了解其他类型的验证器</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="093a" class="lg lh iq lc b gy li lj l lk ll">import { FormGroup, FormControl, <strong class="lc ir">Validators </strong>} from '@angular/forms';</span><span id="08c4" class="lg lh iq lc b gy lv lj l lk ll">...</span><span id="57e1" class="lg lh iq lc b gy lv lj l lk ll">constructor() {<br/> this.contactForm = new FormGroup({<br/>   'firstName': new FormControl('',  <strong class="lc ir">[Validators.required]</strong>),<br/>   'lastName': new FormControl('',  <strong class="lc ir">[Validators.required]</strong>),<br/>   'age': new FormControl('',  <strong class="lc ir">[Validators.required]</strong>),<br/> })<br/>}</span></pre><p id="6942" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，如果用户没有填写所有的输入，表单将是无效的。通过检查有效性，您可以更好地控制表单。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="d770" class="lg lh iq lc b gy li lj l lk ll">&lt;input <br/>  type="submit" <br/>  value="Submit" <br/>  <strong class="lc ir">[disabled]="!contactForm.valid"</strong>&gt;</span></pre><p id="9682" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果表单无效，提交按钮将被禁用。</p><p id="302f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从现在开始，您知道了如何创建一个反应式表单，并能够向它添加一些验证。</p></div></div>    
</body>
</html>
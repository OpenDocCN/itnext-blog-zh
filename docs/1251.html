<html>
<head>
<title>Dynamic App Themes with CSS Variables and JavaScript 🎨</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有CSS变量和JavaScript的动态应用程序主题🎨</h1>
<blockquote>原文：<a href="https://itnext.io/css-variables-dynamic-app-themes-86c0db61cbbb?source=collection_archive---------1-----------------------#2018-08-22">https://itnext.io/css-variables-dynamic-app-themes-86c0db61cbbb?source=collection_archive---------1-----------------------#2018-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f246e3b1712ff127ba22198851bcf96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZ4wAfvhrQpuzvM-pZkkmg.jpeg"/></div></div></figure><figure class="jy jz ka kb gt jr"><div class="bz fp l di"><div class="kc kd l"/></div></figure><p id="f2df" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你好。在这篇文章中，我想讨论我在web应用程序中创建动态主题加载器的方法。我会讲一点关于react，create-react-app，portals，sass，css变量和其他有趣的东西。如果你对此感兴趣，请继续阅读！</p><p id="33a3" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我正在开发的应用程序是一个音乐应用程序，是Spotify的迷你克隆。客户端代码用create-react-app 引导。我用<a class="ae lc" href="https://github.com/michaelwayman/node-sass-chokidar" rel="noopener ugc nofollow" target="_blank"> node-sass-chokidar </a>为CRA设置添加了sass支持。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ld"><img src="../Images/494fcd2fe06c65bf99b964eefc0afd49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eONilVt2-KF6bpIu9OxhzQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">sass集成</figcaption></figure><p id="1702" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">将sass添加到CRA设置中并不太困难。我只需要安装<code class="fe li lj lk ll b">node-sass-chokidar</code>并在package.json文件中添加几个脚本，告诉它如何构建sass文件，并在开发过程中观察它们的重新编译。<code class="fe li lj lk ll b">include-path</code>标志是让它知道在哪里寻找通过<code class="fe li lj lk ll b">@import</code>导入sass文件的文件。选项的完整列表在<a class="ae lc" href="https://github.com/michaelwayman/node-sass-chokidar#options" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="a14b" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">随着sass集成的加入，我做的下一件事是开始定义一个颜色列表，这将是应用程序的基础模板。它不必是一个详尽的列表，只是基本模板所需的最少颜色。接下来，我定义了应用程序中使用颜色的部分，并给它们起了描述性的名字。有了这些变量，就可以将它们应用于应用程序的各个组件，这些组件将定义应用程序的主题。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/6f321da9737c360ba24d629fcdae0ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*4J5_zY1pkslb8GWLgpVdmA.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">sass颜色变量</figcaption></figure><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/e1bbda7e2467efc7bb3fee4764d5b322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBXgZI-3qWHiW2k8IeoJhA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">sass主题变量</figcaption></figure><p id="44b1" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在这里你可以看到我已经定义了一组基本的颜色变量，并将它们应用到默认的sass主题变量中。这些主题变量将在整个代码库的样式表中使用，以将调色板应用于应用程序并赋予其生命！</p><p id="b85f" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">接下来，我需要一种方法来轻松地动态更新这些变量。这就是CSS变量发挥作用的地方。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lo"><img src="../Images/5503a67f52c23e451772db4785eaff6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SgLF0GFzpFXgPZZrZkbgQg.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">CSS变量浏览器支持</figcaption></figure><p id="ce54" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">CSS变量是较新的浏览器规范。它非常接近100%的浏览器支持。考虑到这一点，我正在构建的应用程序是一个原型，所以我不太担心在这里支持旧浏览器。也就是说，有些人已经为IE 推出了一些<a class="ae lc" href="https://github.com/luwes/css-var-shim" rel="noopener ugc nofollow" target="_blank">垫片。</a></p><p id="5ef9" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对于我的用例，我需要将SASS变量同步到CSS变量。为此，我选择使用<a class="ae lc" href="https://github.com/malyw/css-vars" rel="noopener ugc nofollow" target="_blank"> css-vars </a>包。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/8248e810073c9792cce161ce1b94a5d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--j_jmZ8p1-2awwqDQleVw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">CSS-var</figcaption></figure><p id="a638" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我基本上为我的应用程序做了同样的事情，如上面的<code class="fe li lj lk ll b">README</code> …</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/9b14216ea5a1ad56082c61854fd0c6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IzkhVzxv991uNSMBBYK1Yg.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">用SASS添加CSS变量支持</figcaption></figure><p id="897d" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有了这个，我就可以在我的样式表中使用CSS变量，而不是SASS变量。上面重要的一行是<code class="fe li lj lk ll b">$css-vars-use-native: true;</code>，它告诉<code class="fe li lj lk ll b">css-vars</code>包编译后的CSS应该编译成实际的CSS变量。这对于以后需要动态更新它们是很重要的。</p><p id="9754" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下一步是给应用程序添加一个“主题选择器”。为此，我想找点乐子，选择添加一个隐藏菜单。这给了它一点复活节彩蛋的感觉，只是让它更有趣。我不太担心这个UX是否合适——将来我可能会把它移出来，让它更显眼。但现在，让我们为应用程序添加一个秘密菜单，当用户按下键盘上的某个组合键时，就会显示该菜单。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/c4247808244a0bf1aa613e2c462d66a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0z13r6yik2WcRMiNoWHl8g.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">模态容器</figcaption></figure><p id="2167" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这个容器将监听组合键<code class="fe li lj lk ll b">CTRL + E</code>，当它听到组合键时，它将显示隐藏的菜单模式。这里的<code class="fe li lj lk ll b">Modal</code>组件是一个react门户…</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ls"><img src="../Images/d2ffdebc732d94ef8c9dfa28bd823c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3xwDmwtLh7xtP1hRyldGw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">模态门户</figcaption></figure><p id="04bb" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">它将自己与<code class="fe li lj lk ll b">modal-root</code>页面元素连接和分离。有了这个，我可以创建包含选择菜单的<code class="fe li lj lk ll b">Theme</code>组件来选择各种不同的主题调色板。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/b4eeba4883f7be7626f2478b12db646f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eozcDZ0mLiymtSeRlsxDLQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">主题组件</figcaption></figure><p id="6897" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这里，我导入了一个调色板列表，其中的颜色变量与我们之前定义的变量相匹配。选择后，它将在应用程序状态中全局设置主题，然后它将调用<code class="fe li lj lk ll b">updateThemeForStyle</code>，这是一个使用JavaScript更新CSS变量的函数。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/180c64424054a1c8ddfae6261f101c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DZ7v0KtJ41HtF7dvhEz0fQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">更新CSS变量</figcaption></figure><p id="e686" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">该函数获取所选主题的名称，在<code class="fe li lj lk ll b">themeOptions</code>中找到主题调色板，然后为每个属性更新<code class="fe li lj lk ll b">html</code>元素的<code class="fe li lj lk ll b">style</code>属性。</p><p id="cebd" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">主题选项只是一个选项列表，其中的变量与为CSS变量定义的变量相同。</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/47ea5e7fd666a8091bd76dabb923e4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*-FaRopFYzpFdf7bjX7Xv8g.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">主题选项</figcaption></figure><p id="643f" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有了这些，主题选择器现在可以动态更新了！</p><figure class="jy jz ka kb gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/cb75a768503fd658e195163077b36cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/1*crV1ujG7TsYXjB3LRbgGdw.gif"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">主题选择</figcaption></figure><p id="3b1b" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这就是结果，动态主题更新！</p><p id="f9b6" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这是我添加特性的<a class="ae lc" href="https://github.com/mjw56/wavves/commit/7fd2210c69617c33c4244d4755f1d33770d3c57d" rel="noopener ugc nofollow" target="_blank">提交</a>。完整的代码库是<a class="ae lc" href="https://github.com/mjw56/wavves" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><p id="ba3d" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你可以在这里试用这个应用的工作版本<a class="ae lc" href="https://wavves-nxnczahctp.now.sh" rel="noopener ugc nofollow" target="_blank">。(需要spotify高级会员资格)。是的，如果你在应用程序中按下<code class="fe li lj lk ll b">CTRL + e</code>，隐藏的主题模式将会显示！😄</a></p><p id="e39e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">感谢您的阅读和快乐的黑客！</p></div></div>    
</body>
</html>
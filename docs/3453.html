<html>
<head>
<title>Hitchhiker’s Guide to the C# scripting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C#脚本的搭便车指南</h1>
<blockquote>原文：<a href="https://itnext.io/hitchhikers-guide-to-the-c-scripting-13e45f753af9?source=collection_archive---------0-----------------------#2019-12-19">https://itnext.io/hitchhikers-guide-to-the-c-scripting-13e45f753af9?source=collection_archive---------0-----------------------#2019-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="52ff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们知道C#是一种编程语言，但是我们已经有几年没有用我们喜爱的语言CSharp编写脚本了！让我们开始旅程吧。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/e8fc4406503b6138a34eab1517ec7c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*wpbWKS2YSYt-tsGiliKUPQ.jpeg"/></div></figure></div><div class="ab cl kq kr hx ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="im in io ip iq"><h1 id="b66f" class="kx ky it bd kz la lb lc ld le lf lg lh jz li ka lj kc lk kd ll kf lm kg ln lo bi translated">背景</h1><blockquote class="lp lq lr"><p id="5f7b" class="ls lt lu lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">C#脚本被引入到。NET社区与罗斯林CTP早在2011年10月。C#脚本背后的主要思想是允许在运行时动态评估代码。虽然过去有其他技术允许这样做(反射。Emit、CodeDOM等。)，Roslyn通过引入脚本将这一概念推向了新的高度——使用的不是常规的严格C#，而是C#语言语义的宽松版本。</p><p id="bab8" class="ls lt lu lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">参考:<br/><a class="ae mp" href="https://blogs.msdn.microsoft.com/cdndevs/2015/12/01/adding-c-scripting-to-your-development-arsenal-part-1/" rel="noopener ugc nofollow" target="_blank">https://blogs . msdn . Microsoft . com/cdn devs/2015/12/01/adding-c-scripting-to-your-development-阿森纳-part-1/ </a></p></blockquote><p id="0bc4" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">你用C# 写脚本了吗？有些人可能不同意用C#编写脚本，因为还有其他面向脚本的工具，比如bash、power-shell，有时还有Python。</p><p id="a245" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated"><strong class="lv iu">然而，</strong></p><p id="b745" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">想象一下，你有一些在后台运行良好的库或代码，你需要写一些脚本来自动化大量的工作。为此，您不必学习PowerShell或任何其他脚本语言！</p><ul class=""><li id="e682" class="mt mu it lv b lw lx lz ma mq mv mr mw ms mx mo my mz na nb bi translated">✔与所有好的图书馆合作。JSON、安全性和所有程序集)</li><li id="b6a7" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo my mz na nb bi translated">✔你不需要学习一门新的语言</li><li id="8d90" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo my mz na nb bi translated">✔跨平台(Mac，Linux，Windows，Raspberry Pi …)</li></ul></div><div class="ab cl kq kr hx ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="im in io ip iq"><h1 id="e820" class="kx ky it bd kz la lb lc ld le lf lg lh jz li ka lj kc lk kd ll kf lm kg ln lo bi translated">C#脚本编写入门</h1><p id="24c5" class="pw-post-body-paragraph ls lt it lv b lw nh ju ly lz ni jx mb mq nj me mf mr nk mi mj ms nl mm mn mo im bi translated">在CSharp中编写脚本没什么大不了的；这与您每天在强健的应用程序中使用的<code class="fe nm nn no np b">C#</code>相同。</p><h2 id="2e1d" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">C#脚本文件的结构</h2><ol class=""><li id="f61c" class="mt mu it lv b lw nh lz ni mq oc mr od ms oe mo of mz na nb bi translated">C#脚本文件只是扩展名为<code class="fe nm nn no np b">.csx</code>的纯文本文件</li><li id="4e81" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo of mz na nb bi translated">使用<code class="fe nm nn no np b">#r "path of a DLL assembly"</code>预处理器指令，你可以将每个DLL引用到脚本中</li><li id="5fd4" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo of mz na nb bi translated">从实现类到使用命名空间，每个C#代码都在文件内部工作</li></ol><p id="68ea" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">下面是一个简单的CRX文件的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="56fc" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">只需浏览一下代码，就可以看到你可以做任何事情！</p><p id="6c31" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">不过是<code class="fe nm nn no np b">csx</code>档。你打算如何执行它？要编写脚本，你需要一个特定的工具。有几个这样的例子:</p><ul class=""><li id="3a59" class="mt mu it lv b lw lx lz ma mq mv mr mw ms mx mo my mz na nb bi translated"><strong class="lv iu">罗斯林Mono CSI </strong>(如果你安装了Visual Studio或Mono SDK，你的操作系统上就会有)</li><li id="29a7" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo my mz na nb bi translated"><a class="ae mp" href="https://github.com/filipw/dotnet-script" rel="noopener ugc nofollow" target="_blank"> <strong class="lv iu">点网-脚本</strong> </a>全局点网工具</li><li id="1d10" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo my mz na nb bi translated"><a class="ae mp" href="https://www.cs-script.net/" rel="noopener ugc nofollow" target="_blank"><strong class="lv iu"/></a></li></ul><p id="a807" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">我将解释我上面提到的所有工具，最后，我们将对它们进行比较。</p><h2 id="05c9" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">使用Mono/Roslyn CSI运行脚本</h2><p id="ccbf" class="pw-post-body-paragraph ls lt it lv b lw nh ju ly lz ni jx mb mq nj me mf mr nk mi mj ms nl mm mn mo im bi translated">我已经在我的操作系统上安装了<strong class="lv iu"> Mono SDK </strong>，所以我可以通过命令行直接访问<code class="fe nm nn no np b">csi.exe</code>！您可以使用所在的<strong class="lv iu">或<strong class="lv iu">所在的</strong>命令<strong class="lv iu">来检查它是否在路径上。</strong></strong></p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="9736" class="nq ky it np b gy om on l oo op">C:\&gt;where csi<br/>C:\Program Files\Mono\bin\csi<br/>C:\Program Files\Mono\bin\csi.bat</span></pre><p id="6ae2" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">CSI命令的第一个参数是<code class="fe nm nn no np b">csx</code>文件。</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="7587" class="nq ky it np b gy om on l oo op">&gt; csi sample-job1.csx</span><span id="1f53" class="nq ky it np b gy oq on l oo op">Hello World!<br/>Hello World, This file is created at 19/12/2019 11:40:37</span></pre><p id="e451" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">因为它在解释器模式下运行文件，所以需要一秒钟。现在让我们引用一些汇编到CSX文件中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="02c9" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">我下载了<strong class="lv iu"> Newtonsoft的<code class="fe nm nn no np b">Assembly dll</code>。并把它放在我的CSX文件旁边。</strong></p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="ac79" class="nq ky it np b gy om on l oo op">&gt; csi sample-job2.csx</span><span id="37dd" class="nq ky it np b gy oq on l oo op">{"Id":"5611f423-9819-4f02-887e-4d39e9a9b0b8","Name":"FooBar","Enabled":true}</span></pre><p id="3df6" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">我用的是<strong class="lv iu"> JsonConvert。序列化虚拟对象的SerializeObject </strong>方法。</p><p id="3b67" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">💡<em class="lu">如果你只是打开</em> <code class="fe nm nn no np b"><em class="lu">csi</em></code> <em class="lu"> app，它会在终端执行repl，你可以逐行执行C#代码。</em></p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="5ee0" class="nq ky it np b gy om on l oo op">C:\&gt;csi<br/>Microsoft (R) Visual C# Interactive Compiler version 3.3.1-beta4-19462-11 ()<br/>Copyright (C) Microsoft Corporation. All rights reserved.</span><span id="3423" class="nq ky it np b gy oq on l oo op">Type "#help" for more information.<br/>&gt; var message= "Hello World";<br/>&gt; Console.WriteLine(message);<br/>Hello World<br/>&gt;</span></pre><h2 id="f156" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">参考NuGet包怎么样？</h2><p id="816a" class="pw-post-body-paragraph ls lt it lv b lw nh ju ly lz ni jx mb mq nj me mf mr nk mi mj ms nl mm mn mo im bi translated">可惜CSI不支持NuGet。因此，您必须手动下载DLL程序集并将其放在脚本旁边。但是正如我已经提到的，还有其他工具也支持NuGet。</p><p id="3148" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">📒<em class="lu">确保你的平台上安装了</em><a class="ae mp" href="https://dotnet.microsoft.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lv iu"><em class="lu">dotnet runtime/SDK</em></strong><em class="lu"/></a><em class="lu">。</em></p><h2 id="3a6f" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">dot net-脚本全局工具</h2><p id="3feb" class="pw-post-body-paragraph ls lt it lv b lw nh ju ly lz ni jx mb mq nj me mf mr nk mi mj ms nl mm mn mo im bi translated">关于<strong class="lv iu"> dotnet core CLI </strong>最好的事情之一是它的全球工具。你可以在这里读到它们<a class="ae mp" href="https://docs.microsoft.com/en-us/dotnet/core/tools/global-tools" rel="noopener ugc nofollow" target="_blank">。简而言之，它们只是一个包含控制台应用程序的特殊NuGet包。全局工具可以安装在计算机上PATH环境变量中包含的默认位置或自定义位置。</a></p><p id="6deb" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">该工具可以这样安装:</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="2272" class="nq ky it np b gy om on l oo op">&gt; dotnet tool install -g dotnet-script</span><span id="7a37" class="nq ky it np b gy oq on l oo op">You can invoke the tool using the following command: dotnet-script<br/>Tool 'dotnet-script' (version '0.50.1') was successfully installed.</span></pre><p id="6840" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated"><strong class="lv iu"> dotnet-script工具</strong>内置了NuGet支持！所以您可以很容易地使用这个指令来引用您喜欢的任何NuGet包。</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="6988" class="nq ky it np b gy om on l oo op">#r “nuget: PackageId, version”</span><span id="78f8" class="nq ky it np b gy oq on l oo op">// for e.g:<br/>// #r “nuget: Newtonsoft.Json, 12.0.3”</span></pre><p id="355b" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">请确保您设置了版本，因为<strong class="lv iu"> dotnet-script </strong>将为下次执行缓存包，这将使脚本运行得更快！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="62ec" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">第一次启动有点慢，因为它要下载NuGet包及其依赖项！</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="3db4" class="nq ky it np b gy om on l oo op">&gt; dotnet script sample-job3.csx</span><span id="a431" class="nq ky it np b gy oq on l oo op">{"Id":"5f14b3be-d634-414d-95e2-b015fda6d383","Name":"FooBar","Enabled":true}</span></pre><p id="a06c" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">结果还是一样的吧？</p><p id="88e1" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">dotnet-script的一个很大的优点就是搭建了一个框架，可以帮助你为你的脚本创建一个文件夹，并为你心爱的VSCode设置启动设置！</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="cbc2" class="nq ky it np b gy om on l oo op">&gt; dotnet-script init</span><span id="46a9" class="nq ky it np b gy oq on l oo op">Creating VS Code launch configuration file<br/>...'\path\.vscode\launch.json' [Created]<br/>Creating OmniSharp configuration file<br/>...'\path\omnisharp.json' [Created]<br/>Creating default script file 'main.csx'<br/>Creating 'main.csx'<br/>...'\path\main.csx' [Created]</span></pre><p id="8d78" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">通过这种配置，您可以在VSCode中运行和调试您的代码！</p><h2 id="4469" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">Script-CS-使用简单的文本编辑器轻松编写和执行C#。</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/a6fc6086fd6148a57084ffd2f940cf3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*bhfFk1GmMYgSiHdG1Y7mDA.png"/></div></figure><p id="8a01" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">与<code class="fe nm nn no np b">dotnet-script</code>和<code class="fe nm nn no np b">CSI</code>相比，Script-CS有点不同。安装它的唯一方法是通过Chocolaty，这是一个windows软件包安装程序。</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="c78e" class="nq ky it np b gy om on l oo op"># install it with chocolaty</span><span id="e0e0" class="nq ky it np b gy oq on l oo op">cinst scriptcs</span></pre><p id="2b1b" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">安装后，您可以访问CMD中的<strong class="lv iu">脚本</strong>命令。通过在cmd中键入<code class="fe nm nn no np b">scripts</code>,将运行<strong class="lv iu"> scriptcs-repl </strong>,这允许您逐行输入C#代码:</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="68f6" class="nq ky it np b gy om on l oo op">C:\&gt;scriptcs<br/>Moving directory '.cache' to '.scriptcs_cache'...<br/>scriptcs (ctrl-c to exit or :help for help)</span><span id="7b23" class="nq ky it np b gy oq on l oo op">&gt; var message = "Hello World";<br/>&gt; Console.WriteLine(message);<br/>Hello World<br/>&gt;</span></pre><p id="c733" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">对于安装NuGet包，可以使用<code class="fe nm nn no np b"><strong class="lv iu">-install</strong></code>参数。<strong class="lv iu">这应该在您的脚本文件夹中执行。</strong></p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="be51" class="nq ky it np b gy om on l oo op">C:\&gt;scriptcs -install Newtonsoft.Json</span><span id="079c" class="nq ky it np b gy oq on l oo op">Installing packages...<br/>Installed: Newtonsoft.Json<br/>Package installation succeeded.<br/>Saving packages in scriptcs_packages.config...<br/>Creating scriptcs_packages.config...<br/>Added Newtonsoft.Json (v9.0.1, .NET 4.5) to scriptcs_packages.config<br/>Successfully updated scriptcs_packages.config.</span></pre><p id="b13f" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">用ScriptCs编写代码与其他代码没有什么不同，下面是一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="2f23" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">并像这样执行它:</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="1ad0" class="nq ky it np b gy om on l oo op">C:\&gt;scriptcs sample-job2.csx</span><span id="0bd6" class="nq ky it np b gy oq on l oo op">{"Id":"e3a9d76e-d558-46d1-8d1a-b831c8013e16","Name":"FooBar","Enabled":true}</span></pre><p id="945f" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">引用组件和其他与<code class="fe nm nn no np b">#r</code>指令相同。</p><h2 id="0b95" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">排除故障</h2><blockquote class="lp lq lr"><p id="d08d" class="ls lt lu lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">可惜文章没有提到如何在实际的IDE中在需要的时候调试这样一个脚本……<br/>—<a class="ae mp" href="https://www.reddit.com/r/csharp/comments/ectt1v/hitchhikers_guide_to_the_c_scripting/fbe2l1g?utm_source=share&amp;utm_medium=web2x" rel="noopener ugc nofollow" target="_blank">https://www . Reddit . com/r/cs harp/comments/ectt1v/hitchligers _ guide _ to _ the _ c _ scripting/FBE 2 l1g？UTM _ source = share&amp;UTM _ medium = web2x</a></p></blockquote><p id="e897" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">你不能用CSI <strong class="lv iu">调试你的脚本，但是</strong> <em class="lu"> Script-CS </em>和<em class="lu"> Dotnet-Script </em>提供调试，尽管<a class="ae mp" href="https://marketplace.visualstudio.com/items?itemName=IgalTabachnik.AnyScriptCS" rel="noopener ugc nofollow" target="_blank"> Script-CS调试很棘手，需要Visual Studio </a>和一个与最新的Visual Studio不是100%兼容的扩展。在这一节中，我只讨论<strong class="lv iu"> dotnet-script </strong>调试。</p><ol class=""><li id="c140" class="mt mu it lv b lw lx lz ma mq mv mr mw ms mx mo of mz na nb bi translated">用dotnet-script scaffolder初始化新脚本</li></ol><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="107c" class="nq ky it np b gy om on l oo op">&gt; mkdir foo-bar</span><span id="4643" class="nq ky it np b gy oq on l oo op">&gt; cd foo-bar</span><span id="e1dd" class="nq ky it np b gy oq on l oo op">&gt; dotnet-script init foobar<br/>Creating VS Code launch configuration file<br/>...'\foo-bar\.vscode\launch.json' [Created]<br/>Creating OmniSharp configuration file<br/>...'\foo-bar\omnisharp.json' [Created]<br/>Creating 'foobar'<br/>...'\foo-bar\foobar.csx' [Created]</span></pre><p id="3a87" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">安装<a class="ae mp" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> VSCode </a>如果你还没有安装它，那么像这样打开脚本的文件夹:</p><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="b6bd" class="nq ky it np b gy om on l oo op">code .</span></pre><p id="90da" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">如果这是你第一次打开任何<code class="fe nm nn no np b">.cs</code>或<code class="fe nm nn no np b">.csx</code>文件，VSCode将安装<a class="ae mp" href="https://code.visualstudio.com/docs/languages/csharp" rel="noopener ugc nofollow" target="_blank"> C#扩展</a>和<a class="ae mp" href="http://www.omnisharp.net/" rel="noopener ugc nofollow" target="_blank"> Omnisharp </a>它需要不到一分钟的时间。现在你可以轻松地设置断点并按下<strong class="lv iu"> F5 </strong>来运行和调试你的脚本！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ot ou di ov bf ow"><div class="gh gi os"><img src="../Images/7516640e52ed4980974e8d238273410a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OnqnNNoqHljbDEew1eE-PA.gif"/></div></div><figcaption class="ox oy gj gh gi oz pa bd b be z dk translated">VSCode中的调试示例</figcaption></figure><h2 id="bbeb" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">用哪个？</h2><pre class="kj kk kl km gt oi np oj ok aw ol bi"><span id="f0cd" class="nq ky it np b gy om on l oo op">.-----------------.------.-------.----------------.--------.<br/>|      Name       | Repl | Nuget | Cross-Platform |  Debug |<br/>:-----------------+------+-------+----------------+--------:<br/>| Mono/Roslyn CSI | Yes  | No    | Yes            | No     |<br/>:-----------------+------+-------+----------------+--------:<br/>| Script-CS       | Yes  | Yes   | No             | Yes(1) |<br/>:-----------------+------+-------+----------------+--------:<br/>| Dotnet-Script   | Yes  | Yes   | Yes            | Yes    |<br/>'-----------------'------'-------'----------------'--------'</span><span id="c361" class="nq ky it np b gy oq on l oo op">1. Script-CS supports debugging but it requies complete Visual Studio and it's not easy to do</span></pre><p id="e9bb" class="pw-post-body-paragraph ls lt it lv b lw lx ju ly lz ma jx mb mq md me mf mr mh mi mj ms ml mm mn mo im bi translated">依我拙见，<strong class="lv iu"> dotnet-script </strong>是最好的选择，它有许多其他功能，如编译成<strong class="lv iu"> exe </strong>但这只是我的拙见，它总是取决于你和你的需求，你需要看看哪个工具更好地解决你的问题。</p><h2 id="faed" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">参考</h2><p id="3418" class="pw-post-body-paragraph ls lt it lv b lw nh ju ly lz ni jx mb mq nj me mf mr nk mi mj ms nl mm mn mo im bi translated"><strong class="lv iu">这是我用来了解C#脚本背景的一些参考资料。</strong></p><ol class=""><li id="a003" class="mt mu it lv b lw lx lz ma mq mv mr mw ms mx mo of mz na nb bi translated"><a class="ae mp" href="https://devblogs.microsoft.com/visualstudio/introducing-the-microsoft-roslyn-ctp/" rel="noopener ugc nofollow" target="_blank">介绍微软“罗斯林”CTP </a></li><li id="e377" class="mt mu it lv b lw nc lz nd mq ne mr nf ms ng mo of mz na nb bi translated"><a class="ae mp" href="https://blogs.msdn.microsoft.com/cdndevs/2015/12/01/adding-c-scripting-to-your-development-arsenal-part-1/" rel="noopener ugc nofollow" target="_blank">将C#脚本添加到您的开发工具中</a></li></ol></div><div class="ab cl kq kr hx ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="im in io ip iq"><h2 id="3fe8" class="nq ky it bd kz nr ns dn ld nt nu dp lh mq nv nw lj mr nx ny ll ms nz oa ln ob bi translated">如果你喜欢我的文章，请多看看我关于C#的其他文章</h2><ul class=""><li id="3c0c" class="mt mu it lv b lw nh lz ni mq oc mr od ms oe mo my mz na nb bi translated"><a class="ae mp" rel="noopener ugc nofollow" target="_blank" href="/run-c-natively-in-the-browser-through-the-web-assembly-via-mono-wasm-60f3d55dd05a">使用mono-wasm通过web程序集在浏览器中本地运行C#</a></li></ul></div></div>    
</body>
</html>
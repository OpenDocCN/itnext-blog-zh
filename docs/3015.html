<html>
<head>
<title>Tutorial: Build a Serverless API backend for Slack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:为Slack构建一个无服务器API后端</h1>
<blockquote>原文：<a href="https://itnext.io/build-a-serverless-api-backend-to-deliver-funny-gifs-in-slack-42002a947f07?source=collection_archive---------4-----------------------#2019-09-15">https://itnext.io/build-a-serverless-api-backend-to-deliver-funny-gifs-in-slack-42002a947f07?source=collection_archive---------4-----------------------#2019-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6bd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Webhook后端是无服务器功能的一个流行用例。FaaS (Functions-as-a-service)产品使得提供一个托管Webhook逻辑的HTTP端点变得相对容易，这可以像发送电子邮件一样简单，像回复有趣的gif一样有趣！</p><p id="38d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，我们将探索<strong class="jp ir">funcy</strong>——一个无服务器的webhook后端，它是令人敬畏的<a class="ae kl" href="https://get.slack.help/hc/en-us/articles/204714258-Giphy-for-Slack" rel="noopener ugc nofollow" target="_blank"> Giphy for Slack </a>的精简版本。(最初的)Giphy Slack应用为一个搜索词返回一堆gif，用户可以从中选择一个。<strong class="jp ir"> funcy </strong>使用<a class="ae kl" href="https://developers.giphy.com/docs/#operation--gifs-random-get" rel="noopener ugc nofollow" target="_blank"> Giphy Random API </a>通过简单地返回一个(单个)搜索关键词的随机图像来稍微调整一下。</p><p id="38c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇博文提供了一步一步的指导，让应用程序部署到Azure Functions，并与你的Slack workspace连接起来。代码在GitHub 上有<a class="ae kl" href="https://github.com/abhirockzz/funcy-azure-functions/" rel="noopener ugc nofollow" target="_blank">供你查找。</a></p><blockquote class="km kn ko"><p id="12f6" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">如果你有兴趣用</em> <a class="ae kl" href="https://azure.microsoft.com/en-in/services/functions/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Azure函数</em> </a> <em class="iq">学习无服务器开发，只需</em> <a class="ae kl" href="https://azure.microsoft.com/en-us/free/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">创建一个免费的Azure账号</em> </a> <em class="iq">就可以开始了！我强烈推荐查看文档中的</em> <a class="ae kl" href="https://docs.microsoft.com/en-in/azure/azure-functions/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">快速入门指南、教程和代码示例</em> </a> <em class="iq">，如果您喜欢，可以使用</em> <a class="ae kl" href="https://docs.microsoft.com/en-in/learn/paths/create-serverless-applications/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">指导学习路径</em> </a> <em class="iq">，或者下载</em> <a class="ae kl" href="https://azure.microsoft.com/en-in/resources/azure-serverless-computing-cookbook/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">无服务器计算手册</em> </a> <em class="iq">。</em></p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/110a81b80910079a6aa8371e12524b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*AwQ2WMzS2ejck0aE.jpg"/></div></figure><p id="2461" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了保持这篇博客的简洁，代码的细节将在随后的文章中介绍。</p><p id="e471" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://dev.to/azure/code-walkthrough-for-funcy-a-serverless-slack-app-using-azure-functions-3gmd" rel="noopener ugc nofollow" target="_blank">https://dev . to/azure/code-walk-for-funcy-a-server less-slack-app-using-azure-functions-3g MD</a></p><h1 id="19e4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">概观</h1><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/0ad3b3d9b4fd53fe4f893a8f8e7d8716.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/0*87lrQQFdqsjv5367.jpg"/></div></figure><p id="ec4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ma mb mc md b">funcy</code>是作为Slack内的斜线命令建立的。作为用户，您可以使用<code class="fe ma mb mc md b">/funcy &lt;your search term&gt;</code>从您的Slack工作区调用它。这反过来调用了我们部署到Azure函数的webhook它只不过是一堆Java代码<a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference-java/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"/>。它调用<a class="ae kl" href="https://developers.giphy.com/docs/#operation--gifs-random-get" rel="noopener ugc nofollow" target="_blank"> Giphy随机API </a>并将结果返回给用户。</p><p id="b4c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，使用<code class="fe ma mb mc md b">/funcy serverless</code>从您的Slack工作区调用它将会返回一个随机的GIF。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi me"><img src="../Images/1e2f0027a0956ab0b763b642528fa69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*pUyKhSbE1119wyQL.gif"/></div></figure><p id="05b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来的部分将指导您完成以下内容:</p><ul class=""><li id="59b4" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">先决条件</li><li id="0680" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">松弛设置和配置</li><li id="038d" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">部署到Azure功能</li></ul><h1 id="7103" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">先决条件</h1><p id="0940" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">在您继续之前，请确保您已准备好以下事项，这不会花费太长时间</p><ul class=""><li id="2960" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><strong class="jp ir">Maven</strong>—<a class="ae kl" href="https://docs.microsoft.com/java/api/overview/azure/maven/azure-functions-maven-plugin/readme?view=azure-java-stable&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">用于Azure函数的Maven插件</a>用于构建和部署您的Java函数。如果没有Maven，请从这里安装<code class="fe ma mb mc md b">v 3.0</code>或以上<a class="ae kl" href="https://maven.apache.org/" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="e9f4" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><strong class="jp ir"> Azure CLI </strong> — <a class="ae kl" href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">按照说明</a>设置并登录Azure CLI。</li><li id="4412" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><strong class="jp ir">宽松工作空间</strong> — <a class="ae kl" href="https://slack.com/create" rel="noopener ugc nofollow" target="_blank">如果您没有宽松工作空间</a>，请创建一个。</li><li id="b75e" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><strong class="jp ir"> GIPHY API key </strong> —你需要创建一个GIHPY账户(免费的！)和<a class="ae kl" href="https://developers.giphy.com/dashboard/?create=true" rel="noopener ugc nofollow" target="_blank">创建一个app </a>。您创建的每个应用程序都有自己的API密钥。</li></ul><blockquote class="km kn ko"><p id="2a04" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">请记下您的GIPHY API密钥，因为您稍后会用到它</em></p></blockquote><h1 id="1a5c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">配置时差</h1><p id="1d74" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">请注意，本节中的说明改编自<a class="ae kl" href="https://api.slack.com/slash-commands#creating_commands" rel="noopener ugc nofollow" target="_blank">松弛文档</a></p><h2 id="662b" class="my lc iq bd ld mz na dn lh nb nc dp ll jy nd ne lp kc nf ng lt kg nh ni lx nj bi translated">创建一个Slack应用程序</h2><p id="441d" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">登录您的<a class="ae kl" href="https://slack.com/signin" rel="noopener ugc nofollow" target="_blank">空闲工作区</a>。从<a class="ae kl" href="https://api.slack.com/apps/new" rel="noopener ugc nofollow" target="_blank">创建一个新的Slack应用</a>开始</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/626d2e07ec798d40bd9da80de84d1429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BNXH_iDO5eGAPxCB.jpg"/></div></div></figure><h2 id="1b68" class="my lc iq bd ld mz na dn lh nb nc dp ll jy nd ne lp kc nf ng lt kg nh ni lx nj bi translated">创建斜线命令</h2><p id="e0f7" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">一旦你完成了应用程序的创建，进入应用程序的设置页面，然后点击导航菜单中的<em class="kp">斜线命令</em>功能。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/e4e67869152a4a31fe3eed9f27c6641a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ol8bWQLVOmsMBhBT.jpg"/></div></div></figure><p id="3fe5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将看到一个标有<em class="kp">创建新命令</em>的按钮，当您点击它时，您将看到一个屏幕，要求您用所需信息定义新的<em class="kp">斜线命令</em>。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi np"><img src="../Images/b71dc01d7dd458c416326545cdbfec70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_2Gffj7av4J1qz-O.jpg"/></div></div></figure><p id="ccc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入所需的信息。请注意,<strong class="jp ir">请求URL </strong>字段是您将输入函数的HTTP端点的字段，在您部署它之后将可用。您可以暂时使用虚拟URL作为占位符，例如<code class="fe ma mb mc md b"><a class="ae kl" href="https://temporary.com:4242" rel="noopener ugc nofollow" target="_blank">https://temporary.com:4242</a></code></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nq"><img src="../Images/c03b4a018bf97bf44675402367dc91d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yy7ptr8r_0kDU5l2.jpg"/></div></div></figure><p id="8504" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成后，点击<strong class="jp ir">保存</strong>完成。</p><h2 id="7309" class="my lc iq bd ld mz na dn lh nb nc dp ll jy nd ne lp kc nf ng lt kg nh ni lx nj bi translated">将应用程序安装到您的工作区</h2><p id="e219" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">创建完Slash命令后，转到应用程序的设置页面，在导航菜单中单击<em class="kp">基本信息</em>功能，选择<em class="kp">将应用程序安装到工作区</em>，然后单击<em class="kp">将应用程序安装到工作区</em> —这将把应用程序安装到Slack工作区，以测试应用程序并生成与Slack API交互所需的令牌。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/d81e3bffa574627b787698191d2461e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XCXJXd4LWhE3jv8z.jpg"/></div></div></figure><p id="5f5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦你完成应用程序的安装，<em class="kp">应用程序凭证</em>将出现在同一页面上。你需要从那里获取你的<em class="kp">松弛签名秘密</em></p><blockquote class="km kn ko"><p id="3840" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">记下你的应用签名密码，因为你以后会用到它</em></p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nr"><img src="../Images/87dbf36a1b473d5789ebdae76315e9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*32ReryK1jzjYbvJX.jpg"/></div></div></figure><h1 id="df13" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">部署到Azure</h1><p id="09ed" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">首先克隆GitHub存储库，然后切换到应用程序目录</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="8c48" class="my lc iq md b gy nw nx l ny nz">git clone https://github.com/abhirockzz/funcy-azure-functions<br/>cd funcy-azure-functions</span></pre><p id="7a3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ma mb mc md b">pom.xml</code>文件包含Azure Functions Maven插件使用的以下属性——应用程序名称(<code class="fe ma mb mc md b">functionAppName</code>)、区域(<code class="fe ma mb mc md b">functionAppRegion</code>)和资源组(<code class="fe ma mb mc md b">functionResourceGroup</code>)。上面的参数都有默认值，所以如果您愿意，可以选择继续使用它们。</p><ul class=""><li id="3fd2" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><code class="fe ma mb mc md b">functionAppName</code> - funcyapp</li><li id="e785" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><code class="fe ma mb mc md b">functionAppRegion</code> -韦斯特乌斯</li><li id="a15d" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><code class="fe ma mb mc md b">functionResourceGroup</code>-Java-函数-组</li></ul><blockquote class="km kn ko"><p id="71a0" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">请注意，app名称必须</em> <strong class="jp ir"> <em class="iq">跨Azure唯一</em> </strong> <em class="iq">。</em></p></blockquote><p id="4cb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您希望更改这些值，请查看来自<code class="fe ma mb mc md b">pom.xml</code>的这个片段，它突出显示了需要更新的<code class="fe ma mb mc md b">&lt;properties&gt;</code></p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="47ac" class="my lc iq md b gy nw nx l ny nz">&lt;properties&gt;<br/>        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;<br/>        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;<br/>        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;<br/>        &lt;azure.functions.maven.plugin.version&gt;1.3.1&lt;/azure.functions.maven.plugin.version&gt;<br/>        &lt;azure.functions.java.library.version&gt;1.3.0&lt;/azure.functions.java.library.version&gt;<br/>        &lt;functionAppName&gt;YOUR_APP_NAME&lt;/functionAppName&gt;<br/>        &lt;functionAppRegion&gt;AZURE_REGION&lt;/functionAppRegion&gt;<br/>        &lt;functionResourceGroup&gt;RESOURCE_GROUP_NAME&lt;/functionResourceGroup&gt;<br/>        &lt;stagingDirectory&gt;${project.build.directory}/azure-functions/${functionAppName}&lt;/stagingDirectory&gt;<br/>    &lt;/properties&gt;</span></pre><blockquote class="km kn ko"><p id="9fb1" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">函数的名称与应用程序名称(通过</em> <code class="fe ma mb mc md b"><em class="iq">pom.xml</em></code> <em class="iq">配置)不同，是使用函数的Java代码中的</em> <code class="fe ma mb mc md b"><em class="iq">@FunctionName</em></code> <em class="iq">注释指定的——在本例中，名称是</em> <code class="fe ma mb mc md b"><em class="iq">funcy</em></code> <em class="iq">。</em></p></blockquote><p id="d7a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您可以构建该功能并将其部署到Azure</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="141e" class="my lc iq md b gy nw nx l ny nz">//build<br/>mvn clean package</span><span id="00bc" class="my lc iq md b gy oa nx l ny nz">//deploy<br/>mvn azure-functions:deploy</span></pre><p id="01a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功部署的结果如下所示</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="3660" class="my lc iq md b gy nw nx l ny nz">[INFO] Successfully updated the function app.funcyapp<br/>[INFO] Trying to deploy the function app...<br/>[INFO] Trying to deploy artifact to funcyapp...<br/>[INFO] Successfully deployed the artifact to https://funcyapp.azurewebsites.net<br/>[INFO] Successfully deployed the function app at https://funcyapp.azurewebsites.net<br/>[INFO] ------------------------------------------------------------------------<br/>[INFO] BUILD SUCCESS</span></pre><p id="142a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Azure CLI列出你的功能应用程序</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="410c" class="my lc iq md b gy nw nx l ny nz">az functionapp list --query "[].{hostName: defaultHostName, state: state}"</span></pre><p id="beb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该看到一个JSON输出</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="96f0" class="my lc iq md b gy nw nx l ny nz">[<br/>    {<br/>        "hostName": "funcyapp.azurewebsites.net",<br/>        "state": "Running"<br/>    }<br/>]</span></pre><blockquote class="km kn ko"><p id="cc68" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">你应该可以在</em> <a class="ae kl" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Azure门户</em> </a>中看到该功能(在 <code class="fe ma mb mc md b"><em class="iq">Function App</em></code> <em class="iq">菜单下)</em></p></blockquote><p id="1c23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦部署成功，该函数应该准备好为请求提供服务，并且可以在以下端点通过HTTP(s)进行访问— <code class="fe ma mb mc md b">https://&lt;APP_NAME&gt;.azurewebsites.net/api/&lt;FUNCTION_NAME&gt;</code></p><p id="a76d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于一个名为<code class="fe ma mb mc md b">funcyapp</code>的应用程序和一个名为<code class="fe ma mb mc md b">funcy</code>的函数，端点应该是</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="4e5c" class="my lc iq md b gy nw nx l ny nz"><a class="ae kl" href="https://funcyapp.azurewebsites.net/api/funcy" rel="noopener ugc nofollow" target="_blank">https://funcyapp.azurewebsites.net/api/funcy</a></span></pre><p id="a3f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你就快到了！</p><h2 id="6a35" class="my lc iq bd ld mz na dn lh nb nc dp ll jy nd ne lp kc nf ng lt kg nh ni lx nj bi translated">更新你的Azure功能应用</h2><p id="2c1d" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">既然Azure Functions应用程序已经启动并运行，您需要更新它，将<code class="fe ma mb mc md b">Giphy API Key</code>和<code class="fe ma mb mc md b">Slack Signing Secret</code>作为环境变量。</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="c830" class="my lc iq md b gy nw nx l ny nz">az functionapp config appsettings set --name &lt;APP_NAME&gt; --resource-group &lt;RESOURCE_GROUP_NAME&gt; --settings "SLACK_SIGNING_SECRET=&lt;SLACK_SIGNING_SECRET&gt;" "GIPHY_API_KEY=&lt;GIPHY_API_KEY&gt;"</span></pre><p id="4a02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如</p><pre class="ku kv kw kx gt ns md nt nu aw nv bi"><span id="ed18" class="my lc iq md b gy nw nx l ny nz">az functionapp config appsettings set --name funcyapp --resource-group java-functions-group --settings "SLACK_SIGNING_SECRET=foobarb3062bd293b1a838276cfoobar" "GIPHY_API_KEY=foobarrOqMb5fvJdIuxTCr3WUDfoobar"</span></pre><blockquote class="km kn ko"><p id="311f" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">详见</em> <a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-how-to-use-azure-function-app-settings/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">如何在Azure门户</em> </a> <em class="iq">中管理一个功能app的文档。</em></p></blockquote><h1 id="0f51" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更新Slack应用</h1><p id="7d30" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">转到应用程序的设置页面，然后在导航菜单中点击<em class="kp">斜杠命令</em>功能。编辑命令，并用您的函数HTTP(s)端点替换<em class="kp">请求URL </em>字段的值</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ob"><img src="../Images/e5ff7e2aa7dbb673dfae8cdc333010e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mHO97KqHXEbvhkJ4.jpg"/></div></div></figure><h1 id="6b2f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe ma mb mc md b">funcy</code>时间到了！</h1><p id="2024" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">从您的工作区中，调用命令</p><p id="5cd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ma mb mc md b">/funcy &lt;search term&gt;</code></p><p id="aa40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然你对猫不会错，那就试试吧</p><p id="24f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ma mb mc md b">/funcy cat</code></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0654f1987b92ac6d67b4bc600f6551d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*O5efmq3yjyEUXxQb.gif"/></div></figure><p id="187f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您在第一次调用后看到Slack中的<code class="fe ma mb mc md b">Timeout error</code>,请不要担心。这是由于“冷启动”问题，该功能需要几秒钟来引导，但<a class="ae kl" href="https://api.slack.com/slash-commands#responding_basic_receipt" rel="noopener ugc nofollow" target="_blank"> Slack期望在3秒钟内得到响应</a>。只要重试(几次)就可以了。</p><blockquote class="km kn ko"><p id="cd85" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">如果您的应用程序无法承受由于“空闲冷启动”而导致的延迟，您可能需要查看一下</em><a class="ae kl" href="https://azure.microsoft.com/en-us/blog/announcing-the-azure-functions-premium-plan-for-enterprise-serverless-workloads/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"><em class="iq">Azure Functions Premium plan</em></a><em class="iq">，它提供了</em>“预热的实例，以便在空闲后无延迟地运行您的应用程序……”</p></blockquote><h1 id="9eff" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">资源</h1><p id="f1a9" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">下面提到的资源是专门用来开发这篇博文中展示的演示应用程序的，所以你可能会发现它们也很有用！</p><ul class=""><li id="e73e" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Functions开发者指南(通用)</a>和<a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference-java/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Functions Java开发者指南</a></li><li id="0cb8" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-first-java-maven/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">如何使用Java创建函数并将其发布到Azure Functions的快速入门</a></li><li id="1f59" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae kl" href="https://docs.microsoft.com/en-us/java/api/overview/azure/maven/azure-functions-maven-plugin/readme?view=azure-java-stable/%3FWT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">Azure函数的Maven插件</a></li><li id="4e09" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">如何在本地编码和测试Azure功能</li><li id="5f17" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae kl" href="https://docs.microsoft.com/en-us/azure/azure-functions/manage-connections/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">如何管理Azure功能中的连接</a></li><li id="6ac1" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae kl" href="https://github.com/microsoft/azure-maven-plugins" rel="noopener ugc nofollow" target="_blank">GitHub上Azure服务的Maven插件</a></li></ul><blockquote class="km kn ko"><p id="3e0c" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">别忘了看看这篇博文的第二部分</em><a class="ae kl" href="https://dev.to/azure/code-walkthrough-for-funcy-a-serverless-slack-app-using-azure-functions-3gmd" rel="noopener ugc nofollow" target="_blank"><em class="iq"/></a><em class="iq">，在那里我已经详细介绍了代码</em></p></blockquote><p id="50a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我真的希望你喜欢这篇文章，并从中学到了一些东西！如果你做了，请喜欢并跟随。很高兴通过<a class="ae kl" href="https://twitter.com/abhi_tweeter" rel="noopener ugc nofollow" target="_blank"> @abhi_tweeter </a>获得反馈或发表评论。</p><div class="od oe gp gr of og"><a href="https://twitter.com/abhi_tweeter" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">阿布舍克</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">Abhishek的最新推文(@abhi_tweeter)。云开发者🥑@Microsoft @azureadvocates |…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">twitter.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kz og"/></div></div></a></div></div></div>    
</body>
</html>
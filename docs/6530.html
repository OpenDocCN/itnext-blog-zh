<html>
<head>
<title>Modern C++ in Advent of Code: Day11</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代C++代码的出现:第11天</h1>
<blockquote>原文：<a href="https://itnext.io/modern-c-in-advent-of-code-day11-fe5a9eb6f3ad?source=collection_archive---------1-----------------------#2021-12-11">https://itnext.io/modern-c-in-advent-of-code-day11-fe5a9eb6f3ad?source=collection_archive---------1-----------------------#2021-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d56e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天是代码问世<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">的第十一天。今天，我们将模拟闪光的章鱼。</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/f45599222825e3f66b60f8834ad75129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyUmtOctOyj0eLIzTDCrmQ.png"/></div></div></figure><p id="11a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，请先尝试解决问题，然后再看解决方案。对于本系列的所有文章，<a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">请查看这个列表</a>。</p><h1 id="a3c8" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第11天:第一部分和第二部分</h1><p id="7d7f" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们正在模拟实体(章鱼)的正方形网格。我们按照以下规则逐步模拟系统:</p><ul class=""><li id="3148" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated">每走一步，每只章鱼的能量等级增加1</li><li id="5aeb" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">当章鱼的能量达到10或更高时，它会闪烁</li><li id="8864" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">闪烁章鱼增加周围(所有八个方向)章鱼的能量等级1</li><li id="fcf3" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">章鱼每走一步只能闪一次</li><li id="ad03" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">所有闪现的章鱼都以0级能量结束本轮</li></ul><p id="0417" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于每只章鱼有八个邻居，即使是低能量的章鱼也会闪光。此外，我们需要小心编码，以确保每只章鱼只闪烁一次。</p><p id="c81f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从声明和基本测试开始:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="98e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的tick函数将系统向前移动一个tick，并返回在那个tick中闪烁的章鱼的数量。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="182c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解决这个问题的一个简单方法是，只要前一个循环中有章鱼闪烁，就进行循环(可能会产生更多会闪烁的章鱼)。然而，虽然简单，这也相当慢，我们可以做得更好。</p><p id="f433" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道每只章鱼只能闪现一次。我们还知道，只有当一些邻居闪烁时，状态为8或更低的章鱼才会闪烁。所以我们可以保留一份章鱼的“现成”清单。我们一直循环，直到这个列表为空，如果一只章鱼由于闪光而超过了阈值，就添加到这个列表中。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="c101" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入解析与<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/modern-c-in-advent-of-code-day9-1ad4e7890032">第9天</a>相同。我们逐个字符地读取输入，将ASCII数字转换成它们的整数值。</p><p id="b150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在tick函数中，我们首先增加所有实体的能量级别，并记住那些准备闪烁的实体(第24–30行)。除了将2D坐标压缩成一个数字(第28行)，我们还可以使用一个结构来存储2D坐标，就像我们在<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/modern-c-in-advent-of-code-day5-4777e4037869"> Day 5 </a>中使用struct Point所做的那样。</p><p id="089f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，当我们有任何准备闪光的章鱼时，我们循环。我们首先从集合中删除一个元素，解码坐标并记录这只章鱼已经闪现的内容(第33–38行)。之后，我们迭代所有的邻居。注意使用<code class="fe mr ms mt mu b">ssize_t</code>(有符号大小类型)，以及边界条件来处理网格边界上的章鱼。最后，我们不接触已经闪现的章鱼(第43行)，如果邻居超过了阈值，我们会将其添加到列表中(第46行)。</p><p id="b38a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们在主函数中需要做的就是对100个分笔成交点上的闪烁次数求和:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="8484" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过这种方法，我们也立即有了问题的第二部分的解决方案。我们必须在所有章鱼闪烁时检测第一次迭代。然而，我们已经知道有多少章鱼闪过。是<code class="fe mr ms mt mu b">tick</code>返回的数字。所以我们将其与章鱼的总数进行比较:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="4753" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">链接和技术说明</h1><p id="af8c" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">每日解决方案存储库位于:【https://github.com/HappyCerberus/moderncpp-aoc-2021】T2。</p><p id="1f8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">看看这个列表，里面有关于《代码降临》中其他日子的文章</a>。</p><p id="6297" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请不要忘记亲自尝试<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">降临码</a>。</p><h1 id="47fa" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">感谢您的阅读</h1><p id="41de" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">感谢您阅读这篇文章。你喜欢吗？</p><p id="ac5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也在YouTube上发布视频。你有问题吗？在Twitter或LinkedIn上联系我。</p></div></div>    
</body>
</html>
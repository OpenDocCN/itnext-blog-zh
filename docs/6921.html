<html>
<head>
<title>Safari now fully supports SharedWorkers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Safari现在完全支持共享工作者</h1>
<blockquote>原文：<a href="https://itnext.io/safari-now-fully-supports-sharedworkers-534733b56b4c?source=collection_archive---------3-----------------------#2022-04-13">https://itnext.io/safari-now-fully-supports-sharedworkers-534733b56b4c?source=collection_archive---------3-----------------------#2022-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="537a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Webkit，多窗口应用已经成为现实</h2></div><p id="fec4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我对这个功能非常兴奋，因为我已经等了两年多了。我们现在可以轻松地创建多屏幕应用程序，并在多个浏览器标签中共享API相关数据。</p><h1 id="cdd4" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">内容</h1><ol class=""><li id="9595" class="lt lu iq kh b ki lv kl lw ko lx ks ly kw lz la ma mb mc md bi translated">介绍</li><li id="6d52" class="lt lu iq kh b ki me kl mf ko mg ks mh kw mi la ma mb mc md bi translated">如何安装Safari Tech预览版？</li><li id="00ae" class="lt lu iq kh b ki me kl mf ko mg ks mh kw mi la ma mb mc md bi translated">如何基于JS模块创建SharedWorker？</li><li id="8ab8" class="lt lu iq kh b ki me kl mf ko mg ks mh kw mi la ma mb mc md bi translated">neo.mjs多窗口Covid仪表板</li><li id="59b9" class="lt lu iq kh b ki me kl mf ko mg ks mh kw mi la ma mb mc md bi translated">浏览器的当前状态</li><li id="a8e0" class="lt lu iq kh b ki me kl mf ko mg ks mh kw mi la ma mb mc md bi translated">最后的想法</li></ol><h1 id="d4aa" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">1.介绍</h1><p id="fb0b" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">对于那些还不熟悉共享工作者的人，请快速浏览一下这个链接:</p><div class="mm mn gp gr mo mp"><a href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">shared worker-Web API | MDN</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">SharedWorker接口表示一种特定的工作器，可以从几个浏览上下文中访问它…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">developer.mozilla.org</p></div></div><div class="my l"><div class="mz l na nb nc my nd ne mp"/></div></div></a></div><p id="135d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然Chrome和Firefox在相当长一段时间内确实支持SharedWorkers，但对于基于Webkit的scope来说，情况就大不相同了。</p><p id="fefa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该团队实际上在许多年前致力于一个实现，但是如果我没记错的话，由于安全考虑，它在版本7中放弃了开发。</p><p id="15a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我参与了一个相当大的社区努力，将该功能推回到“雷达上”类别:</p><div class="mm mn gp gr mo mp"><a href="https://bugs.webkit.org/show_bug.cgi?id=149850" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">149850 -恢复对共享工作者的支持</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">错误149850:恢复对共享工作人员的支持</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">bugs.webkit.org</p></div></div></div></a></div><p id="5438" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">快进:Webkit团队创建了一个新标签，并几乎秘密地解决了这个问题:</p><div class="mm mn gp gr mo mp"><a href="https://bugs.webkit.org/show_bug.cgi?id=230382" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">230382 -实现共享工作器</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">编辑描述</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">bugs.webkit.org</p></div></div></div></a></div><p id="c8dc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个问题现在已经解决了，它已经进入了最新版本的Safari技术预览版:</p><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c70a4a441c121a02eca36fb77c4579ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*tTysbKSYb3whuzuXE7fyfQ.png"/></div></figure><h1 id="7e83" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">2.如何安装Safari Tech预览版？</h1><p id="34ec" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">安装非常简单:</p><div class="mm mn gp gr mo mp"><a href="https://developer.apple.com/safari/resources/" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">资源- Safari -苹果开发者</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">工具、文档、论坛、视频等等。观看视频并向我们的工程师学习，他们展示了如何将…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">developer.apple.com</p></div></div></div></a></div><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/cfcc7ee2039d667cb032e90c1da5d608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNtIDD2dTUtxrQhCqY5iyQ.png"/></div></div></figure><h1 id="8455" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">3.如何基于JS模块创建SharedWorker？</h1><p id="9d03" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">您可以像这样创建一个非基于模块的工作线程:</p><pre class="ng nh ni nj gt nr ns nt nu aw nv bi"><span id="0fb7" class="nw lc iq ns b gy nx ny l nz oa">const worker = new SharedWorker('worker.js');</span></pre><p id="6c9e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您确实想要一个JS模块作为起点，只需使用type选项:</p><pre class="ng nh ni nj gt nr ns nt nu aw nv bi"><span id="3a8a" class="nw lc iq ns b gy nx ny l nz oa">const worker = new SharedWorker('worker.mjs', {<br/>  type: 'module'<br/>});</span></pre><h1 id="7033" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">4.neo.mjs多窗口Covid仪表板</h1><p id="3bef" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">这个演示应用程序仍然是最令人惊叹的neo.mjs演示之一:</p><figure class="ng nh ni nj gt nk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="fb88" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，它只能在Chromium和Firefox浏览器中运行。现在，它也可以在Safari技术预览版中运行:)</p><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi od"><img src="../Images/8adb57716d1f0cdd3be591709ef0e0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ps3hRvml7Koww_pBGsXZLA.png"/></div></div></figure><p id="b748" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">亲自尝试一下:</p><p id="2391" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">开发模式</strong> (Chromium，Safari):<br/><a class="ae oe" href="https://neomjs.github.io/pages/node_modules/neo.mjs/apps/sharedcovid/index.html#mainview=table" rel="noopener ugc nofollow" target="_blank">neo.mjs/apps/sharedcovid/index.html#mainview=table</a></p><p id="f74b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">dist/production</strong>(Chromium、Firefox、Safari):<br/><a class="ae oe" href="https://neomjs.github.io/pages/node_modules/neo.mjs/dist/production/apps/sharedcovid/index.html#mainview=table" rel="noopener ugc nofollow" target="_blank">neo . mjs/dist/production/apps/shared covid/index . html # main view = table</a></p><h1 id="0515" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">5.浏览器的当前状态</h1><p id="b415" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">我们可以总结如下:</p><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi of"><img src="../Images/c82bf3636cfd1f770dcd43d63589c7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6WU5mgCQNGw4u7jLjhgyw.png"/></div></div></figure><p id="0c4b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(用<a class="ae oe" href="https://imgflip.com/memegenerator/187760713/Three-dragons" rel="noopener ugc nofollow" target="_blank">https://imgflip.com/memegenerator/187760713/Three-dragons</a>生成)</p><p id="eaa9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在渲染性能方面，Safari卷土重来。例如，neo.mjs helix和gallery视图与Chromium处于同一级别。在这种情况下，Firefox感觉慢了10倍左右，这种情况非常严重。</p><p id="06ee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然Firefox也支持SharedWorkers，但是Mozilla团队还没有在基于worker的范围内完成对JS模块的支持。更准确地说:动态导入还没有奏效。</p><p id="f842" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于neo.mjs范围，这意味着:</p><p id="2a47" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">dev模式(专用工人):<br/> <strong class="kh ir"> Chromium，Safari </strong></p><p id="f109" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">dev模式(共享工作者):<br/> <strong class="kh ir"> Chromium，Safari </strong></p><p id="73e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分销/生产(专门的工人):<br/> <strong class="kh ir"> Chromium、Firefox、Safari </strong></p><p id="ee84" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分销/生产(共享工人):<br/> <strong class="kh ir"> Chromium、Firefox、Safari </strong></p><p id="2514" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很高兴看到Mozilla很快又赶上来了！</p><h1 id="7393" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">6.最后的想法</h1><p id="1f8f" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">此时，neo.mjs workers设置会立即在Safari中运行:</p><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi og"><img src="../Images/7e0c5499adc9f506faace928f1e6a813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P7Iv-yHVQKSECOtY0WJfDA.png"/></div></div></figure><p id="ea00" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们切换到SharedWorkers范围的情况下也是如此。</p><p id="656f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这使我们能够跨多个浏览器窗口直接通信，并共享相同的后端(API)数据，从而减少对BE的调用。</p><p id="8cf9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">性能提升惊人。</p><p id="0fba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于iOS的思考:苹果仍然限制iOS只允许Webkit引擎。含义:iOS上的Chrome只是一个被剥皮的Safari。一旦软件支持也在iOS上结束，我们可以创建使用无头浏览器的混合应用程序，在那里，应用程序也可以直接通信。</p><p id="6b8a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新的Safari版本将neo.mjs推向了黄金时段。除非您想成为下一个jQuery开发人员，否则我只能强烈建议您深入研究一下:</p><div class="mm mn gp gr mo mp"><a href="https://github.com/neomjs/neo" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">GitHub - neomjs/neo:应用工人驱动的前端框架</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">neo.mjs使您能够使用一个以上的CPU创建可扩展的高性能应用程序。不需要照顾一个…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">github.com</p></div></div><div class="my l"><div class="oh l na nb nc my nd ne mp"/></div></div></a></div><p id="9db3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您在学习neo方面需要帮助，非常欢迎您加入Slack频道:</p><div class="mm mn gp gr mo mp"><a href="https://join.slack.com/t/neomjs/shared_invite/zt-6c50ueeu-3E1~M4T9xkNnb~M_prEEOA" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">松弛的</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">编辑描述</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">join.slack.com</p></div></div><div class="my l"><div class="oi l na nb nc my nd ne mp"/></div></div></a></div><p id="3cd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">问候&amp;快乐编码，<br/>托拜厄斯</p></div></div>    
</body>
</html>
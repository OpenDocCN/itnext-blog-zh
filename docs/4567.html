<html>
<head>
<title>Create your first REST API in Django Rest Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Django Rest框架中创建您的第一个REST API</h1>
<blockquote>原文：<a href="https://itnext.io/create-your-first-rest-api-in-django-rest-framework-e45fa3318106?source=collection_archive---------5-----------------------#2020-07-27">https://itnext.io/create-your-first-rest-api-in-django-rest-framework-e45fa3318106?source=collection_archive---------5-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/411715dc9cfa819ce81647883208dc61.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*Zpir4UKnPI2omHU_dZvxEQ.jpeg"/></div></figure><p id="a1a4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我将谈论Django Rest框架或DRF。DRF用于在Django中创建RESTful APIs，以后可以被各种应用程序使用；移动、网络、桌面等。我们将讨论如何在你的机器上安装DRF，然后为系统编写API。</p><p id="dab1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们讨论DRF之前，让我们先谈谈休息本身。</p><h1 id="7be0" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">什么是休息</h1><p id="3e5a" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">来自维基百科</p><blockquote class="lv lw lx"><p id="6c9b" class="ju jv ly jw b jx jy jz ka kb kc kd ke lz kg kh ki ma kk kl km mb ko kp kq kr ij bi translated"><strong class="jw ir">表述性状态转移(REST) </strong>是一种软件架构风格，它定义了一组用于创建Web服务的约束。符合REST架构风格的Web服务，称为RESTful Web服务，提供互联网上计算机系统之间的互操作性。RESTful Web服务允许请求系统通过使用一组统一的、预定义的无状态操作来访问和操作Web资源的文本表示。其他种类的Web服务，如SOAP Web服务，公开了它们自己的任意操作集。[1]</p></blockquote><p id="7381" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ly"> Rest API(应用编程接口)</em>是一种无状态的客户端-服务器架构，使用典型的URL方案进行数据交换。罗伊·菲尔丁在2000年的著名论文中首次提出了这一观点。用于在客户机和服务器之间提供通信的URL通常被称为<em class="ly">端点</em>。不同的HTTP方法用于此目的:</p><ul class=""><li id="6269" class="mc md iq jw b jx jy kb kc kf me kj mf kn mg kr mh mi mj mk bi translated">GET:-它返回请求的数据，可以是记录列表或单个记录。</li><li id="1e65" class="mc md iq jw b jx ml kb mm kf mn kj mo kn mp kr mh mi mj mk bi translated">POST:-它创建了一个新记录。</li><li id="92c5" class="mc md iq jw b jx ml kb mm kf mn kj mo kn mp kr mh mi mj mk bi translated">PUT/PATCH:-它更新现有的记录。</li><li id="b705" class="mc md iq jw b jx ml kb mm kf mn kj mo kn mp kr mh mi mj mk bi translated">删除；它会删除记录。</li></ul><p id="2e0e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">返回的数据可以是XML、JSON或其他格式，但前两种格式最常见。</p><p id="c22b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好了，现在你已经了解了一点REST API，我们来讨论一下Django Rest框架本身。</p><h1 id="3891" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">什么是Django Rest框架</h1><p id="ce54" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">Django Rest Framework是一个用Python编写RESTful APIs的开源框架。它是基于Django框架的，所以对Django的了解是非常有益的，尽管不是必需的。</p><p id="2346" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，我们将为联系人管理系统开发API，用户可以使用我们的API来创建/更新和删除联系人。返回的数据将采用JSON格式。</p><h1 id="501f" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">安装和设置</h1><p id="f8d0" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">我将使用<a class="ae mq" href="https://pipenv-fork.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Pipenv </a>为我们的API设置开发环境。Pipenv使隔离您的开发环境变得更加容易，不管您的机器上安装了什么。它还允许您选择一个不同的Python版本，无论它安装在您的机器上。它使用<code class="fe mr ms mt mu b">Pipfile</code>来管理所有与项目相关的依赖项。我不打算在这里详细介绍Pipenv，所以将只使用项目所必需的命令。</p><p id="c89b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行<code class="fe mr ms mt mu b">pip install pipenv</code>可以通过PyPy安装Pipenv</p><p id="9f92" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装完成后，我们现在必须为我们的项目选择Python版本。我愿意使用Python 3.8版本，而不是我机器上已经安装的Py3.7。要安装Python 3.8，您只需运行以下命令:</p><p id="17d4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe mr ms mt mu b">pipenv install --python 3.8</code></p><p id="23b7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它将如下安装:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mv"><img src="../Images/ccc2b3d683587f25cd92451b3a70558d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Hyl8B2ubfGyOBnsX.png"/></div></div></figure><p id="4486" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你也可以运行<code class="fe mr ms mt mu b">pipenv install --three</code>，其中三表示Python 3.x。</p><p id="9187" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装完成后，你可以通过运行<code class="fe mr ms mt mu b">pipenv shell</code>命令来激活虚拟环境</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="224e" class="ni kt iq mu b gy nj nk l nl nm">➜  ContactAPIs pipenv shell<br/>Launching subshell in virtual environment…<br/> . /Users/AdnanAhmad/.local/share/virtualenvs/ContactAPIs-tI040CTn/bin/activate<br/>➜  ContactAPIs  . /Users/AdnanAhmad/.local/share/virtualenvs/ContactAPIs-tI040CTn/bin/activate</span></pre><p id="771d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦进入shell(您将看到类似于<em class="ly">(contact APIs)➜contact APIs</em>的提示)，您将能够安装所需的库。首先，我们将通过运行以下命令来安装Django:</p><p id="8073" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe mr ms mt mu b">pipenv install django</code></p><p id="945a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">注意是<em class="ly"> pipenv </em>，不是pip。当你进入外壳时，你将使用<code class="fe mr ms mt mu b">pipenv</code>。底层使用pip，但所有条目都存储在<code class="fe mr ms mt mu b">Pipfile</code>中。比运行<code class="fe mr ms mt mu b">pipenv install djangorestframework</code>后。<code class="fe mr ms mt mu b">Pipfile</code>将如下图所示:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="b1f0" class="ni kt iq mu b gy nj nk l nl nm">[[source]]<br/>name = "pypi"<br/>url = "<a class="ae mq" href="https://pypi.org/simple" rel="noopener ugc nofollow" target="_blank">https://pypi.org/simple</a>"<br/>verify_ssl = true</span><span id="6c3b" class="ni kt iq mu b gy nn nk l nl nm">[dev-packages]</span><span id="b6c8" class="ni kt iq mu b gy nn nk l nl nm">[packages]<br/>django = "*"<br/>djangorestframework = "*"</span><span id="0730" class="ni kt iq mu b gy nn nk l nl nm">[requires]<br/>python_version = "3.8"</span></pre><p id="9807" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们必须创建一个Django项目。为了创建Django项目，我们将运行如下的<code class="fe mr ms mt mu b">django-admin</code>命令:</p><p id="0fc6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe mr ms mt mu b">django-admin startproject contact_api .</code></p><p id="77a4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它将创建如下所示的目录结构:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="1b4c" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  ContactAPIs tree  contact_api<br/>contact_api<br/>├── __init__.py<br/>├── asgi.py<br/>├── settings.py<br/>├── urls.py<br/>└── wsgi.py</span></pre><p id="76fb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">到目前为止一切顺利，让我们看看是否可以运行本地开发服务器。运行命令<code class="fe mr ms mt mu b">python manage.py runserver</code>。如果一切顺利，您应该会看到如下所示的窗口:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d9f3b79cfd62734d4960480a0dfe5f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*6roXxnBfmo823OEV.png"/></div></figure><p id="c0fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">很美，不是吗？好的，让我们运行一些现有的迁移。为此，我们将运行命令<code class="fe mr ms mt mu b">python manage.py migrate</code>。</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="26c0" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  ContactAPIs python manage.py migrate  <br/>Operations to perform:<br/>  Apply all migrations: admin, auth, contenttypes, sessions<br/>Running migrations:<br/>  Applying contenttypes.0001_initial... OK<br/>  Applying auth.0001_initial... OK<br/>  Applying admin.0001_initial... OK<br/>  Applying admin.0002_logentry_remove_auto_add... OK<br/>  Applying admin.0003_logentry_add_action_flag_choices... OK<br/>  Applying contenttypes.0002_remove_content_type_name... OK<br/>  Applying auth.0002_alter_permission_name_max_length... OK<br/>  Applying auth.0003_alter_user_email_max_length... OK<br/>  Applying auth.0004_alter_user_username_opts... OK<br/>  Applying auth.0005_alter_user_last_login_null... OK<br/>  Applying auth.0006_require_contenttypes_0002... OK<br/>  Applying auth.0007_alter_validators_add_error_messages... OK<br/>  Applying auth.0008_alter_user_username_max_length... OK<br/>  Applying auth.0009_alter_user_last_name_max_length... OK<br/>  Applying auth.0010_alter_group_name_max_length... OK<br/>  Applying auth.0011_update_proxy_permissions... OK<br/>  Applying sessions.0001_initial... OK</span></pre><p id="5839" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Django默认使用Sqlite3，但是你可以通过改变设置来使用你最喜欢的RDBMS引擎。好了，所有与系统相关的表都创建好了。我们应该可以访问<code class="fe mr ms mt mu b">http://127.0.0.1:8000/admin/</code>但是我们无法登录。我们没有任何证件，怎么能够呢？所以现在，我们将创建一个超级用户。</p><p id="ab71" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe mr ms mt mu b">python manage.py createsuperuser --email me@example.com --username admin</code></p><p id="81dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它会提示您设置密码。完成后，你进入管理，你会看到一个类似如下的窗口:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4f830340484b6a0161f6835cf5253283.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*I_TBDppoUkFHHqCn.png"/></div></figure><p id="726c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们将创建一个Django应用程序。为此，首先我将进入<code class="fe mr ms mt mu b">contact_api</code>文件夹，然后运行以下命令:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="1d39" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  ContactAPIs cd contact_api <br/>(ContactAPIs) ➜  contact_api  django-admin startapp contact</span></pre><p id="7d02" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">之后，文件夹结构将如下所示:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="0acc" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  contact_api tree .<br/>.<br/>├── __init__.py<br/>├── asgi.py<br/>├── contact<br/>│   ├── __init__.py<br/>│   ├── admin.py<br/>│   ├── apps.py<br/>│   ├── migrations<br/>│   │   └── __init__.py<br/>│   ├── models.py<br/>│   ├── tests.py<br/>│   └── views.py<br/>├── settings.py<br/>├── urls.py<br/>└── wsgi.py</span></pre><p id="4460" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Django开发人员可能会发现在项目文件夹中创建应用程序并不常见，但DRF官方网站上推荐使用。你可以一直按照你的方式，从项目文件夹中创建一个应用程序。</p><p id="4687" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，我们将在<code class="fe mr ms mt mu b">INSTALLED_APPS</code>中包含我们的DRF框架和新创建的应用程序。因此，前往<code class="fe mr ms mt mu b">contact_api</code>文件夹中的<code class="fe mr ms mt mu b">settings.py</code>，添加如下条目:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="115e" class="ni kt iq mu b gy nj nk l nl nm">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',<br/>    'rest_framework',<br/>    'contact_api.contact',<br/>]</span></pre><p id="647d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">注意最后两个条目。我们添加了<code class="fe mr ms mt mu b">rest_framework</code>，这样我们就可以拥有API功能。其次，我们添加了新创建的应用程序。注意那条路。因为应用程序是在<code class="fe mr ms mt mu b">contact_api</code>文件夹中创建的，所以我们必须用点符号给出完整的路径。</p><p id="222c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们现在将为我们的API端点创建模型和视图。在<code class="fe mr ms mt mu b">models.py</code>文件中，我们将编写我们的模型。这个模型将是通过API检索或插入数据的唯一责任。</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="c5b0" class="ni kt iq mu b gy nj nk l nl nm">from django.db import models</span><span id="656a" class="ni kt iq mu b gy nn nk l nl nm"># Create your models here.<br/>class Contact(models.Model):<br/>    first_name = models.CharField(max_length=50)<br/>    last_name = models.CharField(max_length=50)<br/>    email = models.CharField(max_length=50)<br/>    address = models.CharField(max_length=100)</span></pre><p id="0efa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是我们有几个字段的模型。现在应该创建迁移，然后迁移它，以便可以在DB文件中生成模式。我们将运行命令<code class="fe mr ms mt mu b">python manage.py makemigrations contact</code>,它将产生如下输出:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="b2df" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  ContactAPIs python manage.py makemigrations contact  <br/>Migrations for 'contact':<br/>  contact_api/contact/migrations/0001_initial.py<br/>    - Create model Contact</span></pre><p id="25e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">迁移文件已创建。是时候迁移它了！</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="71dd" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  ContactAPIs python manage.py migrate               <br/>Operations to perform:<br/>  Apply all migrations: admin, auth, contact, contenttypes, sessions<br/>Running migrations:<br/>  Applying contact.0001_initial... OK<br/>(ContactAPIs) ➜  ContactAPIs</span></pre><p id="50fd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">除了创建以前的迁移之外，它还创建了我们刚刚创建的迁移。我们现在将在<code class="fe mr ms mt mu b">admin.py</code>中注册我们的模型，以便我们可以在管理界面中与模型交互:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="5310" class="ni kt iq mu b gy nj nk l nl nm">from django.contrib import admin<br/>from .models import Contact</span><span id="7224" class="ni kt iq mu b gy nn nk l nl nm"># Register your models here.<br/>admin.site.register(Contact)</span></pre><p id="b8f8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您访问<a class="ae mq" href="http://127.0.0.1:8000/admin," rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/admin，</a>您会在那里找到新创建的<strong class="jw ir">联系人</strong>模型。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/1ed7e2d261f1e6c7ba4e748b1517dcbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*vgvynFi-DPY0IB9b.png"/></div></figure><p id="a89a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我们将创建视图和数据序列化程序。</p><p id="0287" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我们将创建序列化程序。</p><p id="caa6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">序列化器</strong>帮助将模型和<em class="ly">查询集</em>转换成本地Python数据类型，这样它们就可以呈现为JSON或XML。因为它们序列化数据，所以你总是可以将它们反序列化回模型和查询集。序列化文件将如下所示:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="a26e" class="ni kt iq mu b gy nj nk l nl nm">from rest_framework import serializers</span><span id="7d38" class="ni kt iq mu b gy nn nk l nl nm">from .models import Contact</span><span id="aea6" class="ni kt iq mu b gy nn nk l nl nm">class Contactializer(serializers.HyperlinkedModelSerializer):<br/>    class Meta:<br/>        model = Contact<br/>        fields = ('id', 'url', 'first_name', 'last_name', 'email', 'address')</span></pre><p id="b5b1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在导入了必要的类之后，我们创建了一个类，并提到了我们想要序列化的类。我们还提到了我们希望公开哪些字段，从而进行序列化。</p><p id="b956" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我们将创建视图，为此，我们将使用视图集。</p><p id="14f6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">视图集将多个视图的逻辑组合在一个类中。</p><p id="70eb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们必须设置我们的API端点，为此，我们必须做一些艰苦的工作。首先，我们必须在我们的app文件夹中创建一个文件<code class="fe mr ms mt mu b">urls.py</code>，即<code class="fe mr ms mt mu b">contact</code>文件夹。</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="c61a" class="ni kt iq mu b gy nj nk l nl nm">from rest_framework import routers<br/>from django.urls import path,include<br/>from . import views</span><span id="44e6" class="ni kt iq mu b gy nn nk l nl nm">router = routers.DefaultRouter()<br/>router.register('contacts', views.ContactView)</span><span id="9075" class="ni kt iq mu b gy nn nk l nl nm">urlpatterns = [<br/>    path('',include(router.urls))<br/>]</span></pre><p id="1897" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里你将学习一个新概念，<a class="ae mq" href="https://www.django-rest-framework.org/api-guide/routers/#routers" rel="noopener ugc nofollow" target="_blank">路由器</a>。如果您有Laravel、Rails甚至NodeJS的背景，您应该对路由器的功能有所了解；它将请求路由到适当的资源。DRF提供三种路由器:简单路由器、默认路由器和定制路由器。默认路由器类似于简单路由器，它返回所有与CRUD相关的端点以及每个记录端点的URL和可选的JSON视图。接下来，我们将视图集注册到一个根名称中，这里是<strong class="jw ir"> contacts </strong>。因此，所有的端点都将在API端点中包含<code class="fe mr ms mt mu b">contacts/</code>。注册后，您将使用相同的旧<code class="fe mr ms mt mu b">include</code>来设置端点的路径，包括<code class="fe mr ms mt mu b">router.urls</code>。在RoR和Laravel世界中，这些被称为<em class="ly">足智多谋的路由</em>，因为你不必为<em class="ly">创建</em>、<em class="ly">更新</em>、<em class="ly">获取、发布</em>和<em class="ly">删除</em>创建单独的视图和它们各自的URL。当然，您总是可以通过添加一个方法并用一个<code class="fe mr ms mt mu b">@action</code>装饰器进行装饰来添加您自己的定制端点。例如，检查以下内容:</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="a420" class="ni kt iq mu b gy nj nk l nl nm"><a class="ae mq" href="http://twitter.com/action" rel="noopener ugc nofollow" target="_blank">@action</a>(detail=False, methods=['get'])<br/>    def lol(self, request, pk=None):<br/>        return Response({'status': 'OK'})</span></pre><p id="2299" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里，我们添加了另一个自定义路由，因此当用户访问<code class="fe mr ms mt mu b">http://127.0.0.1:8000/contacts/lol/</code>时，它会返回一个JSON响应。我们设置<code class="fe mr ms mt mu b">detail=False</code>是因为它不是一个资源丰富的端点，因此只服务于单个端点。</p><p id="5928" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，事情不会就此结束。接下来，我们必须将我们的API添加到主<code class="fe mr ms mt mu b">urls.py</code>中，为此我们将在<code class="fe mr ms mt mu b">contact/urls.py</code>中执行以下操作</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="b82d" class="ni kt iq mu b gy nj nk l nl nm">from django.contrib import admin<br/>from django.urls import path,include</span><span id="85b3" class="ni kt iq mu b gy nn nk l nl nm">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('',include('contact_api.contact.urls')),<br/>]</span></pre><p id="5b0b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，除了管理，我们终于有我们的API包含在主项目的<code class="fe mr ms mt mu b">urls.py</code>中，这使得它可以探索除了管理或其他应用程序URL的API。</p><p id="eea0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在是品尝我们努力成果的时候了。在你的浏览器上点击<a class="ae mq" href="http://127.0.0.1:8000/contacts/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/contacts/</a>，你会看到如下内容:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/cfa825d4a93c28e578df269244413343.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*Dtqu66d5qliNgrz8.png"/></div></figure><p id="7ffa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它显示了一个添加记录和其他东西的漂亮界面。您还会看到一个额外的选项按钮，这是我们刚刚添加的自定义方法。让我们一起玩吧。我为您创建了一个动画Gif，让您看看如何以HTML和JSON格式添加记录。记录是如何被列出的，单个记录是如何被浏览的。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ebb79503b371e0476dbf1dd63b6f35cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*u980OVWd-4JoZeYT.gif"/></div></figure><p id="91ea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当然，当你通过CURL或其他库直接访问它时，你不会看到所有这些基于HTML的界面。</p><pre class="mw mx my mz gt ne mu nf ng aw nh bi"><span id="857c" class="ni kt iq mu b gy nj nk l nl nm">(ContactAPIs) ➜  ContactAPIs curl <a class="ae mq" href="http://127.0.0.1:8000/contacts/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/contacts/</a><br/>[{"id":1,"url":"<a class="ae mq" href="http://127.0.0.1:8000/contacts/1/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/contacts/1/</a>","first_name":"Adnan","last_name":"Ahmad","email":"<a class="ae mq" href="mailto:adnan@mail.com" rel="noopener ugc nofollow" target="_blank">adnan@mail.com</a>","address":"A29 Sweet House"},{"id":2,"url":"<a class="ae mq" href="http://127.0.0.1:8000/contacts/2/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/contacts/2/</a>","first_name":"Ali","last_name":"Ahmad","email":"<a class="ae mq" href="mailto:ali@email.com" rel="noopener ugc nofollow" target="_blank">ali@email.com</a>","address":"5th Street New way Town"}]%</span></pre><p id="80b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">哦BTW，可以随时访问<a class="ae mq" href="http://127.0.0.1:8000/contacts/lol/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/contacts/LOL/</a>LOL！！</p><h1 id="c648" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">结论</h1><p id="85cd" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">在本教程中，您了解了如何使用Django Rest框架在Python中创建REST APIs。我刚刚给了你一个介绍，你还可以做更多的事情，比如在登录/密码后面保护某个API端点，或者使用JWT或其他现代认证机制。我会在接下来的文章中介绍它们。和往常一样，代码可以在<a class="ae mq" href="https://github.com/kadnan/django-rest-framework-api-tutorial" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><p id="79cc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ly">原载于2020年7月27日</em><a class="ae mq" href="http://blog.adnansiddiqi.me/create-your-first-rest-api-in-django-rest-framework" rel="noopener ugc nofollow" target="_blank"><em class="ly">http://blog . adnansiddiqi . me</em></a><em class="ly">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Observables in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度的可观测量</h1>
<blockquote>原文：<a href="https://itnext.io/observables-in-angular-176b8010a4cd?source=collection_archive---------6-----------------------#2018-05-20">https://itnext.io/observables-in-angular-176b8010a4cd?source=collection_archive---------6-----------------------#2018-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3d0a3c16a3154518debfdef223a0b53b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7aJPlxn8gwhI7JjcBFr-tQ.jpeg"/></div></div></figure><p id="9a54" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好，</p><p id="ac2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你们都过得很好。让我们开始了解可观测值，以及我们为什么要使用它。</p><h1 id="12ce" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">有哪些可观察到的现象？</h1><p id="8ff9" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">angular中的可观察值用于确保API调用是否返回特定的属性。</p><p id="3503" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Observables帮助您管理异步数据，比如来自后端服务的数据。Observables在Angular内部使用，包括Angular的事件系统和它的HTTP客户端服务。为了使用observables，Angular使用了一个名为Reactive Extensions (RxJS)的第三方库。</p><p id="45ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想了解更多的细节，请查看下面的链接。https://angular.io/guide/observables<br/>T3</p><h1 id="d5ab" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">■有什么好处？</strong></h1><ol class=""><li id="974f" class="ma mb iq ka b kb lu kf lv kj mc kn md kr me kv mf mg mh mi bi translated">可观测量用于具有不同-2属性的数据。</li></ol><p id="7a65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.Observables实际上验证数据及其类型和性能，这比以旧的方式调用API要好得多。</p><p id="d07e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.为了应用程序的良好性能，并确保返回特定类型的数据，我们确实建议这样做。</p><p id="550b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Angular利用observables作为接口来处理各种常见的异步操作。例如:EventEmitter类扩展Observable。HTTP模块使用observables来处理AJAX请求和响应。</p><p id="a2ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">路由器和表单模块使用observables来监听和响应用户输入的事件。</p><h1 id="1c35" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">如何使用？</strong> <br/> <strong class="ak"> Step-1 </strong>我们来创建一个有角度的app，</h1><p id="99b3" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">去你的终端。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="d9a5" class="ms kx iq mo b gy mt mu l mv mw">ng new observable-app</span></pre><p id="0330" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Step-2 </strong>现在在不到30秒的时间内，用零编码创建一个完整的伪REST API。这里我使用了json-server。</p><p id="052d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae lz" href="https://github.com/typicode/json-server" rel="noopener ugc nofollow" target="_blank">https://github.com/typicode/json-server</a></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="6486" class="ms kx iq mo b gy mt mu l mv mw">npm install -g json-server</span></pre><p id="1a5b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤3 </strong>在根目录下创建一个db.json文件。</p><p id="94cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看起来，</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="ebc9" class="ms kx iq mo b gy mt mu l mv mw">{<br/>  "languages": [<br/>      "Java",<br/>      "c#",<br/>      "Python"<br/>  ],<br/>  "student": {<br/>      "id": 123,<br/>      "name": "john",<br/>      "phone": "123456",<br/>      "age": 21<br/>  },<br/>  "orderbook": {<br/>      "BuyOrders": [{<br/>              "OrderType": "LimitBid",<br/>              "Price": 497.02000000,<br/>              "Volume": 0.01000000<br/>          },<br/>          {<br/>              "OrderType": "LimitBid",<br/>              "Price": 490.00000000,<br/>              "Volume": 1.00000000<br/>          }<br/>      ],<br/>      "CreatedTimestampUtc ": "2014-08-05T06:42:11.3032208Z",<br/>      "SellOrders": [{<br/>              "OrderType": "LimitOffer",<br/>              "Price": 500.00000000,<br/>              "Volume": 1.00000000<br/>          },<br/>          {<br/>              "OrderType": "LimitOffer",<br/>              "Price": 505.00000000,<br/>              "Volume": 1.00000000<br/>          }<br/>      ]<br/>  },<br/>  "rates": [<br/>      {<br/>          "CurrencyCodeA": "Aud",<br/>          "CurrencyCodeB": "Usd",<br/>          "Rate": 0.86830000<br/>      }, {<br/>          "CurrencyCodeA": "Usd",<br/>          "CurrencyCodeB": "Aud",<br/>          "Rate": 1.15170000<br/>      }<br/>  ],<br/>  "latestprices": {<br/>      "status": "ok",<br/>      "prices": {<br/>          "btc": {<br/>              "bid": "2352",<br/>              "ask": "3422",<br/>              "last": "5232"<br/>          },<br/>          "ltc": {<br/>              "bid": "0.342",<br/>              "ask":"0.343",<br/>              "last": "0.643"<br/>          },<br/>          "doge": {<br/>              "bid": "23.5",<br/>              "ask": "23.543",<br/>              "last": "234"<br/>          }<br/>      }<br/>  }<br/>}</span></pre><p id="9b91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后运行这个json-server来获得输出。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="34a3" class="ms kx iq mo b gy mt mu l mv mw">json-server --watch db.json --port 4201</span></pre><p id="fc3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我用的是—端口4201，你可以在任何你喜欢的端口运行，除了4200(因为已经被angular捕获了)。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/5f851afbdecb7ffb79f5e38c6efd4c9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*W9dtDSBT2awBQI-W.png"/></div></figure><p id="c7d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Step-4 </strong>这里我们有一个数据，里面包含了多种类型的值，比如integer，string。</p><p id="cddc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了识别api的数据类型，我将在/app目录中创建一个模型。这对那些已经在同一个项目中工作的人或者新成员来说是非常有益的。因为它们不需要调用api并检查数据类型或检查DB表来识别数据类型。</p><p id="639d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">/app/models/ → student.ts</p><p id="4fa4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">→ orderbook.ts</p><p id="7fa2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> student.ts </strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="e57e" class="ms kx iq mo b gy mt mu l mv mw">export interface Student {<br/>  'id': number;<br/>  'name': string;<br/>  'phone': string;<br/>  'age': number;<br/>}</span></pre><p id="789e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> orderbook.ts </strong>，</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="0efd" class="ms kx iq mo b gy mt mu l mv mw">export interface OrderBook {<br/>  BuyOrders: Array&lt;{<br/>      OrderType: string,<br/>      Price: number,<br/>      Volume: number<br/>  }&gt;;<br/>  CreatedTimestampUtc: string;<br/>  SellOrders: Array&lt;{<br/>      OrderType: string,<br/>      Price: number,<br/>      Volume: number<br/>  }&gt;;<br/>}</span></pre><p id="b207" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么，我们的API现在已经准备好了。让我们在服务中调用这些API。</p><p id="25d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个与数据通信的新服务。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="4446" class="ms kx iq mo b gy mt mu l mv mw">ng g service apitest</span></pre><p id="31b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">apitest.service.ts</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="05f2" class="ms kx iq mo b gy mt mu l mv mw">import { Injectable } from '@angular/core';<br/>import { HttpClient } from '@angular/common/http';<br/>import { Observable } from 'rxjs/Observable';<br/><br/>import { Student } from './models/student';<br/>import { OrderBook } from './models/orderbook';<br/><br/>@Injectable()<br/>export class ApitestService {<br/><br/>  languages:string = 'http://localhost:4201/languages';<br/>  student:string = 'http://localhost:4201/student';<br/>  orderBook:string = 'http://localhost:4201/orderbook';<br/><br/>  constructor(private httpClient: HttpClient) { }<br/><br/>  getLanguages(): Observable&lt;any&gt; {<br/>    return this.httpClient.get(this.languages);<br/>  }<br/><br/>  getStudent(): Observable&lt;Student&gt; {<br/>    return this.httpClient.get&lt;Student&gt;(this.student);<br/>  }<br/><br/>  getOrderBook(): Observable&lt;OrderBook&gt; {<br/>    return this.httpClient.get&lt;OrderBook&gt;(this.orderBook);<br/>  }<br/>}</span></pre><p id="5f9d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在导入一些重要的库和服务</p><p id="3869" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> app.module.ts </strong>中，</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="0754" class="ms kx iq mo b gy mt mu l mv mw">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { HttpClientModule } from '@angular/common/http';<br/><br/><br/>import { AppComponent } from './app.component';<br/>import { ApitestService } from './apitest.service';<br/><br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    HttpClientModule<br/>  ],<br/>  providers: [ApitestService],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="bc98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我在<strong class="ka ir">导入</strong>部分导入了<strong class="ka ir"> HttpClientModule、ApitestService </strong>和<br/>，在<strong class="ka ir">提供者</strong>中添加了<strong class="ka ir"> HttpClientModule </strong>和<br/>，添加了<strong class="ka ir"> ApitestService </strong>。</p><p id="d846" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第7步</strong> <br/>转到<strong class="ka ir"> app.component.ts </strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="353f" class="ms kx iq mo b gy mt mu l mv mw">import { Component, OnInit } from '@angular/core';<br/>import { ApitestService } from './apitest.service';<br/><br/>@Component({<br/>  selector: 'app-root',<br/>  templateUrl: './app.component.html',<br/>  styleUrls: ['./app.component.css']<br/>})<br/>export class AppComponent implements OnInit {<br/>  constructor(private apitest: ApitestService) {}<br/><br/>  ngOnInit() {<br/>    this.getLanguages();<br/>    this.getStudent();<br/>    this.getOrderBook();<br/>  }<br/><br/>  getLanguages() {<br/>    this.apitest.getLanguages().subscribe(function(data) {<br/>      console.log('languages', data);<br/>    });<br/>  }<br/><br/>  getStudent() {<br/>    this.apitest.getStudent().subscribe(function(data) {<br/>      console.log('Student', data);<br/>    });<br/>  }<br/><br/>  getOrderBook() {<br/>    this.apitest.getOrderBook().subscribe(function (data) {<br/>      console.log("Order Book", data);<br/>    });<br/>  }<br/>}</span></pre><p id="223f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们有获得结果的方法，并在<strong class="ka ir"> ngOnInit() </strong>中调用这些方法。</p><p id="2b3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">Step-8</strong>T23】所以我们准备检查结果。启动ng服务器。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="2c90" class="ms kx iq mo b gy mt mu l mv mw">ng s</span></pre><p id="62cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">去<a class="ae lz" href="http://localhost:4200/" rel="noopener ugc nofollow" target="_blank">http://localhost:4200/</a><br/>这里是结果，</p><p id="e33d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 1。getLanguages() </strong></p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/0e9bb0cb0a42c36a3f812a49331eb208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/0*9UkX7tflQK9VR59_.png"/></div></figure><p id="3618" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 2。getStudent() </strong></p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/6e6b5f1fa8ed20e3f8ec889567d6700a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*CSfyqRbmFSxotj-j.png"/></div></figure><p id="c43d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 3。getOrderBook() </strong></p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/d6176c5eb41c90992bf11e7a958de169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/0*S4CTlbYj0A2gMryG.png"/></div></figure><p id="033b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我添加了一些其他复杂的场景。请签入git repo。<br/> <strong class="ka ir">下面是git回购，供大家参考。</strong><br/><a class="ae lz" href="https://github.com/alokrawat050/observable-app" rel="noopener ugc nofollow" target="_blank">https://github.com/alokrawat050/observable-app</a></p><p id="0ef0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望对你有帮助。</p><p id="f3e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">享受编码…</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/7e1a877dbae8ca6d05549b02e73b0c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*X-LuRAIHAqua4yia.png"/></div></figure><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/4d46b00ee8a63b848742cc859368a080.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*__doS5u4MPJhbFvk.png"/></div></figure></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="0145" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ni">原载于qiita.com</em><a class="ae lz" href="https://qiita.com/alokrawat050/items/f334c83dfd247c3f6304" rel="noopener ugc nofollow" target="_blank"><em class="ni"/></a><em class="ni">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>How-to: Create a custom ProgressView with SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何:使用SwiftUI创建自定义ProgressView</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-a-custom-progressview-with-swiftui-e1edb443a68e?source=collection_archive---------1-----------------------#2021-06-27">https://itnext.io/how-to-create-a-custom-progressview-with-swiftui-e1edb443a68e?source=collection_archive---------1-----------------------#2021-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/160fdba82870344a62e7bca6a5aaf468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M7j5Ua7hHBDqPmAc"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@nickpage?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">尼克·佩奇</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="f968" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于在iOS或MacOS应用程序中创建进度条视图，您可能已经熟悉了UIKit或SwiftUI中的ProgressView元素，并且可能还知道它如何缺少简单的定制。默认实现只是一个填充蓝色的细条:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/9574c82287560670a3ff9c8418fb0fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*GA6Vi50E4PjBk5BZCco7fw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">系统的默认进度视图</figcaption></figure><p id="857e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">定制视图修改器，如<em class="lg">背景</em>、<em class="lg">高度</em>、<em class="lg">等</em>。将会改变视图的所有内容，但不改变工具栏本身。</p><p id="5053" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它将保持原样——蓝色而朴素。</p><p id="431e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想有自己的自定义进度条，你有两个选择:</p><ol class=""><li id="b0ba" class="lh li iq kf b kg kh kk kl ko lj ks lk kw ll la lm ln lo lp bi translated">创建你自己的进度条视图并实现它</li><li id="c2cd" class="lh li iq kf b kg lq kk lr ko ls ks lt kw lu la lm ln lo lp bi translated">根据Apple提供的ProgressViewStyle协议，创建您的自定义进度条视图样式</li></ol><p id="7338" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文将关注后者，尽管您也可以轻松地获取代码，用绑定扩展它，并拥有自己的视图而不是样式——这根本没有什么意义。</p><blockquote class="lv lw lx"><p id="d84f" class="kd ke lg kf b kg kh ki kj kk kl km kn ly kp kq kr lz kt ku kv ma kx ky kz la ij bi translated">扩展现有的协议也应该是首选的方式，因为重新发明轮子很少是一个好主意。</p></blockquote></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="5bb9" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">目标</h1><p id="5fed" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">像往常一样，让我们先看看我们最终想要达到的目标:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/61032d99b0295a8e4fa65f79b8e8c810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*_htXdfdujcD_4_6b3fiXdA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我们想要实现的最终进度视图</figcaption></figure><p id="be62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想用一个更宽的颜色渐变条代替蓝色细条，而不是简单的颜色。此外，我们希望能够设置一个显示在视图下方的可选标签。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="c6e0" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">协议</h1><p id="b49e" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">苹果为我们提供了一个在SwiftUI中创建自定义流程视图样式的协议:<a class="ae kc" href="https://developer.apple.com/documentation/swiftui/progressviewstyle" rel="noopener ugc nofollow" target="_blank"> ProgressViewStyle </a>。</p><p id="b38f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">协议本身有一个方法要求:</p><p id="a66f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nm nn no np b">func makeBody(configuration: Self.Configuration) -&gt; Self.Body</code></p><p id="6062" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个函数基本上构建了我们的定制进度视图。在其中，我们定义了视图的主体以及任何属性、样式等。—其实和<a class="ae kc" href="https://developer.apple.com/documentation/swiftui/viewmodifier" rel="noopener ugc nofollow" target="_blank"> ViewModifier </a>协议的<strong class="kf ir">func body(Content:Content)-&gt;some View</strong>函数很像。如果您了解ViewModifier，那么将这一知识应用到样式协议中应该很容易。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="cc04" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">风格</h1><p id="7809" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">创建定制的进度视图样式实质上意味着定义整个视图主体，而不仅仅是对其进行样式化。</p><p id="2bcf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于进度视图样式的主体，我们使用ZStack，我们将它包装在VStack中，以提供标签的可能性。此外，我们添加了一些变量来定制选项(如背景、高度等。):</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="a240" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第4–9行是用于定制我们的定制视图的属性。我们的大多数属性都有默认值，所以只有<em class="lg">笔画</em>和<em class="lg">填充</em>是必需的，其余的都是可选的。</p><p id="bcc4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在ZStack中，我们放置了一个GeometryReader来动态地读取视图的宽度，然后根据进度视图的当前值，使用这个宽度作为封闭矩形的宽度。如果用户旋转屏幕或改变视图分辨率，进度条状态应该是相同的，只是缩放到新的宽度。</p><p id="85fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以从makeBody函数内部的给定配置对象中读取进度条的当前值。值<em class="lg">configuration . fraction completed</em>以一个从0到1的双精度值的形式表示当前完成的总工作量的一部分。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="d998" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">实施</h1><p id="ef64" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">让我们看看如何实现我们的自定义进度条。代替进度条的静态值，我们将使用定义进度条状态的滑块视图。有了它，我们可以动态地改变标杆。</p><p id="575a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了简单起见，我们只使用ContentView.swift文件来实现——在现实生活中，最好将它拆分为单独的文件:</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">内容视图. swift</figcaption></figure><p id="be6d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一行(3–36)是我们之前章节中的进度条样式。</p><p id="8c1a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第39–75行是实现本身。一如既往，它应该是非常直截了当的。首先，我们为值、输入状态(滑块)和进度条的渐变定义了一些状态变量。</p><p id="171e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第59–61行，您可以看到ProgressView实现附加了我们的自定义样式和一些垂直填充。不要太花哨…</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="00e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们运行代码并转动滑块手柄，我们的进度条将会和上面看到的一模一样。这篇how-to应该给出了一些如何创建定制进度视图的基本概念，这样您现在就可以轻松地创建自己的视图，或者只是从这里获取代码并扩展它。</p></div></div>    
</body>
</html>
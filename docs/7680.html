<html>
<head>
<title>The day I chose Lua over Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">那天我选择了Lua而不是Javascript</h1>
<blockquote>原文：<a href="https://itnext.io/the-day-i-chose-lua-over-javascript-ba97b3c732b9?source=collection_archive---------0-----------------------#2022-12-19">https://itnext.io/the-day-i-chose-lua-over-javascript-ba97b3c732b9?source=collection_archive---------0-----------------------#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/c4015e783d6aa2e5927604e0994e29e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*A240hQnv-DQsFRGuKhiOTw.png"/></div></figure><p id="d109" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">过去两年我一直在Tabnine工作。</p><p id="9ac6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Tabnine是一个很棒的AI代码生成工具，可以直接在你的IDE中运行，提供内嵌的、整行的、全功能的代码完成。</p><p id="79e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">虽然Tabnine可以在几个IDE上工作，但它不支持Vim(准确地说是Neovim)中的全功能完成，这是我选择的IDE。</p><p id="e96e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我对开发一个不能日常使用的产品感到有些不舒服——所以我决定在Vim中提供全功能的完成。</p><h1 id="01d9" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">入门指南</h1><p id="464d" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">在完成了VS代码和Intellij插件之后，我知道首先我需要确保虚拟线API存在于Neovim中。</p><p id="b135" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我谷歌了一下<a class="ae lv" href="https://twitter.com/neovim/status/1442152074523734020?lang=en" rel="noopener ugc nofollow" target="_blank">发现了这个</a>。</p><p id="3834" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">太好了！</p><p id="2f2f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">虽然我已经使用Vim很多年了——并且有了相当不错的配置集——但是我从来没有真正为它开发过东西——我主要是将其他插件的配置复制粘贴到我的<code class="fe lw lx ly lz b">init.vim</code>文件中。</p><p id="75a6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">那么，我应该从哪里开始呢？</p><p id="91b1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我从过去的经验中(主要是从使用其他插件中)知道Neovim插件是用Lua或Viml编写的。</p><p id="cf4a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Viml看起来什么都不像，所以它马上就被搁置了，而且我从来没有用Lua编码过..语法看起来有点…嗯。</p><p id="6410" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">希望我可以避免使用Lua，我在网上搜索其他解决方案。</p><p id="ca45" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是第一个引起我注意的东西。T12】</p><p id="6204" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Neovim的节点客户端！嘣，我不能指望更多了。我最初的想法是派生出<code class="fe lw lx ly lz b">tabnine-vscode</code>项目(用typescript编写),并迅速为Neovim做出调整。我估计最多要花两天时间！</p><p id="492d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">1小时后，我已经很沮丧了。即使是最简单的事情也几乎没有文档。我勉强运行了最基本的例子。</p><p id="1bfd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我试图搜索用这个SDK编写的Neovim插件，以了解如何开始。实际上没有。我看了看<code class="fe lw lx ly lz b">node-client</code>回购——它勉强维持着。但是我还没准备好放弃。</p><p id="ffad" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在花了几个小时试图调整<code class="fe lw lx ly lz b">tabnine-vscode</code>插件后，我设法得到了一些基本的配置来运行。但是感觉还是没有烤熟。然而，由于没有文档或示例，我陷入了困境。我意识到我走错了路。</p><p id="eb87" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我搜索了Neovim的GitHub页面，在那里我找到了Neovim的Python客户端<code class="fe lw lx ly lz b">pynvim</code>。太好了！大家都爱Python！我以为会有大量的Python插件。不对。令我惊讶的是，几乎没有。</p><p id="f73a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，我知道了，尼奥维姆。我去学Lua！</p><h1 id="b32b" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">接受我的命运</h1><p id="e08f" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">根据Lua.org的说法，Lua是一种通用嵌入式编程语言，旨在用数据描述工具支持过程化编程。</p><p id="d4fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Lua的Neovim运行时非常简单，所以我理解为什么开发者选择它。</p><h1 id="2621" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">全局Vim对象</h1><p id="fafa" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">Nevim公开了一个全局vim对象，以便与其API进行交互，例如:</p><p id="a73f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe lw lx ly lz b">vim.fn.col(“.”)</code>获取光标下的当前列。</p><p id="2f4e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或<code class="fe lw lx ly lz b">vim.api.nvim_buf_set_text</code>将文本添加到缓冲区。</p><p id="1681" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个API的文档很棒，可以用<code class="fe lw lx ly lz b">:help</code>命令很容易地搜索到。</p><p id="3a08" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我还了解到，虽然Lua本身缺少简单的操作，如<code class="fe lw lx ly lz b">array.map</code>或<code class="fe lw lx ly lz b">string.split</code>(或者Lua行话中的表格)，但Neovim会公开它们，例如<code class="fe lw lx ly lz b">vim.tbl_map</code>或<code class="fe lw lx ly lz b">vim.fn.split</code>。</p><h1 id="213a" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">简单</h1><p id="ad69" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">Lua怀念卷曲的作用域，这是我在编程语言中不喜欢的。但是我已经学会喜欢它的简单。语法类似于其他高级语言——与Viml相反。</p><p id="ea62" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您不需要习惯任何花哨/复杂的语法，从而缩短了学习曲线。</p><p id="0858" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">基本上，Lua完美地完成了它的工作，即嵌入到其他平台中。</p><h1 id="8d4d" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">Lua模块</h1><ul class=""><li id="ef00" class="ma mb iq jw b jx lq kb lr kf mc kj md kn me kr mf mg mh mi bi translated">Lua模块类似于Javascript commonjs模块</li><li id="0db7" class="ma mb iq jw b jx mj kb mk kf ml kj mm kn mn kr mf mg mh mi bi translated">Vim有一个运行时路径的概念，即它在运行时查找模块的目录列表</li><li id="4383" class="ma mb iq jw b jx mj kb mk kf ml kj mm kn mn kr mf mg mh mi bi translated">Vimplug(和其他插件管理器)为您将插件加载到运行时路径中</li><li id="1e7c" class="ma mb iq jw b jx mj kb mk kf ml kj mm kn mn kr mf mg mh mi bi translated">当Lua模块位于运行时路径中时，可以通过在<code class="fe lw lx ly lz b">init.vim</code> / <code class="fe lw lx ly lz b">init.lua</code>中使用<code class="fe lw lx ly lz b">require(‘module-name’)</code>来轻松加载它</li></ul><h1 id="573e" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">证明文件</h1><p id="50f8" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">Vimdocs很好地覆盖了Vim全局对象下的所有Lua函数。</p><p id="bd63" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Lua文档<a class="ae lv" href="https://www.lua.org/docs.html" rel="noopener ugc nofollow" target="_blank">也相当不错</a>。该网站看起来像90年代的东西，但内容还不错。</p><h1 id="94ca" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">摘要</h1><p id="b440" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">我绝对能理解为什么大家写Neovim插件都选择Lua。</p><p id="5882" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">感觉node &amp; Python客户端只是Neovim团队为了让插件开发更容易而进行的一次不成功的实验，而Lua的工作方式正是它的本意。</p><p id="a105" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，当你克服了学习一门新语言的学习曲线，这甚至是简单的，我敢说——快乐的！</p><p id="541f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">底线:</strong> <a class="ae lv" href="https://github.com/nanotee/nvim-lua-guide" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">当你开发Neovim插件</strong> </a> <strong class="jw ir">的时候，选择Lua。你甚至可能会喜欢它🙂</strong></p><p id="fe44" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">neovim的Tabnine试试吧！https://github.com/codota/tabnine-nvimT2</p></div></div>    
</body>
</html>
<html>
<head>
<title>From no-sql database to Firestore &amp; AngularFire</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从非sql数据库到Firestore &amp; AngularFire</h1>
<blockquote>原文：<a href="https://itnext.io/from-no-sql-database-to-firestore-angularfire-82dc13ecda65?source=collection_archive---------5-----------------------#2018-07-13">https://itnext.io/from-no-sql-database-to-firestore-angularfire-82dc13ecda65?source=collection_archive---------5-----------------------#2018-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6dd6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你有没有想过firestore独特的query格式不同于任何其他nosql … <br/> Firestore是由google的Firebase团队创建的超级强大的数据库，但是当我们想要迁移我们在另一个数据库中的数据，并且我们发现我们处理状态数据，而这些数据在Firestore的查询中没有得到同等的处理时会发生什么呢…</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/144ab9fdddbb22cef7c01c58e0a9b2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijwRLDPUlke-7twDinUvSg.jpeg"/></div></div></figure><p id="4b35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们想从mongodb迁移到firestore…</p><p id="0cf3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们正在迁移的是一个聊天…一个聊天通常有数据，如谁发送它，谁接收它，最重要的是它有一个重要的数据，著名的双蓝检查，或者说是read的后续。</p><p id="0fcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么我们就会有一个类似于这个的结构:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/805361adf90bea1142deb50cd448b815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9im_IjBxBA9sI7lQQsuzfQ.png"/></div></div></figure><p id="474e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了这种格式，我们就可以轻松地进行查询，确定它是真还是假，读取它们，因为只有两种状态，如果我们想看到“读数”，我们就去找那些为真的，相反的是“未读的”</p><p id="85f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们考虑一下如何进行查询:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/0e7a84e125ff36204b217d93b56c0183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krQaHIQwe-cEseVq4PAYLQ.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/58209283ad36d580a78693ef93f19846.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*P_j3Ducx8Aj4qE3cHo0p-w.jpeg"/></div></figure><p id="5160" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是有更多的“状态”实际上读取或不读取…我们必须识别“通过发送”，“发送”，“接收/不读取”，“接收/读取”</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi la"><img src="../Images/5eb813375b7afd6737c7fb56727ac11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*DiX3IpEpnST9CiBZcYel3Q.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lb"><img src="../Images/d6164465c0f68d48ffc33611f037b0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sz2Sg58EJSpwLWh9udxqXQ.png"/></div></div></figure><p id="d79b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，会有什么问题呢？这很简单，我可以添加更多的“where ”,并通过2或3个不同的“allRead”进行过滤，在MongoDB中可以，但在firestore中不行</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/ae52b06b50751c085585a4b5afb97c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*ChMf4j6WKQG0z7XTO4cnGw.gif"/></div></figure><p id="6c9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在firestore中，我们必须生成这种类型的结构:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lb"><img src="../Images/bdaaff07c86e76b34c33dcebe424dbcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7PfCBObtSCQ_kkZLsG04bQ.png"/></div></div></figure><p id="0d20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，你是在告诉我我不能做迁移吗？</p><p id="7c9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实际上，如果我们想保持数据的格式，我们必须对代码做一些修改…</p><p id="7a10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以考虑的第一件事是调用不同的函数并推入一个通用数组:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/fa9d08f40f12541a8899c39461950292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFrmOrF9csJPELJNsIn7Dw.png"/></div></div></figure><p id="afb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，这样可以吗？<br/>这是最好的方法吗？<br/>不存在一件不用做那么多代码的事情吗？<br/>我一直在重复同样的话…</p><p id="4c5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢RXJS和一些小技巧，我们将能够改善我们对AngularFire和Firestore的体验</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/c370e9b7c745e4919589ccd820c78aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1f_qkwdoDwKIWzFRBLLaRw.gif"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/e62c303e484132d134d7f90c0c6f1b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h2cf3kr3O-EWBsBWobB9ww.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/0d95fa4d22b2e075a89edb5ba3a760a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*T-657J1OUtxKqgJs9whm3w.gif"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">RxJS我的宝贝</figcaption></figure><p id="6501" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过这种方式，感谢来自firestore的数据和数据，我们将能够融合数据，并能够完整地展示它们，而不用考虑我们有多少事情要做。</p><h2 id="2779" class="lj lk iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">但是它是如何工作的呢？</h2><p id="0152" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我们所做的是迭代数组，从而能够处理不同的返回，但firestore实际上提供的是一种“可观察的”,我们通过它发送我们在查询中请求的数据。<br/>通过这种方式，利用开关图，我们将能够获得所有可观察到的数据，并以这种方式将它们连接起来。<br/>一旦所有的数据都建立在同一个数组中，我们将制作映射来获取集合的数据以及每个数据的唯一ID，并将其传送到我们的列表中，以便正确地处理数据。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="0052" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请记住，该收集当然不包括真实聊天数据库中存在的所有真实数据，但它是一种解释我们如何使用非sql和Firestore的差异的方式。</p><p id="94b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该功能可以在:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mo mp l"/></div></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><blockquote class="mq mr ms"><p id="3dc8" class="jn jo mt jp b jq jr js jt ju jv jw jx mu jz ka kb mv kd ke kf mw kh ki kj kk ij bi translated">现在，你可以迁移到firestore :) …享受它</p></blockquote></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="a9d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Jorge在技术行业工作了9年多，是一名专注于JavaScript技术的全栈开发人员。今天，Jorge正在使用Angular/RxJS/Firebase/native script以及其他技术在ByteDefault工作。他讲授了几门课程和讲座，并就这些主题撰写了一些科技文章。正因为如此，他被认为是Angular &amp; web技术领域的Google开发者专家和Nativescript开发者专家。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="bfe8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在离开之前，我离开所有可能看到我在做什么的地方，或者只是被问候的地方=)。</p><div class="mx my gp gr mz na"><a href="https://twitter.com/jorgeucano" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd ir gy z fp nf fr fs ng fu fw ip bi translated">豪尔赫·卡诺(@jorgeucano) |推特</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">Jorge Cano的最新推文(@jorgeucano)。开发商——Amante de las nuevas technologias——AngularJS Dev——Creador…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">twitter.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no kv na"/></div></div></a></div><div class="mx my gp gr mz na"><a href="https://youtube.com/channel/UCdp9sM22GW5uIOaU9eZ7n6w" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd ir gy z fp nf fr fs ng fu fw ip bi translated">豪尔赫·卡诺</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">立即登录查看您的频道和推荐！</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">youtube.com</p></div></div><div class="nj l"><div class="np l nl nm nn nj no kv na"/></div></div></a></div></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="4ab7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读👌</p><p id="b209" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">法学家(jurisconsult)</p></div></div>    
</body>
</html>
<html>
<head>
<title>Why Are You Still Using Yarn in 2018?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2018年为什么还在用纱？</h1>
<blockquote>原文：<a href="https://itnext.io/why-are-you-still-using-yarn-in-2018-5803e6216232?source=collection_archive---------2-----------------------#2018-07-04">https://itnext.io/why-are-you-still-using-yarn-in-2018-5803e6216232?source=collection_archive---------2-----------------------#2018-07-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/115dbfe091c15bda4e526f4b82a9045d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*12V33OLPxvpryEfVqBB84A.jpeg"/></div></div></figure><p id="9a6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我记得当纱爆炸到现场。</p><p id="9e94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">速度超快。每隔<code class="fe kw kx ky kz b">yarn install</code>就节省几分钟。</p><p id="5238" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这确保了你的<code class="fe kw kx ky kz b">/node_modules</code>与你旁边好友的<code class="fe kw kx ky kz b">/node_modules</code>完全匹配。还有服务器上的<code class="fe kw kx ky kz b">/node_modules</code>。不要再说“这对我有用，\_(ツ)_/”。</p><p id="8f27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">而且，表情符号无处不在！🔥🔥🔥</p><p id="a1c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 6个月过去了……</strong></p><p id="4b3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">npm在v5中史诗般地卷土重来，带来了速度的提高和一致的<code class="fe kw kx ky kz b">/node_modules</code>。是的，所有这些原因让我们开始转向纱线。</p><p id="eb5e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">许多开发者现在想知道:</p><blockquote class="la"><p id="8d8d" class="lb lc iq bd ld le lf lg lh li lj kv dk translated"><em class="lk">“纱线还有必要吗？”</em></p></blockquote><p id="8dcc" class="pw-post-body-paragraph jy jz iq ka b kb ll kd ke kf lm kh ki kj ln kl km kn lo kp kq kr lp kt ku kv ij bi translated">我想是时候换回老样子了。让我们来看看。</p><h1 id="239e" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">npm和纱线一样快。</h1><p id="50e2" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">自己看:</p><pre class="mt mu mv mw gt mx kz my mz aw na bi"><span id="65cd" class="nb lr iq kz b gy nc nd l ne nf"># Backup<br/>mv node_modules node_modules_backup<br/>mv package-lock.json package-lock.backup.json<br/>mv yarn.lock yarn.backup.lock<br/><br/># Test cold npm speed<br/>time npm install</span><span id="1758" class="nb lr iq kz b gy ng nd l ne nf"># Reset modules<br/>rm -Rf node_modules</span><span id="5061" class="nb lr iq kz b gy ng nd l ne nf"># Test warm npm speed<br/>time npm install</span><span id="e4a5" class="nb lr iq kz b gy ng nd l ne nf"># Test cold yarn speed<br/>time yarn install<br/>    <br/># Reset modules<br/>rm -Rf node_modules</span><span id="d0b9" class="nb lr iq kz b gy ng nd l ne nf"># Test warm yarn speed<br/>time yarn install</span><span id="8e7c" class="nb lr iq kz b gy ng nd l ne nf"># Reset<br/>rm package-lock.json<br/>rm yarn.lock<br/>    <br/># Restore<br/>mv node_modules_backup node_modules<br/>mv package-lock.backup.json package-lock.json<br/>mv yarn.backup.lock yarn.lock</span></pre><p id="e5e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我跑了三次，速度非常相似。</p><h1 id="b6b2" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">您可以轻松地切换npm版本。</h1><p id="48ea" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">Bob安装了Yarn v1.1版，Brenda安装了Yarn 1.2版。当他们安装和删除项目的依赖项时，Yarn写入了一个<code class="fe kw kx ky kz b">yarn.lock</code>文件。但是Yarn v1.1版和Yarn 1.2版的锁文件格式略有不同，这对Bob和Brenda来说并不好玩。</p><p id="ada0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以使用<code class="fe kw kx ky kz b">package.json</code>中的<a class="ae ni" href="https://yarnpkg.com/lang/en/docs/package-json/#toc-engines" rel="noopener ugc nofollow" target="_blank">引擎</a>指定哪些纱线版本与您的项目兼容。</p><p id="c058" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，如果你需要定期在不同的项目之间切换，每个项目都需要不同的纱线版本，该怎么办呢？</p><p id="9f10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要停止使用brew ( <code class="fe kw kx ky kz b">brew uninstall yarn</code>)并恢复到npm安装。在项目间切换时，运行<code class="fe kw kx ky kz b">npm install yarn@1.1 --global</code>和<code class="fe kw kx ky kz b">npm install yarn@1.2 --global</code>。是的，每次切换项目时，都要重新安装完整的Yarn。真是一场噩梦！</p><p id="c79c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">但是用npm超级简单！</strong></p><p id="92d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<a class="ae ni" href="https://github.com/creationix/nvm" rel="noopener ugc nofollow" target="_blank"> nvm </a>或<a class="ae ni" href="https://github.com/tj/n" rel="noopener ugc nofollow" target="_blank"> n </a>，一个命令瞬间切换版本。嘣。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/0ea24400d3e6f3cb3edd354bf26ac58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*VsWfIxscxoPjbnefuMcgwQ.gif"/></div></figure><h1 id="9208" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">使用Lerna来管理您的工作区。</h1><p id="50f5" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">如果你在<a class="ae ni" href="https://yarnpkg.com/lang/en/docs/workspaces/" rel="noopener ugc nofollow" target="_blank">工作空间</a>特性中使用Yarn，考虑使用<a class="ae ni" href="https://github.com/lerna/lerna/" rel="noopener ugc nofollow" target="_blank"> Lerna </a>来代替。它做了Yarn提供的所有事情和附加功能，例如:管理工作区版本，在每个工作区内运行命令，以及发布工作区。</p><h1 id="378d" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">使用npm-check以交互方式升级。</h1><p id="aa46" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated"><code class="fe kw kx ky kz b">yarn upgrade-interactive</code>命令棒极了:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/5e90904187631ad5a1ca4901cd708d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*su3ElIyEyZt3w-nSbtyZ0A.png"/></div></div></figure><p id="6b51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">流行的<a class="ae ni" href="https://github.com/dylang/npm-check" rel="noopener ugc nofollow" target="_blank"> npm-check </a>模块做同样的事情:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/b5ba32cd16c260e8f3ef93466cc3ea52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M6Jq1k_DRL23SvSLmOhCAQ.png"/></div></div></figure><p id="b957" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并且非常容易设置:</p><pre class="mt mu mv mw gt mx kz my mz aw na bi"><span id="cff7" class="nb lr iq kz b gy nc nd l ne nf">npm install npm-check --save-dev</span></pre><p id="8f43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向package.json添加脚本:</p><pre class="mt mu mv mw gt mx kz my mz aw na bi"><span id="af3b" class="nb lr iq kz b gy nc nd l ne nf">{<br/>  "scripts": {<br/>    "upgrade-interactive": "npm-check --update"<br/>  }<br/>}</span></pre><p id="6a06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后用<code class="fe kw kx ky kz b">npm run upgrade-interactive</code>。</p><h1 id="90ab" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">纱线变得复杂。</h1><p id="2f3f" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">来自<a class="ae ni" href="https://github.com/facebook/jest" rel="noopener ugc nofollow" target="_blank"> Jest </a>自述:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/3bd0f8f0e25483339e57abd758c393e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-AY_o7opl4E5LrbD3gThJg.png"/></div></div></figure><p id="d7d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用笑话不需要故事。但它就在这里，推给你。现在我需要把<code class="fe kw kx ky kz b">yarn test</code>转换成<code class="fe kw kx ky kz b">npm</code>命令……好的，是<code class="fe kw kx ky kz b">npm test</code>还是<code class="fe kw kx ky kz b">npm run test</code>？我不太记得了。这才是自述应该告诉我的！</p><p id="f694" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">即使自述文件显示了<code class="fe kw kx ky kz b">yarn</code>和<code class="fe kw kx ky kz b">npm</code>命令，它也不必要地增加了噪声。例如，下面是<a class="ae ni" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>的自述文件:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/803b9466e697b3e4081e6b05c26e16b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O2YCfyQunF4y03NgNDZMBg.png"/></div></div></figure><p id="9f6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">纱线给我们带来了什么好处？没有。</p><p id="ba2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于已经被学习一个新框架搞得不知所措的全新React开发人员来说，这很令人困惑。“我应该运行哪个命令？这是什么纱线？我需要它吗？啊！”</p><p id="9b4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我还见过工具和CI代码检查<code class="fe kw kx ky kz b">yarn.lock</code>文件，如果检测到，就运行一组不同的命令。</p><p id="a62c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择在项目中使用Yarn意味着你的开发团队的其他人，包括未来的贡献者，也必须使用Yarn(来维护<code class="fe kw kx ky kz b">yarn.lock</code>文件)。</p><p id="109f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">JavaScript生态系统已经足够复杂了。我们真的也需要纱线吗？</p><p id="ac51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望Yarn团队将他们的改进贡献给npm本身，以简化我们的生活。</p><h1 id="9948" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">npm摇滚！</h1><p id="8511" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">切换回npm后，我意识到我的shell设置通过扫描package.json脚本自动完成了<code class="fe kw kx ky kz b">npm run</code>命令:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/01b2ac68fd8729a190b06fa0994a424a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*aFLov5S8HeX5L2ZfMTRbWQ.png"/></div></figure><p id="a21d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然，Yarn最终可能会有这种支持(而且可能已经有了)。但是npm拥有年复一年的社区支持和工具的优势。</p><p id="dd3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">npm也带来了一些杀手锏。运行<code class="fe kw kx ky kz b">npm audit</code>来扫描你的项目漏洞。使用<code class="fe kw kx ky kz b">npx</code>运行一次性命令(例如:<code class="fe kw kx ky kz b">npx create-react-app</code>而不是全局安装<code class="fe kw kx ky kz b">create-react-app</code>)。</p><h1 id="0711" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated"><strong class="ak">再给npm一次机会。</strong></h1><p id="d409" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">它很快。这是久经考验的。它定期更新。它拥有多年的社区支持和工具(如<a class="ae ni" href="https://github.com/creationix/nvm" rel="noopener ugc nofollow" target="_blank"> nvm </a>、<a class="ae ni" href="https://github.com/tj/n" rel="noopener ugc nofollow" target="_blank"> n </a>和上面的shell自动完成)。像<a class="ae ni" href="https://github.com/lerna/lerna" rel="noopener ugc nofollow" target="_blank"> Lerna </a>和<a class="ae ni" href="https://github.com/dylang/npm-check" rel="noopener ugc nofollow" target="_blank"> npm-check </a>这样的流行模块实现了Yarn的额外功能。</p><p id="3f2f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您正在编写javascript，那么您已经安装了npm。简化你的开发工具，再次使用npm。如果你错过了纱，让我知道为什么在下面的评论！</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h1 id="edd4" class="lq lr iq bd ls lt nv lv lw lx nw lz ma mb nx md me mf ny mh mi mj nz ml mm mn bi translated">JavaScript是不可能跟上的。</h1><p id="11fa" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">你抓住了每一个机会。滚动…阅读…刷新…略读。你迷失在文章、教程和GitHub repos的42个浏览器标签中。你可以收藏一把，以后再看(或者，永远不看)。</p><p id="e296" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">势不可挡。要知道的太多了。</strong></p><p id="0c21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我开发了一个系统，可以轻松地让我了解最新情况。</p></div></div>    
</body>
</html>
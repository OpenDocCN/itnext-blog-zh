<html>
<head>
<title>PHP microservices framework — Swoft 2.0.5 published</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PHP微服务框架——Swoft 2 . 0 . 5发布</h1>
<blockquote>原文：<a href="https://itnext.io/php-microservices-framework-swoft-2-0-5-published-97ff11da1915?source=collection_archive---------1-----------------------#2019-08-08">https://itnext.io/php-microservices-framework-swoft-2-0-5-published-97ff11da1915?source=collection_archive---------1-----------------------#2019-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/cc77b2d85cb05b5d715ccf131fa94259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/0*bikQKINpJg9Dj5dL.jpeg"/></div></div></figure><h1 id="b00d" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是Swoft？</h1><p id="1688" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">Swoft是一个基于Swoole扩展的PHP微服务协程框架。像Go一样，Swoft有一个内置的协程web服务器和一个公共的协程客户端，驻留在内存中，独立于传统的PHP-FPM。还有类似Go的语言操作，类似Spring的云框架灵活的注解，强大的全局依赖注入容器，全面的服务治理，灵活强大的AOP，标准的PSR规范实现等等。</p><p id="c4f6" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Swoft通过三年的积累和方向探索，将Swoft打造成PHP界的春天云，是PHP高性能框架和微服务管理的不二之选。</p><h1 id="b5cb" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">开源代码库</h1><ul class=""><li id="e08b" class="mc md it lb b lc ld lg lh lk me lo mf ls mg lw mh mi mj mk bi translated"><a class="ae ml" href="https://github.com/swoft-cloud/swoft" rel="noopener ugc nofollow" target="_blank">T3【https://github.com/swoft-cloud/swoft】T5</a></li></ul></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="e7a8" class="kb kc it bd kd ke mt kg kh ki mu kk kl km mv ko kp kq mw ks kt ku mx kw kx ky bi translated">高效秒crontab</h1><p id="deb8" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">下面简单的几行代码定义了一个每秒执行一次的定时任务，可以完全替代系统crontab。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="b1c8" class="nh kc it nd b gy ni nj l nk nl">&lt;?php declare(strict_types=1);</span><span id="da63" class="nh kc it nd b gy nm nj l nk nl">namespace App\Crontab;</span><span id="fdf8" class="nh kc it nd b gy nm nj l nk nl">use Swoft\Crontab\Annotaion\Mapping\Cron;<br/>use Swoft\Crontab\Annotaion\Mapping\Scheduled;</span><span id="1546" class="nh kc it nd b gy nm nj l nk nl">/**<br/> * Class CronTask<br/> *<br/> * @since 2.0<br/> *<br/> * @Scheduled()<br/> */<br/>class CronTask<br/>{<br/>    /**<br/>     * @Cron("* * * * * *")<br/>     */<br/>    public function secondTask()<br/>    {<br/>        printf("second task run: %s ", date('Y-m-d H:i:s', time()));<br/>    }<br/>}</span></pre><p id="9887" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">crontab启动服务，将看到以下显示:</p><figure class="my mz na nb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/69aa3ed5293259b53868fa1db99cbb6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2I8Z7fs-ItM5dk7d.png"/></div></div></figure><h1 id="46f3" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">异常管理</h1><p id="a73c" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在开发过程中，如果错误消息是一串字符，不方便业务解决问题。如果使用组件，所有错误消息将显示如下:</p><figure class="my mz na nb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/61aabd19ac57e5f31881ebe25529628e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JOFpucrO0ej-jMmt.png"/></div></div></figure></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="2707" class="kb kc it bd kd ke mt kg kh ki mu kk kl km mv ko kp kq mw ks kt ku mx kw kx ky bi translated">更新</h1><p id="f812" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">固定:</p><ul class=""><li id="92c5" class="mc md it lb b lc lx lg ly lk np lo nq ls nr lw mh mi mj mk bi translated">修复早期中断请求逻辑可能会导致相应内容类型<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/f03139886a471a0424d236061e8cb30d90b32a89" rel="noopener ugc nofollow" target="_blank"> f031398 </a>的不正确格式化</li><li id="6f5c" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">修正了使用sgo创建子协程，最后没有清理与顶层协程<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/de11ae5bc63833b80ca491132d156d51b95f6c8d" rel="noopener ugc nofollow" target="_blank"> de11ae5b </a>的映射</li><li id="19d7" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">修复Xml格式解析方法<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/495/commits/24d0038dc644fccf238d9642f049ceb961dd22b3" rel="noopener ugc nofollow" target="_blank"> 24d0038 </a></li><li id="061e" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">修复类代理唯一字符串问题<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/495/commits/444ddeb51e0741dda06e8f548f2579cf534bdf30" rel="noopener ugc nofollow" target="_blank"> 444ddeb </a></li><li id="7776" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">修复了<code class="fe nx ny nz nd b">context()-&gt;get()</code>问题并放弃了<code class="fe nx ny nz nd b">Context::mustGet()</code>方法<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/496/commits/6acc1b55163a18edc95de6cdb899398a9a7d0f2e" rel="noopener ugc nofollow" target="_blank"> 6acc1b5 </a></li><li id="fcdd" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">固定接口注入，类名访问错误<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/496/commits/2d9a31fe1855054055daa6e6e73aeaddfa280900" rel="noopener ugc nofollow" target="_blank"> 2d9a31f </a></li><li id="0047" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">修复模型使用<code class="fe nx ny nz nd b">paginate</code>方法，结果集没有映射字段<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/commit/3027287a58bfa66b3c87b8d2d03fddbfc6c2c754" rel="noopener ugc nofollow" target="_blank"> 3027287 </a></li><li id="ef5b" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">修复了当有多个工作线程并主动关闭非当前工作线程连接时的websocket服务器错误<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/500/commits/7666969f731dce68d395f45749260731eead7bda" rel="noopener ugc nofollow" target="_blank"> 7666969 </a></li></ul><p id="9a85" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">更新:</p><ul class=""><li id="dd09" class="mc md it lb b lc lx lg ly lk np lo nq ls nr lw mh mi mj mk bi translated">通过<code class="fe nx ny nz nd b">swoole_cpu_num</code>功能<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/553f6500678b258080b84cffeab0fe2d5bf65550" rel="noopener ugc nofollow" target="_blank"> 553f6500 </a>获得默认工人数量设置</li><li id="909a" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">验证器调整为，默认不需要，用户打开<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/496/commits/e5b258db35683e50f4abeba22a2c6fa82dbc7ceb" rel="noopener ugc nofollow" target="_blank"> e5b258d </a></li><li id="cabc" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">不再将swowt内部的<code class="fe nx ny nz nd b">containerException</code>扔向用户使用的层<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/498/commits/1e74893bf6e05fe954334e527e8b76eca2cef6e9" rel="noopener ugc nofollow" target="_blank"> 1e74893 </a></li><li id="04de" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">控制台输出添加交互方式如<code class="fe nx ny nz nd b">confirm</code> <code class="fe nx ny nz nd b">select</code> <a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/498/commits/0181138af6f1bc1dc0f3f1025b23d9a6354d122a" rel="noopener ugc nofollow" target="_blank"> 0181138a </a></li></ul><p id="ccf9" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">增强功能:</p><ul class=""><li id="d9f6" class="mc md it lb b lc lx lg ly lk np lo nq ls nr lw mh mi mj mk bi translated">控制台命令选项设置<code class="fe nx ny nz nd b">CommandOption</code>，现在允许选项被描述为多行信息<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/e591498363dac1888f503ab18766e89542e33665" rel="noopener ugc nofollow" target="_blank"> e5914983 </a></li><li id="37ac" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">websocket服务器的所有消息传递方法，支持传入的<code class="fe nx ny nz nd b">opcode</code>参数<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/dc164ffe97d507e505ac8cd1b50a421a27ae5859" rel="noopener ugc nofollow" target="_blank"> dc164ffe9 </a></li><li id="f2e2" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">websocket模块允许设置当前模块的默认<code class="fe nx ny nz nd b">opcode</code>，用于自动处理返回数据设置<code class="fe nx ny nz nd b">opcode</code> <a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/9e3e9672ed83579e6135ed47ae0c30ef335d8659" rel="noopener ugc nofollow" target="_blank"> 9e3e9672 </a></li><li id="5ad9" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">增强了websocket相关类，现在的消息处理方法允许注入更多的数据对象类型<code class="fe nx ny nz nd b">Request</code> <code class="fe nx ny nz nd b">Response</code> <a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/493/commits/3d6c60b4812535c48d51c57476f801529f66655f" rel="noopener ugc nofollow" target="_blank"> 3d6c60b4 </a></li><li id="55f8" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">当工人退出时，websocket服务器将自动关闭所有连接<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/498/commits/5ea10ecc4bcf767b374dad9652dd57a4fcfc8fc5" rel="noopener ugc nofollow" target="_blank"> 5ea10ecc </a></li><li id="2d01" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">添加定时器定时器包<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/495/commits/eb92ee6a7d5e7f2a47e30920a83ed192626b42e3" rel="noopener ugc nofollow" target="_blank"> eb92ee6 </a></li><li id="f8f2" class="mc md it lb b lc ns lg nt lk nu lo nv ls nw lw mh mi mj mk bi translated">添加协程方法包<a class="ae ml" href="https://github.com/swoft-cloud/swoft-component/pull/495/commits/d8c2b8848d492fc4b389df6edee595ef8f0e39c5" rel="noopener ugc nofollow" target="_blank"> d8c2b88 </a></li></ul></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><div class="my mz na nb gt oa"><a href="https://github.com/swoft-cloud/swoft" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">软件云/软件</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">PHP微服务协程框架。Swoft是一个基于Swoole扩展的PHP微服务协程框架…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo jz oa"/></div></div></a></div></div></div>    
</body>
</html>
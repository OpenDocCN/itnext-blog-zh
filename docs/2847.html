<html>
<head>
<title>Software Spotlight: Husky, git hooks made easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">软件聚焦:Husky，git挂钩变得简单</h1>
<blockquote>原文：<a href="https://itnext.io/software-spotlight-husky-git-hooks-made-easy-dc326e6c9dbb?source=collection_archive---------5-----------------------#2019-08-13">https://itnext.io/software-spotlight-husky-git-hooks-made-easy-dc326e6c9dbb?source=collection_archive---------5-----------------------#2019-08-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5791bcf2f4dcb4a2a2e6868ff27de2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dH7RbzFxDnjfUROpWftDlQ.png"/></div></div></figure><p id="71e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我几乎每天都偶然发现伟大的开源库或工具——其中一些拥有数以千计的GitHub之星，但我从未听说过它们。我想仅仅在GitHub上就有超过1亿个仓库的事实可以解释这一点。</p><p id="8c60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，我总是喜欢在我的博客上做一些系列文章——我想展示我的一些发现是一个很好的方式——特别是因为其中一些已经成为我自己工作流程中的一个重要元素。</p><p id="b0fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以这是第一个(希望有很多！)<strong class="ka ir">软件spotlight，</strong>特色<a class="ae kw" href="https://github.com/typicode/husky" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">Husky</strong></a><strong class="ka ir"/>by<strong class="ka ir"/><a class="ae kw" href="https://twitter.com/typicode?lang=de" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">typicode</strong></a>，一个开源库，方便创建git钩子的过程。</p><h1 id="4802" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">哈士奇，Git挂钩变得简单</h1><p id="c04d" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">Husky是一个简单的工具，它使得在你的<code class="fe ma mb mc md b">package.json</code>中轻松创建<a class="ae kw" href="https://git-scm.com/book/uz/v2/Customizing-Git-Git-Hooks" rel="noopener ugc nofollow" target="_blank"> git钩子</a>成为可能。</p><ul class=""><li id="6320" class="me mf iq ka b kb kc kf kg kj mg kn mh kr mi kv mj mk ml mm bi translated"><a class="ae kw" href="https://github.com/typicode/husky" rel="noopener ugc nofollow" target="_blank">储存库</a></li><li id="d888" class="me mf iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">GitHub上超过<a class="ae kw" href="https://github.com/typicode/husky/stargazers" rel="noopener ugc nofollow" target="_blank">15000颗星</a></li><li id="bac8" class="me mf iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">GitHub上超过160，000个存储库使用(例如，webpack、babel、Next.js、create-react-app等)</li><li id="c67f" class="me mf iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">每周超过<a class="ae kw" href="https://www.npmjs.com/package/husky" rel="noopener ugc nofollow" target="_blank">150万次下载</a></li></ul><h1 id="eefd" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">它的作用</h1><p id="389e" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">Husky允许您简单地在您的<code class="fe ma mb mc md b">package.json</code>中添加挂钩，而不是在您的<code class="fe ma mb mc md b">.git</code>目录中手动创建git挂钩，例如:</p><pre class="ms mt mu mv gt mw md mx my aw mz bi"><span id="1b39" class="na ky iq md b gy nb nc l nd ne">{<br/>  ... your package.json<br/>  "husky": {<br/>    "hooks": {<br/>      "pre-push": "npm test"<br/>    }<br/>  }<br/>}</span></pre><p id="9e57" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在每个<code class="fe ma mb mc md b">git push</code>之前执行<code class="fe ma mb mc md b">npm test</code>，如果<code class="fe ma mb mc md b">npm test</code>失败，推送将不被执行。</p><p id="44fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有时你可能想跳过钩子(例如，当在WIP分支上工作时)——这可以通过在git命令中添加<code class="fe ma mb mc md b">--no-verify</code>标志来轻松实现。</p><p id="5086" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">卸载Husky时，由Husky创建的挂钩将被移除。</p><h1 id="53ee" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">它是如何工作的</h1><p id="8034" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在引擎盖下，Husky只在安装时创建正常的git挂钩<a class="ae kw" href="https://github.com/typicode/husky/blob/master/package.json#L16" rel="noopener ugc nofollow" target="_blank">。例如，如果您在<code class="fe ma mb mc md b">.git/hooks/pre-pull</code>中查看，您会发现一个由Husky生成的文件:</a></p><pre class="ms mt mu mv gt mw md mx my aw mz bi"><span id="ef68" class="na ky iq md b gy nb nc l nd ne">#!/bin/sh<br/># husky</span><span id="db55" class="na ky iq md b gy nf nc l nd ne"># Hook created by Husky<br/>#   Version: 3.0.1<br/>#   At: 8/2/2019, 9:53:34 AM<br/>#   See: <a class="ae kw" href="https://github.com/typicode/husky#readme" rel="noopener ugc nofollow" target="_blank">https://github.com/typicode/husky#readme</a></span><span id="fc86" class="na ky iq md b gy nf nc l nd ne"># From<br/>#   Directory: /&lt;your-project&gt;/node_modules/husky<br/>#   Homepage: <a class="ae kw" href="https://github.com/typicode/husky#readme" rel="noopener ugc nofollow" target="_blank">https://github.com/typicode/husky#readme</a></span><span id="5a0e" class="na ky iq md b gy nf nc l nd ne">scriptPath="node_modules/husky/run.js"<br/>hookName=`basename "$0"`<br/>gitParams="$*"</span><span id="e597" class="na ky iq md b gy nf nc l nd ne">[...]</span></pre><p id="4d24" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个生成的文件负责为执行的命令(在这里是<code class="fe ma mb mc md b">git push</code>)执行适当的钩子(在这里是:<code class="fe ma mb mc md b">pre-push</code>)。</p><p id="a19a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如上所述，当哈士奇<a class="ae kw" href="https://github.com/typicode/husky/blob/master/package.json#L17" rel="noopener ugc nofollow" target="_blank">被移除</a>时，这些文件也被移除。</p><h1 id="3c33" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为什么要使用它</h1><p id="6caa" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">有人可能会说，一个适当的CI设置可能会做与Husky相同的事情，这一点我部分同意。但有一件事导致我们(这意味着我工作的公司)使用Husky，即使我们的CI设置运行所有测试，林挺和相关的东西:我们的CI需要相当长的时间才能完成。一次构建需要30到60分钟——您不希望等那么久才收到通知，它实际上告诉您:</p><blockquote class="ng nh ni"><p id="d83a" class="jy jz nj ka b kb kc kd ke kf kg kh ki nk kk kl km nl ko kp kq nm ks kt ku kv ij bi translated">你的构建失败了，因为你忘记了一个空格。诺布。</p></blockquote><p id="310f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的<code class="fe ma mb mc md b">pre-push</code>钩子只是运行<code class="fe ma mb mc md b">npm run lint</code>(链接所有<code class="fe ma mb mc md b">.ts</code>和<code class="fe ma mb mc md b">.scss</code>文件)来防止这种情况。对于git挂钩来说，花费的时间有点太多了，这也是我们选择林挺的原因。</p><p id="7bd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个额外的好处是，它使得在团队内部共享git挂钩变得非常容易，而不需要改变任何git配置。</p></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><p id="e8e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这篇文章，请留下👏，关注我上 <a class="ae kw" href="https://twitter.com/nehalist" rel="noopener ugc nofollow" target="_blank"> <em class="nj">推特</em> </a> <em class="nj">并订阅</em> <a class="ae kw" href="https://nehalist.io/newsletter/" rel="noopener ugc nofollow" target="_blank"> <em class="nj">我的快讯</em> </a> <em class="nj">。本帖原载于2019年8月13日</em> <a class="ae kw" href="https://nehalist.io" rel="noopener ugc nofollow" target="_blank"> <em class="nj">我的博客</em> </a> <em class="nj">。</em></p></div></div>    
</body>
</html>
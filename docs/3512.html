<html>
<head>
<title>Kong Gateway in Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes的孔门</h1>
<blockquote>原文：<a href="https://itnext.io/kong-gateway-in-kubernetes-ad86981f93a5?source=collection_archive---------2-----------------------#2019-12-31">https://itnext.io/kong-gateway-in-kubernetes-ad86981f93a5?source=collection_archive---------2-----------------------#2019-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8a7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kong是一个构建在轻量级代理Nginx之上的开源API网关。在这篇文章中，我将向您展示如何在Kubernetes中设置和配置Kong。有关孔的更多信息，请访问:<a class="ae kl" href="https://konghq.com/kong/" rel="noopener ugc nofollow" target="_blank"/></p><blockquote class="km kn ko"><p id="7b37" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">在<a class="ae kl" href="https://gengo.com/" rel="noopener ugc nofollow" target="_blank"> Gengo </a>，我们每天处理上亿的HTTP请求。我们使用Nginx作为内部和外部流量到Kubernetes集群中托管的微服务的网关。我们自己管理这些代理变得很成问题，因为我们需要控制、监视和保护流量，而不增加现有设置中的代码更改和复杂性。当然，这是为了让我们能够快速扩展。</p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/585a9e3766da24ccf89b4a8d6eecb6a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPMYiRFN3gwpUO25ZzHxBQ.png"/></div></div></figure><p id="fe8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">金刚来救援了。这是一个运行在Nginx中的Lua应用程序，这意味着我们可以使用插件享受更多的功能，同时仍然使用一个非常轻量级的代理。Nginx类固醇=)</p></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><p id="0200" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了在K8s中使用孔，我们将使用<a class="ae kl" href="https://github.com/Kong/kubernetes-ingress-controller" rel="noopener ugc nofollow" target="_blank">孔入口控制器</a>。这允许我们以管理Kubernetes资源的类似方式配置Kong。</p><h1 id="0a51" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">测试设置</h1><ul class=""><li id="3579" class="mk ml iq jp b jq mm ju mn jy mo kc mp kg mq kk mr ms mt mu bi translated">minikube 1 . 5 . 2版</li><li id="2c66" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated">kubernetes 1 . 14 . 0版</li></ul><p id="ef52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行此命令以应用控制器。</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="34fd" class="nf ln iq nb b gy ng nh l ni nj">kubectl apply -f <a class="ae kl" href="https://bit.ly/kong-ingress-dbless" rel="noopener ugc nofollow" target="_blank">https://bit.ly/kong-ingress-dbless</a></span></pre><blockquote class="km kn ko"><p id="16e2" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">请注意，这不是Kong的生产级部署。</p></blockquote><p id="64a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将为Kong创建所需的资源，包括名称空间、服务、部署、CustomResourceDefinitions(稍后将详细介绍)、ClusterRoles和ConfigMaps。</p><p id="1736" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在1.1版本发布之前，Kong的配置通常与数据库一起使用，但我们不希望这样，因为我们的目标是一个声明式设置。</p><p id="aceb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要检查它是否工作，卷曲kong-proxy服务。在minikube中，必须可以在本地主机中访问LoadBalancer类型的服务。要做到这一点，运行</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="c995" class="nf ln iq nb b gy ng nh l ni nj">$ minikube tunnel</span></pre><p id="9c35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以从本地主机访问我们的服务。</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="1b0f" class="nf ln iq nb b gy ng nh l ni nj">$ export KONG_HTTP=$(minikube ip):$(kubectl -nkong get svc kong-proxy --no-headers | awk '{print $5}' | cut -d / -f 1 | cut -d : -f 2)</span><span id="81fd" class="nf ln iq nb b gy nk nh l ni nj">$ curl -i $KONG_HTTP</span><span id="38a8" class="nf ln iq nb b gy nk nh l ni nj">HTTP/1.1 404 Not Found<br/>Date: Sun, 08 Dec 2019 12:10:23 GMT<br/>Content-Type: application/json; charset=utf-8<br/>Connection: keep-alive<br/>Content-Length: 48<br/>Server: kong/1.3.0</span><span id="6b27" class="nf ln iq nb b gy nk nh l ni nj">{"message":"no Route matched with those values"}%</span></pre><p id="a061" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">恭喜你！孔正在工作。但是它还不知道如何代理请求。</p><h2 id="3431" class="nf ln iq bd lo nl nm dn ls nn no dp lw jy np nq ma kc nr ns me kg nt nu mi nv bi translated">让我们建立一个简单的应用程序，</h2><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="d0f3" class="nf ln iq nb b gy ng nh l ni nj">$ curl -sL bit.ly/echo-server | kubectl apply -f -</span><span id="fbc0" class="nf ln iq nb b gy nk nh l ni nj">service/echo created<br/>deployment.apps/echo created</span></pre><h2 id="9f86" class="nf ln iq bd lo nl nm dn ls nn no dp lw jy np nq ma kc nr ns me kg nt nu mi nv bi translated">基本路由配置</h2><p id="9fcc" class="pw-post-body-paragraph jn jo iq jp b jq mm js jt ju mn jw jx jy nw ka kb kc nx ke kf kg ny ki kj kk ij bi translated">kong-ingress-controller监视入口控制器的变化，以建立基本路由配置。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">入口/api</figcaption></figure><p id="4169" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该在日志中看到类似这样的内容</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="6141" class="nf ln iq nb b gy ng nh l ni nj">$ kubectl -n kong logs -f $(kubectl -n kong get pod — no-headers | awk ‘{print $1}’) --tail=2 ingress-controller</span><span id="ccd5" class="nf ln iq nb b gy nk nh l ni nj">I1208 10:10:30.885602       1 status.go:342] updating Ingress default/api status to [{10.110.88.230 }]<br/>W1208 10:10:30.902533       1 controller.go:135] successfully synced configuration to Kong</span></pre><p id="251e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在用api.gengo.dev的主机头再次卷曲端点</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="63cd" class="nf ln iq nb b gy ng nh l ni nj">$ curl -i -H "Host: api.gengo.dev" $KONG_HTTP/</span><span id="a523" class="nf ln iq nb b gy nk nh l ni nj">HTTP/1.1 200 OK<br/>Content-Type: text/plain; charset=UTF-8<br/>Transfer-Encoding: chunked<br/>Connection: keep-alive<br/>Date: Sun, 08 Dec 2019 12:20:14 GMT<br/>Server: echoserver<br/>X-Kong-Upstream-Latency: 14<br/>X-Kong-Proxy-Latency: 3<br/>Via: kong/1.3.0</span><span id="cecb" class="nf ln iq nb b gy nk nh l ni nj">Hostname: echo-758859bbfb-bx9tx</span><span id="72a4" class="nf ln iq nb b gy nk nh l ni nj">Pod Information:<br/> node name: minikube<br/> pod name: echo-758859bbfb-bx9tx<br/> pod namespace: default<br/> pod IP: 172.17.0.7</span><span id="47b5" class="nf ln iq nb b gy nk nh l ni nj">...</span></pre><p id="f4aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">恭喜你！您已经有了基本的路由配置。现在让我们注射一些类固醇。</p><h1 id="5bbd" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">自定义资源定义</h1><p id="a81f" class="pw-post-body-paragraph jn jo iq jp b jq mm js jt ju mn jw jx jy nw ka kb kc nx ke kf kg ny ki kj kk ij bi translated">由于Kong提供了比我们刚才设置的基本路由配置更多的功能，它允许我们通过使用自定义资源定义来进行进一步的配置。</p><ul class=""><li id="ea44" class="mk ml iq jp b jq jr ju jv jy of kc og kg oh kk mr ms mt mu bi translated"><strong class="jp ir"> KongPlugin: </strong>在Kong中安装和配置插件</li><li id="471d" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> KongIngress: </strong>作为入口资源的“扩展”,用于流量的细粒度控制(路由、负载平衡，甚至健康检查)</li><li id="0e85" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir">孔消费者:</strong>映射到孔<a class="ae kl" href="https://getkong.org/docs/latest/admin-api/#consumer-object" rel="noopener ugc nofollow" target="_blank">消费者</a>实体。</li><li id="7f16" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> KongCredential: </strong>允许设置将与KongConsumer关联的凭证。</li></ul><h2 id="a974" class="nf ln iq bd lo nl nm dn ls nn no dp lw jy np nq ma kc nr ns me kg nt nu mi nv bi translated">孔插件</h2><p id="0e03" class="pw-post-body-paragraph jn jo iq jp b jq mm js jt ju mn jw jx jy nw ka kb kc nx ke kf kg ny ki kj kk ij bi translated">这就是我真正喜欢孔的地方。轻量级Nginx的功能可以通过使用插件轻松扩展。如果你想查看不同功能(认证、安全、无服务器、监控、日志等)的可用插件列表，有一个<a class="ae kl" href="https://docs.konghq.com/hub/" rel="noopener ugc nofollow" target="_blank"> KongHub </a>。)</p><p id="bd92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我最喜欢使用的插件之一是<strong class="jp ir">无服务器函数</strong>，我们可以在访问阶段动态运行Lua代码。插件有两种。在插件链中，每一个都有不同的优先级。</p><ul class=""><li id="c603" class="mk ml iq jp b jq jr ju jv jy of kc og kg oh kk mr ms mt mu bi translated"><strong class="jp ir">前置功能</strong> —在其他插件之前运行</li><li id="23a8" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir">后置功能</strong> —在其他插件之后运行</li></ul><p id="21fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的插件举例说明了如何在Lua中读取JWT令牌的每一段。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">孔插件/读-jwt-令牌</figcaption></figure><p id="9683" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并且我们也可以为Lua使用<a class="ae kl" href="https://github.com/openresty/lua-nginx-module#nginx-api-for-lua" rel="noopener ugc nofollow" target="_blank"> Nginx API </a>。多酷啊。</p><p id="7459" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用它，我们需要通过使用注释将它与入口关联起来。</p><p id="b0c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如(假设我们有另一个名为http-jwt的插件，它在读取令牌之前检查它的有效性)</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="8f76" class="nf ln iq nb b gy ng nh l ni nj">annotations:<br/>  plugins.konghq.com: http-jwt,read-jwt-token</span></pre><h2 id="3f69" class="nf ln iq bd lo nl nm dn ls nn no dp lw jy np nq ma kc nr ns me kg nt nu mi nv bi translated">KongIngress Man！！</h2><p id="c327" class="pw-post-body-paragraph jn jo iq jp b jq mm js jt ju mn jw jx jy nw ka kb kc nx ke kf kg ny ki kj kk ij bi translated">在大多数情况下，入口资源是足够的，但如果你想更多地控制路由，孔入口是你的男人。使用这个可以修改与入口资源相关的<a class="ae kl" href="https://getkong.org/docs/latest/admin-api/#upstream-objects" rel="noopener ugc nofollow" target="_blank">上游</a>、<a class="ae kl" href="https://getkong.org/docs/latest/admin-api/#service-object" rel="noopener ugc nofollow" target="_blank">服务</a>和<a class="ae kl" href="https://getkong.org/docs/latest/admin-api/#route-object" rel="noopener ugc nofollow" target="_blank">路由</a>实体的所有属性。</p><p id="d551" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">供您参考，这是完整的规格，</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">孔入口/全规格</figcaption></figure><p id="0f64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有配置都是不言自明的，如果不是，请参考<a class="ae kl" href="https://docs.konghq.com/1.4.x/admin-api/#upstream-object" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="cf1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用它，我们需要通过使用注释将其与入口或服务相关联。</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="5de1" class="nf ln iq nb b gy ng nh l ni nj">annotations:<br/>  configuration.konghq.com: kong-ingress-resource-name</span></pre><p id="3d99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它可以与入口或服务相关联，但是我们如何知道是哪一个呢？</p><p id="078c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您在上游或代理节点中进行配置更改，它需要与服务相关联，而路由节点与入口相关联</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="5284" class="nf ln iq nb b gy ng nh l ni nj">upstream: # Associate with Service<br/>  hash_on: none<br/>  hash_fallback: none</span><span id="447d" class="nf ln iq nb b gy nk nh l ni nj">proxy: # Associate with Service<br/>  protocol: http<br/>  path: /<br/>  connect_timeout: 10000<br/>  retries: 10<br/>  read_timeout: 10000<br/>  write_timeout: 10000</span><span id="56b0" class="nf ln iq nb b gy nk nh l ni nj">route: # Associate with Ingress<br/>  methods:<br/>  - POST<br/>  - GET</span></pre><h2 id="6156" class="nf ln iq bd lo nl nm dn ls nn no dp lw jy np nq ma kc nr ns me kg nt nu mi nv bi translated">孔消费者</h2><p id="c550" class="pw-post-body-paragraph jn jo iq jp b jq mm js jt ju mn jw jx jy nw ka kb kc nx ke kf kg ny ki kj kk ij bi translated">有些情况下，我们希望对访问端点的每个用户/消费者使用不同的规则。例如，web客户端上的速率限制条件不同于以编程方式访问API的机器。这可以用孔消费者来实现。</p><p id="dc95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是创建消费者的清单文件。</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="3ee7" class="nf ln iq nb b gy ng nh l ni nj">apiVersion: configuration.konghq.com/v1<br/>kind: KongConsumer<br/>metadata:<br/>  name: api-consumer<br/>  annotations:<br/>    plugins.konghq.com: api-rate-limit<br/>username: api<br/>custom_id: api-1</span><span id="b4f9" class="nf ln iq nb b gy nk nh l ni nj">---<br/>apiVersion: configuration.konghq.com/v1<br/>kind: KongConsumer<br/>metadata:<br/>  name: web-consumer<br/>  annotations:<br/>    plugins.konghq.com: web-rate-limit, web-cors<br/>username: web<br/>custom_id: web-1</span></pre><p id="6f86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个例子中，我们创建了两个消费者，每个消费者根据他们的需求与不同的插件相关联。</p><p id="2caf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只需使用注释将KongPlugins与您的消费者关联起来。</p><p id="6132" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于孔来说，消费者是一个不透明的概念，因为它可以根据不同的使用情况进行不同的处理。这真的很令人困惑。</p><p id="42ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，你可以和你的用户进行一对一的交流，或者像上面的例子一样。核心原则是你可以给它们附加插件，从而定制请求行为。</p><p id="3bbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在大多数情况下，消费者是通过身份验证插件来识别的，所以凭证部分就来了。</p><h2 id="245e" class="nf ln iq bd lo nl nm dn ls nn no dp lw jy np nq ma kc nr ns me kg nt nu mi nv bi translated">孔凭据</h2><p id="314f" class="pw-post-body-paragraph jn jo iq jp b jq mm js jt ju mn jw jx jy nw ka kb kc nx ke kf kg ny ki kj kk ij bi translated">KongCredentials是可以分配给KongConsumer的不同类型的独立实体。</p><ul class=""><li id="e3e2" class="mk ml iq jp b jq jr ju jv jy of kc og kg oh kk mr ms mt mu bi translated"><strong class="jp ir"> key-auth </strong>用于<a class="ae kl" href="https://docs.konghq.com/plugins/key-authentication/" rel="noopener ugc nofollow" target="_blank">密钥认证</a></li><li id="2da1" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir">基本认证</strong>为<a class="ae kl" href="https://docs.konghq.com/plugins/basic-authentication/" rel="noopener ugc nofollow" target="_blank">基本认证</a></li><li id="e3c7" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> hmac-auth </strong>用于<a class="ae kl" href="http://docs.konghq.com/plugins/hmac-authentication/" rel="noopener ugc nofollow" target="_blank"> HMAC认证</a></li><li id="7bcf" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> jwt </strong>用于<a class="ae kl" href="http://docs.konghq.com/plugins/jwt/" rel="noopener ugc nofollow" target="_blank">基于jwt的认证</a></li><li id="e413" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> oauth2 </strong>为<a class="ae kl" href="https://docs.konghq.com/hub/kong-inc/oauth2/" rel="noopener ugc nofollow" target="_blank"> Oauth2客户端凭证</a></li><li id="6a53" class="mk ml iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> acl </strong>用于<a class="ae kl" href="https://docs.konghq.com/hub/kong-inc/acl/" rel="noopener ugc nofollow" target="_blank"> ACL组关联</a></li></ul><p id="dd7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，一个消费者可以有许多凭证。</p><pre class="ku kv kw kx gt na nb nc nd aw ne bi"><span id="d668" class="nf ln iq nb b gy ng nh l ni nj">apiVersion: configuration.konghq.com/v1<br/>kind: KongCredential<br/>metadata:<br/>  name: web-apikey<br/>consumerRef: web-consumer<br/>type: key-auth<br/>config:<br/>  key: super-secret-key</span></pre><p id="e419" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的例子中，我们使用集成到Auth0中的JWT插件，每个Auth0租户只需要1个消费者和1个凭证。清单文件如下所示</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">孔-auth0-integration.yaml</figcaption></figure></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><p id="2fda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上就是孔在库伯内特斯的故事。我希望你在Kubernetes学会了如何使用孔。如果你有意见/建议/问题，请在下面的评论区告诉我。</p><p id="6691" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读:)</p><blockquote class="km kn ko"><p id="cbde" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">我乐于接受反馈和建议，这样我就可以改进。:)</p></blockquote><p id="9d74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参考资料:</p><div class="oi oj gp gr ok ol"><a href="https://docs.konghq.com/?itm_source=website&amp;itm_medium=nav" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">开源API管理和微服务管理</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">使用插件保护、管理和扩展您的API或微服务，用于身份验证、日志记录、速率限制…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">docs.konghq.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ld ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://github.com/Kong/kubernetes-ingress-controller" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">kong/kubernetes-入口控制器</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">使用孔作为Kubernetes入口。在Kong为Kubernetes配置插件、健康检查、负载平衡等等…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz ld ol"/></div></div></a></div></div></div>    
</body>
</html>
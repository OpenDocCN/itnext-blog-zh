<html>
<head>
<title>Form Validation with React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React挂钩进行表单验证</h1>
<blockquote>原文：<a href="https://itnext.io/form-validation-with-react-hooks-ab0dbba23b9f?source=collection_archive---------0-----------------------#2019-02-14">https://itnext.io/form-validation-with-react-hooks-ab0dbba23b9f?source=collection_archive---------0-----------------------#2019-02-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/6dcf7ae13b18a59f317e53cadc12a6f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YWaSaYPtW1n_vEplTUaanA.png"/></div></div></figure><div class=""/><p id="46fc" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如你可能知道的，我对钩子的新React API感到非常兴奋(<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/why-im-excited-with-react-hooks-5a8601ac43f7">这里是关于它们的介绍</a>)</p><p id="0822" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在有几个可用的React钩子，我计划详细介绍其中的一些，但是这篇文章是关于只使用<strong class="kd jf"> useState </strong>钩子来构建一个自定义钩子来验证表单数据。</p><p id="668c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你现在想看它工作，这里有一个活生生的例子。</p><div class="is it gp gr iu la"><a href="https://frontarm.com/demoboard/?id=04d6233e-31cd-4921-b171-8d65f8204a05" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd jf gy z fp lf fr fs lg fu fw jd bi translated">演示板</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">快速创建Javascript和Markdown演示。导入npm上的任何包。</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">frontarm.com</p></div></div><div class="lj l"><div class="lk l ll lm ln lj lo ja la"/></div></div></a></div><p id="608c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">想法是创建一个定制的钩子来接收初始数据、验证和验证器。并返回一组变量和函数作为表单的工具</p><p id="0e1e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是最后一个钩子，让我们看看它是如何工作的，以及我们如何用它来验证一个表单</p><figure class="lp lq lr ls gt iv"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="d82e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里的总体思路是，钩子返回一个包含2部分状态和3个函数的数组，让我们一个接一个地看看会是什么</p><h2 id="3a88" class="lv lw je bd lx ly lz dn ma mb mc dp md km me mf mg kq mh mi mj ku mk ml mm mn bi translated">form变量表示状态以及状态每个部分的onChange和onClick函数。这意味着</h2><p id="4364" class="pw-post-body-paragraph kb kc je kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">如果我们有一个这样的初始表单数据</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="5ea3" class="lv lw je mu b gy my mz l na nb">const formData = {<br/>  name: '',<br/>  email: ''</span><span id="98d5" class="lv lw je mu b gy nc mz l na nb">}</span></pre><p id="1863" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">钩子返回的表单变量将是</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="cf37" class="lv lw je mu b gy my mz l na nb">{<br/>  name: {<br/>    input: {<br/>      value: '',<br/>      onClick: onClickHandlerFunction,<br/>      onChange: onChangeHandlerFunction<br/>    },<br/>    meta: {<br/>      touched: false,<br/>      dirty: false<br/>    }<br/>  },<br/>  email: {<br/>    input: {<br/>      value: '',<br/>      onClick: onClickHandlerFunction,<br/>      onChange: onChangeHandlerFunction<br/>    },<br/>    meta: {<br/>      touched: false,<br/>      dirty: false<br/>    }<br/>  }<br/>}</span></pre><h2 id="afd6" class="lv lw je bd lx ly lz dn ma mb mc dp md km me mf mg kq mh mi mj ku mk ml mm mn bi translated">验证保存来自valida-js的验证响应</h2><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="48c0" class="lv lw je mu b gy my mz l na nb">{<br/>  valid: true,<br/>  errors: {<br/>    name: [],<br/>    email: []<br/>  }<br/>}</span></pre><h2 id="7607" class="lv lw je bd lx ly lz dn ma mb mc dp md km me mf mg kq mh mi mj ku mk ml mm mn bi translated">其他3个功能用于</h2><ul class=""><li id="552b" class="nd ne je kd b ke mo ki mp km nf kq ng ku nh ky ni nj nk nl bi translated">验证:一次验证所有的表单数据</li><li id="c383" class="nd ne je kd b ke nm ki nn km no kq np ku nq ky ni nj nk nl bi translated">getData:返回一个对象，其签名与传递给钩子的初始值相同</li><li id="69fe" class="nd ne je kd b ke nm ki nn km no kq np ku nq ky ni nj nk nl bi translated">setData:将数据设置为表单状态，传递一个与钩子初始参数具有相同签名的对象</li></ul><h1 id="1a80" class="nr lw je bd lx ns nt nu ma nv nw nx md ny nz oa mg ob oc od mj oe of og mm oh bi translated">使用钩子</h1><p id="d705" class="pw-post-body-paragraph kb kc je kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">首先从npm导入钩子，并将它们放入组件函数中。</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="edf8" class="lv lw je mu b gy my mz l na nb">import useValidatedForm from 'react-valida-hook'</span></pre><p id="2d36" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd jf"> useValidatedForm </strong> hook可以用来传递至少两个参数，第一个是表单的初始数据(应该是数据的完整模式)，第二个参数是验证规则的数组，那些验证规则将用于<strong class="kd jf"> valida-js。</strong></p><p id="83e4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在知道了钩子的返回以及如何初始化钩子。让我们用它写一个小表格</p><figure class="lp lq lr ls gt iv"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="21e8" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里的重要部分是</p><p id="625e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果一个属性有错误，我们该如何读取(也许我们需要一个函数来做得更好)，但是让我们保持这个简单的逻辑。如果一个属性的错误数组大于0，这意味着我们在那里有错误，在另一种情况下，我们假设我们没有</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="ec33" class="lv lw je mu b gy my mz l na nb">className={ validation.errors.firstName.length &gt; 0 ? 'validated-form__control error': 'validated-form__control'</span></pre><p id="eecd" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里另一个重要的部分是</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="b1f5" class="lv lw je mu b gy my mz l na nb">&lt;input name='first-name' id='first-name' { ...formData.firstName.input } /&gt;</span></pre><p id="fd38" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我们拆分输入对象<strong class="kd jf"> firstName </strong>的地方，这意味着我们正在将<strong class="kd jf">值</strong>、<strong class="kd jf"> onClick </strong>处理程序和<strong class="kd jf"> onChange </strong>处理程序作为道具传递给输入。这样，我们将更新属性的元数据(<strong class="kd jf"> touched </strong>，<strong class="kd jf"> dirty </strong>)，在用户写入输入时更新输入的值，并更新关于表单特定属性的验证。因此，在这种情况下，更新<strong class="kd jf">validation . errors . first name</strong>。</p><p id="a063" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">其中一个奇妙的事情是，现在我们可以构建控件组件并通过<strong class="kd jf">验证.属性</strong>、<strong class="kd jf">表单.属性</strong>并提取逻辑将错误和类放入其中。</p><p id="56f2" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我希望这能帮助你了解更多关于React钩子的知识，以及我们如何使用它在我们的应用程序中组合功能。</p><p id="beda" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个例子只使用了React上众多可用钩子中的一个(<strong class="kd jf">使用状态</strong>)，我将深入挖掘其他钩子，以及我们如何使用它们来创建一个类似redux的架构，只是使用钩子。</p><p id="cca7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是带有这个挂钩的npm包的存储库</p><div class="is it gp gr iu la"><a href="https://github.com/highercomve/react-valida-hook" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd jf gy z fp lf fr fs lg fu fw jd bi translated">更高级的命令/反应有效的钩子</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">通过在GitHub上创建一个帐户，为更高级的comve/react-valida-hook开发做出贡献。</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">github.com</p></div></div><div class="lj l"><div class="oi l ll lm ln lj lo ja la"/></div></div></a></div><p id="f644" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢阅读，愿原力与你同在。</p></div></div>    
</body>
</html>
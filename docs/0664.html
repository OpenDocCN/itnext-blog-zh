<html>
<head>
<title>Up and Running: Cockpit for Google Kubernetes Engine (GKE)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">启动并运行:谷歌Kubernetes引擎驾驶舱(GKE)</h1>
<blockquote>原文：<a href="https://itnext.io/up-and-running-cockpit-for-google-kubernetes-engine-gke-4aca68f182bf?source=collection_archive---------4-----------------------#2018-05-02">https://itnext.io/up-and-running-cockpit-for-google-kubernetes-engine-gke-4aca68f182bf?source=collection_archive---------4-----------------------#2018-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e37a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我个人找到一个快速的方法来更好地向朋友解释kubernetes。为<a class="ae kl" href="https://cloud.google.com/kubernetes-engine/" rel="noopener ugc nofollow" target="_blank"> Google Kubernetes引擎设置<a class="ae kl" href="http://cockpit-project.org/" rel="noopener ugc nofollow" target="_blank">驾驶舱</a>仪表盘。</a>顾名思义，Cockpit是一个服务器管理器，可以通过网络浏览器轻松管理我们的GNU/Linux服务器。驾驶舱仪表板可以作为pod中的容器部署在kubernetes上(在本例中),也可以通过普通的认证驾驶舱会话使用。Cockpit通过其REST API与Kubernetes通信。</p><p id="b4c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们来演示一下。</p><p id="540a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在谷歌云上建立一个GKE集群。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="fd29" class="lc ld iq ky b gy le lf l lg lh">$ kubectl get nodes<br/><br/>NAME                                            STATUS    ROLES     AGE       VERSION<br/>gke-my-k8s-cluster-default-pool-85aa2e6c-18nn   Ready     &lt;none&gt;    2d        v1.9.3-gke.0<br/>gke-my-k8s-cluster-default-pool-85aa2e6c-509w   Ready     &lt;none&gt;    2d        v1.9.3-gke.0<br/>gke-my-k8s-cluster-default-pool-85aa2e6c-c95p   Ready     &lt;none&gt;    2d        v1.9.3-gke.0</span></pre><p id="2c8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我将在我的kubernetes相关工作下创建一个名为“cockpit”的目录。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="abbb" class="lc ld iq ky b gy le lf l lg lh">$ pwd<br/>/Users/sai/hellocloud/github<br/>$ mkdir cockpit<br/>$ cd cockpit</span></pre><p id="d6ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">下载驾驶舱舱单文件。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="eb59" class="lc ld iq ky b gy le lf l lg lh">$ wget https://raw.githubusercontent.com/cockpit-project/cockpit/master/containers/kubernetes-cockpit.json<br/><br/>--2018-04-05 14:50:24--  https://raw.githubusercontent.com/cockpit-project/cockpit/master/containers/kubernetes-cockpit.json<br/>Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.8.133<br/>Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.8.133|:443... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 447 [text/plain]<br/>Saving to: 'kubernetes-cockpit.json'<br/><br/>kubernetes-cockpit.json                                 100%[============================================================================================================================&gt;]     447  --.-KB/s    in 0s     <br/><br/>2018-04-05 14:50:25 (10.9 MB/s) - 'kubernetes-cockpit.json' saved [1628]<br/><br/>$ ls<br/>kubernetes-cockpit.json</span></pre><p id="83e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">创建一个名为“cockpit-demo”的名称空间，我将在其中部署cockpit仪表板作为kubernetes pod。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="5ccd" class="lc ld iq ky b gy le lf l lg lh">$ kubectl create namespace cockpit-demo<br/>namespace "cockpit-demo” created</span></pre><p id="08df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在kubernetes-cockpit.json中将服务类型从“ClusterIP”修改为“load balancer”。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="a73a" class="lc ld iq ky b gy le lf l lg lh">$ more kubernetes-cockpit.json<br/><br/>{<br/>   "kind":"List",<br/>   "apiVersion":"v1",<br/>   "items":[<br/>      {<br/>         "kind":"ReplicationController",<br/>         "apiVersion":"v1",<br/>         "metadata":{<br/>            "name":"kubernetes-cockpit",<br/>            "labels":{<br/>               "name":"kubernetes-cockpit"<br/>            }<br/>         },<br/>         "spec":{<br/>            "replicas":1,<br/>            "selector":{<br/>               "name":"kubernetes-cockpit"<br/>            },<br/>            "template":{<br/>               "metadata":{<br/>                  "labels":{<br/>                     "name":"kubernetes-cockpit"<br/>                  }<br/>               },<br/>               "spec":{<br/>                  "containers":[{<br/>                    "name": "kubernetes-cockpit",<br/>                    "image": "cockpit/kubernetes:latest",<br/>                    "ports":[{<br/>                        "containerPort":9090,<br/>                        "protocol":"TCP"<br/>                     }],<br/>                    "env":[{<br/>                        "name": "KUBE_INSECURE",<br/>                        "value": "false"<br/>                    }]<br/>                  }]<br/>               }<br/>            }<br/>         }<br/>      },<br/>      {<br/>         "kind":"Service",<br/>         "apiVersion":"v1",<br/>         "metadata":{<br/>            "name":"kubernetes-cockpit",<br/>            "labels":{<br/>               "name":"kubernetes-cockpit"<br/>            }<br/>         },<br/>         "spec":{<br/>             "type": "LoadBalancer",<br/>             "ports": [{<br/>                 "protocol": "TCP",<br/>                 "port": 443,<br/>                 "targetPort": 9090<br/>             }],<br/>            "selector":{<br/>               "name":"kubernetes-cockpit"<br/>            }<br/>         }<br/>      }<br/>   ]<br/>}</span></pre><p id="bde5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">部署驾驶舱并获取负载平衡器IP以访问驾驶舱仪表板。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="fbaf" class="lc ld iq ky b gy le lf l lg lh">$ kubectl create -f kubernetes-cockpit.json -n cockpit-demo<br/><br/>replicationcontroller "kubernetes-cockpit" created<br/>service "kubernetes-cockpit” created<br/><br/>$ kubectl get svc -n cockpit-demo<br/><br/>NAME                 TYPE           CLUSTER-IP      EXTERNAL-IP     PORT(S)         AGE<br/>kubernetes-cockpit   LoadBalancer   10.39.244.214.   35.198.192.81   443:31418/TCP   45s</span></pre><p id="7506" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">浏览驾驶舱仪表板</strong><a class="ae kl" href="https://35.198.192.81." rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">https://35.198.192.81。</strong>T21<strong class="jp ir">从GKE得到国书。(点击显示凭证)</strong></a></p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi li"><img src="../Images/079cc50a17aea12d5f09ca1d35e58752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbI8q17e8PYC1xcvc0DyXg.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">谷歌Kubernetes引擎</figcaption></figure><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lu"><img src="../Images/594938e08426e617425699abfa493563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhYLRZB54OvguxhyxPPqHA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">驾驶舱仪表板</figcaption></figure><p id="8273" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注:</strong></p><p id="012d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">cockpit kubernetes仪表板可以作为一个pod部署在kubernetes上，要求用户使用为访问其API而配置的标准身份验证进行登录。</p><p id="462e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个pod可以在配置了基本身份验证的kubernetes上使用。默认情况下，pod会尝试安全地访问kubernetes API，并期望kubernetes API服务器已经部署了CA、证书文件和服务帐户密钥。为了改变这种行为，编辑kubernetes-cockpit.json并将KUBE _不安全环境变量改为true。</p><p id="f8a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">成功登录后… </strong></p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lv"><img src="../Images/472f42bc015b0bb03e6ae9bc166af5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*75vlGMaccz2AKswDvXEVwA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">集成GKE的驾驶舱仪表板</figcaption></figure><p id="0e99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">恭喜你！！！驾驶舱仪表板现在作为GKE上的kubernetes吊舱运行。享受使用驾驶舱学习Kubernetes。</p><p id="3fc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请检查:</p><ul class=""><li id="3238" class="lw lx iq jp b jq jr ju jv jy ly kc lz kg ma kk mb mc md me bi translated"><a class="ae kl" href="http://cockpit-project.org/" rel="noopener ugc nofollow" target="_blank">驾驶舱</a></li><li id="31dd" class="lw lx iq jp b jq mf ju mg jy mh kc mi kg mj kk mb mc md me bi translated"><a class="ae kl" href="https://cloud.google.com/kubernetes-engine/" rel="noopener ugc nofollow" target="_blank">谷歌Kubernetes引擎</a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>AWS: Cost Explorer — costs checking on the CloudWatch Logs example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS:Cost Explorer—cloud watch日志上的成本检查示例</h1>
<blockquote>原文：<a href="https://itnext.io/aws-cost-explorer-costs-checking-on-the-cloudwatch-logs-example-e2265c3ff076?source=collection_archive---------5-----------------------#2021-09-07">https://itnext.io/aws-cost-explorer-costs-checking-on-the-cloudwatch-logs-example-e2265c3ff076?source=collection_archive---------5-----------------------#2021-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4db53edc2d31ceaf0cc5efaa8b7bac60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8QppZuMnRQSngTE4H4UqzA.png"/></div></div></figure><p id="b0b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章并不是对AWS Cost Explorer服务的概述，而只是一个如何检测你的AWS账户及其服务成本的简单例子。</p><p id="aefa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，当我从<a class="ae kw" href="https://rtfm.co.ua/poezdka-v-kemer-turciya-foto/" rel="noopener ugc nofollow" target="_blank">假期</a>回来时，我注意到我们为8月份的AWS CloudWatch支付了比平时更多的费用——几乎每天50美元(包括下图中的<em class="kx">其他</em>):</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ky"><img src="../Images/58d4175cbf4872cb7bfd3c241ebf275e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RlMtvsH33qke7ZNN.png"/></div></div></figure><p id="295b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了找出CloudWatch到底花了我们多少钱，在<em class="kx">过滤器</em>中选择<em class="kx"> CloudWatch </em>，并在<em class="kx">组中通过</em>使用<em class="kx">使用类型</em>:</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ld"><img src="../Images/bd5ff6de118cf037ea7d0f11cd0f544b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vW-hd3kTSbLJscXX.png"/></div></div></figure><p id="4960" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以看到，<code class="fe le lf lg lh b">DataProcessing-Bytes</code>在八月份增加了很多，这是CloudWatch日志的第一点。</p><p id="3366" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们检查一下是不是这样—通过将<em class="kx">组切换到<em class="kx"> API操作</em>:</em></p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi li"><img src="../Images/b713ac9dc3e3b64d8d6383a8b38e20c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yzIJGs-VD-kYlW6Y.png"/></div></div></figure><p id="2b56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">哇！现在我们可以看到，从每天50美元中，我们只支付40美元来将新事件写入CloudWatch日志！API操作名<code class="fe le lf lg lh b"><a class="ae kw" href="https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_PutLogEvents.html" rel="noopener ugc nofollow" target="_blank">PutLogEvents</a></code>不言自明。</p><p id="8ba1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好了，现在我们需要找出哪个日志组产生的流量最多。</p><p id="a6f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">转到云观察指标，选择<em class="kx">日志</em> — <em class="kx">日志组指标</em>:</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lj"><img src="../Images/869daaa77278368e4c1002919c13c464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FfxxCtWQqKYqMtPj.png"/></div></div></figure><p id="7e15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，选择所有的<code class="fe le lf lg lh b">IncomingBytes</code>，你会看到你所有日志组的活动:</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lk"><img src="../Images/971f28f84702b4c6ab5589875cca8db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EUIBI0jesWyU09XI.png"/></div></div></figure><p id="9e50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在顶部，我们有一个Aurora集群，它为监控启用了通用日志；一个EKS集群，我们的开发环境，其中有许多活动；以及一个<em class="kx">cloudtrail-Bt trm-management-events</em>日志组，其中有我们的cloud trail活动，请参见<a class="ae kw" href="https://rtfm.co.ua/en/aws-cloudtrail-overview-and-integration-with-cloudwatch-and-opsgenie/" rel="noopener ugc nofollow" target="_blank"> AWS: CloudTrail概述以及与CloudWatch和Opsgenie的集成</a>。</p><p id="3bfe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，最后一件事是调整这些服务的日志设置。</p><p id="afe3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于CloudTrail，我们可以禁用关于写操作的日志记录，因为我们没有将它们用于警报，并且排除一些AWS KMS和AWS RDS日志记录:</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/976ccef8d3614fbca6c7681bc23c410e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sBh3yMhR7LdIXDE7.png"/></div></div></figure><p id="f655" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于EKS集群，禁用所有或一组日志:</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lm"><img src="../Images/87697062fc6668f65549d72580db11c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BIYOHtrmYvNN6oaw.png"/></div></div></figure><p id="2ceb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成了。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="5fa4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">最初发布于</em> <a class="ae kw" href="https://rtfm.co.ua/en/aws-cost-explorer-costs-checking-on-the-cloudwatch-logs-example/" rel="noopener ugc nofollow" target="_blank"> <em class="kx"> RTFM: Linux、DevOps、系统管理</em> </a> <em class="kx">。</em></p></div></div>    
</body>
</html>
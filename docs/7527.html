<html>
<head>
<title>Profile pictures in OutSystems the traffic-saving way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">节省流量的方式</h1>
<blockquote>原文：<a href="https://itnext.io/profile-pictures-in-outsystems-the-traffic-saving-way-5c5f727b1253?source=collection_archive---------0-----------------------#2022-10-24">https://itnext.io/profile-pictures-in-outsystems-the-traffic-saving-way-5c5f727b1253?source=collection_archive---------0-----------------------#2022-10-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6ba9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何实现它们并避免不必要的数据流量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b08257f6d2444d161b9e5b74948ee2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FiphTQb2COh2gUQUvcktLw.png"/></div></div></figure><p id="eb0d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">OutSystems非常方便，在快速实现反应式web应用程序时，它提供了许多现成的UI模式。一个例子是所谓的<em class="ln"> UserInfo </em>小部件，它位于页面的右上角。遗憾的是，尽管这个小部件显示了一个占位符图像，但它并没有实现个人资料图片功能。</p><h1 id="6d23" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">摘要</h1><p id="56ae" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在本文中，您将了解到</p><ul class=""><li id="149a" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">如何以简单的方式实现这个缺失的特性，</li><li id="8e20" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">在数据流量方面有缺点的地方，</li><li id="7f9c" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">以及如何避免它们。</li></ul><p id="b2d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以，我们一起来搭建一个小例子app。</p><h1 id="49dd" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">你需要什么</h1><p id="b36e" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">如果您想自己跟踪实施情况，您需要:</p><ul class=""><li id="9ac6" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">一个外部系统账户(一个<a class="ae mz" href="https://www.outsystems.com/free-edition/" rel="noopener ugc nofollow" target="_blank">免费的个人环境</a>就足够了)</li><li id="196b" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">外部系统服务工作室</li><li id="8f0b" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">带有开发工具的网络浏览器，用于检查发送的请求(例如Edge、Chrome、Firefox)</li></ul><p id="7acc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于本教程，您应该已经有了一些使用外部系统构建反应式web应用程序的经验。</p></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><h1 id="85ac" class="lo lp iq bd lq lr nh lt lu lv ni lx ly jw nj jx ma jz nk ka mc kc nl kd me mf bi translated">简单的解决方案</h1><h2 id="c697" class="nm lp iq bd lq nn no dn lu np nq dp ly la nr ns ma le nt nu mc li nv nw me nx bi translated">向我们的用户添加个人资料图片</h2><p id="74f1" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在OutSystems中，终端用户在<em class="ln">用户</em>实体中管理，该实体可以在<em class="ln">系统</em>模块中找到，并且默认情况下作为新的反应式web应用程序的依赖项添加。由于这个实体没有提供属性来存储配置文件图片，我们需要将图片存储在其他地方。在旨在生产环境中运行的应用程序中，我们会考虑为这种类型的用户配置文件数据提供单独的基于域的服务，或者从身份提供者(例如Azure Active Directory)获取配置文件映像。</p><p id="273d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了简化本文，我们在示例应用程序中创建了一个单独的<em class="ln"> UserPicture </em>实体。由于每个用户只能有一张个人资料图片，我们使用<em class="ln">用户身份</em>作为<em class="ln">用户图片</em>的主键，因此我们得到了一对一的关系。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/414e826d6a48075cf56dd451765009fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nj_o8l8aYev4wYERvn6_xw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">示例应用程序的实体</figcaption></figure><p id="f66c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了让用户能够更改个人资料图片，我们需要一个带有数据操作<em class="ln"> GetProfilePicture </em>的表单来加载当前的图像数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/376c09dd56d47bf8ed7ccddf3b9b297d.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*1cn8GaVocxDooAMNrWJ1Bw.png"/></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">数据操作:GetProfilePicture</figcaption></figure><p id="242a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们在表单上放置一个上传小部件。通过将widget的参数<em class="ln">文件内容</em>设置为<em class="ln"> GetProfilePicture。图片</em>和<em class="ln">接受</em>到<em class="ln">图片</em>，我们得到一个整洁的编辑器，显示当前图片并提供一个上传新图片文件的选项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/aaa2000fb793a12371b0d86b7f7d415e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YUOpMdboeAV0fqLrcyvnJg.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">更改个人资料图片的用户界面</figcaption></figure><p id="b841" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如您在上面的屏幕截图中所看到的，在更改事件上的<em class="ln">的处理程序也被添加到小部件中。这是为了在用户选择新文件时将图像直接保存到数据库中。为了在服务器端实现这个功能，我们实现了一个新的服务器动作<em class="ln"> ProfilePicture_Save </em>。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/6bcb1370bbf6c632d6636fc647c9a85c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8iKA4KzrEna10s_ZJu5L6A.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">客户端操作UploadOnChange和服务器操作ProfilePicture_Save</figcaption></figure><p id="4f8f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了更好地进行测试，我们还将添加一个服务器动作来删除配置文件图片(如果有的话)。所以我们可以复用<em class="ln"> ProfilePicture_Save </em>，将参数<em class="ln"> Picture </em>设置为<em class="ln"> NullBinary() </em>。为了以后更新ui，我们可以刷新数据动作<em class="ln"> GetProfilePicture </em>。但是为了保存这个服务器回调，我们可以简单地乐观并覆盖这个值，因为它应该是<em class="ln"> NullBinary() </em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/d89def7d4ac58502e449032f48cd7db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpCmoQD0-rcotVG1Pysvqw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">扩展用户界面和客户端操作RemoveOnClick</figcaption></figure><p id="8836" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">设置好这些之后，我们就可以发布和测试我们的应用程序了。</p><h2 id="2e1d" class="nm lp iq bd lq nn no dn lu np nq dp ly la nr ns ma le nt nu mc li nv nw me nx bi translated">在UserInfo小工具中显示个人资料图片</h2><p id="8aaf" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">目前，用户已经可以更改个人资料图片，但当然它不会显示在右上角的<em class="ln"> UserInfo </em>小部件中。为了实现这一点，我们需要相应地扩展<em class="ln"> UserInfo </em>小部件。一种简单的方法是将已经实现的数据动作添加到小部件中，并将其输出参数配置为图像小部件的源。这种方法的缺点是，它会在每次页面加载时重新加载，因此配置文件图片总是会从数据库重新加载，并从服务器传输到客户端。正如我的文章标题所说，我们希望避免不必要的流量，所以这不是解决方案。</p><p id="2ab0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您查看OutSystems如何从服务器加载用户名并将其显示在<em class="ln"> UserInfo </em>小部件中，您会看到它们将用户名存储在一个客户端变量中，并仅在必要时从服务器请求它。那么，为什么我们不能将配置文件图片存储在一个客户端变量中呢？这带来了OutSystems不支持客户机变量的二进制数据类型的问题。如果您在OutSystems社区中搜索这个问题的解决方案，您会发现一个简单的解决方案，它将图像编码为base64，并将结果字符串存储在一个客户机变量中。为了显示图像，字符串再次被解码成二进制数据。</p><p id="ed80" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以，我们暂时这么说吧。为了将另一个请求保存到服务器，我们简单地将现有的服务器动作<em class="ln"> GetUserNameFromServer </em>扩展为另一个配置文件图片的输出参数。当然，我们还需要扩展客户端动作<em class="ln"> GetUsername </em>，并将接收到的个人资料图片本地存储到一个新的客户端变量<em class="ln"> UserPicture </em>。为了更好的可重用性和可维护性，我们将它实现为一个单独的客户端动作，以在客户端存储配置文件图片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/d90a561e444ba7ad7973d6e8217c1ab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wIRwkn3fXW0q9_7eqQhdIA.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">标准小部件和SetLocalUserPicture的扩展操作GetUserNameFromServer和GetUsername</figcaption></figure><p id="2460" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">显然，我们还需要检索本地存储的个人资料图片，并将其加载到<em class="ln"> UserInfo </em>的image小部件的source参数中。为此，我们使用第二个客户端动作<em class="ln">getlocaluserphoto</em>，它被配置为一个函数。这允许我们如下图所示修改图像小部件的参数，并直接从客户端动作接收图片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/20a4266624113a94ef327c84a6d0ae87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*82FLcHxQj5XvWjva_qKpqg.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">在UserInfo小部件中获取LocalUserPicture和更改的配置文件图像</figcaption></figure><p id="37ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了将二进制数据编码和解码为base64字符串，我们可以简单地编写自己的JavaScript<em class="ln">base64 encode</em>和<em class="ln"> Base64decode </em>。它们包含一个输入和一个输出参数，分别用于接收和返回二进制数据和编码字符串。使用javascript中的<em class="ln">窗口</em>对象的内置<em class="ln"> btoa </em>和<em class="ln"> atob </em>函数，转换非常容易:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="9f56" class="nm lp iq ok b gy oo op l oq or">// base64 encode:<br/>$parameters.Base64 = window.btoa($parameters. Binary);</span><span id="4bbf" class="nm lp iq ok b gy os op l oq or">// base64 decode:<br/>$parameters.Binary = window.atob($parameters.Base64);</span></pre><p id="5f39" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">恭喜，我们已经成功让用户上传了一张个人资料图片，并显示在已经存在的<em class="ln"> UserInfo </em>小部件中，而无需重复请求。但是故事还有更多…</p></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><h1 id="4759" class="lo lp iq bd lq lr nh lt lu lv ni lx ly jw nj jx ma jz nk ka mc kc nl kd me mf bi translated">使用客户端变量是一个聪明的想法吗？</h1><p id="f083" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">客户端变量不同于普通的屏幕变量，即使在浏览器关闭时也保存在本地存储中，并且在屏幕之间共享。如果您想保留用户偏好或整体上下文，这尤其有用。</p><p id="34e8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这对我们的目的来说太棒了，不是吗？只要客户端变量只在客户端使用，上述解决方案完全可以工作。</p><h2 id="76de" class="nm lp iq bd lq nn no dn lu np nq dp ly la nr ns ma le nt nu mc li nv nw me nx bi translated">服务器回调中不必要的数据流量</h2><p id="c595" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">但是，一旦在服务器端访问了单个客户机变量，默认情况下，所有客户机变量都会随着每次回调被传输到服务器。</p><p id="2d09" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了说明示例应用程序中的行为，让我们创建一个名为<em class="ln"> ResultsPerPage </em>的客户机变量，默认值为10，并在屏幕上添加一个小列表视图。为简单起见，数据动作<em class="ln"> GetListData </em>返回n个随机生成的密码，其中n是<em class="ln"> ResultsPerPage </em>的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/856e3a5d5bf206edd5043de51b311ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Rc0ZpKMtl7IFdRtdAD56Q.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">带有列表视图和新数据操作GetListData的扩展屏幕</figcaption></figure><p id="6419" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们现在发布这个新的应用程序版本，我们可以在浏览器的开发工具中检查(要打开按F12)，当我们单击<em class="ln">刷新列表</em>按钮时，哪些数据被发送到服务器。正如您在network选项卡中看到的，所有客户端变量，包括base64编码的配置文件图片，都是在每个服务器回调的有效负载中发送的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/145d6813cfb0fbed74595f08a3102582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HB-DAip2YbEQjsNzYNReGw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">浏览器开发工具中的网络检测</figcaption></figure><p id="c624" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当然，本例中的102 kB并不是很大的数据量，但是不必要地传输它是没有意义的。根据应用程序的复杂性和只在本地需要的客户端变量的数量，这可能会很快增加大量不应该传输的数据。</p><h1 id="c758" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">更好的解决方案</h1><p id="f922" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">目标是防止配置文件图片作为客户机变量的一部分随每个请求被发送到服务器。为了实现这一点，我们可以修改已经实现的客户端操作，将图片存储在独立于标准外部系统机制的单独的本地存储项中，该机制也将本地存储用于其客户端变量。</p><p id="f1b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为此，我们首先移除<em class="ln">用户图片</em>客户端变量，因为我们不再需要它了。之后，我们需要调整客户端动作<em class="ln">SetPictureFromLocalStorage</em>和<em class="ln">GetPictureFromLocalStorage</em>的逻辑，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/0c8a84f91659ccbaee1134169216cf17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96nPv3P2ROvRYXZk8kO-0Q.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">修改了客户端操作，以便从本地存储中存储和加载个人资料图片</figcaption></figure><p id="d180" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从截图的中间部分可以看到，所有三个新的JavaScripts都有一个名为<em class="ln"> AppName </em>的输入参数。它用于为我们单独的本地存储项的键创建应用程序特定的前缀。如果在同一台主机上部署了多个应用程序，这可以确保每个应用程序都有自己的命名空间。此外，前缀还包含段<em class="ln"> $KeepLocalVars$ </em>来标识我们的纯本地变量，并将它们与外部系统使用的名称空间区分开来。</p><p id="cbd5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要访问本地存储，您可以在OutSystems forge中找到Paulo Ca ao的组件<a class="ae mz" href="https://www.outsystems.com/forge/component-overview/6978/local-storage-reactive" rel="noopener ugc nofollow" target="_blank"> <em class="ln">本地存储Reactive </em> </a> <em class="ln"> </em>。我决定不使用它，因为我们只需要三行简单的代码就可以得到结果，并且可以同时对二进制数据进行所需的编码。</p><p id="871b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面您可以找到三个新JavaScripts的清单:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="9bc9" class="nm lp iq ok b gy oo op l oq or">// SavePictureToLocalStorage<br/>window.localStorage.setItem(<br/>  '$' + $parameters.AppName + '$KeepLocalVars$UserPicture',<br/>  window.btoa($parameters.Binary)<br/>);</span><span id="a071" class="nm lp iq ok b gy os op l oq or">// RemovePictureFromLocalStorage<br/>window.localStorage.removeItem(<br/>  '$' + $parameters.AppName + '$KeepLocalVars$UserPicture'<br/>);</span><span id="ca70" class="nm lp iq ok b gy os op l oq or">// GetPictureFromLocalStorage<br/>var p = window.localStorage.getItem(<br/>  '$' + $parameters.AppName + '$KeepLocalVars$UserPicture'<br/>);<br/>if (p!==null) $parameters.Binary = window.atob(p);</span></pre><p id="b3c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在让我们重新发布我们的应用程序，并检查网络选项卡。如您所见，现在客户机变量<em class="ln"> UserPicture </em>不再被发送到服务器。</p><h2 id="c637" class="nm lp iq bd lq nn no dn lu np nq dp ly la nr ns ma le nt nu mc li nv nw me nx bi translated">最后一个问题</h2><p id="62c8" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">当用户注销时，如何清除本地存储项目？答案很简单:绝不！</p><p id="7d5a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您不会遇到这种行为问题的原因是，OutSystems会在注销时清除客户机变量，所以<em class="ln"> Client。用户名</em>在下一次<em class="ln"> GetUsername </em>运行时为空，本地存储的个人资料图片将被覆盖。尽管如此，在注销时主动从本地存储中删除个人资料图片是一个很好的做法。为此，我们只需在<em class="ln">UserInfo</em>小部件的注销客户端动作中，调用参数<em class="ln">图片</em>设置为<em class="ln"> NullBinary() </em>的<em class="ln">setlocauserphoto</em>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/a3c9e868e007479e2043107534c010f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*8Q2o7Eke96eULFYpqg8c-w.png"/></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">注销时删除本地个人资料图片</figcaption></figure></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><p id="e41d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望这篇文章对你来说是有趣的，我已经谈到了这个话题。如果您有任何未解决的问题或需要我改进的建议，请通过medium或我的<a class="ae mz" href="https://www.outsystems.com/profile/enrntqhemy/" rel="noopener ugc nofollow" target="_blank"> OutSystems profile </a>联系我。</p></div></div>    
</body>
</html>
<html>
<head>
<title>VMware vSphere — install Centos 8 and run minishift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VMware vSphere —安装Centos 8并运行minishift</h1>
<blockquote>原文：<a href="https://itnext.io/vmware-vsphere-install-centos-8-and-run-minishift-d40c56848f5c?source=collection_archive---------2-----------------------#2019-10-29">https://itnext.io/vmware-vsphere-install-centos-8-and-run-minishift-d40c56848f5c?source=collection_archive---------2-----------------------#2019-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3344" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">许多公司都在VMware vSphere之上运行OpenShift来部署、运行和管理其容器生命周期。OpenShift使用容器编排平台Kubernetes来完成这项工作。</p><p id="7c15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尤其是在为OpenShift开发应用程序时，或者如果您只是想运行一个本地测试环境来玩玩，您绝对应该查看一下<a class="ae kl" href="https://github.com/minishift/minishift" rel="noopener ugc nofollow" target="_blank"> minishift </a>。</p><p id="e8d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇博客文章介绍了虚拟机的创建和Centos 8操作系统的安装，以及安装minishift的第一步。</p><h1 id="bf7a" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">虚拟机的创建</h1><p id="dcd6" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">您几乎可以创建一个完全标准化的虚拟机，并选择Centos 8 (x64)作为操作系统。因为我们希望在该虚拟机中基于KVM运行它，所以您需要导出硬件虚拟化特性。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/6e480c0aa8953e2c0925fda61808024e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Xr-1E_9aNP5J08PP.png"/></div></div></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/6e417bcc7e03f50f629e876b007dc2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x9AQ1x6ujXQKvaJ5.png"/></div></div></figure><h1 id="7e1f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">Centos 8的安装</h1><p id="b693" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们不深入研究Centos 8的安装本身，因为它非常简单。您可以在此下载dvd映像，连接并运行安装程序:</p><p id="d232" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="http://isoredirect.centos.org/centos/8/isos/x86_64/CentOS-8-x86_64-1905-dvd1.iso" rel="noopener ugc nofollow" target="_blank">http://iso redirect . CentOS . org/CentOS/8/isos/x86 _ 64/CentOS-8-x86 _ 64-1905-DVD 1 . iso</a></p><h1 id="2922" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">第一次开始Centos 8</h1><p id="b2c0" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">真正有趣的部分是从你新安装的操作系统的第一个配置步骤开始的。尤其是如果你不习惯RedHat OS或者不习惯老版本的话，命令行会有一些变化。</p><p id="cf11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">设置您的网络</strong></p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="adfd" class="mg kn iq mc b gy mh mi l mj mk"># set your hostname <br/>nmtui-hostname</span><span id="bd74" class="mg kn iq mc b gy ml mi l mj mk"># configure your network <br/>nmtui-edit</span><span id="05f9" class="mg kn iq mc b gy ml mi l mj mk"># connect your network <br/>nmtui-connect</span></pre><p id="bec0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">更新软件包</strong></p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="3c96" class="mg kn iq mc b gy mh mi l mj mk">dnf check-update <br/>dnf update <br/>dnf clean all</span><span id="bc42" class="mg kn iq mc b gy ml mi l mj mk"># install some basic tools <br/>dnf install nano vim wget curl net-tools lsof bash-completion</span></pre><p id="03cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">创建一个拥有sudo权限的新用户帐户</strong></p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="8773" class="mg kn iq mc b gy mh mi l mj mk">useradd user <br/>passwd user <br/>usermod -aG wheel user</span></pre><h1 id="d659" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">安装kvm</h1><p id="5968" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">从配置桥接网络开始</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="6d0a" class="mg kn iq mc b gy mh mi l mj mk"># create and edit the following file <br/>vi /etc/sysconfig/network-scripts/ifcfg-br0</span><span id="a624" class="mg kn iq mc b gy ml mi l mj mk"># file content <br/>DEVICE=br0 <br/>TYPE=Bridge <br/>IPADDR=192.168.10.100 <br/>NETMASK=255.255.255.0 <br/>GATEWAY=192.168.10.1 <br/>DNS=192.168.10.1 <br/>ONBOOT=yes <br/>BOOTPROTO=static <br/>DELAY=0</span></pre><p id="eac0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和默认网络适配器</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="66c9" class="mg kn iq mc b gy mh mi l mj mk"># create or change the interface config (check the interface name, i. e. ens192) <br/>vi /etc/sysconfig/network-scripts/ifcfg-ens192</span><span id="3a2b" class="mg kn iq mc b gy ml mi l mj mk"># file content <br/>DEVICE=eth0 <br/>TYPE=Ethernet <br/>BOOTPROTO=none <br/>BRIDGE=br0 <br/>NAME=ens192 <br/>DEVICE=ens192 ONBOOT=yes</span></pre><p id="453a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重新启动系统，它应该出现一个桥接网络和配置的ip地址。</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="63fd" class="mg kn iq mc b gy mh mi l mj mk"># install required packages <br/>dnf install qemu-kvm qemu-img libvirt virt-install libvirt-client</span><span id="bd94" class="mg kn iq mc b gy ml mi l mj mk"># check the kvm module <br/>lsmod | grep kvm</span><span id="46b3" class="mg kn iq mc b gy ml mi l mj mk"># start and enable the libvirtd <br/>systemctl start libvirtd <br/>systemctl enable libvirtd</span></pre><p id="8f10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样，KVM安装完毕，应该可以运行了。</p><h1 id="a404" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">准备</h1><p id="8ca7" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">由于默认使用virtualbox，我们需要首先安装minishift KVM驱动程序:</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="f6eb" class="mg kn iq mc b gy mh mi l mj mk">sudo usermod -a -G libvirtd $(whoami)<br/>newgrp libvirt<br/>curl -L https://github.com/dhiltgen/docker-machine-kvm/releases/download/v0.10.0/docker-machine-driver-kvm-centos7 -o docker-machine-driver-kvm<br/>sudo mv docker-machine-driver-kvm /usr/local/bin/docker-machine-driver-kvm<br/>sudo chmod +x /usr/local/bin/docker-machine-driver-kvm</span></pre><p id="aaa5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后启动默认网络</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="b97c" class="mg kn iq mc b gy mh mi l mj mk">sudo virsh net-start default <br/>sudo virsh net-autostart default</span></pre><h1 id="ae59" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">装置</h1><p id="e6c0" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">检查最新版本，并相应地更改版本号:</p><p id="b166" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/minishift/minishift/releases/latest" rel="noopener ugc nofollow" target="_blank">https://github.com/minishift/minishift/releases/latest</a></p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="0945" class="mg kn iq mc b gy mh mi l mj mk">export VER="1.34.1"<br/>curl -L https://github.com/minishift/minishift/releases/download/v$VER/minishift-$VER-linux-amd64.tgz -o minishift-$VER-linux-amd64.tgz<br/>tar xvf minishift-$VER-linux-amd64.tgz# copy the executable to /usr/local/bin<br/>sudo mv minishift-$VER-linux-amd64/minishift /usr/local/bin # check the version<br/>minishift version</span></pre><h1 id="e889" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">第一次开始</h1><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="5f68" class="mg kn iq mc b gy mh mi l mj mk"># start minishift<br/>minishift start</span><span id="fc9f" class="mg kn iq mc b gy ml mi l mj mk"># get minishift console url<br/>minishift console --url</span><span id="3cad" class="mg kn iq mc b gy ml mi l mj mk"># stop minishift<br/>minishift stop</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/948cd32cd58d033a2c9359e0fbc0e436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qlq9-oaFhtBKxoCa.png"/></div></div></figure><p id="b508" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一条消息应该显示可以使用浏览器打开的控制台url</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="04dd" class="mg kn iq mc b gy mh mi l mj mk">Server Information ...<br/>OpenShift server started.The server is accessible via web console at:<br/>    https://192.168.42.144:8443/console</span></pre><h1 id="586f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">安装命令行界面(oc)</h1><p id="ce39" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">要使用命令行控制和管理Openshift，还应该安装oc命令。oc命令已经集成，您可以简单地将它复制到您的默认路径中，比如/usr/local/bin</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="790d" class="mg kn iq mc b gy mh mi l mj mk">sudo cp ~/.minishift/cache/oc/v3.11.0/linux/oc /usr/local/bin</span></pre><h1 id="04fb" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">oc命令</h1><p id="1a59" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">检查oc是否工作:</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="1326" class="mg kn iq mc b gy mh mi l mj mk"><strong class="mc ir"><em class="mm">oc version</em></strong></span></pre><p id="b5a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以管理员身份登录:</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="b795" class="mg kn iq mc b gy mh mi l mj mk"><strong class="mc ir"><em class="mm">oc login -u system:admin</em></strong></span></pre><p id="87a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查您的运行配置:</p><pre class="lq lr ls lt gt mb mc md me aw mf bi"><span id="05a2" class="mg kn iq mc b gy mh mi l mj mk"><strong class="mc ir"><em class="mm">oc config view</em></strong></span></pre><h1 id="600d" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">后续步骤</h1><p id="2592" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">您现在应该有一个正在运行的安装，oc命令应该会给您有意义的响应。</p><p id="3abe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇博文中，我们将介绍kubectl安装、插件安装和运行您的第一个应用程序等步骤。</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="ee45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mm">原载于2019年10月29日</em><a class="ae kl" href="https://www.opvizor.com/vmware-vsphere-install-centos-8-and-run-minishift" rel="noopener ugc nofollow" target="_blank"><em class="mm">【https://www.opvizor.com】</em></a><em class="mm">。</em></p></div></div>    
</body>
</html>
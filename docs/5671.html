<html>
<head>
<title>The benefits of a shared mobile architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">共享移动架构的优势</h1>
<blockquote>原文：<a href="https://itnext.io/the-benefits-of-a-shared-mobile-architecture-18b766be7c3c?source=collection_archive---------3-----------------------#2021-04-28">https://itnext.io/the-benefits-of-a-shared-mobile-architecture-18b766be7c3c?source=collection_archive---------3-----------------------#2021-04-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e498" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于如何提高移动应用质量和一致性的故事</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/98f90398f0a10782ffbbbf274ef2650b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3bFsazNPwSQIS7hY"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Muhammadh Saamy 在<a class="ae lb" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="20a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大约一年前，也就是2020年夏初，我的团队决定对我们应用中的一个非常重要的页面——付费墙页面进行重构和现代化。你可以理解为什么打破人们购买我们服务的页面不是一个选项，所以我们必须非常注意我们将如何进行。</p><p id="b9c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那为什么要冒这个险呢？我们需要在这个页面上进行更快、更可靠的运输实验，以便优化我们的收入。记住<strong class="jp ir">一个重构项目总是需要一个商业理由</strong>才能被非技术人员接受。所以我们开始工作。</p><p id="540e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的工程经理<a class="ae lb" href="http://hannesdorfmann.com" rel="noopener ugc nofollow" target="_blank">汉尼斯·多尔夫曼</a>的参与下(去看看他，他有很多有趣的内容)，我们决定这一次我们将以不同的方式做事。我们决定在Android和iOS上以完全相同的方式设计和实现这个页面。</p><p id="92bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">读到这句话，你可能会想到一个问题。</p><p id="7860" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">“Alessandro，你是在说跨平台技术吗？？?"</em></p><p id="a725" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你们中的一半已经兴奋得从椅子上跳了起来，而另一半甚至因为我问了这个问题而生气。您可以放心，我不是在谈论使用跨平台技术，或者至少现在不是。虽然探索这个话题可能很有趣，但走这条路没有太多意义。该页面对业务至关重要，而跨平台技术在我的公司并不常见。</p><p id="f191" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，我所说的以完全相同的方式建造东西是什么意思呢？</p><h1 id="5151" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">项目的范围</h1><p id="50fe" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">在我们开始之前，让我说明这个项目主要是在移动客户端(Android和iOS)上进行的。我不会谈论后端或Web方面的事情。</p><p id="381c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们做出的决定简单而有力，我们决定以同样的方式设计页面。想象一下，在两个平台上有相同的类、相同的方法、相同的状态表示等等。换句话说，我们决定使用<strong class="jp ir">相同的架构</strong>。</p><p id="4c99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但我们并没有就此止步，我们承诺在开发过程中会相互支持，以保持正确的道路，并验证实现也会尽可能保持一致。注意，当我谈到架构时，我指的是UI实现细节之外的一切。对于每个平台来说，这一部分仍然会有不同的处理方式，因为UI框架差异太大，无法以相同的方式实现(目前…)。</p><p id="6065" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会深入到架构本身，因为这不是本文的重点。如果你想知道更多细节，请留言。简而言之，我们使用了MVI(模型视图意图)的修改版本，主要依赖于创建解耦组件、反应式编程、通过状态机的状态管理、可靠原则等等。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/f1d8314935fca8135a7659b160f977ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*AU-ap5Hzh3u-9ghv1PdlHw.jpeg"/></div></figure><p id="b963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如今，许多公司都有跨职能团队，与所有移动工程师一起开始设计一个功能已经成为惯例(如果你的公司还没有，对不起，坚持住)，但这通常不会持续太久。在某个点上，已经完成了非常高层次的细化，每个人都或多或少地理解了使某个功能工作并满足主要需求所需的高层次组件。不幸的是，在这之后，工程师们基于他们的平台分裂了，他们去决定中间层组件和实现细节。<br/>虽然你会从分享第一次细化会议中获得一些回报，但在我看来，你只是触及了所能实现的表面。</p><p id="f705" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果这是你目前的工作方式，我不怪你。从表面上看，这有点道理，而且似乎是最容易走的路。毕竟，除非你是从零开始构建一个应用程序，否则一个特性必须被放在已经存在的特性、架构、设计模式约束和技术债务的环境中。</p><p id="a2bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们将在下一节中看到的，这条“看似容易”的道路隐藏着许多坎坷，这些坎坷会在途中被发现，并会在未来回来找你麻烦。</p><h1 id="a8aa" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">为什么要使用统一的架构？</h1><p id="e1f6" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">为了理解我们为什么选择这条道路，首先，我们需要理解我们试图解决的问题:<strong class="jp ir">一致性</strong>和<strong class="jp ir">质量</strong>。当在筒仓中分别构建东西时(是的，如果你们一起设计，然后自己实现，我仍然会认为它是筒仓),你一定会做出不同的决定。</p><p id="d6a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题有两种不同的解决方式。随着时间的推移，不同的决策将会结合在一起，并在移动客户端上导致两种非常不同的实现。这是为什么呢？为什么我们需要用两种不同的方法解决同一个问题两次？就我个人而言，除了一些非常罕见的特定于平台的案例或问题，我从来没有找到一个好的理由。</p><p id="4a98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在测试过程中(或者更糟糕的是，在生产环境中)，你会发现这两个应用的行为有细微的差别。<strong class="jp ir">差异产生技术债务</strong>。将来，没有人会理解为什么相同的特性在不同的平台上有这些差异。人们的任务将是理解哪个行为是正确的，并且必须在另一个平台上重构错误的行为。或者更糟，你会走“一直都是这样，就让它这样吧”这条路。</p><p id="2ca8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实现上的差异导致会出现不同的错误。当来自一个平台的工程师忙于修复bug时，来自另一个平台的工程师将继续他们的sprint工作，这就造成了团队在sprint中所能实现的不平衡，并降低了团队的可预测性。</p><p id="8715" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不幸的是，这些问题并不局限于单个特征。通常，平台创新是由各自的学院推动的(这就是我们对来自一个平台的所有工程师的称呼)。这个小组为他们的平台决定所有的指导方针，通常他们的决定基于社区中流行的东西。不同的学院会创建不同的指南，这些指南会将我们提到的所有问题扩展到整个应用程序。</p><p id="9b50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">老实说，在中小规模上，这没什么不好，反正大多数公司都是这么运作的。然而，当风险增加时，你需要找到优化的方法，并且在你运输的货物和产品的最终质量上更加一致。</p><h1 id="f941" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">最后，所有的好处…</h1><p id="0b22" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">统一架构如何解决一致性和质量这两个主要问题，以及上述所有副作用？</p><p id="5b50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过使用统一的架构，您可以<strong class="jp ir">简化设计和开发流程</strong>。现在问题以单一的方式解决，这意味着有了一台运转良好的机器，你可以在技术上解决一个问题，为此投入两倍的精力(如果你是为了质量而优化)，或者甚至用同样数量的工程师解决两倍的问题(如果你是为了速度而优化)。仅仅凭借这个简单的概念，我们已经解决了两个主要问题。质量可以更高，因为两倍多的人在处理同一个问题，而且你会有一致性，因为一个问题只有一个解决方案。</p><p id="03e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样，现在我们可以自由地探索我们一路走来发现的所有额外好处。</p><p id="4161" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">多种形式的超负荷跨平台协作</strong>:</p><ul class=""><li id="c83b" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated">工程师从一个平台到另一个平台的<strong class="jp ir">过渡变得容易多了。Kotlin和Swift是非常相似的语言，而且如果代码以相同的方式编写(相同的设计模式、相同的架构、相同的名称)，拥有能够在两个平台上工作的工程师会变得容易得多。</strong></li><li id="591a" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">出于同样的原因，<strong class="jp ir">跨平台代码评审</strong>成为一种简单的习惯。这就是我们如何保持一致性，甚至在实施细节。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/8789841a9bb2833615f9b4afd1f4816d.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*Hi6cs-eEmkpzXH-8hpwO4Q.jpeg"/></div></figure><p id="cf8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果应用程序以一致的方式工作，那么<strong class="jp ir"> QA(质量保证)流程也会得到简化</strong>。现在，您可以为两个应用程序规划一个通用的测试自动化策略，从高级测试到两个应用程序都应该有的特定单元测试。</p><p id="98f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，在我们发布到产品中的特性中，我们经历了更少的bug(在发布6个月之后，每个平台一个)。我们能够在发布之前找到并修复大部分问题，这是一个巨大的成功。</p><p id="299b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看市场和其他科技公司，引入统一架构似乎是提高工程部门质量和速度的自然下一步。一个著名的例子来自<a class="ae lb" href="https://www.uber.com/" rel="noopener ugc nofollow" target="_blank"/>和他们的<a class="ae lb" href="https://github.com/uber/RIBs" rel="noopener ugc nofollow" target="_blank">肋骨建筑</a>。</p><p id="6ed6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，这两个平台可能会很快开始集成SwiftUI和Jetpack Compose。考虑到这些新的UI系统<strong class="jp ir">是使用相同的范例</strong>(基于状态的声明式UI)定义的，这里有一个推动统一架构的巨大机会。从那时起，统一设计也可以扩展到ui。</p><h1 id="6526" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><strong class="ak">包装</strong></h1><p id="5117" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">这有很多好处。<br/>使用统一架构肯定不是一个完美的方法(生活中很少有事情是这样的)，但在本文中，我试图解释为什么它对我们有好处，以及我们如何设法<strong class="jp ir">提高质量和一致性</strong>，甚至获得比我们要求的更多的好处，如<strong class="jp ir">跨平台协作和更少的错误</strong>。</p><p id="8b11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我确实相信在一致性和质量方面还有更多的事情可以做，但是我认为在谈论更大的计划(例如跨平台开发)之前，统一的架构是大多数团队可以采取的简单的第一步。<br/>我希望你下次在公司启动新功能或新项目时，能够带着学到的知识做出明智的决定。</p><p id="b799" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇文章中，我们将讨论采用统一架构的缺点，我相信其中一些会让你感到惊讶。</p><p id="20c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么你觉得这个过程怎么样呢？你有没有尝试过在Android和iOS上使用完全相同的架构来构建一个功能或应用？怎么样了？<br/>请在下面的评论中告诉我，或者发微博给我<a class="ae lb" href="https://twitter.com/_alerecchi" rel="noopener ugc nofollow" target="_blank"> @_alerecchi </a></p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="5e9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">原载于2021年4月28日https://www.alessandrorecchi.com</em><em class="lc">的</em> <a class="ae lb" href="https://www.alessandrorecchi.com/shared-mobile-architecture-pros/" rel="noopener ugc nofollow" target="_blank"> <em class="lc">。</em></a></p></div></div>    
</body>
</html>
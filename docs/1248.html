<html>
<head>
<title>Unleash the hidden superpowers of react-intl (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">释放react-intl隐藏的超能力(第1部分)</h1>
<blockquote>原文：<a href="https://itnext.io/unleash-the-hidden-superpowers-of-react-intl-part-1-a59ba5e960cf?source=collection_archive---------5-----------------------#2018-08-21">https://itnext.io/unleash-the-hidden-superpowers-of-react-intl-part-1-a59ba5e960cf?source=collection_archive---------5-----------------------#2018-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="1ed7" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">第1部分:如何使用babel宏美化翻译的react.js标记</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/38d66b12887e6ba6763ea368183ef64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ds-vry9icWK4-nnAN0R8ow.png"/></div></div></figure><p id="f62d" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">让图像说话，看看你会得到什么:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lv"><img src="../Images/f2ad288968c7cd3cb57bd0675760f281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ha96A0wutfZ2UkjiWYPZRg.png"/></div></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h2 id="eba3" class="md jo iq bd jp me mf dn jt mg mh dp jx li mi mj kb lm mk ml kf lq mm mn kj mo bi translated">我们不喜欢这种混乱:</h2><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="9bac" class="md jo iq mq b gy mu mv l mw mx">const name = 'John Doe';</span><span id="4ab3" class="md jo iq mq b gy my mv l mw mx">&lt;FormattedMessage<br/>   id="welcome"<br/>   defaultMessage={`Hello {name}!`}<br/>   values={{ name: &lt;b&gt;{name}&lt;/b&gt; }}<br/>/&gt;</span></pre><p id="95b2" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">虽然react-intl工作得很好，但是到处都有这些<code class="fe mz na nb mq b">FormattedMessage</code>并不能真正帮助保持代码的美观和可读性。你可以这样写不是更好吗:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="a343" class="md jo iq mq b gy mu mv l mw mx">&lt;FormattedMessage id=”welcome”&gt;Hello &lt;b&gt;{name}&lt;/b&gt;!&lt;/FormattedMessage&gt;</span></pre><h2 id="abd1" class="md jo iq bd jp me mf dn jt mg mh dp jx li mi mj kb lm mk ml kf lq mm mn kj mo bi translated">巴别塔宏来救援了</h2><p id="b9af" class="pw-post-body-paragraph kx ky iq kz b la nc lc ld le nd lg lh li ne lk ll lm nf lo lp lq ng ls lt lu ij bi translated">您可以轻松地编写一个babel插件，将上述简化的标记转换成所需的react-intl FormattedMessage。但是有一个更好的方法使用<a class="nh ni ep" href="https://medium.com/u/db72389e89d8?source=post_page-----a59ba5e960cf--------------------------------" rel="noopener" target="_blank">肯特·c·多兹</a>巴别塔宏(<a class="ae nj" href="https://github.com/kentcdodds/babel-plugin-macros" rel="noopener ugc nofollow" target="_blank">https://github.com/kentcdodds/babel-plugin-macros</a>)。使用宏有一个很大的好处(除了它们创建起来超级简单之外),你可以在使用<a class="ae nj" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>创建的应用程序中使用它们，而不需要弹出(编写时需要一个alpha build v2.x.x)。</p><p id="f8ae" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">babel宏基本上只是一个使用宏获取节点引用的函数:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="3a63" class="md jo iq mq b gy mu mv l mw mx">const { createMacro } = require('babel-plugin-macros')</span><span id="2756" class="md jo iq mq b gy my mv l mw mx">module.exports = createMacro(myMacro)</span><span id="d9b2" class="md jo iq mq b gy my mv l mw mx">function myMacro({references, state, babel}) {<br/>  // the FormattedMessage imported in below code snippet<br/>  const { FormattedMessage = [] } = references;</span><span id="28fe" class="md jo iq mq b gy my mv l mw mx">// transform each occurance<br/>  FormattedMessage.forEach(referencePath =&gt; { /* transform */ });<br/>}</span></pre><p id="72ea" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们不会讨论用于转换简单标记的宏的所有细节，但是您可以在这里查看代码:</p><blockquote class="nk nl nm"><p id="0efd" class="kx ky nn kz b la lb lc ld le lf lg lh no lj lk ll np ln lo lp nq lr ls lt lu ij bi translated"><a class="ae nj" href="https://github.com/locize/locize-react-intl-example/blob/master/src/intl.macro.js" rel="noopener ugc nofollow" target="_blank">https://github . com/locize/locize-react-intl-example/blob/master/src/intl . macro . js</a></p></blockquote><p id="b887" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">您可以像这样使用宏:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="2529" class="md jo iq mq b gy mu mv l mw mx">// import the macro component<br/>import { FormattedMessage } from "./intl.macro";</span><span id="bcfc" class="md jo iq mq b gy my mv l mw mx">// and use it<br/>&lt;FormattedMessage id=”welcome”&gt;Hello &lt;b&gt;{name}&lt;/b&gt;!&lt;/FormattedMessage&gt;</span></pre><p id="dc1b" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">宏会将其转换为react-intl FormattedMessage:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="f7c7" class="md jo iq mq b gy mu mv l mw mx">&lt;FormattedMessage<br/>   id="welcome"<br/>   defaultMessage={`Hello {name}!`}<br/>   values={{ name: &lt;b&gt;{name}&lt;/b&gt; }}<br/>/&gt;</span></pre><h2 id="7459" class="md jo iq bd jp me mf dn jt mg mh dp jx li mi mj kb lm mk ml kf lq mm mn kj mo bi translated">复数和选择</h2><p id="f473" class="pw-post-body-paragraph kx ky iq kz b la nc lc ld le nd lg lh li ne lk ll lm nf lo lp lq ng ls lt lu ij bi translated">我们可以在简单的复数和选择中加入更多的宏魔术:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="84df" class="md jo iq mq b gy mu mv l mw mx">import { Select, Plural } from "./intl.macro";</span><span id="f8c3" class="md jo iq mq b gy my mv l mw mx">// select<br/>&lt;FormattedMessage<br/>  id="avoid_bugs"<br/>  defaultMessage="{gender,select,he{He avoids bugs.}she{She avoids bugs.}other{They avoid bugs.}}"<br/>  values={{ count: 10 }}<br/>/&gt;</span><span id="48f6" class="md jo iq mq b gy my mv l mw mx">// will become<br/>&lt;Select<br/>  id="avoid_bugs"<br/>  switch={gender}<br/>  male="He avoids bugs."<br/>  female="She avoids bugs."<br/>  other="They avoid bugs."<br/>/&gt;</span><span id="220e" class="md jo iq mq b gy my mv l mw mx">// plurals<br/>&lt;FormattedMessage<br/>  id="items_count"<br/>  defaultMessage="{count,plural,=0{There is no item.}one{There is # item.}other{There are # items.}}"<br/>  values={{ count: 10 }}<br/>/&gt;</span><span id="f221" class="md jo iq mq b gy my mv l mw mx">// will become:<br/>&lt;Plural<br/>  id="items_count"<br/>  count={itemsCount1}<br/>  $0="There is no item."<br/>  one="There is # item."<br/>  other="There are # items."<br/>/&gt;</span></pre><p id="b18d" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">如需更多选项(如嵌套组件)，请查看示例用法:</p><blockquote class="nk nl nm"><p id="814a" class="kx ky nn kz b la lb lc ld le lf lg lh no lj lk ll np ln lo lp nq lr ls lt lu ij bi translated"><a class="ae nj" href="https://github.com/locize/locize-react-intl-example/blob/master/src/ComponentUsingMacro.js" rel="noopener ugc nofollow" target="_blank">https://github . com/locize/locize-react-intl-example/blob/master/src/component using macro . js</a></p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="a3bd" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">因此，在第一部分中，你学习了如何使用<a class="ae nj" href="https://github.com/kentcdodds/babel-plugin-macros" rel="noopener ugc nofollow" target="_blank"> babel-plugin-macros模块</a>使你的标记比仅仅使用react-intl提供的<code class="fe mz na nb mq b">FormattedMessage</code>更具可读性。</p><p id="2325" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">不要忘记，您可以在此处的示例基础上构建:</p><blockquote class="nk nl nm"><p id="547c" class="kx ky nn kz b la lb lc ld le lf lg lh no lj lk ll np ln lo lp nq lr ls lt lu ij bi translated"><a class="ae nj" href="https://github.com/locize/locize-react-intl-example" rel="noopener ugc nofollow" target="_blank">https://github.com/locize/locize-react-intl-example</a></p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="98fe" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">在即将发布的第二部分中，您将了解如何使用react-intl扩展react.js项目，以提供国际化来实现简单的连续本地化生命周期，这也适用于需要将翻译拆分为多个文件的大型项目。</p><p id="066c" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">希望你喜欢第一部分——敬请期待第二部分。</p></div></div>    
</body>
</html>
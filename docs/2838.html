<html>
<head>
<title>ASP.NET Core Server-Side Blazor with Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带认证的ASP.NET核心服务器端Blazor</h1>
<blockquote>原文：<a href="https://itnext.io/asp-net-core-server-side-blazor-with-authentication-2ffa37c37d8b?source=collection_archive---------3-----------------------#2019-08-12">https://itnext.io/asp-net-core-server-side-blazor-with-authentication-2ffa37c37d8b?source=collection_archive---------3-----------------------#2019-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f25d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自从我在Blazor上写了第一篇帖子<a class="ae kl" href="https://elanderson.net/2018/08/asp-net-core-basics-blazor/" rel="noopener ugc nofollow" target="_blank">ASP.NET核心基础:Blazor </a>以来，已经过去了将近一年，很多事情都变了。最重要的事情是，它宣布<a class="ae kl" href="https://devblogs.microsoft.com/aspnet/blazor-0-6-0-experimental-release-now-available/" rel="noopener ugc nofollow" target="_blank">服务器端Blazor将与。网芯3 </a>。这篇文章将介绍如何创建一个包含认证的服务器端Blazor应用程序。</p><h2 id="81f5" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">服务器端Blazor</h2><p id="4d10" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">什么是服务器端Blazor，它与客户端Blazor有什么不同？简单的回答是客户端Blazor使用<a class="ae kl" href="https://webassembly.org/" rel="noopener ugc nofollow" target="_blank"> WebAssembly </a>和<a class="ae kl" href="https://www.mono-project.com/news/2017/08/09/hello-webassembly/" rel="noopener ugc nofollow" target="_blank"> Mono </a>来运行。使用服务器端Blazor，应用程序在服务器上执行，并通过SignalR连接请求更新/处理。</p><p id="46c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要更深入地了解这些差异，请查看<a class="ae kl" href="https://docs.microsoft.com/en-us/aspnet/core/blazor/hosting-models?view=aspnetcore-3.0" rel="noopener ugc nofollow" target="_blank">ASP.NET Core Blazor主机模型</a>文档。</p><h2 id="fd59" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">先决条件</h2><p id="5286" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">要开始，请确保安装至少的预览版6。网芯3。使用命令提示符，您可以运行以下命令来查看。NET Core SDK已安装。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="9a9b" class="km kn iq lp b gy lt lu l lv lw">dotnet --list-sdks</span></pre><p id="3a15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">的预演。网芯3可以从<a class="ae kl" href="https://dotnet.microsoft.com/download/dotnet-core/3.0" rel="noopener ugc nofollow" target="_blank">这里</a>下载。还有，一定要用<a class="ae kl" href="https://visualstudio.microsoft.com/vs/preview/" rel="noopener ugc nofollow" target="_blank"> Visual Studio 2019 </a>的最新预览版。</p><h2 id="9384" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">应用程序创建</h2><p id="9587" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">我在命令提示符下使用下面的命令创建了一个使用个人身份验证的新Blazor应用程序。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="08d9" class="km kn iq lp b gy lt lu l lv lw">dotnet new blazorserverside --auth Individual</span></pre><p id="b527" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您选择了<strong class="jp ir">ASP.NET核心Web应用</strong>项目类型，Visual Studio也有可用的模板，并且在选择<strong class="jp ir"> Blazor服务器应用</strong>选项中有大约三个屏幕。</p><p id="013c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建过程完成后，在Visual Studio中打开该项目。此时，如果您运行该应用程序，您将看到登录或注册的标准选项。</p><figure class="lk ll lm ln gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lx"><img src="../Images/c3d78fcf67ada2ac84ca9dfe62da9b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_zFAyS1V9JkqoNse.png"/></div></div></figure><h2 id="d411" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">要求对页面进行授权</h2><p id="a7a6" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">此时，应用程序允许帐户创建和登录，但是所有页面对所有用户都可用，即使他们没有登录。有多种方法可以解决这个问题。在这篇文章中，我将使用最接近我所习惯的MVC的方法，即使用Authorize属性。在Pages目录中打开then <strong class="jp ir"> FetchData.razor </strong>文件，并进行以下更改，使页面要求用户获得授权。请注意，该方法只应用于页面组件。</p><p id="82be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之前:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="9a04" class="km kn iq lp b gy lt lu l lv lw">@page "/fetchdata"<br/>@using BlazorAuth.Data<br/>@inject WeatherForecastService ForecastService</span></pre><p id="a3ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="dd45" class="km kn iq lp b gy lt lu l lv lw">@page "/fetchdata"<br/>@using BlazorAuth.Data<br/>@using Microsoft.AspNetCore.Authorization<br/>@attribute [Authorize]<br/>@inject WeatherForecastService ForecastService</span></pre><p id="8239" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您在未登录的情况下进入“获取数据”页面，您将会看到一条未授权的消息。可以使用AuthorizeView组件自定义此消息。你可以在<a class="ae kl" href="https://docs.microsoft.com/en-us/aspnet/core/security/blazor/?view=aspnetcore-3.0&amp;tabs=visual-studio#authorizeview-component" rel="noopener ugc nofollow" target="_blank">文件</a>中找到更多细节。</p><h2 id="71e9" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">包扎</h2><p id="f320" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">很高兴看到自从我上次玩Blazor以来，它已经有了很大的进步。文档很棒，产品也有了很大的改进。我可能会在后续文章中更深入地介绍如何使用AuthorizeView组件。</p><p id="3773" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请务必查看<a class="ae kl" href="https://docs.microsoft.com/en-us/aspnet/core/security/blazor/?view=aspnetcore-3.0" rel="noopener ugc nofollow" target="_blank"> Blazor认证和授权</a>上的官方文档，以了解该主题的全貌。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="4fb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mm">原载于</em> <a class="ae kl" href="https://elanderson.net/2019/08/asp-net-core-server-side-blazor-with-authentication/" rel="noopener ugc nofollow" target="_blank"> <em class="mm">埃里克·安德森</em> </a> <em class="mm">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Dynamically sized, animated carousel in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动态大小，动画旋转木马在颤动</h1>
<blockquote>原文：<a href="https://itnext.io/dynamically-sized-animated-carousel-in-flutter-8a88b005be74?source=collection_archive---------0-----------------------#2022-09-22">https://itnext.io/dynamically-sized-animated-carousel-in-flutter-8a88b005be74?source=collection_archive---------0-----------------------#2022-09-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/4d076625c6fcae85df3faf91c7c41d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*ByyiAsmJfETmLXQsUKwB2Q.gif"/></div></figure><p id="5fd6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你喜欢时尚、灵敏的设计吗？我也是！动画旋转木马是实现这一目标的好方法，但实现起来可能有些棘手。在本文中，我将向您展示如何毫不费力地做到这一点。</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="ca52" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">虽然<a class="ae kz" href="https://pub.dev/packages/carousel_slider" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> carousel_slider </strong> </a>库看起来很诱人，但它在响应迅速的动态应用程序中并不太好。因为要定义内容高度，所以用图片比用widgets更合适。</p><p id="d4ed" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这就是为什么我们必须使用<a class="ae kz" href="https://pub.dev/packages/expandable_page_view" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">expandable _ page _ view</strong></a>来显示我们的卡片，并将它们恰当地放在其他UI组件旁边。在后面的指南中，我还将实现<a class="ae kz" href="https://pub.dev/packages/flutter_bloc" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> flutter_bloc </strong> </a>来管理状态并保存我们当前挑选的卡片，以及<strong class="jw ir"/><a class="ae kz" href="https://pub.dev/packages/smooth_page_indicator" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">smooth _ page _ indicator</strong></a><strong class="jw ir"/>来指示当前页面，但这是可选的。</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="93da" class="la lb iq bd lc ld le dn lf lg lh dp li kf lj lk ll kj lm ln lo kn lp lq lr ls bi translated">目录</h2><blockquote class="lt lu lv"><p id="a928" class="ju jv lw jw b jx jy jz ka kb kc kd ke lx kg kh ki ly kk kl km lz ko kp kq kr ij bi translated"><strong class="jw ir"> 1。底座零件<br/> 2。动画<br/> 3。状态管理&amp;页面指示器<br/> 4。最终想法&amp;完成项目</strong></p></blockquote></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h1 id="5d19" class="ma lb iq bd lc mb mc md lf me mf mg li mh mi mj ll mk ml mm lo mn mo mp lr mq bi translated">1.基础零件</h1><p id="3124" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ij bi translated">首先，让我们将我们的<strong class="jw ir">页面</strong>小部件包装在一个<strong class="jw ir">sliverfillreming</strong>中。这确保了如果页面内容溢出，我们将获得一个漂亮的可滚动视图(记住将<strong class="jw ir"> hasScrollBody </strong>设置为false以获得我们想要的行为):</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="f40b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们创建一个简单的<strong class="jw ir">卡片模板</strong>放到我们的转盘中。它本质上可以是任何小部件，因此我将选择一些简单的东西来展示:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8134" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在剩下唯一要做的就是创建一个page controller<strong class="jw ir">(viewportFraction定义了我们的一张卡片占多大的屏幕宽度%) </strong>和一堆<strong class="jw ir"> </strong>卡片。<strong class="jw ir"> </strong>我现在打算静态地做这件事:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="d184" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并将它们放入我们的<strong class="jw ir">可扩展页面视图中。</strong>我在一个<strong class="jw ir">构建器</strong>工厂中使用过它，因为以后实现动画和动态缩放更方便:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="3de5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它应该会产生类似如下的结果:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ad8d40a11aa837ca69e15d5d486f48bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*p7ZUnuuGo46h0z1dwuj40Q.gif"/></div></figure><p id="e0d0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">很整洁，不是吗？但是我们可以做得更好！</p><h1 id="e58e" class="ma lb iq bd lc mb nc md lf me nd mg li mh ne mj ll mk nf mm lo mn ng mp lr mq bi translated">2.动画片</h1><p id="4ce2" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ij bi translated">为了给我们的小部件添加一些比例动画，<strong class="jw ir"> AnimatedBuilder </strong>将会派上用场。它可以把我们的PageController当做一个双动画。PageController有一个page字段，它以双倍的速度传输当前页面索引切换进度(当您在第一个小部件上时，它发出0，当您进行到一半时，它发出0.5，以此类推)。</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8d50" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">由于PageController的工作方式，在调用<code class="fe nh ni nj nk b">.page</code> getter之前，我们必须<strong class="jw ir">检查它是否有维度</strong>，否则，它将打印出一个错误并溢出一瞬间。</p><p id="ae92" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了缩放内容，我使用了一个<code class="fe nh ni nj nk b"><strong class="jw ir">Transform.scale</strong></code>小部件，并将缩放比例设置为<code class="fe nh ni nj nk b">max(0.8, (1 — (carouselController.page! — index).abs() / 2))</code>。这非常简单——当当前页面与卡片的索引匹配时，最大值为1——否则它将自己固定在0.8(或者我们希望的任何值)。我们也可以增加除数来制作更平滑的动画。这就是它现在的样子:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6fcfc9789c5f11ed4f4882853f91abf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*5LLp5cTR7Ry5_vai9BZyaA.gif"/></div></figure><h1 id="28fb" class="ma lb iq bd lc mb nc md lf me nd mg li mh ne mj ll mk nf mm lo mn ng mp lr mq bi translated">3.状态管理和页面指示器</h1><p id="8972" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ij bi translated">我会让文章的这一部分相对简短，你应该对<strong class="jw ir"> BLoC </strong>的工作原理有所了解。让我们创建我们的Cubit和State类:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="0b93" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我还希望我的CarouselCard类将它的<strong class="jw ir">索引</strong>作为参数。现在我们可以检查卡片当前是否被<strong class="jw ir">选中</strong>，并相应地更改其边框的颜色:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="46d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们必须<strong class="jw ir">用BlocProvider </strong>包装页面，并将当前页面<strong class="jw ir">索引</strong>传递给CarouselCubit。后者可以通过监听器实现:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="de03" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们正在确保页面不为空，如果存储在cubit状态中的当前卡片索引与四舍五入的页面值不匹配，它将被更新。现在我们可以创建一个<strong class="jw ir"> SmoothPageIndicator </strong>:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="42c8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们得到了这个结果:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/4d076625c6fcae85df3faf91c7c41d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*ByyiAsmJfETmLXQsUKwB2Q.gif"/></div></figure><h1 id="1416" class="ma lb iq bd lc mb nc md lf me nd mg li mh ne mj ll mk nf mm lo mn ng mp lr mq bi translated">4.最终想法和完成项目</h1><p id="f0e2" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ij bi translated">我希望你会发现这是一篇有用的文章。如果有任何不清楚的地方，请随时在我的社交网站上给我发消息或留下评论。这是一份完整的回购协议:<br/><a class="ae kz" href="https://github.com/RedC4ke/carousel_app" rel="noopener ugc nofollow" target="_blank">https://github.com/RedC4ke/carousel_app</a></p><h2 id="5617" class="la lb iq bd lc ld le dn lf lg lh dp li kf lj lk ll kj lm ln lo kn lp lq lr ls bi translated">跟随我:</h2><p id="547d" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ij bi translated"><a class="ae kz" href="https://www.linkedin.com/in/redc4ke/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/redc4ke/</a><br/>T25】https://github.com/RedC4ke</p></div></div>    
</body>
</html>
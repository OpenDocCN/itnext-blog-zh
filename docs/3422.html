<html>
<head>
<title>KeePass: an MFA TOTP codes, a browser’s passwords, SSH keys passwords storage configuration and Secret Service integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KeePass:一个MFA TOTP代码，一个浏览器的密码，SSH密钥密码存储配置和秘密服务集成</h1>
<blockquote>原文：<a href="https://itnext.io/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-a1b1efe50e13?source=collection_archive---------2-----------------------#2019-12-12">https://itnext.io/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-a1b1efe50e13?source=collection_archive---------2-----------------------#2019-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/4cfd70dba381fb1b47647204a6fcb15c.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/0*V2hkbzA5i_it5GyA.png"/></div></figure><p id="8164" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，这似乎是关于Linux中密码和SSH管理的整个系列的最后一篇文章。</p><p id="8d7e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">前面的部分是关于:</p><ul class=""><li id="d2d6" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/linux-the-nextcloud-client-qtkeychain-and-the-the-name-org-freedesktop-secrets-was-not-provided-by-any-service-files-error/" rel="noopener ugc nofollow" target="_blank">Linux:next cloud客户端，qtkeychain和“org.freedesktop.secrets”这个名字没有被任何人提供。服务文件“错误</a><br/>——我发现一个密匙环服务能够存储SSH密钥密码<br/>——并且知道Chromium以一种“不加密的方式”存储密码</li><li id="d2a9" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/linux-keepass-ssh-i-xranenie-parolej-rsa-klyuchej/" rel="noopener ugc nofollow" target="_blank"> Linux: KeePass，SSHихраненеиепаиолейrsa-ключей</a>(俄语<em class="lh">，即将翻译</em> ) <br/> —如何使用<code class="fe li lj lk ll b">ssh-agent</code>，稍微介绍一下它与KeePass的集成，以存储ssh密钥密码</li><li id="ffa4" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/" rel="noopener ugc nofollow" target="_blank">什么是:Linux keyring、gnome-keyring、Secret Service和D-Bus </a> <br/> —什么是keyring以及如何使用它<br/> —回顾一下，如何使用D-Bus <br/> —以及一些关于KeePass集成为Secret Service的内容</li><li id="83ff" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/chromium-linux-keyrings-secret-service-passwords-encryption-and-store/" rel="noopener ugc nofollow" target="_blank"> Chromium: Linux，key rings&amp;&amp;Secret Service，密码加密和存储</a><br/>——最后整理出来——Chromium以明文形式存储敏感数据是真的吗？</li></ul><p id="6e56" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">实际上，知道了所有这些，我们就可以把它们集合在一起，在一台装有Arch Linux和Openbox DE的工作笔记本电脑上配置普通的秘密管理。</p><p id="a68f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在本帖中，我们将为以下各项配置KeePassXC:</p><ul class=""><li id="e1c3" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">浏览器集成将密码存储在KeePass中，而不是Chromium自己的SQLite数据库中</li><li id="00b9" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated">MFA的TOTP码生成</li><li id="57ff" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated">将集成<code class="fe li lj lk ll b">ssh-agent</code>和KeePass来存储RSA密钥密码</li><li id="c8a3" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated">并将使特勤局集成使用KeePass作为Linux的密匙环存储</li></ul><h2 id="7272" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kf lv lw lx kj ly lz ma kn mb mc md me bi translated"><strong class="ak">内容</strong></h2><ul class=""><li id="a863" class="ks kt iq jw b jx mf kb mg kf mh kj mi kn mj kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/#KeePass_vs_KeePassXC" rel="noopener ugc nofollow" target="_blank"> KeePass vs KeePassXC </a></li><li id="c6b6" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/#KeePass_and_a_browsers_passwords_KeePassXC-Browser" rel="noopener ugc nofollow" target="_blank"> KeePass和浏览器的密码— KeePassXC-Browser </a></li><li id="76a7" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/#KeePassXC_MFA_TOTP_generator" rel="noopener ugc nofollow" target="_blank"> KeePassXC MFA TOTP发电机</a></li><li id="5761" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/#KeePass_and_ssh-agent_for_SSH_keys_passwords" rel="noopener ugc nofollow" target="_blank"> KeePass和ssh-agent获取ssh密钥密码</a></li><li id="f4f1" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/#sign_and_send_pubkey_signing_failed_agent_refused_operation" rel="noopener ugc nofollow" target="_blank"> sign_and_send_pubkey:签名失败:代理拒绝操作</a></li><li id="e0ef" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/#KeePass_and_Secret_Service_integration" rel="noopener ugc nofollow" target="_blank"> KeePass和特勤局整合</a></li></ul><h1 id="fd4a" class="mk ln iq bd lo ml mm mn lr mo mp mq lu mr ms mt lx mu mv mw ma mx my mz md na bi translated">KeePass vs KeePassXC</h1><p id="b554" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ij bi translated">我用KeePassXC代替KeePass。</p><p id="a45c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">事实上，从一开始，我就改用KeePassXC，只是因为默认情况下，它在装有Openbox的Linux中看起来要好得多。</p><p id="4cb5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">KeePass:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ne"><img src="../Images/3597bcc7768e7a5530ba055317d3f9e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CP0nX8ls2zMafvGz.png"/></div></div></figure><p id="368d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">KeePassXC:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nn"><img src="../Images/31062f453056ff9d640ae2c22e405db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2IfFmImVPZS-I8yF.png"/></div></div></figure><p id="c74b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，KeePass是用微软的C#编写的，在Linux下需要<code class="fe li lj lk ll b"><a class="ae lb" href="https://www.mono-project.com/docs/about-mono/supported-platforms/linux/" rel="noopener ugc nofollow" target="_blank">mono</a></code>才能工作，而KeePassXC是用C++编写的(见其<a class="ae lb" href="https://github.com/keepassxreboot/keepassxc" rel="noopener ugc nofollow" target="_blank">库</a>)，可以在任何平台上轻松工作——Linux/BSD/MAC OS/Windows。</p><p id="779f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看<a class="ae lb" href="https://www.reddit.com/r/KeePass/comments/8wll8p/keepass_vs_keepassxc/" rel="noopener ugc nofollow" target="_blank"> Reddit </a>上的帖子了解更多详情。</p><p id="c54d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">作为一个浏览器，我将使用基于Chromium的Brave，这样在配置上就没有区别了。</p><h2 id="de91" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kf lv lw lx kj ly lz ma kn mb mc md me bi translated">KeePass和浏览器的密码— KeePassXC-Browser</h2><p id="568b" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ij bi translated">首先，有一个很好的问题——你真的想改变你的浏览器的密码存储吗？</p><p id="2a20" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">也就是说，你有Chromium，它有自己的SQLite数据库，密码以加密的方式存储在那里。</p><p id="f9d4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，Chromium在网页上创建凭证字段没有问题，但KeePass有时会出现这种情况。</p><p id="3844" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另一方面，当使用KeePass时——你所有的密码(和SSH密钥等)总是在你身边，在同一个地方。易于备份/恢复、在计算机之间移动/共享、添加到另一个浏览器等等。</p><p id="b599" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，每个人都会自己决定，但是让我们来写KeePass和Chromium的集成过程。</p><p id="f8d6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">进入<em class="lh">工具&gt;设置</em>，然后进入<em class="lh">浏览器集成</em>，启用:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/1aaebb10dba2f9877d8c7fe807059ec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/0*2VMnnd8n4Nf5ggca.png"/></div></figure><p id="e7a9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">找到<strong class="jw ir"> KeePassXC-Browser </strong>插件，安装:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi np"><img src="../Images/d555f6fd43f90ffd8ed217ab9bd2a768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8mtprjK-Ymesv2di.png"/></div></div></figure><p id="d484" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">转到<em class="lh">设置</em>:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/bd4cb55ce9678c623f2e61bd07bc5ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/0*n_bsbM9l6z4LBOjK.png"/></div></figure><ul class=""><li id="2d8f" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><em class="lh">保存新密码的默认组</em> —通常，我会禁用默认的KeePassXC-Browser密码，并启用该选项，以便总是询问我想在哪里保存新密码，因为在我的数据库中，所有内容都被分组</li><li id="4ddf" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><em class="lh">激活2FA/OTP字段图标</em> —如果主动使用MFA可以启用，但是值得这么做吗？参见下面的<a class="ae lb" href="https://rtfm.co.ua/?p=22933#KeePass_MFA_TOTP_generator" rel="noopener ugc nofollow" target="_blank"> <em class="lh"> KeePass MFA TOTP发生器</em> </a> <em class="lh"/></li><li id="86bb" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated"><em class="lh">自动重新连接到KeePassXC </em> —始终保持与数据库的连接很舒服，还没有发现任何滞后/错误</li><li id="067e" class="ks kt iq jw b jx lc kb ld kf le kj lf kn lg kr kx ky kz la bi translated">自动填写HTTP基本认证对话框并提交它们——看起来很有用，但是我不能让它工作——总是显示一个HTTP表单窗口</li></ul><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nr"><img src="../Images/acc4a3c4afe52d5f0a028d407d789f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZLPk74q-0PgNq9bk.png"/></div></div></figure><p id="3f6e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">回到插件，点击<em class="lh">连接</em>:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9481520f98011ed9b4b8c08fff26e494.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/0*2yc09HbZ-ou-9iZe.png"/></div></figure><p id="bec3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">设置连接名称:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/1808dd3fa82567d4e0d3ff2344faabf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/0*mfE2n_F3W8V5CZq5.png"/></div></figure><p id="c7d8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查KeePass关于连接的浏览器:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nu"><img src="../Images/d8a90ce5078c0fa1f84c322b94d34cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y7kSHH62oArNCtMa.png"/></div></div></figure><p id="e7af" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成了——图标现在是绿色的:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/d93f344d4afd79c85c056bd53dd0cb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/0*mKSP8rXOllNKC-L1.png"/></div></figure><p id="1232" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在某处登录，KeePass会提示保存密码:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a50e022936f4e0ae769e2e90888f7a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/0*gTxMGTCCx3QEvxIo.png"/></div></figure><p id="8143" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存它(<em class="lh"> New </em>)，再次登录——我们的凭证现在就在这里:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nx"><img src="../Images/0543bffd72356553f349d88c7a83cc0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MALwUrXSA48M5II_.png"/></div></div></figure><h2 id="d2bf" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kf lv lw lx kj ly lz ma kn mb mc md me bi translated">KeePassXC MFA TOTP发电机</h2><p id="cbb4" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ij bi translated">还有一件有趣的事情KeePassXC中的TOTP码生成器。</p><p id="e340" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然而，有一个严肃的问题:启用它是一个好的解决方案吗？</p><p id="dd51" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">MFA认证背后的主要思想正是使用两个独立的服务来认证你，即一方的<em class="lh">登录:密码</em>，另一方的<strong class="jw ir">和</strong>来自你的MFA的TOTP码。</p><p id="f0b6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">是否值得将它们一起保存在同一个KeePass数据库中——绝对是关于你的，但请记住，如果有人将访问你的KeePass——那么你将没有机会将MFA作为保护你数据安全的最后希望。</p><p id="4ce7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">尽管如此，这样的选项是存在的，我使用的是MFA，所以让我们看看如何配置它。</p><p id="29c8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在MFA配置期间—根据服务选择类似“<em class="lh">显示密钥</em>或“<em class="lh">无法扫描QR </em>”的内容，以查看文本代码而非QR代码。</p><p id="1172" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以下是AWS控制台的一个示例:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ny"><img src="../Images/23da2cd13e26e8a31716e4fab17be72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*znqUPw7a2KjdnHnk.png"/></div></div></figure><p id="168a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存代码，然后在KeePassXC中找到或更新您想要配置MFA的条目，右键单击它— <em class="lh"> TOTP &gt;设置TOTP </em>:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nz"><img src="../Images/86ef67430b570335404cc3048bfb128a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RQrnRCpiy-G40CPp.png"/></div></div></figure><p id="0e3a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并从AWS设置<em class="lh">密钥</em>:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nz"><img src="../Images/62330195fc956f735696bc0602f06a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lhdvfjN680OLESQd.png"/></div></div></figure><p id="6852" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存，再次点击右键— <em class="lh">显示TOTP </em>:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi oa"><img src="../Images/43e15c9fe0c3f514fae98d991cd01f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cuqri-wwZF6aHm1z.png"/></div></div></figure><p id="f029" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并在AWS中完成MFA配置:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ob"><img src="../Images/466f88cf8d0de66ec036ba1ede68d795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*GyiRIPfioo6Sp6jF.png"/></div></div></figure><p id="b34b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">尝试登录，但是…填充TOTP字段的按钮不起作用:-(</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c833c23e7905f98614609b2fe65e3dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*RoOntV69DC5UMmOF.png"/></div></figure><p id="f8e9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它在Chromium的Gmail上也不能用。</p><p id="d2cc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好了KeePass中的代码已经生成，所以只需通过右键单击或使用<em class="lh"> Ctrl+T </em>手动复制它——我们就完成了。</p><h2 id="4e57" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kf lv lw lx kj ly lz ma kn mb mc md me bi translated">SSH密钥密码的KeePass和<code class="fe li lj lk ll b">ssh-agent</code></h2><p id="e8bf" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ij bi translated">这里的想法是将SSH密钥密码存储在KeePass中，并通过<code class="fe li lj lk ll b">ssh-agent</code>访问它们，而不需要询问SSH密钥密码。</p><p id="f695" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在<a class="ae lb" href="https://rtfm.co.ua/linux-keepass-ssh-i-xranenie-parolej-rsa-klyuchej/" rel="noopener ugc nofollow" target="_blank"> Linux: KeePass，sshихранениепаиолеййrsa-ключей</a>的帖子中已经有了更详细的描述，但是目前只有俄语版本(将在未来几天翻译)。</p><p id="3f3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查<code class="fe li lj lk ll b">ssh-agent</code>是否正在运行:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="0a35" class="lm ln iq ll b gy oh oi l oj ok">$ ps aux | grep ssh-agent<br/>setevoy 1505 0.0 0.0 5796 456 ? Ss Dec10 0:00 ssh-agent</span></pre><p id="8591" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果没有—启动它:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="9e03" class="lm ln iq ll b gy oh oi l oj ok">$ eval $(ssh-agent)<br/>Agent pid 950428</span></pre><p id="144a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查<code class="fe li lj lk ll b">$SSH_AUTH_SOCK</code>变量是否可用，因为它将指向一个用于与代理通信的套接字:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="d9e4" class="lm ln iq ll b gy oh oi l oj ok">$ env | grep SSH<br/>SSH_AUTH_SOCK=SSH_AUTH_SOCK=/run/user/1000/ssh-agent.socket<br/>SSH_AGENT_PID=950428</span></pre><p id="20de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">进入KeePass <em class="lh">工具&gt;设置</em>，启用<em class="lh"> SSH代理</em>:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/371ce395ecb0ba2137c42cda1d5de6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/0*o3znKmdSZUgKk3fL.png"/></div></figure><p id="ac56" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重新启动KeePass并添加新密钥。</p><p id="4432" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">生成它，设置密码:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="0e21" class="lm ln iq ll b gy oh oi l oj ok">$ ssh-keygen -f /home/setevoy/rtfm-do-prod-setevoy<br/>Generating public/private rsa key pair.<br/>Enter passphrase (empty for no passphrase):<br/>Enter same passphrase again:<br/>Your identification has been saved in /home/setevoy/rtfm-do-prod-setevoy.<br/>Your public key has been saved in /home/setevoy/rtfm-do-prod-setevoy.pub.<br/>…</span></pre><p id="69a3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">注意这里是用于设置密钥文件的<code class="fe li lj lk ll b">-f</code>,它不在<code class="fe li lj lk ll b">.ssh</code>目录中，以便更简单地添加到KeePass中。</p><p id="f999" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查文件:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="9a45" class="lm ln iq ll b gy oh oi l oj ok">$ ll /home/setevoy/rtfm-do-prod-setevoy*<br/>-rw — — — — 1 setevoy setevoy 2655 Dec 11 10:53 /home/setevoy/rtfm-do-prod-setevoy<br/>-rw-r — r — 1 setevoy setevoy 579 Dec 11 10:53 /home/setevoy/rtfm-do-prod-setevoy.pub</span></pre><p id="139c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">返回KeePass，创建一个新条目，设置任意名称，并在<em class="lh">密码</em>字段中设置您的密钥密码:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a9f47ba4ac1ca8376549688951aa5a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/0*SJtmgmmW4J0My6mI.png"/></div></figure><p id="3442" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在<em class="lh"> SSH代理中，</em>可以添加一个key作为<em class="lh">附件</em>，或者作为<em class="lh">外部文件</em>。</p><p id="8395" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我建议使用<em class="lh">附件</em>，因为在这种情况下，密钥将直接存储在数据库中，您不需要将它复制到您的工作/家庭/etc笔记本电脑上。</p><p id="4ae8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在同一个窗口中切换到<em class="lh">高级</em>，并附上关键文件标签:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi on"><img src="../Images/af4dd093f90d8467a1f5421004d48951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wpzcZj5oOKejmsJ9.png"/></div></div></figure><p id="0013" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">转到<em class="lh"> SSH代理</em>，从<em class="lh">附件</em>添加密钥:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi oo"><img src="../Images/97719d5271278495ec522ca9d0a67a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k9HOXy6vUbIimEnC.png"/></div></div></figure><p id="0e6d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里，请注意<em class="lh">数据库打开/解锁时将密钥添加到代理</em>选项——仅针对经常使用的密钥启用该选项，并且最好使它们少于5个，因为当ssh-agent尝试连接到主机时——它将尝试使用在<code class="fe li lj lk ll b">ssh-agent</code>中可访问的每个密钥，并且远程主机上的ssh服务器可以关闭连接以“防止暴力破解”。</p><p id="3f3c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，试着连接到一个主机:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="9b5a" class="lm ln iq ll b gy oh oi l oj ok">$ ssh setevoy@rtfm.co.ua<br/>Linux rtfm-do-production 4.9.0–8-amd64 #1 SMP Debian 4.9.144–3.1 (2019–02–19) x86_64<br/>…<br/>setevoy@rtfm-do-production:~$</span></pre><p id="e2af" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好的——它起作用了。</p><p id="78f0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请记住，使用这种方法<code class="fe li lj lk ll b">ssh-agent</code>必须在KeePass之前启动，并且必须以这样的方式导出其<code class="fe li lj lk ll b">$SSH_AUTH_SOCK</code>变量，以便KeePass可以看到它。检查<a class="ae lb" href="https://rtfm.co.ua/en/ssh-rsa-keys-and-ssh-agent-for-ssh-keys-and-their-passwords-management/#Running_ssh-agent_with_multitype_terminals" rel="noopener ugc nofollow" target="_blank">中的选项，使用多种类型的终端运行ssh-agent】。</a></p><p id="f2ec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我使用带有<code class="fe li lj lk ll b">systemd</code>服务的变体，套接字路径将通过<code class="fe li lj lk ll b">~/.config/openbox/environment</code>文件导出(因为我使用的是Openbox DE)。</p><p id="e615" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我的单位-档案<code class="fe li lj lk ll b">/home/setevoy/.config/systemd/user/ssh-agent.service</code>:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="c213" class="lm ln iq ll b gy oh oi l oj ok">[Unit]<br/>Description=SSH key agent<br/><br/>[Service]<br/>Type=simple<br/>Environment=SSH_AUTH_SOCK=%t/ssh-agent.socket<br/>ExecStart=/usr/bin/ssh-agent -D -a $SSH_AUTH_SOCK<br/><br/>[Install]<br/>WantedBy=default.target</span></pre><p id="dd25" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和环境文件— <code class="fe li lj lk ll b">~/.config/openbox/environment</code>:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="9462" class="lm ln iq ll b gy oh oi l oj ok">export QT_QPA_PLATFORMTHEME="qt5ct"<br/>export SSH_AUTH_SOCK="${XDG_RUNTIME_DIR}/ssh-agent.socket"</span></pre><p id="52d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后一步只是为了稍微舒服一点——为与<code class="fe li lj lk ll b">~/.ssh/config</code>的连接添加一个“短名称”:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="f67d" class="lm ln iq ll b gy oh oi l oj ok">Host rtfm<br/> Hostname rtfm.co.ua<br/> User setevoy</span></pre><p id="405e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们根本没有添加<code class="fe li lj lk ll b">IdentityFile</code>-<code class="fe li lj lk ll b">ssh-client</code>将询问<code class="fe li lj lk ll b">ssh-agent</code>可用的密钥来尝试登录，所以我们没有被绑定到磁盘上的密钥文件。</p><p id="ad50" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用以下简称立即连接:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="09ac" class="lm ln iq ll b gy oh oi l oj ok">$ ssh rtfm<br/>…<br/>setevoy@rtfm-do-production:~$</span></pre><p id="8d3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">既没有询问用户密码，也没有询问密钥密码——一切都如预期的那样正常工作。</p><h2 id="d96e" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kf lv lw lx kj ly lz ma kn mb mc md me bi translated">sign_and_send_pubkey:签名失败:代理拒绝操作</h2><p id="9bb0" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ij bi translated">简短说明:如果您现在启用“<em class="lh">使用此键时需要用户确认</em>”选项:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/ab9815051499b2a8b553205d8bc552aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/0*BNRm7LDpkbXUiCFL.png"/></div></figure><p id="0975" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后在SSH登录过程中，有时会看到“<em class="lh"> sign_and_send_pubkey:签名失败:代理拒绝操作</em>”错误:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="8d2f" class="lm ln iq ll b gy oh oi l oj ok">$ ssh rtfm<br/>sign_and_send_pubkey: signing failed: agent refused operation<br/>Load key “/home/setevoy/.ssh/id_rsa”: Is a directory<br/>setevoy@rtfm.co.ua’s password:</span></pre><p id="27c1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">发生这种情况是因为<code class="fe li lj lk ll b">ssh-agent</code>试图要求用户确认，并使用了系统中无法安装的<code class="fe li lj lk ll b">ssh-askpass</code>实用程序:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="2352" class="lm ln iq ll b gy oh oi l oj ok">$ file /usr/lib/ssh/ssh-askpass<br/>/usr/lib/ssh/ssh-askpass: cannot open `/usr/lib/ssh/ssh-askpass’ (No such file or directory)</span></pre><p id="d6eb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装<code class="fe li lj lk ll b">x11-ssh-askpass</code>包:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="7ccf" class="lm ln iq ll b gy oh oi l oj ok">$ sudo pacman -S x11-ssh-askpass</span></pre><p id="ddda" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重新尝试登录—现在您必须看到这样一个带有确认请求的窗口:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/9346141fc536e2495776043ce951c0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/0*5tTniSONtmxM2jtb.png"/></div></figure><p id="d6f5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">点击<em class="lh">ок</em>——现在一切正常。</p><h2 id="a54b" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kf lv lw lx kj ly lz ma kn mb mc md me bi translated">KeePass和特勤局整合</h2><p id="db43" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ij bi translated">为了更好地理解一般情况下的密匙环和特殊情况下的特勤局——我强烈建议你首先阅读<a class="ae lb" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/" rel="noopener ugc nofollow" target="_blank">什么是:Linux密匙环、gnome-密匙环、特勤局和D-Bus </a>帖子。</p><p id="c8fa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，让我们确保我们的系统中没有可用的秘密服务——检查D-Bus:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="236a" class="lm ln iq ll b gy oh oi l oj ok">$ qdbus — session org.freedesktop.DBus / org.freedesktop.DBus.GetConnectionUnixProcessID org.freedesktop.secrets<br/>Error: org.freedesktop.DBus.Error.NameHasNoOwner<br/>Could not get PID of name ‘org.freedesktop.secrets’: no such name</span></pre><p id="ede2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，是空的。</p><p id="8c6b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">进入KeePass，<em class="lh">工具&gt;设置</em>，选择<em class="lh">特勤整合</em>，启用它:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/1b381b513ef09aa6e366873650e6ad3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/0*0U9UEDhs5UwhA9r9.png"/></div></figure><p id="5610" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，转到KeePass数据库的设置，并在它的<em class="lh">特勤局集成</em>设置中指定一个集合(团队，文件夹)，该集合将用于存储我们的秘密:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/f0ce3018d4fe562724a70b39007071b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/0*ftml39Y3VfAZdJ9T.png"/></div></figure><p id="99ef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，现在最好在系统中的每个其他应用程序之前启动KeePass。</p><p id="f9b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我的例子中，这可以通过<code class="fe li lj lk ll b">~/.config/openbox/autostart</code>文件来完成:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="5f98" class="lm ln iq ll b gy oh oi l oj ok">xrandr --output HDMI-1 --primary<br/>xrandr --output eDP-1 --right-of DP-1<br/><br/>feh --bg-scale /home/setevoy/Pictures/Wallpaper/seryy-kapli-strela-ten-arch.jpg &amp;<br/><br/>tint2 -c /home/setevoy/.config/tint2/setevoy-tint2-90-pecent-bottom-wrk.tint2rc &amp;<br/>polybar -c /home/setevoy/.config/polybar/setevoy-polybar-wrk-bars.conf bottom &amp;<br/>polybar -c /home/setevoy/.config/polybar/setevoy-polybar-wrk-bars.conf top &amp;<br/>sleep 5<br/><br/>keepassxc &amp;<br/>dropbox &amp;<br/>lxqt-notificationd &amp;<br/>xscreensaver &amp;<br/>qxkb &amp;<br/><br/>skypeforlinux &amp;<br/>sleep 5<br/>slack &amp;<br/>...</span></pre><p id="c032" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行浏览器:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="91e4" class="lm ln iq ll b gy oh oi l oj ok">$ chromium — password-store=gnome</span></pre><p id="f452" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并在KeePass' <em class="lh">工具&gt;设置</em>中查看现在正在使用Secret Service的服务:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi on"><img src="../Images/a823ba99bff84b85b52d7272a3f4750d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NrPEiDrE2LznTEzc.png"/></div></div></figure><p id="3da5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当Chromium试图访问其密码来解密其SQLite数据库中的一些密码时，KeePass会发出通知:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/4572db1582ca290932c7cb94978a81a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/0*K6zZnIuFY6lJ7pti.png"/></div></figure><p id="2243" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但这里有另一个问题:当我通过<code class="fe li lj lk ll b"><a class="ae lb" href="https://rtfm.co.ua/arch-posleustanovochnye-nastrojki/#Openbox_XOrg" rel="noopener ugc nofollow" target="_blank">gmrun</a></code>启动Chromium时——它是通过<code class="fe li lj lk ll b">--password-store=basic</code>而不是<code class="fe li lj lk ll b">--password-store=gnome</code>启动的，尽管它必须检查一个秘密服务是否可用，并运行“gnome”而不是“基本”存储。</p><p id="e5b8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要解决这个问题，请阅读<a class="ae lb" href="https://wiki.archlinux.org/index.php/Chromium/Tips_and_tricks#Making_flags_persistent" rel="noopener ugc nofollow" target="_blank"> Arch Wiki </a>并创建一个<code class="fe li lj lk ll b">~/.config/chromium-flags.conf</code>文件:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="45df" class="lm ln iq ll b gy oh oi l oj ok">--password-store=gnome</span></pre><p id="4834" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重启浏览器，进入chrome://version/，勾选选项:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ot"><img src="../Images/cdf6761cc52853fe7099c225a32e4b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lq1L9PC-T-y4Gc0T.png"/></div></div></figure><p id="43f3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，它对Chromium有效——但是Brave仍然使用“<em class="lh"> basic </em>”选项。</p><p id="eaee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于Arch Linux中的Brave浏览器，你可以创建一个<code class="fe li lj lk ll b">~/.config/brave-flags.conf</code>文件，如<a class="ae lb" href="https://github.com/brave/brave-browser/issues/2300#issuecomment-504907440" rel="noopener ugc nofollow" target="_blank">中提到的&gt; &gt; &gt; </a>注释，所以我们可以只复制现有的一个:</p><pre class="nf ng nh ni gt od ll oe of aw og bi"><span id="208a" class="lm ln iq ll b gy oh oi l oj ok">$ cp .config/chromium-flags.conf .config/brave-flags.conf</span></pre><p id="586f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重新启动Brave，检查其选项:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ou"><img src="../Images/23290fbc66ba3e2417f965d1a1475022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0DrWei-66VPUUDPL.png"/></div></div></figure><p id="8e60" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">而且在KeePass的特勤里出现了<em class="lh">勇者</em>的记录，所以现在用的是特勤:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ov"><img src="../Images/3fa83ca00c01279b546cd52c4bee0a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CKiYtfdx_lvHmIQ_.png"/></div></div></figure><p id="a450" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成了。</p></div><div class="ab cl ow ox hu oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="ij ik il im in"><p id="8101" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lh">最初发布于</em> <a class="ae lb" href="https://rtfm.co.ua/en/keepass-an-mfa-totp-codes-a-browsers-passwords-ssh-keys-passwords-storage-configuration-and-secret-service-integration/" rel="noopener ugc nofollow" target="_blank"> <em class="lh"> RTFM: Linux、DevOps和系统管理</em> </a> <em class="lh">。</em></p></div></div>    
</body>
</html>
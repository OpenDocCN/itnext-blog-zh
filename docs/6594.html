<html>
<head>
<title>Chrome Extension Development with Nx Workspace &amp; Angular v13 — Part 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Nx Workspace和Angular v13开发Chrome扩展—第5部分</h1>
<blockquote>原文：<a href="https://itnext.io/chrome-extension-development-with-nx-workspace-angular-v13-part-5-7245829ea87c?source=collection_archive---------2-----------------------#2021-12-28">https://itnext.io/chrome-extension-development-with-nx-workspace-angular-v13-part-5-7245829ea87c?source=collection_archive---------2-----------------------#2021-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/750c531cfc106aa8edd0c981e6d9cfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*942qvtSjvJ-3b9bj.png"/></div></div></figure><p id="1077" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我试图为个人使用创建一个简单的Chrome扩展。然后指出这可以使用HTML、CSS &amp; JavaScript来完成。</p><p id="e70f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/chrome-extension-development-with-nx-workspace-angular-v13-48cf3d2c2a41"> <strong class="kd iu">第1部分:入门</strong> </a> <strong class="kd iu"> <br/> </strong> <a class="ae kz" href="https://medium.com/@dalenguyen/chrome-extension-development-with-nx-workspace-angular-v13-f9163e545c8f" rel="noopener"> <strong class="kd iu">第2部分:更改背景颜色</strong></a><strong class="kd iu"><br/></strong><a class="ae kz" href="https://medium.com/@dalenguyen/chrome-extension-development-with-nx-workspace-angular-v13-part-3-f824c0baf75f" rel="noopener"><strong class="kd iu">第3部分:添加上下文菜单</strong></a><strong class="kd iu"><br/></strong><a class="ae kz" href="https://medium.com/@dalenguyen/chrome-extension-development-with-nx-workspace-angular-v13-part-4-948fcc51e0f8" rel="noopener"><strong class="kd iu">第4部分:发送HTTP请求</strong></a><strong class="kd iu"><br/></strong><a class="ae kz" href="https://dalenguyen.medium.com/chrome-extension-development-with-nx-workspace-angular-v13-part-5-7245829ea87c" rel="noopener"><strong class="kd iu">第5部分:添加内容脚本</strong> </a></p><p id="1af9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://github.com/dalenguyen/dalenguyen.github.io/tree/dev/apps/ext-utils" rel="noopener ugc nofollow" target="_blank"> Github示例</a></p><p id="3c37" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我将展示如何添加<a class="ae kz" href="https://developer.chrome.com/docs/extensions/mv3/content_scripts/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">内容脚本</strong> </a>。</p><blockquote class="la lb lc"><p id="e964" class="kb kc ld kd b ke kf kg kh ki kj kk kl le kn ko kp lf kr ks kt lg kv kw kx ky im bi translated">内容脚本是在网页环境中运行的文件。通过使用标准的<a class="ae kz" href="https://www.w3.org/TR/DOM-Level-2-HTML/" rel="noopener ugc nofollow" target="_blank">文档对象模型</a> (DOM)，它们能够读取浏览器访问的网页的细节，对它们进行修改，并将信息传递给它们的父扩展。</p></blockquote><p id="80ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">简单地说，这是一个脚本，我们可以嵌入和操纵任何网站的内容。例如，我可以添加一个内容脚本，将站点的样式更改为黑暗模式。</p><p id="e4ff" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">添加内容脚本文件</strong></p><p id="71e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe lh li lj lk b">src</code>文件夹下创建一个文件名<code class="fe lh li lj lk b">content-script.ts</code></p><pre class="ll lm ln lo gt lp lk lq lr aw ls bi"><span id="648e" class="lt lu it lk b gy lv lw l lx ly">// src/content-script.ts</span><span id="d08b" class="lt lu it lk b gy lz lw l lx ly">console.log('content script is running...')</span><span id="0ddb" class="lt lu it lk b gy lz lw l lx ly">// Turn on dark mode<br/>// This is a simple example. It may not work in all cases<br/>document.body.style.background = '#000'<br/>document.body.style.color = '#fff'</span></pre><p id="0725" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">向所有网站添加内容脚本</strong></p><p id="2e3b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该文件必须在<code class="fe lh li lj lk b">manifest.json</code>中声明。脚本可以静态地声明<a class="ae kz" href="https://developer.chrome.com/docs/extensions/mv3/content_scripts/#functionality" rel="noopener ugc nofollow" target="_blank">或者编程地注入</a>。在这个例子中，我将静态地将它添加到所有站点。</p><pre class="ll lm ln lo gt lp lk lq lr aw ls bi"><span id="0067" class="lt lu it lk b gy lv lw l lx ly">// manifest.json</span><span id="4546" class="lt lu it lk b gy lz lw l lx ly">"content_scripts": [<br/>    {<br/>      "matches": ["&lt;all_urls&gt;"], // matches all URLs<br/>     <strong class="lk iu"> "js": ["content-script.js"],</strong><br/>      "all_frames": true<br/>    }<br/> ]</span></pre><p id="2969" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">更新Webpack配置</strong></p><p id="21e5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了让扩展识别新脚本，您需要在ts config . app . JSON &amp; custom-web pack . config . js中声明它</p><pre class="ll lm ln lo gt lp lk lq lr aw ls bi"><span id="b4d8" class="lt lu it lk b gy lv lw l lx ly">// custom-webpack.config.js</span><span id="b8d6" class="lt lu it lk b gy lz lw l lx ly">background: 'apps/ext-utils/src/background.ts',<br/>'content-script': 'apps/ext-utils/src/content-script.ts',</span></pre><p id="e109" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将内容脚本添加到TSConfig</p><pre class="ll lm ln lo gt lp lk lq lr aw ls bi"><span id="4cc6" class="lt lu it lk b gy lv lw l lx ly">// tsconfig.app.json</span><span id="f115" class="lt lu it lk b gy lz lw l lx ly">"files": [<br/>  "src/main.ts", <br/>  "src/polyfills.ts", <br/>  "src/background.ts", <br/><strong class="lk iu">  "src/content-script.ts"<br/></strong>],</span></pre><p id="076a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">构建&amp;刷新扩展</strong></p><p id="15d9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">每次更新扩展时，您都需要构建它并刷新扩展才能看到变化。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/f89081ba145c60c749daa89e3084ffe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*eoK0wQ1SKCbf1pxOzydD5A.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">刷新扩展</figcaption></figure><p id="21af" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">之后，你可以从<code class="fe lh li lj lk b">content-script.ts</code>看到控制台日志，网站的背景颜色变成了黑色。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mf"><img src="../Images/b9c8fbccd6e67e0ebb0d5841b46eee80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lqm4oprvbnLaobRH2SrrsA.png"/></div></div></figure><p id="9bc9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://twitter.com/dale_nguyen" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">在Twitter上关注我</strong> </a>了解Angular、JavaScript &amp; WebDevelopment的最新内容👐</p></div></div>    
</body>
</html>
<html>
<head>
<title>Getting Started Building Component Libraries with Angular CLI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始使用Angular CLI构建组件库</h1>
<blockquote>原文：<a href="https://itnext.io/angular-cli-libraries-79b0a32a1443?source=collection_archive---------2-----------------------#2018-06-03">https://itnext.io/angular-cli-libraries-79b0a32a1443?source=collection_archive---------2-----------------------#2018-06-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c2a917ef2b8a80e896fc9526b8f6ce03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQ9QA3Sy1kX7XdmZmFwlYg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/photos/JuFcQxgCXwA?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">塞缪尔·泽勒</a>在<a class="ae kc" href="https://unsplash.com/search/photos/package?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="03a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Angular生态系统中，进入门槛一直较高的事情之一是创建其他Angular应用程序可以使用的组件库。Angular团队发布了类似于<a class="ae kc" href="https://docs.google.com/document/d/1CZC2rcpxffTDfRDs6p1cfbmKNLA6x5O-NtkJglDaBVs/edit" rel="noopener ugc nofollow" target="_blank"> Angular Package Format </a>的指南，并由此社区创建了一些奇妙的工具，如<a class="ae kc" href="https://github.com/jvandemo/generator-angular2-library" rel="noopener ugc nofollow" target="_blank">generator-Angular 2-library</a>，使之变得更容易。然而，从来没有一种工具可以像在正常项目工作流程中使用Angular CLI的开发人员所习惯的那样，生成Angular包格式的自以为是的实现。</p><p id="ad80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着Angular CLI版本6的最新发布，我们现在可以访问一些工具来帮助我们构建库，同时还可以利用CLI的其他强大功能，例如schematics，而无需离开我们习惯的工作流！我将向您展示如何通过CLI开始构建您自己的组件库。</p><p id="558b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将涵盖:</p><ul class=""><li id="382b" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">使用Angular CLI生成库项目</li><li id="59b2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">为您的库构建组件</li><li id="6fb0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">在其他应用程序中使用您的库</li><li id="d8b8" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">发布您的库供他人使用</li></ul></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="4d69" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">使用Angular CLI生成库项目</h1><p id="d8d7" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">最重要的是。我们需要建立我们的项目。如果您没有最新版本的CLI，请从npm获取。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0fcb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在用CLI创建一个新项目。这里没什么新鲜的。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0669" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您习惯于使用Angular CLI，您可能会注意到您所熟悉和喜爱的项目结构发生了一些变化。其中最引人注目的是旧的<code class="fe nf ng nh ni b">angular-cli.json</code>文件不见了，取而代之的是新的<code class="fe nf ng nh ni b">angular.json</code>文件。</p><p id="26b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个文件是版本6中最大的新特性之一的关键。现在，Angular CLI可以创建和使用包含一个或多个多角度项目的工作空间。这个<code class="fe nf ng nh ni b">angular.json</code>文件让您可以控制每个项目的配置。这最终使得在CLI中构建库成为可能，因为我们需要以不同于普通Angular应用程序的方式处理库的构建。</p><p id="a4bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了——现在我们对CLI对象中的库是如何工作的有了更多的了解；让我们在项目中生成库结构。我们用<code class="fe nf ng nh ni b">generate</code>命令来做这件事，就像我们创建一个组件、服务、模块等一样...</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cc23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将为您的库和一些示例文件创建一个新的<code class="fe nf ng nh ni b">/projects</code>目录和一个新文件夹。</p><p id="691f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里真正需要注意的文件是<code class="fe nf ng nh ni b">/src/public_api.ts</code>、<code class="fe nf ng nh ni b">ng-package.json</code>和<code class="fe nf ng nh ni b">ng-package.prod.json</code>。这些文件控制着<a class="ae kc" href="https://github.com/dherges/ng-packagr" rel="noopener ugc nofollow" target="_blank">ng-packar</a>的配置，ng-packar是驱动库打包的库。我鼓励你去看看这个项目，熟悉一下它是如何工作的，但这里有一个快速而粗略的概述:</p><ul class=""><li id="860b" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><code class="fe nf ng nh ni b">public_api.ts</code>是您图书馆的新入口。如果你有任何你想让库的用户访问的文件(模块，组件，等等...)除了从库中的任何模块导出它们之外，您还需要在这里导出它们。</li></ul><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="cf33" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><code class="fe nf ng nh ni b">ng-package.json</code>和<code class="fe nf ng nh ni b">ng-package.prod.json</code>控制ng-packar执行的包装过程的配置。您可以使用它们来更改目标构建目录或为您的应用程序定义不同的入口点。<code class="fe nf ng nh ni b">ng-package.json</code>在您执行<code class="fe nf ng nh ni b">ng build</code>命令时使用，<code class="fe nf ng nh ni b">ng-package.prod.json</code>在您运行<code class="fe nf ng nh ni b">ng build --prod</code>时使用。现在这两个文件之间唯一的区别是<code class="fe nf ng nh ni b">ng-package.json</code>包含一个<code class="fe nf ng nh ni b">deleteDestPath</code>标志，它将在运行构建之前删除您的目标目录。这将有助于您在开发过程中不断进行更改。</li></ul><blockquote class="nj nk nl"><p id="6c6d" class="kd ke nm kf b kg kh ki kj kk kl km kn nn kp kq kr no kt ku kv np kx ky kz la ij bi translated"><strong class="kf ir"> <em class="iq"> Protip </em> </strong> <em class="iq">:如果你的库需要捆绑一个整体的Sass文件，你需要在你的工作流中包含类似</em><a class="ae kc" href="https://github.com/SimplrJS/scss-bundle" rel="noopener ugc nofollow" target="_blank"><em class="iq">scss-bundle</em></a><em class="iq">的东西。</em> <a class="ae kc" href="https://github.com/dherges/ng-packagr/issues/273#issuecomment-345059670" rel="noopener ugc nofollow" target="_blank"> <em class="iq">更多信息请看这里</em> </a></p></blockquote><h1 id="f5cc" class="lw lx iq bd ly lz nq mb mc md nr mf mg mh ns mj mk ml nt mn mo mp nu mr ms mt bi translated">为您的库构建组件</h1><p id="b9f1" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">现在我们有了库设置的总体结构。是时候开始建设了！</p><p id="dd30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先将<a class="ae kc" href="https://material.angular.io/" rel="noopener ugc nofollow" target="_blank">角形材料</a>添加到我们的项目中。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="90e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">"等等，为什么我们把材料添加到我的应用程序，而不是我的新图书馆？"好问题。这个问题的简单答案是，在这种情况下，材料是我们库的对等依赖。我们不希望每次在某个地方安装我们的库时都要下载它——这会导致在构建应用程序时出现巨大的最终包。相反，我们希望规定无论哪个项目使用我们的库，都需要安装材料。对于将由第三方(提示，提示:我们的)安装和使用的库，您需要向对等依赖关系中添加材料之类的东西。在这里有一个关于什么时候使用对等和普通依赖<a class="ae kc" href="https://stackoverflow.com/questions/26737819/why-use-peer-dependencies-in-npm-for-plugins" rel="noopener ugc nofollow" target="_blank">的很好的讨论。</a></p><p id="9c42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，材料的<code class="fe nf ng nh ni b">ng add</code>命令仅适用于标准项目配置，即由<code class="fe nf ng nh ni b">ng new</code>命令生成的项目配置。如果你运行<code class="fe nf ng nh ni b">ng add @angular/material --project my-new-lib</code>，你会得到一个这样说的错误。正在后台运行以添加材料的原理图假设您正在将其添加到现有的Angular应用程序，而不是库，因此它不会理解，因为<code class="fe nf ng nh ni b">angular.json</code>内部的结构是为您的库设置的。</p><p id="d043" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在继续添加到我们的对等依赖项中。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7dcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们为我们的图书馆设置模块。首先，删除在<code class="fe nf ng nh ni b">src/lib</code>和<code class="fe nf ng nh ni b">public_api.ts</code>中由CLI生成的示例文件。然后生成模块。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="ad34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们希望其他人使用这个模块，所以我们需要将它添加到<code class="fe nf ng nh ni b">public_api.ts</code>。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="048a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这个例子，库将有一个由按钮和徽章组成的组件。每次点击按钮时，徽章都会更新并显示总点击次数。为了增加复杂性，组件还应该发出一个事件，让任何父组件知道计数已经改变以及当前计数是多少。</p><p id="7c60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先生成组件。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4cd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从我们的库中导出刚刚创建的组件。当你在这里的时候也导入<code class="fe nf ng nh ni b">MatBadgeModule</code>和<code class="fe nf ng nh ni b">MatButtonModule</code>。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4a47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也将组件添加到<code class="fe nf ng nh ni b">public_api.ts</code></p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="41fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，向组件添加逻辑，以处理每当单击按钮时显示的计数递增。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="38fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将组件连接到模板。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b26b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们有了一个希望其他应用程序使用的组件！但是我们如何确保它有效呢？我们接下来会处理这个问题。</p><h1 id="acba" class="lw lx iq bd ly lz nq mb mc md nr mf mg mh ns mj mk ml nt mn mo mp nu mr ms mt bi translated">在其他应用程序中使用您的库</h1><p id="572b" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">好吧，我们有一个很棒的库可以使用——但是我们实际上如何使用它呢？有几种不同的方法。</p><p id="5c4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先是在我们刚开始工作时由CLI生成的应用程序中使用它。请记住，Angular CLI不再只是生成一个应用程序；相反，它会生成CLI团队所称的工作区。这意味着您可以在同一目录中构建多个应用程序和库，并利用您在同一工作区的其他项目中构建的内容。</p><p id="3204" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开工作区根目录下的<code class="fe nf ng nh ni b">tsconfig.json</code>。您将看到一个指向<code class="fe nf ng nh ni b">dist/my-new-library</code>目录的<code class="fe nf ng nh ni b">paths</code>选项。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="36b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样做的目的是让您在构建完库后，在同一工作区的其他应用程序中自动使用库。这类似于使用npm安装的库，因为您可以导入组件并在库中使用。这当然意味着在构建应用之前，你<em class="nm">必须</em>构建你的应用所依赖的任何库<strong class="kf ir">，并且每次你对库进行更改时都需要重新构建库，这些更改才会得到反映。</strong></p><p id="2c34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个示例工作流可以这样工作:</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1c08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在继续构建我们的库，然后我们将构建一个示例，展示如何使用我们工作区中生成的原始应用程序来使用它。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8f27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将生成前面提到的<code class="fe nf ng nh ni b">dist/</code>目录。如果您打开该目录，您会看到ng-packar已经生成了FESM2015、FESM5和UMD的库包以供使用，并生成了一个类型文件。</p><p id="bbdf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以在应用程序中使用这个库了！</p><p id="5758" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe nf ng nh ni b">src/app/app.module.ts</code>中导入<code class="fe nf ng nh ni b">MyLibModule</code></p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cb66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想证明应用程序正在从库组件接收<code class="fe nf ng nh ni b">countChanged</code>事件，所以在<code class="fe nf ng nh ni b">src/app/app.component.ts</code>中实现<code class="fe nf ng nh ni b">handleCountChanged()</code>。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f698" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在将<code class="fe nf ng nh ni b">CounterButtonComponent</code>添加到<code class="fe nf ng nh ni b">src/app/app.component.html</code>中。还要添加一个div，显示从组件发出的值。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="ba8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看我们的示例应用程序的运行情况！记得在服务应用程序之前建立您的库。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="77f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开浏览器，您将看到您的组件在运行！</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/3f0c48a27f09e3b9b16676c79126d692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Yyz98r860LWKq7oqqVTt-w.gif"/></div></div></figure><p id="a6c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像这样使用库是在同一个工作空间中的多个Angular应用程序之间共享代码的一种很好的方式。此外，如果您正在构建类似组件库的东西，您可以使用最初生成的Angular应用程序为您的库构建出色的工作示例。</p><h1 id="5e23" class="lw lx iq bd ly lz nq mb mc md nr mf mg mh ns mj mk ml nt mn mo mp nu mr ms mt bi translated">发布您的库供他人使用</h1><p id="ca10" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">因此，您已经构建了一个非常棒的组件库，并且正在您自己的应用程序中使用它，但是如果您想要共享它以便其他人可以在他们的应用程序中使用它，该怎么办呢？</p><p id="d4fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，如果你之前没有在npm上发表过任何东西，那就去注册吧。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="fbac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">登录npm帐户后，再次构建库。这次使用<code class="fe nf ng nh ni b">--prod</code>标志，这样Angular CLI将执行一些额外的优化步骤。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7218" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在进入<code class="fe nf ng nh ni b">dist/my-new-library</code>。如果你想测试你的包是否能在其他应用中运行，你可以把它链接到你的本地npm注册表。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="587c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在创建一个新的角度工作空间，并将库链接到项目。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f032" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在新的工作空间中，将<code class="fe nf ng nh ni b">projects/test-lib-app/architect/build</code>下<code class="fe nf ng nh ni b">options</code>对象中的<code class="fe nf ng nh ni b">preserveSymLinks</code>添加到<code class="fe nf ng nh ni b">angular.json</code>。这允许当应用被提供时，你的库的链接继续工作。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0316" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像我们之前一样使用这个库，你会发现它在这里也可以工作！要删除链接库，您可以在测试项目中使用一个<code class="fe nf ng nh ni b">npm remove my-new-library</code>命令，在您构建的库的目录中使用<code class="fe nf ng nh ni b">npm unlink</code>命令。</p><p id="08a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您准备将您的应用程序发布到npm以供他人使用，请在您的<code class="fe nf ng nh ni b">dist/my-new-library</code>目录中运行下面的命令。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="28f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从那里，您可以像使用任何其他使用<code class="fe nf ng nh ni b">npm install</code>的包一样使用它。</p><h1 id="966e" class="lw lx iq bd ly lz nq mb mc md nr mf mg mh ns mj mk ml nt mn mo mp nu mr ms mt bi translated">后续步骤</h1><p id="e636" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">恭喜你！您已经用Angular构建了自己的组件库，并将其发布给npm供其他人使用。向前迈进，建立酷库共享！对于接下来的步骤，我也强烈建议您深入研究<a class="ae kc" href="https://github.com/dherges/ng-packagr/issues?q=label%3Adocumentation%20" rel="noopener ugc nofollow" target="_blank">ng-packar</a>的文档，以了解更多关于库打包过程的高级主题。</p><p id="cdd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在Github <a class="ae kc" href="https://github.com/bniedermeyer/component-libraries-with-angular-cli" rel="noopener ugc nofollow" target="_blank">这里</a>找到例子中使用的代码。</p></div></div>    
</body>
</html>
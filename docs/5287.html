<html>
<head>
<title>Npm security and license compliance best practices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Npm安全性和许可证合规性最佳实践</h1>
<blockquote>原文：<a href="https://itnext.io/npm-security-and-license-compliance-best-practices-3ec15e9f2878?source=collection_archive---------4-----------------------#2021-02-02">https://itnext.io/npm-security-and-license-compliance-best-practices-3ec15e9f2878?source=collection_archive---------4-----------------------#2021-02-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b368" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">Javascript安全性</h2><div class=""/><div class=""><h2 id="65c2" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">Javascript陷阱以及如何避免它们</h2></div><h2 id="f8a6" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">使用这10个最佳实践，更好、更安全地构建它</h2><p id="d422" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">在这篇文章中，我们将看看我和我的团队在构建JavaScript生态圈时相信的一些最佳实践，无论你是在一个快速发展的初创企业还是一个更大的组织。我们将看看如何最好地避免我们的十大潜在陷阱，这样你就可以充满信心地建立在他人的成功之上！</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/c10f5dbb5e3302593e36ad7bc3357370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mXuBcXvCxzlFw2ES"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">Johannes Plenio 在<a class="ae ms" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="cdbb" class="mt kp iq bd kq mu mv mw kt mx my mz kw kf na kg la ki nb kj le kl nc km li nd bi translated">漏洞、许可证、依赖性…</h1><p id="7f55" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">如今，依赖性管理以及安全性和许可证合规性都是任何团队或组织需要优先考虑的问题。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ne"><img src="../Images/515ed1802d6da7cb6254fc6be1c4b96b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C8Lmk6EUicJUpSjc"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated"><a class="ae ms" href="https://unsplash.com/@weareprocreator?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">制作者UX设计工作室</a>在<a class="ae ms" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><blockquote class="nf"><p id="bb8e" class="ng nh iq bd ni nj nk nl nm nn no mb dk translated">公共npm注册表中有近150万个可用的包，现代应用程序中高达90%的代码是由他人开发的开源代码。</p></blockquote></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="d45b" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">那么，除了我们喜欢有机会挑选我们需要的东西、安装它并继续前进之外，这实际上告诉了我们什么呢？</p><p id="d878" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">下面我们编制了一份<strong class="ll ja">清单</strong>，列出了我们认为的最佳实践。再往下是关于10大最佳实践的更多信息。</p><h1 id="1c9d" class="mt kp iq bd kq mu mv mw kt mx my mz kw kf na kg la ki nb kj le kl nc km li nd bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="d7ef" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">有许多方法可以保护您的代码供应链。我们在<a class="ae ms" href="https://bytesafe.dev/" rel="noopener ugc nofollow" target="_blank">bytes safe</a>编辑了一份PDF，其中包含了我们认为所有开发者和公司都应该考虑的10大安全最佳实践。因此，如果您很急或者想要一份关于10个npm安全最佳实践的单页报告，那么<em class="ob"> </em> <a class="ae ms" href="https://bytesafe.dev/posts/npm-security-best-practices/" rel="noopener ugc nofollow" target="_blank">这份<em class="ob"> </em>快速指南</a>就是为您准备的。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><a href="https://bytesafe.dev/posts/npm-security-best-practices/"><div class="gh gi oc"><img src="../Images/1c6e3bbc9b52dcd38ca217b41b8319d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*-Kpdl8A4vdQilxWM_PLZpA.png"/></div></a><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">点击下载打印机友好版本(文章中的PDF)</figcaption></figure><h1 id="6595" class="mt kp iq bd kq mu mv mw kt mx my mz kw kf na kg la ki nb kj le kl nc km li nd bi translated">10项国家预防机制最佳做法</h1><h2 id="5458" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">1.使用私有注册表获得额外的安全性</h2><p id="5319" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">使用像Bytesafe这样的私有注册中心，可以为您的所有包添加一个中心，您可以在这里添加控制和规则。</p><p id="dbfd" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">团队成员可以下载和安装任何包，而不是依赖于公共注册表，您可以通过管理您的私有注册表来增加额外的安全性，查看所有包的依赖关系，允许缓存包，最重要的是:扫描安全性和许可证问题。</p><h2 id="7f21" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">2.扫描包中的安全问题</h2><p id="3fff" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">npm团队与整个社区一起为提高安全性付出了巨大努力，但新的恶意软件包不断被检测到并添加到咨询数据库中。</p><p id="407b" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">大多数情况下，在检测到有安全问题的包并从您的应用程序中移除依赖关系之前，需要一段时间。因此，持续扫描安全问题非常重要，以便尽快通知您。</p><p id="d8bc" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">不要仅仅依赖安装期间的触发扫描(如<code class="fe od oe of og b">npm audit</code>)。</p><h2 id="bb01" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">3.利用您的开源许可证保持领先</h2><p id="4f08" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">使用带有错误许可证的软件包可能会导致灾难性的后果。许可信息可以存储在包的任何文件中，而不仅仅是<code class="fe od oe of og b">package.json</code>，所以不要把许可看作是事后的想法！</p><ul class=""><li id="42bf" class="oh oi iq ll b lm nw lp nx kx oj lb ok lf ol mb om on oo op bi translated">使用Bytesafe等工具识别所有文件中的许可证信息</li><li id="5eac" class="oh oi iq ll b lm oq lp or kx os lb ot lf ou mb om on oo op bi translated">限制有问题或未经许可的软件包</li><li id="9009" class="oh oi iq ll b lm oq lp or kx os lb ot lf ou mb om on oo op bi translated">扫描所有软件包文件中有问题的许可证。发现许可问题时获得通知</li></ul><h2 id="0756" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">4.启用依赖性防火墙来阻止包</h2><p id="b062" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">太好了，现在你可以使用一个私有注册表来扫描你的包的安全和许可问题了！</p><p id="59b2" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">这时，您应该启用规则(策略)来阻止“坏包”，这意味着它们甚至不会出现在您的注册表中。确保您启用强制软件包必须被扫描、安全且不包含要添加到您的私有注册表的限制性许可证的策略是一个良好的开端。</p><p id="279d" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">更多关于如何使用<a class="ae ms" href="https://docs.bytesafe.dev/policies/" rel="noopener ugc nofollow" target="_blank">策略阻止软件包</a>的信息。</p><h2 id="361d" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">5.将责任转移到团队，而不是个人</h2><p id="0820" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">即使当你使用私有注册表时，当你添加新的包到一个项目中时，你也应该有意识地进行修改。</p><p id="ab3d" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">您使用的软件包越多，其中一个软件包包含安全漏洞的风险就越大。因此，最佳实践是在添加新的依赖项时，手边有更多的眼睛，并有正确的工具来做出明智的决策。</p><p id="11e7" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">像Bytesafe这样为所有用户缓存和可视化依赖关系的工具，可以用来使这些信息大众化，并使其对所有团队成员可用。</p><h2 id="d337" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">6.安装软件包时，避免默认情况下运行脚本</h2><p id="ba8e" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">您知道执行脚本是安装过程的一部分吗？非常方便和有用，但不幸的是这个功能也被黑客用来执行随机脚本。因此，执行安装后脚本是一个很大的风险，除非你已经检查过了。</p><p id="fdad" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">除非你有信心并且知道执行了什么，否则你应该安装带有<code class="fe od oe of og b">--ignore-scripts</code>标志的软件。</p><pre class="md me mf mg gt ov og ow ox aw oy bi"><span id="11cd" class="ko kp iq og b gy oz pa l pb pc">npm install PACKAGE@VERSION --ignore-scripts</span></pre><h2 id="4128" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">7.注意域名抢注的风险</h2><p id="9d99" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">哪个套餐是官方的——<em class="ob">twilio-NPM</em>还是<em class="ob"> twilio </em>？域名仿冒攻击，这意味着攻击者创建与官方名称相似的包。目的是让开发者下载恶意软件包。</p><p id="0d54" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">确保你仔细检查你安装的东西，最好使用管理的私有注册表。</p><p id="1bb5" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">(BTW，twilio是官方的包名)</p><h2 id="2e67" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">8.保护您的令牌和凭据的安全</h2><p id="15b9" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">如果您要将包发布到公共存储库，集中令牌管理是一个好主意。存储维护者令牌并用Bytesafe发布。避免将令牌分发给所有开发人员的风险和麻烦。</p><p id="ec70" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">避免敏感凭据的意外泄露。尽管npm增加了检测秘密的功能，但还是要养成更新忽略文件的习惯(例如npmignore，。gitignore等)。</p><h2 id="4cc8" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">9.让您的不同环境使用完全相同的软件包版本</h2><p id="2c84" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">对于任何开发团队来说，在不同的环境中获得一致和确定的结果都是一个持续的问题。根据您的设置和状态，如果您的项目文件完全同步，您可能会测试其他版本的包，而不是预期的版本。</p><p id="1e61" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">听起来像是一个很容易解决的问题，但事实上，你的团队需要非常熟练(包锁、纱锁收缩包装等)才能实现100%确定的结果。使用<code class="fe od oe of og b">npm ci</code> (npm全新安装)有助于复制<code class="fe od oe of og b">node_modules</code>的特定状态，但不涵盖传递依赖(依赖的依赖)。</p><p id="7169" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">有更简单的解决方案吗？对于需要完全确定性结果的团队，bytesafe提供了冻结策略❄️.冻结策略使得整个注册表为只读，从而允许完全一致的结果。</p><p id="b2d5" class="pw-post-body-paragraph lj lk iq ll b lm nw ka lo lp nx kd lr kx ny lt lu lb nz lw lx lf oa lz ma mb ij bi translated">您可以准确地拍摄所使用的版本的快照，并在任何环境下使用该快照。由于所有依赖项都被冻结，这也包括完全复制的传递性依赖项。</p><h2 id="5317" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">10.确保整个团队都使用私有注册表</h2><p id="b8c5" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">哇，你把上面的都勾上了！现在你只需要让每个人都使用你的私有注册表，在那里你可以信任你的依赖。通过这种方式，您可以控制团队或公司中使用的npm包的流程。</p><pre class="md me mf mg gt ov og ow ox aw oy bi"><span id="0922" class="ko kp iq og b gy oz pa l pb pc">npm config set registry 'https://example.bytesafe.dev/r/default/'</span></pre></div></div>    
</body>
</html>
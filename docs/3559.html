<html>
<head>
<title>How to Control Access to your JavaScript Objects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何控制对JavaScript对象的访问</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-control-access-to-your-javascript-objects-1a75435c04e3?source=collection_archive---------6-----------------------#2020-01-08">https://itnext.io/how-to-control-access-to-your-javascript-objects-1a75435c04e3?source=collection_archive---------6-----------------------#2020-01-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6232" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">和其他让你的朋友惊讶的聚会技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8cd0b686c7cfe048d24a0fbc83979341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CvgLJWMLy_f_8JGT"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">本·怀特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="aff2" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="1d6c" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">JavaScript对象只是属性的动态集合<em class="mo">。我们可以根据需要添加和删除属性。俗话说，权力越大，责任越大。这句话在这里并不适用，但我认为它让这段介绍更具戏剧性。😃</em></p><p id="a758" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">随着随意添加和删除属性的能力，我们失去的东西之一是对授予每个属性的访问级别的控制。如果您来自另一种语言，这种语言允许您使用关键字<strong class="lx iu"> <em class="mo"> private </em> </strong>来限制对变量的访问，这可能看起来很奇怪，并且很容易引入意想不到的错误。</p><p id="d249" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在这篇文章中，我们将看看如何让JavaScript表现得更像那些提供全面隐私的语言。</p><h2 id="ee47" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">你为什么要在乎？</h2><p id="6b56" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">很棒的问题！坦率地说，也许你不知道，但是我猜如果你在Medium上阅读这篇关于JavaScript对象访问控制的文章，你会关心的。欺负你！</p><p id="7618" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">然而，如果你只是在喝了几杯啤酒后在网上闲逛，碰巧在搜索特朗普头发的最新照片时来到这里，这里有几个你可能会关心的原因:</p><ol class=""><li id="f1a6" class="mu mv it lx b ly mp mb mq li mw lm mx lq my mn mz na nb nc bi translated">你是一个有责任心的程序员，你想确保当一个变量被设置为一个新值时，它是你所期望的值。你不希望Elvis对象被传递到你期望的布尔值。(尽管猫王的物品更酷)</li><li id="fddd" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">您希望记录与某个变量相关的所有交互，或者跟踪它被访问或更新的次数。</li></ol><p id="3892" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">既然我们已经建立了一些想要做这类事情的真正原因，让我们来看看一些代码。</p><p id="8b29" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">首先，让我们看看问题在行动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">这没什么隐私可言！</figcaption></figure><p id="a6cb" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在这个代码片段中，我们使用object literal语法创建一个简单的对象，并保存到一个名为trump的变量中。</p><p id="bffe" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在对象内部，我们有一个名为_taxReturns的"<em class="mo"> private" </em>变量和两个方法，一个用于获取值，一个用于设置值。很简单。</p><p id="32dd" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">接下来，我们把这个小东西拿出来旋转一下，我们马上就可以在控制台上看到问题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/e776e6f28f3f5aa788b7374ade8974db.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*qYxLsecJs-ZGXwSwXqNFkQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">特朗普的大问题！</figcaption></figure><p id="f5de" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在第11行，console.log(_taxReturns)向我们显示了我们希望成为私有变量的值。那真是太糟糕了！</p><p id="0314" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">那么，我们如何着手纠正这种情况呢？让我们来看几个选项。</p><h2 id="6e1f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用构造函数</h2><p id="d844" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">如果你读过我的另一篇名为<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/4-ways-to-call-a-function-in-javascript-19b174678f5a">用JavaScript </a>调用函数的4种方法的文章，你就会知道我们有一个选择就是使用构造函数。</p><div class="nl nm gp gr nn no"><a rel="noopener  ugc nofollow" target="_blank" href="/4-ways-to-call-a-function-in-javascript-19b174678f5a"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">用JavaScript调用函数的4种方法</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">JavaScript中的函数可以用不同的方式调用。乍一看，这似乎是一个疯狂的声明。怎么能…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">itnext.io</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ks no"/></div></div></a></div><p id="8d69" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">用<strong class="lx iu"> <em class="mo"> new </em> </strong>关键字调用构造函数会给我们一个新的实例，通过闭包的魔力，我们会有自己的私有变量。让我们看看那是什么样子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">一个潜在的解决方案</figcaption></figure><p id="3664" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在控制台中查看输出显示，我们已经成功地限制了对_taxReturns变量的直接访问，因为它现在显示为未定义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/24b9d2577999de50e2283bae89268665.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*Zme72VXaYgz9FYvukRdKyQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">大获成功！</figcaption></figure><p id="db7d" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">同样，这是通过使用闭合来实现的。如果你不确定这是什么意思，看看这篇文章。</p><div class="nl nm gp gr nn no"><a href="https://levelup.gitconnected.com/using-closures-in-javascript-to-create-private-variables-c0b358757fe0" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">在JavaScript中使用闭包来创建私有变量</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">如何利用JavaScript的一个核心特性</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nx l"><div class="oe l nz oa ob nx oc ks no"/></div></div></a></div><p id="26ad" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">现在，我们只允许通过我们漂亮的get和set函数访问_taxReturns变量，我们可以限制传递什么值，并在调用这些方法时记录我们想要的任何内容，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">检查数值并记录日志，天啊！</figcaption></figure><p id="d5e8" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">这段代码在控制台中生成以下内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/967a35730c7ce166ac57ae4641e94ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*xYmZwHCGMQPW3rhITUNqVQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">看起来一切都在按计划进行！</figcaption></figure><p id="24dd" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">看起来我们已经完成了来这里要做的事情。对我们的_taxReturns变量的访问是受限制的，我们像mofo一样验证数据和记录日志。</p><p id="bb87" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">米勒时间到了！</p><p id="8794" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">当你伸手去办公室冰箱里拿冷饮时，你的经理/同事/妻子气喘吁吁地闯进了你的办公室。过了一会儿，他们说他们听说JavaScript有一个内置的方法来创建getters和setters。更重要的是，您应该删除您的自定义setReturns()和getReturns()方法，并像真正的(男人/女人/在此输入性别)一样使用本机语言功能。</p><p id="8a5c" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">你表现得很冷静，回到你的键盘上，你的思维在飞速运转。会不会是？内置功能？这太疯狂了。</p><p id="e2ea" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">几分钟的谷歌搜索，你就有答案了。</p><h2 id="65aa" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">对象.定义属性</h2><p id="3687" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们要看的最后一个选项是<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" rel="noopener ugc nofollow" target="_blank"> Object.defineProperty </a>。在前面的代码示例中，我们定义了自己获取和设置值的方法。虽然这种方法没有错，但重要的是要知道这种语言确实提供了这种特性，它让我们能够对对象的属性进行粒度控制。</p><p id="e649" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">首先，让我们使用Object.defineProperty重新定义我们的对象，并尝试一下。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="7018" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">你可以在上面看到，在我们的构造函数中，我们定义了私有变量，并在第4行使用Object.defineProperty创建了一个名为taxReturns的属性。记住，在构造函数的上下文中，<strong class="lx iu"> <em class="mo">这个</em> </strong>指向新创建的对象，我们在第4行把它传递到这里来定义属性。我们还传递另外两个参数。让我们也来看看这些。</p><p id="8292" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">Object.defineProperty有3个参数。</p><ol class=""><li id="749e" class="mu mv it lx b ly mp mb mq li mw lm mx lq my mn mz na nb nc bi translated">在其上定义属性的对象</li><li id="e64d" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">要定义或修改的属性的名称</li><li id="a04c" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">一个名为<em class="mo">属性描述符对象</em>的对象文字，为这个属性设置规则</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/010ead7ce4142234084bb58c0ba9fe67.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*Fsy-80khzv6xVBB3aRX4BA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用Object.defineProperty输出</figcaption></figure><p id="fd33" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在属性描述符对象中，我们可以设置如下内容:</p><ol class=""><li id="d8bf" class="mu mv it lx b ly mp mb mq li mw lm mx lq my mn mz na nb nc bi translated">价值</li><li id="2a1f" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">属性是否可写</li><li id="53ef" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">在中使用Object.keys或for…时，属性是否可枚举</li><li id="d06c" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">属性是否可配置</li></ol><p id="e151" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">Object.defineProperties不要求您传递其中的任何一个，如果您不传递，它将使用默认值。查看文档，了解选项的完整概要。</p><div class="nl nm gp gr nn no"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">Object.defineProperty()</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">静态方法Object.defineProperty()直接在对象上定义新的属性，或者修改现有的…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">developer.mozilla.org</p></div></div><div class="nx l"><div class="oh l nz oa ob nx oc ks no"/></div></div></a></div><h2 id="be17" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="e6d3" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">这就结束了我们控制JavaScript对象访问的旋风之旅。在考虑JavaScript中的属性访问时，请记住以下几点:</p><ol class=""><li id="8b81" class="mu mv it lx b ly mp mb mq li mw lm mx lq my mn mz na nb nc bi translated">JavaScript对象只是一个可以随时修改的动态属性集合。</li><li id="d90c" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">闭包是你的朋友，它将帮助你使用JavaScript实现很多事情——其中之一就是对象的私有属性。花时间好好学习和理解闭包。</li><li id="7c56" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">您可以创建自己的方法，作为对象的getters和setters。</li><li id="1a96" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">您可以利用内置语言特性Object.defineProperty向对象添加属性。它还使您能够微调对象的每个属性。</li></ol><p id="2421" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">一如既往的感谢阅读！请查看我的其他帖子，并在<a class="ae ky" href="https://twitter.com/aritzcovan" rel="noopener ugc nofollow" target="_blank"> T <em class="mo"> witter上查看我！</em>T9】</a></p><div class="nl nm gp gr nn no"><a href="https://medium.com/@aritzcovan" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">亚历克斯·里茨科万-中等</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">阅读Alex Ritzcovan在媒体上的文章。前CTO、IT总监、软件开发人员、健身爱好者和…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">medium.com</p></div></div><div class="nx l"><div class="oi l nz oa ob nx oc ks no"/></div></div></a></div></div></div>    
</body>
</html>
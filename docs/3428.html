<html>
<head>
<title>Laravel and Vue: Creating a Portfolio website with a CRUD admin panel — Chapter Ten</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第十章</h1>
<blockquote>原文：<a href="https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-ten-a669461c51ad?source=collection_archive---------1-----------------------#2019-12-13">https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-ten-a669461c51ad?source=collection_archive---------1-----------------------#2019-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="98bf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">投资组合更新的后端验证()</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/356b75485e089e5f82dbde357b976794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XzsKh5MKXEbbJx8X"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">约翰·萨尔维诺在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="c295" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经完成了更新功能的前端验证，现在我们将重点放在后端验证上。我们还重构了store()和update()函数。这是更新函数的代码:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7acb" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>update(Request $request, $id) {<br/>    $file = $request-&gt;itempic;<br/>    $hashName = $file-&gt;hashName();<br/>    $this-&gt;resizeAndStore($file, $hashName);<br/>    $item = PortfolioItem::<em class="mg">find</em>($id);<br/>    $this-&gt;storeDetails($hashName, $item);<br/>}</span></pre><p id="9b2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在将通过使用FormRequest以及<code class="fe mh mi mj lw b"><strong class="lb iu">hasFile</strong></code>和<code class="fe mh mi mj lw b"><strong class="lb iu">filled</strong></code>函数对此进行改进。</p><p id="a910" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们必须通过在每一行前面加上两个<code class="fe mh mi mj lw b"><strong class="lb iu">/</strong></code>来注释掉这些行。<strong class="lb iu">我们不移除线条。我们只是把它们注释掉。</strong></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8112" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/><em class="mg">//        $file = $request-&gt;itempic;<br/>//        $hashName = $file-&gt;hashName();<br/>//        $this-&gt;resizeAndStore($file, $hashName);<br/>//        $item = PortfolioItem::find($id);<br/>//        $this-&gt;storeDetails($hashName, $item);<br/></em><br/>    }</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="4cd9" class="mr mb it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">表单请求—更新PortfolioItemRequest</h1><p id="89d0" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们需要的是创建一个表单请求</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6820" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">php artisan make:request UpdatePortfolioItemRequest</strong></span></pre><p id="a1e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将authorize设置为true</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9514" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>authorize()<br/>{<br/>    <em class="mg">return true</em>;<br/>}</span></pre><p id="ec16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更改更新函数，使其接受UpdatePortfolioItemRequest</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d4a3" class="ma mb it lw b gy mc md l me mf">p̶u̶b̶l̶i̶c̶ ̶f̶u̶n̶c̶t̶i̶o̶n̶ ̶u̶p̶d̶a̶t̶e̶(̶R̶e̶q̶u̶e̶s̶t̶ ̶$̶r̶e̶q̶u̶e̶s̶t̶,̶ ̶$̶i̶d̶)̶<br/><em class="mg">public function </em>update(<strong class="lw iu">UpdatePortfolioItemRequest</strong> $request, $id)</span></pre><p id="1738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们考虑一下在<strong class="lb iu">更新表单请求</strong>中可以使用哪些<strong class="lb iu">规则</strong>💭</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><h2 id="c618" class="ma mb it bd ms np nq dn mw nr ns dp na li nt nu nc lm nv nw ne lq nx ny ng nz bi translated">UpdatePortfolioItemRequest —我们可以使用哪些规则？</h2><p id="1ed3" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果我们看一下我们为创建功能(StorePortfolioItemRequest)制作的FormRequest(在第八章),我们会发现这段代码:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e393" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>rules()<br/>{<br/>    <em class="mg">return </em>[<br/>        'itempic' =&gt; 'required',<br/>        'name' =&gt; 'required|unique:portfolio_items',<br/>    ];<br/>}</span></pre><p id="2c5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们<strong class="lb iu">不能</strong>对更新表单请求使用相同的代码。</p><ol class=""><li id="3565" class="oa ob it lb b lc ld lf lg li oc lm od lq oe lu of og oh oi bi translated">我们<strong class="lb iu">不能拥有所需的itempic</strong>，因为用户可能不想更新itempic，因此可能不会提交新的item pic。为此，我们可以使用控制器中的<code class="fe mh mi mj lw b"><strong class="lb iu">$request-&gt;hasFile()</strong></code> <strong class="lb iu"> </strong>。</li></ol><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4fc5" class="ma mb it lw b gy mc md l me mf"><em class="mg">// UpdatePortfolioItemRequest's rules()<br/>public function </em>rules()<br/>{<br/>    <em class="mg">return </em>[<br/>        <strong class="lw iu">'̶i̶t̶e̶m̶p̶i̶c̶'̶ ̶=̶&gt;̶ ̶'̶r̶e̶q̶u̶i̶r̶e̶d̶'̶,̶</strong><br/>        'name' =&gt; 'required|unique:portfolio_items',<br/>    ];<br/>}</span><span id="38bd" class="ma mb it lw b gy oj md l me mf">// PortfolioController's update()<br/><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/><em class="mg">//        $file = $request-&gt;itempic;<br/>//        $hashName = $file-&gt;hashName();<br/>//        $this-&gt;resizeAndStore($file, $hashName);<br/>//        $item = PortfolioItem::find($id);<br/>//        $this-&gt;storeDetails($hashName, $item);<br/>        </em><strong class="lw iu"><em class="mg">if </em>($request-&gt;hasFile('itempic')) {</strong></span><span id="a828" class="ma mb it lw b gy oj md l me mf"><strong class="lw iu">        }</strong><br/>    }</span></pre><p id="a570" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">存储文件的<strong class="lb iu">注释掉的代码行</strong>可以移动到＄request-&gt;has file块中，并且<strong class="lb iu">取消注释</strong></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5179" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/><em class="mg">//        $item = PortfolioItem::find($id);<br/>//        $this-&gt;storeDetails($hashName, $item);<br/>        if </em>($request-&gt;hasFile('itempic')) {<br/>            <strong class="lw iu">$file = $request-&gt;itempic;<br/>            $hashName = $file-&gt;hashName();<br/>            $this-&gt;resizeAndStore($file, $hashName);</strong><br/>        }<br/>    }</span></pre><p id="74cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.再次查看表单Request，我们确实想要名称 <code class="fe mh mi mj lw b"><strong class="lb iu">required</strong></code>,因为我们不想提交一个空的名称字段——一个项目必须有一个名称。</p><p id="1d6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.我们确实希望名字是<code class="fe mh mi mj lw b"><strong class="lb iu">unique</strong></code> <strong class="lb iu">。</strong></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a317" class="ma mb it lw b gy mc md l me mf"><em class="mg">// UpdatePortfolioItemRequest's rules()<br/>public function </em>rules()<br/>{<br/>    <em class="mg">return </em>[<br/>        'name' =&gt; 'required|unique:portfolio_items',<br/>    ];<br/>}</span></pre><p id="27cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">问题</strong>:如果你更新和你用了同一个名字，你会得到错误:</p><blockquote class="ok"><p id="edee" class="ol om it bd on oo op oq or os ot lu dk translated">这个名字已经有人用了。</p></blockquote><p id="6eb6" class="pw-post-body-paragraph kz la it lb b lc ou ju le lf ov jx lh li ow lk ll lm ox lo lp lq oy ls lt lu im bi translated">这是因为<code class="fe mh mi mj lw b"><strong class="lb iu">unique</strong></code>规则检查数据库表的每一行，并将其与表单输入进行匹配。现在，因为您插入的数据已经存在，所以会出现一个错误。</p><p id="e166" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解决方案</strong>:你要说出唯一规则，避开当前项目的行。</p><p id="5c9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须小心语法</p><p id="7ee1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mh mi mj lw b">'name' =&gt; 'required|unique:portfolio_items,name'.$id</code> ❎</p><p id="6e7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mh mi mj lw b">'name' =&gt; 'required|unique:portfolio_items,name<strong class="lb iu">,</strong>'.$id</code> ✅</p><p id="9fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">区别是逗号</strong></p><p id="a8a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在结尾<code class="fe mh mi mj lw b"><strong class="lb iu">'</strong></code>之前必须有一个逗号</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="25b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mh mi mj lw b"><strong class="lb iu">$id</strong></code>可以取自<code class="fe mh mi mj lw b"><strong class="lb iu">request()</strong></code></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ca65" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>rules()<br/>{<br/>    <strong class="lw iu">$id = request()-&gt;id;</strong><br/>    <em class="mg">return </em>[<br/>        'name' =&gt; 'required|unique:portfolio_items,name,'.<strong class="lw iu">$id</strong><br/>    ];<br/>}</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ba3d" class="mr mb it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">hasFile和<code class="fe mh mi mj lw b">filled</code></h1><p id="1727" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">除了<code class="fe mh mi mj lw b"><strong class="lb iu">hasFile('itempic')</strong></code> <strong class="lb iu">，</strong>我们还需要检查描述是否填写。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7a42" class="ma mb it lw b gy mc md l me mf">// PortfolioController's update()<br/><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/><em class="mg">//        $item = PortfolioItem::find($id);<br/>//        $this-&gt;storeDetails($hashName, $item);<br/>        if </em>($request-&gt;hasFile('itempic')) {<br/>            $file = $request-&gt;itempic;<br/>            $hashName = $file-&gt;hashName();<br/>            $this-&gt;resizeAndStore($file, $hashName);<br/>        }<br/>        <strong class="lw iu"><em class="mg">if </em>($request-&gt;filled('description')) {<br/>            <br/>        }</strong><br/>    }</span></pre><p id="484f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有填写描述，那么服务器得到的是空的，所以我们需要处理描述为空的情况</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="534a" class="ma mb it lw b gy mc md l me mf">// PortfolioController's update()<br/><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/><em class="mg">//        $item = PortfolioItem::find($id);<br/>//        $this-&gt;storeDetails($hashName, $item);<br/>        if </em>($request-&gt;hasFile('itempic')) {<br/>            $file = $request-&gt;itempic;<br/>            $hashName = $file-&gt;hashName();<br/>            $this-&gt;resizeAndStore($file, $hashName);<br/>        }<br/>        <em class="mg">if </em>($request-&gt;filled('description')) {<br/><br/>        }<br/>        <strong class="lw iu"><em class="mg">if </em>($request-&gt;description === <em class="mg">null</em>) {<br/>            <br/>        }</strong><br/>    }</span></pre><p id="d8d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们不需要<code class="fe mh mi mj lw b"><strong class="lb iu">has</strong></code>、<code class="fe mh mi mj lw b"><strong class="lb iu">hasFile</strong></code>或<code class="fe mh mi mj lw b"><strong class="lb iu">filled</strong></code> <strong class="lb iu"> </strong>来命名，因为:</p><ul class=""><li id="941e" class="oa ob it lb b lc ld lf lg li oc lm od lq oe lu oz og oh oi bi translated">通过FormRequest ( <code class="fe mh mi mj lw b"><strong class="lb iu">required</strong></code>规则)检查名称是否存在，</li><li id="0009" class="oa ob it lb b lc pa lf pb li pc lm pd lq pe lu oz og oh oi bi translated">名称不是文件</li><li id="a0a0" class="oa ob it lb b lc pa lf pb li pc lm pd lq pe lu oz og oh oi bi translated">姓名必须已经填写(也由<code class="fe mh mi mj lw b"><strong class="lb iu">required</strong></code>规则完成)</li></ul><p id="5944" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以插入更新的名称并保存它。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fe32" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/><em class="mg">//        $item = PortfolioItem::find($id);<br/>//        $this-&gt;storeDetails($hashName, $item);<br/>        if </em>($request-&gt;hasFile('itempic')) {<br/>            $file = $request-&gt;itempic;<br/>            $hashName = $file-&gt;hashName();<br/>            $this-&gt;resizeAndStore($file, $hashName);<br/>        }<br/>        <em class="mg">if </em>($request-&gt;filled('description')) {<br/><br/>        }<br/>        <em class="mg">if </em>($request-&gt;description === <em class="mg">null</em>) {<br/><br/>        }<br/>        <strong class="lw iu">$item-&gt;name = $request-&gt;name;<br/>        $item-&gt;save();</strong><br/>    }</span></pre><p id="bf44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们试图改变一个项目的细节，我们将会以这个500错误结束</p><blockquote class="ok"><p id="de2f" class="ol om it bd on oo op oq or os ot lu dk translated">消息:从空值创建默认对象</p></blockquote><p id="e06d" class="pw-post-body-paragraph kz la it lb b lc ou ju le lf ov jx lh li ow lk ll lm ox lo lp lq oy ls lt lu im bi translated">出现该错误的原因是<code class="fe mh mi mj lw b"><strong class="lb iu">$item</strong></code>的含义被注释掉了。让我们取消该行的注释。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="279c" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/>        <strong class="lw iu">$item = PortfolioItem::<em class="mg">find</em>($id);</strong><br/><em class="mg">//        $this-&gt;storeDetails($hashName, $item);<br/>        if </em>($request-&gt;hasFile('itempic')) {<br/>            $file = $request-&gt;itempic;<br/>            $hashName = $file-&gt;hashName();<br/>            $this-&gt;resizeAndStore($file, $hashName);<br/>        }<br/>        <em class="mg">if </em>($request-&gt;filled('description')) {<br/><br/>        }<br/>        <em class="mg">if </em>($request-&gt;description === <em class="mg">null</em>) {<br/><br/>        }<br/>        $item-&gt;name = $request-&gt;name;<br/>        $item-&gt;save();<br/>    }</span></pre><p id="030f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在<code class="fe mh mi mj lw b"><strong class="lb iu">$item</strong></code> <strong class="lb iu"> </strong>被设置为我们试图更新的项目。如果我们现在更新，我们将能够更新投资组合项目的名称。<strong class="lb iu">成功</strong>😄</p><p id="2b06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，对于<code class="fe mh mi mj lw b"><strong class="lb iu">description</strong></code>仍有工作要做</p><p id="ebff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">👷即如何处理填充描述和空描述</p><h2 id="3a6d" class="ma mb it bd ms np nq dn mw nr ns dp na li nt nu nc lm nv nw ne lq nx ny ng nz bi translated">填补空白</h2><p id="ca22" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">填充描述-只需将<code class="fe mh mi mj lw b"><strong class="lb iu">$request</strong></code>的描述插入<code class="fe mh mi mj lw b"><strong class="lb iu">$item</strong></code>的描述中。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6e91" class="ma mb it lw b gy mc md l me mf"><em class="mg">if </em>($request-&gt;filled('description')) {<br/>    <strong class="lw iu">$item-&gt;description = request()-&gt;description;</strong><br/>}</span></pre><p id="4598" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">空描述-使<code class="fe mh mi mj lw b"><strong class="lb iu">$item</strong></code> <strong class="lb iu"> </strong>描述为空。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f362" class="ma mb it lw b gy mc md l me mf"><em class="mg">if </em>($request-&gt;description === <em class="mg">null</em>) {<br/>    $item-&gt;description = '';<br/>}</span></pre><h2 id="ad8e" class="ma mb it bd ms np nq dn mw nr ns dp na li nt nu nc lm nv nw ne lq nx ny ng nz bi translated">一个注释掉了左边一行</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d2f8" class="ma mb it lw b gy mc md l me mf"><em class="mg">//        $this-&gt;storeDetails($hashName, $item);</em></span></pre><p id="2734" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这当然指向storeDetails函数。我们从这个函数中唯一需要的是<code class="fe mh mi mj lw b"><strong class="lb iu">$item-&gt;img_path = $hashName</strong></code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/cfd2a72b7306c78e7599d4c0242ce4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DdPvetFs8PlUqR-t9DQlaA.png"/></div></div></figure><p id="edea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将<code class="fe mh mi mj lw b"><strong class="lb iu">$item-&gt;img_path = $hashName</strong></code> <strong class="lb iu"> </strong>复制粘贴到hasFile块中，并删除注释行</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ea76" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">/̶/̶ ̶$̶t̶h̶i̶s̶-̶&gt;̶s̶t̶o̶r̶e̶D̶e̶t̶a̶i̶l̶s̶(̶$̶h̶a̶s̶h̶N̶a̶m̶e̶,̶ ̶$̶i̶t̶e̶m̶)̶;̶</strong><br/><em class="mg">if </em>($request-&gt;hasFile('itempic')) {<br/>    $file = $request-&gt;itempic;<br/>    $hashName = $file-&gt;hashName();<br/>    $this-&gt;resizeAndStore($file, $hashName);<br/>    <strong class="lw iu">$item-&gt;img_path = $hashName;</strong><br/>}</span></pre><p id="d28b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在一起:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="11e8" class="ma mb it lw b gy mc md l me mf"><em class="mg">public function </em>update(UpdatePortfolioItemRequest $request, $id) {<br/>    $item = PortfolioItem::<em class="mg">find</em>($id);<br/>    <em class="mg">if </em>($request-&gt;hasFile('itempic')) {<br/>        $file = $request-&gt;itempic;<br/>        $hashName = $file-&gt;hashName();<br/>        $this-&gt;resizeAndStore($file, $hashName);<br/>        $item-&gt;img_path = $hashName;<br/>    }<br/>    <em class="mg">if </em>($request-&gt;filled('description')) {<br/>        $item-&gt;description = $request-&gt;description;<br/>    }<br/>    <em class="mg">if </em>($request-&gt;description === <em class="mg">null</em>) {<br/>        $item-&gt;description = '';<br/>    }<br/>    $item-&gt;name = $request-&gt;name;<br/>    $item-&gt;save();<br/>}</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="6888" class="mr mb it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">列出清单——第十章结束</h1><p id="9535" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们可以从列表中勾掉后端验证。</p><ul class=""><li id="c157" class="oa ob it lb b lc ld lf lg li oc lm od lq oe lu oz og oh oi bi translated">前端验证(用于更新functionality)☑️</li><li id="c607" class="oa ob it lb b lc pa lf pb li pc lm pd lq pe lu oz og oh oi bi translated">后端验证(用于更新functionality)☑️</li><li id="9264" class="oa ob it lb b lc pa lf pb li pc lm pd lq pe lu oz og oh oi bi translated">更新和删除功能</li></ul><p id="bcf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi">—</p><ul class=""><li id="d4ca" class="oa ob it lb b lc ld lf lg li oc lm od lq oe lu oz og oh oi bi translated">重构组合控制器</li></ul><p id="18f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi">—</p><ul class=""><li id="264e" class="oa ob it lb b lc ld lf lg li oc lm od lq oe lu oz og oh oi bi translated">带文本的图像(Portfolio.vue)</li><li id="76aa" class="oa ob it lb b lc pa lf pb li pc lm pd lq pe lu oz og oh oi bi translated">具有更大图像和描述的模型(Portfolio.vue)</li><li id="67f0" class="oa ob it lb b lc pa lf pb li pc lm pd lq pe lu oz og oh oi bi translated">modal (Portfolio.vue)上的关闭按钮</li></ul></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="8ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第十一章中，我们将为创建功能创建一个模式，完成更新功能并创建删除功能。</p><div class="pg ph gp gr pi pj"><a href="https://medium.com/@UmarCodes/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-11-20445acf83bb" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd iu gy z fp po fr fs pp fu fw is bi translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第11章</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">PortfolioEditor —添加模板，完成更新功能和实现删除功能</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">medium.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px ks pj"/></div></div></a></div></div></div>    
</body>
</html>
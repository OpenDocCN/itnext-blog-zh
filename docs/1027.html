<html>
<head>
<title>ASP.NET Core with GraphQL using .NET Boxed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GraphQL的ASP.NET核心。网盒装</h1>
<blockquote>原文：<a href="https://itnext.io/asp-net-core-with-graphql-using-net-boxed-f96a2aab6bde?source=collection_archive---------1-----------------------#2018-07-08">https://itnext.io/asp-net-core-with-graphql-using-net-boxed-f96a2aab6bde?source=collection_archive---------1-----------------------#2018-07-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d8b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GraphQL 是我一直想研究的东西，但一直没有时间。<a class="ae kl" href="https://twitter.com/RehanSaeedUK" rel="noopener ugc nofollow" target="_blank">穆罕默德·雷汉·赛义德</a>最近释放的<a class="ae kl" href="https://github.com/Dotnet-Boxed/Templates" rel="noopener ugc nofollow" target="_blank">。NET Boxed </a>，它是他的ASP.NET核心样板模板的一个更名，包含一个GraphQL的模板。这让GraphQL回到了我的脑海中，所以这篇文章将介绍安装和使用。NET Boxed来启动和运行GraphQL项目。</p><h2 id="e08d" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">模板安装</h2><p id="959c" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">与所有模板一样，使用。NET CLI。打开命令提示符，输入以下命令。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="4af9" class="km kn iq lp b gy lt lu l lv lw">dotnet new --install "Boxed.Templates::*"</span></pre><p id="c39b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">命令末尾的<strong class="jp ir"> * </strong>只是确保安装了最新版本。安装完成后，你会得到一个你已经安装的所有模板的列表。提供的两个新的。网框在截图中突出显示。</p><figure class="lk ll lm ln gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lx"><img src="../Images/6f160ce0e44b2fceb233d53ed339de0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FPz0m2Nb0uOmnea5.png"/></div></div></figure><h2 id="03a7" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">项目创建</h2><p id="fea1" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">在这篇文章中，我们将使用<strong class="jp ir"> graphql </strong>模板创建一个项目。提供的两个模板。NET Boxed有许多可选标志，可用于配置生成的项目。确保为您正在使用的模板运行<strong class="jp ir"> help </strong>命令，查看是否有您想要设置的选项。例如，下面的命令将列出GraphQL模板的所有选项。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="058d" class="km kn iq lp b gy lt lu l lv lw">dotnet new graphql --help</span></pre><p id="2fd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建并导航到要创建新项目的目录，然后运行以下命令，使用默认设置创建项目，但关闭HTTPS。对于生产应用程序来说，这不是您想要关闭的东西，但是它降低了初始探索的复杂性。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="56ea" class="km kn iq lp b gy lt lu l lv lw">dotnet new graphql --https-everywhere false</span></pre><p id="398d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建项目后，从同一目录运行以下命令，在Visual Studio代码中打开它。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="e90b" class="km kn iq lp b gy lt lu l lv lw">code .</span></pre><h2 id="bbec" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">一些项目笔记</h2><p id="120f" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">项目生成在项目的根中创建一个<strong class="jp ir">ReadMe.html</strong>。确保并检查它。它列出了项目所需的先决条件，以及大量关于一般良好实践的有用信息。</p><p id="22db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们不打算深入研究这个项目本身，但是当我们尝试一些GraphQL查询时，知道数据在哪里以及它看起来像什么是有帮助的。支持数据位于<strong class="jp ir">Repositories/database . cs</strong>文件中的静态类中。</p><p id="84ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些数据以星球大战为主题，由两个角色列表组成，一个是机器人的，另一个是人类的，这两个列表合并成一个角色列表。下面是数据库类，供参考。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="5704" class="km kn iq lp b gy lt lu l lv lw">public static class Database<br/>{<br/>    static Database()<br/>    {<br/>        Droids = new List&lt;Droid&gt;()<br/>        {<br/>            new Droid()<br/>            {<br/>                Id = new Guid("1ae34c3b-c1a0-4b7b-9375-c5a221d49e68"),<br/>                Name = "R2-D2",<br/>                Friends = new List&lt;Guid&gt;()<br/>                {<br/>                    new Guid("94fbd693-2027-4804-bf40-ed427fe76fda"),<br/>                    new Guid("c2bbf949-764b-4d4f-bce6-0404211810fa")<br/>                },<br/>                AppearsIn = new List&lt;Episode&gt;() { Episode.NEWHOPE,<br/>                                                  Episode.EMPIRE,<br/>                                                  Episode.JEDI, },<br/>                PrimaryFunction = "Astromech"<br/>            },<br/>            new Droid()<br/>            {<br/>                Id = new Guid("c2bbf949-764b-4d4f-bce6-0404211810fa"),<br/>                Name = "C-3PO",<br/>                Friends = new List&lt;Guid&gt;(),<br/>                AppearsIn = new List&lt;Episode&gt;() { Episode.NEWHOPE,<br/>                                                  Episode.EMPIRE,<br/>                                                  Episode.JEDI, },<br/>                PrimaryFunction = "Protocol"<br/>            }<br/>        };<br/>        Humans = new List&lt;Human&gt;()<br/>        {<br/>            new Human()<br/>            {<br/>                Id = new Guid("94fbd693-2027-4804-bf40-ed427fe76fda"),<br/>                Name = "Luke Skywalker",<br/>                Friends = new List&lt;Guid&gt;()<br/>                {<br/>                    new Guid("1ae34c3b-c1a0-4b7b-9375-c5a221d49e68"),<br/>                    new Guid("c2bbf949-764b-4d4f-bce6-0404211810fa")<br/>                },<br/>                AppearsIn = new List&lt;Episode&gt;() { Episode.NEWHOPE,<br/>                                                  Episode.EMPIRE,<br/>                                                  Episode.JEDI, },<br/>                HomePlanet = "Tatooine"<br/>            },<br/>            new Human()<br/>            {<br/>                Id = new Guid("7f7bf389-2cfb-45f4-b91e-9d95441c1ecc"),<br/>                Name = "Darth Vader",<br/>                Friends = new List&lt;Guid&gt;(),<br/>                AppearsIn = new List&lt;Episode&gt;() { Episode.NEWHOPE,<br/>                                                  Episode.EMPIRE,<br/>                                                  Episode.JEDI, },<br/>                HomePlanet = "Tatooine"<br/>            }<br/>        };<br/>        Characters = Droids.AsEnumerable&lt;Character&gt;()<br/>                           .Concat(Humans)<br/>                           .ToList();<br/>    }<br/><br/>    public static List&lt;Character&gt; Characters { get; }<br/><br/>    public static List&lt;Droid&gt; Droids { get; }<br/><br/>    public static List&lt;Human&gt; Humans { get; }<br/>}</span></pre><h2 id="0866" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">尝试一下</h2><p id="86f5" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">当你在开发模式(默认)下运行项目时，它会显示一个由<a class="ae kl" href="https://github.com/graphql-dotnet/graphql-dotnet" rel="noopener ugc nofollow" target="_blank">GraphQL.NET</a>提供的GraphQL操场。看起来是这样的。</p><figure class="lk ll lm ln gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mf"><img src="../Images/94f31cdc86afa8703ba85794316ee564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RbPufIsMnsEh2f62.png"/></div></div></figure><p id="a0c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">框1是您输入想要对GraphQL后端执行的查询的区域。框2是play按钮，它将查询发送到后端。最后，框3是显示查询结果的地方。</p><p id="2716" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下查询要求提供ID、名称，并出现在与提供的ID匹配的人的属性中。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="d66a" class="km kn iq lp b gy lt lu l lv lw">query getHuman{<br/>  human(id: "94fbd693-2027-4804-bf40-ed427fe76fda")<br/>  {<br/>    id,<br/>    name,<br/>    appearsIn    <br/>  }<br/>}</span></pre><p id="366d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的示例数据中，查询返回以下内容。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="3aac" class="km kn iq lp b gy lt lu l lv lw">{<br/>  "data": {<br/>    "human": {<br/>      "id": "94fbd693-2027-4804-bf40-ed427fe76fda",<br/>      "name": "Luke Skywalker",<br/>      "appearsIn": [<br/>        "NEWHOPE",<br/>        "EMPIRE",<br/>        "JEDI"<br/>      ]<br/>    }<br/>  }<br/>}</span></pre><p id="9747" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们试着创造一个新的人类。清除查询区域并输入以下查询。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="fd56" class="km kn iq lp b gy lt lu l lv lw">mutation createHuman($human: HumanInput!) {<br/>  createHuman(human: $human) {<br/>    id<br/>    name<br/>  }<br/>}</span></pre><p id="e634" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你尝试运行上面的代码，它将会失败。为了让这个查询工作，我们需要定义$human是什么。您可以在上面截图中框1正下方的<strong class="jp ir">查询变量</strong>区域中这样做。输入以下内容并点击播放按钮。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="d01a" class="km kn iq lp b gy lt lu l lv lw">{<br/>  "human": {<br/>    "name": "Eric Anderson",<br/>    "homePlanet": "Earth"<br/>  }<br/>}</span></pre><p id="2613" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将导致以下结果。你的身份证当然会不同。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="9cea" class="km kn iq lp b gy lt lu l lv lw">{<br/>  "data": {<br/>    "createHuman": {<br/>      "id": "22297c0e-01b4-4322-8e25-16d455a0c8e2",<br/>      "name": "Eric Anderson"<br/>    }<br/>  }<br/>}</span></pre><h2 id="beca" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">包扎</h2><p id="bdc7" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">以上信息足以开始使用ASP.NET核心的GraphQL。我想深入了解的还有很多，所以请寻找更多关于这些主题的帖子。代码可以在<a class="ae kl" href="https://github.com/elanderson/ASP.NET-Core-GraphQl/tree/59792e870382dba7c6c40d444cfe573577b2569b" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="7c34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mn">原载于</em> <a class="ae kl" href="https://elanderson.net/2018/07/asp-net-core-with-graphql-using-net-boxed/" rel="noopener ugc nofollow" target="_blank"> <em class="mn">埃里克·安德森</em> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>
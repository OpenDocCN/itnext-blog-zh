<html>
<head>
<title>How to Add a New User With SSH to Your VPS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用SSH向您的VPS添加新用户</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-add-a-new-user-with-ssh-to-your-vps-f44276c02b4b?source=collection_archive---------3-----------------------#2021-06-01">https://itnext.io/how-to-add-a-new-user-with-ssh-to-your-vps-f44276c02b4b?source=collection_archive---------3-----------------------#2021-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8bd0e77ef6b8786e1782837fd2856d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8qyjnBJ6MFF0gNKuJKIZmA.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在<a class="ae kf" href="https://unsplash.com/s/photos/server?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kf" href="https://unsplash.com/@scienceinhd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">科学高清</a>拍摄的照片</figcaption></figure><p id="80d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">设置VPS的第一步是添加一个带有SSH密钥的新的非root用户，并禁用root身份验证和密码身份验证。</p><p id="f1f4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将看到如何在基于Linux的操作系统(Ubuntu)的VPS上实现这一点。</p><h2 id="b358" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">先决条件</h2><ul class=""><li id="fed9" class="lx ly it ki b kj lz kn ma kr mb kv mc kz md ld me mf mg mh bi translated"><a class="ae kf" href="https://www.putty.org/" rel="noopener ugc nofollow" target="_blank">油灰</a></li><li id="1a19" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated"><a class="ae kf" href="https://www.puttygen.com/" rel="noopener ugc nofollow" target="_blank">推杆</a></li></ul><h2 id="bd43" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">目录:</h2><ol class=""><li id="d901" class="lx ly it ki b kj lz kn ma kr mb kv mc kz md ld mn mf mg mh bi translated">创建新用户</li><li id="2ced" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">创建一个SSH密钥</li><li id="551c" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">将会话保存在Putty中，以便于连接</li><li id="ab8e" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">禁用root和密码登录</li><li id="186a" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">将主题颜色应用于Putty会话(可选)</li></ol><h1 id="ceea" class="mo lf it bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">1.创建新用户</h1><p id="e112" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">当您启动一个新的VPS时，您通常会第一次以根用户身份连接到它，并创建一个单独的用户，您将在将来出于<a class="ae kf" href="https://askubuntu.com/questions/16178/why-is-it-bad-to-log-in-as-root" rel="noopener ugc nofollow" target="_blank">安全原因</a>使用该用户。</p><p id="3648" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您是系统管理员，您将为自己创建的这个用户将是超级用户，为了提高安全性，您还将禁用root和密码身份验证，并且只使用SSH密钥。</p><p id="a308" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以root用户身份连接到VPS后，您可以运行以下命令来添加新用户。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/434a51e211a6cec44c0522bc6860a6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1ebgf5zIi4ydrNaVjk77A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&amp;t=seti&amp;wt=none&amp;l=application%2Fx-sh&amp;ds=true&amp;dsyoff=20px&amp;dsblur=68px&amp;wc=true&amp;wa=true&amp;pv=14px&amp;ph=20px&amp;ln=false&amp;fl=1&amp;fm=Hack&amp;fs=14px&amp;lh=133%25&amp;si=false&amp;es=2x&amp;wm=false&amp;code=adduser%2520%255Busername%255D%2520%2523%2520add%2520user%250A%250Ausermod%2520-aG%2520sudo%2520%255Busername%255D%2520%2523%2520set%2520it%2520as%2520superuser" rel="noopener ugc nofollow" target="_blank"> Raw </a></figcaption></figure><blockquote class="nn no np"><p id="afc9" class="kg kh nq ki b kj kk kl km kn ko kp kq nr ks kt ku ns kw kx ky nt la lb lc ld im bi translated">系统将提示您添加的密码可用于验证和授权超级用户命令(sudo)</p></blockquote><h1 id="900b" class="mo lf it bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">2.创建一个SSH密钥</h1><p id="0273" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">为了创建新的SSH密钥，我们将使用<a class="ae kf" href="https://www.puttygen.com/" rel="noopener ugc nofollow" target="_blank"> PuTTYgen </a>。</p><p id="e10e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了增加一层安全性，我们还将在SSH密钥中添加一个密码短语。这样，任何想要使用SSH密钥的人也必须输入密码。这在安全方面很有用，以防SSH密钥泄露。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/70c27b415791bac4b2ed1ea725773350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*a9mqAh5g485TTTKGMAnClg.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">用PuTTYGen创建一个SSH密钥</figcaption></figure><blockquote class="nn no np"><p id="662d" class="kg kh nq ki b kj kk kl km kn ko kp kq nr ks kt ku ns kw kx ky nt la lb lc ld im bi translated">这里有一个很好的经验法则，那就是始终使用密码短语，除非你在任何类型的自动化程序中需要它。</p></blockquote><p id="789d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦生成了SSH密钥对，我们就可以将其添加到我们的VPS中。</p><p id="d5dc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们需要运行以下命令。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/be718b46b9f446575d1ccd270351ed85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzL20wqYQ1Z36ZeUYgdJJw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&amp;t=seti&amp;wt=none&amp;l=application%2Fx-sh&amp;ds=true&amp;dsyoff=20px&amp;dsblur=68px&amp;wc=true&amp;wa=true&amp;pv=14px&amp;ph=20px&amp;ln=false&amp;fl=1&amp;fm=Hack&amp;fs=14px&amp;lh=133%25&amp;si=false&amp;es=2x&amp;wm=false&amp;code=su%2520-%2520username%2520%2523%2520switch%2520to%2520the%2520newly%2520created%2520user%250A%250Amkdir%2520%7E%252F.ssh%2520%2523%2520create%2520an%2520.ssh%2520directory%2520in%2520the%2520current%2520user%27s%2520home%2520directory%250A%250Achmod%2520700%2520%7E%252F.ssh%2520%2523%2520protect%2520the%2520file%2520from%2520being%2520accessed%2520by%2520other%2520users%250A%250Anano%2520%7E%252F.ssh%252Fauthorized_keys%2520%2523%2520create%2520a%2520file%2520for%2520the%2520authorized%2520SSH%2520keys%2520and%2520paste%2520your%2520public%2520key%253B%2520add%2520ssh-rsa%2520in%2520front%2520of%2520the%2520key%2520and%2520make%2520sure%2520the%2520content%2520it%27s%2520on%2520a%2520single%2520line%252C%2520not%2520multiple%2520lines%250A%250Achmod%2520600%2520%7E%252F.ssh%252Fauthorized_keys%2520%2523%2520set%2520it%2520as%2520a%2520private%2520file%2520that%2520can%2520only%2520be%2520modified%2520by%2520the%2520user%2520who%2520entered%2520this%2520command%250A%250Asudo%2520service%2520ssh%2520restart%2520%2523%2520restart%2520the%2520SSH%2520service" rel="noopener ugc nofollow" target="_blank">生</a></figcaption></figure><blockquote class="nn no np"><p id="1966" class="kg kh nq ki b kj kk kl km kn ko kp kq nr ks kt ku ns kw kx ky nt la lb lc ld im bi translated"><a class="ae kf" href="https://chmodcommand.com/chmod-700/" rel="noopener ugc nofollow" target="_blank"> chmod 700 </a>和<a class="ae kf" href="https://chmodcommand.com/chmod-600/" rel="noopener ugc nofollow" target="_blank"> chmod 600 </a>解释</p></blockquote><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/f3402c138751f4e8ee476e1ff19fc2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*w8LQ24zcefFQtuzFOXp1SA.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">为新用户添加SSH密钥</figcaption></figure><p id="d456" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是对该视频的一些评论:</p><ul class=""><li id="12f1" class="lx ly it ki b kj kk kn ko kr nw kv nx kz ny ld me mf mg mh bi translated">用运行<code class="fe nz oa ob oc b">adduser <em class="nq">username</em></code> <em class="nq"> </em>命令时提供的用户名替换<code class="fe nz oa ob oc b">georgian</code>；</li><li id="b300" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated"><code class="fe nz oa ob oc b">nano</code>是一个轻量级的命令行文本编辑器，用于Unix和<strong class="ki iu"> Linux </strong>，我们将使用它来添加我们的<strong class="ki iu"> public </strong> SSH密钥；粘贴SSH密钥可以使用<code class="fe nz oa ob oc b">right-click</code>，保存并退出可以使用<code class="fe nz oa ob oc b">CTRL+X</code>；</li></ul><h1 id="58d6" class="mo lf it bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">3.将会话保存在Putty中以实现更快的连接</h1><p id="dff9" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">下面是如何作为新添加的用户使用SSH密钥连接到VPS。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/6bb2357ccc0a9a38f10ed9b8adcca23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Xr_7gvbHrelM9dqRdQ1iZQ.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在PuTTy中保存会话</figcaption></figure><p id="f272" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是上面视频中可见的步骤:</p><ol class=""><li id="f789" class="lx ly it ki b kj kk kn ko kr nw kv nx kz ny ld mn mf mg mh bi translated">在字段<code class="fe nz oa ob oc b">Host Name (or IP address)</code>中，填写您的副总裁的IP。</li><li id="c08d" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">在<code class="fe nz oa ob oc b">Saved Sessions</code>部分，输入您想要保存该会话的标签。</li><li id="5e43" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">在左侧菜单的<strong class="ki iu">连接- &gt;数据</strong>选项卡下，用您创建用户时使用的名称填写<strong class="ki iu">自动登录用户名</strong>字段。</li><li id="7d30" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">在<strong class="ki iu">连接- &gt; SSH - &gt;认证</strong>中添加私有SSH密钥。</li><li id="b7cb" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld mn mf mg mh bi translated">在左侧菜单中，返回<strong class="ki iu">会话</strong>选项卡，点击<strong class="ki iu">保存</strong>保存该信息，然后点击<strong class="ki iu">打开</strong>。</li></ol><p id="66a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于将来的连接，您只需在<strong class="ki iu">会话</strong>选项卡的<strong class="ki iu">保存的会话</strong>部分选择该会话，然后点击<strong class="ki iu">打开</strong>。</p><blockquote class="nn no np"><p id="3c5c" class="kg kh nq ki b kj kk kl km kn ko kp kq nr ks kt ku ns kw kx ky nt la lb lc ld im bi translated">当使用Putty中保存的会话连接到VPS时，私有SSH密钥的路径必须始终可用。因此，建议您将SSH密钥放在计算机上定义明确的目录中，这样就不会意外删除它。</p></blockquote><h1 id="35ce" class="mo lf it bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">4.禁用root和密码登录</h1><p id="adab" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">这一步是额外的安全措施，是可选的，但是推荐使用。</p><p id="20aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们将禁用root身份验证，这样任何人都不能使用SSH或密码作为<strong class="ki iu"> root </strong>用户登录，我们还将禁用所有人的密码登录，因此我们的VPS将只允许非root用户使用SSH连接。</p><p id="1dc3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，您必须执行以下操作:</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi gj"><img src="../Images/3a1ca060b43f489859d2bc91ed284dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NDLTcuHMmPjb_xLJ6lZHNw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&amp;t=seti&amp;wt=none&amp;l=application%2Fx-sh&amp;ds=true&amp;dsyoff=20px&amp;dsblur=68px&amp;wc=true&amp;wa=true&amp;pv=14px&amp;ph=20px&amp;ln=false&amp;fl=1&amp;fm=Hack&amp;fs=14px&amp;lh=133%25&amp;si=false&amp;es=2x&amp;wm=false&amp;code=sudo%2520nano%2520%252Fetc%252Fssh%252Fsshd_config%2520%250A%250A%2523%2520Set%2520PermitRootLogin%2520to%2520no%250A%2523%2520Set%2520PasswordAuthentication%2520to%2520no%250A%250Asudo%2520systemctl%2520reload%2520sshd%2520" rel="noopener ugc nofollow" target="_blank">生</a></figcaption></figure><blockquote class="nn no np"><p id="d2b5" class="kg kh nq ki b kj kk kl km kn ko kp kq nr ks kt ku ns kw kx ky nt la lb lc ld im bi translated"><strong class="ki iu"> systemctl </strong>命令是控制<strong class="ki iu"> systemd </strong>系统和服务的工具，被大多数新的Linux操作系统所使用。</p></blockquote><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/3f0e75dbfb77ce344e7efdbf76293b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IGzlf5rb8Nd2tit1vZjCQw.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">禁用root和密码登录</figcaption></figure><h1 id="7e3d" class="mo lf it bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">5.将主题颜色应用于Putty会话</h1><p id="d4ce" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">最后一步是完全可选的，只是作为Putty会话的增强，即添加主题颜色。</p><p id="0ed8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以从这个Github <a class="ae kf" href="https://github.com/AlexAkulov/putty-color-themes" rel="noopener ugc nofollow" target="_blank">资源库</a>下载主题，并按照下面视频中的说明来应用一个。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/ace53aba25e3303cddc7a7b10d3c809a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*17H4fSriiZv4tQzze4a8NA.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">向putty会话添加主题颜色</figcaption></figure><p id="c521" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只需打开您喜欢的主题文件<code class="fe nz oa ob oc b">.reg</code>，键入您想要应用主题的Putty会话的名称，然后双击该文件。</p><p id="099e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以根据主题文件的内容确定将应用哪些更改。</p><p id="bf04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">应用这个主题会出现的一个问题是<code class="fe nz oa ob oc b">right-click</code>粘贴会被禁用，但是你可以很容易地从左边的菜单进入<strong class="ki iu">窗口- &gt;选择</strong>标签，从<strong class="ki iu"> xterm </strong>切换到<strong class="ki iu">窗口</strong>或<strong class="ki iu">妥协。</strong></p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/25ff673b937ecb28cc469e6bc35c4213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OsbLPaD2mdGZ2gOxyoCMAg.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">右键单击时修复副本</figcaption></figure><blockquote class="nn no np"><p id="e291" class="kg kh nq ki b kj kk kl km kn ko kp kq nr ks kt ku ns kw kx ky nt la lb lc ld im bi translated">请注意，在更新会话之前，您首先需要点击<strong class="ki iu">加载</strong>按钮，然后点击<strong class="ki iu">保存</strong>，以保存此更改。</p></blockquote></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><figure class="nj nk nl nm gt ju"><div class="bz fp l di"><div class="ok ol l"/></div></figure></div></div>    
</body>
</html>
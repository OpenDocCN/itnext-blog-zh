# 没有必要讨厌 Web 组件

> 原文：<https://itnext.io/theres-no-need-to-hate-web-components-ebf2ec8a998c?source=collection_archive---------3----------------------->

你也不需要放弃你的框架

![](img/a6acab25f5161f42d424a8776ec9c3d4.png)

乔恩·泰森在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

四年前，我在一家国际荷兰银行找到了一份自由职业。最初，我受雇帮助将应用程序从 AngularJS 迁移到 Angular 2，但事情突然变得不同了。

有一天，我碰到一位经理，他力劝我“看一看聚合物”，因为澳大利亚的一个团队已经用它创造出了一些好东西。聚合物现在是前进的方向，实际上在几周内，我们正在向聚合物迁移。

事情进行得很快，也出了差错。Polymer 的第一个稳定的 1.0 版本才发布了大约一年，仍然有许多开创性的工作要做。

我们在测试、遗留浏览器支持和依赖性管理方面苦苦挣扎。但是现在，四年后，Web 组件终于出现了，它们已经准备好了。

# Web 组件现在在任何地方都受支持

1 月 15 日，微软发布了基于 Chromium 的 Edge 浏览器，所有主流浏览器最终都获得了对 Web 组件的本地支持。

最初的规范是在 2011 年推出的，所以它已经被悲观的开发者宣布 [死亡](https://dev.to/richharris/why-i-don-t-use-web-components-2cia)好几次了。

在铬基 Edge 发布后，聚合物团队的声明再次遭到了一些质疑:

那么，为什么对 Web 组件如此厌恶呢？

# 有一段时间了

所有主流浏览器都支持 Web 组件需要相当长的时间，也许太长了。与此同时，前端框架已经接管了世界，许多开发人员似乎不愿意“转换”到 Web 组件。

反应还是王道，Vue。JS 正在获得牵引力，Web 组件的采用仍然相对较低。但在过去的一年半时间里，这种情况似乎正在慢慢改变。

存在框架疲劳，开发人员想知道框架是否值得麻烦，寻找本地平台作为替代。

我相信 Web 组件是一种解决方案，但是 Web 组件是框架的替代物是围绕它们的许多误解之一。

让我们仔细看看。

# 你可以继续使用你的框架

没有必要“转换”和放弃你的前端框架。有人声称 [Web 组件将取代前端框架](https://blog.usejournal.com/web-components-will-replace-your-frontend-framework-3b17a580831c)，这听起来可能很奇怪，但这从来都不是 Web 组件的*目标*。

是的，我仍然相信 Web 组件将会进化，使我们所知的这些框架过时，但是它们从来没有打算成为替代品。

Web 组件的一个关键特性是它们是框架不可知的，这意味着它们可以集成到任何框架中。这是*与 Angular、React 和 Vue 等不可互换的专有组件之间的巨大*转变。

Web 组件最终使我们能够编写一个组件，并在任何地方使用它。三大框架 React、Angular 和 Vue [已经](https://reactjs.org/docs/web-components.html) [提供](https://angular.io/guide/elements) [支持](https://github.com/vuejs/vue-web-component-wrapper)集成 Web 组件。

# “没有人使用 Web 组件”

Web 组件的采用仍然相对较低，但它们已经被 YouTube、 [Apple Music](https://dev.to/ionic/apple-just-shipped-web-components-to-production-and-you-probably-missed-it-57pf) 和 ING Bank(我是其中的一员)用于生产，Github 和 Twitter 也在它们的应用程序的较小部分中使用它们。

毫不奇怪，在这个框架占主导地位的时代，Web 组件可能不会一夜成名，事实上，它们只是最近才得到所有浏览器的完全支持。

但是目前，人们的兴趣正在快速增长，关于 Web 组件和使用它们的项目的文章数量也在快速增长。一些很好的例子是[svelet](https://svelte.dev)、 [Webcomponents.dev](https://webcomponents.dev) 和 [open-wc](https://open-wc.org) 。

因此，尽管 Web 组件的采用和浏览器支持花了很长时间，但毫无疑问它正在发生。

# “我需要支持 IE11”

我经历过在尝试使用现代 JavaScript 特性的同时不得不支持 IE11 的痛苦。

但我从未让这妨碍向现代浏览器用户提供最佳体验。仅仅因为我们需要迎合老浏览器的用户，就降低他们的体验是没有意义的。

给所有用户尽可能最好的体验更有意义，但不一定要给*完全相同的体验*。这可能意味着额外的工作，但是这并不是特定于 Web 组件的，所以也不应该成为不使用它们的理由。

根据有多少用户仍在使用 IE11，你可以决定应该在这上面花费多少资源。通常，这将是一个很小的百分比，因此应该相应地花费资源。

如果这一小部分人至少得到了一个可接受的，尽管是降级的体验，那么这应该是好的。

具体到 Web 组件，他们有一组可用的[poly fill](https://github.com/WebComponents/webcomponentsjs)，可以在 IE11 上提供足够好的体验。

只要确保现代浏览器上的用户不会受到影响，因为您需要支持 IE11 的一小部分用户。这说不通。

# “没有数据绑定，无法扩展”

默认情况下，Web 组件的属性只能接受原始值，如字符串、数字和布尔值。这些属性值的变化可以通过`attributeChangedCallback`方法观察和反应。

属性不能像对象和数组那样接受复杂的值，所以在实践中，数据绑定只能通过带有原语值的`attributeChangedCallback`来完成。

但这并不意味着复杂值的数据绑定在 Web 组件中是不可能的，它只是需要一些代码。

我自己实现了一个简单的概念验证。它类似于由 Polymer 团队创建的 [lit-element](https://github.com/polymer/lit-element) ，它也为自定义元素提供了一个 bass 类，包含各种方便的方法，使使用 Web 组件更加容易。

请记住，框架也不会“神奇地”让复杂值的数据绑定成为可能。他们通常提供序列化机制来实现这一点，这在性能方面也不是免费的。

使用 Web 组件的标准方式是通过属性传递复杂的值。通常，您会为这些属性定义 getters 和 setters 来对更改做出反应。您还可以在 Web 组件上定义可以从外部调用的方法，这样也可以传入复杂的值。

# “没有无状态组件，它不会扩展”

Web 组件是基于类的，这是必要的，因为它们需要扩展`HTMLElement`，这是所有 HTML 元素的 bass 类。本质上，Web 组件是通过扩展 HTML 本身来工作的。

就我个人而言，如果能够用一个对象或函数创建一个 Web 组件，我会很高兴，但是由于上面提到的原因，不幸的是事实并非如此。

但这并不意味着当应用程序变得非常大时，Web 组件就不能伸缩。

似乎有这样一种误解，即如果不使用前端框架和无状态功能组件，构建可伸缩的应用程序就不再可能。

无状态功能组件很棒，但是它们确实带来了一些额外的复杂性。在 React 的情况下，API 从`React.createClass`到 ES6 类再到功能组件，这带来了更高阶的组件，现在这些组件被 React 钩子所取代。

我们应该认识到，这些都是为了解决无状态功能组件引起的问题而创建的变通办法。

他们可能会带来更多的麻烦。

# “为 Web 组件设置主题很难”

Web 组件可以使用影子 DOM，它带来了真正有作用域的 CSS。这意味着一个组件可以用只适用于组件本身的 CSS 从内部进行样式化。

当然，我们仍然希望 Web 组件的消费者能够对它们进行样式化，这可以通过 CSS 自定义属性来实现。这确实意味着这些属性中的每一个都需要显式公开。

在 Chrome 和 Firefox 中， [CSS 阴影部分](https://developer.mozilla.org/en-US/docs/Web/CSS/::part)已经被支持以使主题化更容易，并且[可构造样式表](https://developers.google.com/web/updates/2019/02/constructable-stylesheets)从 Chrome 73 开始被支持。目前还不清楚其他浏览器何时会提供支持。

主题化 Web 组件仍有改进的空间，但框架的替代方案，例如 [React styled components](https://styled-components.com/) ，需要另一个库，很复杂，并且将所有 CSS 都转移到 JavaScript。

# “没有服务器端渲染”

服务器端渲染很难，当使用 Shadow DOM 或任何其他浏览器专用 API 时，我想你没有其他选择，只能使用成熟的无头浏览器来进行渲染。

如果你的应用非常依赖于服务器端的渲染，那么 Web 组件现在可能不是一个好的选择。但话说回来，你最好的选择可能是完全使用静态 HTML，而不是单页应用程序。

# Web 组件是一个健壮的解决方案

对于基于组件的前端架构来说，使用 Web 组件有很多好处。

它们扩展了 HTML 本身，并利用浏览器的 HTML 解析器来确保最佳性能。

您可以继续使用您喜欢的框架，因为 Web 组件可以集成到所有当前的前端框架中，因此真正可以在任何地方重用。

Web 组件是基于标准的，不需要外部依赖，而且不太可能被废弃。现在，所有主流浏览器都支持它们，并且会一直支持下去。

Web 组件的 API 是稳定的，并且保证保持稳定，因为它受到标准的约束。

这些是 Web 组件的好处:基于标准、经得起未来考验、稳定和真正可重用。

拥抱他们或憎恨他们，选择权在你。
<html>
<head>
<title>Why and how to use Static IPs in Frontend &amp; Backend</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么以及如何在前端和后端使用静态IP</h1>
<blockquote>原文：<a href="https://itnext.io/why-and-how-to-use-static-ips-in-frontend-backend-4d1ed9a65eb8?source=collection_archive---------0-----------------------#2020-10-11">https://itnext.io/why-and-how-to-use-static-ips-in-frontend-backend-4d1ed9a65eb8?source=collection_archive---------0-----------------------#2020-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8eefb39a53f54e7e187c165a2489bfd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t8LwZkvOLoYjlLTX"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">安娜斯塔西娅·杜尔吉尔在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="c735" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一位测试版客户曾经找过我们，因为他无法登录我们的Angular web应用程序。页面正在加载，但是对我们API的任何HTTP请求都失败了。在与客户交谈后，我们发现他们的公司正在使用IP限制。因此，他想知道我们是否可以提供静态IP，他们可以将这些IP添加到他们的产品中，以便在他们的公司中使用我们的应用程序。</p><p id="1bcb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不幸的是，我们选择的云平台(<a class="ae kf" href="https://render.com" rel="noopener ugc nofollow" target="_blank">渲染</a>)当时还没有直接支持这个特性。因此，我们无法提供一个绝对不会改变的IP列表。这就是为什么我们必须寻找一种可以提供静态IP的产品。改变我们的云平台是不可能的，因为直到今天我们对它还是很满意的。由于这是第一个提出要求的客户，我们现在也不想为此花太多钱。</p><p id="d76f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，我偶然发现了一个解决方案，它似乎提供了我现在需要的一切。<a class="ae kf" href="https://www.quotaguard.com" rel="noopener ugc nofollow" target="_blank"> QuotaGuard </a>是一项服务，它自称为“<em class="le">全球领先的分布式网络和基于云的应用的静态IP解决方案提供商</em>”。他们支持多种云平台，包括我们正在使用的平台，在我看来，价格是公平的。</p><p id="a5d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的例子中，我们只需要一个允许我们从静态IP访问应用程序的入站代理。如果我们希望通过静态IP将流量从我们的应用程序路由到外部服务，那么出站是必要的。</p><p id="4cb9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住，除了帐户注册之外，下面的步骤相当一般，因此它们也应该与替代解决方案一起使用。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="ebac" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">如何创建入站代理以使用带有QuotaGuard Static的静态IPs</h2><ol class=""><li id="d1bc" class="mf mg it ki b kj mh kn mi kr mj kv mk kz ml ld mm mn mo mp bi translated">创建一个帐户</li><li id="a9df" class="mf mg it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">创建入站代理。这需要您提供API的URL。</li><li id="af25" class="mf mg it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">确保允许您的应用程序使用入站代理</li><li id="7715" class="mf mg it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">确保使用域URL，而不是直接调用API</li><li id="083e" class="mf mg it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">向您的客户提供所有静态IP</li><li id="1792" class="mf mg it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">可选:仅对某些请求或客户使用入站代理，以不超过您的配额🤓</li></ol><p id="2dfb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建入站代理后，我们会看到静态IP和域URL。我们应该向感兴趣的客户提供我们在这里看到的静态IP。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/54c01d0a3d72d87988c56c1aa45fe8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MkOwpQkPnwFMxQXcw6C65A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">创建入站代理</figcaption></figure><p id="7a17" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的例子中，我们的Angular web应用程序使用<a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/how-to-send-jwt-automatically-in-angular-http-requests-31c1fd060871"> JWT </a>进行认证。注意<code class="fe na nb nc nd b">whitelistedDomains</code>，它包含了我们的入站代理的新域名URL。</p><pre class="mw mx my mz gt ne nd nf ng aw nh bi"><span id="eb26" class="lm ln it nd b gy ni nj l nk nl">// called on every request to retrieve the token<br/>export function jwtOptionsFactory(tokenService: MyTokenService) {<br/>  return {<br/>    tokenGetter: () =&gt; tokenService.getToken(),<br/>    whitelistedDomains: ['some-api.com', 'some-api.gestatica.com']<br/>  };<br/>}<br/>// the actual module imports (simplified)<br/>@NgModule({<br/>  ...,<br/>  imports: [JwtModule.forRoot({<br/>      jwtOptionsProvider: {<br/>        provide: JWT_OPTIONS,<br/>        useFactory: jwtOptionsFactory,<br/>        deps: [MyTokenService]<br/>      }<br/>    }),<br/>  ...<br/>}</span></pre><p id="18ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">剩下唯一要做的事情是:为HTTP请求使用正确的URL。在我们的例子中，我们为此创建了一个特性标志。因此，只有需要这个特性的客户才会使用入站代理，而其他人会像往常一样直接使用API。然而，在用户登录之前我们不知道这些信息，所以我们总是使用代理来处理登录请求。</p><pre class="mw mx my mz gt ne nd nf ng aw nh bi"><span id="bff2" class="lm ln it nd b gy ni nj l nk nl">getApiUrl(route: string, useStaticIps: boolean): string {<br/>  if (!environment.production) {<br/>   return 'https://some-api.com';<br/>  } else {<br/>   return useStaticIps || route.includes('authentication/login') ?<br/>    'https://some-api.gestatica.com' :<br/>    'https://some-api.com';<br/>  }<br/> }</span></pre></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="b97b" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">结论</h2><p id="d252" class="pw-post-body-paragraph kg kh it ki b kj mh kl km kn mi kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">感谢您阅读这篇关于使用QuotaGuard作为静态IPs解决方案的短文。如您所见，设置在几分钟内完成，每个人都可以再次访问我们的应用程序。如何在您的产品中使用静态IP？请在评论中告诉我。</p></div></div>    
</body>
</html>
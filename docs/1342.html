<html>
<head>
<title>Send Targeted Notifications to iOS Devices with AWS Amplify and Amazon Pinpoint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过AWS Amplify和Amazon Pinpoint向iOS设备发送目标通知</h1>
<blockquote>原文：<a href="https://itnext.io/send-targeted-notifications-to-ios-devices-with-aws-amplify-and-amazon-pinpoint-81badf4100ad?source=collection_archive---------1-----------------------#2018-09-18">https://itnext.io/send-targeted-notifications-to-ios-devices-with-aws-amplify-and-amazon-pinpoint-81badf4100ad?source=collection_archive---------1-----------------------#2018-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6635db2e5b3c38018faffd311595ceb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6vdG8oqDCWAZdw83bsf0g.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">丘比特的跨度——在旧金山跑了5公里</figcaption></figure><p id="1422" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是关于使用<a class="ae lb" href="https://aws-amplify.github.io/media/get_started?utm_source=da&amp;utm_medium=blog&amp;utm_campaign=denhills&amp;utm_term=ios_native" rel="noopener ugc nofollow" target="_blank"><em class="la">AWS Amplify</em></a><em class="la">和</em><a class="ae lb" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/welcome.html" rel="noopener ugc nofollow" target="_blank"><em class="la">Amazon Pinpoint</em></a>将用户分析添加到您的iOS Swift应用程序的3部分系列的第3部分。在<a class="ae lb" href="https://medium.com/@dmennis/integrate-analytics-into-your-ios-swift-applications-with-aws-amplify-20d31fe0a20e" rel="noopener">第1部分</a>中，我们在你的iOS应用中收集了基本的用户分析(人口统计和应用活动)。在<a class="ae lb" href="https://medium.com/p/2ace3ce0fef1" rel="noopener">第2部分</a>中，我们通过以<strong class="ke ir">设备特定属性的形式添加自定义用户设备分析，增强了标准人口统计收集流程。</strong>然后，我们基于iOS设备的子集创建了一个亚马逊定位细分市场。</p><p id="d898" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本文中，我们将启用SMS消息，创建一个针对我们的自定义设备特定属性的<a class="ae lb" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/campaigns.html" rel="noopener ugc nofollow" target="_blank">精确定位活动</a>，然后向iPhone X设备上的用户发送一条有针对性的SMS消息。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="ef82" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，让我们回到我们在第二部分中创建的精确细分市场。在那篇文章中，我们创建了一个新的细分市场，通过特定的设备(iPhone X)来识别用户子集。当时，我们只是选择了一个任意的通信频道。在这里，我们应该修改细分市场，以使用三种可用渠道(推送通知、电子邮件和短信)之一，并使用该渠道向这些细分市场的设备型号发送我们的营销活动消息。</p><p id="fc82" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于这个例子，我将使用SMS，但您也可以通过<a class="ae lb" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/channels-email.html" rel="noopener ugc nofollow" target="_blank">电子邮件</a>或<a class="ae lb" href="https://docs.aws.amazon.com/pinpoint/latest/userguide/channels-mobile.html" rel="noopener ugc nofollow" target="_blank">推送通知</a>渠道设置消息。</p><h2 id="14f2" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">启用短信服务</h2><p id="c049" class="pw-post-body-paragraph kc kd iq ke b kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz ij bi translated">从iOS项目文件夹中，启动终端并键入:</p><p id="650b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">$ <em class="la">放大添加通知</em></p><p id="e51f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">选择<strong class="ke ir">短信。</strong>这将在您的Amazon Pinpoint项目中启用短信功能。</p><h2 id="c333" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">为SMS注册设备</h2><p id="e9f0" class="pw-post-body-paragraph kc kd iq ke b kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz ij bi translated">针对我们的移动用户，我们有三种渠道可供选择。您可以使用AWS CLI或AWS SDK向一个或多个通道注册设备。每个Amazon Pinpoint端点代表一个通道。因此，如果有一个用户设备注册了所有三个通道，则同一设备将有三个不同的端点，每个通道一个。当我们创建细分市场时，我们只选择一个渠道，并且在发送有针对性的通知时，每个活动只选择一个细分市场。</p><p id="857c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通常，当用户第一次注册时，会进行频道注册。例如，如果我们为Amazon Cognito用户池启用了电子邮件/密码注册，我们将在这个阶段捕获电子邮件，并将电子邮件地址发送给Pinpoint。因为我选择了SMS作为我的通道，所以我需要更新一个设备端点，将通道类型设置为SMS，并为端点地址提供一个有效的移动电话号码。在这个演示中，我将使用<a class="ae lb" href="https://aws.amazon.com/cli/" rel="noopener ugc nofollow" target="_blank"> AWS CLI </a>更新一个端点。</p><h2 id="5c46" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">使用AWS CLI更新端点</h2><blockquote class="mh mi mj"><p id="8e04" class="kc kd la ke b kf kg kh ki kj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky kz ij bi translated">我本打算向您展示如何使用AWS SDK for iOS直接从客户端更新端点，但是，它不可用(对我无效)。如果情况有变，我会在这里更新。抱歉，CLI确实创建了一些额外的步骤。</p></blockquote><ol class=""><li id="e462" class="mn mo iq ke b kf kg kj kk kn mp kr mq kv mr kz ms mt mu mv bi translated">使用以下代码片段从iOS应用程序客户端获取Amazon Pinpoint<em class="la">endpoint-id</em>:</li></ol><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/ef39e71728948ff254e451dc247fb08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zd7u0dvLiis6382uCnYnEg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae lb" href="https://gist.github.com/mobilequickie/30a3f2ee03527924c796a3e7f455d559" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mobile quickie/30 a3 F2 ee 03527924 c 796 a3 e 7 f 455d 559</a></figcaption></figure><p id="671b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2.通过将其粘贴到新的<em class="la"> endpointrequest.json </em>文件中来定义端点请求。*不要忘记更改电话号码以匹配iPhone设备</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/60e0b510334b769bddba6b8edb2c404b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U32UobywavO2lb08qZUpUA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae lb" href="https://gist.github.com/mobilequickie/429aafc0711130822f675827442926a9" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mobile quickie/429 aafc 0711130822 f 675827442926 a9</a></figcaption></figure><p id="107a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">3.从与<em class="la"> endpointrequest.json </em>相同目录中的终端，让我们更新从步骤#1捕获的现有端点id。应用id可在Pinpoint控制台应用视图<a class="ae lb" href="https://console.aws.amazon.com/pinpoint/home/?region=us-east-1#/apps" rel="noopener ugc nofollow" target="_blank">中找到，此处为</a>。</p><p id="f3dd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用以下<a class="ae lb" href="https://docs.aws.amazon.com/cli/latest/reference/pinpoint/update-endpoint.html" rel="noopener ugc nofollow" target="_blank"> AWS CLI命令</a>更新精确定位端点。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/32fdf7f1dda4a2504b5bf99d151f7703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3yvc9-IfnIAhfLqA9tICw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae lb" href="https://gist.github.com/mobilequickie/4c901aedec5429573d28d4f2778b909e" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mobile quickie/4c 901 aedc 5429573d 28 d4f 2778 b 909 e</a></figcaption></figure><p id="df7a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您的端点现在应该与一个电话号码和一个iPhone X设备相关联。</p><h2 id="4317" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">创建新的活动</h2><p id="3412" class="pw-post-body-paragraph kc kd iq ke b kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz ij bi translated">您可以先创建一个细分市场或一个活动。如果不存在细分市场，控制台将引导您在活动页面中创建细分市场。</p><ol class=""><li id="67da" class="mn mo iq ke b kf kg kj kk kn mp kr mq kv mr kz ms mt mu mv bi translated">在终端的项目目录中，使用AWS Amplify CLI启动Amazon Pinpoint控制台:<em class="la"> $ amplify analytics console </em></li><li id="7983" class="mn mo iq ke b kf nd kj ne kn nf kr ng kv nh kz ms mt mu mv bi translated">在导航菜单中，选择<strong class="ke ir">活动</strong>。</li><li id="6506" class="mn mo iq ke b kf nd kj ne kn nf kr ng kv nh kz ms mt mu mv bi translated">选择<strong class="ke ir">新战役</strong>。</li><li id="a2d8" class="mn mo iq ke b kf nd kj ne kn nf kr ng kv nh kz ms mt mu mv bi translated">如图所示，完成四个步骤。</li></ol><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/eb9003ace3fd4bac586612a0fe2af186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1BlMq6L4UtzsIidAHoCOuQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建新的活动</figcaption></figure><h2 id="8443" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">指定段</h2><ol class=""><li id="a893" class="mn mo iq ke b kf mc kj md kn nj kr nk kv nl kz ms mt mu mv bi translated">在段下，选择<strong class="ke ir">创建一个新段</strong>。</li></ol><p id="7906" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2.为段提供一个可选名称，以便以后重用。</p><p id="fc7b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">3.对于<strong class="ke ir">按标准属性过滤</strong>，定义哪些用户正在使用型号为&gt;的iPhone X。您在这里看到的(2)个“iPhone”设备表示尚未使用第2部分中的代码进行更新的应用程序，因此我们只知道这些用户使用的是iPhone。多无聊啊？！</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/79020f614f0bc216c3ba7f6b7b4a16eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jxdcb-r-yPaqUNPARCvo_A.png"/></div></div></figure><p id="0b9a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">4.保持0%不变。</p><p id="c420" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">5.选择<strong class="ke ir">下一步</strong>。</p><h2 id="5c4d" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">撰写并发送消息</h2><p id="c256" class="pw-post-body-paragraph kc kd iq ke b kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz ij bi translated">选择交易并输入shore SMS消息，然后选择下一步。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/31731f11e7351740b9936bd346f3214a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SKA7tixljx3O3H_6Fyr89w.png"/></div></div></figure><p id="3070" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">立即发送<strong class="ke ir"/>。选择<strong class="ke ir">下一步</strong>。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/e57713583da6ac52449b045f2100331e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWHL18O-s2kK8Bsz48oA5Q.png"/></div></div></figure><p id="2173" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">选择<strong class="ke ir">发起活动</strong>。</p><p id="7221" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您应该可以在任何安装了您的应用程序并提供了电话号码的iPhone X上立即看到结果:</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a1560b444483a1e6bfb4dd8cd98f6779.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*odBwR5hUXkJ6KDQs_oRAHg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来自亚马逊Pinpoint的短代码短信</figcaption></figure><h2 id="518f" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">最后的想法</h2><p id="2cc5" class="pw-post-body-paragraph kc kd iq ke b kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz ij bi translated">在本文中，我们使用Amplify CLI在Amazon Pinpoint应用程序中启用了SMS消息传递。然后，我们创建了一个新的精确定位活动，将我们的iPhone X作为目标受众，并向这些用户发送有针对性的短信。这就是我的收集用户分析、添加自定义人口统计数据和对这些用户进行细分的3部分系列的结论，这样我们就可以利用相关信息锁定用户。请留下你的评论或建议，告诉我们你将来想在这里阅读的内容。感谢阅读！</p><h2 id="6528" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kn ls lt lu kr lv lw lx kv ly lz ma mb bi translated">资源</h2><p id="7ae4" class="pw-post-body-paragraph kc kd iq ke b kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz ij bi translated"><a class="ae lb" href="https://aws-amplify.github.io/media/get_started?utm_source=da&amp;utm_medium=blog&amp;utm_campaign=denhills&amp;utm_term=ios_native" rel="noopener ugc nofollow" target="_blank"> AWS Amplify CLI </a></p></div></div>    
</body>
</html>
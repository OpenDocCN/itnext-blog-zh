<html>
<head>
<title>How to Create a Half Circle Progress Bar</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建半圆进度条</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-a-half-circle-progress-bar-10d22e2d4b29?source=collection_archive---------3-----------------------#2022-10-16">https://itnext.io/how-to-create-a-half-circle-progress-bar-10d22e2d4b29?source=collection_archive---------3-----------------------#2022-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="33ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我敢打赌，你们都遇到过这样的情况，当一个设计师做了一个看起来很酷的UI时，你只是想“很酷，但是如何实现它”。当a在Figma看到这个进度条时，我也遇到了同样的情况。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/5c29a42e61aad64663c56b96a310d269.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*75IcrkqXF0hdboTG0AJGRg.gif"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">它看起来像什么</figcaption></figure><p id="ff04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好的一面是，在Flutter中创建自定义视图非常容易，它们在每个平台上都很棒，但有时你只需要记住你在几何和数学课上学到的所有这些东西。<em class="kx">是的，我们并不总是像某些人想的那样改变按钮的颜色:)</em></p><h1 id="add6" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">一点点几何学</h1><p id="6071" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们想一想要实现进度条需要做些什么。首先，我们必须找到一种方法来理解半圆上应该有多少个点。其次，如何在上面放置这些点。</p><h2 id="c031" class="mb kz iq bd la mc md dn le me mf dp li jy mg mh lm kc mi mj lq kg mk ml lu mm bi translated">计算点数</h2><p id="e936" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们从简单的开始，如果我们有一条直线，我们需要计算它可以拟合多少个点。答案是你用线的长度除以圆点的直径，然后在它们之间添加填充。就这样了。</p><p id="104a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们做同样的事情，但是用一个圆。如果你知道圆的半径，我们就能求出它的长度。公式是<code class="fe mn mo mp mq b">2 * pi * r</code>，但是我们只需要它的一半，所以对我们来说，公式将是:</p><pre class="km kn ko kp gt mr mq ms mt aw mu bi"><span id="d459" class="mb kz iq mq b gy mv mw l mx my">lineLength = pi * r</span></pre><p id="bfb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们知道点的大小(半径或直径)和它们之间的间距，所以我们可以简单地用线的长度除以带间距的点的大小。所以我们有这样一个公式:</p><pre class="km kn ko kp gt mr mq ms mt aw mu bi"><span id="0c51" class="mb kz iq mq b gy mv mw l mx my">dotsNumber = floor(<!-- -->lineLength<!-- --> / (dot<!-- -->Diameter<!-- --> + dotsSpacing))</span></pre><p id="ae19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们用floor是因为我们不能画，比如说，点的一半。</p><h2 id="68f3" class="mb kz iq bd la mc md dn le me mf dp li jy mg mh lm kc mi mj lq kg mk ml lu mm bi translated">在圆上放置点</h2><p id="b4cc" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">如果我们有一条线，就很容易把点放在上面。我们将从0开始，并在画完点后添加<code class="fe mn mo mp mq b">dotDiameter + dotsSpacing</code>。</p><p id="4987" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不幸的是，在我们的情况下，我们不能这样做。为了在圆上放置点，我们将使用极坐标，并将指定两个坐标:<br/> 1。圆点离圆心有多远(<strong class="jp ir"> r) </strong>，<br/> 2。圆点的角度<strong class="jp ir"> <em class="kx"> (θ) </em> </strong>。</p><p id="d82e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了这些坐标，我们可以很容易地把它们转换成笛卡尔坐标，然后再画。这些公式是:</p><pre class="km kn ko kp gt mr mq ms mt aw mu bi"><span id="f667" class="mb kz iq mq b gy mv mw l mx my">x = circleRadius * sin(dotAngle) + circleCenterX<br/>y = circleRadius * cos(dotAngle) + circleCenterY</span></pre><h1 id="e752" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">履行</h1><p id="a6d2" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们已经具备了开始实现进度条的一切条件。我们将使用一个<code class="fe mn mo mp mq b">CustomPainter</code>类在画布上绘制视图。</p><h2 id="5232" class="mb kz iq bd la mc md dn le me mf dp li jy mg mh lm kc mi mj lq kg mk ml lu mm bi translated">画家们</h2><p id="9c9e" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们添加我们需要的所有参数，并实现<code class="fe mn mo mp mq b">CustomPainter</code>需要的方法，但不实现<code class="fe mn mo mp mq b">paint</code>方法。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="2472" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们有自定义进度条的参数，比如点的颜色、点和层之间的间距以及第一个(内)圆的半径。还有，我们创建画师，所以我们不会在绘画方法中每次都实例化他们。</p><p id="cb8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不要忘记实现<code class="fe mn mo mp mq b">shouldRepaint</code>方法，这样一旦其中一个参数改变，视图就会被重新绘制。</p><h2 id="d916" class="mb kz iq bd la mc md dn le me mf dp li jy mg mh lm kc mi mj lq kg mk ml lu mm bi translated">画第一个圆</h2><p id="98c1" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们实现用点画圆的<code class="fe mn mo mp mq b">paint</code>方法。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="075c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们得到了圆心，计算出了圆上有多少个点以及它们之间的角度。</p><p id="c74c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里重要的是，我们从270°角(<code class="fe mn mo mp mq b">_startAngle</code>)开始画点，因为我们希望第一个点在左下角并顺时针移动。</p><p id="67f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，看看我们如何计算有多少点应该有不同的(进展)颜色。</p><h2 id="f80f" class="mb kz iq bd la mc md dn le me mf dp li jy mg mh lm kc mi mj lq kg mk ml lu mm bi translated">绘制更多图层</h2><p id="4851" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">最后就是多加几层。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e422" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">增加了一个for-loop，对于每一个刻度，我们只是通过增加圆点的直径和层与层之间的间距来增加圆的半径。</p><h1 id="0c49" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">包装它</h1><p id="4a20" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">你可以用<code class="fe mn mo mp mq b">CustomPaint</code>小部件包装你的<code class="fe mn mo mp mq b">CustomPainter</code>来使用它，但是我认为这不是用户友好的。所以让我们用我们的小部件来包装画师。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e693" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个小部件，它封装了关于画师的一些东西，并为必需的参数添加了默认值。这里重要的是我们为<code class="fe mn mo mp mq b">CustomPaint</code>增加了大小，这样<code class="fe mn mo mp mq b">Painter</code>就知道画布的大小，并且小部件可以被正确定位，例如，在<code class="fe mn mo mp mq b">Stack</code>小部件中。</p><p id="f3df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另外，添加了<code class="fe mn mo mp mq b">ClipRect</code>来剪切父小部件之外的所有内容。当父窗口小部件小于绘制进度条所需的尺寸时，就会发生这种情况。</p><p id="b8f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">—</p><p id="d949" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这些了:)有什么意见或建议可以随时补充分享，发现有帮助就鼓掌！</p><p id="3d61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是资源库的链接—<a class="ae nb" href="https://github.com/ValeryPonomarenko/flutter-half-circle-progress-bar" rel="noopener ugc nofollow" target="_blank">https://github . com/valeryponoparenko/flutter-half-circle-progress-bar</a></p></div></div>    
</body>
</html>
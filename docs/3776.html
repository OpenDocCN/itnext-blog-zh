<html>
<head>
<title>Blazor live reload preview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Blazor实时重装预览</h1>
<blockquote>原文：<a href="https://itnext.io/blazor-live-reload-preview-4505015fd589?source=collection_archive---------1-----------------------#2020-02-23">https://itnext.io/blazor-live-reload-preview-4505015fd589?source=collection_archive---------1-----------------------#2020-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b3c8f7b013cdb970d1676fd41c2ac892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mc3CleeQ0b6eXf4Le6owNg.gif"/></div></div></figure><p id="6c02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在react中，我们有热模块替换功能，该功能允许我们更改代码，并在您的浏览器中立即看到更改。我们可以使用Roslyn编译器在blazor中创建一个类似的特性。在运行时编译razor组件，并使用文件监视器在每次文件更改时使用WebSockets。</p><h1 id="f143" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">它是如何工作的</h1><p id="063d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">它使用razor引擎版本3将组件编译成c#类。然后我用罗斯林编译器把这些类编译成汇编。最后，我使用反射从一个程序集中加载app.razor组件，并使用Steve Sanderson测试主机修改的库将组件转换为普通HTML。为了实时提供HTML文件，我使用WebSockets进行全双工通信。</p><h1 id="6d0e" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">怎么会更好呢？！</h1><p id="a436" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">修复路由而不是使用/preview，这可以通过将WebSocket客户端注入到每个HTTP请求上下文中来实现。</p><p id="f97b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用两个构建服务器，一个用于快速预览，另一个带有dotnet watch build的服务器用于真正更长的构建。</p><p id="7c9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Blazor web assembly中，也许我们可以在浏览器中加载和卸载程序集？</p><h1 id="6a9a" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">安装</h1><p id="7881" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">1.添加包:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="fde9" class="mi kx iq me b gy mj mk l ml mm">dotnet add package RazorComponentsPreview</span></pre><p id="718f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.添加到启动:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="c735" class="mi kx iq me b gy mj mk l ml mm">services.AddRazorComponentsRuntimeCompilation();<br/>app.UseRazorComponentsRuntimeCompilation();</span></pre><p id="ca55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.运行项目转到/预览并更改razor文件组件</p><p id="05fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">来源:https://github.com/martasp/BlazorLiveReload</p></div></div>    
</body>
</html>
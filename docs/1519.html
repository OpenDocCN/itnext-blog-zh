<html>
<head>
<title>Monitoring With Prometheus Using Ansible</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Ansible通过Prometheus进行监控</h1>
<blockquote>原文：<a href="https://itnext.io/monitoring-with-prometheus-using-ansible-812bf710ef43?source=collection_archive---------0-----------------------#2018-11-12">https://itnext.io/monitoring-with-prometheus-using-ansible-812bf710ef43?source=collection_archive---------0-----------------------#2018-11-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c6424f5e16afb7b8419c62e319156a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JN3ElLD0ixB6VR6W"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@chrisliverani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·利维拉尼</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上“打开平板显示器”</figcaption></figure><p id="3999" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你最糟糕的噩梦是什么？对我来说，就是当我们的客户访问社交媒体，告诉我们我们的服务中断了，而我们却不知道。为了防止这种情况，我们需要在部署过程中设置监控。希望你们都这样做。监控有助于了解何时出现问题。它有助于调试和了解问题。如果某段时间内CPU或内存使用率上升，它会发出通知。我们希望持续监控我们的实例和服务，以发现行为、CPU使用、内存使用、磁盘空间、网络使用等方面的任何异常。监控使我们能够识别长期趋势、分析性能并看到可视化效果。</p><p id="6dd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">监控包括收集、处理、聚合和显示有关系统的数据，以及基于该数据的警报。这有助于查询错误率、请求持续时间、等待时间等。当我们得到警报时，我们知道什么正在破坏，这表明症状，然后查看进一步的数据有助于找到原因，最终有助于解决问题。</p><p id="9359" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看如何解决监控问题:</p><ol class=""><li id="2328" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">对一些错误发出警报，或者查看错误图表以了解哪里出错了。</li><li id="f122" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">查看图表以确定错误时间范围。</li><li id="43f5" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">调试日志文件以查明该时间段内的错误日志。</li><li id="90a2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">修复错误并确保之后一切正常。</li></ol><p id="dac9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们总结一下为什么需要进行监控:</p><ol class=""><li id="ff9d" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">出现问题时保持警惕。</li><li id="d7a8" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">帮助调查和诊断问题。</li><li id="9c3e" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">使用仪表板帮助可视化系统行为。</li><li id="95bc" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">有助于分析长期趋势。</li><li id="eca6" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">有助于跨多个时间段比较系统行为。</li><li id="9555" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">帮助进行回顾性分析。</li></ol><h1 id="2ec4" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated"><strong class="ak">普罗米修斯</strong></h1><p id="51c8" class="pw-post-body-paragraph kd ke iq kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">Prometheus 是一款基于拉式机制的开源监控工具，可帮助抓取数据、查询数据、使用数据创建仪表板，并根据警报规则提供警报。它支持Prom查询语言来搜索指标。</p><p id="4bea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">普罗米修斯有一个名为普罗米修斯服务器的主要中央组件。它帮助监控被称为目标的服务器。它可以是单个目标，也可以是针对不同指标(如CPU使用率、内存使用率等)进行监控的多个目标。Prometheus server在一段时间间隔内抓取目标，以收集指标并将它们存储在时序数据库中。我们可以对这些数据进行PromQL查询，以获得特定目标的指标。默认情况下，Prometheus会获取关于自己实例的指标。我们可以为不同的第三方系统使用导出器，它们将第三方工具的度量转换为普罗米修斯度量格式。Prometheus提供了自己的可视化仪表板。Prometheus还有一个警报管理器组件，可以通过电子邮件、slack或其他警报工具发送警报。我们可以定义Prometheus服务器读取的规则，并在定义的条件触发时发出警报。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/0e05e83f6c69307536d0079e1581279b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQLI-Uxv07d1PX8jQ290oQ.png"/></div></div></figure><p id="d50d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经谈过出口商，他们提供许多不同组件的信息，如基础设施、数据库、网络服务器等。有很多可用的导出器，两个导出器的例子是<a class="ae kc" href="https://github.com/prometheus/node_exporter" rel="noopener ugc nofollow" target="_blank">节点导出器</a>和<a class="ae kc" href="https://github.com/prometheus/blackbox_exporter" rel="noopener ugc nofollow" target="_blank">黑盒导出器</a>。节点导出器产生关于基础设施的指标，包括CPU、内存、磁盘、网络统计等等。Blackbox exporter通过探测不同协议(如HTTP、HTTPS)上的不同端点来获得可用性、响应时间等指标。在这篇文章中，我们将设置node_exporter和blackbox_exporter来使用Prometheus服务器。</p><p id="84d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们首先使用<a class="ae kc" href="https://www.ansible.com/" rel="noopener ugc nofollow" target="_blank"> Ansible </a>设置普罗米修斯。首先，我们需要创建“prometheus”用户和组，这有助于隔离Prometheus服务器的所有权并提供安全性。该用户不能登录实例，只能在实例内部使用。为了更好地控制，我们在变量文件中定义了所有参数。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="bca6" class="nc lq iq my b gy nd ne l nf ng">- name: Creating prometheus user group<br/>  group: name="{{groupId}}"<br/>  become: true</span><span id="c4a3" class="nc lq iq my b gy nh ne l nf ng">- name: Creating prometheus user<br/>  user:<br/>    name: "{{userId}}"<br/>    group: "{{groupId}}"<br/>    system: yes<br/>    shell: "/sbin/nologin"<br/>    comment: "{{userId}} nologin User"<br/>    createhome: "no"<br/>    state: present</span></pre><p id="9a24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是下载和安装prometheus的所有权给Prometheus用户。安装后，清理安装过程所需的所有临时文件。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="cd36" class="nc lq iq my b gy nd ne l nf ng">- name: Install prometheus<br/>  unarchive:<br/>    src: "<a class="ae kc" href="https://github.com/prometheus/prometheus/releases/download/v{{" rel="noopener ugc nofollow" target="_blank">https://github.com/prometheus/prometheus/releases/download/v{{</a> version }}/prometheus-{{ version }}.linux-amd64.tar.gz"<br/>    dest: /tmp/<br/>    remote_src: yes</span><span id="e4fb" class="nc lq iq my b gy nh ne l nf ng">- name: Copy prometheus file to bin<br/>  copy:<br/>    src: "/tmp/prometheus-{{ version }}.linux-amd64/prometheus"<br/>    dest: "/usr/local/bin/prometheus"<br/>    owner: "{{userId}}"<br/>    group: "{{groupId}}"<br/>    remote_src: yes<br/>    mode: 0755</span><span id="d598" class="nc lq iq my b gy nh ne l nf ng">- name: Delete prometheus tmp folder<br/>  file:<br/>    path: '/tmp/prometheus-{{ version }}.linux-amd64'<br/>    state: absent</span></pre><p id="64ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将复制Prometheus服务器使用的Prometheus配置文件。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="79e2" class="nc lq iq my b gy nd ne l nf ng">- name: config file<br/>  template:<br/>    src: prometheus.conf.j2<br/>    dest: /etc/prometheus/prometheus.conf</span></pre><p id="aa9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们为运行Prometheus做好了一切准备，我们将复制systemctl init文件，这样在每次重新启动时，我们就可以确定Prometheus正在运行。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="c4bc" class="nc lq iq my b gy nd ne l nf ng">- name: Copy systemd init file<br/>  template:<br/>    src: init.service.j2<br/>    dest: /etc/systemd/system/prometheus.service<br/>  notify: systemd_reload</span><span id="fa2f" class="nc lq iq my b gy nh ne l nf ng">- name: Start prometheus service<br/>  service:<br/>    name: prometheus<br/>    state: started<br/>    enabled: yes</span></pre><p id="16bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是启动服务器，这样它就可以根据配置文件开始工作。然后，我们通过在端口9090点击一个HTTP调用并确认我们得到了200个响应来检查它是否在工作。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="eb21" class="nc lq iq my b gy nd ne l nf ng">- name: Check if prometheus is accessible<br/>  uri:<br/>    url: <a class="ae kc" href="http://localhost:9090" rel="noopener ugc nofollow" target="_blank">http://localhost:9090</a><br/>    method: GET<br/>    status_code: 200</span></pre><p id="4596" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了所有这些，我们就有了我们的Prometheus服务器，并从它自己的实例中收集数据。</p><p id="a479" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们希望从其他实例中收集与基础设施相关的指标，为此我们需要在其他实例中设置<strong class="kf ir"> node_exporter </strong>。Prometheus server使用node_exporter从这些实例中收集数据，并使用其仪表板向我们显示详细信息。步骤将类似于我们使用Ansible对Prometheus所做的。</p><p id="7f3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将创建名为“node_exporter”的用户和组，这有助于隔离node_exporter的所有权并提供安全性。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="bc8d" class="nc lq iq my b gy nd ne l nf ng">- name: Creating node_exporter user group<br/>  group: name="{{groupId}}"<br/>  become: true</span><span id="082c" class="nc lq iq my b gy nh ne l nf ng">- name: Creating node_exporter user<br/>  user:<br/>    name: "{{userId}}"<br/>    group: "{{groupId}}"<br/>    system: yes<br/>    shell: "/sbin/nologin"<br/>    comment: "{{userId}} nologin User"<br/>    createhome: "no"<br/>    state: present</span></pre><p id="f77f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是下载并安装node_exporter，方法是将其二进制文件放在路径“/usr/local/bin”中。一旦设置完成，我们删除所有多余的文件。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="0601" class="nc lq iq my b gy nd ne l nf ng">- name: Install prometheus node exporter<br/>  unarchive:<br/>    src: "<a class="ae kc" href="https://github.com/prometheus/node_exporter/releases/download/v{{" rel="noopener ugc nofollow" target="_blank">https://github.com/prometheus/node_exporter/releases/download/v{{</a> version }}/node_exporter-{{ version }}.linux-amd64.tar.gz"<br/>    dest: /tmp/<br/>    remote_src: yes</span><span id="5a62" class="nc lq iq my b gy nh ne l nf ng">- name: Copy prometheus node exporter file to bin<br/>  copy:<br/>    src: "/tmp/node_exporter-{{ version }}.linux-amd64/node_exporter"<br/>    dest: "/usr/local/bin/node_exporter"<br/>    owner: "{{userId}}"<br/>    group: "{{groupId}}"<br/>    remote_src: yes<br/>    mode: 0755</span><span id="6fa0" class="nc lq iq my b gy nh ne l nf ng">- name: Delete node exporter tmp folder<br/>  file:<br/>    path: '/tmp/node_exporter-{{ version }}.linux-amd64'<br/>    state: absent</span></pre><p id="7fcf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每次重新启动时，将systemctl init文件复制到start node_exporter，并启动node_exporter服务，以便它可以开始收集数据。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="6b70" class="nc lq iq my b gy nd ne l nf ng">- name: Copy systemd init file<br/>  template:<br/>    src: init.service.j2<br/>    dest: /etc/systemd/system/node_exporter.service</span><span id="7cc1" class="nc lq iq my b gy nh ne l nf ng">- name: Start node_exporter service<br/>  service:<br/>    name: node_exporter<br/>    state: started<br/>    enabled: yes</span></pre><p id="90c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦一切都完成了，我们将验证它是否按预期工作。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="bee0" class="nc lq iq my b gy nd ne l nf ng">- name: Check if node exporter emits metrics<br/>  uri:<br/>    url: <a class="ae kc" href="http://127.0.0.1:9100/metrics" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:9100/metrics</a><br/>    method: GET<br/>    status_code: 200</span></pre><p id="8641" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们运行了node_exporter，让我们开始运行<strong class="kf ir"> blackbox_exporter </strong>，通过使用HTTP之类的协议探测端点来对不同的服务进行黑盒监控。黑盒导出器通过“/probe”API获取模块和目标URL参数。模块在黑盒配置文件中进行配置，默认配置包括http_2xx模块，该模块执行http探测并成功获得2xx响应。</p><p id="4a09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们已经对Prometheus和node_exporter所做的那样，我们将以同样的方式创建用户和组。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="e0fb" class="nc lq iq my b gy nd ne l nf ng">- name: Creating blackbox_exporter user group<br/>  group: name="{{groupId}}"<br/>  become: true</span><span id="324c" class="nc lq iq my b gy nh ne l nf ng">- name: Creating blackbox_exporter user<br/>  user:<br/>    name: "{{userId}}"<br/>    group: "{{groupId}}"<br/>    system: yes<br/>    shell: "/sbin/nologin"<br/>    comment: "{{userId}} nologin User"<br/>    createhome: "no"<br/>    state: present</span></pre><p id="1fb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是下载并安装blackbox_exporter，把它的二进制文件放到路径“/usr/local/bin”中。一旦设置完成，我们删除所有多余的文件。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="a00f" class="nc lq iq my b gy nd ne l nf ng">- name: Copy prometheus blackbox exporter file to bin<br/>  copy:<br/>    src: "/tmp/blackbox_exporter-{{ version }}.linux-amd64/blackbox_exporter"<br/>    dest: "/usr/local/bin/blackbox_exporter"<br/>    owner: "{{userId}}"<br/>    group: "{{groupId}}"<br/>    remote_src: yes<br/>    mode: 0755</span><span id="0025" class="nc lq iq my b gy nh ne l nf ng">- name: Delete blackbox exporter tmp folder<br/>  file:<br/>    path: '/tmp/blackbox_exporter-{{ version }}.linux-amd64'<br/>    state: absent</span></pre><p id="1570" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后将blackbox配置文件和systemctl init文件复制到各自的目标位置。启动黑盒导出器，以便它可以开始接受请求。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="cda1" class="nc lq iq my b gy nd ne l nf ng">- name: Copy blackbox exporter config file<br/>  template:<br/>    src: blackbox.yml.j2<br/>    dest: /data/blackbox_exporter/blackbox.yml<br/>    owner: "{{userId}}"<br/>    group: "{{groupId}}"</span><span id="003d" class="nc lq iq my b gy nh ne l nf ng">- name: Copy systemd init file<br/>  template:<br/>    src: init.service.j2<br/>    dest: /etc/systemd/system/blackbox_exporter.service<br/>  notify: systemd_reload</span><span id="b12d" class="nc lq iq my b gy nh ne l nf ng">- name: Start blackbox_exporter service<br/>  service:<br/>    name: blackbox_exporter<br/>    state: started<br/>    enabled: yes</span></pre><p id="711c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们验证blackbox_exporter工作正常。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="65ce" class="nc lq iq my b gy nd ne l nf ng">- name: Check if blackbox_exporter is accessible<br/>  uri:<br/>    url: <a class="ae kc" href="http://localhost:9115" rel="noopener ugc nofollow" target="_blank">http://localhost:9115</a><br/>    method: GET<br/>    status_code: 200</span></pre><p id="132b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将为通过blackbox.yml配置文件配置的探测器使用HTTP模块。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="b87c" class="nc lq iq my b gy nd ne l nf ng">modules:<br/>  http_2xx:<br/>    prober: http<br/>    timeout: 5s<br/>    http:<br/>      preferred_ip_protocol: "ipv4"<br/>      valid_http_versions: ["HTTP/1.1", "HTTP/2"]<br/>      valid_status_codes: []<br/>      method: GET</span></pre><p id="c0b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此时，我们在一个实例上运行Prometheus server，在同一个实例上运行blackbox_exporter，在另一个实例上运行node_exporter。我们需要更新Prometheus服务器的配置(在我们的示例中，在http://www.google.com上运行probe ),并重启服务器，以便它可以开始获取数据。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="24de" class="nc lq iq my b gy nd ne l nf ng"><strong class="my ir">prometheus.conf template file</strong><br/>global:<br/>  scrape_interval: 15s</span><span id="c4b5" class="nc lq iq my b gy nh ne l nf ng">scrape_configs:<br/>  - job_name: 'prometheus'<br/>    scrape_interval: 5s<br/>    static_configs:<br/>      - targets: ['localhost:9090']<br/>  - job_name: 'node_exporter'<br/>    scrape_interval: 5s<br/>    static_configs:<br/>      - targets:<br/>      {% for host in groups['all'] %}<br/>      {% if inventory_hostname != host %}<br/>        - '{{ host }}:9100'<br/>      {% endif %}<br/>      {% endfor %}<br/>  - job_name: 'blackbox'<br/>    metrics_path: /probe<br/>    params:<br/>      module: [http_2xx]<br/>    static_configs:<br/>      - targets:<br/>        - http://www.google.com<br/>    relabel_configs:<br/>      - source_labels: [__address__]<br/>        target_label: __param_target<br/>      - source_labels: [__param_target]<br/>        target_label: instance<br/>      - target_label: __address__<br/>        replacement: localhost:9115</span></pre><p id="2e8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们转到Prometheus dashboard，确认一切正常运行。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/c21a6df4dc93c1a639c6fa32fd691f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pVlvBfp3ush5YAqNwc4Mlw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用普罗米修斯监控所有目标</figcaption></figure><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/793db3447b73e8dfd607384c4164df5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g0W52YhRjaAqmpqvmhUdBw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用node_exporter查询所有节点的运行状态</figcaption></figure><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/692ee30b0faeafb543b7bb517c480d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50J_Tyntp11xNTei2ifiMA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用blacbox_exporter探测http://www.google.com<a class="ae kc" href="http://www.google.com" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="1464" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完整的代码可以在这个git资源库中找到:<a class="ae kc" href="https://github.com/MiteshSharma/PrometheusWithAnsible" rel="noopener ugc nofollow" target="_blank">https://github.com/MiteshSharma/PrometheusWithAnsible</a></p><p id="aebd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="nj"> PS:如果你喜欢这篇文章，请用掌声支持它</em> </strong>👏<strong class="kf ir"> <em class="nj">。欢呼</em> </strong></p></div></div>    
</body>
</html>
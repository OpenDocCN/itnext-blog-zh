<html>
<head>
<title>Deploying Jakarta EE 9 applications to Payara using Cargo maven plugin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cargo maven插件将Jakarta EE 9应用程序部署到Payara</h1>
<blockquote>原文：<a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-payara-using-cargo-maven-plugin-d4fff02091cb?source=collection_archive---------0-----------------------#2020-12-05">https://itnext.io/deploying-jakarta-ee-9-applications-to-payara-using-cargo-maven-plugin-d4fff02091cb?source=collection_archive---------0-----------------------#2020-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d4fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Payara社区5.2020.5引入了技术预览功能，可以在Payara服务器和Micro上运行Jakarta EE 9，更多详情请参见<a class="ae kl" href="https://docs.payara.fish/community/docs/5.2020.6/release-notes/release-notes-2020-5.html#_run_jakarta_ee_9_applications_in_tech_preview" rel="noopener ugc nofollow" target="_blank">发布说明</a>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/bbe525b66addc9069a161aebd3e74370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZgar-TMaqJ9r-ovXsLz_A.png"/></div></div></figure><p id="05c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最初，Payara是开源Glassfish的一个分支，但是它包含了一系列Glassfish中没有的新特性。</p><ul class=""><li id="e8ce" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">与现有的Glassfish相比，有许多改进和更快的错误修复</li><li id="7225" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">Java 11(或更高版本)支持</li><li id="aeec" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">内置微配置文件支持，可用于云原生应用</li><li id="508d" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">许多第三方服务集成。</li><li id="27e7" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">全面的文档和技术指南</li><li id="7b0c" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">为付费企业用户提供商业支持。</li></ul><p id="3726" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Payara社区也是开源的，对于开发者来说，你可以用它作为Glassfish的替代来获得更好的开发体验。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="1626" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">先决条件</h1><p id="1523" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">确保您已经安装了以下软件。</p><ul class=""><li id="047c" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">Java 8或Java 11 ( <a class="ae kl" href="https://openjdk.java.net/install/" rel="noopener ugc nofollow" target="_blank"> OpenJDK </a>或<a class="ae kl" href="https://adoptopenjdk.net/installation.html" rel="noopener ugc nofollow" target="_blank"> AdoptOpenJDK </a>)</li><li id="e58b" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><a class="ae kl" href="https://www.payara.fish/downloads/payara-platform-community-edition/" rel="noopener ugc nofollow" target="_blank"> Payara社区5.2020.6 </a></li><li id="e89c" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><a class="ae kl" href="http://maven.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇Maven </a></li><li id="6ab4" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">了解<a class="ae kl" href="https://codehaus-cargo.github.io/" rel="noopener ugc nofollow" target="_blank"> Cargo maven插件</a>的基础。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="6ff2" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">部署到本地Payara服务器</h1><p id="9374" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">Cargo maven插件为payara服务器提供了一个单独的<strong class="jp ir"> payara </strong>容器。</p><p id="a624" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设您已经下载了一份<a class="ae kl" href="https://www.payara.fish/downloads/payara-platform-community-edition/" rel="noopener ugc nofollow" target="_blank"> Payara Community dist </a>，并将文件解压到您的本地磁盘中。</p><p id="cbd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<em class="mw"> pom.xml </em>中添加以下配置，以使用现有的Payara域配置在本地Payara服务器上运行Jakarta EE 9应用程序。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="754b" class="nc lu iq my b gy nd ne l nf ng">&lt;properties&gt;<br/>	&lt;glassfish.home&gt;[ Payara install dir]&lt;/glassfish.home&gt;<br/>	&lt;glassfish.domainDir&gt;${glassfish.home}/glassfish/domains&lt;/glassfish.domainDir&gt;<br/>	&lt;glassfish.domainName&gt;domain1&lt;/glassfish.domainName&gt;<br/>&lt;/properties&gt;<br/>&lt;build&gt;<br/>	&lt;plugins&gt;<br/>		&lt;plugin&gt;<br/>			&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>			&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>			&lt;configuration&gt;<br/>				&lt;container&gt;<br/>					&lt;containerId&gt;payara&lt;/containerId&gt;<br/>					&lt;type&gt;installed&lt;/type&gt;<br/>					&lt;home&gt;${glassfish.home}&lt;/home&gt;<br/>				&lt;/container&gt;<br/>				&lt;configuration&gt;<br/>					&lt;type&gt;existing&lt;/type&gt;<br/>					&lt;home&gt;${glassfish.domainDir}&lt;/home&gt;<br/>					&lt;properties&gt;<br/>						&lt;cargo.glassfish.domain.name&gt;${glassfish.domainName}&lt;/cargo.glassfish.domain.name&gt;<br/>						&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br/>					&lt;/properties&gt;<br/>				&lt;/configuration&gt;<br/>			&lt;/configuration&gt;<br/>		&lt;/plugin&gt;<br/>	&lt;/plugins&gt;<br/>&lt;/build&gt;</span></pre><p id="d3b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的配置几乎与我们在<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/docs/deploy-cargo.md" rel="noopener ugc nofollow" target="_blank">之前的Glassfish帖子</a>中讨论的配置相同，但是我们在这里使用了containerId <strong class="jp ir"> payara </strong>。</p><p id="c583" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开终端，执行以下命令在Payara服务器上运行您的应用程序。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="96cf" class="nc lu iq my b gy nd ne l nf ng">mvn clean package cargo:run -Ppayara-local</span></pre><p id="5a64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述命令将执行一系列任务。</p><ul class=""><li id="36a7" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">构建项目，并将其打包到<em class="mw">目标</em>文件夹中的war档案中</li><li id="1685" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">使用现有的<em class="mw">域1 </em>配置启动Payara服务器</li><li id="f87a" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">将打包的war部署到正在运行的服务器</li></ul><p id="33d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您希望每次都使用刷新域配置来运行您的应用程序，请尝试将配置<code class="fe nh ni nj my b">type</code>设置为<strong class="jp ir">独立</strong>。将服务器<em class="mw">配置</em>部分更改为以下内容。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="8ae9" class="nc lu iq my b gy nd ne l nf ng">&lt;configuration&gt;<br/>    &lt;type&gt;standalone&lt;/type&gt;<br/>    &lt;properties&gt;<br/>        &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br/>    &lt;/properties&gt;<br/>&lt;/configuration&gt;</span></pre><p id="e108" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与现有的配置略有不同，它将在<em class="mw">目标</em>文件夹中创建一个新的域配置，而不是Payara服务器中的默认<em class="mw">域1 </em>。</p><p id="e695" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在CI服务中，比如Github actions，我想使用官方的<code class="fe nh ni nj my b">maven-dependency-plugin</code>来准备Payara服务器的刷新副本。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="5ab4" class="nc lu iq my b gy nd ne l nf ng">&lt;plugin&gt;<br/>    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;<br/>    &lt;executions&gt;<br/>        &lt;execution&gt;<br/>            &lt;id&gt;unpack&lt;/id&gt;<br/>            &lt;phase&gt;process-resources&lt;/phase&gt;<br/>            &lt;goals&gt;<br/>                &lt;goal&gt;unpack&lt;/goal&gt;<br/>            &lt;/goals&gt;<br/>            &lt;configuration&gt;<br/>                &lt;artifactItems&gt;<br/>                    &lt;artifactItem&gt;<br/>                        &lt;groupId&gt;fish.payara.distributions&lt;/groupId&gt;<br/>                        &lt;artifactId&gt;payara&lt;/artifactId&gt;<br/>                        &lt;version&gt;${payara.version}&lt;/version&gt;<br/>                        &lt;type&gt;zip&lt;/type&gt;<br/>                        &lt;overWrite&gt;false&lt;/overWrite&gt;<br/>                        &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;<br/>                    &lt;/artifactItem&gt;<br/>                &lt;/artifactItems&gt;<br/>            &lt;/configuration&gt;<br/>        &lt;/execution&gt;<br/>    &lt;/executions&gt;<br/>&lt;/plugin&gt;</span></pre><p id="c5d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<code class="fe nh ni nj my b">glassfish.home</code>属性更改为以下内容。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="769a" class="nc lu iq my b gy nd ne l nf ng">&lt;glassfish.home&gt;${project.build.directory}/payara5&lt;/glassfish.home&gt;</span></pre><p id="d2b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要停止服务器，只需向正在运行的控制台发送一个<code class="fe nh ni nj my b">CTRL+C</code>来停止它。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="a689" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">部署到正在运行的Payara服务器</h1><p id="d979" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">使用远程部署器和运行时配置，您可以使用Cargo maven插件将应用程序部署到正在运行的Payara，esp。Payara服务器位于远程服务器中。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="6e5d" class="nc lu iq my b gy nd ne l nf ng">&lt;plugin&gt;<br/>	&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>	&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>	&lt;configuration&gt;<br/>		&lt;container&gt;<br/>			&lt;containerId&gt;payara&lt;/containerId&gt;<br/>			&lt;type&gt;remote&lt;/type&gt;<br/>		&lt;/container&gt;<br/>		&lt;configuration&gt;<br/>			&lt;type&gt;runtime&lt;/type&gt;<br/>			&lt;properties&gt;<br/>				&lt;cargo.remote.username&gt;admin&lt;/cargo.remote.username&gt;<br/>				&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br/>				&lt;cargo.glassfish.admin.port&gt;4848&lt;/cargo.glassfish.admin.port&gt;<br/>				&lt;cargo.hostname&gt;localhost&lt;/cargo.hostname&gt;<br/>			&lt;/properties&gt;<br/>		&lt;/configuration&gt;<br/>	&lt;/configuration&gt;<br/>	&lt;!-- provides JSR88 client API to deploy on Glassfish/Payara Server --&gt;<br/>	&lt;dependencies&gt;<br/>		&lt;dependency&gt;<br/>			&lt;groupId&gt;org.glassfish.main.deployment&lt;/groupId&gt;<br/>			&lt;artifactId&gt;deployment-client&lt;/artifactId&gt;<br/>			&lt;version&gt;5.1.0&lt;/version&gt;<br/>			&lt;!--&lt;version&gt;${glassfish.version}&lt;/version&gt;--&gt;<br/>		&lt;/dependency&gt;<br/>	&lt;/dependencies&gt;<br/>&lt;/plugin&gt;</span></pre><p id="4a4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述配置与<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/docs/deploy-cargo.md" rel="noopener ugc nofollow" target="_blank"> Glassfish文档</a>中的配置几乎相同。</p><p id="04f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于远程服务器，您不能启动和停止Payara服务器。在部署应用程序之前，请确保它正在运行并且可以从您的本地环境访问。</p><p id="5643" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe nh ni nj my b">deploy</code>和<code class="fe nh ni nj my b">undeploy</code>目标执行部署和取消部署任务。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="af1e" class="nc lu iq my b gy nd ne l nf ng"># deploy applications<br/>mvn clean package cargo:deploy -Ppayara-remote</span><span id="c88a" class="nc lu iq my b gy nk ne l nf ng"># undeploy<br/>mvn cargo:undeploy -Ppayara-remote</span></pre></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="efd5" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">验证部署的应用程序</h1><p id="2107" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">当应用程序成功部署后，使用<code class="fe nh ni nj my b">curl</code>来验证部署的应用程序是否。</p><pre class="kn ko kp kq gt mx my mz na aw nb bi"><span id="b85c" class="nc lu iq my b gy nd ne l nf ng">curl <a class="ae kl" href="http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy</a><br/>{"message":"Say Hello to Hantsy at 2020-11-14T15:56:10.099"}</span></pre><blockquote class="nl nm nn"><p id="711d" class="jn jo mw jp b jq jr js jt ju jv jw jx no jz ka kb np kd ke kf nq kh ki kj kk ij bi translated"><em class="iq">注:事实上，您可以使用</em> <code class="fe nh ni nj my b"><em class="iq">glassfish5x</em></code> <em class="iq"> containerId将Jakarta EE 9应用程序部署到Payara服务器，反过来，我认为使用</em> <code class="fe nh ni nj my b"><em class="iq">payara</em></code> <em class="iq"> containerId将应用程序部署到Glassfish v6也是可以的。</em></p></blockquote><p id="5895" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从我的github中抓取<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate/" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p></div></div>    
</body>
</html>
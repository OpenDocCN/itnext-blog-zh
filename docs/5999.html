<html>
<head>
<title>Handsfree Websites</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">免提网站</h1>
<blockquote>原文：<a href="https://itnext.io/handsfree-websites-10d03ffbe85d?source=collection_archive---------2-----------------------#2021-07-22">https://itnext.io/handsfree-websites-10d03ffbe85d?source=collection_archive---------2-----------------------#2021-07-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c400" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在很多设备都可以通过语音控制和/或查询，比如我的装有Windows Cortana的笔记本电脑，我的装有Siri的iPhone，还有我车上的语音指令。其实语音识别技术并不新鲜。IBM鞋盒在1961年就已经能够识别语音了。当然，随着云的出现，这项技术已经得到了很大的改进，并且更加可用。</p><p id="90fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定进行调查，并用HTML5/JavaScript创建了一个简单的单页网站，我可以通过语音进行控制。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/abf5f7d4d4ea408aa6cfe4272e740116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUSbJMpK1wpDlj05om7auQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">【windows.net蔚蓝语音服务公司(T2)】T3</figcaption></figure><p id="eff0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">蔚蓝语音服务</strong></p><p id="4e4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">微软Azure云提供了几种认知服务。有了这个API集合，作为开发人员的您就拥有了现成的智能。对于我的项目，我使用语音到文本的API。</p><p id="cf6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用这个API，你显然需要一个Azure订阅。</p><p id="2e01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如下面的动画所示，订阅API很容易。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/a54bcb85b50c05ff9f0a1a51c7db9c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ln7-hBWvkFiDLUZWgPCePg.gif"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">Azure门户</figcaption></figure><p id="4977" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在API刀片中，导航到资源管理下的密钥和端点。在这里，您复制了一个可用的授权密钥，您需要使用API上的应用程序对其进行授权以交换数据。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/1674936413cec51a4cd46c6d13709e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sB4IOW1SBp-dvEFJJWH9hA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">Azure门户</figcaption></figure><p id="f492" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Azure认知服务SDK </strong></p><p id="91d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用语音到文本API，您可以轻松地将语音识别添加到您的应用程序中，并将语音音频转换为文本。这个API的SDK可以从产品网站<a class="ae kl" href="https://aka.ms/csspeech" rel="noopener ugc nofollow" target="_blank">https://aka.ms/csspeech</a>下载或者通过NuGet包安装。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="d2bc" class="li lj iq le b gy lk ll l lm ln">PM&gt; Install-Package Microsoft.CognitiveServices.Speech -Version 1.18.0</span></pre><p id="380d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦SDK被添加到您的项目中，您就可以在HTML页面的底部引用包含所有特性的JavaScript文件。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="60cf" class="li lj iq le b gy lk ll l lm ln">&lt;!-- Speech SDK reference sdk. --&gt;<br/>&lt;script src="js/microsoft.cognitiveservices.speech.sdk.bundle-min.js"&gt;&lt;/script&gt;</span></pre><p id="eca9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">语音转文字</strong></p><p id="d8c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的HTML项目中，我添加了一个带有id标签的(麦克风)图像按钮。此按钮的功能相当于录音按钮。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="ac4b" class="li lj iq le b gy lk ll l lm ln">&lt;img class="img-fluid img-profile rounded-circle mx-auto mb-2 ready" src="img/mic.svg" width="160" id="startRecognizeOnceAsyncButton" alt="Press to listen!"&gt;</span></pre><p id="4bf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我为我的功能创建了一个新的JavaScript文件，并在HTML页面底部的HTML文件中创建了一个引用。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="0d51" class="li lj iq le b gy lk ll l lm ln">&lt;!-- Custom scripts for this template --&gt;<br/>&lt;script src="js/speech.js"&gt;&lt;/script&gt;</span></pre><p id="a08c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我在文件中声明必要的变量。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="6138" class="li lj iq le b gy lk ll l lm ln">var subscriptionKey = "{your-api-key}";<br/>var serviceRegion = "westeurope";</span></pre><p id="9f31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该API支持多种语言。我选择英语，因为荷兰语模型还没有得到足够的训练，因此不太可靠。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="4dc7" class="li lj iq le b gy lk ll l lm ln">var speechRecognitionLanguage = "en-US";</span></pre><p id="829e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，我向先前创建的image按钮添加了一个事件侦听器(在页面完全加载之后)。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="b8ba" class="li lj iq le b gy lk ll l lm ln">document.addEventListener("DOMContentLoaded", function () {</span><span id="b4e4" class="li lj iq le b gy lo ll l lm ln">    startRecognizeOnceAsyncButton = document<br/>         .getElementById("startRecognizeOnceAsyncButton");</span><span id="f9e0" class="li lj iq le b gy lo ll l lm ln">    phraseDiv = document.getElementById("phraseDiv");<br/> <br/>    startRecognizeOnceAsyncButton<br/>         .addEventListener("click", function () {</span></pre><p id="803c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我配置我的客户端。我请求一个授权令牌，并确定提供给API的语言。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="fef9" class="li lj iq le b gy lk ll l lm ln">startRecognizeOnceAsyncButton.disabled = true;<br/>startRecognizeOnceAsyncButton.classList.add("record");<br/>phraseDiv.innerHTML = "";<br/> <br/>// if we got an authorization token, use the token. <br/>// Otherwise use the provided subscription key</span><span id="bf44" class="li lj iq le b gy lo ll l lm ln">var speechConfig;<br/>if (authorizationToken) {<br/>    speechConfig = SpeechSDK.SpeechConfig<br/>         .fromAuthorizationToken(authorizationToken, serviceRegion);<br/>} else {<br/>    speechConfig = SpeechSDK.SpeechConfig<br/>         .fromSubscription(subscriptionKey, serviceRegion);<br/>}<br/> <br/>speechConfig.speechRecognitionLanguage = speechRecognitionLanguage;</span></pre><p id="d387" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过两种方式传递音频:通过文件或通过麦克风。我选择后者。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="2b78" class="li lj iq le b gy lk ll l lm ln">var audioConfig = SpeechSDK.AudioConfig<br/>     .fromDefaultMicrophoneInput();</span></pre><p id="42b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了让网站知道何时发出语音命令，我选择了一个受其他语音助手启发的公告:<em class="lp">“嘿LINKIT”</em>。在我的场景中，我的叙述作为音频发送给API。API返回一个文本作为响应。我检查命令是否是通过正则表达式模式给出的。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="8c01" class="li lj iq le b gy lk ll l lm ln">let commandReg = /^hey link it|hey link, it/i;</span><span id="7434" class="li lj iq le b gy lo ll l lm ln">recognizer = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);<br/> <br/>    recognizer.recognizeOnceAsync(<br/>        function (result) {<br/> <br/>            startRecognizeOnceAsyncButton.disabled = false;<br/>            startRecognizeOnceAsyncButton<br/>                 .classList.remove("record");<br/>            startRecognizeOnceAsyncButton.classList.add("ready");<br/> <br/>            if (commandReg.test(result.text)) {<br/>                voiceCommand(result.text);<br/>            }<br/> <br/>            phraseDiv.innerHTML += result.text;<br/>            console.log(result);<br/> <br/>            recognizer.close();<br/>            recognizer = undefined;<br/> <br/>        },<br/>        function (err) {<br/>            recognizer.close();<br/>            recognizer = undefined;<br/>            startRecognizeOnceAsyncButton.disabled = false;<br/>            startRecognizeOnceAsyncButton<br/>                 .classList.remove("record");<br/> <br/>            phraseDiv.innerHTML += err;<br/>            console.log(err);<br/>        });<br/>});</span></pre><p id="7970" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当文本以<em class="lp">“嘿LINKIT”</em>开头时，我的JavaScript函数voiceCommand被调用。</p><p id="05a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">语音命令</strong></p><p id="6f2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我构建了两个不同的命令。因此，该函数首先确定意图:用户给出了哪个命令？</p><p id="8a89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一次意图导航:<em class="lp">滚动到</em>。第二个操纵布局:<em class="lp">改</em>。</p><p id="7bbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">“Hey LINKIT”</em>公告删除后，意向确定。</p><p id="5deb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，该命令被删除，留下意图参数。在下面的代码中，我操纵我的DOM来改变颜色:变成灰色或黑色——或者——我的按钮变成圆形或方形。</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="b072" class="li lj iq le b gy lk ll l lm ln">function voiceCommand(command) {<br/>    command = command<br/>        .replace(commandReg, "")<br/>        .replace(",", "")<br/>        .toLowerCase();<br/>    console.log("command:" + command);<br/> <br/>    if (command.includes("go to") || command.includes("goto")) {<br/>        command = command.replace("go", "")<br/>                         .replace("to", "")<br/>                         .replace(".", "")<br/>                         .replace(/ /g, '');<br/> <br/>        var selector = "a[href='#" + command.toLowerCase() + "']";<br/>        console.log("navigate to:" + selector);<br/> <br/>        var hyperlink = document.querySelectorAll(selector)[0];<br/> <br/>        if (!!hyperlink) {<br/>            hyperlink.click();<br/>            console.log("Click");<br/>        }<br/>    }<br/> <br/>    if (command.includes("change to") ||<br/>         command.includes("changeto") || <br/>         command.includes("changed to") || <br/>         command.includes("changedto")) {</span><span id="e818" class="li lj iq le b gy lo ll l lm ln">        var commandOption = command.replace("changed", "")<br/>                         .replace("change", "")<br/>                         .replace("to", "")<br/>                         .replace(".", "")<br/>                         .replace(/ /g, '');<br/> <br/>        console.log("change to:" + commandOption);<br/> <br/>        switch (commandOption) {<br/>            case "gray":<br/>                document.getElementById("sideNav")<br/>                     .classList.remove('bg-primary');<br/>                document.getElementById("sideNav")<br/>                     .classList.add('gray');<br/>                break;<br/>            case "black":<br/>                document.getElementById("sideNav")<br/>                     .classList.remove('gray');<br/>                document.getElementById("sideNav")<br/>                     .classList.add('bg-primary');<br/>                break;<br/>            case "square":<br/>                document<br/>                    .getElementById("startRecognizeOnceAsyncButton")<br/>                    .classList.remove('rounded-circle');<br/>                break;<br/>            case "circle":<br/>                document<br/>                    .getElementById("startRecognizeOnceAsyncButton")<br/>                    .classList.add('rounded-circle');<br/>                break;<br/>            default:<br/>                console.log("command option unknown: " <br/>                     + commandOption);<br/>                break;<br/>        }<br/>    }<br/>}</span></pre><p id="f17f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出版后，我访问我的网站<a class="ae kl" href="https://itnextspeechst.z13.web.core.windows.net/" rel="noopener ugc nofollow" target="_blank"> Azure语音服务(windows.net)</a>。使用我的麦克风时需要SSL/https连接。当我单击“录制”按钮时，我的浏览器会请求一次许可。然后我可以测试我的命令。而且很管用！</p><p id="d59f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">环境噪音、清晰度和糟糕的麦克风有时会影响工作，但在不久的将来肯定会变得更好。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lq"><img src="../Images/0035b1e3a4798e78700ecf4496ce80cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zgcNlrNsDo1t4JWlKpV0Q.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated"><a class="ae kl" href="https://itnextspeechst.z13.web.core.windows.net/" rel="noopener ugc nofollow" target="_blank"> Azure语音服务(windows.net)</a></figcaption></figure><p id="d605" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果奏效了。我按下麦克风。我的浏览器的录音功能启动。我的网站监听命令，例如:</p><p id="d7e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">“嘿林吉特，换成灰色”</em></p><p id="eafd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">“嘿林吉特，换成方形”</em></p><p id="1639" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">《嘿林吉特，去蔚蓝吧》</em></p><p id="9d74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">“嘿LINKIT，改黑了”</em></p><p id="d549" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">“嘿LINKIT，改圈了”</em></p><p id="c704" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lp">“嗨林吉特去谢谢你”</em></p><p id="7e05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">代码</strong></p><p id="7737" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在<a class="ae kl" href="https://github.com/Bengkel/Bengkel.HandsfreeWebsite" rel="noopener ugc nofollow" target="_blank"> Bengkel/Bengkel下载代码。HandsfreeWebsite(github.com)</a>。</p><p id="a6b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论</strong></p><p id="6ac6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这项研究相当基础。实现很简单。但结果是有效的。我按下麦克风。我的浏览器的录音功能启动。在对着我的麦克风以正确的方式说话的一些实验之后，我的网站监听命令。</p><p id="e4ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要有点创意，你就可以轻松地为你的网站配备语音识别和语音助手。</p></div></div>    
</body>
</html>
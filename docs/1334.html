<html>
<head>
<title>Generating Sitemaps for Bots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为机器人生成站点地图</h1>
<blockquote>原文：<a href="https://itnext.io/generating-sitemaps-for-bots-a9d927f359b1?source=collection_archive---------1-----------------------#2018-09-14">https://itnext.io/generating-sitemaps-for-bots-a9d927f359b1?source=collection_archive---------1-----------------------#2018-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6318" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上一篇关于使用<a class="ae kl" href="https://medium.com/@justindavies/using-rendertron-in-kubernetes-for-spa-seo-39055567c745" rel="noopener"> Rendertron和Kubernetes </a>在服务器端渲染我的React应用程序的文章之后，我需要一种方式来让这些搜索引擎了解内容(即以太坊块的更新解释)。</p><p id="e595" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于<a class="ae kl" href="http://inkl.in" rel="noopener ugc nofollow" target="_blank"> http://inkl.in </a>上的内容会不断更新，每当链上出现新块时，我需要确保爬虫能找到比发生的有机内部链接更容易的东西。</p><p id="871e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入网站地图。</p><p id="a642" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网站地图是一个XML文件，它会提示搜索引擎有它应该查看的内容。我说提示，因为它不会强迫像Google或Bing这样的公司对内容进行索引，但总比什么都没有好。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/f19f3c7a0255a0dbfbaa7ed78b487898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TrFFbACqgLR3SJTJylVJKg.png"/></div></div></figure><p id="bae6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自从把inkl.in网站地图推给谷歌后，我可以看到每天大约有5000个页面被索引，并且有有机的搜索流量访问这个网站。</p><p id="4ad3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">拥有站点上那么多的内容(超过600万个块=超过600万个页面，加上地址的可视化，超过3亿个)的问题是，它不适合一个单一的sitemap XML文件。</p><p id="94cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要解决这个问题，请输入站点地图索引。索引是用于引用所有其他站点地图的另一个XML文件。单个站点地图文件中的数据量是有限制的，即50，000页，最大50Mb。</p><p id="1521" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以需要做两件事，我需要生成一个链接到inklin中所有块的站点地图的站点地图索引。我不会太聪明，因为我不介意丢失几千个404错误。</p><p id="9f2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">inklin API有一个“活动”端点，它将返回关于最新块的数据(包括块号)</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="5859" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我有了这个，我需要做的就是从那里开始递减到块1。</p><p id="823f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将允许be为Google或Bing决定抓取的每个块生成一个sitemap条目。我还需要确保我们为每50，000个条目生成一个新的站点地图文件。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="fc63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，一旦我有了网站地图目录，我需要生成索引。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="696a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们有了完整的代码，我需要构建一个Kubernetes作业(一个一次性的Pod)来运行并每天生成它。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="8d77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你会注意到我定义了一个体积。我使用Azure Files (CIFS文件共享),这样Sitemaps作业可以生成并保存数据。这很重要，因为你的站点地图需要和你的站点来自同一个域。</p><p id="f437" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我修改了前端Pod规范，在NGINX根目录下的/sitemaps下挂载相同的CIFS共享。我知道，我知道，我也可以设置一个入口控制器来分离它，但是我花了一个小时就把它黑在一起了！</p><p id="eb4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的头盔模板现在看起来像这样:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="698e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦完成，每当Sitemaps作业运行时，数据将被刷新，以便Google或Bing决定重新搜索Sitemap索引。这是最终的结果…</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi la"><img src="../Images/e450fb74d358cb639af29e8cec889ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*11gyzRhOBNJWmzbCF6ypNA.png"/></div></div></figure></div></div>    
</body>
</html>
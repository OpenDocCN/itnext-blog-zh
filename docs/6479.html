<html>
<head>
<title>AWS: Trusted Advisor, part 2 — CloudWatch Alarms and Slack notifications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS:可信顾问，第2部分—云监控警报和松弛通知</h1>
<blockquote>原文：<a href="https://itnext.io/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications-95e3213fbadb?source=collection_archive---------2-----------------------#2021-11-29">https://itnext.io/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications-95e3213fbadb?source=collection_archive---------2-----------------------#2021-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/e151e2723d4fa31c63c35d271b991b65.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*IQXKQuuiBB-kvKYDCUSuiQ.png"/></div></figure><p id="3b3f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">继续AWS可信顾问服务的主题，让我们看看如何配置关于新发现的通知。</p><p id="b030" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">第一部分:<a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-1-its-features-overview/" rel="noopener ugc nofollow" target="_blank"> AWS:值得信赖的顾问，第1部分—其功能概述</a>。</p><p id="d17b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要获得通知，我们可以使用来自CloudWatch的可信顾问指标，在<a class="ae ks" href="https://docs.aws.amazon.com/awssupport/latest/user/cloudwatch-metrics-ta.html#trusted-advisor-metrics-dimensions" rel="noopener ugc nofollow" target="_blank">可信顾问指标和维度</a>页面上查看它们的列表。</p><p id="ea15" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，CloudWatch会发出警报，将它们发送到AWS简单通知服务(AWS SNS)。从那里，我们将在Opsgenie中获得警报，并从那里将它们转发到一个Slack通道。</p><p id="6227" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个想法是，一旦有人将创建一个向世界开放的AWS安全组，就可以迅速得到通知。</p><p id="0830" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，在这篇文章中，我们将配置CloudWatch警报，并将它们发送到Slack，并将查看可信顾问如何刷新其数据，以便我们可以每天(或每小时，尽管有一些限制，请参见<a class="ae ks" href="https://rtfm.co.ua/en/?p=27384#Trusted_Advisor_refresh_checks_-_frequency_of_updates" rel="noopener ugc nofollow" target="_blank">可信顾问刷新检查-更新频率</a>部分)收到通知。</p><ul class=""><li id="52b0" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#Opsgenie_configuration" rel="noopener ugc nofollow" target="_blank">通用配置</a></li><li id="4084" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#AWS_Simple_Notification_Service_configuration" rel="noopener ugc nofollow" target="_blank"> AWS简单通知服务配置</a></li><li id="780f" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#AWS_Trusted_Advisor_what_to_monitor" rel="noopener ugc nofollow" target="_blank"> AWS可信顾问:监控什么？</a></li><li id="c15e" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#CloudWatch_Alarms_configuration" rel="noopener ugc nofollow" target="_blank"> CloudWatch警报配置</a></li><li id="4ca3" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#Trusted_Advisor_refresh_checks_-_frequency_of_updates" rel="noopener ugc nofollow" target="_blank">可信顾问刷新检查—更新频率</a></li><li id="825e" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#Trusted_Advisor_-_manual_refresh" rel="noopener ugc nofollow" target="_blank">可信顾问—手动刷新</a></li><li id="6197" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/#Alert_message_in_Slack_configuration" rel="noopener ugc nofollow" target="_blank">松弛配置中的警报消息</a></li></ul><h1 id="02af" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">Opsgenie配置</h1><p id="1955" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">在Opsgenie中，让我们创建一个新的CloudWatch集成，它将用于Trusted Advisor警报。</p><p id="7f45" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">进入Opsgenie <em class="mk">设置&gt;集成、</em>并找到CloudWatch:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ml"><img src="../Images/dc4c11c04373578b84e571b8aea8aa0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G8i0J8cKe1mjeAE8.png"/></div></div></figure><p id="0824" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们把它命名为“<em class="mk">可信安全顾问</em>”:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/77f924979de77f498dd16fe7c1b6dfbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/0*4on2NlknWntWXwEn.png"/></div></figure><p id="c6b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存它，但我们稍后将回到这里配置宽限消息文本。</p><h1 id="05ca" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">AWS简单通知服务配置</h1><p id="f545" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">AWS SNS需要在弗吉尼亚州的<em class="mk"> us-east-1 </em>进行配置，因为一些CloudWatch指标只能在这里获得，因为它是第一个(afaik)也是最老的AWS数据中心。таккакчастьметиикдостукпна此外，我们将在这里配置CloudWatch警报。</p><p id="5455" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">转到sns，使用<em class="mk">standard</em>类型创建一个新主题，将其命名为<em class="mk">ops genie-trusted advisor-security-us-east-1-SNS</em>—在SNS主题的名称中包含一个地区和服务名称似乎是一个好主意:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mv"><img src="../Images/05107de2dd4a2538209569cbcb734dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X5o7VH-HfSvBZV5y.png"/></div></div></figure><p id="374a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">创建主题后，添加订阅:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mw"><img src="../Images/0c3fb8ebeb42a66bd07269c12db01a7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QCHZbB4vdcuSF2Zc.png"/></div></div></figure><p id="4184" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从Opsgenie集成中复制URL:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mx"><img src="../Images/545d456aecc553ab8474453397dd2770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gxcKsgIELP4Y2rZh.png"/></div></div></figure><p id="df13" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">返回到SNS订阅，指定<em class="mk">协议</em> == HTTPS，并插入来自Opsgenie的URL:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi my"><img src="../Images/15b632a824d9612afc9894e810616e62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l61zzboq2J0ouOpk.png"/></div></div></figure><p id="6432" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">省省吧，我们去看云吧。</p><h1 id="b07c" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">AWS可信顾问:监控什么？</h1><p id="49f5" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">在本例中，我们将使用<em class="mk">安全组——特定端口无限制</em>,但一般来说是什么呢？</p><p id="e362" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">转到<a class="ae ks" href="https://docs.aws.amazon.com/awssupport/latest/user/trusted-advisor-check-reference.html" rel="noopener ugc nofollow" target="_blank"> AWS可信顾问检查参考</a>，检查列表，并选择最适合您的。</p><p id="bbcb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">至于我，那些支票似乎是最有趣的:</p><p id="d101" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">成本优化</strong>:</p><ul class=""><li id="fb8b" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated"><em class="mk">亚马逊RDS空闲数据库实例</em></li><li id="7078" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">空载平衡器</em></li><li id="ceb8" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">利用率低的亚马逊EC2实例</em></li><li id="8f32" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">未关联的弹性IP地址</em></li></ul><p id="7ebf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">性能</strong>:</p><ul class=""><li id="5e22" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated"><em class="mk">高利用率亚马逊EC2实例</em></li><li id="d6a2" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">亚马逊EC2到EBS的吞吐量优化</em></li></ul><p id="c654" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">安全</strong>:</p><ul class=""><li id="8fab" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated"><em class="mk">安全组—特定端口无限制</em></li><li id="44e4" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">安全组—无限制访问</em></li><li id="1b60" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">亚马逊S3桶权限</em></li><li id="1c67" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">亚马逊RDS安全组访问风险</em></li><li id="b91d" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk"> ELB安全小组</em></li><li id="ea7c" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated"><em class="mk">暴露的访问键</em></li></ul><p id="5b3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这样做时，请记住，所有可信顾问的调查结果都分为三个严重级别:<em class="mk">绿色</em>、<em class="mk">黄色</em>和<em class="mk">红色</em>。</p><p id="35b4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于<em class="mk">安全组-特定端口无限制</em>，级别由以下标准确定(仅在可信顾问仪表板中找到):</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/8493cdc53c4552a87cb7958c3bb59281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/0*oi597LxvD1HfYZBj.png"/></div></figure><ul class=""><li id="a57d" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated">绿色:对端口80、25、443或465的访问不受限制。</li><li id="75a2" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">红色:对端口20、21、1433、1434、3306、3389、4333、5432或5500的访问不受限制。</li><li id="416e" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">黄色:对任何其他端口的访问不受限制。</li></ul><p id="dc3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，让我们使用红色级别进行警告。</p><h1 id="6eac" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">CloudWatch警报配置</h1><p id="dc73" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">转到CloudWatch警报，创建一个新警报:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi na"><img src="../Images/132f90379e51a47797266f8fae8c45f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PrS_5unVJfDr2nss.png"/></div></div></figure><p id="994f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">选择指标:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nb"><img src="../Images/77607f57a7304d717617fccf5b1a56ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HwoXSWrQK54gCw01.png"/></div></div></figure><p id="de08" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">找到一个必要的可信顾问指标，在当前情况下，它将是<em class="mk">安全组—特定端口不受限制—重新分配资源</em>:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nc"><img src="../Images/142480d336226d6ca8f8d6cb7d18d6b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4lVZZWurDlSUcM9B.png"/></div></div></figure><p id="c595" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">设置何时触发该警报:在统计中使用<em class="mk">简单计数</em>:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nd"><img src="../Images/5c5aae4b91795edc45b6229d4f16e67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tAgWxpoQSQxw8FZl.png"/></div></div></figure><p id="6a04" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在<em class="mk">条件</em>中选择<em class="mk">大于/等于</em>且值为1，在<em class="mk">附加配置</em>中设置<em class="mk">将缺失数据视为良好</em>:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ne"><img src="../Images/3664968a3139a37951ff326cad31fb58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Haea_MnfD0yUYpkl.png"/></div></div></figure><p id="b667" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，配置<em class="mk">动作:</em>向上面创建的SNS主题发送通知:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nf"><img src="../Images/ce4c4f25031b311b6e844dfa5cdc7ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X0yb8xQhCZOucIPj.png"/></div></div></figure><p id="9a38" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">设置警报的名称，也可以选择描述:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ng"><img src="../Images/fbaf30f72227d2693888485dfffcff41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pCQUUbS2MZah2C_p.png"/></div></div></figure><p id="970a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们来测试一下:使用Allow规则从<em class="mk"> 0.0.0.0/0 </em>到端口3306创建一个SecurityGroup，因此它必须触发红色级别:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nh"><img src="../Images/ae0df4ae5b5eff6a794e132fdca05ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QerXyhmQfiFmdWtK.png"/></div></div></figure><p id="14cd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">保存新的提醒，并等待提醒…等待…等待…</p><h1 id="09f1" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">可信顾问刷新检查—更新频率</h1><p id="c674" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">未触发警报的原因是Trusted Advisor刷新其数据的频率:有些检查是自动更新的，有些是在您访问其仪表板或通过AWS API或AWS CLI时更新的。</p><p id="1529" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们当前的案例中，让我们检查一下<a class="ae ks" href="https://docs.aws.amazon.com/awssupport/latest/user/trusted-advisor-check-reference.html#security-groups-specific-ports-unrestricted" rel="noopener ugc nofollow" target="_blank">安全组的文档—特定端口无限制</a>检查:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ni"><img src="../Images/79568e795c27a196c88b36d3a1acf6c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OmxyNuOqQ2eBXttX.png"/></div></div></figure><p id="8797" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里我们看不到任何关于<em class="mk">的刷新。</em>但是——你可以看到<strong class="jw ir">检查ID</strong>——我们很快就会用它来手动更新检查。</p><p id="c927" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但是对于亚马逊RDS公开快照，你会发现它每天会自动刷新几次，你不能手动触发它的更新:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ni"><img src="../Images/135d7eb5d5db252c4c35a0000898fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4K63EAuKODVq9Df6.png"/></div></div></figure><h2 id="dd0a" class="nj li iq bd lj nk nl dn ln nm nn dp lr kf no np lv kj nq nr lz kn ns nt md nu bi translated">可信顾问—手动刷新</h2><p id="6db4" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">要运行手动刷新，我们可以:</p><ol class=""><li id="753b" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr nv kz la lb bi translated">只需打开TrustedAdvisor仪表板并展开<a class="ae ks" href="https://docs.aws.amazon.com/awssupport/latest/user/trusted-advisor-check-reference.html#security-groups-specific-ports-unrestricted" rel="noopener ugc nofollow" target="_blank">安全组—特定端口无限制</a></li><li id="50ae" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr nv kz la lb bi translated">可以使用<code class="fe nw nx ny nz b"><a class="ae ks" href="https://docs.aws.amazon.com/awssupport/latest/APIReference/API_RefreshTrustedAdvisorCheck.html" rel="noopener ugc nofollow" target="_blank">RefreshTrustedAdvisorCheck</a></code> API调用</li><li id="176d" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr nv kz la lb bi translated">或者使用AWS CLI和<code class="fe nw nx ny nz b"><a class="ae ks" href="https://docs.aws.amazon.com/cli/latest/reference/support/refresh-trusted-advisor-check.html" rel="noopener ugc nofollow" target="_blank">refresh-trusted-advisor-check</a></code>命令</li></ol><p id="87b2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们尝试使用CLI —使用上面的命令，将AWS区域指定为<em class="mk"> us-east-1 </em> (N. Virginia，我们发出警报的地方)，并在<code class="fe nw nx ny nz b">--check-id</code>中设置上面提到的id(同样，您可以使用<code class="fe nw nx ny nz b"><a class="ae ks" href="https://docs.aws.amazon.com/cli/latest/reference/support/describe-trusted-advisor-checks.html" rel="noopener ugc nofollow" target="_blank">aws support describe-trusted-advisor-checks</a></code>命令获得ID):</p><pre class="mm mn mo mp gt oa nz ob oc aw od bi"><span id="a2ff" class="nj li iq nz b gy oe of l og oh">$ aws --region us-east-1 support refresh-trusted-advisor-check --check-id HCP4007jGY<br/>{<br/>  “status”: {<br/>    “checkId”: “HCP4007jGY”,<br/>    “status”: “enqueued”,<br/>    “millisUntilNextRefreshable”: 3599991<br/>  }<br/>}</span></pre><p id="64ec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mk"> enqueued </em>状态意味着刷新请求被接受，您将在几分钟后看到结果。</p><p id="32bf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果<code class="fe nw nx ny nz b">status</code>字段有“<em class="mk">成功</em>”值——那么它是最近刷新的，你必须等待<code class="fe nw nx ny nz b">millisUntilNextRefreshable</code> (3599990 ms == 60分钟)。</p><p id="55ba" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最终，我们得到了警报:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oi"><img src="../Images/676e8eab98818b07580f2f63cdfde8f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9u8uvZg8x7mW0EHL.png"/></div></div></figure><p id="93d4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以及松弛信道中的消息:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/f12246a034390a7d6f380cafbca60b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*OEYS_DGTp1qqbaLw.png"/></div></figure><h1 id="45af" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">松弛配置中的预警消息</h1><p id="e332" class="pw-post-body-paragraph ju jv iq jw b jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr ij bi translated">上面消息中的文本现在没有用了——我们只看到它被触发了。</p><p id="c14a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们在这里添加一些信息—转到松弛时间集成设置，单击<em class="mk">高级</em>:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ok"><img src="../Images/ea17adcfb6570e852cd0ce3a74456ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v03xF1ZtopXmnvK7.png"/></div></div></figure><p id="b400" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并设置您希望在那里看到的数据。例如，我添加了两个链接，分别指向文档和可信顾问的控制面板:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ol"><img src="../Images/5e9766562a94396deae419fd781e505a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wPeKkwWIDM0e0_4Z.png"/></div></div></figure><p id="94a7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">再次运行检查:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/1fbe0118880a5bdb9b6ca1ff4d43c268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/0*2AFRJRC_FT3o7bV6.png"/></div></figure><p id="0e0d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成了。</p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><p id="25dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mk">最初发布于</em> <a class="ae ks" href="https://rtfm.co.ua/en/aws-trusted-advisor-part-2-cloudwatch-alarms-and-slack-notifications/" rel="noopener ugc nofollow" target="_blank"> <em class="mk"> RTFM: Linux、DevOps、系统管理</em> </a> <em class="mk">。</em></p></div></div>    
</body>
</html>
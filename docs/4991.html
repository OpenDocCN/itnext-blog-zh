<html>
<head>
<title>How to build your own Python Voice Assistant | thecodingpie</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建自己的Python语音助手| thecodingpie</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-build-your-own-python-voice-assistant-thecodingpie-eaa1f70aabb6?source=collection_archive---------1-----------------------#2020-11-11">https://itnext.io/how-to-build-your-own-python-voice-assistant-thecodingpie-eaa1f70aabb6?source=collection_archive---------1-----------------------#2020-11-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/594620296e3861fa0c1b30d75a594e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qACm5Xd829LBiLOQCSjNgQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">让我们建造它！</figcaption></figure><p id="b122" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章最初发表在我的博客——<a class="ae kw" href="https://thecodingpie.com/" rel="noopener ugc nofollow" target="_blank">https://thecodingpie.com</a></p><p id="6a0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有没有兴趣像电影《钢铁侠》中的贾维斯一样，打造自己的虚拟语音助手？如果你有兴趣建立一个，那么你来对地方了。</p><p id="cd0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好，在本教程中，你将学习如何使用Python构建自己的个人语音助手，比如Jarvis。</p><p id="f4a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以从我的Github repo — <a class="ae kw" href="https://github.com/the-coding-pie/voice_assistant" rel="noopener ugc nofollow" target="_blank">最终版本下载完成的项目代码。</a></p><p id="c985" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在开始之前，让我们了解一下我们要构建什么…</p><h1 id="efb8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">了解我们要建造什么？</h1><p id="dee2" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们将要构建的语音识别程序将能够识别这些命令:</p><ul class=""><li id="c71c" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">名称—告知其名称。</li><li id="63a7" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">日期—显示日期。</li><li id="4dbb" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">时间—显示当前时间。</li><li id="4900" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">你好吗？—会说“我很好……”。</li><li id="cba8" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">搜索—将使用Google进行搜索。</li><li id="8b58" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">最后，如果我们说“退出”或“退出”，它将终止。</li></ul><p id="5694" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了实现所有这些功能，我们将主要使用3个python模块:</p><ul class=""><li id="8c53" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated"><strong class="ka ir">语音识别</strong> —识别我们的语音，并使用谷歌的网络语音API将其转换为文本格式。</li><li id="942a" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated"><strong class="ka ir"> PyAudio </strong> —用于使用麦克风。</li><li id="9de4" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated"><strong class="ka ir"> pyttsx3 </strong> —用于将给定文本转换为语音(即用于生成计算机语音)</li></ul><h1 id="33b6" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">我们该如何建造它？</h1><p id="2114" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">基本上很简单。我们只需要创建3个函数，仅此而已！</p><ul class=""><li id="0fb2" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">第一个函数<code class="fe mo mp mq mr b">recognize_voice()</code>，将负责捕获我们的声音(我们通过麦克风输入的)，识别它，并返回它的“文本”版本。</li><li id="52ae" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后，我们将把语音的“文本”版本交给另一个名为<code class="fe mo mp mq mr b">reply()</code>的功能，它将负责回复我们，并做各种其他疯狂的事情(如搜索谷歌，告诉当前时间等)。).</li><li id="04af" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">最后，一个名为<code class="fe mo mp mq mr b">speak()</code>的函数，它将接受我们给它的任何文本并将其转换成语音。</li></ul><p id="1d2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将无限重复上述功能，直到用户说“退出”或“退出”。</p><h1 id="11d2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">要求</h1><ul class=""><li id="e305" class="ma mb iq ka b kb lv kf lw kj ms kn mt kr mu kv mf mg mh mi bi translated">你应该擅长python3。</li><li id="3897" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">您应该在计算机上安装python3.3或更高版本。</li><li id="c49d" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">你应该已经安装了<strong class="ka ir"> venv </strong>。如果您使用的是Python 3.3或更新版本，那么<strong class="ka ir"> venv </strong>已经包含在Python标准库中，不需要额外安装。</li><li id="a35e" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">你应该有一个麦克风(笔记本电脑的内置麦克风或者耳机上的麦克风就可以了)</li><li id="e1cb" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">你应该需要一个互联网连接。</li><li id="4a90" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">最后，你应该有一个像visual studio代码这样的现代代码编辑器。</li></ul><p id="592e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这些东西，我们开始吧。</p><h1 id="4602" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">初始设置</h1><ul class=""><li id="608f" class="ma mb iq ka b kb lv kf lw kj ms kn mt kr mu kv mf mg mh mi bi translated">首先，在计算机上的任意位置创建一个名为<code class="fe mo mp mq mr b">voice_assistant</code>的文件夹。</li><li id="899a" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后在visual studio代码中打开它。</li></ul><p id="f7fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们使用<strong class="ka ir"> venv </strong>创建一个新的虚拟环境并激活它。为此:</p><ul class=""><li id="095d" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">打开<strong class="ka ir">端子&gt;新建端子</strong>。</li><li id="b9c7" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后键入:</li></ul><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="fafe" class="nd ky iq mr b gy ne nf l ng nh">python3 -m venv venv</span></pre><p id="c816" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个命令将为我们创建一个名为<strong class="ka ir"> venv </strong>的虚拟环境。</p><ul class=""><li id="4ea0" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">要激活它，如果您在<strong class="ka ir">窗口</strong>上，请键入以下内容:</li></ul><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="d69d" class="nd ky iq mr b gy ne nf l ng nh">venv\Scripts\activate.bat</span></pre><ul class=""><li id="ff62" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">如果您使用的是<strong class="ka ir"> Linux/Mac </strong>，那么:</li></ul><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="e5d9" class="nd ky iq mr b gy ne nf l ng nh">source venv/bin/activate</span></pre><p id="b865" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，您应该会看到类似这样的内容:</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/248fdff416f6e372386e84b2454cf623.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*zIfrrCov8uKT_wGC_qFTvA.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">这意味着您已经成功激活了虚拟环境</figcaption></figure><p id="6ccc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">注意:</strong>像<strong class="ka ir"> venv </strong>这样的虚拟环境有助于我们将所有与当前项目相关的依赖关系都保存在与主计算机隔离的环境中。这是我们使用它的主要原因之一。</p><ul class=""><li id="44e3" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">最后，直接在voice_assistant文件夹中创建一个名为“<code class="fe mo mp mq mr b">main.py</code>”的新文件，如下所示:</li></ul><figure class="mv mw mx my gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/77fff241c9be33e9db41a665bd8d6c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*FJf6azAIzcHmRwu8YVaOuw.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">点击此图标并创建文件</figcaption></figure><ul class=""><li id="6c92" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">现在，您将看到与此类似的内容:</li></ul><figure class="mv mw mx my gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/efb4bdc18217e0a25760c991631cc68e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*b8CBcoxBhqG6zMlDVkSEDg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">main.py文件</figcaption></figure><p id="72a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就这样，现在让我们安装那些需要的模块。</p><h1 id="e62a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">安装需求</h1><p id="84e3" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">为了识别我们的声音并将其转换为文本，我们需要一些额外的模块，如<strong class="ka ir"> SpeechRecognizer </strong>，所以让我们安装它。在终端中键入以下命令:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="6333" class="nd ky iq mr b gy ne nf l ng nh">pip install SpeechRecognition</span></pre><p id="198b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，如果您使用麦克风作为输入源，在我们的例子中，我们需要安装<a class="ae kw" href="https://people.csail.mit.edu/hubert/pyaudio/" rel="noopener ugc nofollow" target="_blank"> PyAudio包</a>。</p><p id="06f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装<strong class="ka ir"> PyAudio </strong>的过程会因你的操作系统而异。</p><p id="36fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于<strong class="ka ir"> Linux </strong>:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="8e82" class="nd ky iq mr b gy ne nf l ng nh">sudo apt-get install python-pyaudio python3-pyaudio</span><span id="7f41" class="nd ky iq mr b gy nl nf l ng nh">pip install pyaudio</span></pre><p id="1894" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你在苹果电脑上:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="3fa0" class="nd ky iq mr b gy ne nf l ng nh">brew install portaudio</span><span id="aa10" class="nd ky iq mr b gy nl nf l ng nh">pip install pyaudio</span></pre><p id="c4e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你在<strong class="ka ir">窗口</strong>上:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="6bde" class="nd ky iq mr b gy ne nf l ng nh">pip install pyaudio</span></pre><p id="ffd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您在Windows上安装<strong class="ka ir"> PyAudio </strong>时遇到任何错误，请参考此<a class="ae kw" href="https://stackoverflow.com/questions/52283840/i-cant-install-pyaudio-on-windows-how-to-solve-error-microsoft-visual-c-14" rel="noopener ugc nofollow" target="_blank">堆栈溢出解决方案</a>。如果你在不同的机器上，那么尝试谷歌错误。如果你仍然有这些错误，请在下面随意评论。</p><p id="31b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦您安装了<strong class="ka ir"> PyAudio </strong>，您可以通过键入以下命令从终端测试安装:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="688c" class="nd ky iq mr b gy ne nf l ng nh">python -m speech_recognition</span></pre><p id="7365" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请确定您的默认麦克风已打开且未静音。如果安装工作正常，您应该会看到如下内容:</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/3ccf175b02ef7739c806574b2d8fb464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*eKGieXMjhE5qkQkdHcfL5A.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">成功消息</figcaption></figure><p id="5b74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你使用的是Ubuntu，那么你可能会得到一些“<strong class="ka ir"> ALSA库[…]未知的PCM </strong>”这样的错误:</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/64d42cd2e1decf9015bb7820d8bdc130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*1o1cxGdnBA7a3Rm15noeRQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">ALSA误差</figcaption></figure><p id="56c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要抑制那些错误，请看<strong class="ka ir"><em class="nn"/></strong><a class="ae kw" href="https://stackoverflow.com/questions/7088672/pyaudio-working-but-spits-out-error-messages-each-time" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nn">这个Stackoverflow的答案</em> </strong> </a> <strong class="ka ir"> <em class="nn">。</em>T29】</strong></p><p id="c2dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，为了让程序能够说话，我们必须安装<strong class="ka ir"> pyttsx3 </strong>模块:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="e7eb" class="nd ky iq mr b gy ne nf l ng nh">pip install pyttsx3</span></pre><p id="6b32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> pyttsx3 </strong>是Python 2和3的文本到语音(TTS)库。它的工作没有互联网连接或延迟。它还支持多种TTS引擎，包括Sapi5、nsss和espeak。</p><p id="501a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就这样，我们已经安装并设置了所有的先决条件。现在是写程序本身的时候了，让我们开始吧。</p><h1 id="1454" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">识别声音()</h1><p id="953a" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">首先，该进口的都要进口。</p><p id="0fcc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe mo mp mq mr b">main.py</code>文件中键入以下代码:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="2934" class="nd ky iq mr b gy ne nf l ng nh"># all our imports<br/>import speech_recognition as sr<br/>from time import sleep<br/>from datetime import datetime<br/>import webbrowser<br/>import pyttsx3</span></pre><ul class=""><li id="f068" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">首先，我们将<code class="fe mo mp mq mr b">speech_recognition</code>模块作为<code class="fe mo mp mq mr b">sr</code>导入。</li><li id="7d04" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后我们从<code class="fe mo mp mq mr b">time</code>模块导入<code class="fe mo mp mq mr b">sleep()</code>函数。我们一会儿将使用它来制造一个假延迟。</li><li id="6108" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后为了知道当前的日期和时间，我们需要那个<code class="fe mo mp mq mr b">datetime</code>模块。</li><li id="9d36" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后打开浏览器进行谷歌搜索，我们需要<code class="fe mo mp mq mr b">webbrowser</code>模块的帮助。</li><li id="ceda" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后就像我之前说的，要把文本转换成语音，我们需要<code class="fe mo mp mq mr b">pyttsx3</code>。</li></ul><p id="83cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">SpeechRecognition的所有神奇之处都发生在<code class="fe mo mp mq mr b">Recognizer</code>类上。接下来让我们实例化它:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="6434" class="nd ky iq mr b gy ne nf l ng nh"># make an instance of Recognizer class<br/>r = sr.Recognizer()</span></pre><p id="3e9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在配置<code class="fe mo mp mq mr b">pyttsx3</code>:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="256f" class="nd ky iq mr b gy ne nf l ng nh"># confs for pyttsx3<br/>engine = pyttsx3.init()</span></pre><ul class=""><li id="f3d6" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">pyttsx3 将负责生成计算机语音。查看/破解性别、年龄、速度等。在生成的计算机声音中，<a class="ae kw" href="https://pypi.org/project/pyttsx3/" rel="noopener ugc nofollow" target="_blank">阅读此描述</a>。</li></ul><p id="646b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们创建那个<code class="fe mo mp mq mr b">recognize_voice()</code>函数。此<code class="fe mo mp mq mr b">recognize_voice()</code>功能将执行以下操作:</p><ul class=""><li id="7f57" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">听我们的麦克风。</li><li id="00c6" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">借助<code class="fe mo mp mq mr b">recognize_google()</code>功能识别我们的声音。</li><li id="95b4" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">将其转换为文本格式。</li><li id="8769" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后返回我们声音的那个<code class="fe mo mp mq mr b">text</code>版本。</li></ul><p id="ec11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建如下的<code class="fe mo mp mq mr b">recognize_voice()</code>函数:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="d954" class="nd ky iq mr b gy ne nf l ng nh">""" fn to recognize our voice and return the text_version of it"""<br/>def recognize_voice():<br/>  text = ''</span><span id="9856" class="nd ky iq mr b gy nl nf l ng nh">  # create an instance of the Microphone class<br/>  with sr.Microphone() as source:<br/>    # adjust for ambient noise<br/>    r.adjust_for_ambient_noise(source)</span><span id="001a" class="nd ky iq mr b gy nl nf l ng nh">    # capture the voice<br/>    voice = r.listen(source)</span><span id="4b31" class="nd ky iq mr b gy nl nf l ng nh">    # let's recognize it<br/>    try:<br/>      text = r.recognize_google(voice)<br/>    except sr.RequestError:<br/>      speak("Sorry, the I can't access the Google API...")<br/>    except sr.UnknownValueError:<br/>      speak("Sorry, Unable to recognize your speech...")<br/>  return text.lower()</span></pre><ul class=""><li id="a252" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">如果发生了一些错误，比如你的网络连接不好，它就会发出适当的信息。</li></ul><p id="6e28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">记住<code class="fe mo mp mq mr b">speak()</code>函数不是一个内置函数。我们必须创建它，我们将在最后完成它，因为它是一个小函数。</p><p id="4790" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还要记住这个<code class="fe mo mp mq mr b">speak()</code>函数会将给定的文本转换成语音(计算机生成的声音)。</p><p id="6f32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在文件的最底部，键入以下内容:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="68e4" class="nd ky iq mr b gy ne nf l ng nh"># wait a second for adjust_for_ambient_noise() to do its thing<br/>sleep(1)</span><span id="1b8a" class="nd ky iq mr b gy nl nf l ng nh">while True:<br/>  speak("Start speaking...")<br/>  # listen for voice and convert it into text format<br/>  text_version = recognize_voice()</span><span id="d384" class="nd ky iq mr b gy nl nf l ng nh">  # give "text_version" to reply() fn<br/>  reply(text_version)</span></pre><ul class=""><li id="deeb" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">延迟1秒后，我们开始一个无限循环。</li><li id="d5b4" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后<code class="fe mo mp mq mr b">speak()</code>消息“开始讲话……”，这就像是对终端用户的提示。</li><li id="945e" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">然后我们监听语音，并使用我们刚刚创建的<code class="fe mo mp mq mr b">recognize_voice()</code>函数将其转换成文本格式。</li><li id="7fca" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">现在我们有了输入语音的<code class="fe mo mp mq mr b">text_version</code>。所以我们可以用这个来生成响应，比如告诉日期，当前时间，根据我们的要求搜索谷歌。</li><li id="e983" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">这就是<code class="fe mo mp mq mr b">reply()</code>函数要做的事情。</li></ul><p id="753d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们创建那个<code class="fe mo mp mq mr b">reply()</code>函数。</p><h1 id="54ed" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">回复()</h1><p id="c90a" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">该函数将接受<code class="fe mo mp mq mr b">text_version</code>作为参数，然后相应地执行操作。在我们之前创建的<code class="fe mo mp mq mr b">recognize_voice()</code>函数下键入以下代码:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="ecf6" class="nd ky iq mr b gy ne nf l ng nh">""" fn to respond back """<br/>def reply(text_version):<br/>  # name<br/>  if "name" in text_version:<br/>    speak("My name is JARVIS")<br/>  <br/>  # how are you?<br/>  if "how are you" in text_version:<br/>    speak("I am fine...")</span><span id="1a91" class="nd ky iq mr b gy nl nf l ng nh">  # date<br/>  if "date" in text_version:<br/>    # get today's date and format it - 9 November 2020<br/>    date = datetime.now().strftime("%-d %B %Y")<br/>    speak(date)</span><span id="640c" class="nd ky iq mr b gy nl nf l ng nh">  # time<br/>  if "time" in text_version:<br/>    # get current time and format it like - 02 28 <br/>    time = datetime.now().time().strftime("%H %M")<br/>    speak("The time is " + time)<br/>  <br/>  # search google<br/>  if "search" in text_version:<br/>    speak("What do you want me to search for?")<br/>    keyword = recognize_voice()</span><span id="bf62" class="nd ky iq mr b gy nl nf l ng nh">    # if "keyword" is not empty<br/>    if keyword != '':<br/>      url = "https://google.com/search?q=" + keyword</span><span id="5ae2" class="nd ky iq mr b gy nl nf l ng nh">      # webbrowser module to work with the webbrowser<br/>      speak("Here are the search results for " + keyword)<br/>      webbrowser.open(url)<br/>      sleep(3)<br/>  <br/>  # quit/exit<br/>  if "quit" in text_version or "exit" in text_version:<br/>    speak("Ok, I am going to take a nap...")<br/>    exit()</span></pre><ul class=""><li id="f8d1" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">看这很简单。我们所做的只是检查给定的<code class="fe mo mp mq mr b">text_version</code>中是否存在“任何文本片段”。如果我们找到了我们正在寻找的某些文本，那么我们将像<code class="fe mo mp mq mr b">speak()</code>一样相应地行动——像这样打开<code class="fe mo mp mq mr b">webbrowser</code>搜索当前时间或日期。</li><li id="e24b" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">再次看到，我们正在使用<code class="fe mo mp mq mr b">speak()</code>函数，但是还没有创建它。这就是我们接下来要做的。</li></ul><h1 id="2e1d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">说话()</h1><p id="1c99" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在<code class="fe mo mp mq mr b">reply()</code>功能的上方/下方键入以下代码:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="3aaf" class="nd ky iq mr b gy ne nf l ng nh">""" speak (text to speech) """<br/>def speak(text):<br/>  engine.say(text)<br/>  engine.runAndWait()</span></pre><ul class=""><li id="ce0c" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">很简单，不是吗？在这里，我们使用前面实例化的<code class="fe mo mp mq mr b">engine</code>，来<code class="fe mo mp mq mr b">say()</code>我们给出的文本。这是我们在<code class="fe mo mp mq mr b">speak()</code>函数中唯一做的事情。</li></ul><p id="379d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就这样，你已经在很短的时间内成功地创建了自己的python语音助手！</p><p id="4db6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们来测试一下。在底部的终端窗口中键入以下代码:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="604a" class="nd ky iq mr b gy ne nf l ng nh">python main.py</span></pre><p id="d5cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">继续，问几个问题，比如“你叫什么名字？”，“今天几号？”、“搜索谷歌”之类的。</p><p id="b86f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽情享受吧…</p><h1 id="a28a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">最终代码</h1><p id="f7eb" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">这里是<code class="fe mo mp mq mr b">main.py</code>文件的最终版本。如果您有任何错误，请用下面的代码交叉检查您的代码:</p><pre class="mv mw mx my gt mz mr na nb aw nc bi"><span id="d8e1" class="nd ky iq mr b gy ne nf l ng nh"># all our imports<br/>import speech_recognition as sr<br/>from time import sleep<br/>from datetime import datetime<br/>import webbrowser<br/>import pyttsx3<br/></span><span id="6b01" class="nd ky iq mr b gy nl nf l ng nh"># make an instance of Recognizer class<br/>r = sr.Recognizer()<br/></span><span id="f7df" class="nd ky iq mr b gy nl nf l ng nh"># confs for pyttsx3<br/>engine = pyttsx3.init()<br/></span><span id="b4a6" class="nd ky iq mr b gy nl nf l ng nh">""" speak (text to speech) """<br/>def speak(text):<br/>  engine.say(text)<br/>  engine.runAndWait()<br/></span><span id="2389" class="nd ky iq mr b gy nl nf l ng nh">""" fn to recognize our voice and return the text_version of it"""<br/>def recognize_voice():<br/>  text = ''</span><span id="3278" class="nd ky iq mr b gy nl nf l ng nh">  # create an instance of the Microphone class<br/>  with sr.Microphone() as source:<br/>    # adjust for ambient noise<br/>    r.adjust_for_ambient_noise(source)</span><span id="2624" class="nd ky iq mr b gy nl nf l ng nh">    # capture the voice<br/>    voice = r.listen(source)</span><span id="ef86" class="nd ky iq mr b gy nl nf l ng nh">    # let's recognize it<br/>    try:<br/>      text = r.recognize_google(voice)<br/>    except sr.RequestError:<br/>      speak("Sorry, the I can't access the Google API...")<br/>    except sr.UnknownValueError:<br/>      speak("Sorry, Unable to recognize your speech...")<br/>  return text.lower()<br/></span><span id="a655" class="nd ky iq mr b gy nl nf l ng nh">""" fn to respond back """<br/>def reply(text_version):<br/>  # name<br/>  if "name" in text_version:<br/>    speak("My name is JARVIS")<br/>  <br/>  # how are you?<br/>  if "how are you" in text_version:<br/>    speak("I am fine...")</span><span id="18c1" class="nd ky iq mr b gy nl nf l ng nh">  # date<br/>  if "date" in text_version:<br/>    # get today's date and format it - 9 November 2020<br/>    date = datetime.now().strftime("%-d %B %Y")<br/>    speak(date)</span><span id="f366" class="nd ky iq mr b gy nl nf l ng nh">  # time<br/>  if "time" in text_version:<br/>    # get current time and format it like - 02 28 <br/>    time = datetime.now().time().strftime("%H %M")<br/>    speak("The time is " + time)<br/>  <br/>  # search google<br/>  if "search" in text_version:<br/>    speak("What do you want me to search for?")<br/>    keyword = recognize_voice()</span><span id="b89c" class="nd ky iq mr b gy nl nf l ng nh">    # if "keyword" is not empty<br/>    if keyword != '':<br/>      url = "https://google.com/search?q=" + keyword</span><span id="456f" class="nd ky iq mr b gy nl nf l ng nh">      # webbrowser module to work with the webbrowser<br/>      speak("Here are the search results for " + keyword)<br/>      webbrowser.open(url)<br/>      sleep(3)<br/>  <br/>  # quit/exit<br/>  if "quit" in text_version or "exit" in text_version:<br/>    speak("Ok, I am going to take a nap...")<br/>    exit()<br/></span><span id="1a78" class="nd ky iq mr b gy nl nf l ng nh"># wait a second for adjust_for_ambient_noise() to do its thing<br/>sleep(1)</span><span id="dc91" class="nd ky iq mr b gy nl nf l ng nh">while True:<br/>  speak("Start speaking...")<br/>  # listen for voice and convert it into text format<br/>  text_version = recognize_voice()</span><span id="8bc5" class="nd ky iq mr b gy nl nf l ng nh">  # give "text_version" to reply() fn<br/>  reply(text_version)</span></pre><h1 id="9011" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">包扎</h1><p id="3f01" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我希望你喜欢这个教程。有些地方，我有意跳过了解释部分。因为这些代码简单明了。所以我让你自己去解码。</p><p id="1e3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">真正的学习发生在你自己尝试的时候。仅仅跟随教程不会让你成为更好的程序员。你得用你自己的大脑。</p><p id="cd40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你仍然有任何错误，首先尝试通过谷歌搜索自己解码。</p><p id="5f3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有找到任何解决方案，那就在下面评论一下吧。因为你应该知道如何自己找到并解决一个bug，这是每个程序员都应该具备的技能！</p><p id="5f73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已，谢谢；)</p></div></div>    
</body>
</html>
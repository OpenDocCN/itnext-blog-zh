<html>
<head>
<title>Form Validation with HTML &amp; Vuejs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用HTML和Vuejs进行表单验证</h1>
<blockquote>原文：<a href="https://itnext.io/form-validation-with-html-vuejs-54ec18e473aa?source=collection_archive---------0-----------------------#2019-02-16">https://itnext.io/form-validation-with-html-vuejs-54ec18e473aa?source=collection_archive---------0-----------------------#2019-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0c8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们说大多数web应用程序只是HTML表单。好吧，表单需要验证，谢天谢地，HTML5自带了很多很棒的内置表单验证功能，比如电子邮件、数字、最大值、最小值等等。您甚至可以用<strong class="jp ir">模式</strong>编写自己的验证规则。在本文中，我将讨论如何利用HTML5验证，同时覆盖无聊的默认设置，这样就可以随心所欲地显示验证错误。我将与<a class="ae kl" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Vuejs </strong> </a> <strong class="jp ir"> </strong>一起工作，但即使你不使用Vue，你也可以随时跟上。</p><p id="f009" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从<a class="ae kl" href="https://getbootstrap.com/docs/4.0/examples/checkout/" rel="noopener ugc nofollow" target="_blank"> bootstrap examples </a>中的Checkout表单的修改版本开始，这样我们就不必太担心样式了。你可以在这里克隆启动器<a class="ae kl" href="https://github.com/Obapelumi/html5-validation-and-vue-starter" rel="noopener ugc nofollow" target="_blank"/>。设置应该如下所示:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/8463c828b4cd95fa2de025d018b42671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lg4K73QpcODX3WmW4Vbnlg.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">使用Vuejs Starter进行HTML验证</figcaption></figure><p id="ead3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认的HTML5验证不会一次显示所有的表单错误。具有讽刺意味的是，一旦用户提交，浏览器实际上知道所有的无效字段，所以现在我们要做的就是检查它们，然后按照我们喜欢的方式显示。</p><p id="f8fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们向表单添加一个id和一个使用Vuejs捕获提交事件的监听器。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="lc ld l"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">将事件侦听器添加到表单提交中</figcaption></figure><p id="8f1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在我们的<strong class="jp ir"> form-validation.js </strong>文件中，我们将初始化Vuejs并创建处理表单提交和验证的方法。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="2e81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们创建了两个方法<strong class="jp ir"> submitForm </strong>和<strong class="jp ir"> validateForm。submitForm </strong>调用<strong class="jp ir"> validateForm </strong>，如果满足所有的验证规则，那么validateForm 将返回true。现在，我们只是控制台记录所有无效的表单输入。如果我们检查每一个，我们可以发现一些有趣的属性，包括可以显示给用户的<strong class="jp ir">验证消息</strong>。</p><div class="kn ko kp kq gt ab cb"><figure class="le kr lf lg lh li lj paragraph-image"><img src="../Images/38bdb40dc03e182bd6b9e7fe64fc7fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*GI13v1sKdJqjxkcOeh-J2A.png"/></figure><figure class="le kr lk lg lh li lj paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/bfbd512bb97eec28efc0344dada33de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*TxjsslwLyTF11GKA-NZtzQ.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk ll di lm ln translated">无效的输入属性</figcaption></figure></div><p id="df5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，让我们为每个无效输入创建保存<strong class="jp ir"> validationErrors </strong>的数据属性。然后我们将遍历无效输入的数组来设置每个输入。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="4c7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们做了许多事情。我们创建了<strong class="jp ir"> validationErrors </strong>数据属性来保存每个字段的错误消息。<strong class="jp ir"> validationErrors </strong>对象的每个属性对应于被验证的每个表单元素的name属性。因此，在<strong class="jp ir"> validateForm </strong>方法中，我们清除任何以前的错误消息，然后遍历无效字段来设置它们对应的validationErrors。我们还添加了一个事件侦听器，一旦无效字段发生变化，它就会重新验证。</p><p id="7c97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要为每个想要验证的字段添加name属性，这在制作表单时是很正常的。然后，当然，我们还应该添加向用户显示错误消息的<strong class="jp ir"> span </strong>元素。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="abc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，一旦我们提交表单，我们的用户就可以看到他们需要修复的所有验证错误。最酷的是，我们已经做到了，而不必仅仅为了验证而引入额外的库。现在，因为我们正在利用Vue的数据绑定能力，我们可以真正地从这里开始，在我们希望如何显示我们的错误上有所创新。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="b6c8" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">使用HTML5模式</h1><p id="918a" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">如果我们需要扩展可用的验证规则，该怎么办？例如，检查邮政编码是否有效。这就是HTML5模式变得非常有用的地方，因为我们可以在HTML中编写正则表达式来执行我们需要的任何类型的检查。我感觉现在有人在咒骂正则表达式，但是谢天谢地你可以在html5pattern.com找到一堆有用的正则表达式。现在我还没有找到一个尼日利亚邮政编码，但我知道我会的。</p><p id="7c71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，找到一个正则表达式比我想象的要难一点。结果大部分都是7位数。所以<strong class="jp ir">[0–9]{ 13，16} </strong>应该没问题。现在我们有了一个新问题。HTML5模式上的错误消息不是很有帮助，所以我们需要指定我们自己的。我们需要一种方法来告诉<strong class="jp ir"> validateForm </strong>函数显示什么消息。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="lc ld l"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">添加标题和图案属性</figcaption></figure><p id="8d94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们可以在<strong class="jp ir"> validateForm </strong>方法中检查title属性:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="d6ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们添加了一个if-else块，它检查title属性，如果没有找到，就显示默认的错误消息。此外，<strong class="jp ir"> formId </strong>和<strong class="jp ir"> errorObjectName </strong>变量现在被传递到<strong class="jp ir"> validateForm </strong>函数中，这允许我们随时随地根据自己的选择来验证同一网页上的多个表单。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="95db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经能够为表单验证的配置方法创建一个简单的约定。一旦我们在<strong class="jp ir"> validationErrors </strong>对象中指定了表单字段的名称属性，我们酷的<strong class="jp ir"> validateForm </strong>函数就会利用内置的HTML5特性来完成剩下的工作，我们需要做的就是按照我们想要的方式显示错误。一如既往，我希望这能帮助一些人。</p><p id="3913" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你正在使用Vue，你可以使用<a class="ae kl" href="https://gist.github.com/Obapelumi/113d8a33c3ae4ae412e46de905c3da5a" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">这个代码片段</strong> </a> <strong class="jp ir"> </strong>来快速开始验证，并且应用于其他前端框架应该不难。你也可以在 <strong class="jp ir">这个回购</strong>  <strong class="jp ir"> </strong>和<a class="ae kl" href="https://obapelumi.github.io/HTML5-Validation-and-Vue-Complete/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">演示网站这里</strong> </a>找到这篇文章<a class="ae kl" href="https://github.com/Obapelumi/HTML5-Validation-and-Vue-Complete" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">的工作代码。干杯！</strong></a></p></div></div>    
</body>
</html>
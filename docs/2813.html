<html>
<head>
<title>Building a blazing fast product list with pagination and animations with Gatsby</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Gatsby的分页和动画建立一个超快的产品列表</h1>
<blockquote>原文：<a href="https://itnext.io/building-a-blazing-fast-product-list-with-pagination-and-animations-with-gatsby-8ffa4baeb623?source=collection_archive---------6-----------------------#2019-08-07">https://itnext.io/building-a-blazing-fast-product-list-with-pagination-and-animations-with-gatsby-8ffa4baeb623?source=collection_archive---------6-----------------------#2019-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c8bbf8fd985736dbaf76321f9a57c30c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mz0Hoo1pxvSJRcL_gIDbsg.jpeg"/></div></div></figure><p id="f68c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本教程中，我们将创建一个有两个页面的Gatsby网站。主页介绍了商店和一些功能，第二页是一个简单的分页产品列表页面。</p><p id="6106" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本教程的主要目标是:</p><p id="e8d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-给你看看盖茨比的基本知识。</p><p id="75dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-了解如何在页面间导航。</p><p id="70d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-创建简单的分页。</p><p id="e0a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-如何更改站点元数据和添加新内容。</p><p id="19db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-学习如何使用不同的插件，如gatsby-source-filesystem，并从json文件中获取动态数据。</p><p id="1529" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">——如何让盖茨比编SASS？</p><ul class=""><li id="80ae" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">如何使用react-spring创建一些漂亮简单的动画？</li></ul><div class="lf lg gp gr lh li"><a href="https://github.com/nunosoares27/GatsbyTutorial01" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd ir gy z fp ln fr fs lo fu fw ip bi translated">nunosoares27/GatsbyTutorial01</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">CD hello-world NPM install &amp; &amp; NPM start Gatsby build Gatsby serve Mindera.com软件前端工程师。主要使用…</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">github.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw jw li"/></div></div></a></div><p id="6d91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们要创建的应用程序的两个屏幕截图。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/beeade1ae2d42eaa993636f7a2c0747c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5snq02DUZe8KoIFV-jSCgA.png"/></div></div></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/62011bc1f2491886f2ffbe1b5bc2e110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BfY3CUf3zexls6KfZgfzFQ.png"/></div></div></figure><p id="0f1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">盖茨比是React的一个非常快的现代站点生成器。</p><p id="b5cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了创建项目，我们将遵循gatsby文档并使用gatsby hello-world starter模板。</p><p id="3468" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">盖茨比中的导航很简单。要添加页面，您只需要在/src/pages中创建一个文件。我们创建了两个页面，一个名为index.js(主页),另一个名为products.js。主要路径始终是index.js，为了导航到产品页面，您只需转到/products。</p><p id="c40a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在深入研究之前，我们将添加一些gatsby插件来处理sass文件，并从json文件中获取动态数据。我们将在存储库根目录下的gatsby-config.js文件中添加插件。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="6ce6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在siteMetaData中，我们可以添加一些静态内容。您可以添加任何想要的数据，在我们的例子中，我们添加了标题、描述和一系列特性。我们在主页上使用了这些数据。gatsby-plugin-sass，因为它为SASS/SCSS样式表提供了插件支持。我们使用gatsby-source-filesystem将数据从我们的本地文件系统提供给gatsby应用程序。</p><p id="b5b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们使用gatsby-transformer-json，因为它将原始json字符串解析为JavaScript对象，例如来自JSON文件的对象，支持对象数组和单个对象。这个插件检查文件夹src/data中的json数据。</p><p id="df8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将主sass文件导入到应用程序的gatsby-browser.js文件中</p><p id="bb80" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们向index.js文件添加内容，并使用gatsby graphql查询一些数据。Graphql棒极了，你可以查询并得到你想要的数据。因此，我们查询整个网站，以便找到站点元数据，从而获得主页所需的所有数据。为了呈现内容，我们需要访问props.data.site.siteMetadata。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="2504" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Gatsby中，为了在页面之间导航，我们只需要添加一个带有“to”属性的链接组件，并传递url路径。</p><p id="5a07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了在产品页面上呈现产品列表，我们将创建一个json文件。</p><p id="8abb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请记住，对于查询这个文件，插件需要一个名为allProductsJson的查询。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="b549" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们继续向页面产品添加内容，查询数据并添加分页。为了从products json中获取数据，我们需要查询allProductsJson，输入节点并调用我们想要检索的属性。然后我们用this . props . data . all products JSON . nodes访问组件内部的内容。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="60de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">calcpagenumbers方法负责呈现分页。为了获得每个页面的当前条目，我们创建了几个变量。</p><p id="1efa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了得到最后一项的索引，我们需要将当前页码乘以每页的项数。为了得到第一项的索引，我们需要用每页的项数减去最后一项的索引。为了获得当前项目，我们使用slice对所有产品数据进行切片，并传递第一个项目的索引和最后一个项目的索引。</p><p id="2257" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们添加了一个onClick方法来处理产品列表的分页和页面更改。我们使用scrollTop在产品列表的页面之间导航，以便让页面重置其位置。</p><h1 id="9a41" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能完成后，让我们添加一些风格！</h1><p id="8543" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">一旦我们完成了所有的功能，是时候使用react-spring库添加一些风格和一些简单的动画了。</p><p id="e149" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用bootstrap，这样我们可以加快样式化过程，让我们下载bootstrap minified css版本(我们不需要bootstrap的js部分),并将其粘贴到styles文件夹，然后导入index.js，如下所示:</p><p id="188a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导入"../styles/bootstrap.min.css "</p><p id="37bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以从http://getbootstrap.comT3<a class="ae nh" href="http://getbootstrap.com" rel="noopener ugc nofollow" target="_blank">T5】下载引导文件</a></p><p id="8153" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在styles文件夹中，您应该会看到两个文件，bootstrap.min.css和global.sass，我们将使用它们进行一些额外的定制。</p><p id="6086" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导入之后，Bootstrap将在我们的所有项目中工作，所以我们不需要在任何其他文件中导入它。</p><p id="666f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们准备在index.js和products.js上删除一些标准的引导css类，这样我们就可以快速改变我们应用程序的“面貌”。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="02f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们的应用程序看起来好一点了，所以让我们把重点放在动画上。</p><p id="cf0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用react-spring库制作一些简单的spring动画(<a class="ae nh" href="http://www.react-spring.io" rel="noopener ugc nofollow" target="_blank"> www.react-spring.io </a>)。打开控制台，使用npm安装库:</p><p id="510d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ni"> npm安装—保存反作用弹簧</em></p><p id="c499" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开index.js文件并将其导入到我们的项目中，我们需要从react-spring库中导入useSpring、animated和config</p><p id="6128" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从“react-spring”导入{ useSpring，animated，config }</p><p id="22f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在这个文件上创建5个不同的动画，但是让我们把重点放在第一个上，这样我们就可以看到react-spring是如何工作的。</p><p id="8f76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于index.js文件，我们将使用hooks api，因为它是一个功能组件，对于类组件，我们将需要使用render-props api。</p><p id="d4fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们用我们希望赋予动画的名称创建一个变量，然后将useSpring函数传递给它，接下来useSpring将接收一个带有几个值的对象，对于这个示例，我们将添加:</p><p id="f7e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ni">从- &gt;动画的初始状态<br/>到- &gt;动画的最终状态<br/>配置- &gt;我们的动画的通用预设<br/>延迟- &gt;动画开始前的毫秒延迟</em></p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="1983" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们只需要定义我们想要添加这个动画的位置。在这个特殊的例子中，我们将把它添加到一个<p>标签中，为此我们将动画添加到</p><p>标签中:</p></p><p id="6465" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><animated.p> … </animated.p></p><p id="fc65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并添加一个带有动画名称的样式道具，最终结果会是这样的:</p><p id="77c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><animated.p style="{leftAnimation}"> … </animated.p></p><p id="2053" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就这样，我们完成了第一个react-spring动画。</p><p id="e36d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们最终的index.js将如下所示:</p><p id="d1da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">→index . js的github链接(<a class="ae nh" href="https://github.com/nunosoares27/GatsbyTutorial01/blob/master/src/pages/index.js" rel="noopener ugc nofollow" target="_blank">https://github . com/nunos oares 27/gatsbytutorial 01/blob/master/src/pages/index . js</a>)</p><p id="f89c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于products.js文件，我们将使用render-props库，因为它是一个类组件，所以我们将以不同的方式导入它:</p><p id="03a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从“react-spring/renderprops”导入{ useSpring，config }</p><p id="ffb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们将把我们的原始组件包装在一个<spring>组件中，我们可以像在钩子示例中那样添加动画的值，Spring组件将如下所示:</spring></p><p id="439e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><spring/>config = { config . wobbly }<br/>from = { {<br/>transform:" translate 3d(0，30px，0)"，<br/>opacity:0<br/>}<br/>to = { {<br/>translate 3d(0，0，0)"，<br/>opacity:1<br/>}&gt;}<br/>{ props =&gt;(<br/>…<br/>)}<br/>&lt;/Sping</p><p id="205c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们最终的products.js将如下所示:</p><p id="2d66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">→products . js的github链接(<a class="ae nh" href="https://github.com/nunosoares27/GatsbyTutorial01/blob/master/src/pages/products.js" rel="noopener ugc nofollow" target="_blank">https://github . com/nunos oares 27/gatsbytutorial 01/blob/master/src/pages/products . js</a>)</p><p id="0526" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是我们如何快速制作一个gatsby站点，使用bootstrap来设计它的样式，并使用令人惊叹的react-spring库添加一些简单的动画。</p><p id="8c6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我想补充一点，react-spring有一个非常棒的文档，里面有很多真实的例子和场景，我们可以尝试不同的价值组合，探索这个库的全部功能。</p><h1 id="9b14" class="me mf iq bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">作者:</h1><p id="5fe6" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">努诺·苏亚雷斯——Mindera.com的软件前端工程师。主要使用React，React Native，Redux，Laravel，Wordpress。</p><p id="1197" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae nh" href="https://nunosoares.eu/" rel="noopener ugc nofollow" target="_blank">https://nunosoares.dev/</a></p><p id="4c2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">努诺佩雷拉</strong> —前端开发者。我不喜欢用我做过的工作来定义自己。我用我想做的工作来定义自己。技能是可以教的，性格是与生俱来的。我喜欢不断学习，不断挑战自己，做有意义的有趣的事情。</p><p id="8fa8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae nh" href="https://www.nunopereira.dev/" rel="noopener ugc nofollow" target="_blank">https://www . nunopereira . dev</a></p></div></div>    
</body>
</html>
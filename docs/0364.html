<html>
<head>
<title>URL Shrinkage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">URL收缩</h1>
<blockquote>原文：<a href="https://itnext.io/url-shortening-explained-2e524b1f8d4f?source=collection_archive---------8-----------------------#2018-02-26">https://itnext.io/url-shortening-explained-2e524b1f8d4f?source=collection_archive---------8-----------------------#2018-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/72359318891de717b614abddbcb24585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1Of3i_eCWqsjtfGjzIjGg.png"/></div></div></figure><p id="4d3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">url缩短允许你把一个很长的URL缩短成一小段很好的文本，这样更容易分享。新的缩短的URL然后链接到真实的URL。当我开始为这个做算法时，我的第一个直觉是从长URL中做一个唯一的散列，因为我知道长URL将是唯一的。但是后来我了解到最好的方法是使用一个数字id作为它的唯一标识符。为了做到这一点，我重新熟悉了碱基，以便从它们的id中生成独特的缩写URL。</p><p id="a69a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，挑战在于将1或37，849，823，742这样的数字映射到包含URL安全字符的字符串。我们举个例子，让3GY等于id 10002。在其核心，我们需要使3+G+Y = 10002。听起来不可能，对吧？g和Y不是数字。这是真的，但是我们可以用基数来表示一个数值。现在我们来谈谈碱基。</p><p id="252d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们知道最常见的基数是十进制。那是我们使用的数字系统。它被称为以10为基数，因为每个数字位置都有10个数字，直到它达到“最大值”并必须转到下一个位置。在我们的例子中，一个位置可以有0，1，2，3，4，5，6，7，8，9个数字。一旦超过9，左侧递增，右侧重新开始，得到10。</p><p id="ef1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以现在我们可以通过它的位置得到每个数字。在10的例子中，我们在第一个索引中有一个1，可以表示为1*(10 ) + 0*(10⁰).9823可以表示为9*10 + 8*10 + 2*10 + 3*10⁰.我们也可以通过除法“遍历”基数，通过不断地将数除以它的基数，将每一步写成“余数* 10^n'.”来得到这种格式我们这样做，直到被除的数等于0</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="62a3" class="lf lg iq lb b gy lh li l lj lk">let num = 100 <br/>num%10 = 3  =&gt; 3*10⁰<br/>num = Math.floor(num/10) <br/>num%10 = 2 =&gt; 2*10¹ + 3*10⁰<br/>num = Math.floor(num/10) <br/>num%10 = 8 =&gt; 8*10² + 2*10¹ + 3*10⁰<br/>num = Math.floor(num/10) <br/>num%10 = 9 =&gt; 9*10³ + 8*10² + 2*10¹ + 3*10⁰<br/>num/10 is now 0 so we stop</span></pre><p id="03e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些例子都是以10为基数的，但是以13为基数的会是什么样子呢？让我们试着得到101的13进制表示。</p><p id="a1fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了找到这个，让我们使用除法技巧。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="cb6f" class="lf lg iq lb b gy lh li l lj lk">let num = 101<br/>console.log(num%13) =&gt; 9*13⁰<br/>num = Math.floor(num / 13);<br/>console.log(num%13) =&gt; 7*13¹ + 10*13⁰</span></pre><p id="97c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我们可以看到91 + 10 = 101。问题是10占据了2个数字位置，所以我们需要创造一个新的字符来代替10。让我们有一个相等的10。所以现在不是7*13 + 10*13⁰，这将使我们写无效的710。我们将它表示为7*13 + A*13⁰，其中a表示我们所理解的10。所以我们新的13进制数是7A。</p><p id="0bd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个小例子，但是通过让等于10，我们将101缩短为7A。这是我们将如何使用字母来表示代表我们唯一id的其他数字的先驱。</p><p id="b542" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们的基数为13的计数器可能是0123456789ABC，其中A、B和C分别是10、11和12。但是如果我们使用所有的大写字母、小写字母和数字呢？这将为我们提供2组字母和9个数字(我们排除0，因为大多数数据库自动从1开始ids)，这将等于一个基数为61的数字系统(26+26+9 = 61)。</p><p id="507e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以让我们回到最初的挑战；看3GY怎么能等于10002。使用我们的61进制数字系统会是这样的</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="5d2b" class="lf lg iq lb b gy lh li l lj lk">const alphabet = "123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"<br/>const base = alphabet.length</span></pre><p id="e256" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">长度将是我们的基数，由于字符串可以通过索引访问字符，我们可以说alphabet[11]可以等于' b '。所以在我们以61为基数的数字系统中，11等于b。现在让我们用我们所学的知识来看看如何从3GY得到10002:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="7da8" class="lf lg iq lb b gy lh li l lj lk">const alphabet = "123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"<br/>const base = alphabet.length</span><span id="0dfe" class="lf lg iq lb b gy ll li l lj lk">function decode(url){<br/>  let result = 0;<br/>  while (url){<br/>    // see what each character equals in base 10<br/>    let alphaIndex = alphabet.indexOf(url[0]);<br/>    <br/>    // find the number placment to act as base<br/>    let power = url.length - 1;<br/>    <br/>    // increment the result<br/>    result += alphaIndex * (Math.pow(base, power));<br/>    <br/>    // remove the left-most character in the url<br/>    url = url.substring(1);<br/>  }<br/>  return result;<br/>}</span><span id="da80" class="lf lg iq lb b gy ll li l lj lk">decode('3GY')<br/>// first loop: 2*61² <br/>// second loop: 41*61¹<br/>// third loop: 59*61⁰<br/>// decoded = 2*61² + 41*61¹ + 59*61⁰ =&gt; 10002 </span></pre><p id="6084" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以用除法来计算10002如何等于3GY:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="35a7" class="lf lg iq lb b gy lh li l lj lk">const alphabet = "123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"<br/>const base = alphabet.length</span><span id="1b97" class="lf lg iq lb b gy ll li l lj lk">function encode(id){<br/>  let encoded = '';<br/>  while (id){<br/>    <br/>    // find out what the right most character is in base 10<br/>    let toBaseTen = id % base;<br/>    <br/>    // put the charcter in the right-most position of the result<br/>    encoded = alphabet[toBaseTen].toString() + encoded;<br/>    <br/>    // divide the number by the base to get ready to evaluate the next position<br/>    id = Math.floor(id / base);<br/>}<br/>  return encoded;<br/>}</span><span id="0667" class="lf lg iq lb b gy ll li l lj lk">encode(10002)<br/>// first loop: the remainder of 61 and 10002 is 59 =&gt; alphabet[59] is Y <br/>// second loop: the remainder of 61 and 163 is 41 =&gt; alphabet[41] is G<br/>// third loop: the remainder of 61 and 2 is 2 =&gt; alphabet[2] is 3 <br/>//result = 3GY</span></pre><p id="d205" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以通过这个过程，我们实际上做了一个双射函数，这些函数允许一个集合中的每个元素恰好等于另一个集合中的另一个元素，反之亦然。在我们的例子中，3GY只能解码为10002，10002只能编码为3GY，这满足双射函数的要求。</p><p id="8a64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就我们的数据库而言，我们的数据库可以有一个包含id、shortURL和longURL列的表</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="1e83" class="lf lg iq lb b gy lh li l lj lk">URLS table:<br/>{id:10002, shortURL: 3GY, longURL: www.news.com/some-story/about/some-thing}</span></pre><p id="7f80" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以您可以使用您的shortURL编码到id，然后通过id找到长URL，这样您就可以重定向到长URL。同样，当您输入一个要缩短的URL，而该URL还没有包含在数据库中时，您可以创建一个新的条目，这会创建一个新的id，然后您可以将该id编码到一个新的shortURL中。</p><p id="165d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我想当谈到网址，它的好处是有收缩。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lm ln l"/></div></figure><p id="c5e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我当然需要帮助来掌握这个概念。以下是一些帮助我摆脱困境的文章链接:</p><div class="lo lp gp gr lq lr"><a href="https://coligo.io/create-url-shortener-with-node-express-mongo/" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">使用NodeJs、Express和MongoDB创建URL Shortener</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">在本教程中，我们将使用NodeJS，Express…创建一个类似于bitly.com网站的URL缩短服务</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">coligo.io</p></div></div><div class="ma l"><div class="mb l mc md me ma mf jw lr"/></div></div></a></div><div class="lo lp gp gr lq lr"><a href="https://code.tutsplus.com/tutorials/base-what-a-practical-introduction-to-base-encoding--net-27590" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">基础什么？基本编码的实用介绍</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">在很小的时候，我们就学会用手指数数——从1-5开始，然后是1-10，也许，如果你特别…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">code.tutsplus.com</p></div></div><div class="ma l"><div class="mg l mc md me ma mf jw lr"/></div></div></a></div></div></div>    
</body>
</html>
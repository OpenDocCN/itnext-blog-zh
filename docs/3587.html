<html>
<head>
<title>Flutter: Handling your network API calls like a boss!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤振:像老板一样处理你的网络API调用！</h1>
<blockquote>原文：<a href="https://itnext.io/flutter-handling-your-network-api-calls-like-a-boss-936eef296547?source=collection_archive---------0-----------------------#2020-01-13">https://itnext.io/flutter-handling-your-network-api-calls-like-a-boss-936eef296547?source=collection_archive---------0-----------------------#2020-01-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8fba811875ed4988fd13f40ccb3fe652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_Hwise5fi9orTgRt5ClQA.jpeg"/></div></div></figure><p id="82f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">如果说有一项技术真的让我起鸡皮疙瘩，那就是Flutter。一种适用于所有平台的语言:桌面、网络、iOS和Android。谷歌真的做了一些不可思议的事情来创造这个。我坚信这项技术将会取代它，如果两年前它还没有出现的话。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">OMG，扑！！</figcaption></figure><p id="b922" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我想在这篇文章中介绍一些东西，这样任何开始使用Flutter的人都可以在您的项目中快速轻松地使用他们的API网络调用。</p><p id="443d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在Flutter中使用<a class="ae lp" href="https://api.chucknorris.io/" rel="noopener ugc nofollow" target="_blank">这个端点</a>创建一个小而有趣的Chuck Norris facts应用程序。我将在下面的教程中介绍这些内容:</p><ul class=""><li id="a094" class="lq lr iq ka b kb kc kf kg kj ls kn lt kr lu kv lv lw lx ly bi translated">块架构和项目设置</li><li id="708e" class="lq lr iq ka b kb lz kf ma kj mb kn mc kr md kv lv lw lx ly bi translated">API调用设置</li><li id="530c" class="lq lr iq ka b kb lz kf ma kj mb kn mc kr md kv lv lw lx ly bi translated">回购和集团</li><li id="95e4" class="lq lr iq ka b kb lz kf ma kj mb kn mc kr md kv lv lw lx ly bi translated">用户界面</li></ul><p id="40ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好的——让我们直入主题吧。</p><p id="b90b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> BLOC架构和项目设置:<br/> </strong>所以，取代MVVM做颤振的基本架构模式是BLOC。它们几乎是相同的，除了BLOC模式给你的是一个可以通过<a class="ae lp" href="https://dart.dev/tutorials/language/streams" rel="noopener ugc nofollow" target="_blank">流</a>而不是ViewModel添加新数据来更新的数据流——数据以这些<a class="ae lp" href="https://dart.dev/tutorials/language/streams" rel="noopener ugc nofollow" target="_blank">流</a>的形式从BLOC流向UI，反之亦然。这里有一个关于streams <a class="ae lp" href="https://medium.com/flutter-community/flutter-stream-basics-for-beginners-eda23e44e32f" rel="noopener">的精彩介绍</a>。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/c83d665731623e8550d1853b85ebf4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l6cZR8IBciTIJU43i0gEhw.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">集团架构</figcaption></figure><p id="b35c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们希望你已经完成了几个令人激动的项目，并对它有所了解。使用您最喜欢的IDE，无论是Visual Studio还是Android Studio，启动您的新项目(您也可以通过终端<em class="mf">flutter create apicalls boss</em>来完成)。</p><pre class="lf lg lh li gt mg mh mi mj aw mk bi"><span id="df0b" class="ml mm iq mh b gy mn mo l mp mq">flutter create apicallsboss</span></pre><p id="112c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我个人的偏好是Android Studio。因此，继续前进，在Android Studio中创建一个新的Flutter项目，并将其命名为您想要的任何名称。我称之为“apicallsboss”。</p><p id="7d11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建完项目后，我们需要设置我们的包:<br/>命名为“blocs”、“models”、“networking”、“repository”和“view”，如下所示。他们所有人都很清楚他们将举办什么样的课程，随着我们的深入，这将变得更加清晰。我建议在所有新的Flutter项目中使用这种架构，因为您将能够正确、轻松地分离和管理所有的业务逻辑。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/7f9a515497d5642db405346cfca1b1dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1QoNPD9kkw7lgC9-wcBUkQ.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">程序包结构</figcaption></figure><p id="e27e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，让我们添加依赖项。对于这个项目，我们需要的是我们的网络调用的http库。打开<strong class="ka ir"> pubspec.yaml </strong>文件和<br/>插件<strong class="ka ir">http</strong>；^0.12.0+1如是说:</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="b4ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后运行flutter packages get或者在Android Studio中做一个“packages get”。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="01cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">网络设置</strong> : <br/>现在是真正有趣的部分，女士们先生们。<br/>我们将连接到这个API<a class="ae lp" href="https://api.chucknorris.io/" rel="noopener ugc nofollow" target="_blank">https://api.chucknorris.io/</a>，它根据某些类别生成随机的查克·诺里斯笑话。</p><p id="29ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">从JSON生成你的模型</strong> : <br/>从<a class="ae lp" href="https://javiercbk.github.io/json_to_dart/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="mf">这个在线工具</em> </strong> </a> <strong class="ka ir"> <em class="mf">或者使用这个插件</em></strong>for Android Studio<a class="ae lp" href="https://plugins.jetbrains.com/plugin/11460-json2dart" rel="noopener ugc nofollow" target="_blank"><em class="mf">此处</em> </a> <em class="mf">或者</em> <a class="ae lp" href="https://github.com/typ0520/JsonToDartClass" rel="noopener ugc nofollow" target="_blank"> <em class="mf">此处</em></a><em class="mf"/><strong class="ka ir"><em class="mf"><em class="mf">(Preferences-Plugins)</em>我喜欢这个工具，因为几秒钟之内，您就可以从您的端点用大块JSON创建所有的模型，而无需编写一行代码。</em></strong></p><p id="b4c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只会到达两个终点。</p><pre class="lf lg lh li gt mg mh mi mj aw mk bi"><span id="d79a" class="ml mm iq mh b gy mn mo l mp mq"><a class="ae lp" href="https://api.chucknorris.io/jokes/categories" rel="noopener ugc nofollow" target="_blank">https://api.chucknorris.io/jokes/categories</a><br/>and<br/><a class="ae lp" href="https://api.chucknorris.io/jokes/random?category={category}" rel="noopener ugc nofollow" target="_blank">https://api.chucknorris.io/jokes/random?category={category}</a></span></pre><p id="6113" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一个只返回一个简单的字符串列表，所以只需要一个模型来保存字符串列表。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">卡盘类别模型</figcaption></figure><p id="f3df" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好，让我们开始第二个终点。转到<code class="fe na nb nc mh b"><a class="ae lp" href="https://api.chucknorris.io/jokes/random?category={category}" rel="noopener ugc nofollow" target="_blank">https://api.chucknorris.io/jokes/random?category={category}</a></code>并弹出类别变量的sport。您应该会看到类似这样的内容。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="9193" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里是一个小魔术发生的地方。进入在线转换器或简单地右击你的“模型”包。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/79735a09a5511a4696dc27eaaebaff57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h0o6_TtJbHwTujB6zFli4g.png"/></div></div></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/a4a0d67db5c4be0b374e5deeda64f705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XgKFBqArNAfOdGyeODA5oA.png"/></div></div></figure><p id="2994" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是你的下场。如果你在你的类的顶部插入了一个“包模型”,只要把它去掉就好了。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">chuckResponsemodel</figcaption></figure><p id="687f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好了，现在是有趣的网络部分。<br/>为了让我们的应用程序和API之间的通信数据流畅通无阻，我们需要三个API类来帮助我们。进入你的网络包。<br/>右击并创建一个新的Dart类，并将其命名为<strong class="ka ir">‘API provider’</strong>。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="821b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我们的主要API提供者类，目前有一个<strong class="ka ir"> GET </strong>和一些异常处理。如果您需要为自己的应用程序添加额外的方法，如Post、Delete或Put。</p><p id="5305" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们创建我们的<strong class="ka ir">【客户异常】</strong>类:</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="7382" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了处理UI线程上的所有API响应，我们需要一个API响应类(不是模型)。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="2b8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">…我们做到了！我们所有的网络层类完成。坐下来休息一下，欣赏一下你目前所做的事情。唷！难以置信，你是一个传奇。:)</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="nf lk l"/></div></figure><p id="721a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们去完成我们的应用程序的其余部分。</p><p id="138d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们添加存储库和块类。我们的存储库类充当我们数据源的“中间人”或“网关”,基本上充当UI和数据提供者(API)之间的抽象。</p><p id="a480" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只需要2个存储库类和2个blocs，因为如前所述，我们只需要2个端点。</p><p id="c3c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一个存储库类将用于我们的类别列表:</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">Chuck类别库</figcaption></figure><p id="e87a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的第二个将用于我们的主要chuck响应。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">卡盘仓库</figcaption></figure><p id="69a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">集团(<strong class="ka ir"> B </strong>业务<strong class="ka ir"> Lo </strong> gic <strong class="ka ir"> C </strong>组件)。BLoC表示与小部件(UI)对话的事件流。加载数据的块将通知UI小部件数据是否被加载、完成或者是否有错误。</p><p id="6873" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的集团:</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">卡盘类别块</figcaption></figure><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">卡盘块</figcaption></figure><p id="6ac8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">酷，是时候使用UI了！！</p><p id="79a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我喜欢把我所有的视图放在一起，所以把<strong class="ka ir"> <em class="mf"> main.dart </em> </strong>放到你的视图包中，但这完全取决于你。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="609f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在对Chuck categories UI屏幕的main.dart调用中启动我们的应用程序，如下所示。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">chuck_categories_view.dart</figcaption></figure><p id="ef63" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦所有这些都实现了，我们的类别将调用我们的' ShowChuckyJoke '屏幕。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ms lk l"/></div></figure><p id="00da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦所有事情都完成了，你应该以这样的方式结束。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ng lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">完成的项目。</figcaption></figure><p id="1718" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成的项目可以在这里找到:</p><div class="nh ni gp gr nj nk"><a href="https://github.com/rgodlontonshaw/apicallsboss" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">rgodlontonshaw/apicallsboss</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">API Flutter调用教程像一个Boss演示应用程序，展示使用Bloc的Flutter API调用的用法…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">github.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny jw nk"/></div></div></a></div><p id="02c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">祝大家编码快乐，飘飘欲仙。:)我希望这对您的API调用有所帮助。</p><p id="cc8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">鸣谢:此处为最初的概念<a class="ae lp" href="https://medium.com/flutter-community/handling-network-calls-like-a-pro-in-flutter-31bd30c86be1" rel="noopener">向</a><a class="ae lp" href="https://medium.com/@xsahil03x" rel="noopener">和<strong class="ka ir"> Sahil Kumar </strong>和</a>致敬。</p><p id="0a0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Ryan Godlonton-Shaw是一名全职高级移动工程师@Platform45和一名技术作家。</p><div class="nh ni gp gr nj nk"><a href="https://www.linkedin.com/in/ryangodlontonshaw/" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">Ryan Godlonton-Shaw -高级移动工程师-平台45 | LinkedIn</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">查看Ryan Godlonton-Shaw在世界上最大的职业社区LinkedIn上的个人资料。Ryan有一份工作列在…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">www.linkedin.com</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny jw nk"/></div></div></a></div></div></div>    
</body>
</html>
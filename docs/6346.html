<html>
<head>
<title>3 Reasons to Choose a Wide Cluster over Multi-Cluster with Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">选择宽集群而非Kubernetes多集群的3个理由</h1>
<blockquote>原文：<a href="https://itnext.io/3-reasons-to-choose-a-wide-cluster-over-multi-cluster-with-kubernetes-c923fecf4644?source=collection_archive---------0-----------------------#2021-10-21">https://itnext.io/3-reasons-to-choose-a-wide-cluster-over-multi-cluster-with-kubernetes-c923fecf4644?source=collection_archive---------0-----------------------#2021-10-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/21d98bc38f92ff8a544c2b7b223303eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*066W4nHYXSDHQNFjFv8law.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">多集群与宽集群</figcaption></figure><p id="55fd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在今年的KubeCon上，热门话题都是关于分布式Kubernetes: Edge、混合云和多云。</p><p id="2c08" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于这些主题中的每一个，都有无数的解决方案:<em class="la"> KubeEdge、OpenShift Edge、Akri、Baetyl、Kubermatic、Lens、Rancher、KubeFed、KubeSphere、Red Hat ACM、Liqo、Skupper、Linkerd、Fleet……</em></p><p id="0ad3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">…这个清单还在继续，继续，继续…你明白了。</p><p id="8932" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一件没有真正讨论过的事？您可以跨不同位置的服务器运行单个Kubernetes集群。您可以完全跳过所有新工具，像平常一样运行集群，但扩展到新环境。听起来很简单，对吧？</p><p id="00de" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这被称为“宽集群”或“扩展集群”，是逐渐流行的“多集群”模型的替代方案。在讨论为什么您可能希望实现宽集群而不是多集群架构之前，让我们讨论一些常见的问题和缺点。</p><h2 id="85e0" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated"><strong class="ak">潜伏期</strong></h2><p id="2c51" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">etcd(Kubernetes的“大脑”)是延迟不容忍的，所以如果你的控制平面节点相距太远，一个宽集群就不能工作。您通常也不希望在工作节点之间引入延迟，因为应用程序性能是一个问题。</p><p id="d208" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是，这两个问题都可以通过以下方式在大型集群中解决:</p><ul class=""><li id="e707" class="lz ma iq ke b kf kg kj kk kn mb kr mc kv md kz me mf mg mh bi translated">协同定位Etcd节点，或者使用非Ectd替代方案(dqlite，有人知道吗？)</li><li id="8bc6" class="lz ma iq ke b kf mi kj mj kn mk kr ml kv mm kz me mf mg mh bi translated">将节点标签应用于位置并将节点选择器用于应用程序</li></ul><p id="a4fc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">遵循这两个步骤，您就不需要担心跨云集群中的延迟。</p><h2 id="bddb" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated"><strong class="ak">安全</strong></h2><p id="c41d" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">如果您在云之间运行单个k8s集群，这可能意味着在公共网络上运行节点间流量，这可能很可怕。这也是一个挑战，因为您需要通过单个专用子网在所有节点之间提供直接连接。</p><p id="0334" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里的解决方案是在您的扩展集群下使用网状VPN(不，不是服务网状)。VPN将加密您的所有流量，并提供一个灵活的子网，您的所有节点可以直接和安全地通信。其实真的很酷。通常，由于子网的原因，您的节点被限制在非常特定的数据中心位置。有了网状VPN，子网可以存在于任何地方。</p><p id="9ef2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">除了节点间的流量安全之外，您可能还需要特别考虑访问控制。有多种方法可以从单个集群管理多租户访问，但是您可能更愿意使用多个集群来管理跨组的访问。没关系，我不会评判你。</p><h2 id="9683" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated"><strong class="ak">云成本</strong></h2><p id="28cd" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">您可能需要避免运行宽集群的首要原因是云成本。某些大型云提供商会向你收取高额的数据出口费。如果您在这样的云和您的数据中心之间运行工作节点，您将为此付费。尽管如此，正如我们将在下面讨论的，不管怎样，您可能最终会通过一个宽集群节省资金。</p><h2 id="63ac" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated"><strong class="ak">云支持</strong></h2><p id="53e6" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">大多数云托管的k8s选项不容易扩展到其他位置，这是有道理的，因为云提供商有充分的动机让你留在他们的云中。如果你被困在运行某些发行版，你可能只是被困住了。很抱歉这个我帮不了你，但是自我管理的Kubernetes得一分。</p><h1 id="a294" class="mn lc iq bd ld mo mp mq lg mr ms mt lj mu mv mw lm mx my mz lp na nb nc ls nd bi translated">那么为什么要运行一个宽集群呢？</h1><p id="a434" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">我们已经讨论了上面的问题，其中一些有简单的答案，而另一些比较难。综上所述，以下是您可能仍然想考虑运行一个宽Kubernetes集群作为多集群架构的替代方案的一些原因。</p><h2 id="21e8" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">原因1:没有复杂的工具</h2><p id="424e" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">正如在开始时所讨论的，有许多工具可以使用Kubernetes来运行和管理多集群、混合云和边缘计算。</p><p id="ec52" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这些工具和平台中有很大一部分需要全新的应用部署和操作框架，必须在您的所有集群中采用。</p><p id="f870" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">那是很多学问。这也让你高度依赖单一工具。他们的解决方案可能还需要依赖单一的k8s发行版或云提供商。</p><p id="f129" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">或者，使用单一的多云集群方法，您可以像使用标准集群一样运行您的操作。没有新工具，大大简化了操作。</p><h2 id="4560" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">原因2:没有额外的开销</h2><p id="2213" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">如果您正在运行大型、复杂的集群，那么您可能在所有集群中都有许多冗余组件。可能需要在每个集群中复制存储、网络、指标、日志、映像注册表、管道等。这些开销加起来。</p><p id="b2b0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此外，每个群集需要自己的控制平面，假设它们都是高可用性的，则每个群集有3个以上的额外节点。一些解决方案甚至需要整个额外的集群来管理操作！计算机变得昂贵。管理这么多基础设施也很昂贵。</p><p id="ef35" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">与之相比，在一个单一的宽集群中，有一个控制平面和一组服务来支持不同集群中的节点。您可以根据特定环境的需要添加特殊的工具，但您不需要<em class="la">提供</em>，这是一个关键的区别。</p><p id="631a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这就是为什么即使您因为特定云上的出口数据费用而对这种方法犹豫不决，您可能仍然希望权衡这些成本与运行多集群基础架构的成本。</p><h2 id="5ed0" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">原因3:终极灵活性</h2><p id="63fe" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">几乎不可能描述网状VPN(像<a class="ae ne" href="https://github.com/gravitl/netmaker" rel="noopener ugc nofollow" target="_blank"> Netmaker </a>)上的集群变得有多灵活。你给了它一个可扩展的网络基础，让它可以在新的环境中成长。</p><p id="2b73" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一个普通的集群总是占据数据中心的一个子网。当然，您可以在上面放置一些工具，让它执行一些奇特的操作，但是集群本身基本上受限于数据中心中的那个位置。</p><p id="4e7b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">另一方面，建立在网状VPN上的k8s集群可以<em class="la">增长。</em> <strong class="ke ir"> <em class="la"> </em> </strong>它可以扩展到新的地点。它的节点可以生活在任何他们需要的地方。你可以通过云计算找到新的提供商。您可以将节点弹出到边上。集群可以从一个地方转移到另一个地方。底层基础设施变得非常具有可塑性。</p><p id="9c80" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这就是为什么，即使你只是在一个云上运行一个集群，你可能还是想把它部署在一个网状VPN <em class="la">上，以防</em>发生变化。</p><h2 id="954d" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">包扎</h2><p id="0459" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">我希望您喜欢这篇关于网状VPN上的宽集群与标准多集群方法的优缺点的简短讨论。当然还有许多其他的考虑，但这应该作为一个快速入门。祝你的k8s之旅和下一次部署好运。下次见。</p></div></div>    
</body>
</html>
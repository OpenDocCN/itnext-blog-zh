<html>
<head>
<title>📟 Building Web based UIs for Terminals using JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">📟使用JavaScript构建基于Web的终端用户界面</h1>
<blockquote>原文：<a href="https://itnext.io/building-web-based-uis-for-terminals-using-javascript-60b5eee31213?source=collection_archive---------1-----------------------#2018-07-20">https://itnext.io/building-web-based-uis-for-terminals-using-javascript-60b5eee31213?source=collection_archive---------1-----------------------#2018-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b86d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于开发人员来说，他/她的大部分时间都花在代码编辑器或终端上。作为web开发人员，我们主要针对浏览器，现在甚至是本地移动平台(感谢React Native)。但是我最近发现，你也可以把终端作为你基于网络的用户界面的目标。</p><p id="a528" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我这么说是什么意思？</strong></p><p id="0494" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">类型:</em> <code class="fe km kn ko kp b"><strong class="jp ir">curl wttr.in</strong></code> <strong class="jp ir"> </strong>在你的终端。这个来自<a class="kq kr ep" href="https://medium.com/u/bae0a1a900e?source=post_page-----60b5eee31213--------------------------------" rel="noopener" target="_blank"> Igor Chubin </a>用python写的控制台应用程序启发了我写这篇博客。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/2aa15bf5ef032c635db7bda5cd2c9645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XYo-_6Sux0onCov7AMKVA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">伊戈尔·楚宾</figcaption></figure><p id="b924" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太神奇了！没错。所以，我决定深入研究一下，看看它是如何做到的。</p><h1 id="4d67" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">ANSI转义码</h1><blockquote class="mg mh mi"><p id="ec9e" class="jn jo kl jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><strong class="jp ir"> ANSI转义序列</strong>是<a class="ae mm" href="https://en.wikipedia.org/wiki/In-band_signaling" rel="noopener ugc nofollow" target="_blank">带内信令</a>的标准，用于控制视频<a class="ae mm" href="https://en.wikipedia.org/wiki/Text_terminal" rel="noopener ugc nofollow" target="_blank">文本终端</a>上的光标位置、颜色和其他选项。某些<a class="ae mm" href="https://en.wikipedia.org/wiki/Byte" rel="noopener ugc nofollow" target="_blank">字节</a>的序列，大部分以<a class="ae mm" href="https://en.wikipedia.org/wiki/Escape_character" rel="noopener ugc nofollow" target="_blank"> Esc </a>和“<a class="ae mm" href="https://en.wikipedia.org/wiki/Bracket" rel="noopener ugc nofollow" target="_blank"> [ </a>”开始，被嵌入到文本中，终端寻找并解释为命令，而不是<a class="ae mm" href="https://en.wikipedia.org/wiki/Character_encoding" rel="noopener ugc nofollow" target="_blank">字符代码</a>。</p></blockquote><p id="e895" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本质上，ANSI转义码是终端以特殊方式解释的字符。这些代码可用于给文本添加颜色、控制光标位置等。所有主要终端都支持这些代码，包括Windows😉。</p><blockquote class="mg mh mi"><p id="06b5" class="jn jo kl jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">2016年随着<a class="ae mm" href="https://en.wikipedia.org/wiki/Windows_10" rel="noopener ugc nofollow" target="_blank">Windows 10</a>“Threshold 2”<a class="ae mm" href="https://en.wikipedia.org/wiki/ANSI_escape_code#cite_note-win10th2-1" rel="noopener ugc nofollow" target="_blank">【1】</a>微软出人意料地开始支持ANSI转义序列</p></blockquote><p id="b5e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ANSI转义码如何工作的具体细节将不在这里讨论。维基百科上有一篇关于这个的优秀文章:<a class="ae mm" href="https://en.wikipedia.org/wiki/ANSI_escape_code" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/ANSI_escape_code</a></p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="1261" class="li lj iq bd lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf bi translated"><strong class="ak">在我们编码之前，更多的灵感例子</strong></h1><p id="250c" class="pw-post-body-paragraph jn jo iq jp b jq mz js jt ju na jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">在我们着手解决这个问题之前，我想分享一些更棒的例子:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ne"><img src="../Images/fc78bf8ce34875fa919c623a84026d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gbQG15IqrXTQMSNqzYhCVA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">rate.sx作者<a class="kq kr ep" href="https://medium.com/u/bae0a1a900e?source=post_page-----60b5eee31213--------------------------------" rel="noopener" target="_blank">伊戈尔·楚宾</a></figcaption></figure><p id="6193" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b"><strong class="jp ir">curl rate.sx</strong></code></p><p id="5a35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个来自<a class="kq kr ep" href="https://medium.com/u/bae0a1a900e?source=post_page-----60b5eee31213--------------------------------" rel="noopener" target="_blank">伊戈尔·楚宾</a>。这个甚至有图表😲。这太疯狂了。！</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6cf84275c4b172aa9dd3b984ae48dc18.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*3Jt7YxgDVu4H93O6"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">parrot.live by <a class="kq kr ep" href="https://medium.com/u/62e3de0825f2?source=post_page-----60b5eee31213--------------------------------" rel="noopener" target="_blank">雨果</a></figcaption></figure><p id="f1c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b"><strong class="jp ir">curl parrot.live</strong></code></p><p id="17fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是雨果的作品。这有一只动画派对鹦鹉！！</p><p id="7e53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多酷啊！！！</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ng nh l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">byemck.atulr.com由<a class="kq kr ep" href="https://medium.com/u/4bfc4b7040a8?source=post_page-----60b5eee31213--------------------------------" rel="noopener" target="_blank">阿图</a></figcaption></figure><blockquote class="mg mh mi"><p id="a480" class="jn jo kl jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><code class="fe km kn ko kp b"><strong class="jp ir">curl byemck.atulr.com</strong></code> <strong class="jp ir"> </strong>或<strong class="jp ir"> <br/> </strong> <code class="fe km kn ko kp b"><strong class="jp ir">curl byeiz.atulr.com</strong></code></p></blockquote><p id="2e9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我前一份工作的最后一天做的。想体面地告别😉</p><p id="19fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mm" href="https://github.com/master-atul/byemck" rel="noopener ugc nofollow" target="_blank">https://github.com/master-atul/byemck</a></p><p id="4e4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">还有更多例子列在:</em><a class="ae mm" href="https://github.com/chubin/awesome-console-services" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://github.com/chubin/awesome-console-services</em></a></p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="2f30" class="li lj iq bd lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf bi translated">为什么会有人建这些？</h1><ul class=""><li id="d9e1" class="ni nj iq jp b jq mz ju na jy nk kc nl kg nm kk nn no np nq bi translated">所以你会注意到一件有趣的事情，当你用浏览器点击<code class="fe km kn ko kp b"><strong class="jp ir">wttr.in</strong></code>，你会得到一个简单的基于HTML &amp; CSS的网页。但是当你使用<code class="fe km kn ko kp b">curl </code>或<code class="fe km kn ko kp b">wget </code>点击它时，你会得到一个ANSI编码的文本作为响应。所以，现在可以直接针对终端用户(dev)了。例如，开发人员现在可以在他们的终端上直接查看带有颜色编码和语法突出显示的在线文档，而无需在单独的浏览器上打开网页。</li><li id="9eae" class="ni nj iq jp b jq nr ju ns jy nt kc nu kg nv kk nn no np nq bi translated">好奇心😬；我不知道你怎么想，但是这些演示足以让我尝试使用NodeJS来构建它。</li></ul><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nw"><img src="../Images/490e6c817ac546d27776e867b2d43c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/0*qb7yHl8PVc8Ns0Ig.jpg"/></div></div></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="5b60" class="li lj iq bd lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf bi translated">让我们使用JavaScript (NodeJS)来构建这些</h1><blockquote class="nx"><p id="213d" class="ny nz iq bd oa ob oc od oe of og kk dk translated">完整的源代码可以在这里找到:<a class="ae mm" href="https://github.com/master-atul/console-web-ui" rel="noopener ugc nofollow" target="_blank">https://github.com/a7ul/console-web-ui</a></p></blockquote><h2 id="bf01" class="oh lj iq bd lk oi oj dn lo ok ol dp ls jy om on lw kc oo op ma kg oq or me os bi translated"><strong class="ak">第一步:简单的hello world </strong></h2><p id="d524" class="pw-post-body-paragraph jn jo iq jp b jq mz js jt ju na jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">由于这是一个web API，我将使用express.js来构建一个使用nodejs的简单API服务器。遵循这里的指南:<a class="ae mm" href="https://expressjs.com/en/starter/hello-world.html" rel="noopener ugc nofollow" target="_blank">https://expressjs.com/en/starter/hello-world.html</a>制作一个简单的express js API服务器。</p><p id="ddc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在输入:<code class="fe km kn ko kp b">node app.js</code>来启动服务器。<br/>在另一个端子类型:<code class="fe km kn ko kp b">curl localhost:3000</code>。您应该看到:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ot"><img src="../Images/300be7eac3919d5a964def40059a506d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nW4O4tp_pOnaAB27tRh9dw.png"/></div></div></figure><p id="8b00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，世界准备好了😆</p><h2 id="cf75" class="oh lj iq bd lk oi ou dn lo ok ov dp ls jy ow on lw kc ox op ma kg oy or me os bi translated"><strong class="ak">下一步:给文本添加颜色</strong></h2><p id="f47b" class="pw-post-body-paragraph jn jo iq jp b jq mz js jt ju na jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">如前所述，我们需要ANSI代码来将彩色输出到屏幕上。幸运的是，有一个非常好的<code class="fe km kn ko kp b">npm</code>模块可以解决这个问题。<a class="ae mm" href="https://github.com/chalk/ansi-styles" rel="noopener ugc nofollow" target="_blank">https://github.com/chalk/ansi-styles</a></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/875cc915b0063861a431fdd8c7ea7af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*FAARTvVre_6iclGo-tp0Qg.jpeg"/></div></figure><p id="712e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看彩色的hello world是什么样子的。</p><pre class="kt ku kv kw gt pa kp pb pc aw pd bi"><span id="332a" class="oh lj iq kp b gy pe pf l pg ph">const style = require('ansi-styles');</span><span id="15bf" class="oh lj iq kp b gy pi pf l pg ph">const express = require('express');                                               </span><span id="2fcd" class="oh lj iq kp b gy pi pf l pg ph">const hello = () =&gt;`                          ${style.green.open}Hello Green!${style.green.close}                         ${style.red.open}Hello Red!${style.red.close}                       `;                                               </span><span id="7370" class="oh lj iq kp b gy pi pf l pg ph">const app = express();                       </span><span id="1960" class="oh lj iq kp b gy pi pf l pg ph">app.get('/hello', (req, res) =&gt; {                          <br/>   res.send(hello());                       <br/>});                       </span><span id="b1cb" class="oh lj iq kp b gy pi pf l pg ph">const PORT = process.env.PORT || 3000; <br/>                      <br/>app.listen(PORT, () =&gt; console.log(`Example app listening on port ${PORT}!`));</span></pre><p id="169d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl"> app.js </em> </strong></p><p id="ee3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该在<code class="fe km kn ko kp b">curl <a class="ae mm" href="http://localhost:3000/hello" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/hello</a></code>上得到以下输出</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi pj"><img src="../Images/b8341d3ad3158c93728c096c9fc8f4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*apVpTcln62I8QNnNIVhBqQ.png"/></div></div></figure><h2 id="b5fb" class="oh lj iq bd lk oi ou dn lo ok ov dp ls jy ow on lw kc ox op ma kg oy or me os bi translated">动画呢？</h2><p id="fc6a" class="pw-post-body-paragraph jn jo iq jp b jq mz js jt ju na jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">动画是一系列连续的帧，给人一种某物在移动的印象。为此，我们需要向客户端发送多个帧，并在显示下一帧之前清除旧帧。</p><ul class=""><li id="9440" class="ni nj iq jp b jq jr ju jv jy pk kc pl kg pm kk nn no np nq bi translated">为了向客户端发送多帧数据，我们将使用<code class="fe km kn ko kp b">node streams</code>。</li><li id="f771" class="ni nj iq jp b jq nr ju ns jy nt kc nu kg nv kk nn no np nq bi translated">为了在显示下一帧之前清空屏幕，我们可以使用一个特殊的ANSI代码<code class="fe km kn ko kp b">\033[2J\033[H</code></li></ul><p id="98ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们想在控制台上显示每秒都在变化的当前服务器时间。因此，我们的输出将如下所示:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi pn"><img src="../Images/9bf12b63ba6b6f31cfcdcac680c182f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BB_wTIoOds-vSFljTVN5rg.gif"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">使用curl动画显示当前时间—注意秒(它会改变😆)</figcaption></figure><p id="55cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码如下所示:</p><pre class="kt ku kv kw gt pa kp pb pc aw pd bi"><span id="795b" class="oh lj iq kp b gy pe pf l pg ph">const express = require("express");<br/>const { Readable } = require("stream");</span><span id="2cbb" class="oh lj iq kp b gy pi pf l pg ph">// This is the special ANSI code to tell terminals to clear the screen</span><span id="4495" class="oh lj iq kp b gy pi pf l pg ph">const PAGE_BREAK = "\033[2J\033[H";</span><span id="4ba8" class="oh lj iq kp b gy pi pf l pg ph">// This function gets the current date in string format along<br/>// with a page break on top.<br/>// Note that you would need to add a new line for the terminal to<br/>// interpret it. That is `hello` will not work while `hello\n` will.</span><span id="d93d" class="oh lj iq kp b gy pi pf l pg ph">const getDate = () =&gt; `<br/>  ${PAGE_BREAK}<br/>  ${new Date()}<br/>`;</span><span id="df00" class="oh lj iq kp b gy pi pf l pg ph">// This function initialises the stream for node</span><span id="6531" class="oh lj iq kp b gy pi pf l pg ph">const getStream = (req, res) =&gt; {<br/>   const stream = new Readable();<br/>   stream.pipe(res);<br/>   stream._read = () =&gt; {};<br/>   req.on("close", () =&gt; {<br/>     stream.destroy();<br/>   });<br/>   return stream;<br/>};</span><span id="6b9c" class="oh lj iq kp b gy pi pf l pg ph">// This is used to add delay between frames.<br/>// Its just waits for a said millisec before resolving the promise</span><span id="95cc" class="oh lj iq kp b gy pi pf l pg ph">const delay = async (milliseconds = 0) =&gt;<br/>   new Promise((resolve) =&gt; {<br/>      setTimeout(() =&gt; resolve(), milliseconds);<br/>   }<br/>);</span><span id="c2d8" class="oh lj iq kp b gy pi pf l pg ph">// animateHello is the main function which pushes each frame<br/>// of animation in a delay of 1sec (max 30 times)</span><span id="fa43" class="oh lj iq kp b gy pi pf l pg ph">const animateHello = async (stream) =&gt; {<br/>  for (let i = 0; i &lt; 30; i += 1) {<br/>     stream.push(getDate());<br/>     await delay(1000);<br/>  }<br/>  stream.push(null); //This ends the stream.<br/>};</span><span id="c6ad" class="oh lj iq kp b gy pi pf l pg ph">// App initialisation</span><span id="d31f" class="oh lj iq kp b gy pi pf l pg ph">const app = express();</span><span id="623d" class="oh lj iq kp b gy pi pf l pg ph">// route</span><span id="8a6d" class="oh lj iq kp b gy pi pf l pg ph">app.get("/anime-hello", async (req, res) =&gt; {<br/>   const stream = getStream(req, res);<br/>   await animateHello(stream);<br/>});</span><span id="32a3" class="oh lj iq kp b gy pi pf l pg ph">const PORT = process.env.PORT || 3000;</span><span id="c57f" class="oh lj iq kp b gy pi pf l pg ph">app.listen(PORT, () =&gt; <br/>   console.log(`Example app listening on port ${PORT}!`)<br/>);</span></pre><h2 id="343c" class="oh lj iq bd lk oi ou dn lo ok ov dp ls jy ow on lw kc ox op ma kg oy or me os bi translated">如果浏览器和终端可以使用相同的路由会怎样？</h2><p id="0454" class="pw-post-body-paragraph jn jo iq jp b jq mz js jt ju na jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">理想情况下，如果我们在浏览器上点击一个URL，我们应该得到HTML和CSS响应，而如果我们从curl或终端上点击它，我们应该得到终端理解的文本格式的响应。</p><p id="9dd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">我是什么意思？好的，试着在浏览器上打开<code class="fe km kn ko kp b">wttr.in</code>——你应该会看到基于HTML、CSS的网站正在加载。现在试试<code class="fe km kn ko kp b">curl wttr.in</code>，同一个URL现在返回终端可以理解的基于文本的输出。</em></strong></p><p id="ee4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在expressjs中实现这一点。我们将使用<code class="fe km kn ko kp b">next</code>的概念。</p><pre class="kt ku kv kw gt pa kp pb pc aw pd bi"><span id="0135" class="oh lj iq kp b gy pe pf l pg ph">const express = require('express');  <br/>                     <br/>const hello = require('./src/ansi/animations/hello');                                               const PORT = process.env.PORT || 3000;                                               const app = express();<br/>                                               <br/>// simple hello route                       <br/>app.get('/hello', async (req, res, next) =&gt; {</span><span id="1061" class="oh lj iq kp b gy pi pf l pg ph">const userAgent = req.headers['user-agent']; <br/>    // checking the useragent                         <br/>    const isCommandline = (userAgent.search(/curl|wget/i) !== -1); <br/>    <br/>    if (isCommandline) {      <br/>       await res.send(hello.hello()); <br/>     // This handles the route if the request came from curl or wget                          <br/>      return null;<br/>    }<br/>    return next(); <br/>    // This passes the control to the next matching route handler<br/>});</span><span id="1ad0" class="oh lj iq kp b gy pi pf l pg ph">app.use('/hello', express.static('static/hello/index.html'));</span><span id="1d59" class="oh lj iq kp b gy pi pf l pg ph">app.listen(PORT, () =&gt; {<br/>  console.log(`Example app listening on port ${PORT}!`);<br/>});</span></pre><h2 id="39e3" class="oh lj iq bd lk oi ou dn lo ok ov dp ls jy ow on lw kc ox op ma kg oy or me os bi translated"><strong class="ak">输出:</strong></h2><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi po"><img src="../Images/ed60b12c5999bd2181c83ffd7f37b4f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*uXsgarwDakK01v3T6efb9Q.png"/></div></figure><p id="77bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在当你运行<br/> <code class="fe km kn ko kp b">curl <a class="ae mm" href="http://localhost:3000/hello" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/hello</a></code></p><p id="c99b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">⬅，你听到了吗</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi pp"><img src="../Images/509b871b45626551b08e8ecfa3210508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R4s3IMThoGM7nfnUkvLPwg.png"/></div></div></figure><p id="526d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在浏览器中打开链接，你会看到你制作的HTML页面。</p><p id="315d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个例子是在https://console-web-ui.herokuapp.com/<a class="ae mm" href="https://console-web-ui.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">的heroku上</a></p><blockquote class="nx"><p id="2232" class="ny nz iq bd oa ob oc od oe of og kk dk translated"><strong class="ak">这个博客的所有代码都在:</strong></p><p id="f1fd" class="ny nz iq bd oa ob oc od oe of og kk dk translated"><a class="ae mm" href="https://github.com/master-atul/console-web-ui/" rel="noopener ugc nofollow" target="_blank"><strong class="ak">https://github.com/a7ul/console-web-ui/</strong></a></p></blockquote><p id="c764" class="pw-post-body-paragraph jn jo iq jp b jq pq js jt ju pr jw jx jy ps ka kb kc pt ke kf kg pu ki kj kk ij bi translated">我希望这很有趣😬🎉请在twitter上关注我@a7ulr/</p></div></div>    
</body>
</html>
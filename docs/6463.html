<html>
<head>
<title>CNCF Linkerd Cheat Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Cheat林克德备忘单</h1>
<blockquote>原文：<a href="https://itnext.io/cncf-linkerd-cheat-sheet-32cb206ec899?source=collection_archive---------4-----------------------#2021-11-22">https://itnext.io/cncf-linkerd-cheat-sheet-32cb206ec899?source=collection_archive---------4-----------------------#2021-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b9cb9176cc08d0e3d9dac78de37bc122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F3_rg5UHOgTrLUVeUqw8TA.jpeg"/></div></div></figure><blockquote class="jy jz ka"><p id="22e6" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Kubernetes超轻、安全第一的服务网。Linkerd 2.x的主回购</p></blockquote><ul class=""><li id="af9d" class="la lb iq ke b kf kg kj kk lc ld le lf lg lh kz li lj lk ll bi translated"><a class="ae lm" href="https://github.com/linkerd/linkerd2" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="3856" class="la lb iq ke b kf ln kj lo lc lp le lq lg lr kz li lj lk ll bi translated"><a class="ae lm" href="https://linkerd.io/2.11/overview/" rel="noopener ugc nofollow" target="_blank">文件</a></li></ul><h1 id="3e1d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">装置</h1><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="6cee" class="mz lt iq mv b gy na nb l nc nd">curl -fsL <a class="ae lm" href="https://run.linkerd.io/install" rel="noopener ugc nofollow" target="_blank">https://run.linkerd.io/install</a> | sh</span></pre><h2 id="3899" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">设置集群</h2><p id="d6b8" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">使用<a class="ae lm" href="https://kind.sigs.k8s.io/docs/user/quick-start/" rel="noopener ugc nofollow" target="_blank">类</a>集群</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="bd69" class="mz lt iq mv b gy na nb l nc nd">kind create cluster --name cncf-cheat-sheet<br/>linkerd check --pre<br/>linkerd install | kubectl apply -f -<br/>linkerd check</span></pre><h2 id="839e" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">演示应用程序</h2><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="5594" class="mz lt iq mv b gy na nb l nc nd">curl -fsL <a class="ae lm" href="https://run.linkerd.io/emojivoto.yml" rel="noopener ugc nofollow" target="_blank">https://run.linkerd.io/emojivoto.yml</a> | kubectl apply -f -</span></pre><h1 id="51f3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">自动完成</h1><h2 id="763e" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">尝试</h2><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="6469" class="mz lt iq mv b gy na nb l nc nd">echo "source &lt;(linkerd completion bash) &gt;&gt; ~/.bashrc"</span></pre><h2 id="ddc8" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">Zsh</h2><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="1805" class="mz lt iq mv b gy na nb l nc nd">source &lt;(linkerd completion zsh)</span></pre><h1 id="95b0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">基础</h1><h2 id="2ce3" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">注射</h2><p id="5525" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">更新部署批注“linkerd.io/inject: enabled”。因此linkerd控制平面知道在pod创建期间插入一个侧柜。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="b58f" class="mz lt iq mv b gy na nb l nc nd">kubectl get deploy -o yaml | linkerd inject - | kubectl apply -f -</span></pre><h1 id="9562" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">交通操纵</h1><p id="5696" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">使用<a class="ae lm" href="https://linkerd.io/2.11/reference/service-profiles/" rel="noopener ugc nofollow" target="_blank">服务配置文件</a> CRD来管理和操作进入服务的流量。</p><h2 id="4224" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">分流流量</h2><p id="2897" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">将去往“svc-a”的流量的33%发送到“svc-b”。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="9157" class="mz lt iq mv b gy na nb l nc nd">cat &lt;&lt;EOF | kubectl apply -f -<br/>apiVersion: split.smi-spec.io/v1alpha1<br/>kind: TrafficSplit<br/>metadata:<br/>  name: traffic-split<br/>spec:<br/>  service: svc-a<br/>  backends:<br/>  - service: svc-a<br/>    weight: 2<br/>  - service: svc-b<br/>    weight: 1</span></pre><h2 id="b988" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">超时设定</h2><p id="add9" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">将进入服务的所有请求的HTTP超时设置为10秒。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d8ec" class="mz lt iq mv b gy na nb l nc nd">cat &lt;&lt; EOF | kubectl apply -f -<br/>apiVersion: linkerd.io/v1alpha2<br/>kind: ServiceProfile<br/>metadata:<br/>  name: svc-name.namespace.svc.cluster.local<br/>  namepspace: default<br/>spec:<br/>  routes:<br/>  - name: 'all'<br/>    conditions:<br/>    - pathRegex: /*<br/>    timeout: 30s</span></pre><h2 id="320b" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">重试次数</h2><p id="d4de" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">对于具有空主体的幂等路由</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="a67c" class="mz lt iq mv b gy na nb l nc nd">cat &lt;&lt; EOF | kubectl apply -f -<br/>apiVersion: linkerd.io/v1alpha2<br/>kind: ServiceProfile<br/>metadata:<br/>  name: svc-name.namespace.svc.cluster.local<br/>  namepspace: default<br/>spec:<br/>  routes:<br/>  - name: 'route-name'<br/>    conditions:<br/>    - pathRegex: /*<br/>    isRetryable: true</span></pre><p id="0659" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lc ko kp kq le ks kt ku lg kw kx ky kz ij bi translated">重试预算</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="331f" class="mz lt iq mv b gy na nb l nc nd">cat &lt;&lt; EOF | kubectl apply -f -<br/>apiVersion: linkerd.io/v1alpha2<br/>kind: ServiceProfile<br/>metadata:<br/>  name: svc-name.namespace.svc.cluster.local<br/>  namepspace: default<br/>spec:<br/>  routes:<br/>  - name: 'route-name'<br/>    conditions:<br/>    - pathRegex: /*<br/>  retryBudget:<br/>    retryRatio: 0.2<br/>    minRetriesPerSecond: 10<br/>    ttl: 10s</span></pre><h1 id="dfe1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">扩展ˌ扩张</h1><h2 id="16ef" class="mz lt iq bd lu ne nf dn ly ng nh dp mc lc ni nj mg le nk nl mk lg nm nn mo no bi translated">即</h2><p id="0d7d" class="pw-post-body-paragraph kb kc iq ke b kf np kh ki kj nq kl km lc nr kp kq le ns kt ku lg nt kx ky kz ij bi translated">Viz extension将度量堆栈添加到集群中。</p><p id="c5ed" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lc ko kp kq le ks kt ku lg kw kx ky kz ij bi translated">安装</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="0a51" class="mz lt iq mv b gy na nb l nc nd">linkerd viz install | kubectl apply -f -</span></pre><p id="5d40" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lc ko kp kq le ks kt ku lg kw kx ky kz ij bi translated">运行仪表板UI</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="f414" class="mz lt iq mv b gy na nb l nc nd">linkerd viz dashboard</span></pre></div></div>    
</body>
</html>
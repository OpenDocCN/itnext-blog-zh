<html>
<head>
<title>Migrate your app to Android Oreo — Part 2 BroadcastReceivers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将您的应用迁移到Android Oreo——第2部分广播接收器</h1>
<blockquote>原文：<a href="https://itnext.io/migrate-your-app-to-android-oreo-part-2-broadcastreceivers-3f1f12f764fc?source=collection_archive---------2-----------------------#2018-06-15">https://itnext.io/migrate-your-app-to-android-oreo-part-2-broadcastreceivers-3f1f12f764fc?source=collection_archive---------2-----------------------#2018-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="16e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上一篇文章中，我解释了如果你想在Android Oreo中调用“startService()”你必须做的一些改变。</p><p id="71bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我将尝试解释如果你想使用<strong class="jp ir"> BroadcastReceivers </strong>你必须完成的一系列改变。但是，当你瞄准Android Oreo时，不要忘记记住所有受影响的Android部分:</p><ol class=""><li id="0cf9" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated"><a class="ae ku" rel="noopener ugc nofollow" target="_blank" href="/migrate-your-app-to-android-oreo-e0fa794b1d21">服务—背景限制</a></li><li id="afe5" class="kl km iq jp b jq kv ju kw jy kx kc ky kg kz kk kq kr ks kt bi translated"><strong class="jp ir">广播接收机</strong></li><li id="2700" class="kl km iq jp b jq kv ju kw jy kx kc ky kg kz kk kq kr ks kt bi translated"><a class="ae ku" rel="noopener ugc nofollow" target="_blank" href="/migrate-your-app-to-android-oreo-part-3-notifications-b59d7c6313f9">通知</a></li><li id="b1a3" class="kl km iq jp b jq kv ju kw jy kx kc ky kg kz kk kq kr ks kt bi translated">运行时权限</li><li id="5f2e" class="kl km iq jp b jq kv ju kw jy kx kc ky kg kz kk kq kr ks kt bi translated">警告</li><li id="8567" class="kl km iq jp b jq kv ju kw jy kx kc ky kg kz kk kq kr ks kt bi translated">Firebase云消息传递(截止日期:2019年4月)</li></ol><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi la"><img src="../Images/7f4ac5a1f362b822c76ac4dd0af3ee98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*-v21b8D6aYUchWEdLT2QuA.gif"/></div></figure><h1 id="ef88" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">安卓奥利奥中的广播接收器</strong></h1><p id="a110" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">本质上，Android Oreo中BroadcastReceivers的问题是，所有我们在AndroidManifest.xml中声明并侦听隐式意图的BroadcastReceivers将不再接收这些广播(有一些情况是允许的)。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/319b0c099d8ea2d37401b98befd02237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*443M1x-ydOuLTGP_py55xg.png"/></div></div></figure><p id="eb3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，什么是隐含意图？</p><p id="1fd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Android中，我们有两种意图去做一个动作:</p><ul class=""><li id="d778" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mq kr ks kt bi translated"><em class="mr">隐含意图</em>:不要命名一个特定的组件，而是声明一个要执行的通用动作。隐含意图的一个例子可能是当我们想要打开一个url时，在这种情况下，我们做类似这样的事情:</li></ul><pre class="lb lc ld le gt ms mt mu mv aw mw bi"><span id="14d7" class="mx lj iq mt b gy my mz l na nb">val browserIntent = Intent(Intent.ACTION_VIEW, URL);<br/>startActivity(browserIntent);</span></pre><ul class=""><li id="f1fb" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mq kr ks kt bi translated"><em class="mr">明确意图</em>:指定哪个组件将要采取动作，用户不能什么都不做。例如，当我们发起一项活动时，我们会制作这样的东西:</li></ul><pre class="lb lc ld le gt ms mt mu mv aw mw bi"><span id="51d7" class="mx lj iq mt b gy my mz l na nb">val intent = Intent(context, ActivityB::class).</span></pre><p id="11fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，如果我们在AndroidManifest.xml中声明了一个BroadcastReceiver，并且正在侦听隐式意图(不在actions白名单中),那么它将不会接收广播。</p><p id="c49a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是允许的隐含意图:</p><p id="ee15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ku" href="https://developer.android.com/guide/components/broadcast-exceptions" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/guide/components/broadcast-exceptions</a></p><p id="2d7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，如果我们要声明一个broadcastReceiver，并且这是在侦听一个自定义操作，我们必须声明将捕获该操作的类:</p><pre class="lb lc ld le gt ms mt mu mv aw mw bi"><span id="4851" class="mx lj iq mt b gy my mz l na nb">&lt;!-- BROADCAST RECEIVER --&gt;<br/>&lt;receiver android:name="your.package.BroadCastReceiver"&gt;<br/>    &lt;intent-filter&gt;<br/>        &lt;action android:name="your.action" /&gt;<br/>    &lt;/intent-filter&gt;<br/>&lt;/receiver&gt;</span></pre><p id="cde3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有关广播接收器的更多信息:</p><p id="c71f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ku" href="https://developer.android.com/guide/components/broadcasts" rel="noopener ugc nofollow" target="_blank">https://developer.android.com/guide/components/broadcasts</a></p></div></div>    
</body>
</html>
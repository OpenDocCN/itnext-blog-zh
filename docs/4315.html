<html>
<head>
<title>How to access the Web from tools and terminals in corporate environments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从企业环境中的工具和终端访问Web</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-access-the-web-from-tools-and-terminals-in-corporate-environments-d822f77acba9?source=collection_archive---------2-----------------------#2020-06-06">https://itnext.io/how-to-access-the-web-from-tools-and-terminals-in-corporate-environments-d822f77acba9?source=collection_archive---------2-----------------------#2020-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="192e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在大中型公司中，几乎总是这样，你的网络流量必须通过公司代理才能到达网络。以下是如何找到更多关于代理的信息。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/da302f643dff72f41289497331a9dcce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z8AOE2oRbml7sWBL2vU1yw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图片由<a class="ae le" href="https://unsplash.com/@dillonwinspear" rel="noopener ugc nofollow" target="_blank">狄龙·温斯皮尔</a>提供</figcaption></figure><p id="6e3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇文章中，我会给你一些提示，告诉你如何发现哪个/哪些代理被使用(如果有的话)。我还将提到更复杂的IT环境如何使用自动代理发现协议(WPAD)和pac文件处理代理设置，执行TLS终止，有时甚至只允许特定的用户代理通过。最后，我将告诉您如何配置您的应用程序和命令行工具来访问Web。</p><p id="2b4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们将看到的，在基本环境中，您只需查看设置即可找到代理的URL/IP/端口。在更复杂的环境中，您需要分析pac文件来找出这些问题。</p><h1 id="8ff8" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">为什么和一个小警告</h1><p id="ee06" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">首先，给你一个建议:通常网络流量都有严格的安全策略。确保你没有做违反这些政策的事情。如果你不确定，在做任何可能让你陷入困境的事情之前，先问问网络/安全团队/ CISO。</p><p id="5839" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可能出于多种原因想要了解更多关于正在使用的公司代理的信息。第一个可能是好奇心，这可能是最糟糕的原因。另一个更有效的方法是能够从您的开发工具和/或终端访问Web。</p><p id="28d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就我个人而言，我经常需要Web访问来下载某些工具/下载NPM/maven/随便什么包，等等。通常我希望我的工具能够做到这一点，或者至少能够从终端做到这一点。</p><p id="8c06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在任何情况下，请务必联系安全和网络团队，看看是否有既定/公认的解决方案可以让您随心所欲。安全总比后悔好；-)</p><p id="846a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你知道自己在做什么，那就继续读下去。</p><h1 id="1ea8" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">找出使用了哪些代理的一些方法</h1><p id="2fc8" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">一些“基本”环境只是通过系统配置(通常在Windows环境中通过组策略等来定义/实施)来实施一个代理(或一组代理)，这可以通过Internet Explorer (meh)来检查:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/aeb3030793675a4d6e3c0c5fb5dc570e.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*4lBmcPwVJ4HAkcjP7GEWFw.jpeg"/></div></figure><p id="e72c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可能已经见过这个窗口至少一次了；-)</p><p id="c795" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要到达那个屏幕，你可以看看这篇微软知识库文章:<a class="ae le" href="https://support.microsoft.com/en-ph/help/4551930/using-proxy-servers-together-with-internet-explorer" rel="noopener ugc nofollow" target="_blank">https://support . Microsoft . com/en-ph/help/4551930/using-proxy-servers-together-with-internet-explorer</a></p><p id="4c15" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关于Edge，看这篇文章:<a class="ae le" href="https://www.windowscentral.com/how-set-proxy-edge-windows-10" rel="noopener ugc nofollow" target="_blank">https://www . windows central . com/how-set-proxy-Edge-windows-10</a></p><p id="47fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你可以通过上面的任何一个直接看到代理设置，那么你就完成了，可能没有必要再看了；只需获取主机/IP/端口。</p><p id="d15f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你使用的是Windows 10，另一种方法是通过操作系统的设置应用程序查看代理设置，如下所述:<a class="ae le" href="https://helpdeskgeek.com/networking/internet-connection-problem-proxy-settings/" rel="noopener ugc nofollow" target="_blank">https://helpdesgeek . com/networking/internet-connection-problem-Proxy-Settings/</a>(该文章还介绍了如何发现OSX &amp; Linux的代理设置)。</p><p id="dcc5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Google Chrome中，您可能可以访问以下设置页面:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="4e1c" class="mo lg it mk b gy mp mq l mr ms">chrome://net-internals/#proxy</span></pre><p id="e680" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Mozilla Firefox中，您可以看到同样的情况:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="c923" class="mo lg it mk b gy mp mq l mr ms">about:preferences#advanced</span></pre><p id="bbab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有访问Windows注册表的权限，那就太容易了；只看下面这个键:<code class="fe mt mu mv mk b">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings</code>。</p><p id="e34d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者通过命令行:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="3c5b" class="mo lg it mk b gy mp mq l mr ms">reg query "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" | find /i "proxyserver"</span></pre><p id="383e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您是这台机器的管理员(您可能永远都不应该是管理员！)，那么你也可以以管理员身份运行以下命令:<code class="fe mt mu mv mk b">netsh winhttp show proxy</code>。</p><p id="7835" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想得到花式，你可以通过PowerShell得到同样的信息:<code class="fe mt mu mv mk b">Get-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings' | findstr ProxyServer</code></p><h1 id="2384" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">代理自动配置(PAC)</h1><p id="fe3c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">代理自动配置(PAC)文件是(不那么)神奇的文件，它描述了让Web浏览器(和其他用户代理)为给定的URL选择使用哪个代理服务器的规则。</p><p id="0402" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当Web浏览器被配置为使用pac文件时，无论何时需要访问网络，它都会调用PAC文件中定义的<code class="fe mt mu mv mk b">FindProxyForURL</code>函数，以确定要使用的代理服务器(如果有)。</p><p id="b06c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通常，强制流量通过代理的公司定义PAC文件，指示用户代理直接连接到目标(例如，对于内部IP范围/内部DNS域)，或者通过特定代理连接。</p><p id="dc74" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这样的环境中，PAC文件才是您真正想要的；它包含了你需要的所有信息。</p><p id="1253" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一个示例PAC文件，取自<a class="ae le" href="https://findproxyforurl.com/example-pac-file/" rel="noopener ugc nofollow" target="_blank">这里</a>:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="8a14" class="mo lg it mk b gy mp mq l mr ms">function FindProxyForURL(url, host) {<br/>  // If the hostname matches, send direct.<br/>  if (dnsDomainIs(host, "intranet.domain.com") ||<br/>  shExpMatch(host, "(*.abcdomain.com|abcdomain.com)"))<br/>  return "DIRECT";<br/>  <br/>  <br/>  // If the protocol or URL matches, send direct.<br/>  if (url.substring(0, 4)=="ftp:" ||<br/>  shExpMatch(url, "http://abcdomain.com/folder/*"))<br/>  return "DIRECT";<br/>  <br/>  // If the requested website is hosted within the internal network, send direct.<br/>  if (isPlainHostName(host) ||<br/>  shExpMatch(host, "*.local") ||<br/>  isInNet(dnsResolve(host), "10.0.0.0", "255.0.0.0") ||<br/>  isInNet(dnsResolve(host), "172.16.0.0",  "255.240.0.0") ||<br/>  isInNet(dnsResolve(host), "192.168.0.0",  "255.255.0.0") ||<br/>  isInNet(dnsResolve(host), "127.0.0.0", "255.255.255.0"))<br/>  return "DIRECT";<br/>  <br/>  <br/>  // If the IP address of the local machine is within a defined<br/>  // subnet, send to a specific proxy.<br/>  if (isInNet(myIpAddress(), "10.10.5.0", "255.255.255.0"))<br/>  return "PROXY 1.2.3.4:8080";<br/>  <br/>  <br/>  // DEFAULT RULE: All other traffic, use below proxies, in fail-over order.<br/>  return "PROXY 4.5.6.7:8080; PROXY 7.8.9.10:8080";<br/>}</span></pre><p id="300e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里对JS代码质量不要抱太大希望；通常你会偶然发现那些不是Web开发人员或者对此毫不关心的人写的代码；-)</p><p id="edcb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您希望在pac文件中破译的是您应该用于自己目的的代理(或多个代理)。例如，如果你想访问网络，而不是一些内部网站/域名，那么你可能需要使用<code class="fe mt mu mv mk b">4.5.6.7:8080</code>和/或<code class="fe mt mu mv mk b">7.8.9.10:8080</code>。</p><p id="f646" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据谁在维护PAC文件，这可能是非常清楚或非常神秘的(一些系统管理员把这些文件弄得一团糟)。</p><p id="dfce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是如何找到pac文件呢？好问题！</p><p id="0273" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有两种可能；要么通过代理设置直接设置PAC文件，例如通过IE可见:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/2fffd5374c15af1d186af6008750efee.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*VWZI2xqEwYhG1jeeGN3c8g.png"/></div></figure><p id="9fb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这种情况下，你又得到了你想要的。</p><p id="f00f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者，代理设置被配置为自动检测。在这种情况下，WPAD协议用于查找PAC文件。</p><h1 id="2e42" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Web代理自动发现协议(WPAD)</h1><p id="eda9" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">PAC文件通常与一个叫做WPAD的协议协同工作，即<a class="ae le" href="https://en.wikipedia.org/wiki/Proxy_auto-config" rel="noopener ugc nofollow" target="_blank">网络代理自动发现协议</a>。</p><p id="1d35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">顾名思义，网络浏览器/用户代理使用WPAD协议，通过DHCP和/或DNS自动发现要使用的代理。</p><p id="659f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">简单地说，WPAD试图从“wpad”主机下载一个名为“wpad.dat”的文件。</p><p id="f77a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">检查环境中是否使用了WPAD的最简单方法是尝试简单的ping:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="fae9" class="mo lg it mk b gy mp mq l mr ms">ping wpad</span></pre><p id="d922" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果不存在，那么要么不使用WPAD，要么您需要附加一个环境特定的DNS后缀，您应该能够通过<code class="fe mt mu mv mk b">ipconfig /all</code>来识别，正如这里所解释的<a class="ae le" href="https://superuser.com/questions/346372/how-do-i-know-what-proxy-server-im-using" rel="noopener ugc nofollow" target="_blank">。基本上你在寻找主要的DNS后缀&amp; DNS后缀搜索列表。</a></p><p id="023f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您可以访问<code class="fe mt mu mv mk b">wpad</code>或<code class="fe mt mu mv mk b">wpad.&lt;some suffix&gt;</code>，那么您可以通过以下方式下载wpad.dat文件:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="d02b" class="mo lg it mk b gy mp mq l mr ms">http://wpad.&lt;suffix&gt;/wpad.dat</span></pre><p id="e940" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有那个文件，那么你就又一次得到了你想要的信息。</p><p id="ef90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果这不起作用，那么WPAD可能会通过DHCP进行配置，在这种情况下，您可以尝试通过Wireshark等工具查看DHCP流量，或者尝试这里建议的<a class="ae le" href="https://superuser.com/questions/346372/how-do-i-know-what-proxy-server-im-using" rel="noopener ugc nofollow" target="_blank">方法</a>。</p><p id="b7e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">顺便说一下，维基百科关于WPAD的文章提到了一些关于WPAD安全的事实；这还挺好玩的(还是难过？)来读。</p><h1 id="943f" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">代理配置</h1><p id="0a5e" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">所以，你有代理设置；现在怎么办？</p><p id="83b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这完全取决于你想如何/在哪里使用它们。我会给你几个例子，但是对于其他的，你需要钻研你的工具的文档；-)</p><h2 id="e841" class="mo lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">尝试</h2><p id="fd12" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">如果你想从你的<a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/bash-aliases-are-awesome-8a76aecc96ab"> Bash终端</a>访问网页(哦我<a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/bash-aliases-are-awesome-8a76aecc96ab">感觉到你</a>！)，那么您需要配置(部分或全部)以下环境变量:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="d9d2" class="mo lg it mk b gy mp mq l mr ms">export HTTP_PROXY="http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>export HTTPS_PROXY="http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>export FTP_PROXY="http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>export SOCKS_PROXY="http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>export TELNET_PROXY="http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>export ALL_PROXY="http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>export NO_PROXY="localhost,127.0.0.1, &lt;whatever else&gt;"</span></pre><p id="7d03" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如您在上面所看到的，您还可以定义凭证来验证代理。对于某些环境，您必须使用Windows域凭据。</p><h2 id="7c15" class="mo lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">饭桶</h2><p id="c12c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">如果您从Bash终端使用Git(哈哈)，那么您就可以开始了。</p><p id="5d72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果不是，那么您可能需要配置git来使用代理:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="883d" class="mo lg it mk b gy mp mq l mr ms">git config --global http.proxy http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;</span></pre><p id="d920" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，用户名/密码是可选的；这完全取决于环境。</p><p id="e100" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些设置将储存在您的个人文件夹的”。gitconfig "文件。</p><p id="bcb8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想在SSH上使用git，不要抱太大希望..</p><h2 id="8748" class="mo lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">npm</h2><p id="9edb" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">使用npm，配置代理也很简单:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="fa47" class="mo lg it mk b gy mp mq l mr ms">npm config set proxy http.proxy http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;<br/>npm config set https-proxy http.proxy http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;</span></pre><p id="59a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些设置将储存在您的个人文件夹的”。npmrc”文件。</p><h2 id="daeb" class="mo lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">专家</h2><p id="0cc6" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">和往常一样，使用Maven时，一切都通过“settings.xml”文件进行:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="bf39" class="mo lg it mk b gy mp mq l mr ms">&lt;proxies&gt;<br/>   &lt;proxy&gt;<br/>        &lt;host&gt;http://&lt;host&gt;&lt;/host&gt;<br/>        &lt;port&gt;&lt;port&gt;&lt;/port&gt;<br/>        &lt;username&gt;...&lt;/username&gt;<br/>        &lt;password&gt;...&lt;/password&gt;<br/>        &lt;nonProxyHosts&gt;...&lt;/nonProxyHosts&gt;<br/>    &lt;/proxy&gt;<br/>&lt;/proxies&gt;</span></pre><p id="a4ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查看<a class="ae le" href="https://www.baeldung.com/maven-behind-proxy" rel="noopener ugc nofollow" target="_blank">这篇文章</a>了解更多细节。</p><h1 id="32f3" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">自签名证书</h1><p id="f6b9" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在许多组织中，企业代理也执行SSL/ <a class="ae le" href="https://en.wikipedia.org/wiki/TLS_termination_proxy" rel="noopener ugc nofollow" target="_blank"> TLS终止</a>。也就是说，公司代理和周围的基础设施在边缘端接SSL/TLS连接，以便它们可以检查所有流量。我希望你在工作时上网时意识到这一点，否则你现在可能会感觉很糟糕；-)</p><p id="2016" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样做的组织通常向客户端机器提供自签名(但内部信任)证书，同时检查他们这边的第三方证书。</p><p id="e229" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这意味着如果你想去https://gmail.com的<a class="ae le" href="https://gmail.com," rel="noopener ugc nofollow" target="_blank">，</a>，那么你将永远看不到gmail.com的证明。相反，您将看到一个由企业基础设施动态创建/自签名的证书。</p><p id="3441" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这在公司的Web浏览器中运行良好，因为您的机器被配置为信任这些证书。但是你的工具和终端就不会这样了。</p><p id="3a95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果环境做到了这一点，那么您需要确保您的工具/终端接受/信任您收到的证书。这对安全性非常不利，但这是唯一的方法(据我所知)。</p><p id="8e92" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这有点超出了本文的范围，但是如果您正面临这种情况，那么请尝试查看这些自签名证书是否都是由同一个根CA发出的。如果是这种情况，那么只信任工具中的根证书颁发机构。</p><p id="b64a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果每个证书都是完全独立的，那就糟了，你需要禁用证书检查。</p><p id="9e6a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，使用npm，您可以使用以下内容来信任特定的CA证书文件:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="c6f9" class="mo lg it mk b gy mp mq l mr ms">npm config -g set cafile blabla.cert</span></pre><p id="564e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你运气不好，不怕被黑(提示:你应该害怕！)，那么您可能需要这样做:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="4d2f" class="mo lg it mk b gy mp mq l mr ms">npm config -g set strict-ssl false</span></pre><p id="bde1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用Git:</p><pre class="kp kq kr ks gt mj mk ml mm aw mn bi"><span id="9c6e" class="mo lg it mk b gy mp mq l mr ms">export GIT_CURL_VERBOSE=1 # to debug<br/>export GIT_SSL_NO_VERIFY=1</span></pre><p id="b3e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大多数处理SSL/TLS的工具都有类似的选项。</p><h1 id="ca73" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">用户代理字符串</h1><p id="e5d0" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">有时，代理对哪些用户代理可以通过或不可以通过是严格的。在2020年，这肯定是一个糟糕的做法(很长时间以来一直如此)，但要意识到这一点。</p><p id="889a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果是这种情况，那么确定接受哪个用户代理字符串(可能是主/审查的Web浏览器的字符串)，并调整您的工具以使用该用户代理字符串。</p><p id="57f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您还可以更进一步，安装您自己的本地代理(例如，使用<a class="ae le" href="http://www.squid-cache.org/Doc/config/request_header_replace/" rel="noopener ugc nofollow" target="_blank"> Squid </a>、<a class="ae le" href="https://www.privoxy.org/user-manual/actions-file.html" rel="noopener ugc nofollow" target="_blank"> privoxy </a>等)来自动修改您的HTTP请求，然后将它们发送给公司代理。</p><p id="2b30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不过这个稍微高级一点:)</p><h1 id="d5e4" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="8077" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在本文中，我解释了如何识别正在使用的公司代理，以及如何配置您的工具/终端通过它们连接到Web。</p><p id="ed14" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还告诉了你经常使用的PAC文件和WPAD协议。</p><p id="a63b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我解释了一些组织进行SSL/TLS终止，提供自签名证书，甚至可能是邪恶的，只允许特定的用户代理通过。</p><p id="2fb5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">希望你不需要做上面的任何事情，但是如果没有选择和帮助，这可能是有用的。</p><p id="b312" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天到此为止！</p><h1 id="1826" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">喜欢这篇文章吗？点击下面“喜欢”按钮查看更多内容，并确保其他人也能看到！</h1><p id="2805" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">PS:如果你想学习大量关于软件/Web开发、TypeScript、Angular、React、Vue、Kotlin、Java、Docker/Kubernetes和其他很酷的主题的其他很酷的东西，那么请不要犹豫<a class="ae le" href="https://www.amazon.com/Learn-TypeScript-Building-Applications-understanding-ebook/dp/B081FB89BL" rel="noopener ugc nofollow" target="_blank">拿一本我的书</a>并订阅<a class="ae le" href="https://mailchi.mp/fb661753d54a/developassion-newsletter" rel="noopener ugc nofollow" target="_blank">我的简讯</a>！</p></div></div>    
</body>
</html>
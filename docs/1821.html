<html>
<head>
<title>Grafana Labs: Loki — logs collecting and monitoring system</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Grafana实验室:Loki —日志收集和监控系统</h1>
<blockquote>原文：<a href="https://itnext.io/grafana-labs-loki-logs-collecting-and-monitoring-system-b8896b5cac5c?source=collection_archive---------0-----------------------#2019-02-06">https://itnext.io/grafana-labs-loki-logs-collecting-and-monitoring-system-b8896b5cac5c?source=collection_archive---------0-----------------------#2019-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/65d1211afe55193a47b7b62a46739438.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/0*A2iJ3ElInZOZR0V8.png"/></div></figure><p id="93c1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Grafana 6.0在2019年2月仍处于测试阶段，当时推出了新功能——Loki，这是一个通过另一个新功能<a class="ae ks" href="http://docs.grafana.org/guides/whats-new-in-v6-0/#explore" rel="noopener ugc nofollow" target="_blank">探索</a>提供的日志聚合系统。</p><p id="0ce1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它类似于众所周知的<a class="ae ks" href="https://www.elastic.co/elk-stack" rel="noopener ugc nofollow" target="_blank">麋鹿</a> / <a class="ae ks" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-elasticsearch-fluentd-and-kibana-efk-logging-stack-on-kubernetes" rel="noopener ugc nofollow" target="_blank"> EFK </a>栈，但设置和使用更简单，主要用于像Prometheus和Kubernetes这样的云和系统。</p><p id="40e9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它仍处于早期开发阶段，我在尝试建立本帖中描述的概念验证时发现的主要缺点是缺乏文档和示例。</p><p id="ea78" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，在这篇文章和接下来的两篇文章中，我将尝试展示一些它的设置和使用示例。</p><p id="7a6e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">总的来说，我喜欢Loki，因为您不需要设置整个专用的ELK堆栈:相同的Grafana可以用于您的监控仪表板，并且您的所有日志都可以通过相同的Grafana实例获得。所以我会试着在我目前的项目上实现它。</p><p id="6ee3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">还是会回到麋鹿解……)</p><p id="f904" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">项目首页— <a class="ae ks" href="https://grafana.com/loki#about" rel="noopener ugc nofollow" target="_blank">此处&gt; &gt; &gt; </a>，Grafana Lab的博客中的帖子— <a class="ae ks" href="https://grafana.com/blog/2018/12/12/loki-prometheus-inspired-open-source-logging-for-cloud-natives/" rel="noopener ugc nofollow" target="_blank">此处&gt; &gt; &gt; </a>，Github库<a class="ae ks" href="https://github.com/grafana/loki" rel="noopener ugc nofollow" target="_blank">此处&gt; &gt; &gt; </a>。</p><p id="d00a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在Reddit <a class="ae ks" href="https://www.reddit.com/r/devops/comments/a754si/grafanas_new_log_analysis_product/" rel="noopener ugc nofollow" target="_blank">这里&gt; &gt; &gt; </a>也有很好的讨论。</p><p id="3095" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">洛基有<code class="fe kt ku kv kw b"><a class="ae ks" href="https://github.com/grafana/loki/blob/master/docs/logcli.md" rel="noopener ugc nofollow" target="_blank">logcli</a></code>工具——但是我还没有检查它。</p><p id="aef8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Loki-stack由三个主要组件组成:</p><ul class=""><li id="e4f4" class="kx ky iq jw b jx jy kb kc kf kz kj la kn lb kr lc ld le lf bi translated"><code class="fe kt ku kv kw b">promtail</code> -代理收集主机上的日志并将其推送到Loki实例</li><li id="7791" class="kx ky iq jw b jx lg kb lh kf li kj lj kn lk kr lc ld le lf bi translated"><code class="fe kt ku kv kw b">loki</code> -日志聚合和处理服务器</li><li id="2e8f" class="kx ky iq jw b jx lg kb lh kf li kj lj kn lk kr lc ld le lf bi translated"><a class="ae ks" href="https://github.com/grafana/grafana" rel="noopener ugc nofollow" target="_blank"> Grafana </a> —用于查询和显示日志</li></ul><p id="a163" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在让我们试着设置它，添加一些NGINX日志，并检查它在Grafana中的样子。</p><ul class=""><li id="4d61" class="kx ky iq jw b jx jy kb kc kf kz kj la kn lb kr lc ld le lf bi translated"><a class="ae ks" href="#4ac0" rel="noopener ugc nofollow"> Loki Docker编写堆栈</a></li><li id="1819" class="kx ky iq jw b jx lg kb lh kf li kj lj kn lk kr lc ld le lf bi translated"><a class="ae ks" href="#3794" rel="noopener ugc nofollow">添加Loki数据源</a></li><li id="7a0e" class="kx ky iq jw b jx lg kb lh kf li kj lj kn lk kr lc ld le lf bi translated"><a class="ae ks" href="#a0d3" rel="noopener ugc nofollow">添加新日志</a></li></ul><h2 id="4ac0" class="ll lm iq bd ln lo lp dn lq lr ls dp lt kf lu lv lw kj lx ly lz kn ma mb mc md bi translated">Loki Docker编写堆栈</h2><p id="96aa" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">创建Loki的主目录:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="f7ec" class="ll lm iq kw b gy mr ms l mt mu">root@bttrm-dev-console:/opt# mkdir /opt/loki<br/>root@bttrm-dev-console:/opt# cd /opt/loki/</span></pre><p id="9d63" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，创建一个Docker合成文件— <code class="fe kt ku kv kw b">loki-compose.yml</code>:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="e07f" class="ll lm iq kw b gy mr ms l mt mu">version: "3"<br/><br/>networks:<br/>  loki:<br/><br/>services:<br/>  loki:<br/>    image: grafana/loki:master<br/>    ports:<br/>      - "3100:3100"<br/>    command: -config.file=/etc/loki/local-config.yaml<br/>    networks:<br/>      - loki<br/><br/>  promtail:<br/>    image: grafana/promtail:master<br/>    volumes:<br/>      - /var/log:/var/log<br/>    command: -config.file=/etc/promtail/docker-config.yaml<br/>    networks:<br/>      - loki<br/><br/>  grafana:<br/>    image: grafana/grafana:master<br/>    ports:<br/>      - "3000:3000"<br/>    networks:<br/>      - loki</span></pre><p id="4aab" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">开始容器:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="4a97" class="ll lm iq kw b gy mr ms l mt mu">root@bttrm-dev-console:/opt/loki# docker-compose -f loki-compose.yml up</span></pre><p id="1a44" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在<code class="fe kt ku kv kw b">promtail</code>的输出中，您将看到<code class="fe kt ku kv kw b">promatil</code>查看的日志信息:</p><blockquote class="mv mw mx"><p id="c3c0" class="ju jv my jw b jx jy jz ka kb kc kd ke mz kg kh ki na kk kl km nb ko kp kq kr ij bi translated">…<br/>prom tail _ 1 | level = info ts = 2019–02–05t 14:07:30.777577365 z caller = file target manager . go:165 msg = " Adding target " key = " { job = \ " varlogs \ " } "<br/>prom tail _ 1 | level = info ts = 2019–02–05t 14:07:30.779215957 z caller = file target . go:269 msg level = info ts = 2019–02–05t 14:07:30.78359605 z caller = file target . go:269 msg = " start tailing file " path =/var/log/cloud-init-output . log<br/>prom tail _ 1 | level = info ts = 2019–02–05t 14:07:30.783648219 z caller = file target . go:269 msg = " start tailing file " path =。</p></blockquote><p id="f56c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">与Prometheus exporters类似，您可以通过<code class="fe kt ku kv kw b">/metrics</code> URI访问数据:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="1f37" class="ll lm iq kw b gy mr ms l mt mu">root@ip-172–31–43–174:/opt/loki# curl localhost:3100/metrics<br/>#HELP cortex_cache_corrupt_chunks_total Total count of corrupt chunks found in cache.<br/>#TYPE cortex_cache_corrupt_chunks_total counter<br/>cortex_cache_corrupt_chunks_total 0.0<br/>#HELP cortex_chunk_store_chunks_per_query Distribution of #chunks per query.<br/>TYPE cortex_chunk_store_chunks_per_query histogram<br/>cortex_chunk_store_chunks_per_query_bucket{le=”10.0"} 0.0<br/>cortex_chunk_store_chunks_per_query_bucket{le=”80.0"} 0.0<br/>cortex_chunk_store_chunks_per_query_bucket{le=”640.0"} 0.0<br/>cortex_chunk_store_chunks_per_query_bucket{le=”5120.0"} 0.0<br/>cortex_chunk_store_chunks_per_query_bucket{le=”40960.0"} 0.0<br/>cortex_chunk_store_chunks_per_query_bucket{le=”327680.0"} 0.0<br/>cortex_chunk_store_chunks_per_query_bucket{le=”+Inf”} 0.0<br/>…</span></pre><p id="5440" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在您可以通过<a class="ae ks" href="http://IP:3000" rel="noopener ugc nofollow" target="_blank"><em class="my">http://IP:3000</em></a>URL访问您的Grafana实例:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/000dab74f1d032288708141fc86ab946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GwlLNfGczNMcZBQi.png"/></div></div></figure><p id="ff3b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用默认凭证登录— <em class="my"> admin:admin </em>。</p><h2 id="3794" class="ll lm iq bd ln lo lp dn lq lr ls dp lt kf lu lv lw kj lx ly lz kn ma mb mc md bi translated">添加Loki数据源</h2><p id="002b" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">Grafana会建议您添加一个数据源:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nh"><img src="../Images/9f6a3dfd57b845f61f259ea29005874f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uywaw-qt6jTSWaGZ.png"/></div></div></figure><p id="11cb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">添加<em class="my"> Loki </em>数据源:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ni"><img src="../Images/5cd0d14a9d10dbfb01234957d5787352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0BU6b4domtjDhLp9.png"/></div></div></figure><p id="b2ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">将loki的URL设置为<a class="ae ks" href="http://loki:3100" rel="noopener ugc nofollow" target="_blank"><em class="my">http://Loki:3100</em></a>(因为我们在Docker自己的网络中运行我们的Loki的堆栈):</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nj"><img src="../Images/81462552b0a41e1a75c59fc96ffe4e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ug7jE5aJKbP523vX.png"/></div></div></figure><p id="4d32" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在您可以导航到<em class="my">浏览</em>:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nk"><img src="../Images/e07b677689d0e81ef52cb2ab6b2d8e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V5dSHJ7R7w3thJXU.png"/></div></div></figure><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nl"><img src="../Images/193c25b7e7a6c2eff1d16ae8732610b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fx61BCgGOWmdVAvR.png"/></div></div></figure><p id="a328" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过<em class="my">日志标签</em>查看一些已经收集的日志:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nl"><img src="../Images/5b4f19b309f25775a9023633ebdcadf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Hjh-ar_mN0n4ufqq.png"/></div></div></figure><h2 id="a0d3" class="ll lm iq bd ln lo lp dn lq lr ls dp lt kf lu lv lw kj lx ly lz kn ma mb mc md bi translated">添加新日志</h2><p id="6a79" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">要跟踪的日志在<code class="fe kt ku kv kw b">promtail</code>的<code class="fe kt ku kv kw b"><a class="ae ks" href="https://github.com/grafana/loki/blob/master/cmd/promtail/promtail-local-config.yaml" rel="noopener ugc nofollow" target="_blank">/etc/promtail/local-config.yaml</a></code>或<code class="fe kt ku kv kw b"><a class="ae ks" href="https://github.com/grafana/loki/blob/master/cmd/promtail/promtail-docker-config.yaml" rel="noopener ugc nofollow" target="_blank">/etc/promtail/docker-config.yaml</a></code>配置中进行配置。</p><p id="64d9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在让我们安装NGINX:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="b7b8" class="ll lm iq kw b gy mr ms l mt mu">root@ip-172–31–43–174:/home/admin# apt install nginx -y</span></pre><p id="83cd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查日志文件是否出现在主机上:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="99d7" class="ll lm iq kw b gy mr ms l mt mu">root@ip-172–31–43–174:/opt/loki# tail -f /var/log/nginx/*<br/>==&gt; /var/log/nginx/access.log &lt;==<br/>==&gt; /var/log/nginx/error.log &lt;==<br/>==&gt; /var/log/nginx/access.log &lt;==<br/>194.***.***.27 — — [05/Feb/2019:14:03:02 +0000] “GET / HTTP/1.1” 200 396 “-” “Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36”<br/>194.***.***.27 — — [05/Feb/2019:14:03:03 +0000] “GET /favicon.ico HTTP/1.1” 404 200 “http://34.243.211.206/" “Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36”</span></pre><p id="6f4a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Loki的配置文件此时存储在容器内的<code class="fe kt ku kv kw b">/etc/loki </code>目录下:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="2a78" class="ll lm iq kw b gy mr ms l mt mu">root@ip-172–31–43–174:/opt/loki# docker exec -ti loki_loki_1 ls -l /etc/loki/<br/>total 4<br/>-rw-r — r — 1 root root 489 Feb 5 12:00 local-config.yaml</span></pre><p id="0f95" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe kt ku kv kw b">promtail</code>的- in <code class="fe kt ku kv kw b">/etc/promtail</code>:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="2c53" class="ll lm iq kw b gy mr ms l mt mu">root@ip-172–31–43–174:/opt/loki# docker exec -ti loki_promtail_1 ls -l /etc/promtail/<br/>total 8<br/>-rw-r — r — 1 root root 312 Feb 5 12:00 docker-config.yaml<br/>-rw-r — r — 1 root root 317 Feb 5 12:00 local-config.yaml</span></pre><p id="8d72" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们为<code class="fe kt ku kv kw b">promtail</code> - <code class="fe kt ku kv kw b">/opt/loki/loki-promtail-conf.yml</code>创建自己的配置:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="f73b" class="ll lm iq kw b gy mr ms l mt mu">server:<br/><br/>  http_listen_port: 9080<br/>  grpc_listen_port: 0<br/><br/>positions:<br/><br/>  filename: /tmp/positions.yaml<br/><br/>client:<br/><br/>  url: <a class="ae ks" href="http://loki:3100/api/prom/push" rel="noopener ugc nofollow" target="_blank">http://loki:3100/api/prom/push</a><br/><br/>scrape_configs:<br/><br/>  - job_name: system<br/>    entry_parser: raw<br/>    static_configs:<br/>    - targets:<br/>        - localhost<br/>      labels:<br/>        job: varlogs<br/>        __path__: /var/log/*log<br/><br/>  - job_name: nginx<br/>    entry_parser: raw<br/>    static_configs:<br/>    - targets:<br/>        - localhost<br/>      labels:<br/>        job: nginx<br/>        __path__: /var/log/nginx/*log</span></pre><p id="540a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里的<code class="fe kt ku kv kw b">scrape_configs</code>中，我们添加了一个新的任务- <em class="my"> nginx </em>和<code class="fe kt ku kv kw b">__path__</code>到由<code class="fe kt ku kv kw b">promtail</code>跟踪的目录和文件中。</p><p id="5f6d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，让我们更新我们的合成文件，并将来自主机的新配置文件映射添加到<code class="fe kt ku kv kw b">promtail</code>的容器中，作为<code class="fe kt ku kv kw b">/etc/promtail/docker-config.yaml</code>:</p><pre class="mj mk ml mm gt mn kw mo mp aw mq bi"><span id="71c7" class="ll lm iq kw b gy mr ms l mt mu">...<br/>  promtail:<br/>    image: grafana/promtail:master<br/>    volumes:<br/>      - /opt/loki/loki-promtail-conf.yml:/etc/promtail/docker-config.yaml<br/>      - /var/log:/var/log<br/>    command: -config.file=/etc/promtail/docker-config.yaml<br/>    networks:<br/>      - loki<br/>...</span></pre><p id="9fb8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重启构建堆栈并检查<code class="fe kt ku kv kw b">promtail</code>输出中的日志，查看<code class="fe kt ku kv kw b">promtail</code>现在正在查看哪些日志:</p><blockquote class="mv mw mx"><p id="38af" class="ju jv my jw b jx jy jz ka kb kc kd ke mz kg kh ki na kk kl km nb ko kp kq kr ij bi translated">…<br/>prom tail _ 1 | level = info ts = 2019–02–05t 15:08:10.53723788 z caller = file target manager . go:165 msg = " Adding target " key = " { job = \ " varlogs \ " } "<br/>prom tail _ 1 | level = info ts = 2019–02–05t 15:08:10.538575763 z caller = file target . go:269 msg = " start level = info ts = 2019–02–05t 15:08:10.543222436 z caller = file target . go:269 msg = "开始跟踪文件" path =/var/log/cloud-init . log<br/>prom tail _ 1 | level = info ts = 2019–02–05t 15:08:10.54394579 z caller = file target manager . go:165 msg = "添加目标" key="{job 2019/02/05 15:08:10 Seeked/var/log/auth . log—&amp;{ Offset:0 where:0 }<br/>prom tail _ 1 | 2019/02/05 15:08:10 Seeked/var/log/nginx/access . log—&amp;{ Offset:0 where:0 }<br/>prom tail _ 1 | level = info ts = 2019–02–05t 15:08:1</p></blockquote><p id="498e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="my"> key="{job=\"nginx\"}" </em>出现了——一切都好。</p><p id="223e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让它工作几分钟，然后检查Grafana内部:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nl"><img src="../Images/868d7d76fd05dd8764b361c15f36c64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OtFxgN811l47E8MB.png"/></div></div></figure><p id="54fc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">日志存在，我们现在完成了。</p><p id="3a8d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看下一篇帖子— <a class="ae ks" href="https://rtfm.co.ua/en/grafana-labs-loki-distributed-system-labels-and-filters/" rel="noopener ugc nofollow" target="_blank"> Grafana Labs: Loki —分布式系统、标签和过滤器</a>查看如何设置分布式系统的示例以及标签和过滤器的使用示例。</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="f2b4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="my">最初发布于</em> <a class="ae ks" href="https://rtfm.co.ua/en/grafana-labs-loki-logs-collector-and-monitoring-system/" rel="noopener ugc nofollow" target="_blank"> <em class="my"> RTFM: Linux、DevOps和系统管理</em> </a> <em class="my">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Useful Heroku add-ons for Ruby on Rails project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对Ruby on Rails项目有用的Heroku附加组件</h1>
<blockquote>原文：<a href="https://itnext.io/useful-heroku-add-ons-for-ruby-on-rails-project-82fa6da5af3a?source=collection_archive---------4-----------------------#2021-02-25">https://itnext.io/useful-heroku-add-ons-for-ruby-on-rails-project-82fa6da5af3a?source=collection_archive---------4-----------------------#2021-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bedd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Heroku和Ruby on Rails项目上工作了8年之后，我有了自己最喜欢的一套Heroku插件，可以很好地与Rails应用程序配合使用。您将了解到在Ruby开发人员的日常生活中非常有用的附加组件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/21728d0139d9252853c492a8f05689bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*THv_urUxkcjK6g1b.jpeg"/></div></div></figure><h1 id="533d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Heroku附件</h1><p id="f2ba" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">这是我在Heroku Marketplace上最喜欢的Heroku插件列表，以及我为什么选择它们作为我在Heroku上托管的Ruby on Rails项目。</p><h1 id="1a13" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Heroku调度程序</h1><p id="42fa" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Heroku Scheduler 可以每10分钟、每小时或每天运行计划任务。我用它来运行我预定的rake任务。例如，我每天运行一个rake任务，将过去24小时内注册的用户汇总发送到我的邮箱。</p><p id="dc74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Heroku Scheduler附加软件是免费的。唯一的限制是它的选项比Unix系统中的cron少。如果您需要每周一运行一个rake任务，那么您需要在Heroku Scheduler中将rake任务设置为每日任务，并在rake任务本身中检查一天，以便在需要时跳过它。</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="7522" class="mg ky iq mc b gy mh mi l mj mk"><em class="ml"># lib/tasks/schedule/notify_users_about_past_due_subscription.rake</em><br/>namespace :schedule <strong class="mc ir">do</strong><br/>  desc 'Send notification about past due subscriptions to users'<br/>  task notify_users_about_past_due_subscription: :environment <strong class="mc ir">do</strong><br/>    <strong class="mc ir">if</strong> Time.<strong class="mc ir">current</strong>.<strong class="mc ir">monday?</strong><br/>      Billing<strong class="mc ir">::</strong>NotifyUsersAboutPastDueSubscriptionWorker.<strong class="mc ir">perform_async</strong><br/>    <strong class="mc ir">else</strong><br/>      Rails.<strong class="mc ir">logger</strong>.<strong class="mc ir">info</strong>("Skip schedule:notify_users_about_past_due_subscription task.")<br/>    <strong class="mc ir">end</strong><br/>  <strong class="mc ir">end</strong><br/><strong class="mc ir">end</strong></span></pre><h1 id="cafe" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">新遗迹APM</h1><p id="0866" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae ma" href="https://elements.heroku.com/addons/newrelic" rel="noopener ugc nofollow" target="_blank"> New Relic </a> add-on做应用性能监控。这是我最喜欢的附件之一。它允许跟踪每个进程，如puma/unicorn/sidekiq per dyno及其性能。您可以看到哪些Rails控制器动作花费的时间最多。您可以看到吞吐量最高的API端点和耗时的端点。New Relic多次帮助我调试我的应用程序中的瓶颈，多亏了它，我才能以平均50毫秒的响应时间制作<a class="ae ma" href="https://knapsackpro.com/?utm_source=docs_knapsackpro&amp;utm_medium=blog_post&amp;utm_campaign=best-heroku-add-ons-for-ruby-on-rails-project" rel="noopener ugc nofollow" target="_blank">背包专业版API </a>。谁说Rails应用一定要慢？:)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mm"><img src="../Images/67903bccf35b9bae4c8fb1c7aebc6975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HnWIDh1oVuoZoI2i.png"/></div></div></figure><h1 id="03de" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">滚动条</h1><p id="b0aa" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Rollbar 允许在前端的Ruby代码和JS代码中进行异常跟踪。它有一个慷慨的免费计划，每月5000例外限制。</p><p id="58f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以很容易地忽略一些常见的Rails异常，以保持在自由计划限制内。</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="60e4" class="mg ky iq mc b gy mh mi l mj mk"><em class="ml"># config/initializers/rollbar.rb</em><br/>Rollbar.<strong class="mc ir">configure</strong> <strong class="mc ir">do</strong> <strong class="mc ir">|</strong>config<strong class="mc ir">|</strong><br/>  config.<strong class="mc ir">access_token</strong> <strong class="mc ir">=</strong> ENV['ROLLBAR_ACCESS_TOKEN']<br/><br/>  <strong class="mc ir">if</strong> Rails.<strong class="mc ir">env</strong>.<strong class="mc ir">test?</strong> <strong class="mc ir">||</strong> Rails.<strong class="mc ir">env</strong>.<strong class="mc ir">development?</strong><br/>    config.<strong class="mc ir">enabled</strong> <strong class="mc ir">=</strong> <strong class="mc ir">false</strong><br/>  <strong class="mc ir">end</strong><br/><br/>  <em class="ml"># Add exception class names to the exception_level_filters hash to</em><br/>  <em class="ml"># change the level that exception is reported at. Note that if an exception</em><br/>  <em class="ml"># has already been reported and logged the level will need to be changed</em><br/>  <em class="ml"># via the rollbar interface.</em><br/>  <em class="ml"># Valid levels: 'critical', 'error', 'warning', 'info', 'debug', 'ignore'</em><br/>  <em class="ml"># 'ignore' will cause the exception to not be reported at all.</em><br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('ActionController::RoutingError' <strong class="mc ir">=&gt;</strong> 'ignore')<br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('ActionController::InvalidAuthenticityToken' <strong class="mc ir">=&gt;</strong> 'ignore')<br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('ActionController::BadRequest' <strong class="mc ir">=&gt;</strong> 'ignore')<br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('ActiveRecord::RecordNotFound' <strong class="mc ir">=&gt;</strong> 'ignore')<br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('Rack::Timeout::RequestTimeoutException' <strong class="mc ir">=&gt;</strong> 'ignore')<br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('Rack::QueryParser::InvalidParameterError' <strong class="mc ir">=&gt;</strong> 'ignore')<br/>  config.<strong class="mc ir">exception_level_filters</strong>.<strong class="mc ir">merge!</strong>('ActionDispatch::Http::MimeNegotiation::InvalidType' <strong class="mc ir">=&gt;</strong> 'ignore')<br/><br/>  config.<strong class="mc ir">environment</strong> <strong class="mc ir">=</strong> ENV['ROLLBAR_ENV'].<strong class="mc ir">presence</strong> <strong class="mc ir">||</strong> Rails.<strong class="mc ir">env</strong><br/><strong class="mc ir">end</strong></span></pre><h1 id="43c5" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">日志条目</h1><p id="0d9f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae ma" href="https://elements.heroku.com/addons/logentries" rel="noopener ugc nofollow" target="_blank"> Logentries </a> —从Heroku标准输出中收集您的日志，以便您稍后可以浏览它们。如果您需要在日志中查找几天前发生的某个问题的信息，那么日志条目可能会有所帮助。</p><p id="7c12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，您可以使用<a class="ae ma" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank"> Heroku命令行界面</a>并在终端中运行<code class="fe mn mo mp mc b">heroku logs -n 10000 --app my-heroku-app</code>命令来浏览最后10，000行的日志，但是这种方法有局限性。您不能在过去的日志中做那么多，也不能像在日志条目中那样容易地过滤日志。</p><p id="05b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在免费计划中，Logentries有5 GB和7天的保留期。这对于小的Rails应用来说已经足够了。</p><p id="2b60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我喜欢Logentries的一个很好的特性是保存查询的选项，稍后可以通过它快速浏览日志。您还可以显示基于日志的图表。也许您想知道Sidekiq中某个特定工人被调用的频率？你可以想象它。</p><h1 id="6190" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">雷迪斯云</h1><p id="54dd" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果你在Ruby on Rails应用中使用Redis，那么<a class="ae ma" href="https://elements.heroku.com/addons/rediscloud" rel="noopener ugc nofollow" target="_blank"> Redis Cloud </a>就是你的插件。它有一个免费计划，付费计划比其他附加服务更实惠。</p><p id="cc54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Redis Cloud add-on可以自动备份您的数据，并提供一个漂亮的web UI来预览实时Redis使用情况和数据库实例的历史使用情况。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mq"><img src="../Images/c55be24ef6fc63ed0f06cac0b4a4aa91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zvs_nAj9fQjD8UFu.png"/></div></div></figure><p id="7930" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我喜欢在我的Rails应用中使用Redis Cloud + sidekiq gem。此外，如果您需要在内存中快速缓存一些数据，并在一段时间后使其过期，Redis非常有用。</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="a13a" class="mg ky iq mc b gy mh mi l mj mk">redis_connection <strong class="mc ir">=</strong> Redis.<strong class="mc ir">new</strong>(<br/>  <em class="ml"># use REDISCLOUD_URL when app is running on Heroku,</em><br/>  <em class="ml"># or fallback to local Redis (useful for development)</em><br/>  url: ENV.<strong class="mc ir">fetch</strong>('REDISCLOUD_URL', 'redis://localhost:6379/0'),<br/>  <em class="ml"># tune network timeouts to be a little more lenient when you are seeing occasional timeout</em><br/>  <em class="ml"># errors for Heroku Redis Cloud addon</em><br/>  <em class="ml"># </em><a class="ae ma" href="https://github.com/mperham/sidekiq/wiki/Using-Redis#life-in-the-cloud" rel="noopener ugc nofollow" target="_blank"><em class="ml">https://github.com/mperham/sidekiq/wiki/Using-Redis#life-in-the-cloud</em></a><br/>  timeout: 5<br/>)<br/><br/>redis_connection.<strong class="mc ir">setex</strong>('my-key-name', 1.<strong class="mc ir">hour</strong>, 'this value will expire in 1 hour')</span></pre><h1 id="0de8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Twilio SendGrid</h1><p id="cf58" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">SendGrid 是一个免费的插件，允许你从Ruby on Rails上发送电子邮件。你甚至可以把你的域名连接到它，这样你的用户就可以从你的域名收到电子邮件。</p><p id="5930" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">免费计划中每月有12000封免费邮件。</p><h1 id="f5c2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Heroku附件为您节省时间和金钱</h1><p id="54f8" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">这里有几个我最喜欢的附加组件，可以帮助你在项目中节省金钱和时间。</p><h1 id="cbab" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">自动拨号</h1><p id="a474" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae ma" href="https://elements.heroku.com/addons/autoidle" rel="noopener ugc nofollow" target="_blank"> AutoIdle </a>通过自动将你的staging和review应用程序置于Heroku睡眠状态，让你省钱。当应用程序没有流量时，我用它来关闭我的web和staging应用程序的worker dyno。晚上和周末不用再为Heroku资源付费了。；)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/ffad3de2a9172628dfc4874531505255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4pVGBcNAUa79kxje.png"/></div></div></figure><h1 id="83bb" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Rails自动缩放</h1><p id="6bfc" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Rails Autoscale 是一个强大的插件，可以帮助你在Heroku上省钱。它将测量请求排队时间，并在此基础上为您的web进程添加或删除dynos。如果你在白天有较高的流量，它会增加更多的动力。在夜间交通流量较低时，它会删除dynos。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/5fc00c1a0d610c50ff95ad697ba09d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PUAmJDhs00D5UL92.png"/></div></div></figure><p id="937e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Rails Autoscale还可以跟踪您的工作队列。例如，如果您在Sidekiq中安排了很多作业，那么Rails Autoscale会添加更多的worker dynos来更快地处理您的作业队列。当没有工作要处理时，它甚至可以关闭worker dyno，这可以为您节省更多的钱。</p><h1 id="6bff" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背包专业版</h1><p id="61d6" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae ma" href="https://elements.heroku.com/addons/knapsack-pro" rel="noopener ugc nofollow" target="_blank">backpack Pro</a>是一个Heroku插件和ruby gem，可以在RSpec、Cucumber、Minitest等中运行Rails测试，并自动在任何CI服务器上的并行机器之间分割测试。它与Heroku CI、CircleCI、Buildkite、Travis CI等配合使用。通过使用队列模式对测试进行<a class="ae ma" href="https://docs.knapsackpro.com/2020/how-to-speed-up-ruby-and-javascript-tests-with-ci-parallelisation" rel="noopener ugc nofollow" target="_blank">动态分割，以确保所有并行任务在相似的时间完成工作，这将帮助您节省时间。这样，您可以优化CI构建运行并节省最多时间。</a></p><p id="c9ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面您可以看到一个测试最佳分布的示例，其中每台并行CI机器执行10分钟的测试，因此整个CI构建只持续10分钟，而不是在单个CI服务器上运行测试时的40分钟。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/36d7a9b2f4a4711a8937b75a4d6ca765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QtNQTUajwHiJ2HJA.png"/></div></div></figure><p id="a82e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我一直在开发<a class="ae ma" href="https://elements.heroku.com/addons/knapsack-pro" rel="noopener ugc nofollow" target="_blank">背包Pro插件</a>，如果你尝试一下，我很乐意听到你的反馈。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/cb891abb926734f06bcaa8b81f30a7af.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/format:webp/0*6WKgsuqzyIkUH0Uu.png"/></div></figure></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="6255" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ml">原载于2021年2月25日https://docs.knapsackpro.com</em><em class="ml"/><a class="ae ma" href="https://docs.knapsackpro.com/2021/best-heroku-add-ons-for-ruby-on-rails-project" rel="noopener ugc nofollow" target="_blank"><em class="ml">。</em></a></p></div></div>    
</body>
</html>
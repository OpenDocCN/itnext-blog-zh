<html>
<head>
<title>SwiftUI - Two Directional SnapList</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI -双向快照列表</h1>
<blockquote>原文：<a href="https://itnext.io/swiftui-two-directional-snaplist-95cb852957be?source=collection_archive---------2-----------------------#2021-06-06">https://itnext.io/swiftui-two-directional-snaplist-95cb852957be?source=collection_archive---------2-----------------------#2021-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a7abafc3d2a753dc851586ca1c7182b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sw-dggwevF2rLEoJcgGXxg.png"/></div></div></figure><p id="548b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嘿伙计们，在这篇文章中我们将看到如何创建两个方向的快照列表。创建一个单一方向的快照列表变得更加容易，因为我们已经在TabView中“<em class="kw"> PageTabViewStyle </em>”。</p><p id="d677" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是实现两个方向的快照列表仍然是具有挑战性的，因为在一个垂直的标签视图中有一个水平的标签视图<em class="kw">。旋转(。度(90))" </em>可以制造一些怪异的卷轴bug。</p><p id="e277" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们将使用相同的TabView进行水平滚动，但我们将它们添加到垂直ScrollView中，并为ScrollView单元格创建一个自定义的捕捉行为。</p><p id="ab8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有其他方法，如创建一个VStack修改器并根据DragGesture调整它的偏移量，但这种方法也会产生问题，因为默认情况下TabView中有垂直滚动。下面的方法使用ScrollView抑制了TabView的滚动行为。</p><p id="9b97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kx" href="https://gist.github.com/sameersyd/fce9599687963fca90677d959dce7a6e" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到该代码的要点。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="754f" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">第一步</h1><ul class=""><li id="d318" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">创建新的SwiftUI项目。</li><li id="ed3f" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">创建水平TabView单元格。它看起来会像这样👇🏻</li></ul><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/e9cc2cde1ff612638dd645a8423b4b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoGJ2ZZZJ9h-WAHPiQXiAA.png"/></div></div></figure><h1 id="2019" class="lf lg iq bd lh li my lk ll lm mz lo lp lq na ls lt lu nb lw lx ly nc ma mb mc bi translated">第二步</h1><ul class=""><li id="b9bc" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">添加ForEach以在父视图中生成垂直TabViews，并将它们包装在ScrollView中，除了垂直滚动不能捕捉和自由流动之外，应该可以获得水平和垂直滚动的预期行为。</li><li id="f87f" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">在接下来的步骤中，我们将向垂直滚动添加对齐行为，但此时父视图代码将类似于以下内容👇🏻</li></ul><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/1c18e2be4fd25d31e2aef6f9fb235a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxaxE8pFuAVm_mmm3JUS5g.png"/></div></div></figure><h1 id="9069" class="lf lg iq bd lh li my lk ll lm mz lo lp lq na ls lt lu nb lw lx ly nc ma mb mc bi translated">第三步</h1><ul class=""><li id="99b4" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">在这一步中，我们将向ScrollView添加一个方法，通过该方法我们可以知道滚动时它的偏移量。</li><li id="4f90" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">添加一个“<em class="kw"> PreferenceKey </em>”。<em class="kw">圆顺空间</em>“，”。背景(颜色偏好键)“和”。<em class="kw"> onPreferenceChange </em>”。它将帮助我们了解ScrollView偏移量的变化。</li><li id="fd8f" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">我们再加上这个"<em class="kw">。coordinate space</em>name to scroll view和其他方法到“<em class="kw">lazyv stack”</em>，之后我们的代码看起来会是这样的👇🏻</li></ul><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/0ad58afed969e930680eaa2b509b3b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CEAZv4DRSliip5lXJxqlw.png"/></div></div></figure><ul class=""><li id="09cc" class="md me iq ka b kb kc kf kg kj ne kn nf kr ng kv mk ml mm mn bi translated">添加此内容后，您的代码将在每次滚动时打印ScrollView偏移量。</li></ul><h1 id="ce54" class="lf lg iq bd lh li my lk ll lm mz lo lp lq na ls lt lu nb lw lx ly nc ma mb mc bi translated">第四步</h1><ul class=""><li id="b41e" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">现在，我们将使用combine来添加一个发布者和检测器，以了解ScrollView何时停止滚动，这样我们就可以捕捉视图。</li><li id="c295" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">添加下面的代码来初始化发布器和检测器。当滚动首选项改变时，调用“<em class="kw"> detector.send(value) </em>”而不是之前的“<em class="kw"> print </em>”方法。</li><li id="cfa3" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">现在请听出版商的介绍。<em class="kw"> onReceive </em>，当滚动结束时会传递滚动偏移量。</li></ul><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/b15e0ff0045d726b07a82bb292d35b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Su_XQ-hhCbQHszJf15eCIw.png"/></div></div></figure><ul class=""><li id="129a" class="md me iq ka b kb kc kf kg kj ne kn nf kr ng kv mk ml mm mn bi translated">在ViewModel中添加detect方法，因为它是一个“<em class="kw">变异</em>函数。</li></ul><h1 id="d75c" class="lf lg iq bd lh li my lk ll lm mz lo lp lq na ls lt lu nb lw lx ly nc ma mb mc bi translated">第五步</h1><ul class=""><li id="82df" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">现在我们已经得到了滚动结束后的滚动偏移量，让我们来捕捉视图。</li><li id="a9dd" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">我们需要将滚动结束偏移量除以静态的TabViewCell高度来获得当前索引。</li><li id="b75c" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">调用ScrollViewReader”之前。<em class="kw">scroll to</em>position，我们还应该检查下一个索引是否在附近，否则视图将一直捕捉到当前索引，直到它被完全滑动。</li><li id="49c8" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">还不忘加上“<em class="kw">”。id </em>"到ScrollView的单元格，这样它就可以滚动到索引。</li></ul><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/cfddb22737978a60a82d7f3019271407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gXsi21SoQ0B5WFkUKPTBOA.png"/></div></div></figure></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><div class="mu mv mw mx gt nj"><a href="https://drive.google.com/file/d/1K0qyVd4Ao42voE5G23c1BgYKX6LTlnaa/view?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">TDSnapList。MP4</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">这是演示的链接</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">drive.google.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jw nj"/></div></div></a></div></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="2fd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">万岁🎉！！！我们终于创建了一个双向快照列表。</p><p id="50e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kx" href="https://gist.github.com/sameersyd/fce9599687963fca90677d959dce7a6e" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到该代码的要点。</p><p id="4baf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我知道你的想法和建议。你可以在推特上找到我。</p><p id="5ea1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你觉得有用，👏🏻它激励人们！</p></div></div>    
</body>
</html>
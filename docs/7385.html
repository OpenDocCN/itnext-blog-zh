<html>
<head>
<title>Python: programmatically download Kaggle competitions and datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python:以编程方式下载Kaggle竞赛和数据集</h1>
<blockquote>原文：<a href="https://itnext.io/python-programmatically-download-competition-datasets-from-kaggle-443d6cf5333e?source=collection_archive---------1-----------------------#2022-09-07">https://itnext.io/python-programmatically-download-competition-datasets-from-kaggle-443d6cf5333e?source=collection_archive---------1-----------------------#2022-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c80c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下载比赛和数据集只需一个电话。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4fcdc07d0e0cc52cbaf90917932fdd44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eioVTlgkPdpM4MLDiLwrhg.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Andrew Ridley 在<a class="ae lb" href="https://unsplash.com/s/photos/programming-wallpaper?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="fde1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kaggle是一个著名的平台，来自不同背景的科学家、程序员和工程师聚集在一起，利用公开可用的数据集做出贡献、学习和解决具有挑战性的问题。</p><p id="d842" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在数据部门工作，你会遇到Kaggle，并使用它来执行分析任务和数据科学。Kaggle提供的许多有用功能之一是公共数据集以及免费下载和使用它们的能力。</p><p id="301a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kaggle提供了一个<a class="ae lb" href="https://www.kaggle.com/docs/api" rel="noopener ugc nofollow" target="_blank"> API </a>来与平台交互。Kaggle API提供的一些功能包括:列出比赛和数据集，下载和上传数据集，创建笔记本，向比赛提交您的作品，等等。</p><p id="1659" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章旨在展示如何开发一个框架来列出和下载比赛数据集。用例不受限制，可以扩展到Kaggle提供的所有API特性。</p><h2 id="3e4f" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">进口:</h2><p id="a43c" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">API调用是外壳命令。为了从Python执行命令，我们将使用Python的内置<code class="fe ma mb mc md b">subprocess</code>库。对于数据分析和解析，<code class="fe ma mb mc md b">pandas</code>库是最合适的。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="8480" class="lc ld iq md b gy mi mj l mk ml">import subprocess<br/>import pandas as pd</span></pre><p id="51cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">比赛名单:</strong></p><p id="a0bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实现我们用例的第一步是检查所需竞争的可用性。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="771a" class="lc ld iq md b gy mi mj l mk ml">subprocess.call(["kaggle","competitions","list"])</span></pre><p id="7779" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以从上面的<code class="fe ma mb mc md b">subprocess.call</code>方法调用竞争列表命令。</p><h2 id="e408" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">记录分析结果:</h2><p id="4158" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">将结果捕获到文本文件中有助于我们解析数据，以完成我们的竞争可用性检查。这可以通过使用子过程库的<code class="fe ma mb mc md b">stdout</code>方法来实现。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="e856" class="lc ld iq md b gy mi mj l mk ml">f = open("competitions_list.txt","w")<br/>subprocess.call(["kaggle","competitions","list"], stdout=f)</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mm"><img src="../Images/0a9d4e513fcd12a0a71e3b09d51576c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GTA_KleMhp793lCUnKo9nA.png"/></div></div></figure><p id="a42a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们记录的文本文件是表格格式的。然而，使用<code class="fe ma mb mc md b">pd.read_tables()</code>类不会产生格式化的视图。因此，我们将使用Pandas固定宽度的文件类<code class="fe ma mb mc md b">pd.read_fwf()</code></p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="f869" class="lc ld iq md b gy mi mj l mk ml">df = pd.read_fwf(“competitions_list.txt”)</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mn"><img src="../Images/944e812535c686130cc0de87ddd807a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Itl8QpUdRILEO0khHl6LPw.png"/></div></div></figure><p id="59d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Pandas data frame系列提供数据切片，通过这种方式，我们可以达到我们的竞争可用性需求。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="35da" class="lc ld iq md b gy mi mj l mk ml">for x in df[‘ref’].str.contains(“store-sales-time-series-   forecasting”):<br/>    comptetitions.append(x)</span></pre><p id="fc77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们有了一个竞争可用性列表，使用if else解析这个列表将给出我们想要的状态，一旦满足可用性条件，我们就可以下载竞争。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="9fba" class="lc ld iq md b gy mi mj l mk ml">if any(comptetitions) is True:<br/>    print(“compeition found”)<br/>    subprocess.call([“kaggle”,”competitions”,”download”,”-c”,”competition_name”])<br/>else:<br/>    print(“competition not found”)</span></pre><p id="21af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的if-else条件将记录状态并成功下载竞赛。</p><h2 id="8734" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">将所有东西包装成一个方法:</h2><p id="ba50" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">将所有步骤整合到一个方法中，以实现模块化和可重用性。该方法将所有表达式集合在一起，并维护一个可变列表，该列表位于方法范围内，用于解析竞争检查。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="2b21" class="lc ld iq md b gy mi mj l mk ml">def check_competition_Status(competition_name):<br/>    f = open("competitions_list.txt","w")<br/>    subprocess.call(["kaggle","competitions","list"], stdout=f)<br/>    df = pd.read_fwf("competitions_list.txt")<br/>    for x in  df['ref'].str.contains("gan-getting-started"):<br/>        self.comptetitions.append(x)<br/>        if any(self.comptetitions) is True:<br/>            print("compeition found")<br/>            subprocess.call(["kaggle","competitions","download","-c",f"{competition_name}"])<br/>        else:<br/>        print("competition not found")</span></pre><p id="2406" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法可以根据您的用例进行增强和重构，框架提供了扩展功能的灵活性。</p><h2 id="d0e0" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">完整代码:</h2><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="0c86" class="lc ld iq md b gy mi mj l mk ml">import subprocess<br/>import pandas as pd</span><span id="71d8" class="lc ld iq md b gy mo mj l mk ml">class kaggle_download_competitions(object):<br/>    def __init__(self):<br/>        self.comptetitions = []</span><span id="eee2" class="lc ld iq md b gy mo mj l mk ml">    def check_competition_Status(self, competition_name):<br/>        f = open("competitions_list.txt","w")<br/>        subprocess.call(["kaggle","competitions","list"], stdout=f)<br/>        df = pd.read_fwf("competitions_list.txt")<br/>        for x in  df['ref'].str.contains("gan-getting-started"):<br/>            self.comptetitions.append(x)<br/>            if any(self.comptetitions) is True:<br/>                print("compeition found")<br/>                subprocess.call(["kaggle","competitions", \n<br/>                "download","-c",f"{competition_name}"])<br/>            else:<br/>                print("competition not found")</span><span id="62aa" class="lc ld iq md b gy mo mj l mk ml">if __name__ == '__main__':<br/>    kaggle = kaggle_download_competitions()<br/>    kaggle.check_competition_Status('store-sales-time-series-forecasting')</span></pre><h2 id="9a00" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">输出:</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mp"><img src="../Images/8f1ae4468e6f76072c74fc4149f22ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FFFtCWGLNNE7m0CWaAd-0w.png"/></div></div></figure><h2 id="ce5a" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">结论:</h2><p id="600c" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">与API交互是所有应用程序中最普通的任务。构建框架和使用选择的语言实现API调用是需要经验的。Kaggle提供API命令来与平台交互和工作。</p><p id="0f67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从框架中下载数据集将被证明是API的一个有用的提供。我希望这种方法向读者展示了如何构建和触发API调用来开发功能并在工作中实现这一点。</p><p id="a2c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关注我的LinkedIn或T2的Twitter，了解更多关于DataOps和MLOps的信息，如果你想学习或添加更多的特性，请联系我。</p><p id="effd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">快乐编码。</p></div></div>    
</body>
</html>
<html>
<head>
<title>The Basics of the :as Option in Ruby on Rails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby on Rails中:as选项的基础知识</h1>
<blockquote>原文：<a href="https://itnext.io/the-basics-of-the-as-option-in-rails-ca28de7e3303?source=collection_archive---------4-----------------------#2018-05-21">https://itnext.io/the-basics-of-the-as-option-in-rails-ca28de7e3303?source=collection_archive---------4-----------------------#2018-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="85ea" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">快速轻松地定制您的路线助手</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0329b6c778df7895f4608c91973f4a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SxeGQmhnkqizW6jJirIcLg.jpeg"/></div></div></figure><h2 id="cfa0" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">:as允许您自定义路线助手</h2><p id="3f0a" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">简单地说，您可以在您的<code class="fe mg mh mi mj b">routes.rb</code>文件中使用:as选项，并定制或覆盖您的路由助手。但是在我们深入:as之前，让我们确保我们知道什么是路由以及路由助手做什么。</p><h2 id="c937" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">快速概述:路线和路线助手</h2><p id="3035" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">假设我们有一个班级学生和一个表格学生，他们都完全遵循REST约定，因为我们在routes文件中使用了#resources:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="4919" class="kr ks iq mj b gy mo mp l mq mr">resources :students </span></pre><p id="9537" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">当我在我的控制台上运行<code class="fe mg mh mi mj b">rake routes</code>时，这些都是Rails友好地为我创建的路线:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="7cb5" class="kr ks iq mj b gy mo mp l mq mr">~/Coding/stdnt-example$ rake routes</span><span id="da3d" class="kr ks iq mj b gy mx mp l mq mr">      Prefix Verb   URI Pattern                  Controller#Action<br/>    students GET    /students(.:format)          students#index<br/>             POST   /students(.:format)          students#create<br/> new_student GET    /students/new(.:format)      students#new<br/>edit_student GET    /students/:id/edit(.:format) students#edit<br/>     student GET    /students/:id(.:format)      students#show<br/>             PATCH  /students/:id(.:format)      students#update<br/>             PUT    /students/:id(.:format)      students#update<br/>             DELETE /students/:id(.:format)      students#destroy</span></pre><p id="7069" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">神奇。如果你不熟悉这四栏，我们主要关注第一栏“前缀”和第三栏“URI模式”。我们使用基于前缀的路由助手，然后它们把我们带到URI的页面。路线助手是这些家伙:</p><p id="26be" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated"><code class="fe mg mh mi mj b">student_path(@student)</code></p><p id="7b7c" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">取代了这种丑陋:</p><p id="78c5" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated"><code class="fe mg mh mi mj b">“/students/#{@student.id}”</code></p><p id="cc9b" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">我们从哪找来的那个路线助手？我们所做的只是在前缀中添加了“_path”。就是这样。在该表中，前缀“学生”与<code class="fe mg mh mi mj b">/students/:id</code>页面相关联。如果我们想使用一个路线助手到达<code class="fe mg mh mi mj b">/students</code>，它将只是<code class="fe mg mh mi mj b">students_path</code>。</p><p id="f8f6" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">路由助手是在代码中编写路径名的更友好、更简洁、更安全的方式。你应该使用它们。很多。</p><h2 id="272c" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">资源不足时自定义路线</h2><p id="ca8b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">资源方法很棒，但它不能涵盖所有内容。自定义路线仍然需要手动输入。比方说，我们想要一个特殊的页面，显示a学生在所有课程中的最好成绩，如果你愿意，也可以是书呆子的最高分页面。这不属于#resources的自动生成路线，我们必须定制一条路线:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="2b7b" class="kr ks iq mj b gy mo mp l mq mr"># routes.rb <br/>get '/students/:id/grades', to: 'students#grades'</span></pre><p id="3b14" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">但是现在当我们运行<code class="fe mg mh mi mj b">rake routes</code>时，我们得到这个:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="720b" class="kr ks iq mj b gy mo mp l mq mr">Prefix Verb   URI Pattern                    Controller#Action<br/>    students GET    /students(.:format)            students#index<br/>             POST   /students(.:format)            students#create<br/> new_student GET    /students/new(.:format)        students#new<br/>edit_student GET    /students/:id/edit(.:format)   students#edit<br/>     student GET    /students/:id(.:format)        students#show<br/>             PATCH  /students/:id(.:format)        students#update<br/>             PUT    /students/:id(.:format)        students#update<br/>             DELETE /students/:id(.:format)        students#destroy<br/>             GET    /students/:id/grades(.:format) students#grades</span></pre><p id="4f44" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">蹩脚。动态路由意味着Rails不知道如何自动生成前缀。没有它也能很好地工作，用户仍然可以导航到它，但是这意味着我们每次在代码中使用它的时候都必须键入这个怪物:</p><p id="5e24" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated"><code class="fe mg mh mi mj b">“/students/#{@student.id}/grades”</code></p><p id="8594" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">Rails的全部意义在于让代码神奇地为你编写。如果rails通常是大卫·科波菲尔让自由女神像消失，那么一个没有路线助手的页面就像你7岁的表弟让你选一张卡片。糟透了。</p><p id="1a1d" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">相反，让我们使用:as来获得一个定制的路由助手！</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="2435" class="kr ks iq mj b gy mo mp l mq mr">get '/students/:id/grades', to: 'students#grades', as: 'grades'</span></pre><p id="1f66" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">这给了我们这个前缀:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="31cb" class="kr ks iq mj b gy mo mp l mq mr">Prefix  Verb  URI Pattern                     Controller#Action</span><span id="2048" class="kr ks iq mj b gy mx mp l mq mr"># ...those old routes still<br/>grades  GET   /students/:id/grades(.:format)  students#grades</span></pre><h2 id="42d3" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">覆盖预设</h2><p id="bf8b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">也可以创建一个不遵循惯例的路径助手。假设我们有一个页面供新生获取账户，<code class="fe mg mh mi mj b">/students/new</code>，还有一个页面供新生获取信息，<code class="fe mg mh mi mj b">/new-students</code>。这是一个人为的例子，但无论如何，关键是，你有两个听起来相似的URI，因为生活是不公平的。因此，因为<code class="fe mg mh mi mj b">students/new</code>实际上更像是一个注册页面，所以让我们避免混淆，创建一个路由助手来完成这个任务:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="7386" class="kr ks iq mj b gy mo mp l mq mr"># these 3 lines are in our routes.rb file </span><span id="8fd4" class="kr ks iq mj b gy mx mp l mq mr">resources :students <br/>get '/students/new', to: 'students#new', as: 'register'<br/>get '/new-students', to: 'students#new_students,'</span><span id="92c8" class="kr ks iq mj b gy mx mp l mq mr"><br/># ...which gives us these routes: <br/>Prefix Verb   URI Pattern                  Controller#Action<br/>    students GET    /students                students#index<br/>             POST   /students                students#create<br/> new_student GET    /students/new            students#new<br/>edit_student GET    /students/:id/edit       students#edit<br/>     student GET    /students/:id            students#show<br/>             PATCH  /students/:id            students#update<br/>             PUT    /students/:id            students#update<br/>             DELETE /students/:id            students#destroy<br/>    register GET    /students/new            students#new<br/>new_students GET    /new-students            students#new_students</span></pre><p id="db83" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">现在我们不再混淆<code class="fe mg mh mi mj b">new_student_path</code>和<code class="fe mg mh mi mj b">new_students_path</code>，而是简单地用<code class="fe mg mh mi mj b">register_path</code>和<code class="fe mg mh mi mj b">new_students_path</code>来代替。</p><h2 id="f996" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">较短的定制路线</h2><p id="79ba" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">Rails知道如何为非动态路由生成rails助手，但有时我们需要更短的助手。以这条路径为例，它显示了顶级区域的最佳学生:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="c2fc" class="kr ks iq mj b gy mo mp l mq mr">get '/students/region-1/top-20', to: 'students#tops'</span></pre><p id="1e95" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">Rails自动制作路线助手:<code class="fe mg mh mi mj b">students_region_1_top_20_path</code>。恶心。与其输入这么长的内容，我们不如给我们的路线起个别名:</p><pre class="kg kh ki kj gt mk mj ml mm aw mn bi"><span id="5ea2" class="kr ks iq mj b gy mo mp l mq mr">get '/students/region-1/top-20', to: 'students#tops', as: "r1_top20"</span></pre><p id="bb22" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">现在的路线助手只是<code class="fe mg mh mi mj b">r1_top20_path</code>。</p><h2 id="4986" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">这是最基本的！</h2><p id="bc3c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">对于大多数基本站点来说，#resources和Rails本身会为你处理路由和路由助手。但是了解如何定制和手动操作总是好的。另外，:as还有其他一些用法，在处理作用域和嵌套的<a class="ae my" href="http://guides.rubyonrails.org/routing.html" rel="noopener ugc nofollow" target="_blank"> Rails文档</a>中有描述，所以我推荐好奇的人去看看。我希望这有所帮助，一如既往，不要犹豫问任何问题或指出混淆/错误的部分，如果你发现他们。</p><p id="5a2d" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">大家编码快乐，</p><p id="b90a" class="pw-post-body-paragraph ln lo iq lp b lq ms jr ls lt mt ju lv la mu lx ly le mv ma mb li mw md me mf ij bi translated">迈克</p></div></div>    
</body>
</html>
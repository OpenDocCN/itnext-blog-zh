<html>
<head>
<title>The Ultimate Guide to Setup Golden Gate On Vagrant Box</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在流浪者盒子上设置金门的终极指南</h1>
<blockquote>原文：<a href="https://itnext.io/the-ultimate-guide-to-setup-golden-gate-on-vagrant-box-5f73fc67ebd6?source=collection_archive---------5-----------------------#2018-07-22">https://itnext.io/the-ultimate-guide-to-setup-golden-gate-on-vagrant-box-5f73fc67ebd6?source=collection_archive---------5-----------------------#2018-07-22</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/66f1a38917611144d49d610082653e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Lfeii5UcLLjmqZPK"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">由<a class="ae kd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>的<a class="ae kd" href="https://unsplash.com/@cleipelt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Chris Leipelt </a>拍摄的“背景中水晶般湛蓝的水面上的旧金山金门大桥的无人机视图”</figcaption></figure><p id="d968" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">如果你读过我之前在<a class="ae kd" href="https://iamninad.com/how-debezium-kafka-stream-can-help-you-write-cdc/" rel="noopener ugc nofollow" target="_blank"> Debezium </a>上的帖子，我已经提到过，目前我正在开发一个平台，该平台包括从Oracle捕获CDC事件并将其发布到我们的新数据库。为此，Oracle提供了类似于Debezium的Golden Gate，将所有数据库更改发布到Kafka主题。然而，如果你像我一样是一名开发人员，正在Mac OS上工作，却没有为Mac安装Oracle DB，这很令人难过😞那么这篇帖子将帮助你拥有自己的Oracle流浪环境。</p><p id="fb8b" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">当我在开发这个新平台时，我的一个同事告诉我，Oracle有一个可以为在mac上工作的开发人员提供Oracle 12c的流浪映像。然后我检查了一下，发现Oracle已经为Linux和Oracle 11和12c创建了一个GitHub repo。在那之后，我基本上把这个流浪文件作为我工作的基础，并在Linux机器上安装了金门设置和合流包。但是你知道手动安装是一项非常繁琐的任务。如果我写一个包含所有步骤的博客，你们会怎么样？</p><figure class="ld le lf lg gu js gi gj paragraph-image"><div class="gi gj lc"><img src="../Images/52b39a1e6a8fd726897d49cc4d94dab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/0*v1_e7xOIeFFKRtZO.gif"/></div></figure><p id="0c29" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">因此，我增强了脚本来完成这项艰巨的工作，并安装了Golden Gate + Confluent +在迁移箱供应期间为Oracle数据库启用一些配置。您知道哪个命令可以为您完成所有的设置和配置。遵循帖子中给出的具体步骤，您将获得Oracle数据库、金门和合流的神奇力量。😂</p><figure class="ld le lf lg gu js gi gj paragraph-image"><div class="gi gj lh"><img src="../Images/a1bcf2c2ec1ee9f38e389a516af9f413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*Xw85qX2IdeBo0hLh.gif"/></div></figure><h1 id="1588" class="li lj ir bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">1.克隆流浪者盒子图像</h1><p id="429b" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">从这里克隆我的神谕流浪叉:<a class="ae kd" href="https://github.com/ninadingole/vagrant-boxes.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ninadingole/vagrant-boxes.git</a>。让我们祝愿我的pull请求被oracle贡献者团队接受，这项工作正式成为Oracle GitHub repository的一部分🤞🏼).</p><h1 id="1cc9" class="li lj ir bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">2.下载Oracle数据库Zip</h1><p id="28d5" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">从甲骨文技术网<a class="ae kd" href="http://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html" rel="noopener ugc nofollow" target="_blank">这里</a>T5】http://www . Oracle . com/tech network/database/enterprise-edition/downloads/index . html下载Oracle database 12c zip文件。使用Oracle Database 12c Release 2—Linux x86–64版本，下载大约3.2GB的单个文件zip</p><h1 id="24b5" class="li lj ir bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">3.下载Oracle GG和Oracle GG BD</h1><p id="587e" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">现在，我们需要Oracle Golden Gate和Golden Gate for Big Data zip文件。这些文件可以从<a class="ae kd" href="http://www.oracle.com/technetwork/middleware/goldengate/downloads/index.html" rel="noopener ugc nofollow" target="_blank">http://www . Oracle . com/tech network/middleware/golden gate/downloads/index . html</a>下载。在Linux x86–64上下载Oracle golden gate for Big Data 12 . 3 . 1 . 1 . 1&amp;Oracle golden gate 12 . 3 . 0 . 1 . 4 for Oracle on Linux x86–64。</p><blockquote class="ml mm mn"><p id="16b7" class="ke kf mo kg b kh ki kj kk kl km kn ko mp kq kr ks mq ku kv kw mr ky kz la lb ik bi translated">将所有下载的文件保存在同一个目录下。</p></blockquote><h1 id="f775" class="li lj ir bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">4.开始流浪</h1><p id="c4d4" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">至此，所有先决条件都已完成。现在运行<code class="fe ms mt mu mv b">vagrant up</code>，这将开始在Linux机器上安装Oracle database 12c、oracle golden gate、oracle golden gate for big data和融合oss软件包。</p><figure class="ld le lf lg gu js gi gj paragraph-image"><div class="gi gj mw"><img src="../Images/09a3c6508ebc48176f0833f9f65deee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*0IUX82yH7zv3v_Gs.gif"/></div></figure><p id="95a5" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">等到一切结束。最后，安装程序将打印Oracle数据库的密码，请务必复制该密码，因为这将有助于您继续下一步。现在，您已经在Mac或任何安装了vagger的机器上准备好了CDC开发环境。😎</p><figure class="ld le lf lg gu js gi gj paragraph-image"><div class="gi gj mx"><img src="../Images/241470493c4b35bec2499faf1a83a2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/0*Omi_GCHVEL0zWo0j.gif"/></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">全部完成</figcaption></figure></div><div class="ab cl my mz hv na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ik il im in io"><p id="5ade" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">如果您不熟悉Oracle golden gate，并且想了解如何为Oracle数据库配置golden gate，请遵循本文中的以下步骤。</p><h1 id="999e" class="li lj ir bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">在流浪者盒子上配置金门</h1><p id="7f03" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">我们需要配置两个东西，首先是oracle golden gate，然后是oracle golden gate for big data。让我们首先为Oracle数据库配置golden gate。请按照准确的步骤让它运行起来。您可以在oracle golden gate <a class="ae kd" href="https://www.oracle.com/technetwork/middleware/goldengate/documentation/index.html" rel="noopener ugc nofollow" target="_blank">文档</a>中找到关于以下命令的更多信息。</p><h2 id="1d3e" class="nf lj ir bd lk ng nh dn lo ni nj dp ls kp nk nl lw kt nm nn ma kx no np me nq bi translated">1.将示例模式加载到Oracle数据库。</h2><p id="8b32" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">我们需要一个存在于已安装的oracle数据库中的模式，这样我们就可以配置golden gate来监听这个模式上发生的变化。Oracle安装程序附带了安装中的HR模式SQL文件。我们将加载相同的到我们的数据库中。</p><ol class=""><li id="c9e5" class="nr ns ir kg b kh ki kl km kp nt kt nu kx nv lb nw nx ny nz bi translated">以sysdba身份使用SQL shell登录数据库:<br/> <code class="fe ms mt mu mv b">sqlplus / as sysdba</code></li><li id="df80" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">更改会话以允许Oracle脚本执行:<br/> <code class="fe ms mt mu mv b">alter session set "_ORACLE_SCRIPT"=true;</code></li><li id="937d" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">将会话更改为使用PDB数据库(在SQL shell中):<br/> <code class="fe ms mt mu mv b">alter session set container=ORCLPDB1;</code></li><li id="2753" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">加载模式，并为以下命令要求的所有输入提供适当的响应:<br/> <code class="fe ms mt mu mv b">@?/demo/schema/human_resources/hr_main.sql</code></li></ol><p id="25f6" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">作为oracle用户执行以下命令，使用<code class="fe ms mt mu mv b">sudo su - oracle</code>将流浪用户切换到Oracle</p><h2 id="ad5c" class="nf lj ir bd lk ng nh dn lo ni nj dp ls kp nk nl lw kt nm nn ma kx no np me nq bi translated">2.配置Oracle金门大桥</h2><ol class=""><li id="3009" class="nr ns ir kg b kh mg kl mh kp of kt og kx oh lb nw nx ny nz bi translated">转到Oracle golden gate安装目录。<br/>T3】</li><li id="d251" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">打开金门控制台。<br/> <code class="fe ms mt mu mv b">./ggsci</code></li><li id="46b6" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">启动管理器。<br/> <code class="fe ms mt mu mv b">&gt; start mgr</code></li><li id="9c74" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">登录到数据库。<br/> <code class="fe ms mt mu mv b">&gt; DBLOGIN USERID <a class="ae kd" href="https://iamninad.com/cdn-cgi/l/email-protection" rel="noopener ugc nofollow" target="_blank">[email protected]</a>:1521/ORCLCDB PASSWORD [password copied while installation]</code></li><li id="1356" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">注册摘录。<br/>T7】</li><li id="8242" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">为表启用模式级补充日志记录。<br/> <code class="fe ms mt mu mv b">&gt; ADD SCHEMATRANDATA ORCLPDB1.HR ALLCOLS</code></li><li id="4a05" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">创建提取组。<br/> <code class="fe ms mt mu mv b">&gt; ADD EXTRACT EXT1, INTEGRATED TRANLOG, BEGIN NOW</code></li><li id="5d3c" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">在本地系统上创建用于在线处理的跟踪，并将其与提取组相关联。<br/> <code class="fe ms mt mu mv b">&gt; ADD EXTTRAIL ./dirdat/lt EXTRACT EXT1</code></li><li id="f182" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">创建EXT1参数文件并粘贴文件中的内容。<br/> <code class="fe ms mt mu mv b">&gt; EDIT PARAM EXT1</code></li></ol><pre class="ld le lf lg gu oi mv oj ok aw ol bi"><span id="efd8" class="nf lj ir mv b gz om on l oo op">EXTRACT EXT1 <br/>USERID SYSTEM@ORCLCDB, PASSWORD [password copied during installation] <br/>EXTTRAIL ./dirdat/lt <br/>SOURCECATALOG ORCLPDB1 <br/>TABLE HR.*;</span></pre><p id="a88b" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">10.开始提取EXT1。<br/> <code class="fe ms mt mu mv b">&gt; start ext1</code></p><p id="4b5b" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">11.查看经理和ext1的状态。<br/> <code class="fe ms mt mu mv b">&gt; info all</code></p><pre class="ld le lf lg gu oi mv oj ok aw ol bi"><span id="1fd7" class="nf lj ir mv b gz om on l oo op">Program  Status   Group    Lag at Chkpt   Time Since Chkpt <br/>MANAGER  RUNNING  <br/>EXTRACT  RUNNING   EXT1     00:00:00        00:00:00</span></pre><p id="81e2" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">Oracle 12c的Oracle golden gate已配置。现在，是时候为大数据配置Oracle golden gate了，这将把所有的更改/ CDC事件推送到汇合的Kafka。</p><h2 id="5984" class="nf lj ir bd lk ng nh dn lo ni nj dp ls kp nk nl lw kt nm nn ma kx no np me nq bi translated">3.为大数据配置Oracle Golden Gate</h2><p id="14a6" class="pw-post-body-paragraph ke kf ir kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ik bi translated">在执行以下步骤之前，确保将java路径添加到<code class="fe ms mt mu mv b">.bashrc</code>文件中的<code class="fe ms mt mu mv b">$LD_LIBRARY_PATH</code>环境变量。java的位置是<code class="fe ms mt mu mv b">/usr/lib/jvm/java-1.8.0-openjdk-XXXXX/jre/lib/amd64/server</code>。在安装过程中，用安装在上的当前版本替换XXXXX。</p><ol class=""><li id="df51" class="nr ns ir kg b kh ki kl km kp nt kt nu kx nv lb nw nx ny nz bi translated">将目录更改为oggbd <br/> <code class="fe ms mt mu mv b">cd /u01/oggbd</code></li><li id="4cc4" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">打开bd控制台的金门。<br/> <code class="fe ms mt mu mv b">./ggsci</code></li><li id="3604" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">创建默认目录。<br/> <code class="fe ms mt mu mv b">&gt; CREATE SUBDIRS</code> <br/>完成后使用<code class="fe ms mt mu mv b">exit</code>命令退出控制台，并在<code class="fe ms mt mu mv b">dirprm</code>目录下创建以下文件。</li><li id="a52c" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">使用步骤<code class="fe ms mt mu mv b">2</code>再次登录GG控制台，然后执行以下命令，并将内容添加到参数文件<br/> <code class="fe ms mt mu mv b">&gt; edit param mgr</code> <br/> `dawd `中</li><li id="2fdf" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">启动管理器。<br/> <code class="fe ms mt mu mv b">&gt; start mgr</code></li><li id="6775" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">创建复制组<code class="fe ms mt mu mv b">rkafka</code>。<br/> <code class="fe ms mt mu mv b">&gt; add replicat rkafka, exttrail /u01/ogg/dirdat/lt</code></li><li id="26cb" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">启动复制机。<br/>T5】</li><li id="b7db" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb nw nx ny nz bi translated">如果一切配置正确，查看所有状态。<br/> <code class="fe ms mt mu mv b">&gt; info all</code></li></ol><pre class="ld le lf lg gu oi mv oj ok aw ol bi"><span id="1b3e" class="nf lj ir mv b gz om on l oo op">Program  Status   Group   Lag at Chkpt   Time Since Chkpt <br/>MANAGER  RUNNING <br/>REPLICAT RUNNING  RKAFKA    00:00:00       00:00:09</span></pre><h2 id="bd08" class="nf lj ir bd lk ng nh dn lo ni nj dp ls kp nk nl lw kt nm nn ma kx no np me nq bi translated">4.验证设置</h2><ol class=""><li id="ebf3" class="nr ns ir kg b kh mg kl mh kp of kt og kx oh lb nw nx ny nz bi translated">登录数据库并向任何表中添加行，如:</li></ol><pre class="ld le lf lg gu oi mv oj ok aw ol bi"><span id="b842" class="nf lj ir mv b gz om on l oo op">&gt; sqlplus / as sysdba <br/>SQL&gt; alter session set container=ORCLPDB1; <br/>SQL&gt; INSERT INTO HR.REGIONS(REGION_ID, REGION_NAME) VALUES(47, 'FOO'); <br/>SQL&gt; COMMIT;</span></pre><p id="4959" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">2.检查是否为数据插入表<br/> <code class="fe ms mt mu mv b">&gt; kafka-topics --zookeeper localhost:2181 --list</code>创建了kafka主题</p><pre class="ld le lf lg gu oi mv oj ok aw ol bi"><span id="a3fb" class="nf lj ir mv b gz om on l oo op">__confluent.support.metrics <br/>__consumer_offsets <br/>_confluent-ksql-default__command_topic <br/>_schemas <br/>connect-configs <br/>connect-offsets <br/>connect-statuses <br/>ora-ogg-HR-REGIONS-avro</span></pre><ul class=""><li id="e995" class="nr ns ir kg b kh ki kl km kp nt kt nu kx nv lb oq nx ny nz bi translated">要检查kafka主题运行中的数据</li></ul><pre class="ld le lf lg gu oi mv oj ok aw ol bi"><span id="ab44" class="nf lj ir mv b gz om on l oo op">&gt; kafka-avro-console-consumer --bootstrap-server localhost:9092 --topic ora-ogg-HR-REGIONS-avro --from-beginning</span></pre><p id="6cb1" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">您可以从运行vagger的主机上运行<code class="fe ms mt mu mv b">kafka-topics</code>和<code class="fe ms mt mu mv b">kafka-avro-console-consumer</code>。这将有助于您在编码时连接到存在于流浪者虚拟机中的Kafka实例。此外，Oracle数据库运行在端口“1521”上，您可以从java代码或IDE连接到该端口。</p><figure class="ld le lf lg gu js gi gj paragraph-image"><div class="gi gj or"><img src="../Images/fa2e8224e3dd225563a8c9c30ce2dd2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*OF6LhCV36N4iyZOk.gif"/></div></figure><p id="a8a4" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">这个流浪图片对我真的很有帮助，希望它也能帮助你们开发与CDC相关的应用程序。对于任何问题，在设置或配置期间，请在帖子上发表评论。</p><ul class=""><li id="373e" class="nr ns ir kg b kh ki kl km kp nt kt nu kx nv lb oq nx ny nz bi translated">动物园管理员端口:2181</li><li id="698a" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb oq nx ny nz bi translated">卡夫卡经纪人:9092</li><li id="3e3d" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb oq nx ny nz bi translated">汇合架构注册表:8081</li><li id="3fc3" class="nr ns ir kg b kh oa kl ob kp oc kt od kx oe lb oq nx ny nz bi translated">Oracle数据库端口:1521</li></ul></div><div class="ab cl my mz hv na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ik il im in io"><p id="9dd4" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated"><em class="mo">原载于2018年7月22日</em><a class="ae kd" href="https://iamninad.com/the-ultimate-guide-to-setup-golden-gate-on-vagrant/" rel="noopener ugc nofollow" target="_blank"><em class="mo">iamninad.com</em></a><em class="mo">。</em></p></div></div>    
</body>
</html>
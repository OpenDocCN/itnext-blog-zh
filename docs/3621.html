<html>
<head>
<title>Pull -to-dismiss modal presentation in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS中的拖放模式演示</h1>
<blockquote>原文：<a href="https://itnext.io/pull-to-dismiss-modal-presentation-in-ios-d6284434c860?source=collection_archive---------4-----------------------#2020-01-19">https://itnext.io/pull-to-dismiss-modal-presentation-in-ios-d6284434c860?source=collection_archive---------4-----------------------#2020-01-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6b464f6793cb1d5ef14bec4e148b211d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ZXZBZT90lxCPby66CG87Q.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">朱利安·迈尔斯在<a class="ae kf" href="https://unsplash.com/s/photos/california?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b93e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">TL；</strong>这是<em class="le"> </em> <a class="ae kf" href="https://gist.github.com/vinczebalazs/ee1f2b466f969fa70d424d4480695325" rel="noopener ugc nofollow" target="_blank"> <em class="le">博士最后的代号</em> </a> <em class="le">。</em></p><p id="cc66" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我用它建立了一个示例模型:</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="lj lk l"/></div></figure></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="7b64" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嘿！</p><p id="de63" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天，我将快速向您介绍如何创建一个可以通过下拉手势消除的模态演示样式，就像iOS 13的默认行为一样。</p><p id="4563" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可能会问，为什么不使用默认的呢？</p><p id="6085" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗯，主要是两个原因:</p><ol class=""><li id="8a78" class="ls lt it ki b kj kk kn ko kr lu kv lv kz lw ld lx ly lz ma bi translated">向后兼容性。</li><li id="155f" class="ls lt it ki b kj mb kn mc kr md kv me kz mf ld lx ly lz ma bi translated">定制的需要。例如，将所呈现的模型的高度改为仅半屏。</li></ol><p id="29a2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们开始吧！</p><p id="e410" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我写这篇文章的原因是因为关于这个主题的文档很少，我花了相当多的时间来弄清楚所有的部分是如何组合在一起的。</p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="3343" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">构建这样的东西有几个挑战，第一个挑战实际上是理解以下协议如何协同工作:</p><p id="89b7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">UIViewControllerTransitioningDelegate</strong></p><p id="e402" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">UIViewControllerAnimatedTransitioning</strong></p><p id="e848" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">UIPresentationController</strong></p><p id="704b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">uipercentdriveninteractive transition</strong></p><p id="ee62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">苹果在<a class="ae kf" href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/CustomizingtheTransitionAnimations.html" rel="noopener ugc nofollow" target="_blank">解释</a>它方面做得相当不错，然而他们的代码样本确实给读者留下了许多漏洞需要填补。我不会在这里解释每个协议做什么，因为本文的目的是向您展示它们是如何协同工作的。</p><p id="4374" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关键点是:</p><ul class=""><li id="56da" class="ls lt it ki b kj kk kn ko kr lu kv lv kz lw ld mg ly lz ma bi translated">UIViewControllerTransitioningDelegate作为一个中介，负责提供动画对象、交互控制器和演示控制器。</li><li id="d593" class="ls lt it ki b kj mb kn mc kr md kv me kz mf ld mg ly lz ma bi translated">UIViewControllerAnimatedTransitioning是我们的animator对象，这里是实际动画代码的位置。</li><li id="9632" class="ls lt it ki b kj mb kn mc kr md kv me kz mf ld mg ly lz ma bi translated"><strong class="ki iu">UIPresentationController</strong>设置演示环境，这包括在模型后面添加一个“调光视图”,并附加一个平移手势识别器用于交互式消除。</li><li id="8966" class="ls lt it ki b kj mb kn mc kr md kv me kz mf ld mg ly lz ma bi translated"><strong class="ki iu">UIPercentDrivenInteractiveTransition</strong>将根据完成的百分比来擦除动画，我们根据平移手势的翻译来计算完成的百分比。</li></ul></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="4406" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我发现自己陷入的第二个<strong class="ki iu">陷阱</strong>是使用<strong class="ki iu"> UIView.animate </strong>而不是<strong class="ki iu">uiviewpropertyimator。UIView.animate </strong>应该在纸上完成工作，但是当与<strong class="ki iu">uipercentdriveninteractive transition</strong>配合使用时，动画与平移手势完全不同步。</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="mh lk l"/></div></figure></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="c98e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第三件让我感到困难的事情是让用户感觉解雇过渡很自然。这意味着如果用户的滑动手势具有更高的速度，则以更快的动画关闭模式。在找到解决问题的方法后，解决方案确实非常简单:</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="mi lk l"/></div></figure><p id="bf5e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<strong class="ki iu"><em class="le">UIPercentDrivenInteractiveTransition的</em></strong><strong class="ki iu">completion speed</strong>中设置的值作为动画持续时间的乘数。我们使用<strong class="ki iu"> max(1，x) </strong>是因为如果用户缓慢向下拖动，然后放开，我们不希望以这种缓慢的速度关闭模态，而是使用默认速度。否则会感觉怪怪的。</p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="e4e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第四件事并不是真正的挑战，而是一个<strong class="ki iu">干</strong>的问题。当使用定制的表示风格表示视图控制器时，每次都必须在表示视图控制器中编写样板代码:</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="mi lk l"/></div></figure><p id="b5e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相反，我把它包装成了一个扩展，这样我就不用每次都写了。</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="mi lk l"/></div></figure></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="3e87" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望这有助于消除一些困惑，并为您在自己的应用程序中实现如此琐碎(但却令人惊讶地具有挑战性)的东西指明正确的方向！</p><p id="fb8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读，敬请期待更多内容！🎉</p><p id="04a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> <em class="le">附言</em> </strong> <em class="le">有问题吗？请在评论中告诉我。</em></p><p id="f7b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">资源:</strong></p><p id="f38a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://gist.github.com/vinczebalazs/ee1f2b466f969fa70d424d4480695325" rel="noopener ugc nofollow" target="_blank">要点与最终代码和示例用法。</a></p></div></div>    
</body>
</html>
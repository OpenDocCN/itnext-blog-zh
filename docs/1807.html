<html>
<head>
<title>Cracking My First Password</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破解我的第一个密码</h1>
<blockquote>原文：<a href="https://itnext.io/cracking-my-first-password-8df292fc71c5?source=collection_archive---------0-----------------------#2019-02-03">https://itnext.io/cracking-my-first-password-8df292fc71c5?source=collection_archive---------0-----------------------#2019-02-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a7ca25cd10989c063dce1e65d5723ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*90vm9ynO9VQsbyAsz2Icnw.png"/></div></div></figure><p id="343d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我女儿的雇主通过电子邮件给她发了一份加密的PDF格式的税单。邮件中写道，“打开这份文件的密码是你的出生日期，格式为MMDDYYYY和你的SS号码的最后4位。”我打开文档，按照提示输入密码。</p><p id="e74b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但是没有用。</p><p id="57ba" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我仔细检查了我女儿的社会安全号码和她的出生日期(有时我们会把这些东西搞混)。我尝试了这样的方法，比如把她社交网站的最后四位放在第一位，然后是格式化的日期。我尝试了十几种不同的日期格式。我试着在她的SSN里调换了几个数字。什么都没用。</p><p id="2d2a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我给她的雇主发了邮件:</p><blockquote class="la lb lc"><p id="ab6b" class="kb kc kz kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">我们无法使用MMDDYYYY后跟她的SS号的最后4位数字来打开<daughter>的表单。你收到过其他人打不开的报告吗？</daughter></p></blockquote><p id="73ce" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">回应:</p><blockquote class="la lb lc"><p id="0ca8" class="kb kc kz kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">不，我没有听说其他人遇到过这种问题。我可以打印和邮寄，或者她来取，看哪个更方便。</p></blockquote><p id="1ab5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在过去的六年里，我已经完全实现了税收无纸化。我把我们所有的税单都数字化储存起来，按年份分类。与纸质文档相比，我更喜欢管理数字文档，纸质文档会积累多年，需要(物理地)存储、组织和移动。</p><p id="a3dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当然，我可以等待邮件中的文件到达，然后扫描它，但是这有什么意思呢？所以我开始使用谷歌:</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lg"><img src="../Images/bfbf6b730f0599bcefc4a514ee0925d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*8eWzMKD7mZKWtHb99KpSug.gif"/></div></div></figure><p id="b9b7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">“暴力破解”密码意味着尝试所有可能的字符组合，直到您最终猜出正确的密码。就我而言，我确信我女儿税单的密码由12位数字组成。在这个计算机时代，这不会太难破解，是吗？</p><p id="2d8c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第一步是从PDF文档中提取密码散列。如果“hash”让你想到“hash browns”，那你就离事实不远了。密码散列甚至被“加盐”以使其更难破解。</p><p id="1170" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要做土豆泥，你需要把土豆磨碎成小丝。让我们称这个光栅工具为“哈希算法”继续类比，为了破解我们的密码，我们需要通过哈希算法一个接一个地输入土豆，直到我们找到一个与原始哈希完全一样的土豆。你可以想象，那需要很多土豆。</p><p id="a6ab" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你饿了吗？</p><p id="1a4d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我也是。这是我的食谱:</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ll"><img src="../Images/671138bfb0887d9c90f03658507d951f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lld34oKBXHy3RNfBswIsvg.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">在未来，只有酷小孩才会写作。看着吧。</figcaption></figure><p id="65e6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，<a class="ae lq" href="https://www.perl.org/get.html" rel="noopener ugc nofollow" target="_blank">下载并安装Perl </a>。Perl是一种超级极客的编程语言，我希望我知道。我用的是微软的Windows(嘿，友好点)，所以我尝试了Perl的ActiveState和Strawberry风格。它们都可以工作，关键的部分是确保Windows关联。使用Perl的pl文件扩展名。</p><p id="b90a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我为开膛手约翰下载了GitHub repo。开膛手约翰是另一个有着悠久历史的极客工具。它的主要目的是尽可能快地把我们的土豆磨碎，直到我们找到匹配的。我下载了Windows版本并将其解压缩。它不需要安装。</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lr"><img src="../Images/fc8d29393559156ca0f34ff5872ab7de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJsbamW961XJaFgv6TRrtQ.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">点击什么来下载构建不是很明显，所以这里有一个截图。</figcaption></figure><p id="fdf7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我在JtR目录中找到了“run”文件夹，并复制了我试图破解的PDF文件(“TaxForm.pdf”)。我在准备我的工作空间。</p><p id="e7aa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我打开Windows Command Prompt并导航到JtR“run”目录，在那里有无数的——没有一个<em class="kz">多余的—</em>—Perl和Python脚本可以用来从所有不同类型的文件中提取密码哈希:7z2john.pl、cisco2john.pl、itunes_backup2john.pl等。我需要的那个叫做<strong class="kd iu"> pdf2john.pl </strong>。</p><p id="a5e6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">运行<code class="fe ls lt lu lv b">pdf2john.pl TaxForm.pdf</code>在屏幕上输出来自PDF文件的散列。但是JtR需要文本文件中的散列。所以我通过添加<code class="fe ls lt lu lv b">&gt;hashfile.txt</code>将输出重定向到一个文本文件。</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lw"><img src="../Images/4de8ccf26a8f35c0a232d1793da91a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B5U8zsMVn0ggJgTn9XvS4A.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">(这个散列实际上并不是我女儿的出生日期和SSN的散列。)</figcaption></figure><p id="f1f9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我几乎准备好开始破解。我只需要弄清楚如何告诉JtR只尝试长度为12个字符的数字0-9的组合。告诉JtR只使用数字的选项是<code class="fe ls lt lu lv b">--incremental=digits</code>，但是指定12个字符的长度需要编辑john.conf文件(方便地位于“run”目录中)。</p><p id="3cac" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">普通的Windows记事本不会检测到john.conf文件中的换行符，所以我用Notepad++打开了它。这是一个很大的文件，但是我在第1210行找到了我要找的参数。我设置了<code class="fe ls lt lu lv b">MinLen = 12</code>和<code class="fe ls lt lu lv b">MaxLen = 12</code>。</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/810374eddc6f26c88f0876728b4959ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*Kr26nnBnbRpisxejGhTuIA.png"/></div></figure><p id="897f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我用<code class="fe ls lt lu lv b">john --incremental=digits hashfile.txt</code>点燃了JtR</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/32207cb0dc042954f54d7a082d5323f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91-ADQcS7f-g9wImJZUwVA.png"/></div></div></figure><p id="bb98" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">JtR开始运行——在我的机器上——通过它的哈希算法，每秒超过50，000个组合，试图找到一个与我们从TaxForm.pdf提取的哈希匹配的哈希。JtR在屏幕上显示的输出并不多，但是会一直在后台运行，直到按下Ctrl-C。关于它在做什么的更多细节，我需要反复检查john.log文件:</p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/114cbc5f815e5760e38ce4fc41a32c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*AtLC-0pRYuNwtktvGr-dLQ.png"/></div></figure><p id="c145" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我让它运行了一整夜，直到第二天。然后我想到:12位数有9000亿种不同的组合。以每秒50，000次尝试的速度，全部尝试需要6个多月的时间。当然，如果运气好的话，我可能只需要几个星期就能找到正确的散列，但这仍然是一段很长的时间。如果我女儿的雇主几天后就把表格邮寄给我们，那就不值得了。</p><p id="c257" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">[我应该注意到，我的机器有一个酷睿i5处理器。我听说有人能够将一堆PlayStation处理器以菊花链形式连接在一起。他们可能比我的小CPU快100倍以上。]</p><p id="35de" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我开始想是否有更好的方法。</p><p id="afe8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">JtR破解密码的另一种方法是通过<strong class="kd iu">字典攻击</strong>。我们不是让JtR尝试所有可能的随机字符组合，而是为它提供一个预先生成的密码列表，让它可以尝试。</p><p id="ab2d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在[以MMDDYYYY表示的出生日期+SSN的最后四位数字]的模式中，我发现只使用了大约六位唯一的数字，如果我假设前三位(MMD部分)是正确的，我可以减少到五位。所以我拼凑了下面的Powershell代码来生成最后九个数字的所有可能排列的列表，以我希望正确的前三个数字为前缀。</p><figure class="lh li lj lk gt ju"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="509b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个脚本花了大约15分钟完成，但当它完成时，我有一个超过60万排列的列表，我可以用它来尝试破解TaxForm.pdf的密码散列。</p><p id="6257" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我把我的list.txt文件复制到JtR的运行目录下，尝试了<br/> <code class="fe ls lt lu lv b">john --wordlist=list.txt hashfile.txt</code></p><figure class="lh li lj lk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/c3b76fd6d5c83eeb46e88f59a49a2e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9vDhursbMvw0f2oTh0gMIQ.png"/></div></div></figure><p id="0d47" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">JtR只用了几秒钟就轻松找到了密码。它显示在我的屏幕上，如上所示，但这可能是因为我对john.conf文件做了一些进一步的调整。无论如何，JtR把破解的密码存储在一个名为john.pot的文件中。</p><p id="41b4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我发现我女儿的雇主把她的社会安全号码弄错了。它甚至在我现在终于能够打开的税单上也是不正确的。幸运的是，他们用这样一种方式弄错了它，它被我的单词表中的一个有限的排列抓住了。</p><p id="cd12" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">最后一点:</strong>对于字典攻击，JtR对我给它的单词列表文件的编码非常挑剔。当文件编码为UTF-8时效果最好。</p></div></div>    
</body>
</html>
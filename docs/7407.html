<html>
<head>
<title>Kubernetes Ingress &amp; Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes入口和示例</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-ingress-examples-f71ac22e9cfe?source=collection_archive---------1-----------------------#2022-09-14">https://itnext.io/kubernetes-ingress-examples-f71ac22e9cfe?source=collection_archive---------1-----------------------#2022-09-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fd8e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Azure Kubernetes服务上设置NGINX</h2></div><p id="847e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将探索Kubernetes (K8S)中的Ingress对象，并通过一些示例来了解如何使用它。然后，我们将一步一步地通过Azure Kubernetes服务(AKS)设置NGINX入口控制器。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/bc8cab7042fe16d8bb5d067cde6cec72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BLPJmyA5ICiBJMS2MdOWew.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">在<a class="ae lu" href="https://unsplash.com/s/photos/containers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae lu" href="https://unsplash.com/@inidianaa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Tri Eptaroka Mardiana </a>拍摄的照片</figcaption></figure><h2 id="2015" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">Kubernetes中的Ingress是什么？</h2><p id="86d8" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">K8S中的Ingress是一个允许从集群外部访问集群中的服务的对象。</p><p id="390b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">kubernetes.io上的官方文档描述了Ingress:</p><blockquote class="mt mu mv"><p id="ec7b" class="ki kj mw kk b kl km ju kn ko kp jx kq mx ks kt ku my kw kx ky mz la lb lc ld im bi translated">管理对群集中服务的外部访问的API对象，通常是HTTP。Ingress可以提供负载平衡、SSL终止和基于名称的虚拟主机。</p></blockquote><p id="5516" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">流量路由由入口资源上指定的规则定义。</p><p id="552a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">入口对象是指允许HTTP或HTTPS流量通过您的集群服务。它们不会向外界公开其他端口或协议。为此，应该使用负载平衡器或节点端口的服务类型。</p><p id="e148" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">服务是一组逻辑单元的外部接口。服务使用群集本地的“虚拟IP地址”,如果没有入口，外部服务将无法访问这些IP地址。</p><h2 id="4de9" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">入口、负载平衡器和节点端口</h2><p id="5460" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">入口、负载平衡器和节点端口都是公开K8S集群中的服务以供外部使用的方式。</p><p id="8ad7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">NodePort和LoadBalancer允许您通过在服务类型中指定值来公开服务。</p><p id="85cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过一个<strong class="kk iu">节点端口</strong>，K8S在每个节点上为指定的服务分配一个特定的端口。集群在端口上收到的任何请求都会被转发给服务。</p><p id="6cd5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<strong class="kk iu">负载平衡器</strong>，需要在K8S集群之外有一个外部服务来提供公共IP地址。在Azure中，这将是Azure Kubernetes服务(AKS)集群前面的Azure应用程序网关。在AWS中，这将是你的弹性Kubernetes服务(EKS)前面的应用负载平衡器(ALB ),而在Google cloud中，这将是你的Google Kubernetes引擎(GKE)集群前面的网络负载平衡器。每次公开新服务时，都需要创建一个新的负载均衡器来获取公共IP地址。方便的是，由于云提供商对Kubernetes的插件方式，负载平衡器的供应会自动发生，因此不必单独完成。</p><p id="9b4c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">入口是一个完全独立于服务的资源。除了能够将路由规则整合到一个地方(入口对象)之外，它还具有作为一个独立的、分离的实体的优势，可以独立于任何服务来创建和销毁。</p><h2 id="20ea" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">入口控制器</h2><p id="dbc2" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">要在K8S中设置Ingress，需要配置一个Ingress控制器。这些不是群集的默认设置，必须安装。入口控制器通常是集群中的反向web代理服务器实现。</p><p id="1aea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有许多可用的入口控制器，它们都有不同的特性。官方文档列出了可用的入口控制器。一些常用的方法包括:</p><ul class=""><li id="46c2" class="na nb it kk b kl km ko kp kr nc kv nd kz ne ld nf ng nh ni bi translated"><a class="ae lu" href="https://docs.microsoft.com/azure/application-gateway/tutorial-ingress-controller-add-on-existing?toc=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&amp;bc=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json" rel="noopener ugc nofollow" target="_blank"> AKS应用网关入口控制器</a>是配置<a class="ae lu" href="https://docs.microsoft.com/azure/application-gateway/overview" rel="noopener ugc nofollow" target="_blank"> Azure应用网关</a>的入口控制器。</li><li id="655b" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated"><a class="ae lu" href="https://github.com/kubernetes/ingress-gce" rel="noopener ugc nofollow" target="_blank">用于谷歌云的GKE入口控制器</a></li><li id="7621" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated"><a class="ae lu" href="https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html" rel="noopener ugc nofollow" target="_blank"> AWS应用负载平衡器入口控制器</a></li><li id="2e85" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated"><a class="ae lu" href="https://haproxy-ingress.github.io/" rel="noopener ugc nofollow" target="_blank"> HAProxy入口</a>是<a class="ae lu" href="https://www.haproxy.org/#desc" rel="noopener ugc nofollow" target="_blank"> HAProxy </a>的入口控制器。</li><li id="ad9c" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated"><a class="ae lu" href="https://istio.io/latest/docs/tasks/traffic-management/ingress/kubernetes-ingress/" rel="noopener ugc nofollow" target="_blank"> Istio入口</a>是基于<a class="ae lu" href="https://istio.io/" rel="noopener ugc nofollow" target="_blank"> Istio </a>的入口控制器。</li><li id="e30a" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">用于Kubernetes 的<a class="ae lu" href="https://www.nginx.com/products/nginx-ingress-controller/" rel="noopener ugc nofollow" target="_blank"> NGINX入口控制器与</a><a class="ae lu" href="https://www.nginx.com/resources/glossary/nginx/" rel="noopener ugc nofollow" target="_blank">NGINX</a>web服务器(作为代理)一起工作。</li><li id="3162" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated"><a class="ae lu" href="https://doc.traefik.io/traefik/providers/kubernetes-ingress/" rel="noopener ugc nofollow" target="_blank"> Traefik Kubernetes入口提供者</a>是<a class="ae lu" href="https://traefik.io/traefik/" rel="noopener ugc nofollow" target="_blank"> Traefik </a>代理的入口控制器。</li></ul><div class="no np gp gr nq nr"><a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">入口控制器</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">为了让入口资源工作，群集必须运行入口控制器。不同于其他类型的…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">kubernetes.io</p></div></div><div class="oa l"><div class="ob l oc od oe oa of lo nr"/></div></div></a></div><p id="bfe3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您愿意，您可以将一个集群中的多个入口控制器映射到多个负载平衡器！</p><p id="047d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Learnk8s有一个奇妙的功能<a class="ae lu" href="https://docs.google.com/spreadsheets/d/191WWNpjJ2za6-nbG4ZoUMXMpUK8KlCIosvQB0f-oq3k/edit#gid=907731238" rel="noopener ugc nofollow" target="_blank">比较所有可用的入口控制器</a>来帮助您做出选择。请注意Azure应用程序网关入口控制器的局限性。目前，NGINX入口控制器似乎是一个更好的选择…</p><h2 id="6f46" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">使用NGINX设置入口</h2><p id="e9e0" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">NGINX是一个广泛使用的入口控制器，我们将通过Azure Kubernetes服务运行如何设置它。我们将建立两个简单的web服务，并使用NGINX入口相应地路由流量。</p><ol class=""><li id="c41d" class="na nb it kk b kl km ko kp kr nc kv nd kz ne ld og ng nh ni bi translated">启动AKS集群并连接到它。为此，浏览Azure门户中的AKS集群资源并单击connect，将显示使用Azure CLI通过您的shell进行连接所需的命令。</li><li id="1987" class="na nb it kk b kl nj ko nk kr nl kv nm kz nn ld og ng nh ni bi translated">安装NGINX入口控制器。它将在<code class="fe oh oi oj ok b">ingress-nginx</code>名称空间中安装控制器，如果该名称空间不存在，则创建该名称空间。</li></ol><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="f4d9" class="lv lw it ok b gy op oq l or os">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.3.0/deploy/static/provider/cloud/deploy.yaml</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ot"><img src="../Images/fedf6438f65300b52083b7350de301aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DPG7lbNyO0rS0EWIVo6hyg.png"/></div></div></figure><p id="addc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:如果您已经安装了Helm，也可以使用它来安装(如果您已经使用前面的命令安装了Helm，则不需要运行它):</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="f9eb" class="lv lw it ok b gy op oq l or os">helm upgrade --install ingress-nginx ingress-nginx --repo https://kubernetes.github.io/ingress-nginx --namespace ingress-nginx --create-namespace</span></pre><p id="8fa6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.检查入口控制器盒是否正在运行:</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="c7dc" class="lv lw it ok b gy op oq l or os">kubectl get pods --namespace ingress-nginx</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ou"><img src="../Images/aa38be8c3da0d6f8a8ad7791498bd764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-DXDRP5hbkMhRrE7tN1uQ.png"/></div></div></figure><p id="3890" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.检查NGINX入口控制器是否分配了公共Ip地址:</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="2eba" class="lv lw it ok b gy op oq l or os">kubectl get service ingress-nginx-controller --namespace=ingress-nginx</span></pre><p id="0933" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意服务类型是负载平衡器:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ov"><img src="../Images/219f46732cc5b3f2ffc337baf657b993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EnJJrfgAf4b3bVRmPTEqxA.png"/></div></div></figure><p id="91aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">浏览这个IP地址会显示NGINX 404页面，这是因为我们还没有为我们的服务设置任何路由规则。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/78f7780860fd2ac7aa0aaf4e99aa93ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*WY4S3qrjDl52FNhOmSFklA.png"/></div></figure><p id="d4b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.我们将设置一个基本的web应用程序来测试我们的新入口控制器。首先，我们需要设置一个DNS记录，指向我们在上一步中发现的外部IP地址。设置完成后，运行以下命令来设置演示(用您的记录替换[DNS_NAME]，例如www.jackwesleyroper.io)。请注意，您必须设置DNS记录，此步骤不适用于IP地址。这个命令来自NGINX文档，我们将在本文后面讨论声明性方法。</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="c4f5" class="lv lw it ok b gy op oq l or os">kubectl create ingress demo --class=nginx --rule [DNS_NAME]/=demo:80</span></pre><p id="7a30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.浏览到网址。你会看到“成功了！”显示，确认入口控制器正确地将流量路由到演示应用。</p><p id="1eea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">7.现在，我们将设置另外两个web应用程序，并使用NGINX在它们之间路由流量。</p><p id="06ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用官方Azure文档中的演示应用程序创建2个YAML文件。</p><p id="16b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mw"> aks-helloworld-one.yaml </em></p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="bd5f" class="lv lw it ok b gy op oq l or os">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: aks-helloworld-one  <br/>spec:<br/>  replicas: 1<br/>  selector:<br/>    matchLabels:<br/>      app: aks-helloworld-one<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: aks-helloworld-one<br/>    spec:<br/>      containers:<br/>      - name: aks-helloworld-one<br/>        image: mcr.microsoft.com/azuredocs/aks-helloworld:v1<br/>        ports:<br/>        - containerPort: 80<br/>        env:<br/>        - name: TITLE<br/>          value: "Welcome to Azure Kubernetes Service (AKS)"<br/>---<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: aks-helloworld-one  <br/>spec:<br/>  type: ClusterIP<br/>  ports:<br/>  - port: 80<br/>  selector:<br/>    app: aks-helloworld-one</span></pre><p id="066d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mw"> aks-helloworld-two.yaml </em></p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="4214" class="lv lw it ok b gy op oq l or os">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: aks-helloworld-two  <br/>spec:<br/>  replicas: 1<br/>  selector:<br/>    matchLabels:<br/>      app: aks-helloworld-two<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: aks-helloworld-two<br/>    spec:<br/>      containers:<br/>      - name: aks-helloworld-two<br/>        image: mcr.microsoft.com/azuredocs/aks-helloworld:v1<br/>        ports:<br/>        - containerPort: 80<br/>        env:<br/>        - name: TITLE<br/>          value: "AKS Ingress Demo"<br/>---<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: aks-helloworld-two  <br/>spec:<br/>  type: ClusterIP<br/>  ports:<br/>  - port: 80<br/>  selector:<br/>    app: aks-helloworld-two</span></pre><p id="4424" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">应用2个配置文件来设置应用程序:</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="fb1d" class="lv lw it ok b gy op oq l or os">kubectl apply -f aks-helloworld-one.yaml --namespace ingress-nginx<br/>kubectl apply -f aks-helloworld-two.yaml --namespace ingress-nginx</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/490425825de05a7a5c60c12a7b4569d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*m57_VwVBcT4EFBPUBxCBKg.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/b47531fd74638e6e15b335ef07bdafc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*CuBg1Pv2jketpNxU1N6s8w.png"/></div></figure><p id="04ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查新的pod是否正在运行(您应该看到2个“aks-hello world”pod正在运行) :</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="d04f" class="lv lw it ok b gy op oq l or os">kubectl get pods --namespace ingress-nginx</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oz"><img src="../Images/a68fcdf091879ee0fa410aa4f3fe4f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vszydtcMjY4Hwumu7MGEHg.png"/></div></div></figure><p id="8348" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">8.设置入口以在两个应用程序之间路由流量。</p><p id="a80e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将设置基于路径的路由，根据用户输入的URL将流量导向适当的web应用。<em class="mw">EXTERNAL _ IP/hello-world-one</em>被路由到名为<code class="fe oh oi oj ok b">aks-helloworld-one</code>的服务。到<em class="mw">EXTERNAL _ IP/hello-world-two</em>的流量被路由到<code class="fe oh oi oj ok b">aks-helloworld-two</code>服务。在用户没有指定路径的情况下(<em class="mw">外部IP/)，流量被路由到<em class="mw"> </em> <code class="fe oh oi oj ok b">aks-helloworld-one.</code></em></p><p id="cf9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建一个名为<em class="mw">hello-world-ingress . YAML</em>的文件</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="1406" class="lv lw it ok b gy op oq l or os">apiVersion: networking.k8s.io/v1<br/>kind: Ingress<br/>metadata:<br/>  name: hello-world-ingress<br/>  annotations:<br/>    nginx.ingress.kubernetes.io/ssl-redirect: "false"<br/>    nginx.ingress.kubernetes.io/use-regex: "true"<br/>    nginx.ingress.kubernetes.io/rewrite-target: /$2<br/>spec:<br/>  ingressClassName: nginx<br/>  rules:<br/>  - http:<br/>      paths:<br/>      - path: /hello-world-one(/|$)(.*)<br/>        pathType: Prefix<br/>        backend:<br/>          service:<br/>            name: aks-helloworld-one<br/>            port:<br/>              number: 80<br/>      - path: /hello-world-two(/|$)(.*)<br/>        pathType: Prefix<br/>        backend:<br/>          service:<br/>            name: aks-helloworld-two<br/>            port:<br/>              number: 80<br/>      - path: /(.*)<br/>        pathType: Prefix<br/>        backend:<br/>          service:<br/>            name: aks-helloworld-one<br/>            port:<br/>              number: 80</span></pre><p id="0204" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建入口</p><pre class="lf lg lh li gt ol ok om on aw oo bi"><span id="131a" class="lv lw it ok b gy op oq l or os">kubectl apply -f hello-world-ingress.yaml --namespace ingress-nginx</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/8614c2c165694f0f8d054d5f01a645d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*-eQPqR5dvEfxk-fXpesTjw.png"/></div></figure><p id="6747" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">9.浏览到<em class="mw">外部IP/hello-world-one: </em></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/849636f26e17dc7fe8feaa29622c514e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*3uYNtBgCggkHmB08W-1STQ.png"/></div></figure><p id="2955" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">和<em class="mw">外部_IP/hello-world-two: </em></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/043d270edae49981489b5aad145a7def.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*Kpno3hZNA-DYUOK9ZFtEPw.png"/></div></figure><h2 id="7544" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">摘要</h2><p id="c7a6" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">K8S中的入口是将K8S集群中的服务暴露给外界的一种健壮的方式。它允许您将路由规则整合到一个位置。有许多可用的入口控制器可供使用，在本文中，我们在AKS上配置了一个NGINX入口，并使用它在2个演示应用程序之间路由流量。</p><p id="8e32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有关Kubernetes Ingress的更多信息，请查看以下链接:</p><div class="no np gp gr nq nr"><a href="https://kubernetes.io/docs/concepts/services-networking/ingress/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">进入</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">特性状态:Kubernetes v1.19 [stable]一个API对象，管理对集群中服务的外部访问…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">kubernetes.io</p></div></div><div class="oa l"><div class="pd l oc od oe oa of lo nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://kubernetes.github.io/ingress-nginx/deploy/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">安装指南— NGINX入口控制器</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">安装NGINX ingress控制器有多种方式:用Helm，用项目库图；与……</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">kubernetes.github.io</p></div></div><div class="oa l"><div class="pe l oc od oe oa of lo nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://docs.microsoft.com/en-us/azure/aks/ingress-basic?tabs=azure-cli#create-an-ingress-controller" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">在Azure Kubernetes服务(AKS)中创建入口控制器— Azure Kubernetes服务</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">入口控制器是一个软件，它提供反向代理、可配置的流量路由和TLS…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">docs.microsoft.com</p></div></div><div class="oa l"><div class="pf l oc od oe oa of lo nr"/></div></div></a></div><p id="d56f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想要更多Kubernetes内容？查看我在K8S上的其他文章！</p><div class="no np gp gr nq nr"><a href="https://jackwesleyroper.medium.com/kubernetes-k8s-related-articles-index-54718769e390" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">Kubernetes (K8S)相关文章索引</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">这是我在博客上发表的所有Kubernetes相关文章的列表！我会随时更新这个页面…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">jackwesleyroper.medium.com</p></div></div><div class="oa l"><div class="pg l oc od oe oa of lo nr"/></div></div></a></div><p id="82f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">干杯！🍻</p><div class="no np gp gr nq nr"><a href="https://www.buymeacoffee.com/jackwesleyroper" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">Jack Roper正在Azure、Azure DevOps、Terraform、Kubernetes和Cloud tech上写博客！</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">希望我的博客能帮到你，你会喜欢它的内容！我真的很喜欢写技术内容和分享…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="oa l"><div class="ph l oc od oe oa of lo nr"/></div></div></a></div><p id="0328" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mw">最初发表于</em><a class="ae lu" href="https://spacelift.io/" rel="noopener ugc nofollow" target="_blank"><em class="mw">space lift . io</em></a><em class="mw">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>5 Muscles You Should Be Working on before Microservices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微保养前你应该锻炼的5块肌肉</h1>
<blockquote>原文：<a href="https://itnext.io/5-muscles-you-should-be-working-on-before-microservices-f7b373f8a3ab?source=collection_archive---------1-----------------------#2021-03-18">https://itnext.io/5-muscles-you-should-be-working-on-before-microservices-f7b373f8a3ab?source=collection_archive---------1-----------------------#2021-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9df03c1540f17953d81a93cabf13c832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*936LSdhRj0WzM8fzKRJjKQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">乔希·卡拉布雷斯在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="babc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，每个人都认为这是一种神奇的模式，可以用一根神奇的棍子解决他们的问题。事实上，除非你知道自己在做什么，否则它可能不适合你。</p><p id="bf89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我不打算详细解释什么是微服务模式。但是，根据<a class="ae kc" href="https://microservices.io" rel="noopener ugc nofollow" target="_blank">微服务. io </a>:</p><blockquote class="lb lc ld"><p id="ba7a" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">它是一种架构风格，将应用程序构建为服务的集合。</p></blockquote><p id="00fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们深入细节。</p><h2 id="6325" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">1 —沟通</h2><p id="4271" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">首先，我认为这方面最重要的主题是人才库成员之间的交流。在最佳情况下，节点之间的连接越少越好。如果每次完成一个动作都需要调用另一个服务；设计可能有问题。</p><p id="4c8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也有几种沟通方式。您可以让消费者(大多数情况下是UI)调用每个服务，您可以让服务直接调用它们自己，或者您可以在它们之间实现一个消息队列。或者你可以把它们结合起来！</p><p id="70ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个问题没有确定的答案，你只需要了解你所处的位置，并尝试选择正确的位置:</p><ul class=""><li id="e52d" class="mg mh iq kf b kg kh kk kl ko mi ks mj kw mk la ml mm mn mo bi translated"><strong class="kf ir">消息队列</strong>异步工作，所以如果您需要在请求时知道结果，这个选项可能对您不好。</li><li id="2501" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated"><strong class="kf ir"> HTTP端点，</strong>则相反，会给你你想要的。但是这带来了另一个成本(额外的域、安全性、TCP开销)</li></ul><p id="d085" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不要忘记；互动少一点好。</p><p id="ca64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在选择沟通方式时，您会意识到还有另一个问题需要回答:</p><h2 id="26e5" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">2 —交易管理</h2><p id="c7a4" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">假设您的微服务应用环境中有A &amp; B服务。如果您选择message queue选项在服务A和服务B之间进行通信，您如何确定服务B完成了由服务A启动的操作？</p><p id="0db3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好吧，你可以再发一条消息给源头，告诉他们任务完成了。然后，可以用WebSocket或push消息通知UI。但是，如果结果是完成操作所必需的，那么消息队列可能并不适合。</p><h2 id="bfc4" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">3 —数据库</h2><p id="17a1" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">数据库是这个系统中最重的一块石头。如果包含数据库操作，就很难进行操作。</p><p id="7de8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在一个数据库上有几个微服务只会增加系统的复杂性。这就像有5个服务员，但只有一个厨师来烹饪所有的订单。</p><p id="e1a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">受源代码控制的数据库是另一个要点。跟踪变更很重要——通过CI/CD管道在数据库中进行更新也很关键。否则，你可能会在发布日有快乐的时刻:)</p><h2 id="6959" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">4—集成测试</h2><p id="3a6b" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">当你一个人的时候，你可以唱得很完美，但是要想在合唱团唱歌，你还需要抓住节奏。因此，您需要作为一个团队开始测试您的服务。</p><p id="1fd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你可能猜到的，这里重要的一点是测试应用程序的连接点。你可以在这里找到马丁·福勒的简短解释<a class="ae kc" href="https://martinfowler.com/articles/microservice-testing/#testing-progress-1" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="dae9" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">5 —诊断</h2><p id="afbc" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">相对来说，检测一个单一应用程序的故障、内存泄漏或性能差距是很容易的。当你向俱乐部介绍新的服务时，你可能无法找到问题的症结所在。</p><p id="e95f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结构化的日志记录机制对于异常非常方便。使用像<a class="ae kc" href="http://www.datadoghq.com" rel="noopener ugc nofollow" target="_blank"> DataDog </a>或<a class="ae kc" href="https://datalust.co/seq" rel="noopener ugc nofollow" target="_blank"> Seq </a>这样的服务或者将你的日志推送到弹性搜索会比你想象的更有用。而且，用关联id标记日志还可以让您轻松地关联日志，而不是检查时间戳。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="fd65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在此列表中添加更多标题，如CI/CD、缓存、安全等。但是我想强调我在开发微服务时最纠结的主题。深入调查一下，决定去还是不去。它可能会让你付出更多。</p></div></div>    
</body>
</html>
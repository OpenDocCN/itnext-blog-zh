<html>
<head>
<title>Postgres and Redis database connection pool size config for Ruby on Rails app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby on Rails应用程序的Postgres和Redis数据库连接池大小配置</h1>
<blockquote>原文：<a href="https://itnext.io/postgres-and-redis-database-connection-pool-size-config-for-ruby-on-rails-app-3725239710fa?source=collection_archive---------7-----------------------#2021-04-26">https://itnext.io/postgres-and-redis-database-connection-pool-size-config-for-ruby-on-rails-app-3725239710fa?source=collection_archive---------7-----------------------#2021-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8f78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于许多程序员来说，为Rails应用程序配置数据库连接池可能不是一项简单的任务。数据库级别有最大打开连接数的限制。您的服务器环境配置可能会随时间变化，并影响到所需的数据库连接数。例如，当您根据web流量自动调整服务器数量时，您使用的服务器数量可能会发生变化。这意味着为Puma或Unicorn服务器运行的web进程/线程的数量可能会改变。所有这些都增加了额外的复杂性。当你使用两个数据库时(例如Postgres + Redis)，一切都变得更加复杂。在本文中，我们将解决这个问题。您将学习如何估计Ruby on Rails生产应用程序所需的数据库连接。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/196392d4311ca9b0d085c631fdeed1e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PHDw21Sj3T5gnAu2.jpeg"/></div></div></figure><h1 id="5184" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为什么可用的数据库连接很重要？</h1><p id="fe60" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">第一个问题是，为什么需要关心可用的数据库连接？答案很简单。假设您将Ruby应用程序配置为打开太多的数据库连接。在这种情况下，当数据库无法处理更多来自Rails应用程序的新连接时，可能会出现来自应用程序的<code class="fe ma mb mc md b">ActiveRecord::ConnectionTimeoutError</code>异常。这可能会导致您的web应用程序用户看到500个错误。</p><p id="b6c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个问题可能不会立即显现出来。通常你会在生产中发现它。您的应用程序可能工作得很好，直到特定的环境导致Rails应用程序需要更多的数据库连接，这可能会触发异常泛滥。我们来看看如何避免。</p><h1 id="bd36" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">RoR应用程序逐步配置</h1><p id="061d" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">让我们将一个典型的Ruby on Rails应用程序分解成使用数据库的更小的组件。</p><ul class=""><li id="e2e3" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">我们有一个Rails应用程序，它使用Postgres数据库来使用ActiveRecord。</li><li id="1338" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">我们也使用Redis数据库为Sidekiq这样的后台工作人员服务。</li></ul><p id="3920" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来很简单，不是吗？让我们从这开始，稍后，我们将增加更多的复杂性:)</p><h1 id="91d5" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Postgres数据库连接—如何检查限制？</h1><p id="c64f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如何检查Postgres有多少可用连接？</p><ul class=""><li id="abba" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">如果您使用安装了Postgres的专用服务器，那么很可能您有一个默认的<code class="fe ma mb mc md b">max_connections</code>,通常是100个连接。</li><li id="36db" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">如果您在AWS上使用Postgres实例，那么您需要查看AWS文档，以了解到您的数据库实例的最大允许连接数是多少(这取决于您是否使用Amazon RDS或Aurora以及什么是服务器实例类)</li><li id="9263" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">如果你使用Heroku，你可以检查<code class="fe ma mb mc md b">Connection Limit</code>的<a class="ae ms" href="https://elements.heroku.com/addons/heroku-postgresql#pricing" rel="noopener ugc nofollow" target="_blank"> Postgres Heroku附加</a>来检查最大可接受的连接。</li></ul><h1 id="9338" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ActiveRecord连接池</h1><p id="1a7b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在您的Rails应用程序中，<code class="fe ma mb mc md b">config/database.yml</code>文件包含了<code class="fe ma mb mc md b">pool</code>选项。如<a class="ae ms" href="https://edgeguides.rubyonrails.org/configuring.html#database-pooling" rel="noopener ugc nofollow" target="_blank"> Rails文档</a>中所述:</p><blockquote class="mt mu mv"><p id="0349" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><em class="iq">活动记录数据库连接由</em> <code class="fe ma mb mc md b"><em class="iq">ActiveRecord::ConnectionAdapters::ConnectionPool</em></code> <em class="iq">管理，确保连接池同步有限数量的数据库连接的线程访问量。</em></p><p id="5417" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><em class="iq">由于缺省情况下连接池是在活动记录中处理的，所以所有应用服务器(瘦、Puma、Unicorn等。)应该表现的一样。数据库连接池最初是空的。随着连接需求的增加，它将创建连接，直到达到连接池的限制。</em></p><p id="9375" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><em class="iq">任何一个请求都会在第一次需要访问数据库时检查一个连接。在请求结束时，它将重新检查连接。这意味着队列中的下一个请求可以再次使用额外的连接槽。</em></p></blockquote><p id="af9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ma mb mc md b">pool</code>可以这样定义:</p><pre class="km kn ko kp gt na md nb nc aw nd bi"><span id="4f7e" class="ne ky iq md b gy nf ng l nh ni">production:<br/>  adapter: postgresql<br/>  database: blog_production<br/>  pool: 5</span></pre><p id="8add" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者作为数据库URL的一部分:</p><pre class="km kn ko kp gt na md nb nc aw nd bi"><span id="2d0f" class="ne ky iq md b gy nf ng l nh ni">development:<br/>  url: postgresql://localhost/blog_production?pool=5</span></pre><p id="10a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您在Amazon RDS这样的外部服务器上托管数据库时，URL选项很受欢迎。那么您可以这样定义URL:</p><pre class="km kn ko kp gt na md nb nc aw nd bi"><span id="548f" class="ne ky iq md b gy nf ng l nh ni">production:<br/>  url: postgres://blog_production:PASSWORD@blog-production.abcdefgh.eu-west-1.rds.amazonaws.com/blog_production?sslca=config/rds-combined-ca-bundle.pem&amp;pool=5</span></pre><p id="68a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，对于生产，您不应该在<code class="fe ma mb mc md b">config/database.yml</code>文件中提交凭证。相反，将它存储在环境变量中，然后在Rails应用程序运行时读取该值。</p><pre class="km kn ko kp gt na md nb nc aw nd bi"><span id="f68e" class="ne ky iq md b gy nf ng l nh ni">production:<br/>  url: &lt;%= ENV['DB_URL'] %&gt;</span></pre><h1 id="801d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ActiveRecord连接池如何影响Postgres max连接数？</h1><p id="395f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">让我们从一个简单的例子开始。您的应用程序可以使用Puma或Unicorn之类的应用服务器。让我们关注Puma，因为它更复杂，因为它为几个进程(Puma术语中称为workers)和线程提供了单独的配置。Unicorn只在单线程中运行。它的工作方式与单线程设置的Puma完全一样。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/34398eed51e2130fae7c152f906f3622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fnGa2sofo0gOSewL.jpeg"/></div></div></figure><h1 id="d2ac" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Puma配置:1个进程和1个线程</h1><p id="2389" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">假设您使用Puma服务器运行Rails应用程序。Puma被配置为运行一个进程(worker ),它只有一个线程。</p><p id="3521" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">puma进程最多可以打开5个到数据库的连接，因为<code class="fe ma mb mc md b">pool</code>选项在<code class="fe ma mb mc md b">config/database.yml</code>中被定义为5。通常情况下，连接会比这个数目少，因为当您运行一个进程和一个线程时，只需要一个到Postgres数据库的连接来进行数据库查询。</p><p id="f5b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有时数据库连接可能会中断。在这种情况下，ActiveRecord可以打开一个新连接，然后您可能会有两个活动连接。在最糟糕的情况下，当4个连接失效时，Rails最多可以打开5个连接。</p><h1 id="17a5" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Puma配置:1个进程和2个线程</h1><p id="da0f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果在一个Puma进程(worker)中使用两个线程，那么这意味着这两个线程可以在Puma进程中使用同一个数据库连接池。</p><p id="aeb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着5个可能的连接中有2 DB将被打开。如果有任何连接失效，那么可以打开更多的连接，直到达到5个连接池的限制。</p><h1 id="b27a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Puma配置:2个进程和每个进程2个线程</h1><p id="fe34" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果您运行2个Puma进程(workers ),并且每个进程有2个线程，那么这意味着每个进程将打开2 DB连接，因为每个进程有2个线程。您有2个进程，因此这意味着在应用程序开始时，可能有4个DB连接打开。每个进程都有自己的池，所以有两个池。每个池最多可以打开5 DB连接。这意味着在最坏的情况下，甚至可以创建10个到数据库的连接。</p><p id="1696" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设每个Puma进程使用2个线程，那么最好将<code class="fe ma mb mc md b">pool</code>选项设置为2 +一些备用连接。它允许ActiveRecord在一个数据库连接失效时打开一个新的连接。</p><h1 id="19c9" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Puma配置:Heroku上有2个进程和2个线程，以及2个web dynos</h1><p id="d884" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果您使用Heroku托管您的应用程序，它允许通过添加更多服务器(dynos)来水平扩展您的web应用程序。假设您在2个服务器(2个Heroku dynos)上运行您的应用程序，每个dyno运行2个Puma进程，每个进程有2个线程。这意味着在开始时，您的应用程序可能会打开6个数据库连接。原因如下:</p><p id="a37d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2个dynos X 2个Puma进程X 2个Puma线程= 6个DB连接</p><p id="9083" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2个dynos X 2个Puma进程X池大小(5) =总池大小20</p><p id="59fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着在最坏的情况下，您的应用程序可能会打开20 DB的连接。</p><h2 id="7baf" class="ne ky iq bd kz nk nl dn ld nm nn dp lh jy no np ll kc nq nr lp kg ns nt lt nu bi translated">自动缩放web应用程序</h2><p id="323f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果您在web流量高峰期通过添加更多服务器来自动扩展web服务器，您需要小心。确保您的应用程序保持在Postgres最大连接数限制内。上面的例子向您展示了如何计算预期的开放数据库连接和最坏的情况。请调整您的池大小，以确保在最坏的情况下，您将低于数据库引擎的最大连接数限制。</p><h1 id="ca24" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">还有什么可以打开DB连接？</h1><p id="bd27" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们刚刚谈到了像Puma这样的web服务器，它可以打开连接并消耗您的最大数据库连接数限制。但是其他非网络流程也可以做到这一点:</p><ul class=""><li id="3579" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">您在Heroku dyno <code class="fe ma mb mc md b">heroku run bin/rails console --app=my-app-name</code>中运行Rails控制台。它运行Rails应用程序的一个实例，1 DB连接将打开。在最坏的情况下，在<code class="fe ma mb mc md b">pool</code>中定义的连接数可以被打开。但是您的数据库连接不太可能会中断。因此不应使用整个池限制。</li><li id="ed90" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">您通过Heroku Scheduler(类似cron的工具)运行预定的rake任务。如果定期执行rake任务，它们需要打开到DB的连接，以便每个rake任务至少使用池中的1 DB连接。假设你有10个每小时开始的rake任务。这意味着每小时需要10个可用的数据库连接。如果你的评估仅仅基于网络连接，很容易忽略这一点。</li><li id="4759" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">您使用Sidekiq这样的后台工作器来执行异步作业。您的作业可能会打开数据库连接。我们以后再谈。</li></ul><h1 id="3331" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">后台工作程序— Sidekiq和ActiveRecord池</h1><p id="1e2f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Sidekiq进程将像Puma一样使用在<code class="fe ma mb mc md b">config/database.yml</code>中定义的池。Sidekiq进程中的所有Sidekiq线程都可以使用一个公共连接池。</p><p id="2fa1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您运行多个服务器(Heroku dynos)，那么它的工作方式类似于Puma示例。</p><p id="4274" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2个服务器(dynos) X 1个Sidekiq进程X 10个Sidekiq线程= 20 DB连接将打开。</p><p id="6d42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe ma mb mc md b">config/database.yml</code>中，您需要至少10个池大小，因为Sidekiq默认使用10个线程。</p><p id="22fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果使用小于10的池大小，那么Sidekiq线程将会争用池中有限的连接。在一段时间内这可能是好的，但是您应该意识到这会增加您的作业的处理时间，因为不是所有的Sidekiq线程都会并行使用DB连接。这也会导致<a class="ae ms" href="https://github.com/mperham/sidekiq/wiki/Problems-and-Troubleshooting#cannot-get-database-connection-within-500-seconds" rel="noopener ugc nofollow" target="_blank">这里描述的一个问题</a>。</p><h1 id="6b6e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Sidekiq和Redis数据库连接</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/e1bd0a8cdcab1214485c24d059208f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Sw9M6azhpA6mznGn.jpeg"/></div></div><figcaption class="nw nx gj gh gi ny nz bd b be z dk translated">雷迪斯</figcaption></figure><p id="65e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Sidekiq使用Redis数据库来存储异步作业。如果您计算到Redis的DB连接以及Postgres连接，那将是最好的。Sidekiq服务器进程至少需要(并发+ 5)个连接。<code class="fe ma mb mc md b">concurrency</code>选项是每个Sidekiq进程的Sidekiq线程数。</p><p id="ff1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用前面的例子:</p><p id="d1ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2台服务器(dynos) X 1个Sidekiq进程X 10个Sidekiq线程= 2台服务器(dynos) X 1个Sidekiq进程X (10 + 5) =需要30个Redis连接。</p><p id="d3e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多信息请见<a class="ae ms" href="https://github.com/mperham/sidekiq/wiki/Using-Redis#complete-control" rel="noopener ugc nofollow" target="_blank"> Sidekiq文档</a>。</p><h1 id="b6a8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Redis数据库连接</h1><p id="8b03" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果您使用Redis来处理后台作业，那么不仅仅是Sidekiq进程在使用Redis连接。Puma进程和线程也可以使用Redis向Sidekiq队列添加新的作业。通常每个Puma线程有一个Redis连接。</p><p id="a3df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您使用<code class="fe ma mb mc md b">Redis.new</code>显式地打开一个新的Redis连接，这也可以为每个Puma线程创建一个新的连接。</p><h1 id="0a3d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">摘要</h1><p id="576a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们讨论了几个Postgres和Redis的例子，计算Rails应用程序所需的数据库连接。我希望这将使您更好地理解如何估计您的数据库级需要多少DB连接来适当地满足您的应用程序的需求。</p><p id="ff81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想改进你的Rails应用程序工作流程，请考虑检查如何在你的CI服务器上用<a class="ae ms" href="https://knapsackpro.com/?utm_source=medium&amp;utm_medium=blog_post&amp;utm_campaign=medium-estimate-database-connections-pool-size-for-rails-application" rel="noopener ugc nofollow" target="_blank">背包Pro </a>并行运行<a class="ae ms" href="https://docs.knapsackpro.com/2020/how-to-speed-up-ruby-and-javascript-tests-with-ci-parallelisation" rel="noopener ugc nofollow" target="_blank">自动化测试。</a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/c3714556e8ce3f65da78bd4da43a0338.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/format:webp/0*2mmnaQj-cChMjlw0.png"/></div></figure></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="5ff6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mw">原载于2021年4月26日https://docs.knapsackpro.com</em><a class="ae ms" href="https://docs.knapsackpro.com/2021/estimate-database-connections-pool-size-for-rails-application" rel="noopener ugc nofollow" target="_blank"><em class="mw"/></a><em class="mw">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>TMTOWTGI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TMTOWTGI</h1>
<blockquote>原文：<a href="https://itnext.io/tmtowtgi-94e343bf669d?source=collection_archive---------6-----------------------#2018-02-22">https://itnext.io/tmtowtgi-94e343bf669d?source=collection_archive---------6-----------------------#2018-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/d297462bff405d04e890ec6dc37d8244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-12lwBRDLG9AOAihS6CExQ.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">由<a class="ae jd" href="https://unsplash.com/photos/8S96OpxSlvg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克里斯蒂安·斯塔尔</a>在<a class="ae jd" href="https://unsplash.com/search/photos/different?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><div class=""/><p id="58bb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Perl普及了这个概念<em class="lb">有不止一种方法可以做到这一点</em>(这取决于你问谁，要么很棒，要么只是令人困惑)。JavaScript同样擅长给初学程序员两种方法去做几乎任何事情。<a class="ae jd" href="http://deadlysyn.com/blog//development/2018/02/11/idea-to-app-part-3" rel="noopener ugc nofollow" target="_blank">在之前的一篇文章</a>中，我们简要评估了如何为查询一个API实现简单的HTTP GETs作为对所有Perl僧侣的敬意，让我们探索一下如何有不止一种方法来获得它(或者post、PUT…无论什么)。</p><p id="49b5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:我倾向于不在JavaScript中使用分号…这并不是想要冒犯或参与任何圣战。在你认为合适的地方随意想象分号，或者更好的是<a class="ae jd" href="https://youtu.be/Qlr-FGbhKaI" rel="noopener ugc nofollow" target="_blank">观看这个既有趣又有启发性的独白</a>。</p><p id="715f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">'注意':请带着幽默感阅读这篇文章或我创作的任何东西。:-)</p><h1 id="c3b6" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">语境</h1><p id="cc41" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">作为一个方便的用例，我们将构建一个极简的比特币价格检查器，因为，好吧，每个人都在做比特币的事情，同行的压力是真实的。我们将使用Coindesk API。</p><p id="4b8c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了简洁起见，我不会在所有示例中重复这一点，但我们在JavaScript的顶部声明了一些重要的常数，它们指向我们将使用当前比特币价格更新的API端点和元素:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">“const”确保全局值不会被覆盖。</figcaption></figure><p id="ee47" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于下面的例子，也使用了普通的HTML样板文件…下面是它的样子，这样JavaScript更有意义:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">这里没什么可看的…</figcaption></figure><p id="fd92" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，就是它…相当可怕，但用户界面不是重点，我们不想让它分心。事实上，这应该更简单——我开始陷入对HTML和CSS无休止调整的黑洞。:-)您需要注意的是，我们设置了一些独特的元素<code class="fe ml mm mn mo b">id</code>以使我们的选择器查询更容易，并导入我们稍后将使用的jQuery和Axios。</p><p id="662a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">… <a class="ae jd" href="https://github.com/deadlysyn/bitcoinGetter" rel="noopener ugc nofollow" target="_blank">或者直接用出处，Luke </a>(或者Lukette，或者随便你的名字，发色，原籍国，人称代词等等。恰好是——source对我们所有人都同样好)。</p><h1 id="a2e1" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">XHR</h1><p id="5c4f" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">首先，让我们回到过去……AJAX(异步JavaScript和XML)刚刚出现的时候。显然，它仍然是新的，因为今天它将被称为AJAJ(现在什么不喷JSON？).那时还没有<em class="lb">单页面应用</em>和其他现在普遍接受的热门应用，所以异步HTTP请求的能力显然让人们非常兴奋。</p><p id="4bf0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">严格来说，<em class="lb"> X </em>不仅仅是<em class="lb">代表XML，更确切地说是<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest?redirectlocale=en-US&amp;redirectslug=DOM%2FXMLHttpRequest" rel="noopener ugc nofollow" target="_blank"> XMLHttpRequest </a>。今天，这个内置对象仍被用于在JavaScript中发出HTTP请求。幸运的是，现代实现使用JSON，因为它在JavaScript生态系统中更有意义。我相信你已经注意到，<em class="lb"> XMLHttpRequest </em>如果我们将其缩写为<em class="lb"> XHR </em>会更好用，所以这是通常的做法(谁不喜欢缩写词)。</em></p><p id="2d65" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你说这是很好的琐事素材，但是它是如何工作的呢？给你:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">使用XHR发出HTTP GET请求。</figcaption></figure><p id="0186" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这没什么好奇怪的，假设你至少明白一些事情:</p><ul class=""><li id="79a5" class="mp mq jg kf b kg kh kk kl ko mr ks ms kw mt la mu mv mw mx bi translated">在做任何有用的事情之前，我们需要<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects" rel="noopener ugc nofollow" target="_blank">实例化</a>一个新的XHR对象(因此使用了<code class="fe ml mm mn mo b">new</code>)。</li><li id="d3a3" class="mp mq jg kf b kg my kk mz ko na ks nb kw nc la mu mv mw mx bi translated"><code class="fe ml mm mn mo b">onreadystatechange</code> ( <em class="lb"> love </em>那个名字)是一个事件处理程序，每当我们的新XHR的<code class="fe ml mm mn mo b">readyState</code>属性发生变化时就会调用它。</li><li id="f34c" class="mp mq jg kf b kg my kk mz ko na ks nb kw nc la mu mv mw mx bi translated"><code class="fe ml mm mn mo b">readyState</code>有<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState" rel="noopener ugc nofollow" target="_blank">五种可能的状态</a> (0-4)，其中<code class="fe ml mm mn mo b">4</code>表示请求完成。</li></ul><p id="3b9f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你发现<code class="fe ml mm mn mo b">open</code>和<code class="fe ml mm mn mo b">send</code>令人困惑，<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest?redirectlocale=en-US&amp;redirectslug=DOM%2FXMLHttpRequest" rel="noopener ugc nofollow" target="_blank">文档帮助</a>…但是只要把<code class="fe ml mm mn mo b">open</code>想象成<em class="lb">建立请求</em>，并且<code class="fe ml mm mn mo b">send</code>，嗯，<em class="lb">发送请求</em>。一旦发送，状态变化将传播，假设它完成(我们得到一个<code class="fe ml mm mn mo b">200 OK</code> ) <code class="fe ml mm mn mo b">PRICE.textContent</code>被更新。</p><p id="da55" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为什么要从xhr开始？它们是下面所有事物建立的基础元素！</p><h1 id="8e3f" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">取得</h1><p id="6f2a" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">另一种本地方式(除了我们过去讨论过的<code class="fe ml mm mn mo b">https.get</code>之外)是<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank">获取</a>。这是这种语言的一个新的补充，从它对承诺的使用可以看出。呜啊啊承诺，你说！在我们了解一个不幸的秘密之前，让我们先看看它的运行情况(如果<em class="lb">秘密</em>是文档中描述的<em class="lb">行为的另一个名称):</em></p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">使用Fetch发出HTTP GET请求。</figcaption></figure><p id="3102" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很整洁，是吧？这里要注意的主要事情是使用<code class="fe ml mm mn mo b">.then</code>和<code class="fe ml mm mn mo b">.catch</code>来处理承诺，以及内置的<code class="fe ml mm mn mo b">.json()</code>方法，它取代了我们上面使用的<code class="fe ml mm mn mo b">JSON.parse()</code>。不错，干净，现代…但是还没有很好的支持。<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank">获取API文档</a>显示IE在这一点上完全被冷落，这对你来说可能是一个阻碍。</p><h1 id="e175" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">jQuery</h1><p id="2052" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">优秀的老jQuery。如果说我们当中还有比这更同时受到尊敬和批评的人，那我还没见过……至少从上次关于vim vs emacs的对话之后没有。虽然，从技术上来说，我想这是一个关于两个同样受辱的工作狂的对话(取决于你和谁说话)。我跑题了。</p><p id="d454" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然没有以前那么流行，但是jQuery仍然是全功能的，在某些情况下非常有用，考虑到过去的流行程度，您可能需要支持它，而不管个人意见如何。郑重声明，我并不反对——只是要确保在引入一个大的依赖项之前，您需要做的不仅仅是发出一个HTTP请求！</p><p id="2d53" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">好的ol' jQuery使HTTP请求变得容易。</figcaption></figure><p id="7435" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ml mm mn mo b">querySelector</code>不见了，或者更准确地说……它被伪装成了<code class="fe ml mm mn mo b">$</code>。不同的语法，但是我们仍然将一个<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions" rel="noopener ugc nofollow" target="_blank">匿名函数</a>绑定到一个点击监听器。在内部，我们使用<a class="ae jd" href="https://api.jquery.com/jQuery.getJSON" rel="noopener ugc nofollow" target="_blank"> jQuery的</a> <code class="fe ml mm mn mo b"><a class="ae jd" href="https://api.jquery.com/jQuery.getJSON" rel="noopener ugc nofollow" target="_blank">getJSON</a></code> <a class="ae jd" href="https://api.jquery.com/jQuery.getJSON" rel="noopener ugc nofollow" target="_blank">方法</a>将HTTP响应转换成有用的对象。这是jQuery的两大优势——不缺少文档或实用方法！</p><h1 id="b65e" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Axios</h1><p id="eea6" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">最后，但同样重要的是，<a class="ae jd" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> Axios </a>是一个非常受欢迎的HTTP客户端库(也就是说，在撰写本文时，GitHub上有近4万个stars)。它是基于承诺的，轻量级的，并且得到了很好的支持。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Axios非常受欢迎是有原因的！</figcaption></figure><p id="66ab" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">承诺处理看起来与前面的例子相似，但是没有任何对JSON相关方法的引用……因为库自动完成了转换。相当甜蜜！Axios也是高度可配置的，并且支持实际上很容易理解的并发性:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Axios让并发变得简单。</figcaption></figure><h1 id="5eca" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">摘要</h1><p id="eaa3" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">所以，现在你有了…比任何人用JavaScript发出HTTP请求都多的方法。不用说，上面的例子都是客户端的，但是也可以在<a class="ae jd" href="https://nodejs.org" rel="noopener ugc nofollow" target="_blank"> Node.js </a>中轻松完成。对于需要导入的，只需将<code class="fe ml mm mn mo b">&lt;script&gt;&lt;/script&gt;</code>标签替换为<code class="fe ml mm mn mo b">npm install axios</code>或类似标签即可。</p><p id="6663" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后但同样重要的是，我想对Udemy的高级Web开发人员训练营大声疾呼。这里的用例与例子是从那里获得的东西的融合。如果你正在寻找一个关于现代web开发的好的概述，这是一个很棒的课程——我与Udemy或课程作者没有任何关系……所以希望这能有所帮助。:-)</p><p id="3982" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读！</p><p id="e16d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">PS:我的例子使用USD只是因为它是我的本地货币，并保持代码有点干净…在撰写本文时，<a class="ae jd" href="https://www.coindesk.com/api" rel="noopener ugc nofollow" target="_blank"> Coindesk API </a>可以返回EUR、GBP和USD。作为一个有趣的练习，<a class="ae jd" href="https://github.com/deadlysyn/bitcoinGetter" rel="noopener ugc nofollow" target="_blank">克隆回购</a>并重构以支持您喜欢的，或者让用户选择所需的货币！</p><p id="8469" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae jd" href="http://deadlysyn.com/blog//development/2018/02/21/TMTOWTGI" rel="noopener ugc nofollow" target="_blank">最初发布于此处</a> …</p></div></div>    
</body>
</html>
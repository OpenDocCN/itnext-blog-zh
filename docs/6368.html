<html>
<head>
<title>Kubernetes KIND Cheat Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes种类备忘单</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-kind-cheat-shee-2605da77984?source=collection_archive---------0-----------------------#2021-10-29">https://itnext.io/kubernetes-kind-cheat-shee-2605da77984?source=collection_archive---------0-----------------------#2021-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ee10687986e14aa23cba1d059cbb08a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDiLy3VezAqPZMYbbvODpA.jpeg"/></div></div></figure><blockquote class="jy jz ka"><p id="8b43" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae la" href="https://sigs.k8s.io/kind" rel="noopener ugc nofollow" target="_blank"> kind </a>是一个使用Docker容器“节点”运行本地Kubernetes集群的工具。<br/> kind主要是为测试Kubernetes本身而设计的，但也可能用于本地开发或CI。</p></blockquote><h1 id="68f2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">自动完成</h1><h2 id="27d1" class="lz lc iq bd ld ma mb dn lh mc md dp ll me mf mg lp mh mi mj lt mk ml mm lx mn bi translated">尝试</h2><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="f7a2" class="lz lc iq mt b gy mx my l mz na"># Setup the current shell<br/>source &lt;(kind completion bash)</span><span id="9ac0" class="lz lc iq mt b gy nb my l mz na">########<br/>## OR ##<br/>########</span><span id="c2ec" class="lz lc iq mt b gy nb my l mz na"># Update permanently<br/>echo “source &lt;(kind completion bash) &gt;&gt; ~/.bashrc”</span></pre><h2 id="58db" class="lz lc iq bd ld ma mb dn lh mc md dp ll me mf mg lp mh mi mj lt mk ml mm lx mn bi translated">ZSH</h2><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="58a0" class="lz lc iq mt b gy mx my l mz na">source &lt;(kind completion zsh)</span></pre><h1 id="7fd6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基础</h1><p id="e43a" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km me ne kp kq mh nf kt ku mk ng kx ky kz ij bi translated">创建一个名为cncf-cheat-sheet的集群</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3c1a" class="lz lc iq mt b gy mx my l mz na">kind create cluster — name cncf-cheat-sheet</span></pre><p id="66e3" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">创建集群，并等待所有组件准备就绪</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="e149" class="lz lc iq mt b gy mx my l mz na">kind create cluster — wait 2m</span></pre><p id="9cdd" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">获取正在运行的集群</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="134a" class="lz lc iq mt b gy mx my l mz na">kind get clusters</span></pre><p id="7c9f" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">删除名为cncf-备忘单的分类</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="8120" class="lz lc iq mt b gy mx my l mz na">kind delete cluster — name cncf-cheat-sheet</span></pre><h1 id="755a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">高级配置</h1><p id="9f7e" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km me ne kp kq mh nf kt ku mk ng kx ky kz ij bi translated">对于更高级的用例，使用kind.yaml配置文件</p><h2 id="0ec7" class="lz lc iq bd ld ma mb dn lh mc md dp ll me mf mg lp mh mi mj lt mk ml mm lx mn bi translated">港口</h2><p id="fca9" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km me ne kp kq mh nf kt ku mk ng kx ky kz ij bi translated"><a class="ae la" href="https://kind.sigs.k8s.io/docs/user/configuration/#extra-port-mappings" rel="noopener ugc nofollow" target="_blank">Info</a>T5】将80端口从集群控制平面映射到主机。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="9d3b" class="lz lc iq mt b gy mx my l mz na">cat &lt;&lt;EOF | kind create cluster — name cncf-cheat-sheet — config -<br/>kind: Cluster<br/>apiVersion: kind.x-k8s.io/v1alpha4<br/>nodes:<br/>- role: control-plane<br/> extraPortMappings:<br/> — containerPort: 80<br/> hostPort: 80<br/> protocol: TCP<br/>EOF</span></pre><h2 id="43ee" class="lz lc iq bd ld ma mb dn lh mc md dp ll me mf mg lp mh mi mj lt mk ml mm lx mn bi translated">挂载目录</h2><p id="d932" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km me ne kp kq mh nf kt ku mk ng kx ky kz ij bi translated"><a class="ae la" href="https://kind.sigs.k8s.io/docs/user/configuration/#extra-mounts" rel="noopener ugc nofollow" target="_blank"> Info </a> <br/>将当前目录挂载到位于`/app `的集群控制平面</p><p id="8812" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated"><em class="kd">注意:MacOS用户:确保在docker-for-mac偏好设置中共享资源</em></p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="a6ca" class="lz lc iq mt b gy mx my l mz na">cat &lt;&lt;EOF | kind create cluster — name cncf-cheat-sheet — config -<br/>kind: Cluster<br/>apiVersion: kind.x-k8s.io/v1alpha4<br/>nodes:<br/>- role: control-plane<br/> extraMounts:<br/> — hostPath: .<br/> containerPath: /app<br/>EOF</span></pre><h2 id="01ec" class="lz lc iq bd ld ma mb dn lh mc md dp ll me mf mg lp mh mi mj lt mk ml mm lx mn bi translated">添加本地注册表</h2><p id="9f6f" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km me ne kp kq mh nf kt ku mk ng kx ky kz ij bi translated"><a class="ae la" href="https://kind.sigs.k8s.io/docs/user/local-registry/" rel="noopener ugc nofollow" target="_blank">信息</a></p><p id="1e44" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">步骤1:创建本地注册表</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="e23d" class="lz lc iq mt b gy mx my l mz na">docker run -d — restart=always -p 127.0.0.1:5000:5000 — name cncf-cheat-sheet-registry registry:2</span></pre><p id="aceb" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">步骤2:创建集群</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="bb83" class="lz lc iq mt b gy mx my l mz na">cat &lt;&lt;EOF | kind create cluster — name cncf-cheat-sheet — config -<br/>kind: Cluster<br/>apiVersion: kind.x-k8s.io/v1alpha4<br/>containerdConfigPatches:<br/>- |-<br/> [plugins.”io.containerd.grpc.v1.cri”.registry.mirrors.”localhost:5000"]<br/> endpoint = [“<a class="ae la" href="http://cncf-cheat-sheet-registry:5000" rel="noopener ugc nofollow" target="_blank">http://cncf-cheat-sheet-registry:5000</a>"]<br/>nodes:<br/>- role: control-plane<br/>EOF</span></pre><p id="9078" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">步骤3:用创建的网络连接注册表</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="744f" class="lz lc iq mt b gy mx my l mz na">docker network connect kind cncf-cheat-sheet-registry</span></pre><p id="c6fc" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km me ko kp kq mh ks kt ku mk kw kx ky kz ij bi translated">步骤4:更新关于新注册表的集群</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="d8c0" class="lz lc iq mt b gy mx my l mz na">cat &lt;&lt;EOF | kubectl apply -f -<br/>apiVersion: v1<br/>kind: ConfigMap<br/>metadata:<br/> name: local-registry-hosting<br/> namespace: kube-public<br/>data:<br/> localRegistryHosting.v1: |<br/> host: “localhost:5000”<br/>EOF</span></pre><h2 id="41ed" class="lz lc iq bd ld ma mb dn lh mc md dp ll me mf mg lp mh mi mj lt mk ml mm lx mn bi translated">多个工人</h2><p id="0b84" class="pw-post-body-paragraph kb kc iq ke b kf nc kh ki kj nd kl km me ne kp kq mh nf kt ku mk ng kx ky kz ij bi translated"><a class="ae la" href="https://kind.sigs.k8s.io/docs/user/configuration/#nodes" rel="noopener ugc nofollow" target="_blank">信息</a> <br/>默认配置将创建具有一个节点(控制平面)的集群。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="fb2b" class="lz lc iq mt b gy mx my l mz na">cat &lt;&lt;EOF | kind create cluster — name cncf-cheat-sheet — config -<br/>kind: Cluster<br/>apiVersion: kind.x-k8s.io/v1alpha4<br/>nodes:<br/>- role: control-plane<br/>- role: worker<br/>EOF</span></pre></div></div>    
</body>
</html>
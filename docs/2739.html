<html>
<head>
<title>Dockerize a Typescript App in 15 mins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在15分钟内完成一个打字稿应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/dockerize-a-typescript-app-in-15-mins-a0e8c1e904b3?source=collection_archive---------0-----------------------#2019-07-25">https://itnext.io/dockerize-a-typescript-app-in-15-mins-a0e8c1e904b3?source=collection_archive---------0-----------------------#2019-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/507b50f5df4d0ed3d04750e04778f65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-ft6UDeFE2OSwJes_TUlg.jpeg"/></div></div></figure><h1 id="34e4" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="ebee" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们将下载一个简单的TypeScript Hacker新示例应用程序，并对其进行dockerize。我们还将介绍如何:</p><ul class=""><li id="d8c5" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">写入<code class="fe mf mg mh mi b">Dockerfile</code>和<code class="fe mf mg mh mi b">docker-compose.yaml</code></li><li id="871a" class="lu lv iq ky b kz mj ld mk lh ml ll mm lp mn lt mb mc md me bi translated">使用docker-compose运行NodeJs应用程序</li><li id="b0c2" class="lu lv iq ky b kz mj ld mk lh ml ll mm lp mn lt mb mc md me bi translated">建立码头工人形象</li><li id="d9f4" class="lu lv iq ky b kz mj ld mk lh ml ll mm lp mn lt mb mc md me bi translated">使用<code class="fe mf mg mh mi b">docker run</code>运行NodeJs应用程序</li></ul><h1 id="06ad" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第一部分:启动一个简单的NodeJs应用程序</h1><h2 id="eab3" class="mo jz iq bd ka mp mq dn ke mr ms dp ki lh mt mu km ll mv mw kq lp mx my ku mz bi translated">克隆源代码</h2><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="abd1" class="mo jz iq mi b gy ni nj l nk nl">git clone <a class="ae nm" href="https://github.com/alickmail/hackernews-async-ts-docker.git" rel="noopener ugc nofollow" target="_blank">https://github.com/alickmail/hackernews-async-ts-docker</a></span></pre><p id="2d84" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">原始源代码来自EggJs官方回购:</p><div class="nq nr gp gr ns nt"><a href="https://github.com/eggjs/examples" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">鸡蛋/例子</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">将所有egg示例存储在一个地方。在GitHub上创建一个帐户，为eggjs/examples开发做贡献。</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">github.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh jw nt"/></div></div></a></div><h2 id="c566" class="mo jz iq bd ka mp mq dn ke mr ms dp ki lh mt mu km ll mv mw kq lp mx my ku mz bi translated">安装软件包，构建typescript，启动服务器</h2><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="9f15" class="mo jz iq mi b gy ni nj l nk nl">// Install all packages<br/>npm install<br/>// Compile all typescript to javascript<br/>npm tsc<br/>// Start the server<br/>npm start</span></pre><h2 id="6324" class="mo jz iq bd ka mp mq dn ke mr ms dp ki lh mt mu km ll mv mw kq lp mx my ku mz bi translated"><strong class="ak">访问服务器</strong></h2><p id="871f" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">您应该能够在控制台中看到这一点:</p><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="9d26" class="mo jz iq mi b gy ni nj l nk nl">hackernewsapp_1  | 2019-07-14 08:45:13,783 INFO 47 [egg-watcher:application] watcher start success<br/>hackernewsapp_1  | 2019-07-14 08:45:13,783 INFO 47 [egg:core:ready_stat] end ready task /usr/src/app/node_modules/egg-watcher/lib/init.js:15:14, remain []<br/>hackernewsapp_1  | 2019-07-14 08:45:13,804 INFO 29 [master] app_worker#1:47 started at 7001, remain 0 (1567ms)<br/>hackernewsapp_1  | 2019-07-14 08:45:13,806 INFO 29 [master] egg started on &lt;http://127.0.0.1:7001&gt; (2464ms)</span></pre><p id="04f2" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">您可以在浏览器<code class="fe mf mg mh mi b">http://127.0.0.1:7001</code>中访问该网址</p><p id="8952" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">服务成功启动！</p><h1 id="9aa7" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第二部分:将应用程序文档化</h1><p id="1cf3" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">将这两个文件添加到项目的根目录中</p><p id="8f5e" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">// <code class="fe mf mg mh mi b">Dockerfile</code></p><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="2d4e" class="mo jz iq mi b gy ni nj l nk nl">FROM node:10.13.0-alpine</span><span id="ce45" class="mo jz iq mi b gy oi nj l nk nl"># Env<br/>ENV TIME_ZONE=Asia/Hong_Kong<br/>ENV ENV_NAME dev<br/>ENV EGG_SERVER_ENV dev<br/>ENV NODE_ENV dev<br/>ENV NODE_CONFIG_ENV dev</span><span id="fbaf" class="mo jz iq mi b gy oi nj l nk nl"># Set the timezone in docker<br/>RUN apk --update add tzdata \\<br/>   &amp;&amp; cp /usr/share/zoneinfo/Asia/Hong_Kong /etc/localtime \\<br/>   &amp;&amp; echo "Asia/Hong_Kong" &gt; /etc/timezone \\<br/>   &amp;&amp; apk del tzdata</span><span id="6938" class="mo jz iq mi b gy oi nj l nk nl"># Create Directory for the Container<br/>WORKDIR /usr/src/app</span><span id="971b" class="mo jz iq mi b gy oi nj l nk nl"># Only copy the package.json file to work directory<br/>COPY package.json .<br/># Install all Packages<br/>RUN npm install</span><span id="0d0f" class="mo jz iq mi b gy oi nj l nk nl"># Copy all other source code to work directory<br/>ADD . /usr/src/app<br/># TypeScript<br/>RUN npm run tsc</span><span id="abfe" class="mo jz iq mi b gy oi nj l nk nl"># Start<br/>CMD [ "npm", "start" ]<br/>EXPOSE 7001</span></pre><p id="8e71" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">// <code class="fe mf mg mh mi b">docker-compose.yaml</code></p><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="714d" class="mo jz iq mi b gy ni nj l nk nl">version: "3"<br/>networks:<br/>  api_server_default:<br/>    external: true</span><span id="8b31" class="mo jz iq mi b gy oi nj l nk nl">services:<br/>  hackernewsapp:<br/>    networks:<br/>      - api_server_default<br/>    build:<br/>      context: .<br/>      dockerfile: Dockerfile<br/>    environment:<br/>      ENV_NAME: dev<br/>    ports:<br/>      - 7001:7001</span></pre><p id="6ec9" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">我们现在可以使用<strong class="ky ir"> docker composer </strong>或<strong class="ky ir"> docker images </strong>来启动应用程序:</p><h1 id="7d68" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">使用docker composer启动应用程序:</h1><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="db50" class="mo jz iq mi b gy ni nj l nk nl">docker-compose up --build</span></pre><p id="8f52" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">您现在可以在浏览器<code class="fe mf mg mh mi b">http://127.0.0.1:7001</code>中访问该网址。</p><h1 id="79c2" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">使用docker图像启动应用程序:</h1><pre class="na nb nc nd gt ne mi nf ng aw nh bi"><span id="738e" class="mo jz iq mi b gy ni nj l nk nl">docker build -t asia.gcr.io/web-campaign/api-server:0.2 .<br/>docker run asia.gcr.io/web-campaign/api-server:0.2</span></pre><p id="d42b" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh nn lj lk ll no ln lo lp np lr ls lt ij bi translated">您现在可以在浏览器<code class="fe mf mg mh mi b">http://127.0.0.1:7001 </code>中访问该url。</p><h1 id="b78d" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">下一步是什么</h1><p id="ec87" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们将在下一篇文章中讨论如何自动构建docker图像。</p></div></div>    
</body>
</html>
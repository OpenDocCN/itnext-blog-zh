<html>
<head>
<title>Ship your Spring Boot application on Kubernetes in 10 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在10分钟内在Kubernetes上发送您的Spring Boot应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/ship-your-spring-boot-application-on-kubernetes-in-10-minutes-6873fddc388b?source=collection_archive---------7-----------------------#2018-06-23">https://itnext.io/ship-your-spring-boot-application-on-kubernetes-in-10-minutes-6873fddc388b?source=collection_archive---------7-----------------------#2018-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1fd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常容易，非常舒适，高度可靠和公平足够直观…我将解释我如何运送一个多微服务项目开发的Spring Boot谷歌Kubernetes引擎(GKE)。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="f5d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kubernetes(K8s)是一个突破性的平台，得到了很好的宣传。我不会解释K8s背后的架构，但我可以说的基本事情是:谷歌Kubernetes引擎(GKE)使得在K8s架构上部署和展示应用程序变得容易。</p><p id="3a72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的应用程序由5个不同的微服务组成(我知道这不是一个大的架构，但相信我，我看过许多来自Google工程师的演示，他们在一个项目中部署了数百甚至数千个微服务)。每个微服务实际上是同一个项目下的一个模块。让我向你展示在IntelliJ Idea上看到的结构:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/1eadc8268cc9d1a831a4de1b8263f434.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*holBAjNudEbFzRTxGZSS1Q.png"/></div></figure><p id="16a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">故事从容器化那些Spring Boot应用开始。正确的关键词是:com . Spotify . docker file-maven-plugin</p><p id="45db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将这个插件导入到pom.xml中，并在每个模块的根目录中放置一个Dockerfile，它将驱动容器化过程。</p><pre class="kt ku kv kw gt la lb lc ld aw le bi"><span id="4a89" class="lf lg iq lb b gy lh li l lj lk">FROM openjdk:8-jdk-alpine<br/>VOLUME /tmp<br/>ARG JAR_FILE<br/>ADD $JAR_FILE target/app.jar<br/>ENTRYPOINT ["java","-agentlib:jdwp=transport=dt_socket,address=5005,server=y,suspend=n","-Djava.security.egd=file:/dev/./urandom","-Xms2g","-Xmx8g","-jar","target/app.jar"]</span></pre><p id="cb6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上docker文件是一个足够合理的指令，可以拥有一个产品级的容器映像。我们用GIT平台给定的提交ID来标记docker图像，这一点我将在接下来的故事中解释。</p><p id="cfbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们依赖的下一个有用的平台是Jenkins。通过使用Jenkins，我们在主分支上提取每一个提交，构建一个标记有提交ID的docker映像，将该映像推送到Google容器注册表(将此视为一个免费的dockerhub ),然后部署在GKE上。就是这样！下面是Jenkins在local上执行的几行shell命令。</p><pre class="kt ku kv kw gt la lb lc ld aw le bi"><span id="1ac7" class="lf lg iq lb b gy lh li l lj lk">./mvnw install dockerfile:build -Drevision=${SCRUMID} -Dgit-revision=$GIT_COMMIT<br/>docker push gcr.io/MYGOOGLECLOUDPROJECT/messenger:${SCRUMID}.$GIT_COMMIT<br/>kubectl set image deployment/messenger-app messenger-app=gcr.io/MYGOOGLECLOUDPROJECT/messenger:${SCRUMID}.$GIT_COMMIT</span></pre><p id="9640" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是什么让上面那些shell命令？让我们一个一个地考虑</p><p id="74ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一行执行一个maven命令，用scrumId.gitCommitId标记构建一个docker映像。</p><p id="5ed7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二行将所谓的图像推送到Google容器注册表。</p><p id="e503" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三行是一个简单的kubectl命令，它更新所有运行我们的messenger应用程序部署的pod。</p><p id="a06d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这么简单！这么简单。</p><p id="f62d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另外，考虑使用Jenkins box来运行docker命令和kubectl命令，并为您的Google云项目MYGOOGLECLOUDPROJECT进行连接和配置</p></div></div>    
</body>
</html>
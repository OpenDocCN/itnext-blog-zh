<html>
<head>
<title>Containerd on a more secure MicroK8s</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更安全的MicroK8s上的容器</h1>
<blockquote>原文：<a href="https://itnext.io/containerd-on-a-more-secure-microk8s-c2c97ac0268f?source=collection_archive---------7-----------------------#2019-02-18">https://itnext.io/containerd-on-a-more-secure-microk8s-c2c97ac0268f?source=collection_archive---------7-----------------------#2019-02-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f98d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经安静了几个月，只是因为我们一直很忙。我们主要致力于我们打算在<em class="kl">1.14版本</em>中发布的两个特性:</p><ul class=""><li id="7410" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">提高安全性</li><li id="e5c2" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">过渡到<a class="ae la" href="https://containerd.io/" rel="noopener ugc nofollow" target="_blank">集装箱d </a></li></ul><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/61d4f80b568deda31d62dc977f5e0cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*A_jfxX0FO_hTu3QY0MFXfg.png"/></div></figure><p id="1c88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">必然的变化将影响MicroK8s的向后兼容性和用户体验，这也是我们将它们与即将到来的上游Kubernetes版本同步的原因。在这里，我们将提供a)这些功能的简短描述，b)您测试新MicroK8s的方法，以及c)如果这是您的主要障碍，如何阻止发布的步骤。</p><h2 id="797a" class="lj lk iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">向容器的过渡</h2><p id="e9e0" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我们用Containerd替换Dockerd主要有两个原因。</p><ul class=""><li id="e26b" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">在同一台主机上设置两个dockerd已被证明是有问题的。MicroK8s带来了自己的docker，这可能会与用户可能希望拥有的本地docker发生冲突。通过迁移到containerd，用户可以<code class="fe mh mi mj mk b">apt-get install docker.io</code>而不影响MicroK8s。这个切换也意味着<code class="fe mh mi mj mk b">microk8s.docker</code>将不再可用，你将不得不使用发行版附带的docker客户端。</li><li id="2901" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">性能。这表明使用containerd会带来性能上的好处。这并不奇怪，因为dockerd本身在内部使用containerd。通过切换到containerd，我们实际上删除了一个docker特有的层。</li></ul><h2 id="eca0" class="lj lk iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">强化MicroK8s安全性</h2><p id="2be2" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">MicroK8s是开发者的工具。它并不意味着要部署在生产或敌对环境中。说到这里，我们试图通过以下方式使MicroK8s更加安全:</p><ul class=""><li id="77fc" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">公开尽可能少的服务。下表列出了我们未解决的问题以及相关的访问限制:</li></ul><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ml mm l"/></div></figure><ul class=""><li id="0502" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">CA和证书在部署时创建一次。</li></ul><h2 id="559a" class="lj lk iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">试用即将发布的补丁</h2><p id="946a" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我们准备了一个临时分支，您可以使用它来评估上述更改:</p><pre class="lc ld le lf gt mn mk mo mp aw mq bi"><span id="1962" class="lj lk iq mk b gy mr ms l mt mu">snap install microk8s --classic --channel=1.13/edge/secure-containerd</span></pre><p id="6546" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您已经安装了MicroK8s，您可以切换MicroK8s正在使用的频道:</p><pre class="lc ld le lf gt mn mk mo mp aw mq bi"><span id="85ed" class="lj lk iq mk b gy mr ms l mt mu">snap refresh --channel=1.13/edge/secure-containerd microk8s</span></pre><p id="723a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尝试一下，如果我们错过了什么，请<a class="ae la" href="https://github.com/ubuntu/microk8s/issues" rel="noopener ugc nofollow" target="_blank">告诉我们</a>。</p><h2 id="d7df" class="lj lk iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">“谢谢，我不去了”</h2><p id="af3c" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">到目前为止的所有版本系列都不会受到此更改的影响。这意味着您可以让您的MicroK8s部署遵循1.13版本:</p><pre class="lc ld le lf gt mn mk mo mp aw mq bi"><span id="67e4" class="lj lk iq mk b gy mr ms l mt mu">snap refresh --channel=1.13/stable microk8s</span></pre><h2 id="e011" class="lj lk iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">总结</h2><p id="6d7e" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">一个重要的更新即将到来。请务必尝试使用:</p><pre class="lc ld le lf gt mn mk mo mp aw mq bi"><span id="8fa2" class="lj lk iq mk b gy mr ms l mt mu">snap install microk8s --classic --channel=1.13/edge/secure-containerd</span></pre><p id="293f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你不喜欢你所看到的，请告诉我们通过提交问题和继续使用1.13轨道的中断。</p><h1 id="9b36" class="mv lk iq bd ll mw mx my lo mz na nb lr nc nd ne lu nf ng nh lx ni nj nk ma nl bi translated">参考</h1><div class="nm nn gp gr no np"><a href="https://kubernetes.io/blog/2018/05/24/kubernetes-containerd-integration-goes-ga/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">Kubernetes集装箱集成正式上市</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">kubernetes Containerd Integration Goes GA作者:刘澜涛，软件工程师，谷歌和迈克布朗，开源…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">kubernetes.io</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od lh np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://github.com/ubuntu/microk8s/issues" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">ubuntu/microk8s</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">kubernetes集群在一瞬间。在GitHub上创建一个帐户，为ubuntu/microk8s的开发做出贡献。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od lh np"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Configuring Travis CI and Coveralls with Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flutter配置Travis CI和工作服</h1>
<blockquote>原文：<a href="https://itnext.io/configuring-travis-ci-and-coveralls-with-flutter-4c65edfc42d3?source=collection_archive---------4-----------------------#2020-02-24">https://itnext.io/configuring-travis-ci-and-coveralls-with-flutter-4c65edfc42d3?source=collection_archive---------4-----------------------#2020-02-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/63a929ee88a9dc0e9224a65e9c6555b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sthBZGJCvvVoRB22scLDwg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">颤振和特拉维斯CI</figcaption></figure><p id="9168" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在我之前的文章中，我谈到了使用Flutter的测试驱动开发(TDD)，你可以在这里阅读<a class="ae la" href="https://medium.com/@sammytech/test-driven-development-in-flutter-e7fe7921ea92" rel="noopener">。这一次，我们将尝试为</a><a class="ae la" href="https://travis-ci.com/" rel="noopener ugc nofollow" target="_blank"> Travis-CI </a>进行设置，并将Flutter应用程序与<a class="ae la" href="https://coveralls.io/" rel="noopener ugc nofollow" target="_blank">套装</a>集成在一起，这将为我们提供关于您的应用程序中的测试覆盖率的反馈。</p><p id="e59b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">我希望这个指南能帮到你</strong>😀<strong class="ke ir">。</strong></p><h1 id="21f5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">要求</strong></h1><ul class=""><li id="1ae3" class="lz ma iq ke b kf mb kj mc kn md kr me kv mf kz mg mh mi mj bi translated">Flutter app应该托管在GitHub、GitLab或者Bitbucket上。</li><li id="7c78" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">Travis CI帐户</li><li id="e7b4" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">颤振SDK</li></ul><h1 id="5532" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建Github/BitBucket/GitLab项目</h1><p id="7166" class="pw-post-body-paragraph kc kd iq ke b kf mb kh ki kj mc kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">创建您的flutter应用程序，并将其推送到GitHub/BitBucket/GitLab。出于本教程的目的，我将使用PiggyX应用程序来演示在Flutter中测试驱动开发的概念。这些代码可以在Github上找到。点击<a class="ae la" href="https://github.com/Mastersam07/PiggyX" rel="noopener ugc nofollow" target="_blank">此处</a>进入代码。你可以在这里阅读之前关于测试驱动开发<a class="ae la" href="https://medium.com/@sammytech/test-driven-development-in-flutter-e7fe7921ea92" rel="noopener">的文章。</a></p><h1 id="630b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">与Travis CI集成</h1><p id="1701" class="pw-post-body-paragraph kc kd iq ke b kf mb kh ki kj mc kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">您需要首先在Travis-CI dashboard上注册您的GitHub项目/资源库。这样，travis就可以检测到存储库中的变化。如果您的存储库是公共的，请前往<a class="ae la" href="https://travis-ci.org/" rel="noopener ugc nofollow" target="_blank">https://travis-ci.org/</a>，如果是私有的，请前往<a class="ae la" href="https://travis-ci.com/" rel="noopener ugc nofollow" target="_blank">https://travis-ci.com/</a>。</p><p id="35a8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在Travis中，您在名为<code class="fe mt mu mv mw b">.travis.yml</code>的文件中定义的<em class="ms"> YAML </em>模式下实现管道。为了让事情继续进行下去，Travis你需要做的就是将正确的<code class="fe mt mu mv mw b">.travis.yml</code>添加到你的库的根中，并告诉Travis按照他们的指示<a class="ae la" href="https://docs.travis-ci.com/user/getting-started" rel="noopener ugc nofollow" target="_blank">开始你的库的连续构建。这里我只解释一下<code class="fe mt mu mv mw b">.travis.yml</code>文件中的内容。下面是我选定的配置:</a></p><pre class="mx my mz na gt nb mw nc nd aw ne bi"><span id="16a0" class="nf lc iq mw b gy ng nh l ni nj">language: dart<br/>dist: xenial<br/>addons:<br/>  apt:<br/>    packages:<br/>      - lib32stdc++6<br/>install:<br/>  - git clone https://github.com/flutter/flutter.git -b stable<br/>  - ./flutter/bin/flutter doctor<br/>script:<br/>  - ./flutter/bin/flutter test<br/>cache:<br/>  directories:<br/>    - $HOME/.pub-cache</span></pre><p id="36a1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">语言<br/> </strong>这为特定语言定制CI环境。省略这一部分告诉travis使用默认语言<strong class="ke ir"> Ruby </strong>。<br/> <strong class="ke ir"> Dist <br/> </strong>指定使用的Ubuntu基础版本。我指定Xenial Xerus支持到2021年。<br/> <strong class="ke ir">插件<br/> </strong>这可以让你在操作系统上安装额外的软件包。在我的实验中，没有<code class="fe mt mu mv mw b">lib32stdc++6</code>的测试仍然通过，但是<code class="fe mt mu mv mw b">flutter doctor</code>抱怨了，所以我把它包括进来。<br/> <strong class="ke ir">安装<br/> </strong>这应该调用Dart的<code class="fe mt mu mv mw b">pub get</code>，但是Flutter报错了，所以让我们忽略它，安装Flutter。<strong class="ke ir"> <br/>脚本<br/> </strong>这是我们运行测试的地方。所以我们在这里提供了运行测试的方法。<br/> <strong class="ke ir">缓存<br/> </strong>这里是最后的部分。这告诉Travis缓存默认Dart包缓存的内容。这应该会让Flutter更快地安装应用程序的依赖项。<br/> <br/>此配置运行良好，完成时间不到2分30秒。</p><h1 id="53d0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将Github项目添加到工作服</h1><p id="8b85" class="pw-post-body-paragraph kc kd iq ke b kf mb kh ki kj mc kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">要将项目添加到工装服，请登录到<a class="ae la" href="https://coveralls.io/" rel="noopener ugc nofollow" target="_blank">https://coveralls.io/</a>并使用您的GitHub/GitLab/BitBucket帐户登录，转到<em class="ms">添加仓库</em>并选择您想要集成的存储库。然后，当你去<em class="ms"> Repos </em>的时候，你应该会看到你的项目。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/9e3e64f106b26cbfb5ccdff4a00b5f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEmajRaktLEq3NRr4JQ-1w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae la" href="https://coveralls.io/" rel="noopener ugc nofollow" target="_blank">工作服</a></figcaption></figure><h1 id="57e4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更新. travis.yml</h1><p id="344d" class="pw-post-body-paragraph kc kd iq ke b kf mb kh ki kj mc kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">要调用Travis build上的工作服，您需要更改<code class="fe mt mu mv mw b">.travis.yml</code>文件。我们需要做的只是稍微调整一下，就可以生成并发送覆盖报告。</p><pre class="mx my mz na gt nb mw nc nd aw ne bi"><span id="fc34" class="nf lc iq mw b gy ng nh l ni nj">language: dart<br/>dist: xenial<br/>addons:<br/>  apt:<br/>    packages:<br/>      - lib32stdc++6<br/>install:<br/>  - git clone https://github.com/flutter/flutter.git -b stable<br/>  - ./flutter/bin/flutter doctor<br/>  - gem install coveralls-lcov<br/>script:<br/>  - ./flutter/bin/flutter test --coverage<br/>after_success:<br/>  - coveralls-lcov coverage/lcov.info<br/>cache:<br/>  directories:<br/>    - $HOME/.pub-cache</span></pre><p id="67f5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们又添加了两行并编辑了脚本:<br/> <strong class="ke ir">安装</strong>:我们添加了<em class="ms">宝石安装套装-lcov安装套装<br/> </em> <strong class="ke ir"> <em class="ms">脚本</em> </strong> <em class="ms">:我们将脚本改为。/flutter/bin/flutter test——生成测试覆盖率报告的覆盖率。<br/></em><strong class="ke ir"><em class="ms">【after _ success】</em></strong><em class="ms">:我们在这里添加了工作包-lcov coverage/lcov.info </em>来发送覆盖报告。</p><p id="fc1b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">至此，您已经为travis-ci和工作服配置了flutter，并且应该能够看到您的测试覆盖率了😄 😄 😄。</p><p id="d251" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">加分<br/> </strong>你可以在项目自述中添加一个徽章，让人们知道项目是如何测试的。要添加服务范围/工作服工卡，登录并打开工作服项目，点击设置。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/376952738aae4e9d3678afd1f6f89d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ohh4lHAkLT9FMlN5_cxsRQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">项目委员会工作服</figcaption></figure><p id="7ef7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在回购设置中，您会看到readme徽章旁边有一个<strong class="ke ir">嵌入</strong>下拉按钮。点击此按钮将为您提供各种徽章选项。对于这个<a class="ae la" href="https://github.com/Mastersam07/PiggyX" rel="noopener ugc nofollow" target="_blank">项目</a>，我使用了Markdown变种并添加到项目README.md中</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/1085058a9680b0f29e3e582515538197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZkMfqNFXdNaX0ZwDLyFiA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">回购设置工作服. io</figcaption></figure><p id="bfc5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要添加travis build状态徽章，请登录并打开travis上的项目。您应该在项目仪表板上看到一个带有构建状态的标记。构建状态各不相同，可能是未知、失败、通过、错误，视具体情况而定。单击此构建状态徽章。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/dfefcb95497d04e119fd87c610babf4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PtuRVQVA7bKvTrbWEJsPGw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">项目仪表板travis-ci</figcaption></figure><p id="edb9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你的屏幕上应该会出现一个弹出窗口，为你提供状态图像的选项。对于这个<a class="ae la" href="https://github.com/Mastersam07/PiggyX" rel="noopener ugc nofollow" target="_blank">项目</a>，我整合了主分支并使用了降价状态图像。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/cfda48402597bd86689879bd9109c802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kSEI7-e6v4Y5lyObBastg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">状态图像travis-ci</figcaption></figure><p id="7c33" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">就是这样！现在，在Travis上正确构建之后，您将能够在您的项目中看到您的测试覆盖率和一些闪亮的徽章💃 💃 💃。完整示例可在<a class="ae la" href="https://github.com/Mastersam07/PiggyX" rel="noopener ugc nofollow" target="_blank">此处</a>获得。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/bd59e83c29c91ce0ef8adf07c1af072a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9F4RV0gJs7ZzL3uCQkD8w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae la" href="https://github.com/Mastersam07/PiggyX/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">https://github.com/Mastersam07/PiggyX/blob/master/README.md</a></figcaption></figure><p id="12c4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您有任何问题，请随时发表评论🙂。</p></div></div>    
</body>
</html>
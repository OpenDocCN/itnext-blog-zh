<html>
<head>
<title>How I turned my old desktop into 2.5TB NAS backup Linux server with a few hard drives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用几个硬盘将我的旧台式机变成2.5TB NAS备份Linux服务器</h1>
<blockquote>原文：<a href="https://itnext.io/how-i-turned-my-old-desktop-into-2-5tb-nas-backup-linux-server-with-a-few-hard-drives-1414852aa0b5?source=collection_archive---------3-----------------------#2020-05-05">https://itnext.io/how-i-turned-my-old-desktop-into-2-5tb-nas-backup-linux-server-with-a-few-hard-drives-1414852aa0b5?source=collection_archive---------3-----------------------#2020-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/82fc608246c5620abe2294bcec9df46e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KcGnLMFvgYVnw9VjIHB0wA.png"/></div></div></figure><p id="fa5a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这一切都是从我得到一台新的笔记本电脑开始的，它远远取代了我的台式电脑。是时候重新利用桌面，让它变得有用了，尤其是当我一直都是一个人在家的时候。</p><p id="4911" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，我拿了一些闲置的旧硬盘——我有这些容量为320 GB、400 GB和500 GB的旧SATA硬盘，我计划有一天用它们来做些什么。这一天已经到来。</p><p id="d787" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我把桌面PC擦了一下，装了新的<a class="ae kz" href="https://releases.ubuntu.com/20.04/" rel="noopener ugc nofollow" target="_blank"> Ubuntu Focal Fossa 20.04 </a>在上面。用一个USB安装程序花了半个小时，是用<a class="ae kz" href="https://rufus.ie/" rel="noopener ugc nofollow" target="_blank">鲁弗斯</a>做的。我还安装了一个ssh服务器用于远程访问。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi la"><img src="../Images/d520aa93ebc3b1c1349b29a9ff9fd291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htGrX7wjoMwWoltT8cQo_A.png"/></div></div></figure><p id="9936" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我把电脑拆开，找到一些电缆，在里面放了5个硬盘，并拆除了旧的GPU，所以设置没有浪费太多的电。</p><p id="bffb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在是真正“神奇”的时候了。我想将5个磁盘合并成一个大的可用空间，这样我就可以通过samba服务器进行远程备份。</p><h2 id="7c59" class="lf lg it bd lh li lj dn lk ll lm dp ln km lo lp lq kq lr ls lt ku lu lv lw lx bi translated">逻辑卷管理器</h2><p id="1cca" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">LVM正是我所需要的。这是一个与物理硬盘一起工作的抽象层。您可以使用它将物理磁盘“合并”成一大块美味的可用空间。</p><p id="eda1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，我需要擦除磁盘，并将其格式化为LVM兼容的文件系统。</p><p id="90ec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些是磁盘(我是在它完成后写这个指南的，所以磁盘标签已经是“后LVM”，但磁盘是一样的):</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/f901b8d68efc8f0a3861201701426123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JAVE53K0mAvKd28gsEOfg.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">lsblk显示所有sdX</figcaption></figure><p id="5e99" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我从/dev/sda开始，298GB的磁盘。</p><p id="0560" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="mi"> Fdisk </em>实用程序足够强大并且易于使用，所以让我们用它来格式化磁盘。它有一个简单的CLI界面:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mj"><img src="../Images/b330130c22fc4f5e5c4de87fe4b97563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z1gy1qKOXSzfUuI8qJXTYA.png"/></div></div></figure><p id="ef4f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我对其他磁盘做了同样的处理。现在是LVM的时候了。首先，我使用<em class="mi"> pvcreate </em>将单个磁盘注册为物理卷。我创建了一个名为<em class="mi"> datadriveVG的卷组。之后，我使用跨越这些磁盘的100%空闲空间创建了一个逻辑卷，并将其全部格式化为<em class="mi"> ext4 </em>文件系统。</em></p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mk"><img src="../Images/0b0bb944be86241b516b374eb1141da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*reh_X2F5F7gMP5L8gd2GVA.png"/></div></div></figure><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ml"><img src="../Images/72974289ee717996b5fbfa134ce4ed67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dcVML4RlwesmyUNli8eGQQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">在将可用空间合并成一个逻辑卷之后</figcaption></figure><p id="4160" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，我创建一个挂载点，并在<em class="mi"> fstab、</em>中注册它，以便在每次PC重新启动时挂载逻辑卷。为此，我需要获取卷的<em class="mi"> blkid </em>。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mm"><img src="../Images/ce59f5bbcf3c97807d037397e9dba651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auHaiBk9rXYsVwbSeAdgmg.png"/></div></div></figure><p id="f2b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我需要做的最后一件事是samba服务器，这样我就可以从我的windows远程访问它作为一个网络驱动器。</p><p id="d2ec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我通过apt安装它并编辑<em class="mi"> smb.conf </em>文件。然后，我将新驱动器的权限更改为可写，并将所有者设置为我自己。我还注册了我的帐户，并为远程访问设置了密码。最后一件事——我将samba服务设置为在启动后初始化，并重新启动它以使配置更改立即生效。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mn"><img src="../Images/29e0f2d25c6c6251fa054771497ff30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmkG_qqSyRo-PIy4p8cmPQ.png"/></div></div></figure><p id="4cdc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我把整个东西作为网络驱动器添加到我的Windows中，我们就完成了。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/05c7d8702bf5fc3b60961923615f3d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*SkzofXMjvIl1ohmIkn_S0g.png"/></div></figure></div></div>    
</body>
</html>
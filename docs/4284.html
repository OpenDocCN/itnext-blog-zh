<html>
<head>
<title>Android Notification All-in-One</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安卓通知一体机</h1>
<blockquote>原文：<a href="https://itnext.io/android-notification-all-in-one-8df3e1218e0e?source=collection_archive---------0-----------------------#2020-05-30">https://itnext.io/android-notification-all-in-one-8df3e1218e0e?source=collection_archive---------0-----------------------#2020-05-30</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="1db9" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">在21世纪，通知已经成为每个人日常生活的一部分。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/341c0d07336b6d27d98c46180a53c09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OoqNRjQj5bGcQLx6LqnofA.png"/></div></div></figure><p id="c2dd" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi lr translated">通知是当今智能手机最有用的功能之一，用户每天都会收到来自消息应用、新闻应用和游戏等的数百条通知。一个好的通知可以增加用户使用你的应用的动力。</p><p id="27b5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Android为开发者提供了大量的选项和功能来为用户提供良好的UI/ UX，并检测用户与每个通知的交互。作为一名Android开发者，我们应该了解更多关于通知布局及其功能的可能性。</p><p id="352d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我已经开发了几年的Android应用程序，我将把我过去的一些经验和技巧包括在内。希望这篇文章对你有用。开始吧！</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="349e" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">通知中的小部件</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mz"><img src="../Images/867c6eac121de046690fa5718012e519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yo_2cQ9y_8rR71Mho9Wh-w.png"/></div></div></figure><p id="2558" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">每个通知中共有9个不同的小部件(<a class="ae na" href="https://developer.android.com/guide/topics/ui/notifiers/notifications#Templates" rel="noopener ugc nofollow" target="_blank">而不是官方文档中的6个</a>):</p><ol class=""><li id="a5eb" class="nb nc iu kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated">小图标(通常是应用程序图标)—记住色调颜色，并参见<strong class="kx iv">“通知图标技巧”</strong>部分了解更多详情</li><li id="fa14" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">应用程序名称—设置在<code class="fe np nq nr ns b">AndroidManifest.xml</code></li><li id="0c36" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">子文本—用<code class="fe np nq nr ns b">setSubText(subText: String)</code>设置</li><li id="11f8" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">文本时—用<code class="fe np nq nr ns b">setWhen()</code>、<code class="fe np nq nr ns b">setShowWhen()</code>和<code class="fe np nq nr ns b">setUsesChronometer()</code>设定</li><li id="4c96" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">箭头按钮</li><li id="3af2" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">内容标题—用<code class="fe np nq nr ns b">setContentTitle(title: String)</code>设置</li><li id="4031" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">内容文本—用<code class="fe np nq nr ns b">setContentText(content: String)</code>设置</li><li id="e89d" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">大图标—用<code class="fe np nq nr ns b">setLargeIcon(bitmap: Bitmap)</code>设置</li><li id="a6e8" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">进度条—用<code class="fe np nq nr ns b"><em class="nt">setProgress(max: Int, progress: Int, isDeterminate: Bool)</em></code>设置</li></ol></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="53b5" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">5种内置通知样式</h1><p id="ef7f" class="pw-post-body-paragraph kv kw iu kx b ky nu jv la lb nv jy ld le nw lg lh li nx lk ll lm ny lo lp lq in bi translated">Android总共提供了5种现有的通知样式。它们可以向用户提供不同的UI / UX，用于显示<strong class="kx iv">对话</strong>、一段<strong class="kx iv">文本</strong>、一张<strong class="kx iv">图像</strong>、<strong class="kx iv">收件箱记录</strong>和一个<strong class="kx iv">媒体控制器</strong>:</p><p id="388f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">1.消息样式通知</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nz"><img src="../Images/b6d02c2dfa0d15241fcd573b60159030.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/0*jmPPn2gRuVhhGfHx.gif"/></div></figure><p id="0c9c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv"> 2。</strong> <a class="ae na" rel="noopener ugc nofollow" target="_blank" href="/android-notification-bigtextstyle-bd35f7530eae"> <strong class="kx iv"> BigTextSytle通知</strong> </a></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nz"><img src="../Images/61ed70ce7221686f92438bf73219af06.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/0*q9r5XfIUtjkZ9git.gif"/></div></figure><p id="1a25" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">3.<a class="ae na" rel="noopener ugc nofollow" target="_blank" href="/android-notification-bigpicturestyle-1f293e6cabaf"><strong class="kx iv">BigPictureStyleNotification</strong></a></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oa"><img src="../Images/0ef0e19d1d398e3ddc76a9775ec34c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/0*__Sn6APvg-xgXACp.gif"/></div></figure><p id="6dd0" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">4.<a class="ae na" rel="noopener ugc nofollow" target="_blank" href="/android-inboxstyle-notification-as-deep-as-possible-4d74c0c725f1"><strong class="kx iv">inbox style notification</strong></a></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ob"><img src="../Images/0ad59d2fc67661627357313277c7df49.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*yFjjrRf-wVrPcvVT.gif"/></div></figure><p id="a622" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">5.<a class="ae na" href="https://developer.android.com/reference/android/app/Notification.MediaStyle" rel="noopener ugc nofollow" target="_blank">媒体样式通知</a></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/41b8869a71b9e3e4b1d9366e503ac5b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hB41m3N5GG-TwYSo.png"/></div></div></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="61f9" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">2017年Android O (API 26)的重要更新</h1><div class="od oe gq gs of og"><a rel="noopener  ugc nofollow" target="_blank" href="/android-notification-channel-as-deep-as-possible-1a5b08538c87"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">尽可能深入的Android通知通道</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">自从……以来，通知通道已经成为向通知抽屉发送通知对象的必要部分</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">itnext.io</p></div></div><div class="op l"><div class="oq l or os ot op ou kt og"/></div></div></a></div><p id="4f13" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe np nq nr ns b">NotificationChannel</code>2017年Android O (API 26)新推出。每个通知都必须附加到一个<code class="fe np nq nr ns b">NotificationChannel</code>上，否则通知将无法发送到通知抽屉，错误日志如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ov"><img src="../Images/d9785d6ef7f47bcc5f53b35ed71a85e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*W6NGQ-Du6cNoQZdv6olKJw.png"/></div><figcaption class="ow ox gk gi gj oy oz bd b be z dk translated">在操作系统API 26之前，没有通知通道设置为通知时的错误消息</figcaption></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="6c6d" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">基本通知</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pa"><img src="../Images/4743269c31db89ea75a958da6ff20a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*6CUx2IhOzUkHXNF9qdyTcA.gif"/></div><figcaption class="ow ox gk gi gj oy oz bd b be z dk translated">基本通知图解</figcaption></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="6a06" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe np nq nr ns b">NotificationManager</code>是Android系统服务之一，可以管理发送到通知抽屉的通知。它可以对所有发送的通知进行CRUD(创建、读取、更新和删除)。开发者可以通过<code class="fe np nq nr ns b">notify(uniqueNotificationId: Int, notification: Notification)</code>方法向通知抽屉发送通知。</p><p id="eb95" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">最基本的通知包括:</p><ol class=""><li id="d9d7" class="nb nc iu kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated"><strong class="kx iv">强制</strong>通知图标(小图标)</li><li id="a82e" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">(可选)标题字符串</li><li id="0df5" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">(可选)内容字符串</li></ol><p id="aa3b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">记住</strong>，必须为每个<code class="fe np nq nr ns b">Notification</code>对象声明通知图标，否则应用程序将崩溃，并出现以下运行时错误:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pd"><img src="../Images/2c58fe91639e83f55713ec5d4a728c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*MahD8nY26rMNjMUD-pKHBA.png"/></div></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="e443" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">通知图标上的技巧</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pe"><img src="../Images/7876a57b6c5a6cc15643d252cd0504ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ExX-RcOT1vagHTgQy1fzw.png"/></div></div><figcaption class="ow ox gk gi gj oy oz bd b be z dk translated">像素3的屏幕截图(API 29)</figcaption></figure><p id="d4c5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">不同的制造商对小通知图标会有不同的实现。有些制造商会在通知图标上添加一层淡色，即所有不透明区域都将涂上由<code class="fe np nq nr ns b">setColor(colorRes: Int)</code>设置的颜色。上面的截图是在运行API 29的Pixel 3设备(由谷歌设计)上拍摄的。因此，设计师应该用透明线条勾勒出应用程序的标志，而不是使用不同的颜色。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="5d53" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">颜色(浅色)</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pf"><img src="../Images/fce9c27f3c4711a12b7f230c9096621a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Ltk2krbC3cUgbZ1ebDScw.png"/></div></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="8c55" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe np nq nr ns b">Notification.Builder</code>的颜色属性影响小图标和<code class="fe np nq nr ns b">RemoteInput</code>动作按钮的颜色。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="283a" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">隐私—设置可见性</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pg"><img src="../Images/818886f1f5324db1fb2c27bade19dfa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OzzdKpmcPZDAB6u7.png"/></div></div><figcaption class="ow ox gk gi gj oy oz bd b be z dk translated">left—VISIBILITY _ PUBLIC；右-可见性_私有</figcaption></figure><p id="e403" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">用户隐私是通知中最重要的部分。每个人都可以在不解锁用户手机的情况下看到用户的锁屏。当屏幕锁定时，开发人员应该隐藏敏感信息或整个通知，例如银行对账单和个人信息。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="6962" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">以下是3个可能的<code class="fe np nq nr ns b">Visibility</code>选项:</p><ol class=""><li id="1cc8" class="nb nc iu kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated"><strong class="kx iv">可见性_秘密</strong> <br/>安全等级最高。通知全部隐藏在锁屏。</li><li id="2319" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><strong class="kx iv">VISIBILITY _ PRIVATE<br/></strong>通知中的敏感信息被替换为另一组公共信息，可通过<code class="fe np nq nr ns b">setPublicVersion(publicNotification: Notification)</code>设置，参见第4–9行。</li><li id="ee80" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><strong class="kx iv"> VISIBILITY_PUBLIC </strong> <br/>所有信息自由显示。锁定屏幕的外观与平视横幅通知完全相同。见上图左侧。</li></ol></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="044c" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">用户交互—单击并消除通知</h1><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="4f6d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Android在通知上捕捉两种用户交互，一种是<strong class="kx iv">点击</strong>通知，另一种是<strong class="kx iv">取消</strong>通知。除了一个由<code class="fe np nq nr ns b">setContentIntent(pendingIntent: PendingIntent)</code>(第8行)设置，另一个由<code class="fe np nq nr ns b">setDeleteIntent(pendingIntent: PendingIntent)</code>(第9行)设置外，它们的处理是相同的。</p><p id="dce5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe np nq nr ns b">PendingIntent</code>是一个指向Android系统维护的令牌的引用。因此，如果应用程序被用户终止，它仍然有效，并且可以在将来的某个时刻广播。初始化<code class="fe np nq nr ns b">PendingIntent</code>共有4个功能:</p><ol class=""><li id="4d8c" class="nb nc iu kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated"><code class="fe np nq nr ns b">PendingIntent.getBroadcast()</code> —何时应该通知广播接收者</li><li id="10e9" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><code class="fe np nq nr ns b">PendingIntent.getActivity()</code> —何时应该启动活动</li><li id="6796" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><code class="fe np nq nr ns b">PendingIntent.getActivities()</code></li><li id="8fcf" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><code class="fe np nq nr ns b">PendingIntent.getService()</code> —服务应该何时启动</li></ol><p id="8ece" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">默认情况下，<code class="fe np nq nr ns b">Notification</code>在用户点击通知抽屉时不会被关闭。因此，开发人员必须调用<code class="fe np nq nr ns b">setAutoCancel(true)</code>(见第10行)，以便在用户被重定向到您的应用程序进行进一步操作后，隐藏通知抽屉中的通知。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="82b2" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">添加附加内容(信息)</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ph"><img src="../Images/d12b0cd00e98d7108812dbcbd2127d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwgCFB0uQXnHOJLHc5kKlQ.png"/></div></div></figure><p id="5299" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">可以将额外的信息传递给通知，然后在稍后检索回来，例如在<code class="fe np nq nr ns b">BroadcastReceiver</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="0320" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们可以先通过第2 -3行的<code class="fe np nq nr ns b">Bundle</code>封装值，然后将其传递给<code class="fe np nq nr ns b">setExtras</code>方法。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="e066" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在后期，例如<code class="fe np nq nr ns b">BroadcastReceiver</code>，我们可以通过第7行的<code class="fe np nq nr ns b">getExtras()</code>方法取回数据。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="1049" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">添加远程输入和操作</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pi"><img src="../Images/d0bc2ab4f651cc3e94a5c9f95211e01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/0*2TuuMVSd19rGcdlM.png"/></div><figcaption class="ow ox gk gi gj oy oz bd b be z dk translated">2个回复选项输入回复—选择和编辑文本</figcaption></figure><p id="9e27" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe np nq nr ns b">RemoteInput</code>和<code class="fe np nq nr ns b">Action</code>是可以让用户快速响应通知的UI套件。<code class="fe np nq nr ns b">RemoteInput</code>是一个带有预定义动作的<code class="fe np nq nr ns b">Button</code>列表，<code class="fe np nq nr ns b">Action</code>是一个可以显示<code class="fe np nq nr ns b">EditText</code>的列表，供用户在不打开应用程序的情况下输入<code class="fe np nq nr ns b">String</code>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pj"><img src="../Images/b78a6425536b0ccd290046f57267b5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*134SWLC1YkmwwU0d.png"/></div></div></figure><p id="031b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">由于空间有限，有些选项在没有空间显示时会被隐藏，例如“选项4”和“选项5”在纵向模式下隐藏，但在横向模式下显示。因此，我们应该限制每个选项的数量和标题长度，以防止被系统裁剪。</p><p id="106c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">关于<code class="fe np nq nr ns b">RemoteInput</code>的更多细节，请参考下一篇文章中的“第4部分5步远程输入”。</p><div class="od oe gq gs of og"><a rel="noopener  ugc nofollow" target="_blank" href="/android-messagingstyle-notification-as-clear-as-possible-1847f809ad59"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">Android消息样式通知尽可能清晰</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">如今，信息应用是我们生活中至关重要的一部分。一个好的消息通知可以极大地改善用户界面和UX…</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">itnext.io</p></div></div><div class="op l"><div class="pk l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="e52d" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">添加进度条</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pl"><img src="../Images/5d0cf146fb68b152c800c358ec5660f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*5bvFqd0CYSifkTPSVrhIJg.png"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="b29b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">进度条通常用于显示长时间运行任务的进度，例如从Play Store下载应用程序或将文件上传到服务器。它的用法简单明了。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="1503" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">设置通知时间</h1><p id="ebf1" class="pw-post-body-paragraph kv kw iu kx b ky nu jv la lb nv jy ld le nw lg lh li nx lk ll lm ny lo lp lq in bi translated">通知项显示的时间必须是它被发送到通知抽屉的时间，这通常是一种误解。可以用<code class="fe np nq nr ns b">setWhen(timestampInMillis: Long)</code>功能手动改变。通知项的<code class="fe np nq nr ns b">when</code>属性用于对通知通道中的通知进行排序。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pa"><img src="../Images/da389a13a61ae5a283321fbc80ea8868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*TSh-bb_F4r9SgmxviPtFSA.png"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="26ae" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">用例可以是在消息应用中处理比赛情况。假设WebSocket正在侦听来自服务器的事件，但是由于文本和图像消息之间的处理时间，发送消息的顺序和接收消息的顺序可能不同。换句话说，文本消息在图像消息之前到达，甚至图像消息在文本消息之前被发送。</p><p id="b87d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">此外，开发者可以通过调用<code class="fe np nq nr ns b">setShowWhen(isShow: Boolean)</code>来显示或隐藏时间。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="9add" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">显示计时器</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pa"><img src="../Images/1008d72d82f47b92bdd9bcfef90d6746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*HHdgO2rT69ju9mOuDPvuqQ.gif"/></div></figure><p id="fc07" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe np nq nr ns b">when</code>属性也可以设置为与特定时间相关的计时器或计时器。<code class="fe np nq nr ns b">setUsesChronometer(true)</code>会根据<code class="fe np nq nr ns b">setWhen(timestamp: Long)</code>设定的时间将显示的时间视为计时器。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="3855" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">同时，<code class="fe np nq nr ns b">when</code>属性可以设置为未来的某个时刻。这种情况会将时间从递增计数计时器改变为递减计数计时器。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pa"><img src="../Images/9ff2998376c4573acf59d0a6db3908e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*KCaLRI3FwsU9hxy2jiir-w.gif"/></div></figure><p id="6e1f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">向上计数计时器可用于显示正在进行的电话呼叫的经过时间，向下计数时间可用于显示预定任务的剩余时间。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pa"><img src="../Images/fe356574165df05460b186776e8de2b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*czf7Hbbd22i8BbeznlyhDA.png"/></div></figure><p id="f8c4" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在一些特殊情况下，比如Android系统通知，长时间运行的进程不需要显示时间。通过调用<code class="fe np nq nr ns b">setShownWhen(false)</code>可以隐藏时间字符串。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="65e3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">对<code class="fe np nq nr ns b">when</code>属性有限制。时间格式不可定制，默认为<code class="fe np nq nr ns b">HH:mm:ss</code>。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="4b6d" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">解除通知</h1><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pb pc l"/></div></figure><p id="83e8" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果您的应用程序支持身份验证，当用户注销应用程序时，通常需要取消所有现有的通知。开发者可以调用<code class="fe np nq nr ns b">NotificationManager</code>的<code class="fe np nq nr ns b">cancelAll()</code>函数轻松解除所有通知。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="5b66" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">摘要</h1><ol class=""><li id="ff04" class="nb nc iu kx b ky nu lb nv le pm li pn lm po lq ng nh ni nj bi translated">通知共有9个可定制的部件</li><li id="55c0" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">MessagingStyle、BigTextStyle、BigPictureStyle、InboxStyle和MediaStyle是Android提供的通知样式，用于向用户展示更好的布局。</li><li id="02a6" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><code class="fe np nq nr ns b">NotificationChannel</code>是从API 26开始添加的，开发者现在必须设置它以防止运行时崩溃</li><li id="9c87" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">通知图标应设计为透明图案，以显示细节部分，即使被一层浅色覆盖</li><li id="eac9" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">用户隐私肯定是一个大问题，应该尽可能小心处理。Android可以隐藏整个通知或隐藏敏感消息，这取决于用户的需要。</li><li id="85fa" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">Android可以捕获点击和删除通知动作</li><li id="def4" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">数据可以通过<code class="fe np nq nr ns b">Bundle</code>发送给通知接收者</li><li id="06bf" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">RemoteInput和choices是用户在不打开应用程序的情况下响应通知的好工具</li><li id="4ccc" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">当有一个耗时的任务在你的应用程序中运行时，进度条应该被添加</li><li id="fcbb" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">通知时间可以定制为任何时间，并显示一个计时器。</li><li id="5e0f" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">当用户从你的应用注销时取消所有通知</li></ol></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="8b81" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">参考</h1><ol class=""><li id="259a" class="nb nc iu kx b ky nu lb nv le pm li pn lm po lq ng nh ni nj bi translated"><a class="ae na" rel="noopener ugc nofollow" target="_blank" href="/android-custom-notification-in-6-mins-c2e7e2ddadab">安卓定制通知</a></li><li id="a9d0" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><a class="ae na" rel="noopener ugc nofollow" target="_blank" href="/android-notification-channel-as-deep-as-possible-1a5b08538c87">尽可能深入的Android通知通道— ITNEXT </a></li><li id="2b6a" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><a class="ae na" href="https://developer.android.com/guide/topics/ui/notifiers/notifications" rel="noopener ugc nofollow" target="_blank">安卓通知概述</a></li><li id="a9a8" class="nb nc iu kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated"><a class="ae na" href="https://developer.android.com/reference/android/app/Notification.Builder" rel="noopener ugc nofollow" target="_blank"> Android NotificationBuilder文档</a></li></ol></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><p id="4fe4" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">欢迎您通过<a class="ae na" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ my rik _ chow</a>关注我，了解更多信息和文章。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
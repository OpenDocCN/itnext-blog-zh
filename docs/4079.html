<html>
<head>
<title>Add an animated indicator to your BottomNavigationView</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向您的BottomNavigationView添加动画指示器</h1>
<blockquote>原文：<a href="https://itnext.io/add-an-animated-indicator-to-your-bottomnavigationview-db04c6aa738f?source=collection_archive---------2-----------------------#2020-04-23">https://itnext.io/add-an-animated-indicator-to-your-bottomnavigationview-db04c6aa738f?source=collection_archive---------2-----------------------#2020-04-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div class="gh gi io"><img src="../Images/0abdeb57a41f455408b3d5f271c81fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*XaErZDWsFEKYtjJwM-YF3g.gif"/></div></figure><div class=""/><p id="da77" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你是否认为标准的BottomNavigationView组件有点无聊，想要增加它的趣味？在这篇文章中，我将向你展示添加一个自定义指示器并让它在不同的位置之间移动是多么容易。</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="935c" class="kz la ix bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">我们将会做什么</h2><ul class=""><li id="d5ab" class="ls lt ix jw b jx lu kb lv kf lw kj lx kn ly kr lz ma mb mc bi translated">扩展底部导航视图</li><li id="4b05" class="ls lt ix jw b jx md kb me kf mf kj mg kn mh kr lz ma mb mc bi translated">使用画布API绘制一个指示器</li><li id="420b" class="ls lt ix jw b jx md kb me kf mf kj mg kn mh kr lz ma mb mc bi translated">听取项目选择并相应移动指示器</li><li id="4801" class="ls lt ix jw b jx md kb me kf mf kj mg kn mh kr lz ma mb mc bi translated">动画运动，并添加一个放大/缩小动画</li></ul></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="3180" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们开始之前，尽管您需要的所有代码都包含在下面，但您可以在我的Github页面上找到一个示例项目:</p><div class="ip iq gp gr ir mi"><a href="https://github.com/patrick-elmquist/Demo-BottomNavigationIndicator" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iy gy z fp mn fr fs mo fu fw iw bi translated">Patrick-elmquist/Demo-BottomNavigationIndicator</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">在GitHub上创建一个帐户，为Patrick-elmquist/Demo-BottomNavigationIndicator开发做贡献。</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">github.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw it mi"/></div></div></a></div></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="bdb9" class="kz la ix bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">给我看看代码</h2><p id="a5d1" class="pw-post-body-paragraph ju jv ix jw b jx lu jz ka kb lv kd ke kf mx kh ki kj my kl km kn mz kp kq kr ij bi translated">所以让我们先看看我们正在实现的类，然后看看它是做什么的。</p><figure class="na nb nc nd gt is"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="de1a" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们来分解一下。</p><h2 id="e63a" class="kz la ix bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">动画位置</h2><figure class="na nb nc nd gt is"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="6c4e" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个函数是这个类的核心，这是我们计算指示器的下一个位置并启动动画来移动它的地方。我们从取消任何运行的动画开始。接下来，我们确保可以找到给定id的视图。<code class="fe ng nh ni nj b">fromCenterX</code>存储在动画外部，以获得用于动画更新块内部插值的起始值。</p><p id="154d" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">动画可以通过多种方式制作。在这个例子中，我已经决定让它在缩放值之间动画化，因为有三个缩放值(当前缩放&gt;大&gt;默认)，并根据<code class="fe ng nh ni nj b">animatedFraction</code>插入平移，T1是一个介于0.0-1.0之间的值，表示动画持续时间有多长。</p><p id="431b" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">代码本身非常简单，我们计算新的位置，并用它和新的刻度值一起更新指示器的边界。</p><p id="bbce" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe ng nh ni nj b"><strong class="jw iy">distanceTravelled</strong></code> <strong class="jw iy"> vs比例<br/> </strong>距离总是从视图的中心开始测量，这样比例就不会影响到它。</p><pre class="na nb nc nd gt nk nj nl nm aw nn bi"><span id="207e" class="kz la ix nj b gy no np l nq nr"><em class="ns">Item1</em>               <em class="ns">Item2</em><br/>    (=x=)<br/>  |---|                <br/>         (===x===)<br/>  |----------|<br/>                 (=x=)<br/>  |----------------|</span></pre><p id="5f18" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw iy">指示器边界<br/> </strong>边界被定义为父对象中的位置，因此我们使用移动的距离和新的宽度来定义左右值。</p><pre class="na nb nc nd gt nk nj nl nm aw nn bi"><span id="b842" class="kz la ix nj b gy no np l nq nr"><em class="ns">distanceTravelled</em><br/>       |<br/> (=====x=====)<br/> |---<em class="ns">width</em>---|</span><span id="d97b" class="kz la ix nj b gy nt np l nq nr">left  = dT - width/2<br/>right = dT + width/2</span></pre><p id="a088" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw iy">持续时间<br/> </strong>动画持续时间是一个计算值，取决于指示器必须移动的距离。为什么要把事情复杂化？两个相邻项目之间的动画应该比相距最远的两个项目之间的动画更快，这是有意义的，否则短运动将会感觉迟钝，或者长运动几乎不会被注意到。</p><p id="ef34" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这就是想法，然而实现和值是完全任意的，主要取决于你正在做的动画类型和你正在使用的插值器。在这种情况下，使用<code class="fe ng nh ni nj b">LinearOutSlowInInterpolator</code>，让一半的最大持续时间由距离控制感觉像一个很好的分割。</p><pre class="na nb nc nd gt nk nj nl nm aw nn bi"><span id="1bf5" class="kz la ix nj b gy no np l nq nr"><em class="ns">Item1</em>               <em class="ns">Item2</em><br/>  O<br/>  |-------------------|<br/>      <em class="ns">distanceToMove</em></span><span id="c1cd" class="kz la ix nj b gy nt np l nq nr">base     = 300L<br/>variable = 300L<br/>duration = base + variable * distanceToMove / parentWidth</span></pre><h2 id="6a8e" class="kz la ix bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">绘制指示器</h2><figure class="na nb nc nd gt is"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="35cd" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">默认情况下，<code class="fe ng nh ni nj b">BottomNavigationView</code>不会调用<code class="fe ng nh ni nj b">onDraw</code>，所以我们将绘制命令放在<code class="fe ng nh ni nj b">dispatchDraw</code>中。这个命令很简单，用指示器的边界画一个圆角矩形，圆角半径是指示器高度的一半。这使得指示器在移动时呈药丸形状，在静止时呈圆形。</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="9b77" class="kz la ix bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">好了</h2><p id="91c3" class="pw-post-body-paragraph ju jv ix jw b jx lu jz ka kb lv kd ke kf mx kh ki kj my kl km kn mz kp kq kr ij bi translated">只要在你的布局中使用这个新的类来代替<code class="fe ng nh ni nj b">BottomNavigationView</code>，你就可以开始了。</p><figure class="na nb nc nd gt is gh gi paragraph-image"><div class="gh gi io"><img src="../Images/0abdeb57a41f455408b3d5f271c81fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*XaErZDWsFEKYtjJwM-YF3g.gif"/></div></figure><p id="8056" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这一次就到此为止，祝你愉快！</p></div></div>    
</body>
</html>
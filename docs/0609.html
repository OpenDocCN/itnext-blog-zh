<html>
<head>
<title>Building RESTful Web APIs with Node.js, Express, MongoDB and TypeScript — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js、Express、MongoDB和TypeScript构建RESTful Web APIs第1部分</h1>
<blockquote>原文：<a href="https://itnext.io/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-1-2-195bdaf129cf?source=collection_archive---------0-----------------------#2018-04-16">https://itnext.io/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-1-2-195bdaf129cf?source=collection_archive---------0-----------------------#2018-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/e448896648e7a16f3be0c2707c5a95ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ZZRtwzUVGyBkfkKurbHjwg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><em class="jy">(图片来自OctoPerf) </em></figcaption></figure><p id="8588" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">有一门关于<a class="ae kx" href="https://www.lynda.com/Node-js-tutorials/Next-steps/633869/671263-4.html" rel="noopener ugc nofollow" target="_blank">如何在Lynda </a>上构建Web APIs的课程，但是他们没有使用TypeScript。所以我决定用TypeScript做一个。这个项目中有许多需要改进的地方。如果你找到了，请留下评论。我很感激。)</p><p id="3fd0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-1-2-195bdaf129cf" rel="noopener"> <strong class="kb ir">第一部分:设置项目</strong> </a></p><p id="4cf5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-2-98c34e3513a2" rel="noopener"> <strong class="kb ir">第二部分:实现路由和CRUD </strong> </a></p><p id="2ebf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-3-d545b243541e" rel="noopener"> <strong class="kb ir">第3部分:为Web APIs使用控制器和模型</strong> </a></p><p id="7273" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-4-954c8c059cd4" rel="noopener"> <strong class="kb ir">第4部分:将Web APIs连接到MongoDB或其他</strong> </a></p><p id="2b17" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-5-a80e5a7f03db" rel="noopener"> <strong class="kb ir">第5部分:我们的Web APIs的安全性</strong> </a></p><p id="11e7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/building-a-serverless-restful-api-with-cloud-functions-firestore-and-express-f917a305d4e6"> <strong class="kb ir">奖励:用云函数、Firestore和Express构建一个“无服务器”RESTful API</strong></a></p><p id="2f9a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/handling-long-running-api-requests-in-nodejs-403bd566d47"> <strong class="kb ir">奖励:在Nodejs </strong> </a>中处理长时间运行的API请求</p><p id="4ac4" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">在我们开始之前</strong></p><p id="931e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">确保您的机器上安装了<a class="ae kx" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>。之后还要安装TypeScript和TypeScript节点。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="568e" class="lh li iq ld b gy lj lk l ll lm">npm install -g typescript ts-node</span></pre><p id="201e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">为了测试HTTP请求，我们可以使用<a class="ae kx" href="https://www.getpostman.com/apps" rel="noopener ugc nofollow" target="_blank"> Postman </a>发送示例请求。</p><p id="861b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> MongoDB准备</strong></p><p id="7fa8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">你应该在你的本地机器上安装<a class="ae kx" href="https://docs.mongodb.com/manual/administration/install-community/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>，或者使用其他服务，比如<a class="ae kx" href="https://mlab.com/" rel="noopener ugc nofollow" target="_blank"> mLab </a>或者<a class="ae kx" href="https://www.compose.com/compare/mongodb" rel="noopener ugc nofollow" target="_blank"> Compose </a></p><p id="c19a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果你在本地安装了MongoDB，你应该为GUI界面安装<a class="ae kx" href="https://robomongo.org/" rel="noopener ugc nofollow" target="_blank"> Robo Mongo </a>或者<a class="ae kx" href="https://docs.mongodb.com/compass/master/install/" rel="noopener ugc nofollow" target="_blank"> Mongo Compass </a>。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ln"><img src="../Images/10fc6f9ac94b045b80dc70eca0aa804f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMuMI8dFx3E6GVQ2Zw8Mkg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">MongoDB Compass GUI界面</figcaption></figure><p id="7f3c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在我们深入到编码部分之前，如果你想提前阅读配置，你可以检查一下我的github库。否则，您只需要按照步骤来运行您的项目。</p><p id="dbf7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第一步:启动一个节点项目</strong></p><p id="9776" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">创建项目文件夹并启动npm项目。记得回答所有问题，之后你可以随时修改</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="c7ba" class="lh li iq ld b gy lj lk l ll lm">mkdir node-apis-project<br/>cd node-apis-project<br/>npm init </span></pre><p id="42a9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第二步:安装所有依赖项</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4087" class="lh li iq ld b gy lj lk l ll lm">npm install --save @types/express express body-parser mongoose   nodemon</span></pre><p id="ab49" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第三步:配置类型脚本配置文件</strong></p><p id="93be" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这样做的目的是将所有的TypeScript文件放在<strong class="kb ir"> <em class="ls"> lib文件夹</em> </strong> <em class="ls"> </em>中进行开发，然后为了制作，我们将所有的Javascript文件保存在<strong class="kb ir"> <em class="ls"> dist文件夹</em> </strong>中。当然，我们将在项目中利用ES2015。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="35e4" class="lh li iq ld b gy lj lk l ll lm">// tsconfig.json<br/>{<br/>    "compilerOptions": {<br/>        "module": "commonjs",<br/>        "moduleResolution": "node",<br/>        "pretty": true,<br/>        "sourceMap": true,<br/>        "target": "es6",<br/>        "outDir": "./dist",<br/>        "baseUrl": "./lib"<br/>    },<br/>    "include": [<br/>        "lib/**/*.ts"<br/>    ],<br/>    "exclude": [<br/>        "node_modules"<br/>    ]<br/>}</span></pre><p id="f299" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以每当我们运行tsc命令时，lib文件夹中的所有ts文件都会被编译成dist文件夹中的js文件</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a5e1" class="lh li iq ld b gy lj lk l ll lm">tsc</span></pre><p id="ba97" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第四步:编辑package.json中的运行脚本</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="0d42" class="lh li iq ld b gy lj lk l ll lm">"scripts": {<br/>    "build": "tsc",<br/>    "dev": "ts-node ./lib/server.ts",        <br/>    "start": "nodemon ./dist/server.js",<br/>    "prod": "npm run build &amp;&amp; npm run start"<br/>}</span></pre><p id="d6e5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">因此，对于开发，我们可以通过运行以下命令来运行测试服务器</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="56be" class="lh li iq ld b gy lj lk l ll lm">npm run dev</span></pre><p id="7d4a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">用于生产</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="3c25" class="lh li iq ld b gy lj lk l ll lm">npm run prod</span></pre><p id="b340" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第5步:基本配置入门</strong></p><p id="3d7d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">你迟早会需要包<a class="ae kx" href="https://github.com/expressjs/body-parser" rel="noopener ugc nofollow" target="_blank">主体解析</a>来解析传入的请求数据。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="fad5" class="lh li iq ld b gy lj lk l ll lm">// lib/app.ts</span><span id="cdd1" class="lh li iq ld b gy lt lk l ll lm">import * as express from "express";<br/>import * as bodyParser from "body-parser";<br/><br/>class App {<br/><br/>    public app: express.Application;<br/><br/>    constructor() {<br/>        this.app = express();<br/>        this.config();        <br/>    }<br/><br/>    private config(): void{<br/>        // support application/json type post data<br/>        this.app.use(bodyParser.json());</span><span id="c741" class="lh li iq ld b gy lt lk l ll lm">        <!-- -->//support application/x-www-form-urlencoded post data<br/>        this.app.use(bodyParser.urlencoded({ extended: false }));<br/>    }<br/><br/>}<br/><br/>export default new App().app;</span></pre><p id="cb01" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">创建lib/server.ts文件</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a5ac" class="lh li iq ld b gy lj lk l ll lm">// lib/server.ts</span><span id="7be8" class="lh li iq ld b gy lt lk l ll lm">import app from "./app";<br/>const PORT = 3000;<br/><br/>app.listen(PORT, () =&gt; {<br/>    console.log('Express server listening on port ' + PORT);<br/>})</span></pre><p id="c2e8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">从现在开始，虽然您还不能发送HTTP请求，但是您仍然可以通过运行<strong class="kb ir"> <em class="ls"> npm run dev </em> </strong>来测试项目。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/357265b6497614c441a18fae54f7bd24.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*vEW6PFH_EimCWK62E_f5Sw.png"/></div></figure><p id="4178" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这是<a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-1-2-195bdaf129cf" rel="noopener"> <strong class="kb ir">的结尾部分1 </strong> </a>。我将更新<a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-2-98c34e3513a2" rel="noopener"> <strong class="kb ir">第二部</strong></a><strong class="kb ir"/><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-3-d545b243541e" rel="noopener"><strong class="kb ir">第三部</strong></a><strong class="kb ir"/><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-4-954c8c059cd4" rel="noopener"><strong class="kb ir">第四部</strong></a><strong class="kb ir"/><a class="ae kx" href="https://medium.com/@dalenguyen/building-restful-web-apis-with-node-js-express-mongodb-and-typescript-part-5-a80e5a7f03db" rel="noopener"><strong class="kb ir">第五部</strong> </a> <strong class="kb ir"> </strong>不久。以防你需要跳过一个头。请访问我的<a class="ae kx" href="https://github.com/dalenguyen/rest-api-node-typescript" rel="noopener ugc nofollow" target="_blank"> github库</a>获取完整代码。</p><div class="lv lw gp gr lx ly"><a href="https://github.com/dalenguyen/rest-api-node-typescript" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">GitHub-dalen guyen/rest-API-node-typescript:用Node.js构建RESTful Web APIs，Express…</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">这是一个简单的API，保存人们的联系信息。这个项目有两个版本。1.0.0版:您可以…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm js ly"/></div></div></a></div><p id="25ee" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae kx" href="https://twitter.com/dale_nguyen" rel="noopener ugc nofollow" target="_blank"> <strong class="kb ir">在Twitter上关注我</strong> </a>了解Angular、JavaScript &amp; WebDevelopment的最新内容👐</p></div></div>    
</body>
</html>
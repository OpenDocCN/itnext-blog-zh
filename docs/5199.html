<html>
<head>
<title>Getting Started with Graph Databases: Azure CosmosDB with Gremlin API and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图形数据库入门:Azure CosmosDB与Gremlin API和Python</h1>
<blockquote>原文：<a href="https://itnext.io/getting-started-with-graph-databases-azure-cosmosdb-with-gremlin-api-and-python-80e57cbd1c5e?source=collection_archive---------1-----------------------#2021-01-10">https://itnext.io/getting-started-with-graph-databases-azure-cosmosdb-with-gremlin-api-and-python-80e57cbd1c5e?source=collection_archive---------1-----------------------#2021-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/bd175b142243e166c95e99bc09f47693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ftJuF1YOKnBLPcvm"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> JJ英</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><h1 id="16aa" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="7dde" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在这篇文章中，我将使用<a class="ae kf" href="https://azure.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> Azure云平台</strong> </a> <strong class="lg iu">对<a class="ae kf" href="https://en.wikipedia.org/wiki/Graph_database" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">图形数据库</strong> </a>进行简单介绍。</strong></p><p id="fe48" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我将从快速介绍图形数据库开始，解释它们的用例以及优缺点。</p><p id="7171" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后，我们将使用<a class="ae kf" href="https://azure.microsoft.com/en-us/services/cosmos-db/" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">Azure CosmosDB</strong></a>和<a class="ae kf" href="https://tinkerpop.apache.org/" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">Apache tinker pop Gremlin API</strong></a>来看一个<strong class="lg iu">实用</strong> <strong class="lg iu">示例</strong>。目标是展示在<strong class="lg iu"> Azure </strong>中创建一个<strong class="lg iu">无服务器</strong>图形数据库来将数据建模为图形是多么容易。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/ee42bb315a3348e29132da48fb340d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-Ka1VviIb7kzWi0q.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://tinkerpop.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache TinkerPop </a>标志</figcaption></figure><h1 id="253a" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">图形数据库</h1><p id="8bc6" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">数据库世界分为两种类型:</p><ul class=""><li id="0215" class="mm mn it lg b lh mc ll md lp mo lt mp lx mq mb mr ms mt mu bi translated">传统的<strong class="lg iu">关系数据库</strong>保存类似<strong class="lg iu">表</strong>的结构化数据，</li><li id="f3bf" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated"><a class="ae kf" href="https://en.wikipedia.org/wiki/NoSQL" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> NoSQL </strong> </a>或者非关系数据库，这是一个用于定义任何非关系的类别。有许多类型的数据库旨在更好地模拟某些类型的数据。在这个类别中，我们有键值数据库、文档数据库，当然还有<strong class="lg iu">图数据库</strong>。</li></ul><p id="3d02" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我<strong class="lg iu">已经谈过</strong> <a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/massive-scale-databases-5b5917ed94e5"> <strong class="lg iu">关于NoSQL vs SQL的困境，但是让我们快速回顾一下…</strong></a></p><h2 id="3622" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">NoSQL vs SQL</h2><p id="0162" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这个话题在很多<a class="ae kf" href="https://www.geeksforgeeks.org/difference-between-sql-and-nosql/" rel="noopener ugc nofollow" target="_blank">篇</a>里都有涉及。NoSQL的出现是为了克服关系数据库面临的<strong class="lg iu">可伸缩性</strong>问题以及正在开发的应用程序类型的转变。SQL是一种强大的通用查询语言，但是它需要一个定义好的<strong class="lg iu">模式</strong>。另一方面，NoSQL并不强制执行模式，它更加具体，这意味着<strong class="lg iu">您需要提前考虑并优化查询</strong>。这是非常重要的，如果你知道你的数据将如何被访问，你希望大量的查询和强烈的一致性不是一个问题，那么NoSQL是一个伟大的选择；这是许多应用的情况。</p><p id="3871" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu"> NoSQL类型</strong></p><p id="ba99" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">NoSQL是一个广泛的主题，它由多种类型的数据库组成，这些数据库使用不同的方法来存储和访问数据。最重要的一点是理解<strong class="lg iu">根据您的使用情况，有些数据库会比其他数据库更适合您</strong>，此外，您可能希望组合几个数据库来满足不同的需求。我的建议是分析你的数据是如何被使用的，并选择最好的模型来解决你的特定需求；而不是选择技术，然后尝试将您的需求融入数据库模型。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/08927a7d84a5fd35fa14813b238a9adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*D_KPH2ZlEnnSPyLF.png"/></div></div></figure><p id="5a02" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">其中一些类型包括<strong class="lg iu">文档、时间序列、键值、图表</strong> …您需要<strong class="lg iu">选择能够更好地处理应用程序使用类型的数据库</strong>。在许多情况下，您需要运行多个数据库，每个数据库都针对特定的查询或访问模式进行了优化。</p><p id="ba55" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">例如，如果您正在使用SQL，并且发现自己在做大量的连接，因为您关心<strong class="lg iu">关系</strong>，那么<strong class="lg iu">图形数据库</strong>可能是一个更合适的解决方案。</p><p id="5035" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">图</strong>在处理<strong class="lg iu">复杂关系、非固定模式</strong>和大型数据集时极其有用。</p><h2 id="7374" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">什么是图形数据库？</h2><p id="8a18" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">图形数据库基于一种叫做<a class="ae kf" href="https://en.wikipedia.org/wiki/Graph_theory" rel="noopener ugc nofollow" target="_blank">图论</a>的数学模型。图形数据库代表一个数学<a class="ae kf" href="https://en.wikipedia.org/wiki/Graph_(discrete_mathematics%29" rel="noopener ugc nofollow" target="_blank">图</a>，它只是由边连接在一起的对象的集合。这些对象被称为节点或顶点，它们有属性和边(关系)来表示、存储和搜索数据的关系。理解<strong class="lg iu">图数据库对待节点间的</strong> <strong class="lg iu">关系与数据本身</strong>同等重要是很重要的。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d4157b16a91a5e593af01a50f86dedd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*fZKLTx1E6OtDXeq0.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">来源:<a class="ae kf" href="https://en.wikipedia.org/wiki/Graph_database#/media/File:GraphDatabase_PropertyGraph.png" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><p id="0593" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">正如我们所看到的，我们有两个主要对象:<strong class="lg iu">节点</strong>和<strong class="lg iu">顶点</strong>，它们中的每一个都<strong class="lg iu">同等重要</strong>并且可以有多个键值对<strong class="lg iu">属性</strong>。重要的是要理解<strong class="lg iu">没有模式</strong>，即使一个节点被定义了一个给定的“类型”，称为<strong class="lg iu">标签</strong>，也并不意味着具有该标签的所有节点都需要遵循相同的模式，所以图中的每个节点可以有不同的属性。</p><p id="3a7d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">让我们总结一下图形数据库的不同元素:</p><ul class=""><li id="1c6e" class="mm mn it lg b lh mc ll md lp mo lt mp lx mq mb mr ms mt mu bi translated">顶点/节点:顶点表示离散的实体，比如一个人、一个地方或一个事件。</li><li id="0893" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated"><strong class="lg iu">边/关系</strong>:边表示顶点之间的关系。例如，一个人可能认识另一个人，参与一个事件，并且最近去过一个地方。</li><li id="a75c" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">属性:属性表达了顶点和边的信息。顶点或边中可以有任意数量的属性，它们可用于描述和过滤查询中的对象。示例属性包括具有名称和年龄的顶点，或者可以具有时间戳和/或权重的边。</li><li id="c658" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">标签:标签是顶点或边的名称或标识符。标签可以对多个顶点或边进行分组，使得一个组中的所有顶点/边都具有某个标签。例如，一个图可以有多个标签类型为“人”的顶点。</li></ul><h2 id="4bb5" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">何时应该使用图形数据库</h2><p id="821b" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">简而言之，你需要理解数据，如果数据符合图表，那么很可能图表数据库是最好的选择。此外，图形数据库非常擅长对<strong class="lg iu">层次结构</strong>进行建模，但请注意，其他NoSQL数据库也可以对树状层次结构进行建模，如果关系数量较少，则效率会更高。例如，一个层次结构可以被建模成一个单个“大表”，其中每个数据库都有一个键值，例如<a class="ae kf" href="https://cassandra.apache.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">【卡珊德拉】</strong> </a>。</p><p id="fce5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">其他需要考虑的事项包括:</p><ul class=""><li id="f0dc" class="mm mn it lg b lh mc ll md lp mo lt mp lx mq mb mr ms mt mu bi translated"><strong class="lg iu">模式</strong>:如果你需要一个固定的模式，那么图形数据库可能不是你的最佳选择，如果没有固定的模式，那么它可能是一个好的选择。如果您的数据结构是固定和一致的，那么就没有必要使用图形数据库，因为图形数据库最适合存储所有类型的数据和不断变化的业务需求。</li><li id="2802" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated"><strong class="lg iu">缩放</strong>:图形数据库可以很好地缩放，它们非常好，在水平缩放方面明显超过关系数据库，特别是当关系数量增加时。</li><li id="5ece" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">如果您的需求只是存储数据，并且只使用简单的查询，那么可能不需要图形数据库。</li><li id="a3a7" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">如果数据是高度不连续的，并且数据之间的关系无关紧要(例如，客户交易数据)，您可能不需要图形数据库。</li><li id="c5a2" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">如果您正在查询批量数据扫描，图形数据库并不适合，因为它们并未针对此类操作进行优化，这通常适用于大多数NoSQL数据库。</li><li id="a225" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">如果需求是存储和检索包含非常大的值的实体属性(比如BLOBs、CLOBs等)，那么图数据库就不是理想的解决方案。其他数据库如<strong class="lg iu"> BigTable </strong>更适合存储大数据。图形数据库可以存储大量的数据和规模，但项目必须很小，不要让节点太大，否则图形会很慢。欲了解更多信息，请查看本文。</li></ul><h2 id="5a8f" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">用例</h2><ul class=""><li id="5ad9" class="mm mn it lg b lh li ll lm lp no lt np lx nq mb mr ms mt mu bi translated">欺诈或异常检测</li><li id="0b62" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">实时推荐</li><li id="1437" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">基于图形的搜索</li><li id="275e" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">地理空间的</li><li id="a012" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">物联网</li><li id="7b88" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">社交网络</li><li id="332c" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">机器学习</li><li id="5757" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">身份和访问管理</li></ul><h1 id="b70b" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">Azure Cosmos DB图形数据库</h1><p id="6cbd" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">市场上有许多图形数据库，既有开源的，也有商业的。其中最早也是最著名的图形数据库是<a class="ae kf" href="https://neo4j.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> Neo4j </strong> </a> <strong class="lg iu">。</strong>也有开放的替代方案如<a class="ae kf" href="https://janusgraph.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> JanusGraph </strong> </a>或<a class="ae kf" href="https://www.arangodb.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> ArangoDB </strong> </a>可以运行在云上或本地，非常灵活。JanusGraph可以在现有的NoSQL数据库上运行。我真的建议检查这些数据库，并尝试他们的能力。</p><p id="c27c" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了更快地移动，让我们使用<strong class="lg iu">云</strong>功能，特别是<a class="ae kf" href="https://azure.microsoft.com/en-us/services/cosmos-db/" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">Azure cosmos db</strong></a><strong class="lg iu"/>使用<a class="ae kf" href="https://docs.microsoft.com/en-us/azure/cosmos-db/graph-introduction" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> CosmosDB图形API </strong> </a>。我喜欢CosmosDB的一点是，它使用相同的服务和后端提供了几个<a class="ae kf" href="https://docs.microsoft.com/en-us/learn/modules/choose-api-for-cosmos-db/" rel="noopener ugc nofollow" target="_blank">API</a>，因此您可以尝试不同的模型并选择更适合您的数据的模型，可用的一些模型有<strong class="lg iu"> SQL </strong>(关系型)、<strong class="lg iu">文档</strong>(使用<strong class="lg iu"> MongoDB </strong> API)、键值(使用<strong class="lg iu"> Cassandra </strong>等等！</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/9e579169570240c9c0788502e4454da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p5WNfPCftSQrzKXn.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">Azure CosmoDB架构。<a class="ae kf" href="https://docs.microsoft.com/en-us/azure/cosmos-db/graph-introduction" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/cosmos-db/graph-introduction</a></figcaption></figure><p id="f09f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><a class="ae kf" href="https://docs.microsoft.com/en-us/azure/cosmos-db/introduction" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB </a>是全球分布式、多模式的数据库服务，由<strong class="lg iu">完全管理</strong>，并且还支持<strong class="lg iu">无服务</strong>即付即用模式。你可以在这里阅读更多信息<a class="ae kf" href="https://docs.microsoft.com/en-us/azure/cosmos-db/graph-introduction" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="ef2c" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">在Azure Cosmos DB中创建图形数据库</h1><p id="bc29" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们知道了什么是图形数据库，什么是CosmosDB，让我们创建一个新的数据库。我假设你已经有了一个<strong class="lg iu">蔚蓝</strong> <strong class="lg iu">账号</strong>，如果没有，你可以在这里 唱一首<strong class="lg iu">免费试用</strong> <a class="ae kf" href="https://azure.microsoft.com/en-us/free/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">。</strong></a></p><p id="c32b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在您的仪表板中，单击“创建资源”。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/15f49ed76151e87a39989a987d6ea69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*DA1mE5PRsWr1aSkheC2gCg.png"/></div></figure><p id="daaa" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在CosmosDB门户中，单击“添加”。选择您的订阅和资源组，您可以为CosmosDB创建新的订阅和资源组。在帐户名中，您需要创建一个全局唯一的名称。我用的是<em class="nt"> gdemo </em>。在API中，选择<strong class="lg iu"> Gremlin </strong>(图形)，启用笔记本以便您可以轻松浏览您的数据。选择位置，为了简化部署，选择<strong class="lg iu">无服务器</strong>模式。这是一种随用随付的模式，由于您不需要提前提供吞吐量，因此设置更加简单。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/0d2a6b7f6b79b28ebf3c6558cb7d8aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*YpHjHXaONIJwZpZJ_ImFHw.png"/></div></figure><p id="bffa" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">点击“审核并创建”。在最后一个屏幕中，选择创建。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/1d81fbe5e032ff6ff2becb9cb7c8512c.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*dUrCthvEJDpagwnKcNH7Kg.png"/></div></figure><p id="1e13" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这可能需要几分钟，但就是这样，您现在已经运行了图形数据库！</p><p id="3eea" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">部署完成后，单击“转到资源”。接下来，在主菜单中，点击<strong class="lg iu">数据浏览器</strong>。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/0d40555613e13267f7f14c7263ac848e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gFP-qP2EAPEopOEKhNN1Gw.png"/></div></figure><p id="8862" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">数据浏览器</strong>是创建、修改和可视化图表的绝佳工具。我们稍后将使用它来查询和导航图表。</p><p id="5de1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">下一步是创建数据库。请记住，您可以有几个数据库帐户，每个帐户包含几个数据库。让我们创建我们的数据库，并添加一个图表。当在我们的第一个数据库中创建我们的第一个图表时，这可以在一个单一的步骤中完成。点击数据浏览器顶部菜单中的“<strong class="lg iu">新图表</strong>”。</p><p id="9f1f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">第一个字段是数据库创建字段，选择一个<strong class="lg iu">数据库Id </strong>，在我们的例子中我们将其命名为“<strong class="lg iu"> <em class="nt"> demodb </em> </strong>”。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5d34095269afa400d93cc25580597f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*Okloy6COEwVFyUOA2j24jw.png"/></div></figure><p id="93f7" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来的两个字段用于创建一个<strong class="lg iu">新图形</strong>。图是共享同一<strong class="lg iu">分区键</strong>的节点和边的容器。这一点很重要，分区键用于将数据分割成分区，以允许CosmosDB扩展。您需要选择一个粒度足够大的键，以便能够正确地分割数据，但是粒度又不能太大，这样数据就会分散到各处。像任何其他NoSQL数据库一样，它将取决于您的查询，但由于图论，在图数据库中，您不需要根据您的查询来设计您的模型，只需要分区键。</p><p id="ee7b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">例如，如果您有许多客户，您可以使用<em class="nt"> customer_id </em>，这将允许您随着客户群的增加而扩展，并将确保一个客户查询不会影响另一个客户的性能。</p><p id="c588" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在下一节中，我们将介绍我们的数据模型，所以现在介绍这些值:</p><ul class=""><li id="e401" class="mm mn it lg b lh mc ll md lp mo lt mp lx mq mb mr ms mt mu bi translated"><strong class="lg iu">图形Id </strong> : <em class="nt">图形</em></li><li id="4aa8" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated"><strong class="lg iu">分区键</strong> : <em class="nt"> pk_id </em></li></ul><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/92f0ce9bd2e5d19004c383bde8f072f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*dl7WiU17_U_BvhiwqLdUIg.png"/></div></figure><p id="86e8" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">单击“OK ”,您应该会看到您的数据库和您的第一个图形创建！！！</p><p id="6d7e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如您所见，<strong class="lg iu">我们不需要事先定义任何模式</strong>。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/a41aade1d547dbb48208085aa61dea5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*K6eyzXnBzACZlJM4v5dSSQ.png"/></div></figure><p id="ad90" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">CosmosDB支持<strong class="lg iu">存储过程</strong>、<strong class="lg iu">用户定义函数</strong>(您可以创建自己的函数)、<strong class="lg iu">触发器</strong>(在事件发生后执行某项操作)等等。<strong class="lg iu">笔记本</strong>的功能也很棒，它允许数据科学家直接从浏览器进行数据探索！</p><p id="760e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们还可以将CosmosDB与其他服务如<a class="ae kf" href="https://docs.microsoft.com/en-us/azure/event-grid/overview" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">事件网格</strong> </a>或<a class="ae kf" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> Azure功能</strong> </a>集成，实现<a class="ae kf" href="https://www.reactivemanifesto.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">反应式</strong> </a>架构。</p><p id="4f5b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在是时候开始添加一些数据了！</p><h1 id="99f9" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">使用Azure Cosmos DB</h1><p id="89f1" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">NoSQL的一个优点，特别是图形数据库，是你不需要遵循瀑布方法和预先设计你的模式。此外，与其他NoSQL数据库相比，图形数据库不需要预先考虑查询。<strong class="lg iu">这使您能够探索和迭代优化您的模型和查询，并快速适应业务变化。</strong></p><h2 id="e595" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">我们的使用案例</h2><p id="933d" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">此时，您可能急于开始创建节点和边。作为一个例子，我们打算尝试模型和非常简化版的<strong class="lg iu"><em class="nt"/></strong>！</p><p id="cb09" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">目标是<strong class="lg iu">展示如何创建节点和几个关系</strong>。这就是我们要建模的。请注意，这不是Medium.com的正确型号，只是一个近似值。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/437a66c0985cfe32e3b6a9f99e7c1b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*JNeQL6UEBDkLDJi7l4eUcw.png"/></div></div></figure><p id="4857" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们有用户，他们可能有会员资格。如果他们拥有会员资格，他们可能对某些话题感兴趣。用户可以阅读文章并鼓掌。它也可以给一篇文章添加评论或者发表一篇新文章。一篇文章有一个id，标题，正文和标签。用户、文章、主题是节点的标签。</p><p id="2c3b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">请注意<strong class="lg iu">关系是如何成为一等公民</strong>的，它们也有属性，并且是图表中的关键元素。新手用户可能会认为节点类似于关系世界中的表，但事实并非如此，关系也非常重要，这就是为什么我们将“comment”建模为边而不是节点，尽管这通常是SQL数据库中的表。</p><p id="9fc0" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你可能会问的另一个问题是<strong class="lg iu">如何识别节点</strong>。属性就像关系数据库中的列，可以包含任何类型的数据，那么我如何<strong class="lg iu">决定某样东西本身是属性还是节点呢？</strong>。例如，您可能想知道为什么我们决定将标签作为属性而不是节点。答案是"<em class="nt">视情况而定</em>"，这就是为什么你需要知道数据以及如何被查询。如果您想在表单中使用自动完成功能，并且需要快速搜索所有标签，那么您可能希望有一个节点和关系，以便快速遍历图形。另一方面，如果使用单独的倒排索引来执行自动完成，那么只需将标签存储为节点的属性。在我们的例子中，为了简化，我们把它们作为属性。这个问题类似于在NoSQL世界中决定是要一个大桌子还是多个桌子。</p><h2 id="31d1" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">数据浏览器</h2><p id="96a8" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在CosmosDB中，我们使用<strong class="lg iu">Gremlin</strong><a class="ae kf" href="https://tinkerpop.apache.org/gremlin.html" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">API</strong></a>，它是<a class="ae kf" href="https://tinkerpop.apache.org/gremlin.html" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">Apache tinker pop</strong></a><strong class="lg iu">项目</strong>的一部分。它有自己的领域语言,允许你创建和操作图形，所以你不需要学习特定语言的API。</p><p id="d422" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Gremlin API非常直观且易于使用。在<strong class="lg iu"> Azure </strong>中，你可以直接从<strong class="lg iu">数据浏览器</strong>中运行和执行查询。这非常方便，因为您可以检查不同格式的结果，并将其可视化。这在您对数据建模时非常有用。</p><p id="561d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在Azure浏览器的数据浏览器中，选择“图形”。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/0ac9ef688352e6e4c9cb7372e43307a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*KTZ8JqMrgHdDuNpAfBXHDQ.png"/></div></figure><p id="6bd9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你可以输入任何Gremlin <strong class="lg iu"> DSL </strong>语言，直接从浏览器执行。你也可以点击“新建顶点”来添加一个新的节点。您还可以直接从UI添加存储过程或触发器。</p><p id="780b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">除了笔记本之外，另一个很酷的功能是能够使用<strong class="lg iu"> SQL </strong>运行查询，只需点击图表中的图表汉堡菜单，然后选择“新SQL查询”。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/28b813fb5ac570cbce34796726568cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*pWMxL21j-uWmc-s8KPH8vQ.png"/></div></figure><p id="4641" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在您可以运行任何SQL查询，注意只允许读操作。你需要使用Gremlin DSL来创建节点和边。我个人更喜欢Gremlin API，因为它比SQL更接近模型。</p><h2 id="98db" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">添加数据</h2><p id="9df7" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">好了，是时候添加一些数据了…</p><p id="0c20" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">虽然，我们可以使用数据浏览器来添加数据，但由于图表通常是由数据科学家和工程师操作的，所以让我们使用<strong class="lg iu"> Python </strong>！。我们将返回浏览器运行查询。</p><p id="a405" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你可以在这个<a class="ae kf" href="https://github.com/javiramos1/cosmosdb_gremlin_demo" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">资源库</strong> </a>中找到<strong class="lg iu">代码</strong>。</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="b5a6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">首先你需要安装<strong class="lg iu"> <em class="nt"> gremlinpython </em> </strong>库:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="2067" class="na kh it ol b gy op oq l or os">pip install gremlinpython</span></pre><p id="243a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后导入客户端:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="356d" class="na kh it ol b gy op oq l or os">from gremlin_python.driver import client, serializer</span></pre><p id="7e50" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后您需要初始化客户端，为此您需要:</p><ul class=""><li id="2f78" class="mm mn it lg b lh mc ll md lp mo lt mp lx mq mb mr ms mt mu bi translated">GREMLIN端点:数据库连接URL</li><li id="ca3c" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">机密:主键</li><li id="d9ef" class="mm mn it lg b lh mv ll mw lp mx lt my lx mz mb mr ms mt mu bi translated">用户名</li></ul><p id="459e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在左侧菜单中点击<strong class="lg iu">键</strong>以获取该信息:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/6c4c14617ffd826469b117e2bb7f772b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*OpevfWurUCWZrrBwkyK1Xg.png"/></div></figure><p id="cb5d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在输入如下详细信息:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="eed6" class="na kh it ol b gy op oq l or os">client = client.Client('wss://&lt;YOUR_ENDPOINT&gt;.gremlin.cosmosdb.azure.com:443/','g',      username="/dbs/&lt;YOUR_DATABASE&gt;/colls/&lt;YOUR_COLLECTION_OR_GRAPH&gt;",      password="&lt;YOUR_PASSWORD&gt;")</span></pre><p id="9c06" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">用户名是这样的格式:/dbs/{ <em class="nt">数据库</em> }/colls/{ <em class="nt">图形</em> }</p><p id="799a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">密码是主要密钥。</p><p id="df8d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在我们的例子中，应该是这样的:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="1434" class="na kh it ol b gy op oq l or os">client = client.Client('wss://gdemo.gremlin.cosmos.azure.com:443/', 'g', username="/dbs/demodb/colls/dgraph",<br/>password="Q9aNH...",                       message_serializer=serializer.GraphSONSerializersV2d0()<br/>)</span></pre><p id="1eb2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Python API使用<strong class="lg iu">异步</strong>调用CosmosDB，这提高了性能和吞吐量。记住CosmosDB在默认情况下是最终一致的。建议添加回调来检查结果。在我们的例子中，为了简单起见，我们将阻塞这个调用。</p><p id="9f0d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">让我们创建一个函数来执行Gremlin查询列表，这将非常方便:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="1ce8" class="na kh it ol b gy op oq l or os">def run(queries):<br/>    for query in queries:<br/>        print("\tRunning: {0}".format(<br/>            query))<br/>        try:<br/>            callback = client.submitAsync(query)<br/>            if callback.result() is not None:<br/>                results = callback.result()<br/>                if results is not None:<br/>                    print("\tSuccess!")<br/>            else:<br/>                print("Something went wrong with this query: {0}".format(query))<br/>        except Exception as e:<br/>            print('There was an exception: {0}'.format(e))</span></pre><p id="03a3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">好了，是时候使用<strong class="lg iu"> Gremlin </strong> API添加数据了。首先，我们定义查询。让我们添加几个用户…</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="47cd" class="na kh it ol b gy op oq l or os">init_user = [<br/>    "g.addV('User').property('id', 'user1').property('name','User 1').property('pk_id', '1')",<br/>    "g.addV('User').property('id', 'user2').property('name','User 2').property('pk_id', '2').property('location','EU')"<br/>]</span></pre><p id="9c52" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如你所见，API非常简单。<strong class="lg iu"> <em class="nt"> g </em> </strong>是指我们作为用户名选择的图形。然后我们使用标签User添加一个顶点/注释(<em class="nt"> addV </em>)。之后，我们链接不同的属性。注意<strong class="lg iu">属性是任意的</strong>，第二个用户有一个额外的“<em class="nt">位置</em>属性。</p><p id="9a81" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">请注意，我们添加了一个ID来方便地引用数据，否则将生成难以解释的UUID。<strong class="lg iu">分区键</strong>也是<strong class="lg iu">所需要的</strong>。</p><p id="5e86" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">让我们运行查询:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="73c5" class="na kh it ol b gy op oq l or os">run(init_user)</span></pre><p id="595b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在，如果您转到数据浏览器，选择“Graph”并运行<em class="nt"> g.V() </em>来查看图表，您应该会看到创建的用户:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ou"><img src="../Images/84df2f70d1db2de9179d81714a6530e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d3JWCDk0Q7CGN89qGzQHEA.png"/></div></div></figure><p id="b69b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">返回两个用户，您可以选择左边的结果并检查右边的属性。您也可以选择<strong class="lg iu"> JSON </strong>视图来查看原始数据。</p><p id="a3ae" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来，让我们为用户1添加一个成员资格:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="4584" class="na kh it ol b gy op oq l or os">run(<br/>["g.addV('Membership')<br/>.property('id', 'mem1')<br/>.property('name','Membership 1')<br/>.property('pk_id', '3').property('type','premium')"])</span></pre><p id="2ceb" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">让我们添加用户1和成员1之间的第一个关系:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="14dc" class="na kh it ol b gy op oq l or os">run(["g.V('user1').addE('has').to(g.V('mem1'))"])</span></pre><p id="74d5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">您可以返回到数据浏览器并刷新图表来查看新的关系。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/51c0b1f1d9313df2005f18d51b30a05a.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*C9MpE6aoX1LsjMupVXpZMg.png"/></div></figure><p id="79a3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们首先使用<em class="nt"> g.V() </em>方法通过id选择一个节点，然后使用<em class="nt">add</em>()方法从具有关系名称的给定节点中创建一个新的边。我们用<em class="nt"> to() </em>的方法将其链接到另一个节点。请注意，如果我们愿意，我们可以向关系中添加属性。</p><p id="f86b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来，我们添加一些主题:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="30ba" class="na kh it ol b gy op oq l or os">init_topics = [<br/>"g.addV('Topic').property('id', 'topic1').property('name','Machine Learning').property('pk_id', '4')",<br/>"g.addV('Topic').property('id', 'topic2').property('name','Big Data').property('pk_id', '5')",<br/>"g.addV('Topic').property('id', 'topic3').property('name','Scala').property('pk_id', '6')"<br/>]<br/>run(init_topics)</span></pre><p id="7937" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">还有一些文章:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="4508" class="na kh it ol b gy op oq l or os">init_articles = [<br/>    "g.addV('Article').property('id', 'article1').property('name','The Secrets of NLP').property('pk_id', '7').property('body', 'blah').property('tags','nlp,ml,python')",<br/>    "g.addV('Article').property('id', 'article2').property('name','Apache Spark Optimizations').property('pk_id', '8').property('body', 'blah').property('tags','none')",<br/>    "g.addV('Article').property('id', 'article3').property('name','Introduction to Scala').property('pk_id', '9').property('body', 'blah')"<br/>]<br/>run(init_articles)</span></pre><p id="31b9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">让我们将关系添加到主题，让我们将一些文章与主题和一些成员资格相关联:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="1a03" class="na kh it ol b gy op oq l or os">add_topic_relations = [<br/>    "g.V('mem1').addE('likes').to(g.V('topic1'))",<br/>    "g.V('mem1').addE('likes').to(g.V('topic2'))",<br/>    "g.V('article1').addE('has').to(g.V('topic1'))",<br/>    "g.V('article2').addE('has').to(g.V('topic2'))",<br/>    "g.V('article2').addE('has').to(g.V('topic1'))",<br/>    "g.V('article3').addE('has').to(g.V('topic3'))",<br/>]<br/>run(add_topic_relations)</span></pre><p id="06c0" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来，让我们添加阅读和发布关系:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="55e7" class="na kh it ol b gy op oq l or os">read_pub_relations = [<br/>    "g.V('user1').addE('reads').to(g.V('article1'))",<br/>    "g.V('user1').addE('reads').to(g.V('article3'))",<br/>    "g.V('user2').addE('reads').to(g.V('article2'))",<br/>    "g.V('user2').addE('publish').to(g.V('article1')).property('date', '2020-11-11')",<br/>    "g.V('user2').addE('publish').to(g.V('article3')).property('date', '2019-11-11')",<br/>    "g.V('user1').addE('publish').to(g.V('article2')).property('date', '2020-11-12')"<br/>]<br/>run(read_pub_relations)</span></pre><p id="43f5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如您所见，我们正在将 <strong class="lg iu">属性</strong>添加到发布关系中。</p><p id="ca5e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">最后，再补充一句评论:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="1a31" class="na kh it ol b gy op oq l or os">run(["g.V('user1').addE('comment').to(g.V('article1')).property('comment', 'Great Job!')"])</span></pre><p id="9e63" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">太棒了，现在您的图形数据库中有一些数据了！</p><p id="9235" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果您转到数据浏览器，您应该能够看到它:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/6dfa5bd32b8e0dde9445cc5f0ffdec2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*fggYLewdMZUWOLlnnlWjWw.png"/></div></figure><h2 id="265f" class="na kh it bd ki nb nc dn km nd ne dp kq lp nf ng ku lt nh ni ky lx nj nk lc nl bi translated">查询数据</h2><p id="4569" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如我们之前提到的，您可以使用<strong class="lg iu"> SQL </strong>或<strong class="lg iu"> Gremlin </strong> <strong class="lg iu"> DSL </strong>来执行查询。数据浏览器是测试数据模型的一个很好的工具。对于真实世界的应用程序，你将使用像Python这样的编程语言，我们也展示了如何简单易用。</p><p id="8d80" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">参考<a class="ae kf" href="https://tinkerpop.apache.org/docs/3.4.9/reference/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">文档</strong> </a>了解关于这个强大API的更多信息。</p><p id="488a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">一般来说，这些查询很容易理解，也很容易推理。例如，如果我们想找出对机器学习感兴趣的用户，我们将执行:</p><pre class="mi mj mk ml gt ok ol om on aw oo bi"><span id="0eda" class="na kh it ol b gy op oq l or os">g.V().hasLabel('Topic')<br/>.has('name','Machine Learning')<br/>.in('likes').in('has')</span></pre><p id="728d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在这里，我们寻找“主题”类型的节点，并通过“机器学习”进行过滤，然后我们使用<strong class="lg iu"> <em class="nt"> in() </em> </strong>导航到源，使用<strong class="lg iu"> <em class="nt"> out() </em> </strong>导航到目标。</p><p id="7151" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">结果是:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/468d18dd09117dfabe9308b9f40cdd34.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*YCjOPeeVqcHwbnjlfACM4w.png"/></div></figure><p id="bfde" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你可以继续玩。尝试更多的查询，添加更多的数据，不断尝试！</p><h1 id="2b80" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="e08d" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我希望你喜欢这篇文章。我真的鼓励你继续摆弄数据，并尝试模拟其他问题。还有，试试其他数据库比如<strong class="lg iu"> Neo4j </strong>。</p><p id="d70e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">图形数据库变得越来越受欢迎，这种类型的专业知识目前需求量很大。越来越多的公司已经意识到图形数据库的潜力，以及如何利用图形数据库解决大规模的复杂商业问题。</p><p id="0564" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">图形数据库极其<strong class="lg iu">灵活</strong>，<strong class="lg iu">强大</strong>，易于使用<strong class="lg iu">简单</strong>；现在，由于<strong class="lg iu">云</strong>易于设置和扩展；但是请注意，它们只适用于特定类型的数据。如果你的数据没有复杂的关系，或者太小或者太死板，那么这种类型的NoSQL数据库可能不适合你。尝试CosmosDB中的其他API，以决定哪一个更适合您的数据和查询。</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="a027" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你可以在这个<a class="ae kf" href="https://github.com/javiramos1/cosmosdb_gremlin_demo" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">库</strong> </a>中找到<strong class="lg iu">代码</strong>。</p><p id="a562" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="nt">如果你喜欢这篇文章，记得鼓掌，并关注我的更多更新！</em></p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="8294" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我希望你喜欢这篇文章。欢迎发表评论或分享这篇文章。跟随 <a class="ae kf" href="https://twitter.com/JavierRamosRod" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> <em class="nt">我</em></strong></a><strong class="lg iu"><em class="nt"/></strong><em class="nt">作未来的职务。</em></p></div></div>    
</body>
</html>
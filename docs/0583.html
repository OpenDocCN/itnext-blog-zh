<html>
<head>
<title>Calling a Webpack + babel transpiled class from outside its scope.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从其作用域之外调用Webpack + babel transpiled类。</h1>
<blockquote>原文：<a href="https://itnext.io/calling-a-es6-webpacked-class-from-outside-js-scope-f36dc77ea130?source=collection_archive---------2-----------------------#2018-04-05">https://itnext.io/calling-a-es6-webpacked-class-from-outside-js-scope-f36dc77ea130?source=collection_archive---------2-----------------------#2018-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/d6975d894828b0e718c9a4732a5333c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4_ObPSgAmbf4RCtuLlfRA.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="a496" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">当任务是创建一个加载JS应用程序的代码片段时，例如加载一个小部件，就像嵌入Google Analytics一样，你需要对Webpack配置做一些修改。</h2></div></div><div class="ab cl kq kr hu ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ij ik il im in"><p id="f9e3" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi lt translated">将Webpack包作为一个库来发布，在一个变量中给出了必要的全局上下文。我们现在可以使用这个变量从index.html文件外部调用这个库。</p><p id="0b2c" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz jc">问题？</strong></p><p id="f6c8" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">调用app.bundle.js内捆绑的类，通过Babel 6和Webpack 2使用transpiled代码在实参参数内传递数据。这将导致someFunc()未定义的错误。</p><p id="a342" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz jc">为什么这是个问题？</strong></p><p id="7546" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦ES6代码被编译成ES5捆绑包，就不能在捆绑代码之外访问该类。下面是一个简单的例子</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="ba0d" class="ml mm jb mh b gy mn mo l mp mq">&lt;!doctype html&gt;<br/>&lt;html class="no-js" lang=""&gt;<br/>    &lt;head&gt;<br/>        &lt;meta charset="utf-8"&gt;<br/>        &lt;meta http-equiv="x-ua-compatible" content="ie=edge"&gt;<br/>        &lt;title&gt;&lt;/title&gt;<br/>        &lt;meta name="description" content=""&gt;<br/>        &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        &lt;h1&gt;My index file&lt;/h1&gt;<br/>        &lt;div id="seat-selection"&gt;<br/>        &lt;script src="./dist/js/app.bundle.js"&gt;&lt;/script&gt;<br/>        &lt;script type="text/javascript"&gt;<br/>           window.onload = function(){<br/>                new someFunc(someData)<br/>            };<br/>        &lt;/script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="88cf" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz jc">解决方法？</strong></p><p id="1502" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们需要通过更改输出设置来不同地配置Webpack。这告诉我们，我们正在创建向名为EntryPoint的var公开透明的ES5代码。</p><p id="2e98" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mr"> webpack.config.js </em></p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="742d" class="ml mm jb mh b gy mn mo l mp mq">output: {<br/>    path: path.resolve(__dirname, 'dist/js'),<br/>    filename: 'app.bundle.js',<br/>    libraryTarget: 'var',<br/>    library: 'EntryPoint'<br/>  },</span></pre><p id="829e" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mr"> index.js(注意我们使用var EntryPoint来调用lib)。</em></p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="8a33" class="ml mm jb mh b gy mn mo l mp mq">&lt;script src="./dist/js/app.bundle.js"&gt;&lt;/script&gt;<br/>   &lt;script type="text/javascript"&gt;<br/>       window.onload = function(){<br/>         EntryPoint.run({ name : 'Joe Bloggs' }) <br/>       };<br/>   &lt;/script&gt;</span></pre><p id="a65e" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mr">app . js’或您的输出捆绑文件名(记住这是您的ES6文件，在它被捆绑之前)。</em></p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="fd48" class="ml mm jb mh b gy mn mo l mp mq">(function () {<br/>   'use strict';<br/>}());</span><span id="81e9" class="ml mm jb mh b gy ms mo l mp mq">import helloWorld from './helloWorld.js'; // ES6 Module</span><span id="f7a9" class="ml mm jb mh b gy ms mo l mp mq">module.exports = {<br/>  run: function (name) {<br/>    new helloWorld(name);<br/>  }<br/>};</span></pre><p id="d257" class="pw-post-body-paragraph kx ky jb kz b la lb kc lc ld le kf lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在我的一个Github项目<a class="ae mt" href="https://github.com/maxsilvauk/js-aircraft-seats-selection-widget/blob/master/webpack.config.js" rel="noopener ugc nofollow" target="_blank">中看到一个更全面的工作示例。</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Reusable Vuex Mutation Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可重复使用的Vuex变异函数</h1>
<blockquote>原文：<a href="https://itnext.io/reusable-vuex-mutation-functions-9b4920aa737b?source=collection_archive---------3-----------------------#2018-03-14">https://itnext.io/reusable-vuex-mutation-functions-9b4920aa737b?source=collection_archive---------3-----------------------#2018-03-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/56ecd7a4a55e1c1545b5e5cc5de18053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*m9NqeI1KktdXUge-h35FRg.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://flic.kr/p/T5HHt7" rel="noopener ugc nofollow" target="_blank">照片由泽维尔·罗宾</a>在Flickr上拍摄</figcaption></figure><blockquote class="jz ka kb"><p id="abdd" class="kc kd ke kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae jy" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Freusable-vuex-mutation-functions-9b4920aa737b%3Futm_source%3Dmedium_sharelink%26utm_medium%3Dsocial%26utm_campaign%3Dbuffer" rel="noopener ugc nofollow" target="_blank">点击这里在LinkedIn上分享这篇文章</a></p></blockquote><h2 id="cfbc" class="lb lc iq bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">更新</h2><p id="d91b" class="pw-post-body-paragraph kc kd iq kf b kg lx ki kj kk ly km kn lk lz kq kr lo ma ku kv ls mb ky kz la ij bi translated">下面描述的<code class="fe mc md me mf b">vuex</code>助手函数模式现在作为一个npm模块可用，<a class="ae jy" href="https://gitlab.com/rhythnic/vuex-intern" rel="noopener ugc nofollow" target="_blank"> vuex-intern </a>。</p><h2 id="e8a5" class="lb lc iq bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">介绍</h2><p id="ebed" class="pw-post-body-paragraph kc kd iq kf b kg lx ki kj kk ly km kn lk lz kq kr lo ma ku kv ls mb ky kz la ij bi translated"><a class="ae jy" href="https://vuejs.org" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>是我这些天去的前端框架。比起React组件模型，我并不太喜欢组件模型，但是Vue的中央状态管理工具Vuex与Vue组件的集成带来了非常好的开发者体验。这篇文章是关于我如何在Vuex中进行突变的。</p><p id="3e41" class="pw-post-body-paragraph kc kd iq kf b kg kh ki kj kk kl km kn lk kp kq kr lo kt ku kv ls kx ky kz la ij bi translated">这篇文章对那些熟悉Vuex的人来说更有意义，但对那些不熟悉的人来说，Vuex中的突变是一个改变状态的函数。变异函数接收状态和要进入状态的值。一般来说，这些都是简单的函数。我开始注意到它们中的很多看起来都是一样的，比如设置一个值，或者向列表中添加一个条目，所以我写了一些状态变异函数，可以用区分这些相似函数的信息来配置(定制)它们。</p><h1 id="c466" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp ln mq mr ms lr mt mu mv lv mw bi translated">例子</h1><p id="413a" class="pw-post-body-paragraph kc kd iq kf b kg lx ki kj kk ly km kn lk lz kq kr lo ma ku kv ls mb ky kz la ij bi translated">其中最简单的叫做‘集’。它只是设置了state的根级别属性。</p><p id="2582" class="pw-post-body-paragraph kc kd iq kf b kg kh ki kj kk kl km kn lk kp kq kr lo kt ku kv ls kx ky kz la ij bi translated">第一个例子是没有状态变异函数时的样子。</p><pre class="mx my mz na gt nb mf nc nd aw ne bi"><span id="16d4" class="lb lc iq mf b gy nf ng l nh ni">const state = {<br/>  prop1: null,<br/>  prop2: null<br/>}</span><span id="1b34" class="lb lc iq mf b gy nj ng l nh ni">const mutations = {<br/>  setProp1 (state, val) {<br/>    state.prop1 = val<br/>  },<br/>  setProp2 (state, val) {<br/>    state.prop2 = val<br/>  }<br/>}</span></pre><p id="6982" class="pw-post-body-paragraph kc kd iq kf b kg kh ki kj kk kl km kn lk kp kq kr lo kt ku kv ls kx ky kz la ij bi translated">让我们重构使用一个状态赋值函数。</p><pre class="mx my mz na gt nb mf nc nd aw ne bi"><span id="cdbd" class="lb lc iq mf b gy nf ng l nh ni">const set = key =&gt; (state, val) =&gt; {<br/>  state[key] = val<br/>}</span><span id="d219" class="lb lc iq mf b gy nj ng l nh ni">const mutations = {<br/>  setProp1: set('prop1'),<br/>  setProp2: set('prop2')<br/>}</span></pre><p id="7b36" class="pw-post-body-paragraph kc kd iq kf b kg kh ki kj kk kl km kn lk kp kq kr lo kt ku kv ls kx ky kz la ij bi translated">我们已经减少了一些乏味的样板代码，同时不再需要测试我们的变异函数(假设使用的状态变异函数已经过测试)。</p><h2 id="173d" class="lb lc iq bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">使用状态变异器的示例Vuex模块</h2><p id="ce30" class="pw-post-body-paragraph kc kd iq kf b kg lx ki kj kk ly km kn lk lz kq kr lo ma ku kv ls mb ky kz la ij bi translated">这里有一个例子，包括我经常使用的变异函数。实现在下面的例子中。</p><pre class="mx my mz na gt nb mf nc nd aw ne bi"><span id="4344" class="lb lc iq mf b gy nf ng l nh ni">const state = {<br/>  primitive: null,<br/>  bool: false,<br/>  list: [],<br/>  users: []<br/>}</span><span id="bffa" class="lb lc iq mf b gy nj ng l nh ni">const getters = {<br/>  // get the user by their id<br/>  userById: findByKey('users', '_id')<br/>}</span><span id="4c00" class="lb lc iq mf b gy nj ng l nh ni">const mutations = {<br/>  setPrimative: set('primative'),<br/>  toggleBool: toggle('bool'),<br/>  pushToList: pushTo('list'),<br/>  replaceUser: replaceRecordInList('users', '_id')<br/>}</span><span id="f3fb" class="lb lc iq mf b gy nj ng l nh ni">const actions = {<br/>  ...<br/>  fetchUser ({ commit }, userId) {<br/>    fetch(`https://example.com/users/${userId}`)<br/>      .then(res =&gt; res.json())<br/>      .then(user =&gt; commit('replaceUser', user))<br/>  }<br/>}</span></pre><h2 id="23c1" class="lb lc iq bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">履行</h2><p id="7432" class="pw-post-body-paragraph kc kd iq kf b kg lx ki kj kk ly km kn lk lz kq kr lo ma ku kv ls mb ky kz la ij bi translated">这些<code class="fe mc md me mf b">vuex</code>助手函数被收集在一个名为<a class="ae jy" href="https://gitlab.com/rhythnic/vuex-intern" rel="noopener ugc nofollow" target="_blank"> vuex-intern </a>的npm模块中。请到那里查看帮助器函数的完整列表和实现，并导入模块使用它们。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Elastic Beanstalk is your guy to Run Your .Net Apps on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">弹性豆茎是你的家伙来运行你的。AWS上的网络应用</h1>
<blockquote>原文：<a href="https://itnext.io/elastic-beanstalk-is-your-guy-to-run-your-net-apps-on-aws-13b6138013a9?source=collection_archive---------5-----------------------#2020-02-06">https://itnext.io/elastic-beanstalk-is-your-guy-to-run-your-net-apps-on-aws-13b6138013a9?source=collection_archive---------5-----------------------#2020-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e1e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我公司的一个小项目中，我需要将一个带有MS-SQL数据库的ASP.Net MVC应用程序部署到云中。我有几次使用微软Azure的经验，但是，由于我们已经在其他应用程序中使用了AWS，我们决定将这个应用程序部署到AWS。在这篇文章中，我想描述我所遵循的步骤以及花了我一些时间来解决的问题。</p><p id="86e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我假设你有一个AWS帐户来尝试这些步骤</em></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="1e58" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">弹性豆茎</h1><p id="967c" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated"><a class="ae lw" href="https://aws.amazon.com/elasticbeanstalk/" rel="noopener ugc nofollow" target="_blank"> Elastic Beanstalk </a>是一个让运行Java开发的应用成为可能的家伙。NET、PHP等。首先要做的是在控制台上搜索<strong class="jp ir">弹性豆茎</strong>:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi lx"><img src="../Images/b44132f046f493f1c70cbd2c8ea8afe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWzfXQyD3gZMs-hyTvLRXA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">AWS控制台</figcaption></figure><p id="1b33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击链接并导航到Elastic Beanstalk仪表板后，单击右上角的<strong class="jp ir">创建新应用程序</strong>按钮。填充弹出窗口，然后点击创建按钮。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mn"><img src="../Images/3ed888d5650beecb6cd7c53e86264cf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jaVh8GzPRDWoZJlKT2_LYg.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">新应用程序弹出窗口</figcaption></figure><p id="55d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建应用程序后，我们需要创建一个环境。在创建环境时，我们将配置Elastic Beanstalk来运行我们的ASP.NET MVC应用程序。现在，从右上角的<strong class="jp ir">动作</strong>下拉菜单中点击“创建环境”按钮，并选择“Web服务器环境”。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mo"><img src="../Images/aa1f77f55ecb7605e28012af5523f87f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xyu4qN3Gl217GXhK2-bMDQ.png"/></div></div></figure><p id="2b1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在接下来的页面中，我们将环境设置为运行ASP.Net应用程序。根据需要填充命名和其他部分，并设置平台。Net (Windows/IIS)。将应用程序代码部分保留为“简单”应用程序。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mp"><img src="../Images/bfb5c61474f284c00bec417ad5e754f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JtRx2d9iJQKaVKwQNyJxxQ.png"/></div></div></figure><p id="a2b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击“创建”按钮后，需要一段时间。完成后，您可以浏览您的简单应用程序。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="0c6c" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">设置数据库</strong></h1><p id="920f" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">从左侧菜单中，单击“配置”，滚动到页面底部。在“数据库”行中，单击“修改”按钮。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mq"><img src="../Images/eda4939e9eada95bc3f014dbb5b05cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ORRub3DBop5I2Sh-yGbKtg.png"/></div></div></figure><p id="2395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在这里创建几种类型的数据库，但我们特别需要一个MSSQN，所以选择“sqlserver-ex”。选择您需要的实例类，并设置访问数据库的用户名和密码。点击“应用”按钮，让AWS创建您的数据库。大约一分钟后，您的数据库就准备好了。</p><p id="2540" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注意:您将看到MSSQL服务器的三个选项(Express，Web &amp; SE)。在本教程中，我选择了SQL Server Express，因为我只需要一个小的。</em></p><p id="97de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当操作完成时，导航到您的数据库仪表板并获取端点信息以创建您的连接字符串。</p><h1 id="589a" class="kt ku iq bd kv kw mr ky kz la ms lc ld le mt lg lh li mu lk ll lm mv lo lp lq bi translated">上传应用程序</h1><p id="3bac" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">当您查看弹性Beanstalk仪表板时，您会看到一个名为“上传和部署”的按钮。你可以使用该功能上传你的应用，但我为此使用了一个VisualStudio的扩展。</p><p id="e26b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开Visual Studio，从顶部的扩展菜单中，单击管理扩展并搜索“AWS Toolkit”</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mw"><img src="../Images/0d6cfc08dc72f8d60a0279e6c0bc3c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQmM5OrVo0qQGeSd4umKog.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">VS的AWS扩展</figcaption></figure><p id="3772" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装完扩展后(如果不受影响，请重启)，右键单击您的应用程序项目，然后单击“发布到AWS Elastic Beanstalk”</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/0153942152f33fca1d08b64b78c1f653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*99iVI_cJMAZJZsB_EP2RwA.png"/></div></figure><p id="598d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的屏幕将询问您如何创建一个概要文件。如果您有相关权限，您可以从AWS控制台获得所有信息。如果您不知道，请咨询您的AWS管理员。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi my"><img src="../Images/778db76db21ea4afd4ce5856f16e7fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SBLgKViZ8B9wHcDk2VIPA.png"/></div></div></figure><p id="e2f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">填写表格后，您将看到您的环境已列出。单击我们刚才创建的环境，然后单击“Next”。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mz"><img src="../Images/569200359cf2f020addbcac1144f2f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HlIE8qG-2Ck6cm_cJJiDuA.png"/></div></div></figure><p id="015e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在以下屏幕中，为您的应用选择合适的参数。我为构建配置选择了“发布”,并启用了32位应用程序。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi na"><img src="../Images/0e1cbb4fc3ab684d1c5bd8567cc78104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CQpdHCaT6u8WoGakAdMnrA.png"/></div></div></figure><p id="03d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您点击“下一步”,您将看到部署前的摘要。点击“完成”，这样可以节省时间:)</p><p id="74f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以从输出窗口观察操作。该过程完成后，您可以浏览您的应用程序。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="6d8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我想指出我花了一些时间解决的一些问题:</p><p id="702a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 1 —文件夹访问</strong></p><p id="36a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ASP。Net MVC为所有人做捆绑。js和。css在启动时，但当我试图浏览应用程序时，AWS不允许它写捆绑文件。这也取消了所有的<strong class="jp ir">文件上传</strong>和将这些文件写入文件夹。</p><p id="f432" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要允许应用程序写入AWS中的特定文件夹，您需要创建一个名为<code class="fe nb nc nd ne b">.ebextensions</code>的文件夹，并在该文件夹中创建一个名为<code class="fe nb nc nd ne b">permissions.config</code>的文件。该文件应该是JSON或YAML格式。数字代表执行的顺序。</p><p id="2b00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的配置如下所示:我选择了JSON，并输入了设置相关权限的命令。要了解更多信息，请查看'<a class="ae lw" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/ebextensions.html" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">EB extensions</strong></a><strong class="jp ir">'。</strong></p><pre class="ly lz ma mb gt nf ne ng nh aw ni bi"><span id="b745" class="nj ku iq ne b gy nk nl l nm nn">{<br/> "container_commands": {<br/>  "01": {<br/>   "command": "icacls \"C:/inetpub/wwwroot/Content/cache\" /grant DefaultAppPool:(OI)(CI)F"<br/>  },<br/>  "02": {<br/>   "command": "icacls \"C:/inetpub/wwwroot/Scripts/cache\" /grant DefaultAppPool:(OI)(CI)F"<br/>  },<br/>  "03": {<br/>   "command": "icacls \"C:/inetpub/wwwroot/Content/uploads\" /grant DefaultAppPool:(OI)(CI)F"<br/>  }<br/> }<br/>}</span></pre><p id="fb16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一个小小的建议；如果你想上传文件到AWS，使用<a class="ae lw" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3桶</a>。</p><p id="9a50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2 —设置域</strong></p><p id="51aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我试着在AWS中做这件事，但是多亏了我的同事，他们通过我们ICT团队的域导航处理了这种情况。所以，我避免做领域工作。</p><p id="17f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3 —配置SSL </strong></p><p id="fe0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您获得为您的域准备的SSL证书时，您需要将它上传到AWS。导航到证书管理器。你的证书应该是PEM编码的。上传您的证书，复制您的证书内容并粘贴到<strong class="jp ir">导入证书</strong>菜单中的框中。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi no"><img src="../Images/1ad722d8e5d1c53c251c9cded1396aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aiu8aaubQZq6MwH3qcjtEQ.png"/></div></div></figure><p id="041c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上传证书后，创建一个负载平衡器来设置证书。在控制台中搜索EC2。单击“负载平衡器”并创建一个新的。</p><p id="2533" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择经典款</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi np"><img src="../Images/53638b00cff8e3c6a93618b84e4abd25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74oJRkUbxCZiF-qvx5kGHw.png"/></div></div></figure><p id="0a38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">给你的LB取一个名字，点击next直到<strong class="jp ir"> Add EC2 Instances </strong>按钮。在<strong class="jp ir">添加EC2实例中，</strong>选择您的env</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/a3ac77e42b2e49f253efafcf17866eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*ugjNRx58BLaih801M0GPsw.png"/></div></figure><p id="dd04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在检查您的设置后完成向导。</p><p id="8265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建LB后，检查实例的状态。如果它显示'<strong class="jp ir">0/1实例正在服务'</strong>'，请检查中同名的<em class="kl">健康检查</em>配置。之后，一切都应该会好起来。</p><p id="d0b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，为了设置我们之前上传的SSL证书，切换到<strong class="jp ir">监听器</strong>选项卡并添加一个新的监听器。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nr"><img src="../Images/b10749fe7ee93ee9b68145ceb18f25a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p8Ikw8Xj8yyMVoPfCSTghg.png"/></div></div></figure><p id="e5fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，为负载平衡器协议设置HTTPS。然后，从右边的列中，选择您刚才上传的SSL证书。</p><p id="28a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这些步骤的最后，你应该在<strong class="jp ir"> https </strong>中浏览你的应用。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="3496" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，我跳过了大部分配置部分，因为我不是AWS工程师。我只是想向您展示，您可以在AWS上轻松地将您的ASP.NET应用程序投入生产。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Flutter x Clean Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤振x清洁建筑</h1>
<blockquote>原文：<a href="https://itnext.io/flutter-clean-architecture-b53ce9e19d5a?source=collection_archive---------0-----------------------#2022-06-20">https://itnext.io/flutter-clean-architecture-b53ce9e19d5a?source=collection_archive---------0-----------------------#2022-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="60ba" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在本文的范围内，我假设您已经知道什么是干净的架构，以及我们为什么要使用它。</p></blockquote><h1 id="5f20" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">。/ Flutter干净的架构</h1><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/0bd0d6fae6ed8424037d06bd0bccd414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*62vHxhRxY05gbvZW5UrvOQ.png"/></div></div></figure><p id="1ca2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated">可以看到，主要有三层:<strong class="jt ir">展现</strong>、<strong class="jt ir">域</strong>和<strong class="jt ir">数据</strong>。</p><blockquote class="jn jo jp"><p id="89b1" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">R <strong class="jt ir"> ole及各层描述:</strong></p></blockquote><h2 id="0780" class="mc kq iq bd kr md me dn kv mf mg dp kz lz mh mi ld ma mj mk lh mb ml mm ll mn bi translated"><strong class="ak">一、陈述</strong></h2><p id="5608" class="pw-post-body-paragraph jq jr iq jt b ju mo jw jx jy mp ka kb lz mq ke kf ma mr ki kj mb ms km kn ko ij bi translated"><em class="js">该层没有业务逻辑处理，因此仅用于显示UI和处理事件。</em></p><p id="e25b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 1。小工具(页面)</strong></p><ul class=""><li id="a62c" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">通知BloC事件，如屏幕显示和用户触摸事件，并监听BloC发出的事件。</li></ul><p id="5889" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 2。阻塞</strong></p><ul class=""><li id="ad51" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">从视图接收事件，必要时根据事件执行用例。</li><li id="c128" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">将从UseCase接收的数据发出以供查看。</li><li id="9b99" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">BloC根本不了解View。</li></ul><h2 id="00d4" class="mc kq iq bd kr md me dn kv mf mg dp kz lz mh mi ld ma mj mk lh mb ml mm ll mn bi translated">二。领域</h2><p id="963b" class="pw-post-body-paragraph jq jr iq jt b ju mo jw jx jy mp ka kb lz mq ke kf ma mr ki kj mb ms km kn ko ij bi translated"><em class="js">这一层负责业务逻辑。</em></p><p id="7d36" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 1。用例</strong></p><ul class=""><li id="2834" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">描述用例所需的逻辑处理。</li><li id="3713" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">直接使用存储库。</li></ul><p id="7bb1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 2。译者</strong></p><ul class=""><li id="43a9" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">将模型转换成实体以便向服务器端请求，或者将实体转换成模型用于表示层。</li></ul><p id="c375" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 3。型号</strong></p><ul class=""><li id="46c3" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">一个模型将不依赖于从服务器端获取的数据。</li><li id="bae9" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">模型用于表示层。</li></ul><h2 id="2b00" class="mc kq iq bd kr md me dn kv mf mg dp kz lz mh mi ld ma mj mk lh mb ml mm ll mn bi translated">三。数据</h2><p id="4e4c" class="pw-post-body-paragraph jq jr iq jt b ju mo jw jx jy mp ka kb lz mq ke kf ma mr ki kj mb ms km kn ko ij bi translated"><em class="js">这一层负责与服务器端和数据管理逻辑通信。</em></p><p id="098d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 1。数据源</strong></p><ul class=""><li id="da56" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">描述获取和更新数据的过程。</li><li id="72fa" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">这是决定是从服务器端获取数据还是使用数据库或缓存中的数据的地方。</li></ul><p id="6bf6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 2。实体</strong></p><ul class=""><li id="b50a" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">一个实体将依赖于从服务器端获取的数据。</li><li id="15b6" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">实体不用于表示层。</li></ul><p id="a19f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 3。储存库</strong></p><ul class=""><li id="5939" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">数据层和领域层之间的桥梁。</li><li id="98ad" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">我们将在存储库中使用翻译器来转换数据。</li></ul><h1 id="d049" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">。/练习</h1><p id="dd22" class="pw-post-body-paragraph jq jr iq jt b ju mo jw jx jy mp ka kb lz mq ke kf ma mr ki kj mb ms km kn ko ij bi translated"><em class="js">为了更好地理解，我将演示一个流程，它接收来自小部件的动作，处理它，从服务器端请求/接收数据，最后将数据显示给小部件。</em></p><blockquote class="jn jo jp"><p id="0e84" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><strong class="jt ir">源代码:</strong><a class="ae nh" href="https://github.com/dubydu/fluttourII" rel="noopener ugc nofollow" target="_blank"><em class="iq">https://github.com/dubydu/fluttourII</em></a></p></blockquote><p id="86d1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 1。数据层</strong></p><ul class=""><li id="4a1d" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建一个<strong class="jt ir">实体。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><blockquote class="jn jo jp"><p id="b76d" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在<a class="ae nh" href="https://github.com/dubydu/fluttourII/blob/master/lib/data/api/api_client/api_client_type.dart" rel="noopener ugc nofollow" target="_blank"><em class="iq">API _ client _ type . dart</em></a>中，定义一个<strong class="jt ir"> HTTP请求</strong>如下:</p></blockquote><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="8a40" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">然后，打开你的终端，运行这个命令:<code class="fe nk nl nm nn b">make gen</code>，<a class="ae nh" href="https://pub.dev/packages/retrofit" rel="noopener ugc nofollow" target="_blank">，<em class="js">改型</em>，</a>将承担剩下的责任。您也可以通过编辑这个<a class="ae nh" href="https://github.com/dubydu/fluttourII/blob/master/Makefile" rel="noopener ugc nofollow" target="_blank"> <em class="js"> Makefile </em> </a> <em class="js">来自定义命令行。</em></li><li id="3041" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">定义<strong class="jt ir">数据源。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="4ef2" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">实现<strong class="jt ir">存储库。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="c78b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 2。领域层</strong></p><ul class=""><li id="f8b2" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建<strong class="jt ir">模型。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="869e" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">定义<strong class="jt ir">译者。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="62cb" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">执行<strong class="jt ir">用例。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="7e89" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 3。表示层</strong></p><ul class=""><li id="7f04" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">定义<strong class="jt ir">区块。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="d7e7" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">实现<strong class="jt ir">小部件。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="fd42" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> 4。迪</strong></p><blockquote class="jn jo jp"><p id="7c36" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">让我们的代码变得更加模块化。😎</p></blockquote><ul class=""><li id="b920" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建<strong class="jt ir">配置模块。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="6050" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建<strong class="jt ir">客户端模块。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="1b44" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建<strong class="jt ir">数据源_模块。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="d8b4" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建<strong class="jt ir">储存库_模块。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="ecf2" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">创建<strong class="jt ir">用例模块。</strong></li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><ul class=""><li id="6ea8" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">将<strong class="jt ir">用例</strong>注入到<a class="ae nh" href="https://github.com/dubydu/fluttourII/blob/master/lib/my_app.dart" rel="noopener ugc nofollow" target="_blank"> my_app.dart </a>中的<strong class="jt ir"> BloC </strong>中，符合所有模块。</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="791d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lz kd ke kf ma kh ki kj mb kl km kn ko ij bi translated">仅此而已，运行项目，看看会发生什么！</p><h1 id="7ad0" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">陷阱</h1><p id="655f" class="pw-post-body-paragraph jq jr iq jt b ju mo jw jx jy mp ka kb lz mq ke kf ma mr ki kj mb ms km kn ko ij bi translated">为了运行这个项目，您需要在特定的环境中运行。</p><ul class=""><li id="9a7d" class="mt mu iq jt b ju jv jy jz lz mv ma mw mb mx ko my mz na nb bi translated">发展:<code class="fe nk nl nm nn b">flutter run -t lib/main_dev.dart</code></li><li id="f718" class="mt mu iq jt b ju nc jy nd lz ne ma nf mb ng ko my mz na nb bi translated">生产:<code class="fe nk nl nm nn b">flutter run -t lib/main_prod.dart</code></li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h2 id="36b1" class="mc kq iq bd kr md me dn kv mf mg dp kz lz mh mi ld ma mj mk lh mb ml mm ll mn bi translated">2022年6月29日更新</h2><ul class=""><li id="6838" class="mt mu iq jt b ju mo jy mp lz nv ma nw mb nx ko my mz na nb bi translated">使用<a class="ae nh" href="https://github.com/dubydu/fluttourII/commit/7a8bea0be7c1b891749e15a30a6e26dc815635ae" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">面向协议的编程</strong> </a>代替<a class="ae nh" href="https://github.com/dubydu/fluttourII/commit/f6d581fbf6c788b7579aef9a5073fbe72f011180" rel="noopener ugc nofollow" target="_blank">服务定位器模式</a>。</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h2 id="528c" class="mc kq iq bd kr md me dn kv mf mg dp kz lz mh mi ld ma mj mk lh mb ml mm ll mn bi translated">2022年7月31日更新</h2><ul class=""><li id="df84" class="mt mu iq jt b ju mo jy mp lz nv ma nw mb nx ko my mz na nb bi translated">实现了<a class="ae nh" href="https://github.com/dubydu/fluttourII/tree/graphql" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir"> GraphQL客户端</strong> </a></li></ul></div></div>    
</body>
</html>
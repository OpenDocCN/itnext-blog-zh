<html>
<head>
<title>Make a signing pad in Angular &amp; Vanilla js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Angular &amp; Vanilla js做一个签名簿</h1>
<blockquote>原文：<a href="https://itnext.io/make-a-signing-pad-in-angular-vanilla-js-7a3eb7e0599d?source=collection_archive---------2-----------------------#2022-08-05">https://itnext.io/make-a-signing-pad-in-angular-vanilla-js-7a3eb7e0599d?source=collection_archive---------2-----------------------#2022-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bf83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何在Angular中制作签名板并将数字签名存储在服务器中</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/51e5c1fa25bc5bc3bad944f8fa57e069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRNosYb7hrwY-qJ5wlXL3Q.png"/></div></div></figure><p id="aaa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好世界！</p><p id="e1ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将与您分享如何使用Canvas在Angular中创建签名板，以及如何将签名保存为图像以供将来使用。</p><p id="6ffe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原理很简单，我们将创建一个<a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas" rel="noopener ugc nofollow" target="_blank">画布</a>，并在上面绘制我们的签名，瞧！</p><p id="6b32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是怎么做呢？别担心，我会详细解释的:)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/810347d6f355f964e2b99560757c931a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*vye7m_7YrfIOK3Mwss5JgA.gif"/></div></figure><p id="3cda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对了，荷马，这不是握笔的正确方式！</p><p id="1f89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所知，荷马的签名来自其手/笔的运动；在我们的例子中，我们需要跟随计算机的鼠标在画布上的移动，并且由于<strong class="jp ir"> MouseMove </strong>事件，Angular将通知我们并给我们光标的坐标:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kz"><img src="../Images/712eb012d7eabe4064f6a5eb85dfd33c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3HGknL5WtU41ZOKjiJMCA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">鼠标事件</figcaption></figure><p id="2a6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，clientX et和clientY是光标的坐标，这将帮助我们使用<a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D" rel="noopener ugc nofollow" target="_blank"> CanvasRenderingContext2D </a>在画布上绘制签名。</p><blockquote class="le lf lg"><p id="313c" class="jn jo lh jp b jq jr js jt ju jv jw jx li jz ka kb lj kd ke kf lk kh ki kj kk ij bi translated">作为<a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API" rel="noopener ugc nofollow" target="_blank"> Canvas API </a>的一部分，<code class="fe ll lm ln lo b">CanvasRenderingContext2D</code>接口为<code class="fe ll lm ln lo b"><a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas" rel="noopener ugc nofollow" target="_blank">&lt;canvas&gt;</a></code>元素的绘制表面提供了2D渲染上下文。它用于绘制形状、文本、图像和其他对象。</p></blockquote><p id="0f5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，对于每个事件，我们将使用<code class="fe ll lm ln lo b"><a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineTo" rel="noopener ugc nofollow" target="_blank">CanvasRenderingContext2D.lineTo(</a>)</code>函数绘制一条线，将当前点(当前事件坐标)与最后注册的点连接起来；我们需要不断重复同样的操作，直到我们画完签名:</p><pre class="km kn ko kp gt lp lo lq bn lr ls bi"><span id="c450" class="lt lu iq lo b be lv lw l lx ly">  onMouseMove(e: any): void {<br/>    if (this.isDrawing) {<br/>      const coords = this.relativeCoords(e);<br/>      this.context.lineTo(coords.x, coords.y);<br/>      this.context.stroke();<br/>    }<br/>  }</span></pre><p id="0d83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">坚持住！我们现在知道了绘图是如何工作的，但是我们如何检测签名的开始和结束呢？答案是MouseUp和MouseDown事件❤；</p><p id="0f7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MouseDown表示我们开始按住鼠标按钮，这代表开始绘制签名(isDrawing = true)而当我们释放按钮时触发MouseUp，这代表签名的结束(isDrawing = false)！</p><pre class="km kn ko kp gt lp lo lq bn lr ls bi"><span id="7c09" class="lt lu iq lo b be lv lw l lx ly">  onMouseDown(e: any): void {<br/>    // The mouse button is clicked, which means the start of drawing the signature<br/>    this.isDrawing = true;<br/>    const coords = this.relativeCoords(e);<br/>    this.context.moveTo(coords.x, coords.y);<br/>  }<br/><br/>  @HostListener('document:mouseup', ['$event'])<br/>  onMouseUp(e: any): void {<br/>    // The mouse button is released, so this means the end of drawing the signature<br/>    this.isDrawing = false;<br/>  }</span></pre><p id="b35a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些用鼠标就能完美完成！但是我们需要在手机或者平板上用手指签什么呢？</p><p id="ea13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前面的代码可能不起作用，但是有一个解决方案可以让我们完成我们的解决方案！touchstart和touchmove事件！touchstart和touchmove的工作方式与mousedown和mousemove事件非常相似。</p><p id="39be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，为了将绘图/签名转换成图像，Canvas API提供了一个函数<a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL" rel="noopener ugc nofollow" target="_blank"> toDataURL() </a>:</p><pre class="km kn ko kp gt lp lo lq bn lr ls bi"><span id="1bdd" class="lt lu iq lo b be lv lw l lx ly">this.signatureImg = this.sigPadElement.toDataURL('image/png');</span></pre><p id="f53e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的最终代码是:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="ad4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，这里是结果:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mb"><img src="../Images/f0f676148fb9a3cabb03525b2a81ec7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qMFjACsSMO56ieQD8otQmg.gif"/></div></div></figure><p id="c883" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自己试试:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mc ma l"/></div></figure><p id="e99b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Github上的项目:</p><div class="md me gp gr mf mg"><a href="https://github.com/adnanelamghari/signing-pad" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd ir gy z fp ml fr fs mm fu fw ip bi translated">GitHub-adnanelamghari/Signature-pad:使用画布的Angular签名板</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">此项目是使用Angular CLI版本14.0.3生成的。为开发服务器运行ng serve。导航到…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu kv mg"/></div></div></a></div></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="181f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">奖金</strong></p><p id="43cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是^^的香草版本</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lz ma l"/></div></figure></div></div>    
</body>
</html>
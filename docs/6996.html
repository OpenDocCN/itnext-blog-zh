<html>
<head>
<title>Automate generating an Avro Schema from a Spark Dataframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Spark数据帧自动生成Avro模式</h1>
<blockquote>原文：<a href="https://itnext.io/automate-generating-avro-schemas-from-a-spark-dataframe-6e8956f03500?source=collection_archive---------3-----------------------#2022-05-10">https://itnext.io/automate-generating-avro-schemas-from-a-spark-dataframe-6e8956f03500?source=collection_archive---------3-----------------------#2022-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2010" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个有用的脚本，可以将你的Spark模式转换成Avro格式，从而将数据转换成Kafka格式</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dd8e52acad5b91f869cfec4c181e65a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jj0GZROvPzRVQO4cpHjZWA.png"/></div></div></figure><p id="3e90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您在数据架构中使用Spark，并希望将数据从dataframe生成到Kafka中，您需要首先编写一个Avro模式。数据帧的模式遵循Spark类型系统，因此必须转换为Avro格式。这个过程并不特别困难，但是当数据帧有许多维时，它变得非常耗时。当你试图用错误的Avro模式从Spark写入Kafka时，你得到的错误消息有时也有点含糊不清，任何错误，如遗漏了一个卷毛或没有正确拼写一个字段，都有可能占用你很大一部分时间。因此，我觉得有必要创建一个小脚本来消除这个过程中的人为错误，并减少花费在手动可重复任务上的时间。</p><p id="afcd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以事不宜迟，这里是可扩展/可重用的脚本:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="baae" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种映射覆盖了最常用的类型，使一切都可以为空，但是如果你想转换一个合适的类型或者使一个字段不可以为空，你可以扩展或者修改这个脚本。我在本文下面留下了Spark和Avro打字系统文档的链接。</p><p id="39b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">希望这篇简短的文章对你有用，当我有时间练习Leetcode的时候，在另一篇类似的文章中再见！</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><ul class=""><li id="a438" class="lw lx iq kt b ku kv kx ky la ly le lz li ma lm mb mc md me bi translated">火花数据类型参考:<a class="ae mf" href="https://spark.apache.org/docs/latest/sql-ref-datatypes.html" rel="noopener ugc nofollow" target="_blank">https://spark.apache.org/docs/latest/sql-ref-datatypes.html</a></li><li id="7ae7" class="lw lx iq kt b ku mg kx mh la mi le mj li mk lm mb mc md me bi translated">Avro原语&amp;逻辑类型参考:<a class="ae mf" href="https://avro.apache.org/docs/current/spec.html#schema_primitive" rel="noopener ugc nofollow" target="_blank">https://avro . Apache . org/docs/current/spec . html # schema _ Primitive</a></li></ul></div></div>    
</body>
</html>
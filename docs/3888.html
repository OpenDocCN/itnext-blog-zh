<html>
<head>
<title>Fixing security vulnerabilities in npm dependencies in less than 3 mins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在不到3分钟的时间内修复npm依赖关系中的安全漏洞</h1>
<blockquote>原文：<a href="https://itnext.io/fixing-security-vulnerabilities-in-npm-dependencies-in-less-than-3-mins-a53af735261d?source=collection_archive---------0-----------------------#2020-03-19">https://itnext.io/fixing-security-vulnerabilities-in-npm-dependencies-in-less-than-3-mins-a53af735261d?source=collection_archive---------0-----------------------#2020-03-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4d0c05ea6c3f7c0c66378429b5258dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*immP4U8mwMmgofYMCaS2ZA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://miro.medium.com/max/1021/1*MrEp6Y0l1B7Ixt5mfE3fWA.png" rel="noopener">https://miro . medium . com/max/1021/1 * mrep 6y 0 l 1 b 7 ixt 5 mfe 3 fwa . png</a></figcaption></figure><p id="5df7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大家好。！！🥑</p><p id="7383" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我已经有一段时间没有写博客了，现在因为我们大多数人都在家工作，过去通勤的时间现在节省了，我想为什么不利用这段时间写一写我最近修复安全漏洞的经历。</p><p id="5379" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，如果你们中的任何人最近看到了类似下面这张图片的东西，却不知道如何修复它，那么这篇文章就是为你准备的。当我看到它的时候，我也没有头绪，但是通过一些研究，我可以解决这个问题。</p><h1 id="60f1" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">🔬问题:</h1><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/765026580ab76f1daadd7f5d5c34a9a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwuFd3y589IdegaHW2tJRA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">github安全漏洞bot警报</figcaption></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="dba7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以这意味着你的<strong class="ki iu">包中的一个依赖项。json </strong>有一些安全隐患，可能被攻击者利用，并可能给你、你的产品、你的产品的用户或你工作的公司带来问题。</p><p id="8cf6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">比如:<a class="ae kf" href="https://snyk.io/vuln/npm:eslint:20180222" rel="noopener ugc nofollow" target="_blank">https://snyk.io/vuln/npm:eslint:20180222</a></p><blockquote class="mo mp mq"><p id="0cce" class="kg kh mr ki b kj kk kl km kn ko kp kq ms ks kt ku mt kw kx ky mu la lb lc ld im bi translated">此漏洞可能导致了<strong class="ki iu">正则表达式拒绝服务</strong></p></blockquote></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="eaef" class="le lf it bd lg lh mv lj lk ll mw ln lo lp mx lr ls lt my lv lw lx mz lz ma mb bi translated">💡调查结果:</h1><p id="44e7" class="pw-post-body-paragraph kg kh it ki b kj na kl km kn nb kp kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">为了发现回购中的潜在漏洞，您可以</p><ol class=""><li id="3585" class="nf ng it ki b kj kk kn ko kr nh kv ni kz nj ld nk nl nm nn bi translated"><code class="fe no np nq nr b">npm audit</code> —应该会显示如下图所示的输出:</li></ol><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ae9a46a9cdc4e2e08378a1a203c4ae4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*dDaT1UDiV6rtfQMXF5umAQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">npm审核日志</figcaption></figure><p id="8cf2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2) Github安全策略也可以通知您—如下图所示:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/c5a683fb3fd40912b78cde9f99ffc56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfhzeRuKnF5ngBG0dEdFKw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">github安全警报</figcaption></figure><p id="8612" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天当我开始工作时，我不得不处理这个错误，其中<code class="fe no np nq nr b">acorn</code>和<code class="fe no np nq nr b">minimist</code>被报告为安全漏洞。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="1871" class="le lf it bd lg lh mv lj lk ll mw ln lo lp mx lr ls lt my lv lw lx mz lz ma mb bi translated">🎉解决办法</h1><p id="61d9" class="pw-post-body-paragraph kg kh it ki b kj na kl km kn nb kp kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">这个问题的解决方法是分步骤的</p><p id="50e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">📦<strong class="ki iu">国家预防机制更新</strong></p><ol class=""><li id="f544" class="nf ng it ki b kj kk kn ko kr nh kv ni kz nj ld nk nl nm nn bi translated">这是你应该做的第一件事，也是最简单的一件事。</li></ol><ul class=""><li id="8913" class="nf ng it ki b kj kk kn ko kr nh kv ni kz nj ld nu nl nm nn bi translated">运行npm更新—<a class="ae kf" href="https://docs.npmjs.com/cli-commands/update.html" rel="noopener ugc nofollow" target="_blank">https://docs.npmjs.com/cli-commands/update.html</a></li><li id="8c22" class="nf ng it ki b kj nv kn nw kr nx kv ny kz nz ld nu nl nm nn bi translated">删除您的package-lock.json文件，或者对于yarn用户，删除您的yarn.lock文件。在理想的情况下，这是可行的，但是可能会有一些不遵循semver的依赖项，并且也可能会被更新。</li><li id="9ffc" class="nf ng it ki b kj nv kn nw kr nx kv ny kz nz ld nu nl nm nn bi translated">因此，这里更好的解决方案是只删除package-lock.json(或yarn.lock)文件中与易受攻击的包相对应的行。</li><li id="a448" class="nf ng it ki b kj nv kn nw kr nx kv ny kz nz ld nu nl nm nn bi translated">再次运行npm安装</li></ul><p id="ef2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在理想的情况下，这应该已经将您的依赖项升级到了下一个semver版本，并且那些库可能已经修复了这些可传递依赖项的版本。</p><p id="c082" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">🔭<strong class="ki iu">国家预防机制审计</strong></p><p id="d485" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.但是如果这没有解决您的问题，也就是说<code class="fe no np nq nr b">minimist</code>没有解决我的问题，那么请遵循下面提到的步骤:</p><p id="f12f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.1)要修复任何依赖关系，您需要首先知道哪个npm包依赖于它。</p><pre class="md me mf mg gt oa nr ob oc aw od bi"><span id="187c" class="oe lf it nr b gy of og l oh oi">npm audit</span></pre><p id="54a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将告诉你哪些包是易受攻击的。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ae9a46a9cdc4e2e08378a1a203c4ae4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*dDaT1UDiV6rtfQMXF5umAQ.png"/></div></figure><p id="2c1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这告诉我,<code class="fe no np nq nr b">mkdirp</code>需要<code class="fe no np nq nr b">minimist</code>,而<code class="fe no np nq nr b">mocha</code>也需要它</p><p id="6b23" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">快速浏览package-lock.json可以获得关于受影响版本的更多信息。</p><blockquote class="mo mp mq"><p id="0354" class="kg kh mr ki b kj kk kl km kn ko kp kq ms ks kt ku mt kw kx ky mu la lb lc ld im bi translated">在我的情况下，mocha(7 . 1 . 0)-&gt; mkdirp(0 . 5 . 1)-&gt; minimit(0 . 0 . 8)-脆弱的版本。</p></blockquote><p id="3abb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">🔑<strong class="ki iu">分辨率键</strong></p><p id="6a76" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3)最后的解决方案是:</p><p id="c8d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.1)首先npm安装非易受攻击的版本，在我的例子中是<code class="fe no np nq nr b">1.2.5</code></p><pre class="md me mf mg gt oa nr ob oc aw od bi"><span id="2d69" class="oe lf it nr b gy of og l oh oi">npm install minimist --save-dev</span></pre><p id="2f2b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe no np nq nr b">yarn</code>和<code class="fe no np nq nr b">npm</code>用户</p><p id="9c2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.2)在package.json文件中添加一个<code class="fe no np nq nr b">resolutions</code>键</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="5e70" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于用户来说，我们还需要一个步骤来让resolutions键起作用。</p><p id="2021" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.3)使用<code class="fe no np nq nr b">npm-force-resolutions</code>(<a class="ae kf" href="https://www.npmjs.com/package/npm-force-resolutions" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/npm-force-resolutions</a>)</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="4262" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.4)运行后</p><pre class="md me mf mg gt oa nr ob oc aw od bi"><span id="37fd" class="oe lf it nr b gy of og l oh oi">npm install</span></pre><p id="77c4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样。这解决了无法使用npm更新或通过卸载并重新安装新的依赖关系来更新的依赖关系问题。</p><p id="57c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查依赖关系是否正常工作</p><pre class="md me mf mg gt oa nr ob oc aw od bi"><span id="158b" class="oe lf it nr b gy of og l oh oi">npm ls minimist</span></pre><p id="bcb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这应该会给你一个输出如下图</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/f4067965dc0d2426a532b61882c2ae4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*adqZwPcPOH8kkg9Vp9H5tw.png"/></div></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="6791" class="le lf it bd lg lh mv lj lk ll mw ln lo lp mx lr ls lt my lv lw lx mz lz ma mb bi translated">⚠️ <strong class="ak">免责声明</strong></h1><blockquote class="mo mp mq"><p id="bd23" class="kg kh mr ki b kj kk kl km kn ko kp kq ms ks kt ku mt kw kx ky mu la lb lc ld im bi translated">如果一些软件包只与旧版本兼容，那么这种变化可能会破坏你的应用程序。因此，在解析到特定版本时要小心，并在发布此更改之前测试您的应用程序。</p></blockquote></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="e1c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">👯如果你觉得这篇文章有帮助，请给它一个掌声！</p><p id="902c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更多更新可以在twitter <a class="ae kf" href="https://twitter.com/VivekNayyar09" rel="noopener ugc nofollow" target="_blank"> @VivekNayyar09 </a>关注我。我在<a class="ae kf" href="https://www.qoala.app/id" rel="noopener ugc nofollow" target="_blank"> Qoala App </a>工作</p><p id="3ecb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，请不要忘记保持社交距离，以防止病毒传播，并定期洗手。注意安全，呆在家里。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="6e9d" class="le lf it bd lg lh mv lj lk ll mw ln lo lp mx lr ls lt my lv lw lx mz lz ma mb bi translated">关于Qoala</h1><h1 id="f1b3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">阿修兰西</h1><p id="ec62" class="pw-post-body-paragraph kg kh it ki b kj na kl km kn nb kp kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">保险公司和城市保险公司的首要任务是:</p><p id="2f0c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">a.让城市的所有居民，无论是农民还是城市的所有居民，都能享受到他们从未享受过的生活；阿陶</p><p id="45e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b.为增加或减少贫困的人提供一个有价值的和/或有价值的福利。</p><p id="83bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">美国保险公司正在寻找一种新的保险:</p><p id="6941" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">a.risiko。</p><p id="da79" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b. Pertanggungan ulang risiko.</p><p id="1f03" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">c. Pemasaran dan distribusi produk asuransi atau produk asuransi syariah.</p><p id="7775" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">d. Konsultasi dan keperantaraan asuransi, asuransi syariah, reasuransi, atau reasuransi syariah, atau</p><p id="dfd4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">e. Penilai kerugian asuransi atau asuransi syariah.</p><p id="f994" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Usaha perasuransian dilaksanakan oleh:</p><p id="57db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">1. Perusahaan Asuransi:</p><p id="166c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">​a. Perusahaan Asuransi Umum, adalah perusahaan yang memberikan jasa pertanggungan risiko yang memberikan penggantian karena kerugian, kerusakan, biaya yang timbul, kehilangan keuntungan, atau tanggung jawab hukum kepada pihak ketiga yang mungkin diderita tertanggung atau pemegang polis karena terjadinya suatu peristiwa yang tidak pasti.</p><p id="0db7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b. Perusahaan Asuransi Jiwa, adalah perusahaan yang memberikan jasa dalam penanggulangan risiko yang memberikan pembayaran kepada pemegang polis, tertanggung, atau pihak lain yang berhak dalam hal tertanggung meninggal dunia atau tetap hidup, atau pembayaran lain kepada pemegang polis, tertanggung, atau pihak lain yang berhak pada waktu tertentu yang diatur dalam perjanjian, yang besarnya telah ditetapkan dan/atau didasarkan pada hasil pengelolaan dana.</p><p id="4797" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">c. Perusahaan Reasuransi, adalah perusahaan yang memberikan jasa dalam pertanggungan ulang terhadap risiko yang dihadapi oleh Perusahaan Asuransi Kerugian, Perusahaan Asuransi Jiwa, Perusahaan Penjaminan, atau Perusahaan Reasuransi lainnya.</p><p id="2a59" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2. Penunjang Usaha Asuransi:</p><p id="1349" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">a. Perusahaan Pialang Asuransi, adalah perusahaan yang memberikan jasa keperantaraan dalam penutupan asuransi atau asuransi syariah dan penanganan penyelesaian ganti rugi asuransi dengan bertindak untuk kepentingan tertanggung.</p><p id="3c62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b. Perusahaan Pialang Reasuransi, adalah perusahaan yang memberikan jasa keperantaraan dalam penempatan reasuransi dan penanganan penyelesaian ganti rugi reasuransi dengan bertindak untuk kepentingan perusahaan asuransi, perusahaan penjaminan, perusahaan reasuransi.</p><p id="7b3f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">c. Perusahaan Penilai Kerugian Asuransi, adalah perusahaan yang memberikan jasa penilaian terhadap klaim dan/atau jasa konsultasi atas obyek asuransi yang dipertanggungkan.</p></div></div>    
</body>
</html>
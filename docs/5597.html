<html>
<head>
<title>Learn TDD with Integration Tests in .NET 5.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过集成测试学习TDD。NET 5.0</h1>
<blockquote>原文：<a href="https://itnext.io/learn-tdd-with-integration-tests-in-net-5-0-937f126e7220?source=collection_archive---------1-----------------------#2021-04-13">https://itnext.io/learn-tdd-with-integration-tests-in-net-5-0-937f126e7220?source=collection_archive---------1-----------------------#2021-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0786" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">开发一个真实世界的病人入院系统</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/cad3b0f22e1612e64f7b6f9e4bc7a865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gpzzW46qAoRm55ZyYOL1g.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">用TDD组织</figcaption></figure><p id="562b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">TDD(测试驱动开发)在技术行业是一个备受争议的词。像<em class="le">你是否应该做TDD这样的争论？</em>或<em class="le">有多大优势？</em>相当受欢迎。简单地说，TDD是开发前的测试。</p><p id="62a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，关于什么类型的测试包括在TDD中，什么不包括在TDD中，有许多不同的观点。例如，它应该包括单元测试、集成测试、系统测试甚至UAT吗？</p><p id="bdf9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将通过一个真实的例子来说明如何在。NET 5.0与TDD方法论。</p><h1 id="36b4" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">项目要求</h1><p id="b17d" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">TDD要求对工作范围有非常清晰的理解。如果不清晰，所有的测试用例可能都不会被覆盖。</p><p id="6312" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们来定义一下工作范围。我们将为一家医院开发一个<em class="le">病人入院系统</em>。</p><h2 id="3b51" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">业务需求</h2><ul class=""><li id="bcdc" class="mu mv it js b jt md jx me kb mw kf mx kj my kn mz na nb nc bi translated">一家医院有X间ICU病房、Y间高级病房和Z间普通病房。</li><li id="7047" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">ICU和高级病房一次只能容纳一名患者，而普通病房可以容纳两名患者。每个房间都有房间号。</li><li id="2f5b" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">入院时，病人必须提供姓名、年龄、性别和电话号码。</li><li id="fc00" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">可以通过姓名或电话号码搜索患者。</li><li id="4f49" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">同一患者不能在住院期间入住多张病床。</li><li id="e47b" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">如果所有的房间都住满了，病人就不能住院。</li></ul><h2 id="4753" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">模型验证规则</h2><p id="638b" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">基于上述要求，有两种模式，即病人和房间。</p><ul class=""><li id="14f4" class="mu mv it js b jt ju jx jy kb ni kf nj kj nk kn mz na nb nc bi translated">病人的年龄在0到150岁之间。名称的长度应该在2到40之间。性别可以是男性、女性和其他。电话号码的长度应该在7到12之间，并且应该都是数字。</li><li id="4f9f" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">房间类型可以是“ICU”、“高级”或“普通”。</li></ul><h2 id="d368" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">测试案例</h2><p id="0674" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">现在，我们已经定义了规则和需求，让我们开始创建测试用例。因为这是一个基本的CRUD应用程序，所以我们主要进行集成测试。</p><p id="2b5b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">病人</p><ul class=""><li id="d3b5" class="mu mv it js b jt ju jx jy kb ni kf nj kj nk kn mz na nb nc bi translated">做所有的模型验证测试。</li><li id="cd43" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">同一病人入院两次</li><li id="2e7f" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">两次检查同一个病人。</li><li id="d50d" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">允许同一患者同时进入多个房间。</li><li id="95ac" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">用电话号码和姓名搜索患者。</li></ul><h1 id="fd7e" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">TDD设置</h1><p id="26ec" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在上面的部分中，我们收集了需求。其次，我们定义了模型。最后，我们创建了将要实现的测试用例列表。</p><p id="1648" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开您的终端并运行下面的脚本来创建和设置一个新项目。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="6d8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的脚本创建了一个名为<em class="le"> TDD.sln </em>的解决方案文件。其次，我们为TDD &amp; TDD.Tests创建2个项目，然后我们为每个项目添加依赖项。最后，我们将项目添加到解决方案中，并在VS代码中打开项目。</p><p id="c887" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们开始测试之前，还需要一些设置。基本上，集成测试是在不模仿的情况下测试特定的模块。所以我们将通过TestServer来模拟我们的应用程序。</p><h2 id="718c" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">定制晶片</h2><p id="bcd1" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">为了模仿测试服务器，有一个名为<a class="ae nn" href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.testing.webapplicationfactory-1?view=aspnetcore-5.0" rel="noopener ugc nofollow" target="_blank">web application factory</a>(WAF)的类在内存中引导应用程序。</p><p id="712b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在你的<strong class="js iu"> <em class="le"> TDD。测试</em>项目用下面的代码创建一个名为<em class="le"> PatientTestsDbWAF.cs </em>的文件。</strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="9d30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们正在删除应用程序DbContext，并在内存中添加一个<strong class="js iu">db context。这是一个必要的步骤，因为我们不想干扰原始数据库。</strong></p><p id="a9e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其次，我们用一些虚拟数据初始化数据库。</p><p id="5acb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于DataContext是一个自定义类，它会给编译器带来错误。所以，我们需要创造它。</p><h2 id="837d" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">数据上下文</h2><p id="631a" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">因此，在您的<strong class="js iu"> TDD项目</strong>中，用下面的代码创建一个名为<em class="le"> DataContext.cs </em>的文件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="75a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，Patient、Room &amp; RoomPatient是具有所需属性的实体类，我们将在接下来创建它们。</p><h2 id="0c59" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">病人</h2><p id="e90f" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">同样，在您的<strong class="js iu"> TDD项目</strong>中，创建一个名为<em class="le"> Patient.cs </em>的文件，并粘贴以下代码。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="0670" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">房间</h2><p id="8620" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">用下面的代码创建另一个名为<em class="le"> Room.cs </em>的文件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="944c" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">病房病人</h2><p id="3dfa" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">用下面的代码创建最后一个模型文件<em class="le"> RoomPatient.cs </em>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="30c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在你不应该得到任何编译错误。</p><p id="9ca6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，删除<em class="le"> WeatherForecast.cs </em>和<em class="le">weather forecast controller . cs</em>文件。</p><p id="4f4c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在VS代码中进入您的终端，运行下面的命令。</p><pre class="kp kq kr ks gt no np nq nr aw ns bi"><span id="cb2f" class="mi lg it np b gy nt nu l nv nw">cd TDD.Tests<br/>dotnet test</span></pre><p id="2690" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您将看到一个漂亮的绿色结果，表示1项测试通过。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/e7300bc6c43a3ca78156273171b1a691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fuFuHk87ghnM4Gog"/></div></div></figure><h2 id="77ef" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">患者控制器</h2><p id="955a" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">不幸的是。NET没有提供直接测试模型本身的方法。因此，我们必须创建一个控制器来测试它。</p><p id="7349" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">继续使用下面的代码在<strong class="js iu"> TDD项目</strong>的Controllers文件夹中创建<em class="le"> PatientController.cs </em>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="cd83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们创建了一个api来添加一个病人。为了测试我们的模型，我们将调用这个api。</p><p id="9119" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是开始测试所需的全部内容。</p><h1 id="2e06" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">模型验证测试</h1><p id="5f1c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">既然我们已经设置了测试的基本代码，让我们编写一个失败的测试。我们将从模型验证测试开始我们的测试。</p><h2 id="721b" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">失败(红色)状态</h2><p id="c64a" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">让我们在您的<strong class="js iu"> TDD中创建一个名为<em class="le"> PatientTests.cs </em>的新文件。测试项目</strong>并删除名为<em class="le"> UnitTest1.cs </em>的文件。将下面的代码复制到你的文件中。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="aa99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">属性允许我们为我们的测试提及不同的参数。因此，我们不必为所有的组合编写不同的测试。</p><p id="e94f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，DBUtilities是一个实用程序类，用于将数据库重新初始化到其初始状态。当我们有1或2个测试时，这可能看起来微不足道，但是当我们添加更多的测试时，这就变得至关重要了。</p><h2 id="34df" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">DBUtilities</h2><p id="b59f" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">DBUtilities类将用1个病人和3个不同类型的房间初始化您的数据库。</p><p id="8965" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在您的<strong class="js iu"> <em class="le"> TDD中创建一个名为<em class="le"> DBUtilities.cs </em>的文件。用下面的代码测试</em>项目。</strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="1182" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">继续运行<strong class="js iu"> <em class="le"> dotnet test </em> </strong>命令，您将看到1个测试通过，4个测试失败。这是因为4个测试预期的是BadRequest，但得到的是Created结果。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/1c89f530b2ef84f85dbe2570bd33b6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EZFegovspaIgy03s"/></div></div></figure><p id="f5a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们修理它！</p><h2 id="8dab" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">成功(绿色)状态</h2><p id="2e02" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">为了解决这些问题，我们需要向我们的<em class="le"> Patient.cs </em>类添加属性。</p><p id="a789" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如下更新<em class="le"> Patient.cs </em>文件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="16e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里，我们已经添加了所需的属性。我们还实现了<em class="le"> IValidatableObject </em>接口，这样我们就可以验证<em class="le">性别</em>。</p><p id="8410" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行<strong class="js iu"> <em class="le">点网测试</em> </strong>命令的时间。您将看到一条漂亮的绿线，表示通过了8项测试。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/f2cf2455edb479686fb0ac5b990bd7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*anj8BZTqSYlXpWA0"/></div></div></figure><p id="5f93" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在<em class="le"> InlineData </em>中添加更多边缘案例场景，以彻底测试患者模型验证测试。</p><h1 id="0907" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">重复患者测试</h1><p id="1a2d" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我们现在将创建一个测试，当我们试图添加一个重复的患者时，该测试会失败。</p><h2 id="a34a" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">失败(红色)测试</h2><p id="de42" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在您的类中创建另一个测试<em class="le"> PatientTests。添加下面的代码。</em></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="5ec8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在这里使用了一个[事实]属性，而不是[理论]属性，因为我们不想用不同的参数测试相同的方法。相反，我们希望两次提出相同的请求。</p><p id="f111" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行<strong class="js iu"> <em class="le"> dotnet测试</em> </strong>来运行我们新创建的测试。测试将失败，并显示消息<em class="le">断言。Equal()故障</em>。是时候解决了。</p><h2 id="3db3" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">成功(绿色)测试</h2><p id="b569" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">为了修复失败的测试，我们需要在<em class="le"> PatientController.cs </em>中添加AddPatient方法的实现。如下所示更新文件的代码。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="02ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">再次运行<strong class="js iu"> <em class="le"> dotnet测试</em> </strong>，你会看到测试已经通过。</p><h1 id="ed51" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">重要注意事项</h1><p id="b6c4" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">随着您添加更多的模型/领域，如医生、员工、仪器等。您将不得不创建更多的测试。确保为它们中每一个拥有不同的WAF、实用包装器和不同的测试文件。</p><p id="30ee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其次，同一个文件中的测试不会并行运行。但是，来自不同文件的测试确实是并行运行的。因此，每个晶片应该具有不同数据库名称，以便数据不会被错误配置。</p><p id="b8ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，到原始数据库的连接仍然需要在主项目中设置。</p><h1 id="0fc9" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">思维过程</h1><p id="657d" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">为所有场景创建测试的思维过程是相似的。</p><p id="b44a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">也就是说，您应该首先确定需求。然后，建立一个没有实现的方法和类的框架。编写测试来验证实现。最后，根据需要重构并重新运行测试。</p><p id="2beb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本教程不包括api的认证和授权。你可以<a class="ae nn" href="https://arjavdave.com/2021/03/31/net-5-setup-authentication-and-authorisation/" rel="noopener ugc nofollow" target="_blank">在这里</a>阅读如何设置它。</p><p id="361e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为不可能覆盖所有的测试用例，所以我在Github 上创建了一个<a class="ae nn" href="https://github.com/shenanigan/tdd-demo" rel="noopener ugc nofollow" target="_blank">库。它涵盖了所有测试用例的实现以及实现。</a></p><p id="4115" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在这里找到<a class="ae nn" href="https://github.com/shenanigan/tdd-demo" rel="noopener ugc nofollow" target="_blank">项目</a>。</p><h1 id="d6a8" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="b8f5" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">为了让TDD有效，你真的需要对需求有一个清晰的概念。如果需求持续变化，维护测试和项目会变得非常困难。</p><p id="fae6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">TDD主要涵盖单元、集成和功能测试。在上线之前，您仍然需要进行UAT、配置和生产测试。</p><p id="408e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">话虽如此，TDD确实有助于让您的项目摆脱bug。其次，它增强了你对实施的信心。只要测试通过，你就可以修改你的代码。最后，它为您的项目提供了一个更好的架构。</p><p id="5b14" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae nn" href="https://arjavdave.com" rel="noopener ugc nofollow" target="_blank">查看更多教程。网在这里。</a></p></div></div>    
</body>
</html>
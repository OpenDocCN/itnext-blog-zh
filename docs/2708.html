<html>
<head>
<title>Adding object properties conditionally with EcmaScript 6 (ES6)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用EcmaScript 6 (ES6)有条件地添加对象属性</h1>
<blockquote>原文：<a href="https://itnext.io/adding-object-properties-conditionally-with-ecmascript-6-es6-7e7611da242e?source=collection_archive---------1-----------------------#2019-07-16">https://itnext.io/adding-object-properties-conditionally-with-ecmascript-6-es6-7e7611da242e?source=collection_archive---------1-----------------------#2019-07-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jq jr js jt"><div class="bz fp l di"><div class="ju jv l"/></div></figure><p id="b6a0" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated"><em class="ku">来源:</em>【https://twitter.com/bmeurer/status/1137025197557669888】<em class="ku"/></p><p id="ed38" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这是谷歌的一名工程师最近发布的一条推文，他正在为谷歌Chrome网络浏览器和Node.js开发V8引擎。这让我想到了哪些用例对我非常有帮助，我应该在这里与全世界分享它们。</p><h2 id="9e5a" class="kw kx it bd ky kz la dn lb lc ld dp le kh lf lg lh kl li lj lk kp ll lm ln lo bi translated">向对象添加属性</h2><p id="8552" class="pw-post-body-paragraph jw jx it jy b jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt im bi translated">在JavaScript中，向对象添加属性非常容易。您基本上可以像下面的代码那样完成它。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="5a65" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">但是想象一下，如果有特定的条件，就应该加上<code class="fe lz ma mb mc b">lastName</code>。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="dae5" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这看起来还不错，但是如果我们把条件组合起来，并把它们添加到多个if块中会怎么样呢？</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="700f" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">总体来看，它看起来很难读懂，而且一个包含这段代码的函数会增长很多，即使它只是在做简单的事情。</p><p id="174c" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">EcmaScript 6 (ES6)是一个新标准，它支持JavaScript语言中的许多新特性。有了这些特性，我们可以编写下面的代码。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="842c" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated"><code class="fe lz ma mb mc b">person</code>的值的结果将与上面提到的脚本中的结果相同。但是这是如何工作的呢？</p><h2 id="f3aa" class="kw kx it bd ky kz la dn lb lc ld dp le kh lf lg lh kl li lj lk kp ll lm ln lo bi translated"><code class="fe lz ma mb mc b">&amp;&amp;</code>号操作员</h2><p id="9596" class="pw-post-body-paragraph jw jx it jy b jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt im bi translated"><code class="fe lz ma mb mc b">&amp;&amp;</code>是JavaScript中的逻辑运算符，通过使用<code class="fe lz ma mb mc b">AND</code>来组合布尔值。它可以与两个参数一起使用。让我们假设那些参数是<code class="fe lz ma mb mc b">a</code>和<code class="fe lz ma mb mc b">b</code>。当我们应用<code class="fe lz ma mb mc b">&amp;&amp;</code>参数时，它看起来像<code class="fe lz ma mb mc b">a &amp;&amp; b</code>。这将产生一个布尔结果，可以是<code class="fe lz ma mb mc b">true</code>或<code class="fe lz ma mb mc b">false</code>。如果两个参数都是<code class="fe lz ma mb mc b">true</code>，则为<code class="fe lz ma mb mc b">true</code>。如果其中一个或两个都是<code class="fe lz ma mb mc b">false</code>，结果也将是<code class="fe lz ma mb mc b">false</code>。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="c930" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">另一个特点是，当不为<code class="fe lz ma mb mc b">a</code>或<code class="fe lz ma mb mc b">b</code>使用布尔值时，可能会发生没有布尔值被返回的情况。我们可以使用浏览器控制台简单地检查这一点。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="4444" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">我们可以扩展这个特性，并返回一个非常好的对象。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="81f1" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">但是我们需要将这个对象合并到上面的<code class="fe lz ma mb mc b">person</code>对象中🤯</p><h2 id="d651" class="kw kx it bd ky kz la dn lb lc ld dp le kh lf lg lh kl li lj lk kp ll lm ln lo bi translated">合并对象</h2><p id="05b7" class="pw-post-body-paragraph jw jx it jy b jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt im bi translated">使用<code class="fe lz ma mb mc b">Object.assign</code>功能合并对象在JavaScript中早已成为可能。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="929b" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这里发生的是最后一个参数<code class="fe lz ma mb mc b">{ lastName: ""}</code>被合并到对象<code class="fe lz ma mb mc b">basePerson</code>中。如果属性相同，则最后一个对象将胜出并覆盖前一个对象的属性。<code class="fe lz ma mb mc b">Object.assign</code>也是可变函数。这意味着它会将所有更改应用于函数所有参数中的第一个参数。为了避免对<code class="fe lz ma mb mc b">basePerson</code>对象的更改，我们传递一个空对象作为第一个参数，这样就创建了一个新对象，而不是一个被重用的旧对象。</p><p id="0760" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">EcmaScript 6 (ES6)提供了一种更好的方式来完成这些合并。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="92c7" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这将产生与之前相同的具有属性<code class="fe lz ma mb mc b">firstName</code>和<code class="fe lz ma mb mc b">lastName</code>的人物对象。同样，这里最后的属性覆盖了第一个属性，但是我们仍然有一个问题，那就是将在<code class="fe lz ma mb mc b">&amp;&amp;</code>解释中返回的对象应用到对象中，因为当前版本假设<code class="fe lz ma mb mc b">lastName</code>只是一个键，并且有一个静态值。</p><p id="36fd" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">我们可以传递一个要被析构的对象到person对象中来传递一个对象，而不是键和值。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="bb20" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">现在这可能足以重构并放入一个变量，但是我们有一个问题，因为<code class="fe lz ma mb mc b">const result = condition &amp;&amp; { lastName: "" };</code>可能导致<code class="fe lz ma mb mc b">false</code>或<code class="fe lz ma mb mc b">{ lastName: "" }</code>。如果我们将对象<code class="fe lz ma mb mc b">...{ lastName: "" }</code>传递给析构函数，一切都很好，但是如果我们传递类似<code class="fe lz ma mb mc b">...false</code>的东西，会发生什么呢？</p><figure class="lu lv lw lx gt jt gh gi paragraph-image"><div class="gh gi md"><img src="../Images/d1046d189e303df536b91aad6b45c04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*iTnk_ASzXCFzdBvPmO2z5A.gif"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">JavaScript很聪明</figcaption></figure><p id="9aee" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">实际上，这在一个对象中使用时不会产生任何结果。这也意味着我们可以在大的析构功能中使用它。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="fb57" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这非常好，但是仍然可以通过内嵌<code class="fe lz ma mb mc b">result</code>来改进。</p><figure class="lu lv lw lx gt jt"><div class="bz fp l di"><div class="ly jv l"/></div></figure><p id="68de" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这是一个关于如何在JavaScript中有条件地扩展对象的超级巧妙的例子，它真实地展示了当使用现代语言时，我们可以使用更简洁的语法来表达自己。</p><p id="a2fc" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">当您创建相同类型的对象时，这些函数变得特别重要，有时有一些属性，有时没有。考虑单元或集成测试的工厂函数。</p><figure class="lu lv lw lx gt jt gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/9b78101ec5f387020fa5fc8b3ef7bdf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_AIONgegEOSemuP85tCt9A.png"/></div></div></figure><blockquote class="mp"><p id="dff2" class="mq mr it bd ms mt mu mv mw mx my kt dk translated">感谢你阅读这篇文章。你真棒🤘</p><p id="d8a6" class="mq mr it bd ms mt mz na nb nc nd kt dk translated">也可以查看我的其他博客文章，比如JavaScript中的<a class="ae kv" href="https://medium.com/@kevin_peters/function-parameters-in-javascript-clean-code-4caac109159b" rel="noopener">函数参数</a>，<a class="ae kv" href="https://medium.com/@kevin_peters/learn-how-to-refactor-vue-js-single-file-components-on-a-real-world-example-501b3952ae49" rel="noopener">学习如何用真实世界的例子重构Vue.js单个文件组件</a>或者<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-debug-javascript-applications-and-tests-9718fe610f7d">如何调试JavaScript应用程序和测试</a>。</p><p id="1a32" class="mq mr it bd ms mt mz na nb nc nd kt dk translated">如果你有任何反馈或者想给这篇文章添加一些东西，请在这里评论。您也可以在<a class="ae kv" href="https://twitter.com/kevinpeters_" rel="noopener ugc nofollow" target="_blank"> twitter </a>上关注我，或者访问我的<a class="ae kv" href="https://www.kevinpeters.net/" rel="noopener ugc nofollow" target="_blank">个人网站</a>来了解我的博客文章和更多内容。</p></blockquote></div></div>    
</body>
</html>
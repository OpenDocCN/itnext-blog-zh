<html>
<head>
<title>How to make a simple One-Time-Password service with Spring Boot.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Spring Boot做一个简单的一次性密码服务？</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-make-a-simple-one-time-password-service-with-spring-boot-ebe640a7be7b?source=collection_archive---------1-----------------------#2021-11-09">https://itnext.io/how-to-make-a-simple-one-time-password-service-with-spring-boot-ebe640a7be7b?source=collection_archive---------1-----------------------#2021-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/593fbd735836afc55ec87f9756cb77ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_xo_h5vQg3xcMaPW7aymQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">李·坎贝尔的照片</figcaption></figure><p id="710c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在发表了上一篇<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/how-to-use-otp-service-in-your-automation-scripts-with-selenium-web-driver-fe81607232b5">文章</a>之后，我收到消息抱怨这篇文章提供了一个复杂的例子。如果我能描述一种更简单的方法来创建一次性密码服务。</p><p id="1ab0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我决定部分重复我的关于创建一次性密码的文章，并实现一种不同的方法。</p><p id="ecf9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将考虑使用Spring boot创建一个一次性密码微服务。我们还将使用Selenium WebDriver 4分析与该服务交互的实现。</p><p id="4f22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最初，我们需要弄清楚什么是<a class="ae kc" href="https://spring.io/projects/spring-boot" rel="noopener ugc nofollow" target="_blank">弹簧靴</a>。</p><p id="c7d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Spring Boot是一个有用的项目，旨在简化基于Spring的应用程序的创建。它允许您最简单地创建一个web应用程序，只需要开发人员最少的努力来配置它和编写代码。</p><p id="b346" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于依赖项的繁琐配置，为企业应用程序配置Spring已经成为一项非常繁琐且容易出错的任务。对于同时使用几个第三方库的应用程序来说尤其如此。</p><p id="38ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每次创建另一个基于Spring的企业Java应用程序时，都需要重复相同的例行步骤来配置它:</p><ul class=""><li id="e183" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">这取决于所创建的应用程序的类型(Spring MVC、Spring JDBC、Spring ORM等)。)，导入必要的Spring模块。</li><li id="1600" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">导入web容器库。</li><li id="0c6a" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">导入必要的第三方库(比如Hibernate，Jackson)。</li><li id="716f" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">配置DAO组件，如数据源、事务管理等。</li><li id="34ac" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">配置web层组件。</li><li id="0126" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">定义一个将加载所有必要配置的类。</li></ul><p id="4742" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Spring的作者决定为开发人员提供一些工具，这些工具可以自动完成配置过程，并加速创建和部署Spring应用程序的过程，这些工具的通用名为<strong class="kf ir"> Spring Boot </strong></p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/f88e0d86232980793cb2f7c16b8574c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzL-f0bWdmPwSS_qB0mUMg.png"/></div></div></figure><p id="668c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Spring Boot有很多功能，但是它最重要的特性是依赖管理、自动配置和内置的servlet容器。</p><p id="bec8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lu translated">你需要的帽子。</p><p id="25f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，我们将创建一个项目，使用Spring Boot和格雷来模拟OTP服务的操作。因此，对于我们的项目，我们必须具备以下工具和技术:</p><ul class=""><li id="c68d" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">Spring Boot版本2.5.6+</li><li id="5ac1" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Java8+</li><li id="67c1" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Gradle 7.2+</li><li id="b368" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">你选择的任何IDE。(我更喜欢IntelliJ IDEA)</li></ul><p id="48c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用Spring Boot创建任何项目都必须从以下几点开始:</p><p id="cf3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://start.spring.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">https://start . spring . io</strong></a><strong class="kf ir">/</strong></p><p id="d84d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个门户是由Spring boot开发人员创建的，可以在创纪录的时间内创建基于Spring boot的项目。</p><p id="0d31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我建议您在项目创建阶段添加几个依赖项:</p><ul class=""><li id="90e2" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">Spring Boot的开发工具。Spring Boot提供了一个叫做Spring Boot开发工具的模块。DevTools代表开发者工具。本模块的目的是在使用Spring Boot应用程序的同时，尝试缩短开发时间。Spring Boot DevTools获取更改并重启应用程序。</li><li id="ac98" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">弹簧网</strong>。这个组包括Web、Web-Servlet、Web-Struts和Web-Portlet。这些模块为创建web应用程序提供支持。</li></ul><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/d74371266e3790bdf3b1e8ee9593e2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ROybmSjoryRZjhclWGenkw.png"/></div></div></figure><p id="9aa4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建项目后，您可以在IDE中打开它。将自动安装所有必需的依赖项。</p><p id="4244" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于成熟的工作，我们需要创建一个控制器类。在这个类中，将集中处理HTTP请求的所有逻辑。姑且称之为家庭控制器吧。</p><p id="5b4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">RestController批注必须添加到该类中。我们使用<a class="ae kc" href="http://twitter.com/RestContoller" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">@ REST controller</strong></a>注释告诉Spring这个类是Spring REST应用程序的控制器。</p><p id="f40e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Spring MVC中第二个重要的注释是<a class="ae kc" href="http://twitter.com/RequestMapping" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">@ request mapping</strong></a>。我们使用该注释将客户端请求与服务请求的适当方法进行映射。在RequestMapping注释的括号中，我们指定了URL路径。例如<strong class="kf ir">@ request mapping("/API/OTP ")</strong></p><p id="1c53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种控制器的一个例子可能是这样的:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="4137" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在URL:<a class="ae kc" href="http://localhost:8080/api/otp" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/API/OTP</a>上启动服务后，我们收到响应:</p><pre class="lq lr ls lt gt mg mh mi mj aw mk bi"><span id="f0a7" class="ml mm iq mh b gy mn mo l mp mq">{"is_successful":"true","code":"1234","parameter_errors":"null","server_datetime":"Sun Nov 07 13:12:29 MSK 2021"}</span></pre><p id="4a21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的一次性密码运行良好，并返回实际结果。</p><p id="cc7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是在这个实现中，逻辑的分解出现了问题。控制器应该只处理请求。HomeController类中不应该有无关的逻辑。为了将我们的业务逻辑从控制器中分离出来，有必要创建一个服务。每个实体必须有一个单独的服务。让我们创建一个家庭服务类。</p><p id="2aed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">服务组件是包含<a class="ae kc" href="http://twitter.com/Service" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">@服务</strong> </a>注释的类文件。这些类文件用于在不同的层中编写业务逻辑，与<a class="ae kc" href="http://twitter.com/RestController" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> @RestController </strong> </a>类文件分开。</p><p id="e6fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的示例Home Service中的服务类是一个独立的抽象层，它与我们的业务逻辑一起工作。创建服务组件类文件的逻辑如下所示:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="60bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们将逻辑移动到单独的服务之后，控制器数量如下所示:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="5a12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们再次打开URL:<a class="ae kc" href="http://localhost:8080/api/otp" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/API/OTP</a>并确保结果没有改变并且服务继续正常工作:</p><pre class="lq lr ls lt gt mg mh mi mj aw mk bi"><span id="a4eb" class="ml mm iq mh b gy mn mo l mp mq">{"is_successful":"true","code":"1234","parameter_errors":"null","server_datetime":"Sun Nov 07 13:12:29 MSK 2021"}</span></pre><p id="b337" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lu translated"><span class="l lv lw lx bm ly lz ma mb mc di"> S </span>元素项目。</p><p id="852b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要检查如何使用一次性密码服务，您必须制作一个带有OTP字段的示例登录页面。例如，这个HTML页面看起来像这样:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/3414228d29c79c54c243251e6487cd06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdd4EehvT5ib56xWTQMn3A.png"/></div></div></figure><p id="daa2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用于处理用户在登录页面上输入的数据的JavaScript代码可能如下所示:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="ff3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了在框架的UI端使用一次性密码服务，我们需要创建一个如下所示的服务助手:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="2ac1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Selenium的登录页面类可能如下所示:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="9209" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自动化脚本如下所示:</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="bb63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lu translated"><span class="l lv lw lx bm ly lz ma mb mc di"> C </span> <strong class="kf ir">结论</strong>。</p><p id="52e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">恭喜你完成了你的第一个春装项目。在本文中，您了解了Spring boot的基础知识，如何设置项目，添加项目依赖项，启动您的第一个REST API服务，以及如何创建简单的一次性密码服务。在本文中，我试图重点创建一个简单的OTP服务。这篇文章的主要目的是学习Spring Boot的初始能力。我们还查看了Selenium Webdriver与REST API服务交互的解决方案示例。在下一篇文章中，我计划给出一个例子，在SpringBoot上创建一个成熟的一次性密码，并在前端与它交互。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/37405c6bd9906e7572c1b5d0f490ca04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Lu3G8OVrxTr-BOSOHvP5Gw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://test-engineer.site/" rel="noopener ugc nofollow" target="_blank">https://test-engineer.site/</a></figcaption></figure><h1 id="b0cf" class="mt mm iq bd mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np bi translated">作者<a class="ae kc" href="https://www.linkedin.com/in/vaskocuturilo/" rel="noopener ugc nofollow" target="_blank">安东·斯米尔诺夫</a></h1></div></div>    
</body>
</html>
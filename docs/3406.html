<html>
<head>
<title>Using AWS Textract — Extract Text in Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS文本摘要-提取图像中的文本</h1>
<blockquote>原文：<a href="https://itnext.io/using-aws-textract-extract-text-in-images-c2b2f226f9db?source=collection_archive---------0-----------------------#2019-12-08">https://itnext.io/using-aws-textract-extract-text-in-images-c2b2f226f9db?source=collection_archive---------0-----------------------#2019-12-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c08fea75eabddbc0d3d72e2db67cea4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HROcMuQOOked14UFfkiKQ.png"/></div></div></figure><p id="8ed8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">AWS有一系列特定于人工智能的服务，有助于加快人工智能在我们基于云的应用程序中的使用。有了这些，开发人员可以专注于业务逻辑，让亚马逊负责开发人工智能模型的完美性。</p><p id="7140" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Textract是一项AWS服务，可以帮助我们从图像中读取文本。它能够处理复杂的图像——只需一次API调用。这使得开发人员可以专注于业务逻辑，而不是纠结于算法。</p><p id="4418" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们深入了解一下Textract服务。有两种方法可以访问Textract——通过控制台和API。当然，API给了我们编程式的访问，让事情变得很酷。让我们看看他们中的任何一个。我们从控制台访问开始，了解正在发生的事情，然后我们进入代码，享受Textract的真正力量。</p><h1 id="cb9c" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">AWS控制台上的文本摘要</h1><p id="49f7" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Amazon Textract服务可以从AWS控制台找到。去https://aws.amazon.com/textract。这将打开亚马逊Textract控制台。</p><p id="ea65" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这有一个简单的界面:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/daedeba75d7fd34b2a18387270ec8483.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9N_UFEZ57gqlhlJDFBRgsQ.png"/></div></div></figure><p id="f2f8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们点击“尝试亚马逊Textract”。这将打开文档分析器，看起来像这样:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mi"><img src="../Images/3a67aa23b2d4f6785b055a2c535cde0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKeqtP0AbXIvriPDH6h_EA.png"/></div></div></figure><p id="45b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它预装了一个样本图像分析演示。左边是图像，右边是分析。我们可以看到三个选项卡—原始文本、表单和表格。</p><p id="e5fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以试着点击每一个。Textract能够识别呈现给它的图像中的单个表单和表格。当我们单击右侧面板中的单个单词、表格或表格时，图像中相应的元素会突出显示，向我们显示它在图像中出现的位置。</p><p id="58c4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这就是Textract的妙处！只需上传一张图片，点击一个按钮，所有的图片分析和文本提取就完成了！</p><p id="0ead" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们在角落里有两个按钮，上传新图像和下载分析。如果我们下载它，我们可以看到几个文件——这些文件向我们显示了图像中识别出的内容的细节。这包括一个巨大的JSON文件，其中包含大量关于图像的细节。</p><p id="b79c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这只是惊鸿一瞥。如果我们想使用Textract的真正力量，我们需要代码来理解和解码那个JSON。它携带了大量关于手边图像的信息。我们需要编写代码来理解这个JSON。</p><h1 id="7851" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">代码中的文本摘要</h1><p id="043e" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Textract用例的典型工作流程如下:</p><ul class=""><li id="4f93" class="mj mk it kd b ke kf ki kj km ml kq mm ku mn ky mo mp mq mr bi translated">外部API将图像转储到S3桶中</li><li id="c6de" class="mj mk it kd b ke ms ki mt km mu kq mv ku mw ky mo mp mq mr bi translated">这触发了一个Lambda函数，该函数使用这个图像调用Textract API来提取和处理文本</li><li id="1cef" class="mj mk it kd b ke ms ki mt km mu kq mv ku mw ky mo mp mq mr bi translated">然后，这些文本被推送到DynamoDB或Elastic Search等数据库中，以供进一步分析</li></ul><p id="1efd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第一步和第三步超出了本博客的范围。让我们把重点放在第二点上。我喜欢Python。所以我将使用Python (Boto3)编码的Lambda函数来调用Textract。你可以选择合适的。</p><h2 id="7b7f" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">图像</h2><p id="edc9" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">我们将在博客的其余部分使用下图。它有不同字体和大小的文本。它有一个表格和一个表单。部分文字有点模糊。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/fff5545f5a6ef51147bde47a87d9edd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*GnhzW-SX6dy8qtQ60pa5tQ.png"/></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">用于文本摘要的图像</figcaption></figure><h2 id="1def" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">S3水桶</h2><p id="099f" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">我们首先将图像保存在S3桶中。让我们创建一个新的存储桶，并将测试图像上传到其中。我把S3桶称为“学习-文本摘要”。在其中，我添加了图像“sample-image.png”</p><h2 id="2fb1" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">λ函数</h2><p id="0dc2" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">接下来，我们创建一个新的Lambda函数——它可以调用Textract API。为了我们。</p><p id="346d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们为这个Lambda函数创建一个IAM角色，并赋予它所需的权限。我用这个政策来完成工作。请将XXXXX替换为您的帐号，以便能够使用此帐户。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="969f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我选择Python 3.7作为语言。有了这些，我们就可以实现Lambda函数了。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="9719" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">尝试运行此Lambda它会生成大量的JSON输出。我们可以将该文件加载到一个好的编辑器中，以查看其内容。JSON太大，无法在此显示。你可以试着运行上面的代码来看看真实的。或者，你可以在我的github上查看。</p><p id="0220" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这太棒了！我不知道我的图像中有这么多信息！但是这有用吗？这个难看的JSON文件乍一看没有多大意义。事实上，它包含了我们需要了解的关于图像的所有信息！</p><h1 id="f53d" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">了解Textract响应</h1><p id="df24" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">从代码中调用Textract服务很容易。重要的部分是理解JSON响应，并将其用于我们的业务逻辑。现在让我们试着理解它的内容。</p><p id="109d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">响应主体有三个子文档。文档元数据、块和响应元数据。元数据内容非常直观，不需要任何解释。但是街区的排列是巨大的。让我们深入探讨一下。</p><p id="ea0f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">每个块都有定义的属性— ID、块类型、几何和关系。除此之外，每种类型的块都有自己的属性。让我们来看看这个响应中的重要模块。</p><h2 id="0b0b" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">页面块</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/f7f73f57e35f6a5966f99d97f645593e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RCyXdKAEghMQECNxG_9Esw.png"/></div></div></figure><p id="281b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是最重要的。文本识别的第一步是文本检测。该算法首先识别页面上有一些文本的区域。这被定义为页面。Textract为此父元素分配一个ID。它还提供了该区域的几何信息。这以两种形式提供</p><ul class=""><li id="e7ec" class="mj mk it kd b ke kf ki kj km ml kq mm ku mn ky mo mp mq mr bi translated">边界框—图像中包含该图像中所有文本的矩形区域。</li><li id="2220" class="mj mk it kd b ke ms ki mt km mu kq mv ku mw ky mo mp mq mr bi translated">多边形—它还确定可以覆盖页面中所有文本的最佳拟合n维多边形。</li></ul><p id="dafe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">除此之外，它还包括一系列关系——为这个“页面”中标识的每个子元素提供一个指针</p><h2 id="fc64" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">线块</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/d4eb77fe6b3a2b24697642cab1a1a51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*koXhmHWbEPnGuVWgw9zvew.png"/></div></div></figure><p id="2ab5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这标识了图像中的每一行文本。这有两个附加属性:</p><ul class=""><li id="e7d4" class="mj mk it kd b ke kf ki kj km ml kq mm ku mn ky mo mp mq mr bi translated">文本—非常直观…它包含图像中识别的文本行。</li><li id="2f62" class="mj mk it kd b ke ms ki mt km mu kq mv ku mw ky mo mp mq mr bi translated">置信度——这是Textract对给定身份的置信度的度量。在这种情况下，我们有干净的，打印文本。因此，对于所有识别出的文本，置信度都非常高。但是，有时文本是模糊的。在这种情况下，置信度相当低。作为我们业务逻辑的一部分，我们可以为置信度需求定义一个阈值。</li></ul><p id="7bed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">与页面块类似，它具有提供边界框和最佳拟合多边形坐标的几何属性。</p><p id="69fd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Line元素有一个子元素列表，每个子元素定义该行中的一个单词。</p><h2 id="ec0a" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">单词块</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/648538b4b0e11b0fe4ab9a463ab561ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4QFuknx8HhSd6p7lfBAgw.png"/></div></div></figure><p id="2a74" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，我们有了单词blocks。与行块类似，单词块具有文本和置信度属性，这些属性提供了关于其中实际文本的信息，以及该文本标识的置信度。它还具有几何属性，给出了关于边界矩形和最佳拟合多边形的细节。</p><p id="c7da" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请注意，单词块是层次结构的尾部元素，因此没有任何进一步的关系。</p><p id="80e8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">线条和文字为我们提供了图像中的所有文本内容。其他元素为我们提供了有关其结构和相关性的更多信息:</p><h2 id="b18d" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">数据表块</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/d236fda16d6d19f54618482f89807afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dcA7w2Wz-wIZZAdA7UmUyA.png"/></div></div></figure><p id="71b1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当Textract在图像中识别出一个表时，它会向JSON添加一个表块。这包括几何图形、置信度以及子元素列表——表格的单个单元格。</p><h2 id="7344" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">单元块</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/b5c9e0f5bc759613ea70c4d5783a9fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYCHvNoa0kKW-vtGOy0a8Q.png"/></div></div></figure><p id="b380" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">单元块包含大量信息—单元的行/列索引、行跨度/列跨度，然后是子元素—即单元中包含的单个字块。</p><p id="5e16" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些信息足以重建该表。</p><h2 id="83e4" class="mx la it bd lb my mz dn lf na nb dp lj km nc nd ln kq ne nf lr ku ng nh lv ni bi translated">键值集块</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/28a389d6fc7797b6ad532c960fa18211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y7sDoyj-QTC2BPChiX6iBA.png"/></div></div></figure><p id="21d6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些表单被标识为键值对。这对块标识表单中的一个条目。这里的子元素是键或值中的单个单词。</p><h1 id="8eba" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">提取信息的代码</h1><p id="c873" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">现在我们已经了解了JSON的结构，让我们来识别和处理这些元素。从上面的图像中，让我们尝试提取表单及其信息。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="23c3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这会产生以下输出:</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="7c5f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">酷！不是吗？</p><p id="3ea1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您在使用这项服务时需要其他帮助，请务必联系我。</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to run your scripts on startup in Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Windows中启动时运行脚本</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-run-your-scripts-on-startup-in-windows-8ae62a625f6c?source=collection_archive---------0-----------------------#2021-03-04">https://itnext.io/how-to-run-your-scripts-on-startup-in-windows-8ae62a625f6c?source=collection_archive---------0-----------------------#2021-03-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8e9973bede3976d6176ad82132d22a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0_v-dXvQyX7z0SWnpepXA.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kf" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="e838" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最近，我开发了一个CLI工具，打算用作备份应用程序。在开发这个工具的过程中，我需要实现一个特性，使这个脚本在启动时执行。对于Linux发行版，我找到了很多关于如何实现这种启动行为的资源，而对于Windows，事情要复杂一些，因为这不是一个简单的过程。</p><p id="e19f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">没有其他不必要的谈话，这里是我如何做到这一点，以及你可以如何为自己实现它😊</p><h2 id="3c5c" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">最终目标</h2><p id="12ac" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">为了让一切尽可能通用，我们将使用一个假想的用例来解释这个过程背后的理论。</p><p id="04cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，假设我们想要创建一个名为<code class="fe mc md me mf b">my-super-script</code>的CLI应用程序，每次打开计算机时，它都会将当前时间记录在一个<code class="fe mc md me mf b">.txt</code>文件中。执行该操作必须运行的命令是<code class="fe mc md me mf b">my-super-script startup do-logic</code>。</p><p id="4c0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们不想每次打开计算机时都打开命令提示符并手动运行这个脚本，而是让它自动为我们运行。</p><h2 id="809e" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">启动文件夹</h2><p id="fac6" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在Windows上，启动时运行程序最简单的方法是将一个可执行文件放在<strong class="ki iu"> Startup </strong>文件夹中。</p><p id="a26c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">计算机打开时，该文件夹中的所有程序都会自动执行。</p><p id="b1b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此文件夹在Windows上的位置是:</p><pre class="mg mh mi mj gt mk mf ml mm aw mn bi"><span id="39ff" class="le lf it mf b gy mo mp l mq mr"><strong class="mf iu"><em class="ms">%APPDATA%</em></strong>\Microsoft\Windows\Start Menu\Programs\Startup</span></pre><p id="831d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以通过按下<strong class="ki iu"> WINDOWS键+ R </strong>然后复制此文本<code class="fe mc md me mf b">shell:startup</code>来更容易地打开此文件夹。</p><h2 id="311b" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">的。蝙蝠文件</h2><p id="c69f" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">现在我们知道<strong class="ki iu">启动</strong>文件夹是我们需要放置<em class="ms">东西</em>来启动我们的脚本的文件夹，我们需要做的就是创建那个<em class="ms">东西</em>。</p><p id="6159" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过创建一个<a class="ae kf" href="https://en.wikipedia.org/wiki/Batch_file" rel="noopener ugc nofollow" target="_blank">球棒</a>(。bat)文件，包含以下内容:</p><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/3f409c29e45c125a18f72ec0b729a5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oAU9vUy9X0_nLT69v1FSzA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&amp;t=seti&amp;wt=none&amp;l=application%2Fx-sh&amp;ds=true&amp;dsyoff=20px&amp;dsblur=68px&amp;wc=true&amp;wa=true&amp;pv=27px&amp;ph=22px&amp;ln=false&amp;fl=1&amp;fm=Hack&amp;fs=14px&amp;lh=133%25&amp;si=false&amp;es=2x&amp;wm=false&amp;code=%2540echo%2520off%250Amy-super-script%2520startup%2520do-logic" rel="noopener ugc nofollow" target="_blank">生</a></figcaption></figure><p id="66ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个批处理脚本将执行我们的命令，而不会在终端中发出任何消息，因为第一行是<code class="fe mc md me mf b"><a class="ae kf" href="https://stackoverflow.com/questions/8486042/what-does-mean-in-windows-batch-scripts" rel="noopener ugc nofollow" target="_blank">@echo off</a></code>。</p><p id="b794" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仅此一项就够了。</p><p id="5352" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果我们将这个<code class="fe mc md me mf b">.bat</code>文件复制到启动文件夹中，然后重新启动我们的计算机，我们会看到一个命令提示符被打开，并且闪烁了不到一秒钟。</p><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/1f40300ce4e519649188f359a47deebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QHoRY6OFxinKMCQA7YTMDA.gif"/></div></div></figure><p id="443c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">实际上，只要我们通过<code class="fe mc md me mf b">my-super-script startup do-logic</code>运行程序处于活动状态，命令提示符窗口就会一直打开。因此，如果我们使用上面提到的假设用例，并假设我们的CLI工具需要2秒钟来将当前时间记录在. txt文件中，那么这个命令提示符窗口将保持可见2秒钟。</p><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/0e3dc4a8c5420e71649a10dff1e300fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Bt4aO3Pbc26HHMPX0Sj5wA.gif"/></div></div></figure><p id="3a10" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然这种方法有效，最终目标也达到了，但是用户体验并不是很好。想象一下，如果我们的应用程序是一个持续的进程，只要计算机是打开的，它就会一直运行，在这种情况下，我们就会一直被这个命令提示符所困扰。</p><p id="692d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要找到一种方法来运行那个命令<code class="fe mc md me mf b">my-super-script startup do-logic</code>，但是不要让这个命令提示符窗口可见。</p><h2 id="430a" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">的。vbs文件</h2><p id="48db" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">解决这个问题的方法是创建一个<a class="ae kf" href="https://fileinfo.com/extension/vbs" rel="noopener ugc nofollow" target="_blank"> VBS </a>(。vbs)文件，并将它放在启动文件夹中，而不是放在<code class="fe mc md me mf b">.bat</code>文件中。</p><p id="0392" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个<code class="fe mc md me mf b">.vbs</code>文件的目的是执行我们之前创建的bash脚本，但是没有显示shell。</p><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/46c6c4d32c01a7f8bd6a74d56eb9be01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBxfK6OkyMzwS7z26OX1uA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&amp;t=seti&amp;wt=none&amp;l=vb&amp;ds=true&amp;dsyoff=20px&amp;dsblur=68px&amp;wc=true&amp;wa=true&amp;pv=27px&amp;ph=22px&amp;ln=false&amp;fl=1&amp;fm=Hack&amp;fs=14px&amp;lh=133%25&amp;si=false&amp;es=2x&amp;wm=false&amp;code=Set%2520WshShell%2520%253D%2520CreateObject%28%2522WScript.Shell%2522%29%2520%250A%2520%2520WshShell.Run%2520chr%2834%29%2520%2526%2520%2522path_to_project%255Cscripts%255Cstartup.bat%2522%2520%2526%2520Chr%2834%29%252C%25200%250ASet%2520WshShell%2520%253D%2520Nothing" rel="noopener ugc nofollow" target="_blank">原始</a></figcaption></figure><p id="51f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完整的工作流程如下所示:</p><ol class=""><li id="80be" class="mw mx it ki b kj kk kn ko kr my kv mz kz na ld nb nc nd ne bi translated"><code class="fe mc md me mf b">.vbs</code>文件被创建并复制到启动文件夹。</li><li id="1078" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated"><code class="fe mc md me mf b">.vbs</code>文件会在启动时运行<code class="fe mc md me mf b">.bat</code>文件。</li><li id="3e15" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated">这个<code class="fe mc md me mf b">.bat</code>文件将运行我们的程序。</li></ol><p id="9615" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦我们在启动文件夹中有了<code class="fe mc md me mf b">.vbs</code>文件，命令<code class="fe mc md me mf b">my-super-script startup do-logic</code>将在每次启动时执行，而不创建命令提示窗口。</p><h2 id="8c43" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">行动中的代码</h2><p id="6fba" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">如果事情不是那么清楚，并且这个理论不足以帮助你，并且你想看这个实现的具体例子，那么你可以看一看这个<a class="ae kf" href="https://github.com/CloudTenant/CloudTenant-CLI/tree/master/src/modules/startup" rel="noopener ugc nofollow" target="_blank">库</a>。</p><p id="ca10" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码是用NodeJS编写的，但是一旦你理解了操作原理，用你想要的语言实现它就很容易了。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="571c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ms">感谢您的关注，如果您觉得这篇文章有帮助，请点击</em>👏<em class="ms">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Say no to ifs with Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Typescript对if说不</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-say-no-to-ifs-with-typescript-7c4217cf257b?source=collection_archive---------4-----------------------#2019-02-10">https://itnext.io/how-to-say-no-to-ifs-with-typescript-7c4217cf257b?source=collection_archive---------4-----------------------#2019-02-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/70869ca0e5649212a130e72252e74787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEXyjdmXKG88U_YJ-gQ-bw.jpeg"/></div></div></figure><div class=""/><p id="a429" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任何与我交谈过的人都会注意到我对if语句的厌恶。当然，你不能避免它们，因为如果你必须比较两个数字，除了if语句，没有其他方法。</p><p id="f0ec" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我对如果有什么不满？软件是一个有趣的词，如果你靠近它看，它包含单词soft。让我们查一下英语词典，单词soft是什么意思。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="0811" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">容易塑造，不难改变。这是我们作为工程师每天都在做的事情，我们创建代码，更改代码，调试代码，制造新的错误。这一切都以维护结束，我们创建一个代码，几年来我们的主要任务是创建功能和维护旧代码。</p><p id="cb6c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我对if语句的不满。他们没有让代码易于维护，而是让代码变得复杂。可悲的是，如果没有威士忌的副作用，如果不会变得更好。Ifs自然会编写代码来扩展，一个if，两个逻辑，再多一个，你就已经有四个商业案例了。</p><p id="a944" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么如何避免呢？寻找聪明的模式，许多如果只是说:“嘿，伙计，你需要某种引擎对国家做出反应”。那么最好创造一个引擎，而不是从ifs中创造圣诞树。</p><p id="bfee" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">女士们先生们，我给你们带来了打字稿中的指挥调度模式。</p><h1 id="9b37" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">命令</h1><p id="1655" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">什么是命令？该命令是一个参数容器。它不包含任何逻辑，它是一个简单的对象。</p><p id="593c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们有一个用户注册的解决方案。必须提供的字段是姓名和年龄。那么我们的命令应该是“RegisterUser”</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="c34e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如何创建命令？</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><h1 id="1b91" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">经理人</h1><p id="e49d" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">什么是处理程序？它处理业务逻辑，作为输入，它得到一个命令。</p><p id="f322" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们创建一个UserHandler。出于演示目的，它将有一个假的存储库，在生产中，它可能是一个API调用。</p><p id="5d03" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在handlers构造函数中，我们注册了一个Handlers可以处理的命令。基本上，我们在这里说，当你看到一个命令注册用户这样做。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="adae" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这取决于你，有多少命令可以处理处理程序。干净利落。</p><p id="2b4e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每个处理程序必须扩展命令处理程序</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="1626" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">包含存储处理程序，其中存储已注册的处理程序和方法寄存器。注册方法第一个参数是一种对象/命令，第二个参数是一个函数，其中输入是一个命令，输出是一个承诺。</p><h1 id="3cbe" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">分配器</h1><p id="cfc1" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">现在我们有了命令和处理程序，我们需要第三个角色，一个调度程序。这个中间人有一项工作，就是为给定的命令执行适当的处理程序。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="a61d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，我讨厌如果，如果可能的话，我会用可选的。</p><p id="0d6e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">至于CommandHandlerMap，这个类是一个中间人，它使得与处理程序一起工作更加令人满意。至于功能性，它将多个处理程序合并为一个。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><h1 id="5231" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">最终游戏</h1><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="38d2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如单元测试所示。我们正在创建一个用户处理程序，并将其传递给处理程序映射。然后我们创建一个dispatcher和pass handler映射。创建一个命令并使用dispatcher执行该命令。</p><p id="3d8e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为什么需要地图？事实并非如此，但是当我们开始建造像这样的建筑时</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="4581" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看看增加功能是多么容易。切换功能的开/关。更多的处理程序没有问题，定义，添加和使用。</p><p id="0b29" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">像这样的分支很容易在内部出错</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="f1f4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么为什么要使用ifs呢？只是<a class="ae mf" href="https://www.youtube.com/watch?v=Ow0lr63y4Mw" rel="noopener ugc nofollow" target="_blank">停止</a>，看看你的代码，寻找模式，寻找可能的“引擎”实现。维护“引擎”比维护巨大的“如果-那么”模块要容易得多。</p><p id="be8d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mf" href="https://github.com/alzuma/tools/blob/master/src/commands/__tests__/CommandHandler.test.ts" rel="noopener ugc nofollow" target="_blank"> GitHub </a>中的代码照常运行。</p></div></div>    
</body>
</html>
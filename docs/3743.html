<html>
<head>
<title>Android Firebase Authentication SDK— Email and Password Login</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android Firebase身份验证SDK—电子邮件和密码登录</h1>
<blockquote>原文：<a href="https://itnext.io/android-firebase-authentication-email-and-password-login-b06980cf864a?source=collection_archive---------3-----------------------#2020-02-15">https://itnext.io/android-firebase-authentication-email-and-password-login-b06980cf864a?source=collection_archive---------3-----------------------#2020-02-15</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/8b9f28197f90fd6901d10ccfb94dfb60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dOIj3dNiuW2uzPYi_dTVpg.png"/></div></div></figure><p id="0791" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi la translated">irebase是一个强大的平台，它提供了许多功能，包括<strong class="ke iv">云消息</strong>、<strong class="ke iv">云功能</strong>和<strong class="ke iv">云Firestore </strong>等。其中一个有用的特性是<strong class="ke iv"> Firebase认证</strong>。它允许开发人员直接创建和管理用户帐户，而不用关心底层的服务器代码！根据Firestore安全规则，登录的用户可以拥有令牌来访问Firestore中的安全数据。</p><p id="70de" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">Firebase提供了丰富的认证方式，包括<strong class="ke iv">邮箱/密码</strong>、<strong class="ke iv">谷歌登录</strong>、<strong class="ke iv">脸书登录</strong>和<strong class="ke iv">苹果登录</strong>等。在本文中，我们将详细介绍<strong class="ke iv">电子邮件/密码认证</strong>的细节和缺陷。以下是内容列表:</p><ol class=""><li id="39e6" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated">先决条件(4个步骤)</li><li id="ac74" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">注册</li><li id="d5de" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">登录</li><li id="121e" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">注销</li><li id="d349" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">忘记/重置密码</li><li id="88e6" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">更新密码</li><li id="c4ad" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">更新电子邮件</li><li id="8deb" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">删除用户帐户</li><li id="f546" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">设置重置密码的电子邮件模板</li><li id="4fc5" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">限制</li></ol></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="f09d" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">先决条件(4个步骤):</h1><ol class=""><li id="e706" class="lj lk iu ke b kf nc kj nd kn ne kr nf kv ng kz lo lp lq lr bi translated">在<a class="ae nh" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>用Android app创建一个项目，用<code class="fe ni nj nk nl b">google-services.json</code>将Firebase项目链接到您的Android app，T0是您注册app时生成的文件，包含重要信息，如<code class="fe ni nj nk nl b">project_id</code>、<code class="fe ni nj nk nl b">package_name</code>和<code class="fe ni nj nk nl b">api_key</code>。</li></ol><figure class="nn no np nq gu jv gi gj paragraph-image"><div class="gi gj nm"><img src="../Images/15e9a6115283b7c73333064e8aa3ec8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*OQkvia1IzzHyIlffqRPFQg.png"/></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">google-services.json必须放在当前模块(app)文件夹中。</figcaption></figure><p id="0a54" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">2.项目<code class="fe ni nj nk nl b">build.gradle</code>文件的设置</p><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="ba4b" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">3.在模块<code class="fe ni nj nk nl b">app.gradle</code>文件中设置</p><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="960d" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">请参考<a class="ae nh" href="https://firebase.google.com/support/release-notes/android" rel="noopener ugc nofollow" target="_blank"> Firebase Android发行说明</a>获取最新版本的Firebase认证SDK，。写这篇文章的时候是<code class="fe ni nj nk nl b">19.2.0</code>。</p><p id="c974" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">4.在Firebase控制台启用电子邮件/密码功能:</p><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nx"><img src="../Images/5156ffaace37d0a932e5249fc77901d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AtceD2QkokhonLDph943g.png"/></div></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">启用电子邮件/密码功能的步骤</figcaption></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="1eaa" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能1)注册</h1><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="1e27" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">注册一个新账户就像调用一个函数<code class="fe ni nj nk nl b">createUserWithEmailAndPassword(email: String, password: String)</code>一样简单。<code class="fe ni nj nk nl b">OnCompleteListener</code>无论账户创建成功与否，当Firebase控制台有响应返回时触发。</p><p id="e0a1" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">成功创建帐户时触发<code class="fe ni nj nk nl b">OnSuccessListener</code>。新用户的信息可以通过代码<code class="fe ni nj nk nl b">FirebaseAuth.getInstance().<em class="ny">currentUser</em></code> <em class="ny">进行检索。</em>账户创建后，用户自动登录。不需要调用签到功能！</p><p id="d9c8" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">当控制台拒绝创建帐户时，触发<code class="fe ni nj nk nl b">OnFailureListener</code>。以下是可能的情况:</p><ol class=""><li id="f6ec" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthException</code> — <code class="fe ni nj nk nl b">Email/Password</code>登录提供者被禁用；开发人员应该在Firebase控制台启用它。参见上述<strong class="ke iv">先决条件</strong>环节的第4点。</li><li id="666f" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthUserCollisionException</code> —该电子邮件地址已被另一个帐户使用</li><li id="2378" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidCredentialsException</code> <em class="ny"> — </em>电子邮件地址格式不正确，例如<code class="fe ni nj nk nl b">example@!?!?.com</code></li><li id="0ae9" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthWeakPasswordException</code> —给定的密码无效。[密码至少应包含6个字符]</li></ol><p id="0d6f" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">因此，在调用<code class="fe ni nj nk nl b">signInWithEmailAndPassword</code>函数之前进行邮件格式检查是明智的。</p><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="6a1f" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能2)登录</h1><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="853a" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">通过调用<code class="fe ni nj nk nl b">signInWithEmailAndPassword(email: String, password: String)</code>，用户可以轻松登录。签到功能还有3个回调(<code class="fe ni nj nk nl b">OnCompleteListener</code>、<code class="fe ni nj nk nl b">OnSuccessListener</code>、<code class="fe ni nj nk nl b">OnFailureListener</code>)，用户信息在<code class="fe ni nj nk nl b">OnSucessListener</code>准备好。</p><p id="47d9" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">下面是一些可能引发<code class="fe ni nj nk nl b">OnFailureListener</code>的异常:</p><ol class=""><li id="6c37" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidCredentialsException</code>:密码无效或用户没有密码。没有匹配的电子邮件帐户或密码。</li><li id="b7b0" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidUserException</code> —用户帐户已被管理员禁用。</li></ol><blockquote class="nz oa ob"><p id="eda9" class="kc kd ny ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz in bi translated">*请注意，用户可以在不注销当前帐户的情况下登录另一个帐户。为了防止现有用户信息被意外覆盖，开发人员应该在显示登录页面之前手动检查用户状态。</p></blockquote><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="a0b7" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能3)注销当前用户</h1><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="5b2d" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">注销不同于可以通过回调添加的登录和注册功能。它只在本地清除当前用户信息和令牌，因此它不是一个异步函数，不需要任何回调。</p></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="ae08" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能4)忘记/重置密码</h1><p id="be02" class="pw-post-body-paragraph kc kd iu ke b kf nc kh ki kj nd kl km kn of kp kq kr og kt ku kv oh kx ky kz in bi translated">Firebase将向用户发送一封重置密码电子邮件，其中包含一个链接，将用户导向重置密码网页。默认的电子邮件模板是多语言和可定制的。以下是英文和繁体中文版本的示例:</p><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oi"><img src="../Images/1e59463282c7214de51f353c6e622709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*11JrfwxcDQWCLSU8KyLo5w.png"/></div></div></figure><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="571f" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">通过使用<code class="fe ni nj nk nl b">setLanguageCode(code: String)</code>功能，将向用户发送不同语言的电子邮件。这里是<a class="ae nh" href="https://github.com/firebase/firebaseui-web/blob/master/LANGUAGES.md" rel="noopener ugc nofollow" target="_blank">支持的语言列表</a>和一些例子:</p><ol class=""><li id="9f7b" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">en</code> —英语</li><li id="6253" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">en_gb</code> —英语(英国)</li><li id="a93c" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">zh_tw</code> —繁体中文</li><li id="38ad" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">zh_cn</code> —简体中文</li></ol><blockquote class="nz oa ob"><p id="01db" class="kc kd ny ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz in bi translated">*请注意，在您自定义模板内容后，您必须<a class="ae nh" href="https://firebase.google.com/docs/auth/custom-email-handler" rel="noopener ugc nofollow" target="_blank">创建自定义电子邮件操作处理程序</a>以支持多语言电子邮件模板。</p></blockquote><h2 id="f1f8" class="oj mf iu bd mg ok ol dn mk om on dp mo kn oo op ms kr oq or mw kv os ot na ou bi translated">选项1(更简单) :通过Firebase控制台</h2><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ov"><img src="../Images/33cecb0a938c929872df8d0d1053dbc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHHoPLbPvc4pYByI4AB7Cg.png"/></div></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">向用户发送重置密码电子邮件的步骤</figcaption></figure><h2 id="8111" class="oj mf iu bd mg ok ol dn mk om on dp mo kn oo op ms kr oq or mw kv os ot na ou bi translated">选项2:以编程方式</h2><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="36a0" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">通过使用<code class="fe ni nj nk nl b">sendPasswordResetEmail(email: String)</code>，用户将收到从Firebase控制台发送的重置密码电子邮件。通过单击电子邮件中嵌入的链接，用户将被定向到重置密码网页。以下是Firebase项目的默认模板。</p><figure class="nn no np nq gu jv gi gj paragraph-image"><div class="gi gj ow"><img src="../Images/b34e0c6768123d634b04d82298e8d191.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*bdcvb_kjeKowHUhDyXKCdw.png"/></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">重置密码的默认电子邮件模板</figcaption></figure><p id="3e9c" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">函数中可能会抛出一些异常:</p><ol class=""><li id="a90b" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidUserException</code>—当Firebase找不到具有已发送帐户电子邮件地址的帐户时。</li><li id="43f0" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidCredentialsException</code>:电子邮件地址格式不正确，例如<code class="fe ni nj nk nl b">example@!?!?!?.com</code></li></ol><p id="465d" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">你对管理员禁用用户帐号的情况感到好奇吗？它不会<strong class="ke iv">而不是</strong>抛出异常，重置密码邮件可以成功发送！Firebase仅在用户试图在重置密码网页重置密码时抛出错误。在我看来，这并不完美，Android SDK在这种情况下抛出一个异常应该更好。</p><p id="5f29" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">网页重置密码的总体流程:</p><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ox"><img src="../Images/7187ff9b4a7a764324f4c0cd31a5fd81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtFGBWrNAqJcN92xXJ2ldw.png"/></div></div></figure><blockquote class="nz oa ob"><p id="dd83" class="kc kd ny ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz in bi translated">*请注意，重置电子邮件地址后，原始用户凭证将不再有效，用户必须再次登录以更新其令牌，否则所有其他用于更新个人信息的功能将抛出<code class="fe ni nj nk nl b">FirebaseAuthInvalidUserException</code>。</p></blockquote></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="9567" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能5)更新密码</h1><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="1b12" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">通过调用<code class="fe ni nj nk nl b">updatePassword(password: String)</code>函数直接更新密码。密码必须至少包含6个字符。</p><ol class=""><li id="cae4" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidUserException</code>:用户账号已被管理员禁用。</li><li id="8916" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthWeakPasswordException</code> —给定的密码无效。[密码至少应包含6个字符]</li></ol></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="7a64" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能6)更新电子邮件</h1><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="d098" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">更新邮件与更新密码有些不同，虽然它也是调用一行代码<code class="fe ni nj nk nl b">updateEmail(newEmail: String)</code>。</p><p id="4e3c" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">在Firebase服务器上成功更改登录电子邮件后，会向用户发送一封确认电子邮件。由于垃圾邮件防护的Firebase策略，电子邮件模板不可定制。以下是确认电子邮件的示例:</p><figure class="nn no np nq gu jv gi gj paragraph-image"><div class="gi gj oy"><img src="../Images/e9358f59ab7ce55e13499326865f65e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*5RaAxsuypVGF8VxfrC8YiQ.png"/></div></figure><p id="df49" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">可能的例外情况:</p><ol class=""><li id="507d" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthUserCollisionException</code> : <br/>案例1:该电子邮件地址目前正被另一个账户使用。<br/>案例2:虽然该电子邮件地址目前没有被其他帐户占用，但它是其他用户注册的初始电子邮件。</li><li id="9978" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidUserException</code>:用户账号已被管理员禁用。</li><li id="4080" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidCredentialsException</code>:电子邮件地址格式不正确。</li></ol></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="eecb" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">功能7)删除用户帐户</h1><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="3f25" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">删除一个用户账号就像调用当前登录用户对象的<code class="fe ni nj nk nl b">delete()</code>函数一样简单。然而，仍然有一种可能的失败情况:</p><ol class=""><li id="927b" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">FirebaseAuthInvalidUserException</code>:用户账号已被管理员禁用。</li></ol><blockquote class="nz oa ob"><p id="5878" class="kc kd ny ke b kf kg kh ki kj kk kl km oc ko kp kq od ks kt ku oe kw kx ky kz in bi translated">*请注意，删除的帐户是不可恢复的，开发者应该在应用程序端警告用户，以获得更好的用户体验。</p></blockquote></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="835e" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">定制电子邮件模板</h1><p id="6c17" class="pw-post-body-paragraph kc kd iu ke b kf nc kh ki kj nd kl km kn of kp kq kr og kt ku kv oh kx ky kz in bi translated">上面已经介绍了两种电子邮件——重置密码电子邮件和更新电子邮件地址电子邮件。然而，只有重置密码电子邮件模板可以由管理员自由更改。由于垃圾邮件阻止的Firebase策略，禁止更新电子邮件地址模板。您可以在以下页面中自定义密码重置电子邮件模板:</p><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oz"><img src="../Images/2d517f68f5249b4f6a92a2727414ddca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9nTVqCYhkG3COX_w2vYbA.png"/></div></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">自定义密码重置电子邮件模板的步骤</figcaption></figure><p id="341a" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">最初的密码重置电子邮件模板非常简单，包含三个Firebase标签:</p><ol class=""><li id="ad9a" class="lj lk iu ke b kf kg kj kk kn ll kr lm kv ln kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">%LINK%</code> <strong class="ke iv">(必需)</strong>:用户可以重置其密码的链接</li><li id="4799" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">%APP_NAME%</code>:你的应用程序的公共名称</li><li id="045b" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">%EMAIL%</code>:用户的电子邮件地址</li></ol><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><figure class="nn no np nq gu jv gi gj paragraph-image"><div class="gi gj ow"><img src="../Images/b34e0c6768123d634b04d82298e8d191.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*bdcvb_kjeKowHUhDyXKCdw.png"/></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">重置密码的电子邮件模板示例</figcaption></figure><p id="15f6" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">在HTML代码和Firebase标签的帮助下，我们可以定制布局和内容。请参见下面的示例:</p><figure class="nn no np nq gu jv"><div class="bz fq l di"><div class="nv nw l"/></div></figure><figure class="nn no np nq gu jv gi gj paragraph-image"><div class="gi gj pa"><img src="../Images/5d5a2a911aaa00399e9c1057daf51f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*V6cdoq_Pthn6tZcIM_J3RA.png"/></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">定制电子邮件模板示例</figcaption></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="3f40" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">限制</h1><p id="b806" class="pw-post-body-paragraph kc kd iu ke b kf nc kh ki kj nd kl km kn of kp kq kr og kt ku kv oh kx ky kz in bi translated">为了防止滥用帐户创建，Firebase限制一个小时内只能从同一个IP地址创建100个帐户。在开发和QA阶段不方便。可以从<a class="ae nh" href="https://console.firebase.google.com/project/_/authentication/providers" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>临时更改该配额<strong class="ke iv">。<br/>.每个IP地址每小时最多注册人数:100 <br/>.计划时间:本年度内(365天)<br/>.最大天数范围:7天<br/>设置可能需要一个小时<strong class="ke iv">才能生效</strong>。</strong></p><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj pb"><img src="../Images/cf18e1330de87a4e8714394631f0142d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auC8yhI-8jNI6r4Uk6Mk8w.png"/></div></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">配置注册配额的步骤(每个IP一小时)</figcaption></figure><figure class="nn no np nq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj pc"><img src="../Images/646aa060cf7a12211d8fbf66d2fc015d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xuvG5qdtnxSGbLEnhEAQQ.png"/></div></div><figcaption class="nr ns gk gi gj nt nu bd b be z dk translated">注册配额配置设置对话框</figcaption></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="651c" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">摘要</h1><ol class=""><li id="333b" class="lj lk iu ke b kf nc kj nd kn ne kr nf kv ng kz lo lp lq lr bi translated">Firebase认证提供了许多注册选项，其中之一是电子邮件/密码。</li><li id="1c1e" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">Firebase SDK提供了注册、登录、退出、更新邮箱和密码、重置密码和删除帐户的功能。</li><li id="8849" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">几乎所有的函数，除了注销函数，都是异步函数，有3个回调函数来监听不同的事件。他们是<code class="fe ni nj nk nl b">OnCompleteListener</code>、<code class="fe ni nj nk nl b">OnSuccessListener</code>和<code class="fe ni nj nk nl b">OnFailureListener</code>。</li><li id="2f66" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated"><code class="fe ni nj nk nl b">OnCompleteListener</code>无论请求成功与否，当Firebase系统有响应时触发。</li><li id="2690" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">当请求在Firebase系统中被接受并完成时,<code class="fe ni nj nk nl b">OnSuccessListener</code>被触发。</li><li id="3701" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">当请求在Firebase系统中被拒绝时<code class="fe ni nj nk nl b">OnFailureListener</code>被触发。</li><li id="3cfa" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">只有未被占用的电子邮件地址和非初始注册电子邮件地址能够用于更新登录电子邮件地址。</li><li id="7dd9" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">通过调用函数<code class="fe ni nj nk nl b">setLanguageCode(locale: String)</code>，可以向不同语言的用户发送默认重置密码邮件。</li><li id="bc98" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">在Firebase系统中只能自定义重置密码模板。自定义重置密码电子邮件模板后，必须实施<a class="ae nh" href="https://firebase.google.com/docs/auth/custom-email-handler" rel="noopener ugc nofollow" target="_blank">自定义电子邮件操作处理程序</a>以支持多语言功能。</li><li id="552b" class="lj lk iu ke b kf ls kj lt kn lu kr lv kv lw kz lo lp lq lr bi translated">只有100个新帐户可以在同一IP每小时创建。它可以临时配置多达1000个新帐户，最长持续时间为7天。</li></ol></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="f613" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">阅读更多(iOS版)</h1><div class="pd pe gq gs pf pg"><a href="https://medium.com/@myrickchow32/ios-firebase-authentication-sdk-email-and-password-login-6a3bb27e0536" rel="noopener follow" target="_blank"><div class="ph ab fp"><div class="pi ab pj cl cj pk"><h2 class="bd iv gz z fq pl fs ft pm fv fx it bi translated">iOS Firebase身份验证SDK —电子邮件和密码登录</h2><div class="pn l"><h3 class="bd b gz z fq pl fs ft pm fv fx dk translated">Firebase提供了一个简单的SDK来验证用户的电子邮件和密码。电子邮件模板也可以定制…</h3></div><div class="po l"><p class="bd b dl z fq pl fs ft pm fv fx dk translated">medium.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu ka pg"/></div></div></a></div></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="adcb" class="me mf iu bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">参考:</h1><h2 id="031a" class="oj mf iu bd mg ok ol dn mk om on dp mo kn oo op ms kr oq or mw kv os ot na ou bi translated">1.使用电子邮件/密码登录的Firebase身份验证</h2><div class="pd pe gq gs pf pg"><a href="https://firebase.google.com/docs/auth/android/password-auth" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab fp"><div class="pi ab pj cl cj pk"><h2 class="bd iv gz z fq pl fs ft pm fv fx it bi translated">在Android上使用基于密码的帐户通过Firebase进行认证</h2><div class="pn l"><h3 class="bd b gz z fq pl fs ft pm fv fx dk translated">您可以使用Firebase身份验证让您的用户使用他们的电子邮件地址和…</h3></div><div class="po l"><p class="bd b dl z fq pl fs ft pm fv fx dk translated">firebase.google.com</p></div></div><div class="pp l"><div class="pv l pr ps pt pp pu ka pg"/></div></div></a></div><h2 id="8d02" class="oj mf iu bd mg ok ol dn mk om on dp mo kn oo op ms kr oq or mw kv os ot na ou bi translated">2.FirebaseUser官方文档</h2><div class="pd pe gq gs pf pg"><a href="https://firebase.google.com/docs/reference/android/com/google/firebase/auth/FirebaseUser" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab fp"><div class="pi ab pj cl cj pk"><h2 class="bd iv gz z fq pl fs ft pm fv fx it bi translated">Firebase用户| Firebase</h2><div class="pn l"><h3 class="bd b gz z fq pl fs ft pm fv fx dk translated">分析用户属性允许个性化信号</h3></div><div class="po l"><p class="bd b dl z fq pl fs ft pm fv fx dk translated">firebase.google.com</p></div></div><div class="pp l"><div class="pw l pr ps pt pp pu ka pg"/></div></div></a></div><p id="decf" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">如需了解更多信息，请在<a class="ae nh" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ myrik _ chow</a>关注我。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
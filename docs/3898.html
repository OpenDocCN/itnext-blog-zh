<html>
<head>
<title>Understanding React key</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解反应键</h1>
<blockquote>原文：<a href="https://itnext.io/understanding-react-key-18787854489a?source=collection_archive---------0-----------------------#2020-03-21">https://itnext.io/understanding-react-key-18787854489a?source=collection_archive---------0-----------------------#2020-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="5e6e" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">键给react元素一个稳定的</em> <code class="fe kp kq kr ks b"><em class="iq">identity</em></code></p></blockquote><h1 id="ccf2" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">没有关键字的数组中的警告</h1><pre class="lr ls lt lu gt lv ks lw lx aw ly bi"><span id="e5cc" class="lz ku iq ks b gy ma mb l mc md">import React from 'react';</span><span id="783f" class="lz ku iq ks b gy me mb l mc md">function App() {<br/>  const persons = [‘mike’, ‘jason’, ‘sharky’];<br/>  return &lt;ul&gt;<br/>    {persons.map(p =&gt; {<br/>      return &lt;li&gt;{p}&lt;/li&gt;<br/>    })}<br/>  &lt;/ul&gt;<br/>}</span></pre><p id="e274" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mf kd ke kf mg kh ki kj mh kl km kn ko ij bi translated">React会抛出一个警告，上面的代码是:<code class="fe kp kq kr ks b">Warning: Each child in a list should have a unique "key" prop.</code></p><h1 id="329d" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">用什么钥匙？</h1><p id="10d5" class="pw-post-body-paragraph jq jr iq jt b ju mi jw jx jy mj ka kb mf mk ke kf mg ml ki kj mh mm km kn ko ij bi translated">按键应该是<code class="fe kp kq kr ks b">unique</code>和<code class="fe kp kq kr ks b">stable</code></p><h1 id="093a" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">指数？也许吧，但只是<code class="fe kp kq kr ks b">under some circumstances</code></h1><p id="6d27" class="pw-post-body-paragraph jq jr iq jt b ju mi jw jx jy mj ka kb mf mk ke kf mg ml ki kj mh mm km kn ko ij bi translated">数组索引在数组中是唯一的。</p><pre class="lr ls lt lu gt lv ks lw lx aw ly bi"><span id="1c56" class="lz ku iq ks b gy ma mb l mc md">import React, { useState } from 'react';</span><span id="b278" class="lz ku iq ks b gy me mb l mc md">function App() {<br/>  const persons = [‘mike’, ‘jason’, ‘sharky’];<br/>  return &lt;ul&gt;<br/>    {persons.map((p, index) =&gt; {<br/>      return &lt;li key={index}&gt;{p}&lt;/li&gt;<br/>    })}<br/>  &lt;/ul&gt;<br/>}</span></pre><p id="93f2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mf kd ke kf mg kh ki kj mh kl km kn ko ij bi translated">但是，如果项目的顺序/数量可能改变，数组索引不是<code class="fe kp kq kr ks b">stable</code>。</p><pre class="lr ls lt lu gt lv ks lw lx aw ly bi"><span id="5798" class="lz ku iq ks b gy ma mb l mc md">import React, { useState } from 'react';</span><span id="24c5" class="lz ku iq ks b gy me mb l mc md">function App() {<br/>    const [persons, setPersons] = useState(<br/>    ['mike', 'jason', 'sharky']<br/>  );</span><span id="ca51" class="lz ku iq ks b gy me mb l mc md">  const onAdd = () =&gt; {<br/>    setPersons(['fishman', ...persons])<br/>  }<br/>  return &lt;&gt;<br/>    &lt;button onClick={onAdd}&gt; Add fishman on top &lt;/button&gt;<br/>    &lt;ul&gt;<br/>      {persons.map((p, index) =&gt; {<br/>        return &lt;li key={index}&gt;&lt;input type="checkbox"/&gt;{p}&lt;/li&gt;<br/>        })}<br/>      &lt;/ul&gt;<br/>  &lt;/&gt;<br/>}</span></pre><p id="d21a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mf kd ke kf mg kh ki kj mh kl km kn ko ij bi translated"><a class="ae mn" href="https://codesandbox.io/s/staging-resonance-vy7eq" rel="noopener ugc nofollow" target="_blank">array-index-as-key—code sandbox</a></p><p id="e9e9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mf kd ke kf mg kh ki kj mh kl km kn ko ij bi translated">勾选<code class="fe kp kq kr ks b">mike</code>然后点击添加按钮将导致<code class="fe kp kq kr ks b">mike</code>的检查状态消失</p><h1 id="0c5c" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><code class="fe kp kq kr ks b">Stable</code>键</h1><p id="d162" class="pw-post-body-paragraph jq jr iq jt b ju mi jw jx jy mj ka kb mf mk ke kf mg ml ki kj mh mm km kn ko ij bi translated">通常我们会为来自后端/数据库的每个记录提供一个唯一且稳定的属性。</p><pre class="lr ls lt lu gt lv ks lw lx aw ly bi"><span id="e6c7" class="lz ku iq ks b gy ma mb l mc md">import React, { useState } from ‘react’;</span><span id="6b87" class="lz ku iq ks b gy me mb l mc md">export default function App() {<br/>  const [persons, setPersons] = useState(<br/>    [<br/>      {id: 'uywoejk', name: 'mike'},<br/>      {id: 'woeioqj', name: 'jason'},<br/>      {id: 'eljlkqd', name: 'sharky'}<br/>    ]<br/>  );</span><span id="bd33" class="lz ku iq ks b gy me mb l mc md">  const onAdd = () =&gt; {<br/>    setPersons([{<br/>      id: 'wuioeioe', name: 'fishman'<br/>    }, ...persons])<br/>  }<br/>  return &lt;&gt;<br/>    &lt;button onClick={onAdd}&gt; Add fishman on top &lt;/button&gt;<br/>    &lt;ul&gt;<br/>      {<br/>        persons.map((p, index) =&gt; {<br/>          return &lt;li key={p.id}&gt;&lt;input type="checkbox"/&gt;{p.name}&lt;/li&gt;<br/>        })<br/>      }<br/>    &lt;/ul&gt;<br/>  &lt;/&gt;<br/>}</span></pre><p id="a23d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mf kd ke kf mg kh ki kj mh kl km kn ko ij bi translated"><a class="ae mn" href="https://codesandbox.io/s/gallant-visvesvaraya-0b3lo" rel="noopener ugc nofollow" target="_blank">稳定键—代码沙盒</a></p><h1 id="1f3d" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">使用键卸载组件</h1><p id="b9ea" class="pw-post-body-paragraph jq jr iq jt b ju mi jw jx jy mj ka kb mf mk ke kf mg ml ki kj mh mm km kn ko ij bi translated">用例:我有一个选择和输入组件。每次选择选项改变时，将输入重置为默认状态，</p><pre class="lr ls lt lu gt lv ks lw lx aw ly bi"><span id="cf71" class="lz ku iq ks b gy ma mb l mc md">import React, { useState } from “react”;</span><span id="5183" class="lz ku iq ks b gy me mb l mc md">export default function App() {<br/>  const [option, setOption] = useState("");<br/>  return (<br/>    &lt;&gt;<br/>      &lt;select onChange={e =&gt; setOption(e.target.value)}&gt;<br/>        &lt;option key="a"&gt;A&lt;/option&gt;<br/>        &lt;option key="b"&gt;B&lt;/option&gt;<br/>      &lt;/select&gt;<br/>      &lt;input defaultValue="this is default"/&gt;<br/>      &lt;input key={option} defaultValue="this is default" /&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><h1 id="e3b5" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><ul class=""><li id="72ab" class="mo mp iq jt b ju mi jy mj mf mq mg mr mh ms ko mt mu mv mw bi translated"><code class="fe kp kq kr ks b">key</code>是react元素的唯一标识符</li><li id="0a46" class="mo mp iq jt b ju mx jy my mf mz mg na mh nb ko mt mu mv mw bi translated"><code class="fe kp kq kr ks b">key</code>应该是<code class="fe kp kq kr ks b">unique</code>和<code class="fe kp kq kr ks b">stable</code>。在不同渲染阶段具有不同<code class="fe kp kq kr ks b">key</code>的react元素将被视为不同的元素。旧的将被卸载，并创建一个新的。</li><li id="e5a3" class="mo mp iq jt b ju mx jy my mf mz mg na mh nb ko mt mu mv mw bi translated">仅当数组项目的数量/顺序在整个应用程序生命周期中保持不变时，才使用数组索引作为键。</li><li id="0c15" class="mo mp iq jt b ju mx jy my mf mz mg na mh nb ko mt mu mv mw bi translated">始终倾向于使用后端/数据库唯一标识符id like属性作为<code class="fe kp kq kr ks b">key</code></li></ul><h1 id="00cd" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">通知；注意</h1><ul class=""><li id="cf1b" class="mo mp iq jt b ju mi jy mj mf mq mg mr mh ms ko mt mu mv mw bi translated">如果您想关注我的博客系列的最新消息/文章，请<a class="ae mn" href="https://github.com/n0ruSh/blogs/" rel="noopener ugc nofollow" target="_blank">【观看】</a>订阅。</li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Here’s how to find the change detection bottle-necks in your application.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以下是如何在您的应用程序中找到变化检测瓶颈的方法。</h1>
<blockquote>原文：<a href="https://itnext.io/heres-how-to-find-the-change-detection-bottle-necks-in-your-angular-application-333a71758477?source=collection_archive---------1-----------------------#2021-03-08">https://itnext.io/heres-how-to-find-the-change-detection-bottle-necks-in-your-angular-application-333a71758477?source=collection_archive---------1-----------------------#2021-03-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/1175662ff476c21ef253d37d7c7911a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WBu0I3S4hlhGc6mq"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://unsplash.com/@bundo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">本多·金</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="b238" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">并探索让您的角度应用充满活力的方法。</h2></div><p id="b325" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您知道角度变化检测有局限性吗？</p><p id="256f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你不明智，它会变得迟钝和酸涩，让你看起来像一个糟糕的开发者。</p><p id="0b0e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们打开Angular引擎的引擎盖怎么样？</p><p id="9e3d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并了解如何检测和修复变更检测问题？</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="gh gi lr"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure><h1 id="f664" class="lw lx jg bd ly lz ma mb mc md me mf mg km mh kn mi kp mj kq mk ks ml kt mm mn bi translated">角度变化检测是如何工作的？</h1><p id="294f" class="pw-post-body-paragraph kv kw jg kx b ky mo kh la lb mp kk ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">Angular使用一个广为人知的库Zone.js来检测DOM事件。这些DOM事件是鼠标点击、键盘按压等等。</p><p id="c709" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当Zone.js检测到一个DOM事件时，它会检查数据绑定并更新不正确的绑定，这样向用户显示的数据总是最新的。</p><p id="e017" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">简而言之，这就是变化检测。这可能是一个很酷的功能，但它有局限性…而且…如果你滥用角度变化检测，它会变得暴躁。</p><p id="65d1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么我们如何挖掘变更检测性能问题呢？</p><h1 id="0dc6" class="lw lx jg bd ly lz ma mb mc md me mf mg km mh kn mi kp mj kq mk ks ml kt mm mn bi translated">启用Angular的调试工具</h1><p id="35f7" class="pw-post-body-paragraph kv kw jg kx b ky mo kh la lb mp kk ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">打开<code class="fe mt mu mv mw b">main.ts</code>文件(用于引导您的Angular应用程序)并编辑这些代码行...</p><pre class="ls lt lu lv gt mx mw my mz aw na bi"><span id="9813" class="nb lx jg mw b gy nc nd l ne nf">platformBrowserDynamic().bootstrapModule(AppModule) <br/>   .catch(err =&gt; console.error(err));</span></pre><p id="0d21" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">…看起来像这样。</p><pre class="ls lt lu lv gt mx mw my mz aw na bi"><span id="5067" class="nb lx jg mw b gy nc nd l ne nf">platformBrowserDynamic().bootstrapModule(AppModule) <br/>   .then(module =&gt; enableDebugTools(module.injector.get(ApplicationRef).components[0]))      .catch(err =&gt; console.error(err));</span></pre><h1 id="21f2" class="lw lx jg bd ly lz ma mb mc md me mf mg km mh kn mi kp mj kq mk ks ml kt mm mn bi translated">分析更改检测时间</h1><p id="c0b7" class="pw-post-body-paragraph kv kw jg kx b ky mo kh la lb mp kk ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">现在我们已经启用了调试工具，我们可以使用它们来发现变更检测需要多长时间。</p><p id="2a1e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使用<code class="fe mt mu mv mw b">ng serve --open</code>运行我们的角度应用程序。</p><p id="38c0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦它在您的浏览器中启动，就在开发人员工具中打开控制台，并键入以下命令来测量上一个变更检测周期持续了多长时间。</p><pre class="ls lt lu lv gt mx mw my mz aw na bi"><span id="fdc7" class="nb lx jg mw b gy nc nd l ne nf">ng.profiler.timeChangeDetection()</span></pre><p id="5403" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于非常基本的角度应用，变化检测周期预计为0.01–0.05毫秒。尽管意见不一，我还是建议你永远不要让你的变更检测周期超过10ms。</p><h1 id="b38e" class="lw lx jg bd ly lz ma mb mc md me mf mg km mh kn mi kp mj kq mk ks ml kt mm mn bi translated">那么，如何修复糟糕的变更检测性能呢？</h1><p id="b5c0" class="pw-post-body-paragraph kv kw jg kx b ky mo kh la lb mp kk ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">假设我们有一个显示5000个随机数的角度组件。</p><pre class="ls lt lu lv gt mx mw my mz aw na bi"><span id="c141" class="nb lx jg mw b gy nc nd l ne nf">import { Component, OnInit } from '@angular/core'; </span><span id="7d66" class="nb lx jg mw b gy ng nd l ne nf">@Component({ <br/>   selector: 'app-number-list', <br/>   template: ` <br/>   &lt;ul&gt; <br/>      &lt;li *ngFor="let number of numbers"&gt;{{ number }}&lt;/li&gt; <br/>   &lt;/ul&gt; <br/>  `, <br/>  styleUrls: ['./number-list.component.css'] <br/>}) </span><span id="4bd6" class="nb lx jg mw b gy ng nd l ne nf">export class NumberListComponent implements OnInit { </span><span id="4cd4" class="nb lx jg mw b gy ng nd l ne nf">   numbers: number[] = []; </span><span id="caf1" class="nb lx jg mw b gy ng nd l ne nf">   constructor() { } </span><span id="a056" class="nb lx jg mw b gy ng nd l ne nf">   ngOnInit(): void { <br/>      this.generateNumbers(); <br/>   } </span><span id="f507" class="nb lx jg mw b gy ng nd l ne nf">   generateNumbers(): void { <br/>      for(let i = 0; i &lt; 5000; i++) { <br/>         let number = Math.random(); <br/>         this.numbers.push(number); <br/>      } <br/>   } <br/>}</span></pre><p id="d989" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你认为它的性能会有多好？</p><p id="a402" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我检查变更检测周期时，至少需要12-14毫秒。😮</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/48004655128e561706d7f5f8399d0fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/0*ggAIHP8yGpbA9ZHh.png"/></div></div></figure><p id="b691" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是一个性能不佳组件的简单示例。列表是长变化检测周期的罪魁祸首，修复长列表的好方法是使用虚拟滚动策略。棱角分明的材质CDK有一个很棒的<a class="ae jd" href="https://material.angular.io/cdk/scrolling/overview" rel="noopener ugc nofollow" target="_blank">虚拟滚动包</a>值得一试。</p><h1 id="e708" class="lw lx jg bd ly lz ma mb mc md me mf mg km mh kn mi kp mj kq mk ks ml kt mm mn bi translated">结论</h1><p id="115f" class="pw-post-body-paragraph kv kw jg kx b ky mo kh la lb mp kk ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">现在你明白了，我的朋友。您已经了解了如何快速启用变化检测调试，并找出角度变化检测需要多长时间。</p><p id="2977" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我的棱角忍者伙伴，如果你喜欢这篇文章，并发现它很有用，请务必点击它👏按钮，关注我，获取更多类似本文的精彩文章。</p><p id="29a3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">关注我:</strong> <a class="ae jd" href="https://github.com/dkreider" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，<a class="ae jd" href="https://dkreider.medium.com/" rel="noopener">中型</a>，<a class="ae jd" href="https://danielk.tech" rel="noopener ugc nofollow" target="_blank">个人博客</a></p><figure class="ls lt lu lv gt is gh gi paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="gh gi lr"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/2bcc92f5c45075187c0d41f774dc89a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/0*PwxveDLcF5NSDJiD.png"/></div></figure><div class="ip iq gp gr ir nj"><a href="https://dkreider.medium.com/add-feature-toggling-to-your-angular-app-the-ultimate-guide-2020-4548e01df07b" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd jh gy z fp no fr fs np fu fw jf bi translated">为您的Angular应用程序添加切换功能(2020年终极指南)</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">在角度应用中实现特征标志功能的终极指南</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">dkreider.medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ix nj"/></div></div></a></div><div class="ip iq gp gr ir nj"><a href="https://dkreider.medium.com/how-to-add-a-spinner-to-an-angular-material-button-the-simplest-way-ever-69e2f7005f29" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd jh gy z fp no fr fs np fu fw jf bi translated">如何将微调器添加到有角度的材质按钮。</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">呃…如果角状材料有一个带装载旋转器的按钮不是很好吗？</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">dkreider.medium.com</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx ix nj"/></div></div></a></div><div class="ip iq gp gr ir nj"><a href="https://dkreider.medium.com/why-i-choose-angular-instead-of-react-and-why-you-should-to-aef005c6d145" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd jh gy z fp no fr fs np fu fw jf bi translated">为什么我选择有角度的…而不是反应。以及为什么你应该这么做。</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">那么…为什么那么多React粉丝认为Angular是一个要避免的很深很黑的框架？还是说太难学了？或者…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">dkreider.medium.com</p></div></div><div class="ns l"><div class="nz l nu nv nw ns nx ix nj"/></div></div></a></div></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><p id="7628" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="oh">最初发布于</em><a class="ae jd" href="https://danielk.tech/home/heres-how-you-can-improve-angular-change-detection-performance" rel="noopener ugc nofollow" target="_blank"><em class="oh">https://danielk . tech</em></a><em class="oh">。</em></p></div></div>    
</body>
</html>
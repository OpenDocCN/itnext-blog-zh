<html>
<head>
<title>Mocking Objects in TypeScript, Functional Style</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模仿打字稿中的对象，函数风格</h1>
<blockquote>原文：<a href="https://itnext.io/mocking-in-typescript-a97267f7cea9?source=collection_archive---------0-----------------------#2017-12-05">https://itnext.io/mocking-in-typescript-a97267f7cea9?source=collection_archive---------0-----------------------#2017-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/169a885c873d6ebfbf6005b1c9d833af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_546D8JBzmwZpuwUbv8ZA.jpeg"/></div></div></figure><p id="a645" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我喜欢测试驱动开发的想法，因为它让你思考什么代码做什么，而不是T2如何做。</p><p id="17f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我目前的工作场所，我正在Angular中开发一个<strong class="ka ir">非常</strong>面向客户的在线商店应用程序。</p><p id="6863" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">即使我还没有达到TDD的水平，我也会努力让我的代码得到高的测试覆盖率，避免深夜打电话来说产品中的一个bug，以及可能会破坏我女儿的睡眠。</p><p id="bd73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">作为一家网上商店，我正在与像<strong class="ka ir">价格</strong>和<strong class="ka ir">产品</strong>这样的实体打交道。这些是非常精简的<strong class="ka ir">价格</strong>和<strong class="ka ir">产品</strong>接口版本。实际上，后端API返回超过25个属性的对象。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">Price.ts</figcaption></figure><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">产品. ts</figcaption></figure><p id="be95" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有一段代码类似于我每天都要测试的代码，它使用了上面的接口。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">产品用途</figcaption></figure><p id="dcf2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> filterProductsByName </strong>和<strong class="ka ir"> addPriceToProduct </strong>都是使用spread运算符的纯定制函数。</p><p id="baab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你对函数式编程感兴趣，我推荐你观看Mattias Petter Johansson的视频。</p><p id="f798" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面的代码<strong class="ka ir">按名称过滤</strong> <strong class="ka ir">产品</strong>，而<strong class="ka ir">将</strong>价格<strong class="ka ir">添加到<strong class="ka ir">产品</strong>中。</strong></p><h1 id="398d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">嗯，让我们看看它是否真的有效！</h1><p id="070b" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我已经用<em class="ml"> Jest </em>、<em class="ml"> Mocha </em>以及当然还有<em class="ml"> TypeScript </em>实现了测试。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">产品实用程序规范</figcaption></figure><p id="efc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Uff，<strong class="ka ir">超过60行</strong>的测试代码，用于14行实际实现。</p><h1 id="3eea" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">这伤害了我可爱的小灵魂！</h1><p id="2dcd" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">因为我们对考试很认真，所以我们需要做些什么。</p><p id="9d2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个想法是在看了一篇<a class="lg lh ep" href="https://medium.com/u/b889ae02aa26?source=post_page-----a97267f7cea9--------------------------------" rel="noopener" target="_blank"> Netanel Basal </a>关于<a class="ae mm" href="https://netbasal.com/getting-to-know-the-partial-type-in-typescript-ecfcfbc87cb6" rel="noopener ugc nofollow" target="_blank"> TypeScript的部分</a>的文章后想到的。</p><p id="ff66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我不声明整个<strong class="ka ir">产品</strong>实体，而是使用一个<strong class="ka ir">工厂函数</strong>，它接受一个<strong class="ka ir">部分&lt;产品&gt; </strong>参数(属于产品接口的属性子集)，并将其与一组默认属性合并，会怎么样？</p><p id="0222" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">即使我很着急，决定不带任何参数地调用<strong class="ka ir"> getProductMock </strong>，我仍然可以安全地使用一个有效的默认<strong class="ka ir">产品</strong>类型对象。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">产品.模拟. ts</figcaption></figure><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">价格.模拟. ts</figcaption></figure><h1 id="47e5" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">在我们的工具带中有那些花哨的工厂，让我们嘲笑吧！</h1><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">模拟产品实用程序规范</figcaption></figure><p id="8c02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你所看到的，使用这些模拟函数的测试是<strong class="ka ir">简洁的</strong>，并且比不使用模拟函数的测试少一半的大小。</p><p id="ca2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我只需要一个<strong class="ka ir">蓬松产品</strong> (grrr，倾向于写pussy:)，只提供它的名字。你猜怎么着？<strong class="ka ir"> getProductMock </strong>方法让我得以脱身，返回一个有效的产品。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><h1 id="da1a" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">就是这样，快乐嘲讽！</h1><p id="ddc5" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我希望你喜欢这篇文章，并会用这种简单的方式来嘲笑你的利益！</p></div></div>    
</body>
</html>
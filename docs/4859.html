<html>
<head>
<title>Access Tekton Pipelines in Java using Fabric8 Tekton Client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fabric8 Tekton客户端访问Java中的Tekton管道</h1>
<blockquote>原文：<a href="https://itnext.io/access-tekton-pipelines-in-java-using-fabric8-tekton-client-bd727bd5806a?source=collection_archive---------7-----------------------#2020-10-07">https://itnext.io/access-tekton-pipelines-in-java-using-fabric8-tekton-client-bd727bd5806a?source=collection_archive---------7-----------------------#2020-10-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6f8fc6c970d4c4727c35fbb5b811bc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*-58gIpXpeckgKtH8jJPUfA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/fabric8io/kubernetes-client/tree/master/extensions/tekton" rel="noopener ugc nofollow" target="_blank"> Fabric8 Tekton客户端</a></figcaption></figure><p id="1093" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">Fabric8 Kubernetes客户端还为<a class="ae jy" href="https://github.com/snowdrop/istio-java-api" rel="noopener ugc nofollow" target="_blank"> Istio </a>、<a class="ae jy" href="https://knative.dev/" rel="noopener ugc nofollow" target="_blank"> Knative </a>、<a class="ae jy" href="https://tekton.dev/" rel="noopener ugc nofollow" target="_blank"> Tekton </a>和<a class="ae jy" href="https://kubernetes.io/docs/concepts/extend-kubernetes/service-catalog/" rel="noopener ugc nofollow" target="_blank">服务目录</a>提供了非常有用的扩展。从那以后，它已经进化了很多。今天，我将简要介绍Fabric8 Tekton extension。</p><div class="kx ky gp gr kz la"><a href="https://github.com/fabric8io/kubernetes-client" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd ir gy z fp lf fr fs lg fu fw ip bi translated">fabric 8 io/kubernetes-客户端</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">这个客户端通过一个流畅的DSL提供对完整的Kubernetes和OpenShift REST APIs的访问。</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">github.com</p></div></div><div class="lj l"><div class="lk l ll lm ln lj lo js la"/></div></div></a></div><h1 id="2120" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">获取Fabric8 Tekton客户端:</h1><p id="5fe2" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">你可以像往常一样在<a class="ae jy" href="https://search.maven.org/search?q=tekton-client" rel="noopener ugc nofollow" target="_blank"> Maven Central </a>上找到Tekton客户端。您可以通过将Tekton client作为依赖项添加到您的<code class="fe ms mt mu mv b">pom.xml</code>中来开始使用它:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="8792" class="ne lq iq mv b gy nf ng l nh ni">&lt;dependencies&gt;<br/>  &lt;dependency&gt;<br/>    &lt;groupId&gt;io.fabric8&lt;/groupId&gt;<br/>    &lt;artifactId&gt;tekton-client&lt;/artifactId&gt;<br/>    &lt;version&gt;${tekton-client.version}&lt;/version&gt;<br/>  &lt;/dependency&gt;<br/>&lt;/dependencies&gt;</span></pre><p id="436f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">Tekton客户端的大部分用法都很容易理解，并且与其母Fabric8 Kubernetes客户端相似。这是使用<code class="fe ms mt mu mv b">v1alpha1</code>或<code class="fe ms mt mu mv b">v1beta1</code> apiVersions的一个非常基本的顶级概述:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">结构中的DSL入口点8 Tekton客户端</figcaption></figure><h1 id="e366" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">列出给定命名空间中的所有管道:</h1><p id="e419" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">一旦添加为依赖项，您就可以开始使用Fabric8 Tekton客户端。让我们从列出所有的<code class="fe ms mt mu mv b">Pipeline</code>对象开始。以下是使用Fabric8 Tekton客户端的操作方法:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">列出默认命名空间中的所有管道</figcaption></figure><h1 id="50d5" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">使用Fabric8的构建器创建Tekton资源:</h1><p id="7ec0" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">因为Tekton客户端基于Tekton模型，该模型是通过将Tekton源代码中的go结构解析成JSON模式，然后在其上使用<a class="ae jy" href="https://github.com/sundrio/sundrio/" rel="noopener ugc nofollow" target="_blank"> sundrio </a>而形成的。我们得到了非常有用的构建器对象，使用它们我们可以快速构建Tekton资源，而不需要从任何Yaml清单中加载任何东西。下面是一个创建hello world <code class="fe ms mt mu mv b">Task</code>和<code class="fe ms mt mu mv b">TaskRun</code>的例子:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">使用构建器创建hello world任务</figcaption></figure><h1 id="4424" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">将YAML·泰克顿清单载入Java对象:</h1><p id="5851" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">Fabric8 Tekton客户端，就像Fabric8 Kubernetes客户端一样，在将YAML清单序列化到Java对象或从Java对象反序列化时，提供了无缝的开发人员体验。假设您有这样一个简单的<code class="fe ms mt mu mv b">Pipeline</code>(摘自<a class="ae jy" href="https://github.com/tektoncd/triggers/blob/master/examples/example-pipeline.yaml" rel="noopener ugc nofollow" target="_blank"> Tekton Github库示例</a>):</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">简单管道YAML清单</figcaption></figure><p id="7e8c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果我想将这个<code class="fe ms mt mu mv b">Pipeline</code>加载到一个Java对象中，然后将它应用到Kubernetes上，我会这样做:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">将YAML清单加载到Java对象</figcaption></figure><h1 id="2f0f" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">创建、更新和删除Tekton资源:</h1><p id="db34" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">如果你已经熟悉Fabric8 Kubernetes客户端API，你就不会面临任何标准操作的问题。如果你正在访问一些资源(例如，<code class="fe ms mt mu mv b">Task</code>)。您可以使用以下方式访问它:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">CRUD操作概述</figcaption></figure><p id="d047" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">让我们来看一个使用Fabric8 Tekton客户端的CRUD操作的工作示例。我们将加载、编辑并最终删除一个<code class="fe ms mt mu mv b">Route</code>对象。以下是这一系列操作的代码:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">tekton.dev/v1beta1#Task的CRUD操作</figcaption></figure><h1 id="a7c1" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">创建触发器:</h1><p id="1fd9" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">Fabric8 Tekton客户端最近支持<a class="ae jy" href="https://github.com/tektoncd/triggers" rel="noopener ugc nofollow" target="_blank"> Tekton触发器</a>。现在，您可以使用Fabric8 Tekton Client轻松定义管道触发器。让我们考虑一个例子，假设您使用Fabric8 Tekton Client创建了这个简单的maven deployer管道，它使用<a class="ae jy" href="https://github.com/eclipse/jkube" rel="noopener ugc nofollow" target="_blank"> Eclipse JKube </a>部署任何基于maven的应用程序:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="9505" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在，如果我想使用Fabric8 Tekton客户端创建一个<code class="fe ms mt mu mv b">TriggerTemplate</code>、<code class="fe ms mt mu mv b">TriggerBinding</code>和<code class="fe ms mt mu mv b">EventListener</code>。我会这样做:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="a905" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这将创建所有提到的资源。EventListener还会创建一个<code class="fe ms mt mu mv b">Pod</code>，您可以使用<code class="fe ms mt mu mv b">kubectl port-forward $(kubectl get pod -o=name -l eventlistener=jkube-listener) 8080</code>将它向前移植。这将暴露您接受连接的触发器。</p><p id="b518" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这就是我对Fabric8 Tekton客户端的简短概述。我希望你喜欢它。请试用并提供反馈。我在这个Github资源库中提供了与这个博客相关的所有代码:</p><div class="kx ky gp gr kz la"><a href="https://github.com/rohanKanojia/tekton-java-client-demo" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd ir gy z fp lf fr fs lg fu fw ip bi translated">rohanKanojia/tek ton-Java-客户端-演示</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">这个项目通过创建一个简单的管道来演示Fabric8 Tekton Java客户端的使用，该管道使用Eclipse JKube来…</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">github.com</p></div></div><div class="lj l"><div class="nl l ll lm ln lj lo js la"/></div></div></a></div><h1 id="7754" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">加入我们:</h1><p id="11a8" class="pw-post-body-paragraph jz ka iq kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ij bi translated">你喜欢Fabric8 Kubernetes的客户，并希望参与项目的开发。随意参与方法:</p><ul class=""><li id="1b89" class="nm nn iq kb b kc kd kg kh kk no ko np ks nq kw nr ns nt nu bi translated">当事情没有按预期运行时，创建<a class="ae jy" href="https://github.com/fabric8io/kubernetes-client/issues" rel="noopener ugc nofollow" target="_blank"> Github问题</a></li><li id="f3e8" class="nm nn iq kb b kc nv kg nw kk nx ko ny ks nz kw nr ns nt nu bi translated">给我们发<a class="ae jy" href="https://github.com/fabric8io/kubernetes-client/pulls" rel="noopener ugc nofollow" target="_blank">拉请求</a>来修复错误/添加增强功能</li><li id="5e5b" class="nm nn iq kb b kc nv kg nw kk nx ko ny ks nz kw nr ns nt nu bi translated">在我们的<a class="ae jy" href="https://gitter.im/fabric8io/kubernetes-client?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" rel="noopener ugc nofollow" target="_blank"> Gitter频道</a>与我们聊天</li><li id="e30a" class="nm nn iq kb b kc nv kg nw kk nx ko ny ks nz kw nr ns nt nu bi translated">在推特上关注我们</li></ul></div></div>    
</body>
</html>
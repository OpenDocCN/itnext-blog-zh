<html>
<head>
<title>Microsoft proposes bringing TypeScript-like type syntax to JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微软提议将类似类型脚本的类型语法引入JavaScript</h1>
<blockquote>原文：<a href="https://itnext.io/microsoft-proposes-bringing-typescript-like-type-syntax-to-javascript-cdbbda7f5a2?source=collection_archive---------2-----------------------#2022-03-10">https://itnext.io/microsoft-proposes-bringing-typescript-like-type-syntax-to-javascript-cdbbda7f5a2?source=collection_archive---------2-----------------------#2022-03-10</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="a2f4" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">近期目标是通过添加类型信息来增加代码分析工具的功能</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/ddbff188cae09e2f02d128b9da890e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VjTNb04L_XmoVuww.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><p id="4c6d" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated"><strong class="lb iv">你并不是每天都能在Twitter上看到TypeScript成为热门话题。但是，微软将类型语法引入JavaScript的提议无疑是一件大事，值得成为Twitter的热门话题。JavaScript的类型？</strong></p><p id="3cdb" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">喜欢JavaScript这种非类型语言的人不用担心。微软的提议是不在JavaScript中添加类型检查或强制。相反，该建议增加了类型声明的语法，但将其视为注释。这大概意味着JavaScript引擎可以有选择地关注类型语法并做一些有用的事情。但是，现在的目标是向JavaScript代码添加更多信息，以便编程工具可以做更多有用的事情。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj lv"><img src="../Images/20d1d857a23220cdca80269f40ff1067.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/0*phuyF1jm4yTpdOew.png"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">2022年3月9日晚推特“What's Trending”屏蔽</figcaption></figure><p id="11b1" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">世界上正在发生一些非常重要的事情。理论上，Twitter上的“热门话题”板块应该反映什么是重要的。但是，正如我上面所说的，像TypeScript这样的东西并不是每天都达到这种重要程度，所以让我们试着理解一下这是怎么回事。</p><p id="eb24" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">首先，当然JavaScript在其存在的整个过程中对类型的支持很少。使用<code class="fe lw lx ly lz b">typeof</code>或<code class="fe lw lx ly lz b">instanceof</code>来区分事物是可能的，并且<code class="fe lw lx ly lz b">number</code>和<code class="fe lw lx ly lz b">string</code>之间有轻微的行为差异，但是总的来说我们在JavaScript中有一个自由选择。这被认为是生产率的提高，因为JavaScript程序员在编写代码时需要处理的事情更少了。这与Java程序员形成了鲜明的对比，Java程序员做任何事情都必须点上每个“I”并跨过每个“t”。</p><p id="0bc4" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">随着我们的JavaScript程序变得越来越大，理论上，严谨地编写代码变得越来越重要。正如我在书中写的</p><p id="892e" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated"><a class="ae ma" href="https://www.amazon.com/Quick-Typescript-TypeORM-Node-js-applications-ebook/dp/B07S87X4ZK?crid=1P423P8Y4EG42&amp;keywords=quick%20start%20typescript%20node.js&amp;qid=1646896504&amp;sprefix=%2Caps%2C346&amp;sr=8-1&amp;linkCode=ll1&amp;tag=thereikipage&amp;linkId=30046c86ca06bffbf60c9ec07836ee73&amp;language=en_US&amp;ref_=as_li_ss_tl" rel="noopener ugc nofollow" target="_blank"> <em class="mb">快速入门使用Node.js上的Typescript和TypeORM进行CLI和web应用</em> </a>:</p><blockquote class="mc md me"><p id="9581" class="kz la mb lb b lc ld jv le lf lg jy lh mf lj lk ll mg ln lo lp mh lr ls lt lu in bi translated">在一个小的应用程序中，一个程序员可以很容易地检查代码，找出编码错误，并记住整个程序。但是，在大型团队开发的大型应用程序中，手动查找编码错误要困难得多。很可能，在大型应用程序中，没有一个程序员能够理解所有的东西，这使得用可视化代码评审来捕捉bug变得更加困难。</p></blockquote><p id="6355" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">虽然这本书是关于如何在Node.js上使用TypeScript，但我觉得有必要说明在JavaScript中使用类型的情况。也就是说，我们正在用JavaScript编写越来越大的应用程序。我相信这意味着我们需要JavaScript生态系统中更强大的工具来管理更大的代码堆。</p><p id="8b90" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">但是..我跑题了，因为微软的提议并不是要给JavaScript带来类型检查。相反，微软的提议仅仅是让在常规JavaScript中使用类型语法成为可能，并让类型语法被视为注释。</p><p id="8cea" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">为什么把语法引入JavaScript只是为了忽略它？显然，目的是让JavaScript工具对类型信息做一些事情。这可能意味着像ESLint或IDE之类的工具可以拥有更丰富的信息。有了更丰富的信息，这个工具可以为程序员做更多有用的事情。</p><h1 id="bf95" class="mi mj iu bd mk ml mm mn mo mp mq mr ms ka mt kb mu kd mv ke mw kg mx kh my mz bi translated">JavaScript+类型的语法示例</h1><p id="1f3e" class="pw-post-body-paragraph kz la iu lb b lc na jv le lf nb jy lh li nc lk ll lm nd lo lp lq ne ls lt lu in bi translated">建议将结果称为JS+类型或JavaScript+类型。</p><p id="94b1" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated"><a class="ae ma" href="https://devblogs.microsoft.com/typescript/a-proposal-for-type-syntax-in-javascript/" rel="noopener ugc nofollow" target="_blank">微软的提议</a>指出，目前我们可以像这样使用JSDoc语法:</p><pre class="kk kl km kn gu nf lz ng nh aw ni bi"><span id="1c88" class="nj mj iu lz b gz nk nl l nm nn">/**<br/> * @param a {number}<br/> * @param b {number}<br/> */<br/>function add(a, b) {<br/>    return a + b;<br/>}</span></pre><p id="61ee" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">像JSDoc这样的JavaScript工具可以查看这些结构化的注释并做一些有用的事情。例如，TypeScript可以读取这些注释，为它提供执行类型检查所需的信息。JavaScript执行引擎会忽略这一点，但是其他工具可以注意这一点来执行有用的功能。</p><p id="ad6f" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们的建议是这样写的:</p><pre class="kk kl km kn gu nf lz ng nh aw ni bi"><span id="bc92" class="nj mj iu lz b gz nk nl l nm nn">function add(a: number, b: number) {<br/>     return a + b; <br/>}</span></pre><p id="a52d" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这正是TypeScript语法。</p><p id="2a5e" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">第0阶段提案描述了许多要支持的特定语法:</p><pre class="kk kl km kn gu nf lz ng nh aw ni bi"><span id="1497" class="nj mj iu lz b gz nk nl l nm nn">function stringsStringStrings(p1: string, p2?: string,<br/>                             p3?: string, p4 = "test"): string {<br/>     // TODO <br/>}  </span><span id="d1ac" class="nj mj iu lz b gz no nl l nm nn">let x: string;  </span><span id="d4a5" class="nj mj iu lz b gz no nl l nm nn">interface Person {<br/>     name: string;<br/>     age: number; <br/>}  </span><span id="d0e4" class="nj mj iu lz b gz no nl l nm nn">type CoolBool = boolean;</span><span id="d5b6" class="nj mj iu lz b gz no nl l nm nn">class Person {<br/>     name: string;<br/>     constructor(name: string) {<br/>         this.name = name;<br/>     }<br/>      getGreeting(): string {<br/>         return `Hello, my name is ${this.name}`;<br/>     } <br/>}  </span><span id="5006" class="nj mj iu lz b gz no nl l nm nn">const point = JSON.parse(serializedPoint) as ({ x: number, y: number });  </span><span id="185a" class="nj mj iu lz b gz no nl l nm nn">type Foo&lt;T&gt; = T[]  interface Bar&lt;T&gt; {<br/>     x: T; <br/>}  </span><span id="8a7f" class="nj mj iu lz b gz no nl l nm nn">function foo&lt;T&gt;(x: T) {<br/>     return x; <br/>}  </span><span id="6293" class="nj mj iu lz b gz no nl l nm nn">class Box&lt;T&gt; {<br/>     value: T;<br/>     constructor(value: T) {<br/>         this.value = value;<br/>     } <br/>}  </span><span id="2a04" class="nj mj iu lz b gz no nl l nm nn">add&lt;number&gt;(4, 5) <br/>new Point&lt;bigint&gt;(4n, 5n)</span></pre><p id="74b3" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">换句话说，这完全是照本宣科。</p><h1 id="c387" class="mi mj iu bd mk ml mm mn mo mp mq mr ms ka mt kb mu kd mv ke mw kg mx kh my mz bi translated">JavaScript+类型的优势</h1><p id="82b4" class="pw-post-body-paragraph kz la iu lb b lc na jv le lf nb jy lh li nc lk ll lm nd lo lp lq ne ls lt lu in bi translated">对于TypeScript或Flow，在执行代码之前有一个编译步骤。许多语言的程序员都有编译步骤，但是JavaScript程序员从来没有过。执行前不需要编译有助于提高生产率。</p><p id="1da3" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">该提案将类型信息描述为<em class="mb">类型注释</em>。作为注释，像<code class="fe lw lx ly lz b">const x: number = 42</code>这样的声明中的类型信息被视为注释。这意味着大多数工具将解析类型注释，然后忽略它。但是也可以开发其他工具来做一些有用的事情。</p><h1 id="9241" class="mi mj iu bd mk ml mm mn mo mp mq mr ms ka mt kb mu kd mv ke mw kg mx kh my mz bi translated">下一步是什么？</h1><p id="508b" class="pw-post-body-paragraph kz la iu lb b lc na jv le lf nb jy lh li nc lk ll lm nd lo lp lq ne ls lt lu in bi translated">微软计划在TC39委员会2022年3月的全体会议上，将此作为<em class="mb"> Stage 1 </em>提案提出。在那个阶段，ECMAScript委员会将会认为这个特性值得进一步开发。</p><p id="fdcd" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">JavaScript执行引擎会有添加类型检查的选项吗？不。以下是微软要说的:</p><blockquote class="mc md me"><p id="be7c" class="kz la mb lb b lc ld jv le lf lg jy lh mf lj lk ll mg ln lo lp mh lr ls lt lu in bi translated"><em class="iu">我们认为这样做会给JavaScript和TypeScript用户带来一系列问题，比如运行时性能、与现有TypeScript代码的兼容性问题，以及停止类型检查领域创新的风险。</em></p><p id="f03f" class="kz la mb lb b lc ld jv le lf lg jy lh mf lj lk ll mg ln lo lp mh lr ls lt lu in bi translated"><em class="iu">相反，我们只是提出与TypeScript兼容并受其启发的语法，它可以被任何类型检查器使用，但会被JavaScript引擎跳过。我们相信这种方法对每个人来说都是最有前途的，并将继续允许TypeScript、Flow和其他人继续创新。</em></p></blockquote><p id="38a9" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我相信这是JavaScript生态系统向前迈出的激动人心的一步。它符合TypeScript被用作试验语言特性的沃土的模型，其中一些特性将变成官方的JavaScript语言提案。一旦这个特性被标准化，看看有什么编程工具变得可用将会很有趣。</p><h1 id="cee0" class="mi mj iu bd mk ml mm mn mo mp mq mr ms ka mt kb mu kd mv ke mw kg mx kh my mz bi translated">关于作者</h1><p id="a2b4" class="pw-post-body-paragraph kz la iu lb b lc na jv le lf nb jy lh li nc lk ll lm nd lo lp lq ne ls lt lu in bi translated"><a class="ae ma" href="https://davidherron.com" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iv"> <em class="mb">大卫·赫伦</em> </strong> </a> <em class="mb">:大卫·赫伦是一名作家和软件工程师，专注于技术的明智使用。他对太阳能、风能和电动汽车等清洁能源技术特别感兴趣。David在硅谷从事了近30年的软件工作，从电子邮件系统到视频流，再到Java编程语言，他已经出版了几本关于Node.js编程和电动汽车的书籍。</em></p></div><div class="ab cl np nq hy nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="in io ip iq ir"><p id="fb50" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated"><em class="mb">原载于</em><a class="ae ma" href="https://techsparx.com/nodejs/news/2022/typescript-trending.html" rel="noopener ugc nofollow" target="_blank"><em class="mb">https://techsparx.com</em></a><em class="mb">。</em></p></div></div>    
</body>
</html>
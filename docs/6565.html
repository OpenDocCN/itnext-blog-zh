<html>
<head>
<title>Modern C++ in Advent of Code: Day19</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代C++在《代码的来临:第19天》</h1>
<blockquote>原文：<a href="https://itnext.io/modern-c-in-advent-of-code-day19-ff9525afb2ee?source=collection_archive---------3-----------------------#2021-12-19">https://itnext.io/modern-c-in-advent-of-code-day19-ff9525afb2ee?source=collection_archive---------3-----------------------#2021-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5217" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天是代码问世的第十九天<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">。今天，我们将根据传感器报告的数据来检测它们的方向和位置。</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/f6efb80f7c74fc73c20d4bdafdb55011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdl2k6IYIEdObfmnlm-LbA.png"/></div></div></figure><p id="235f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，请先尝试解决问题，然后再看解决方案。对于本系列中的所有文章，<a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">请看这个列表</a>。</p><h1 id="d549" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第19天</h1><p id="d7bb" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">对于第19天，我们需要确定观察信标的传感器的位置。每个传感器处于未知方位的未知位置。然而，我们知道传感器在十二个或更多信标上与至少一个其他传感器重叠。</p><p id="e109" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们暂时忽略方向，看看如何在一维情况下检测两个传感器是否重叠:</p><p id="4864" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mb mc md me b">-------A-i-j--B-k-------</code></p><p id="d3c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果传感器A和B的方向相同(从左到右)，并且情况与图表相符，它们将报告以下值:</p><ul class=""><li id="85f6" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">答:我:2，j:4，k:9</li><li id="1e04" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">b:我:-5，j:-3，k:2</li></ul><p id="89b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们可以很容易地验证这些传感器是否重叠，因为<code class="fe mb mc md me b">2-(-5) == 4-(-3) == 9 — 2 == 7</code>也是传感器B与传感器a的相对位置。</p><p id="7432" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的任务是3D的，这并不能改变问题。我们只是同时使用三个轴，它们都需要匹配。然而，棘手的是，传感器可以在24个有效方向中的任何一个方向上，例如，报告的[x，y，z]可以是[-z，x，-y](例如)。</p><p id="447b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道一些传感器重叠了至少12个值。因此，我们可以尝试所有的方向。如果产生重叠，我们知道这是这两个传感器之间的正确方向和相对位置。</p><h2 id="15f0" class="mt kz iq bd la mu mv dn le mw mx dp li jy my mz lm kc na nb lq kg nc nd lu ne bi translated">要点</h2><p id="dd65" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们需要一个3D点的表示:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="013f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还需要代表24种可能的方向:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="cd4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用矩阵乘法生成这个表。然而，今天的问题足够复杂，所以我使用骰子旋转方法手动创建了这个表。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="566b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">rotate方法创建了一个三元素数组(第24行)，所以我们可以使用旋转索引(0，1，2)来选取X，Y或Z坐标，用<code class="fe mb mc md me b">.second</code>表示符号。</p><h2 id="bef6" class="mt kz iq bd la mu mv dn le mw mx dp li jy my mz lm kc na nb lq kg nc nd lu ne bi translated">扫描仪</h2><p id="6838" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">每个扫描仪都有一个信标(3D点)列表和两种方法:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e776" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mb mc md me b">overlaps()</code>检查两台扫描仪是否至少在<code class="fe mb mc md me b">threshold</code>个信标数量上重叠，然后<code class="fe mb mc md me b">normalize()</code>将所有坐标修改为上一步计算的相对位置和方向。</p><p id="0c7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天的输入解析对于C++来说尤其成问题。该格式使用带有减号的标题。试图在一个传感器的输入端读取一个数字将会从下一个传感器的头部读取负号。因此，我们必须逐行读取输入:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="af77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了检测两个传感器是否重叠，我们迭代所有可能的方向。对于每个方向，如果至少有<code class="fe mb mc md me b">threshold</code>对信标具有相同的相对3D位置增量，我们知道我们已经找到了我们期望的方向以及两个传感器之间的位置增量。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="3413" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了标准化，我们旋转并移动每个信标到期望的位置。</p><h2 id="b492" class="mt kz iq bd la mu mv dn le mw mx dp li jy my mz lm kc na nb lq kg nc nd lu ne bi translated">信标数量</h2><p id="3f32" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">为了计算信标总数，我们需要对所有扫描器应用重叠和归一化操作。为了避免重复工作，我们可以做一个简单的呼吸优先搜索:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="4d26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们尝试将每个传感器相互匹配(仍然是未标准化的传感器)。如果我们发现重叠，我们就正常化。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="c6ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦所有传感器都标准化为传感器0，我们必须根据它们的位置计算唯一信标。</p><h2 id="e73c" class="mt kz iq bd la mu mv dn le mw mx dp li jy my mz lm kc na nb lq kg nc nd lu ne bi translated">曼哈顿距离</h2><p id="6e08" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">由于我们所有的传感器都计算了它们的相对位置(根据上一步)，我们可以循环扫描扫描仪以获得最长距离:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h1 id="b0aa" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">链接和技术说明</h1><p id="d512" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">每日解决方案存储库位于:<a class="ae kl" href="https://github.com/HappyCerberus/moderncpp-aoc-2021" rel="noopener ugc nofollow" target="_blank">https://github.com/HappyCerberus/moderncpp-aoc-2021</a>。</p><p id="8f92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">看看这个列表，里面有关于《代码降临》</a>其他日子的文章。</p><p id="6879" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请不要忘记亲自尝试<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">降临码</a>。</p><h1 id="2d08" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">感谢您的阅读</h1><p id="5348" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">感谢您阅读这篇文章。你喜欢吗？</p><p id="3dc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也在YouTube上发布视频。你有问题吗？在推特或LinkedIn 上联系我。</p></div></div>    
</body>
</html>
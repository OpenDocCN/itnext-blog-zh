<html>
<head>
<title>Github: Github Actions overview and ArgoCD deployment example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Github: Github操作概述和ArgoCD部署示例</h1>
<blockquote>原文：<a href="https://itnext.io/github-github-actions-overview-and-argocd-deployment-example-b6cf0cf6f832?source=collection_archive---------5-----------------------#2021-05-07">https://itnext.io/github-github-actions-overview-and-argocd-deployment-example-b6cf0cf6f832?source=collection_archive---------5-----------------------#2021-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3def375ece2990081c301e8add6d1396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k99_arb0x9B7LI4I5hhCPw.png"/></div></div></figure><p id="52ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> Github Actions </a>实际上与<a class="ae kw" href="https://rtfm.co.ua/category/ci-cd-ru/travis-ru/" rel="noopener ugc nofollow" target="_blank"> TravisCI </a>非常相似，但与Github的集成更加紧密，甚至其接口也包含在Github WebUI中:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/33e5544d99b07fb9ce3ee7598c519b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4MzGdk3-Rpy1w4TY.png"/></div></div></figure><p id="339d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，让我们仔细看看它的能力，如何使用它，在下面的帖子中，我们将把它的自托管运行器部署到一个Kubernetes集群，并将使用Github Actions和<a class="ae kw" href="https://rtfm.co.ua/tag/argocd/" rel="noopener ugc nofollow" target="_blank"> ArgoCD </a>构建一个CI/CD管道来部署应用程序。</p><ul class=""><li id="27db" class="lc ld iq ka b kb kc kf kg kj le kn lf kr lg kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Github_Actions_pricing" rel="noopener ugc nofollow" target="_blank"> Github动作定价</a></li><li id="c3bb" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Github_Actions_an_overview" rel="noopener ugc nofollow" target="_blank"> Github操作:概述</a></li><li id="7be0" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#A_workflow_file_structure" rel="noopener ugc nofollow" target="_blank">工作流文件结构</a></li><li id="3708" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Getting_started_Creating_workflow_file" rel="noopener ugc nofollow" target="_blank">入门:创建工作流文件</a></li><li id="701c" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Events" rel="noopener ugc nofollow" target="_blank">事件</a></li><li id="572f" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Manual_trigger_-_workflow_dispatch" rel="noopener ugc nofollow" target="_blank">手动触发—工作流_调度</a></li><li id="b0f6" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Workflow_inputs" rel="noopener ugc nofollow" target="_blank">工作流程输入</a></li><li id="61d7" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated">Webhooks:创建</li><li id="bd8f" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Environment_variables" rel="noopener ugc nofollow" target="_blank">环境变量</a></li><li id="2732" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Secrets" rel="noopener ugc nofollow" target="_blank">秘密</a></li><li id="9133" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Conditions_and_if" rel="noopener ugc nofollow" target="_blank">条件和如果</a></li><li id="7431" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#needs_-_jobs_dependency" rel="noopener ugc nofollow" target="_blank">需求—工作依赖</a></li><li id="93d6" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Actions" rel="noopener ugc nofollow" target="_blank">行动</a></li><li id="1afc" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#An_ArgoCD_application" rel="noopener ugc nofollow" target="_blank">一个ArgoCD应用</a></li><li id="4801" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/#Github_Actions_workflow_for_ArgoCD" rel="noopener ugc nofollow" target="_blank">ArgoCD的Github动作工作流程</a></li></ul><h1 id="305a" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">Github操作定价</h1><p id="dff6" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">这里的文档是<a class="ae kw" href="https://docs.github.com/en/github/setting-up-and-managing-billing-and-payments-on-github/about-billing-for-github-actions" rel="noopener ugc nofollow" target="_blank">&gt;&gt;&gt;</a>。</p><p id="a2db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">GitHub Actions对所有帐户类型都是免费的，但有一些限制:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/5de77a472535655e111f549a2d90e5b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*xkja8X0wpaLl5FGZaN2-BQ.png"/></div></figure><p id="0b91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我们的项目使用GitHub团队，因此我们每月可以有2gb和3000分钟。</p><p id="6f39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，Linux、macOS和Windows的分钟数不同:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/244088311944ec362eecc4f49bda5545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*_kZLyMrsVKOLMez-7Zw7AA.png"/></div></figure><p id="e7fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">也就是说，在我们总共3000分钟的时间里，如果我们使用macOS代理，我们只能使用300分钟，每多花一分钟就要额外付费:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/a89112b4ed1fccad581f2253b548086e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*_sg9ddJgwzfcS2mCGUcN3g.png"/></div></figure><p id="0397" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，Github操作可以在Github Cloud中工作，并作为<a class="ae kw" href="https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners" rel="noopener ugc nofollow" target="_blank">自托管运行器</a>，这可以解决访问您的安全资源的问题，因为Github没有静态IP范围，所以您无法配置您的安全组/防火墙。</p><p id="40a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners#ip-addresses" rel="noopener ugc nofollow" target="_blank"> Github建议</a>定期下载带有更新网络的json文件(顺便说一句，Github Actions正在开发<a class="ae kw" href="https://rtfm.co.ua/azure-pochemu-nikogda/" rel="noopener ugc nofollow" target="_blank"> Microsoft Azure </a>)，但是我懒得创建一些额外的自动化来更新安全配置。</p><h1 id="dd0a" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">Github操作:概述</h1><p id="a880" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">在动作中，构建流程如下(参见<a class="ae kw" href="https://docs.github.com/en/actions/learn-github-actions/introduction-to-github-actions" rel="noopener ugc nofollow" target="_blank">GitHub动作简介</a>):</p><ol class=""><li id="63c5" class="lc ld iq ka b kb kc kf kg kj le kn lf kr lg kv mv li lj lk bi translated">一个<em class="mw">事件</em>(例如，一个拉取请求或者提交到一个存储库，参见这里的完整列表<a class="ae kw" href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows" rel="noopener ugc nofollow" target="_blank">&gt;&gt;&gt;</a>)触发一个<em class="mw">工作流</em>，它包含<em class="mw">作业</em></li><li id="757c" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv mv li lj lk bi translated">一个<em class="mw">作业</em>包含一系列<em class="mw">步骤</em>，每个步骤由一个或多个<em class="mw">动作</em>组成</li><li id="206a" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv mv li lj lk bi translated"><em class="mw">动作</em>在<em class="mw">转轮</em>上运行，一个工作流的多个动作可以同时运行</li></ol><p id="e518" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">主要组件包括:</p><ul class=""><li id="fa48" class="lc ld iq ka b kb kc kf kg kj le kn lf kr lg kv lh li lj lk bi translated"><em class="mw"> runner </em>:运行在Github Cloud上或者自托管的服务器，它将执行一个作业</li><li id="3c06" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated">工作流:YAML描述的一个过程，包括一个或多个任务，由一个事件触发</li><li id="3abf" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><em class="mw">作业</em>:在同一个转轮上运行的一组步骤。如果一个工作流有多个作业，默认情况下，它们将并行启动，但也可以配置为相互依赖</li><li id="9990" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><em class="mw">步骤</em>:з执行普通命令的任务或<em class="mw">动作</em>。由于同一个作业的步骤在同一个运行器上运行，它们可以相互共享数据。</li><li id="91e4" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><em class="mw">动作</em>:主“执行块”——可以是一组已经准备好的任务，或者运行简单的命令</li></ul><h2 id="4996" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">工作流文件结构</h2><p id="2f4f" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">简而言之，让我们看看工作流文件是如何构建的:</p><ul class=""><li id="f0a6" class="lc ld iq ka b kb kc kf kg kj le kn lf kr lg kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">name</code>:工作流程名称</li><li id="4121" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">on</code>:将触发此工作流的事件</li><li id="f028" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">jobs</code>:该工作流的任务列表</li><li id="9c92" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">&lt;JOB_NAME&gt;</code></li><li id="4678" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">runs-on</code>:执行作业的运行程序</li><li id="54b4" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">steps</code>:该工作中需要用<code class="fe nj nk nl nm b">uses</code>或<code class="fe nj nk nl nm b">run</code>执行的任务</li><li id="99a3" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">uses</code>:一个<em class="mw">动作</em>执行</li><li id="11f9" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><code class="fe nj nk nl nm b">run</code>:要执行的命令</li></ul><h2 id="e445" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">入门:创建工作流文件</h2><p id="2002" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">让我们从一个简单的文件开始，看看它是如何工作的。</p><p id="6d76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您存储库根目录下创建一个名为<code class="fe nj nk nl nm b">.github/workflows/</code>的目录——在这里我们将存储所有的工作流，这些工作流可以被不同的事件触发:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="b51b" class="mx lr iq nm b gy nr ns l nt nu">$ mkdir -p .github/workflows</span></pre><p id="ec2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个目录中，为您的流创建一个文件，例如，命名为<code class="fe nj nk nl nm b">.github/workflows/actions-test.yaml</code>:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="843b" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/>on: [push]<br/>jobs:<br/>  print-hello:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: echo "Hello, world"</span></pre><p id="c068" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存并推送到Github:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="7b17" class="mx lr iq nm b gy nr ns l nt nu">$ git add .github/workflows/actions-test.yaml &amp;&amp; git commit -m “Test flow” &amp;&amp; git push</span></pre><p id="bfcb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">转到Github WebUI，切换到Actions选项卡，您会看到这个工作流的执行:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/9958ddc85b55cd031320157c06306561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*apMBT90-goY1VegN.png"/></div></div></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/ad4108c2198fe8afcadca1df83153cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/0*BqAsYfr9wnntUlq3.png"/></div></figure><h2 id="3386" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">事件</h2><p id="05c1" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">在事件中，您可以描述运行该流的条件。</p><p id="e785" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这样的条件可以是对存储库的pull请求或提交、时间表，或者Github之外的一些事件，这些事件将运行一个指向存储库的webhook。</p><p id="243c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，您可以为存储库的不同分支配置这些条件:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="288d" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/>on: <br/>  push:<br/>    branches:<br/>      - master<br/>  pull_request:<br/>    branches:<br/>      - test-branch<br/>...</span></pre><p id="e1a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者使用cronjob，参见<a class="ae kw" href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows#scheduled-events" rel="noopener ugc nofollow" target="_blank">预定事件</a>:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="85d9" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/>on: <br/>  schedule:<br/>    - cron: '* * * *'</span></pre><h2 id="1aa2" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">手动触发— <code class="fe nj nk nl nm b">workflow_dispatch</code></h2><p id="1687" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">此外，您可以通过使用<code class="fe nj nk nl nm b">on</code>中的<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/developers/webhooks-and-events/webhook-events-and-payloads#workflow_dispatch" rel="noopener ugc nofollow" target="_blank">workflow_dispatch</a></code>来配置手动执行工作流的能力:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="9409" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/>on: <br/>   workflow_dispatch<br/>jobs:<br/>  print-hello:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: echo "Hello, world"</span></pre><p id="3438" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，在操作中，您将获得一个按钮来运行该流程:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/c9d08c2c466305f8058b39bb76bd0bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SHYN_d11qFVgtZBD.png"/></div></div></figure><h2 id="cce7" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">工作流程<code class="fe nj nk nl nm b">inputs</code></h2><p id="0586" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">在您的工作流程中，您还可以添加一些<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/learn-github-actions/finding-and-customizing-actions#using-inputs-and-outputs-with-an-action" rel="noopener ugc nofollow" target="_blank">inputs</a></code>，它们将通过<code class="fe nj nk nl nm b"><a class="ae kw" href="https://help.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" rel="noopener ugc nofollow" target="_blank">github.event</a></code>上下文作为变量出现在步骤中:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="552d" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/>on: <br/>   workflow_dispatch:<br/>     inputs:<br/>       userName:<br/>         description: "Username"<br/>         required: true<br/>         default: "Diablo"<br/>jobs:<br/>  print-hello:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: echo "Username: ${{ github.event.inputs.username }}"<br/>      - run: echo "Actor's username: ${{ github.actor }}"</span></pre><p id="e729" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，在<code class="fe nj nk nl nm b">${{ github.event.inputs.username }}</code>中，我们获得了<code class="fe nj nk nl nm b">workflow_dispatch.inputs.userName</code>的值，在<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" rel="noopener ugc nofollow" target="_blank">github.actor</a></code>中，我们接收了Github操作元数据:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/0b0e5283c6f6a8535b76b8b095ccb6df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RYsPLseZZuTzIh-0.png"/></div></div></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/6d29b5b3b80e4c5588bc5275e38ffdce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/0*JHmsEHLpWWcB4U3v.png"/></div></figure><p id="1ff2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个用例可以是，例如，传递Docker图像标签以与ArgoCD一起部署。</p><h2 id="a383" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">Webhooks: <code class="fe nj nk nl nm b">create</code></h2><p id="b90e" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">除了我们在上面使用的<code class="fe nj nk nl nm b">push</code>之外，我们可以在存储库中的任何其他事件上配置我们的工作流。</p><p id="52c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">参见<a class="ae kw" href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows#webhook-events" rel="noopener ugc nofollow" target="_blank"> Webhook事件</a>中的完整列表。</p><p id="77ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">作为另一个例子，让我们使用<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows#create" rel="noopener ugc nofollow" target="_blank">create</a></code>将我们的流配置为在创建新的分支或标签时运行:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="137e" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/>on: <br/>  create<br/>jobs:<br/>  print-hello:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: |<br/>          echo "Event name: ${{ github.event_name }}"<br/>          echo "Actor's username: ${{ github.actor }}"</span></pre><p id="6787" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里的<code class="fe nj nk nl nm b">${{ github.event_name }}</code>用于显示触发器名称。</p><p id="6cd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个新分支并推动它:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="43ef" class="mx lr iq nm b gy nr ns l nt nu">$ git checkout -b a-new-branch<br/>Switched to a new branch ‘a-new-branch’<br/>$ git push -u origin a-new-branch</span></pre><p id="1315" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f4b3cd70f1ea2d4aec359c32b0256835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/0*eU3YJ3-wZBUKQYJ5.png"/></div></figure><h2 id="0039" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">环境变量</h2><p id="3e9e" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">此外，Github Actions支持工作流中的环境变量。</p><p id="7d6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有一个默认变量的列表，参见<a class="ae kw" href="https://docs.github.com/en/actions/reference/environment-variables#default-environment-variables" rel="noopener ugc nofollow" target="_blank">默认环境变量</a>，您可以在工作流级别、作业级别、每个作业或每个步骤创建自己的变量。</p><p id="42f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在此期间，注意你以不同的方式访问变量，参见<a class="ae kw" href="https://docs.github.com/en/actions/reference/environment-variables#about-environment-variables" rel="noopener ugc nofollow" target="_blank">关于环境变量</a>:</p><ul class=""><li id="c3c4" class="lc ld iq ka b kb kc kf kg kj le kn lf kr lg kv lh li lj lk bi translated"><em class="mw">上下文变量</em> — <code class="fe nj nk nl nm b">${{ env.VARNAME }}</code>:在将工作流文件发送给运行器之前，将在工作流文件预处理期间设置一个值，在除了<code class="fe nj nk nl nm b">run</code>之外的任何地方使用它，例如在<code class="fe nj nk nl nm b">if</code>条件中(将在下面讨论)</li><li id="99d1" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated"><em class="mw">环境变量</em> — <code class="fe nj nk nl nm b">$VARNAME</code>:运行程序上的<code class="fe nj nk nl nm b">run</code>在任务执行过程中会设置一个值</li><li id="4d08" class="lc ld iq ka b kb ll kf lm kj ln kn lo kr lp kv lh li lj lk bi translated">要在作业执行期间创建自己的变量，请使用默认<code class="fe nj nk nl nm b">$GITHUB_ENV</code>变量中设置的特定文件</li></ul><p id="9f46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">变量示例:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="2f1a" class="mx lr iq nm b gy nr ns l nt nu">name: vars-test<br/><br/>on:<br/>  push<br/><br/>env:<br/>  VAR_NAME: "Global value"<br/><br/>jobs:<br/>  print-vars:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/><br/>      # using own varibales<br/>      - name: "Test global var as $VAR_NAME"<br/>        run: echo "Test value $VAR_NAME"<br/><br/>      - name: "Test global var as ${{ env.VAR_NAME }}"<br/>        run: echo "Test value ${{ env.VAR_NAME }}"<br/><br/>      # using default variables<br/>      - name: "Test job var as $GITHUB_REPOSITORY"<br/>        run: echo "Test value $GITHUB_REPOSITORY"<br/><br/>      # this will be empty, as default variables are not in the context<br/>      - name: "Test job var as ${{ env.GITHUB_REPOSITORY }}"<br/>        run: echo "Test value ${{ env.GITHUB_REPOSITORY }}"<br/><br/>      # using 'dynamic' variables<br/>      - name: "Set local var"<br/>        run: echo "local_var=local value" &gt;&gt; $GITHUB_ENV<br/><br/>      - name: "Print local var as $local_var"<br/>        run: echo "$local_var"<br/><br/>      - name: "Print local var as ${{ env.local_var }}"<br/>        run: echo "${{ env.local_var }}"</span></pre><p id="7d55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和结果:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/6387c974f20eee5c7bb62fb0d16fce32.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/0*pdrYenkr-weGnGJB.png"/></div></div></figure><h2 id="022d" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">秘密</h2><p id="ca51" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">这里的文献资料是<a class="ae kw" href="https://docs.github.com/en/actions/reference/encrypted-secrets" rel="noopener ugc nofollow" target="_blank">&gt;&gt;&gt;</a>。</p><p id="4263" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以在存储库中添加秘密<em class="mw">设置&gt;秘密</em>:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/015ec9d372ba4b0937e4f088fc246526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yub9_3jCJvok6nNG.png"/></div></div></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7427949c7cdeb714fb8c582901f58263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*t9Osmi9g6ElcqeaA.png"/></div></figure><p id="d319" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在工作流中添加它的使用。一个秘密可以通过<code class="fe nj nk nl nm b">${{ secret.SECRETNAME }}</code>直接被例化或者可以被设置为一个变量:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="a9f1" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/><br/>on: <br/>  push<br/><br/>env:<br/>  TEST_ENV: ${{ secrets.TEST_SECRET }}<br/><br/>jobs:<br/>  print-hello:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: |<br/>          echo "Test secret: ${{ secrets.TEST_SECRET }}"<br/>          echo "Test secret: ${{ env.TEST_ENV }}"</span></pre><p id="4d70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行流程:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/34ef2c7d0d5c26cc2a8fcf0f65a4aeae.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/0*3nIbhLFDkZ7auBEg.png"/></div></figure><h2 id="f407" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">条件和<code class="fe nj nk nl nm b">if</code></h2><p id="7a2e" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">Github Actions通过使用<code class="fe nj nk nl nm b">if</code>运算符后跟一个表达式来支持作业的条件检查，参见<a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#about-contexts-and-expressions" rel="noopener ugc nofollow" target="_blank">关于上下文和表达式</a>。</p><p id="f20f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个例子:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="28b7" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/><br/>on:<br/>  push<br/>  <br/>jobs:<br/>  print-hello:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/><br/>      - id: 'zero'<br/>        run: echo "${{ github.actor }}"<br/><br/>      - id: 'one'<br/>        run: echo "Running because of 'github.actor' contains a 'setevoy' string"<br/>        if: "contains(github.actor, 'setevoy')"<br/><br/>      # this will not run<br/>      - id: 'two'<br/>        run: echo "Skipping because of 'github.actor' contains a 'setevoy' string"<br/>        if: "!contains(github.actor, 'setevoy')"<br/><br/>      - id: 'three'<br/>        run: echo "Running because of Step Two was skipped"<br/>        if: steps.two.conclusion == 'skipped'<br/><br/>      - id: 'four'<br/>        run: echo "Running because of commit message was '${{ github.event.commits[0].message }}'"<br/>        if: contains(github.event.commits[0].message, 'if set')<br/><br/>      - id: 'five'<br/>        run: echo "Running because of previous Step was successful and the trigger event was 'push'"<br/>        if: success() &amp;&amp; github.event_name == 'push'</span></pre><p id="4a17" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，我们使用<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" rel="noopener ugc nofollow" target="_blank">github</a></code> <a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" rel="noopener ugc nofollow" target="_blank">上下文</a>、<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#contains" rel="noopener ugc nofollow" target="_blank">contains()</a></code>函数、<code class="fe nj nk nl nm b">!=</code>、<code class="fe nj nk nl nm b">&amp;&amp;</code>、<a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#operators" rel="noopener ugc nofollow" target="_blank">运算符</a>和<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#steps-context" rel="noopener ugc nofollow" target="_blank">steps</a></code>、<a class="ae kw" href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#steps-context" rel="noopener ugc nofollow" target="_blank">上下文</a>来检查条件。</p><p id="6309" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">结果将是:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/5198cb8563d6a59e13cdcf69f8f9913f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5x0AyQ9RaTzkgbMO.png"/></div></div></figure><h2 id="2703" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated"><code class="fe nj nk nl nm b">needs</code> -工作依赖</h2><p id="5106" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">除了步骤中的<code class="fe nj nk nl nm b">if: success()</code>之外，您还可以通过使用<code class="fe nj nk nl nm b"><a class="ae kw" href="https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idneeds" rel="noopener ugc nofollow" target="_blank">needs</a></code>来添加相互依赖的作业:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="b1bc" class="mx lr iq nm b gy nr ns l nt nu">name: actions-test<br/><br/>on: <br/>  push<br/><br/>jobs:<br/><br/>  init:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: echo "An init job"<br/><br/>  build:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: echo "A build job" &amp;&amp; exit 1<br/>    needs: 'init'<br/><br/>  deploy:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - run: echo "A deploy job"<br/>    if: always()<br/>    needs: ['init', 'build']</span></pre><p id="3d86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，在<em class="mw">构建</em>作业中，我们等待<em class="mw">初始化</em>作业完成，在<em class="mw">部署</em>作业中，我们等待<em class="mw">初始化</em>和<em class="mw">构建</em>，通过使用<code class="fe nj nk nl nm b">if: always()</code>，我们已经设置运行<em class="mw">部署</em>作业，而不管依赖作业的执行结果如何:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/9dd5b02f1006b30c10d25e1da97b4de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zxZu91ripN3zqrAx.png"/></div></div></figure><h1 id="0ac5" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">行动</h1><p id="eb44" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">最后要看的是Github动作的主要组成部分——动作。</p><p id="c30d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Actions允许我们使用已经存在的来自Github Actions Marketplace的脚本和工具，或者来自Docker Hub的Docker图片。</p><p id="8006" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">参见<a class="ae kw" href="https://docs.github.com/en/actions/learn-github-actions/finding-and-customizing-actions" rel="noopener ugc nofollow" target="_blank">查找和定制动作</a>。</p><p id="4761" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下面的例子中，我们将使用<a class="ae kw" href="https://github.com/actions/checkout" rel="noopener ugc nofollow" target="_blank"> actions/checkout@v2 </a>来克隆一个存储库roo a runner-agent，并使用<a class="ae kw" href="https://github.com/marketplace/actions/argocd-application-sync-action" rel="noopener ugc nofollow" target="_blank">ome gion/argocd-app-actions</a>来同步ArgoCD应用程序(详见<a class="ae kw" href="https://rtfm.co.ua/en/argocd-an-overview-ssl-configuration-and-an-application-deploy/" rel="noopener ugc nofollow" target="_blank"> ArgoCD:概述、SSL配置和应用程序部署</a>帖子)。</p><h2 id="998d" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">ArgoCD应用程序</h2><p id="c964" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">让我们创建一个测试应用程序:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/9e1533d2cdf5d6aacad5245ee1bfcb94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UtaZHVRVVe8YjP5y.png"/></div></div></figure><p id="f51a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更新<code class="fe nj nk nl nm b">argocd-cm</code>配置图，因为默认情况下<em class="mw">管理员</em>用户无权使用ArgoCD令牌(不要在生产环境中执行此操作！：</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="ff49" class="mx lr iq nm b gy nr ns l nt nu">...<br/>data:<br/>  accounts.admin: apiKey,login<br/>...</span></pre><p id="65bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">登录:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="d4cb" class="mx lr iq nm b gy nr ns l nt nu">$ argocd login dev-1–18.argocd.example.com<br/>Username: admin<br/>Password:<br/>‘admin’ logged in successfully<br/>Context ‘dev-1–18.argocd.example.com’ updated</span></pre><p id="d451" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建令牌:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="5981" class="mx lr iq nm b gy nr ns l nt nu">$ argocd account generate-token<br/>eyJ***3Pc</span></pre><h2 id="33c6" class="mx lr iq bd ls my mz dn lw na nb dp ma kj nc nd me kn ne nf mi kr ng nh mm ni bi translated">ArgoCD的Github操作工作流</h2><p id="e021" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">使用此令牌添加密码:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/8b26e5802ddfb3dd208fcfa82cef7934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xyPSpkl6D80MIFXh.png"/></div></div></figure><p id="6ebc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建新的工作流程:</p><pre class="ky kz la lb gt nn nm no np aw nq bi"><span id="ffe2" class="mx lr iq nm b gy nr ns l nt nu">name: "ArgoCD sync"<br/>on: "push"<br/>jobs:<br/>  build:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/><br/>      - name: "Clone reposiory"<br/>        uses: actions/checkout@v2<br/>        with:<br/>          repository: "argoproj/argocd-example-apps.git"<br/>          ref: "master"<br/><br/>      - name: "Sync ArgoCD Application"<br/>        uses: omegion/argocd-app-actions@master<br/>        with:<br/>          address: "dev-1-18.argocd.example.com"<br/>          token: ${{ secrets.ARGOCD_TOKEN }}<br/>          appName: "guestbook"</span></pre><p id="2d53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将其推送到一个存储库，并检查其执行情况:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/2c3334f090a14eab6a41b732e18293df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eRwq_djz4dN25Waf.png"/></div></div></figure><p id="2c18" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ArgoCD中的应用程序现在是同步的:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/dba109d682ffef8ad73ac0c8cb5b36b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Qf_sO76SirSKw96D.png"/></div></div></figure><p id="daab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成了。</p></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><p id="0858" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mw">最初发布于</em> <a class="ae kw" href="https://rtfm.co.ua/en/github-github-actions-overview-and-argocd-deployment-example/" rel="noopener ugc nofollow" target="_blank"> <em class="mw"> RTFM: Linux、DevOps、系统管理</em> </a> <em class="mw">。</em></p></div></div>    
</body>
</html>
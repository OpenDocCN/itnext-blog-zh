<html>
<head>
<title>4 (of many) awesome additions in Ruby 2.5.1 (and how to install it)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby 2.5.1中4个令人惊叹的新增功能(以及如何安装)</h1>
<blockquote>原文：<a href="https://itnext.io/4-of-many-awesome-additions-in-ruby-2-5-0-and-how-to-install-it-4b6f07bdc25f?source=collection_archive---------2-----------------------#2018-04-16">https://itnext.io/4-of-many-awesome-additions-in-ruby-2-5-0-and-how-to-install-it-4b6f07bdc25f?source=collection_archive---------2-----------------------#2018-04-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="652c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">还有一个关于Ruby结构以及如何利用它的快速旁白</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/55cac99237da8777e923a7261bcd8399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdG6x6mYDa8UWH1UJzoomg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">ruby 2 . 5 . 1:2018年3月28日发布</figcaption></figure><p id="a165" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上周二，我参加了<a class="ae lu" href="http://www.fogcityruby.com/" rel="noopener ugc nofollow" target="_blank">雾城Ruby</a>——这是一个在旧金山举行的月度聚会，有三场涉及Ruby和Ruby相关话题的讲座。当晚的主要话题——<a class="ae lu" href="https://speakerdeck.com/havenwood/a-deep-dive-into-new-ruby-features" rel="noopener ugc nofollow" target="_blank"><em class="lv">Ruby 2.5:由<a class="ae lu" href="https://github.com/havenwood" rel="noopener ugc nofollow" target="_blank"> Shannon Skipper </a>从<a class="ae lu" href="https://squareup.com/" rel="noopener ugc nofollow" target="_blank"> Square </a>带来的对Ruby特性</em> </a> <em class="lv"> </em>的深入探究——是对Ruby 2.5中实现的一些新特性的精彩概括。(他的原始幻灯片，点击<a class="ae lu" href="https://speakerdeck.com/havenwood/a-deep-dive-into-new-ruby-features" rel="noopener ugc nofollow" target="_blank">这里</a>)</p><p id="fd66" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面，我列出了我从他的演讲中学到的2.5版的四个显著的新特性。</p><h1 id="cea1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">1.前置和追加数组</h1><p id="809a" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">如果您曾经认为<code class="fe mt mu mv mw b">unshift</code>听起来像是数组方法的一个笨拙的名字，那是因为它确实是。</p><p id="c865" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Ruby 2.5现在允许你使用<code class="fe mt mu mv mw b">prepend</code>在数组的开头添加一个值。对每个人来说更容易阅读和记忆。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="bd55" class="nb lx it mw b gy nc nd l ne nf">a = [2,3,4]</span><span id="fa93" class="nb lx it mw b gy ng nd l ne nf"># THE OLD WAY<br/>a.unshift(1) #=&gt; [1,2,3,4]</span><span id="1cef" class="nb lx it mw b gy ng nd l ne nf"># NEW IN RUBY 2.5<br/>a.prepend(0) #=&gt; [0,1,2,3,4]</span></pre><p id="4447" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你也可以<code class="fe mt mu mv mw b">append</code>给一个数组赋值，而不是把它推入或者铲入。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="499a" class="nb lx it mw b gy nc nd l ne nf">b = [1,2,3]</span><span id="bec8" class="nb lx it mw b gy ng nd l ne nf"># THE OLD WAYS<br/>b &lt;&lt; 4 #=&gt; [1,2,3,4]<br/>b.push(5) #=&gt; [1,2,3,4,5]</span><span id="f831" class="nb lx it mw b gy ng nd l ne nf"># NEW IN RUBY 2.5<br/>b.append(6) #=&gt; [1,2,3,4,5,6]</span></pre><h1 id="7121" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">2.SecureRandom .字母数字</h1><p id="0310" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">如果你想创建一个随机的字母数字字符串，Ruby 2.5可以满足你。<code class="fe mt mu mv mw b">SecureRandom</code>现在有了一个<code class="fe mt mu mv mw b">alphanumeric</code>方法。只要确保<code class="fe mt mu mv mw b">require 'securerandom'</code>在文件的顶部，然后像下面这样调用<code class="fe mt mu mv mw b">SecureRandom.alphanumeric</code>:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="b3a7" class="nb lx it mw b gy nc nd l ne nf">require 'securerandom'</span><span id="a85f" class="nb lx it mw b gy ng nd l ne nf">alnum = SecureRandom.alphanumeric <br/>#=&gt; "gKS5JuHBb2Xu3JtR"</span><span id="ffc7" class="nb lx it mw b gy ng nd l ne nf">alnum.size #=&gt; 16</span><span id="73d0" class="nb lx it mw b gy ng nd l ne nf">SecureRandom.alphanumeric(1) <br/>#=&gt; "x"</span><span id="3649" class="nb lx it mw b gy ng nd l ne nf">SecureRandom.alphanumeric(2) <br/>#=&gt; "8M"</span><span id="9251" class="nb lx it mw b gy ng nd l ne nf">SecureRandom.alphanumeric(20)<br/>#=&gt; "95SqPm8TNixZwonrjZqw"</span></pre><h1 id="3d50" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">3.#屈服_自我</h1><p id="c628" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">Ruby 2.5增加了一个名为<code class="fe mt mu mv mw b">yield_self</code>的新方法，它将给定的块产生给定的接收者，并返回块中最后一条语句的输出。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="7583" class="nb lx it mw b gy nc nd l ne nf">2.yield_self { |num| num + 3 } #=&gt; 5</span><span id="82e8" class="nb lx it mw b gy ng nd l ne nf">"Harry".yield_self { |str| "Hermione, #{str}, and Ron" }</span><span id="ae4b" class="nb lx it mw b gy ng nd l ne nf">#=&gt; "Hermione, Harry, and Ron"</span></pre><h1 id="33a5" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">4.关键字结构</h1><h2 id="7f51" class="nb lx it bd ly nh ni dn mc nj nk dp mg lh nl nm mi ll nn no mk lp np nq mm nr bi translated">4a。除了什么是结构</h2><p id="14b2" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">在Shannon向我们介绍这个新的关键字Structs概念之前，他要求小组成员如果以前在他们的Ruby代码中使用过<code class="fe mt mu mv mw b">Struct</code>请举手。</p><p id="20ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">房间里大约一半的人举起了手，我不在其中。然后我看了这篇<a class="ae lu" href="https://www.leighhalliday.com/ruby-struct" rel="noopener ugc nofollow" target="_blank">博文</a>现在知道是什么了。我在这里总结一下:</p><p id="ef2f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">直接来自Ruby文档，<a class="ae lu" href="http://ruby-doc.org/core-2.1.2/Struct.html" rel="noopener ugc nofollow" target="_blank"> Struct </a>是一种通过使用访问器方法将许多属性捆绑在一起的便捷方式，而不必编写显式类。</p><p id="7c8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要建立一个Ruby类，(这里我将使用带有Fido实例的陈词滥调Dog类)，可以像教科书一样编写它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="4d26" class="nb lx it mw b gy nc nd l ne nf">class Dog<br/>  attr_accessor :name, :breed</span><span id="dfaf" class="nb lx it mw b gy ng nd l ne nf">  def initialize(name, breed)<br/>    <a class="ae lu" href="http://twitter.com/name" rel="noopener ugc nofollow" target="_blank">@name</a> = name<br/>    <a class="ae lu" href="http://twitter.com/breed" rel="noopener ugc nofollow" target="_blank">@breed</a> = breed<br/>  end</span><span id="0599" class="nb lx it mw b gy ng nd l ne nf">  def introduce_self<br/>    "Hi, my name is #{name} and I'm a #{breed}."<br/>  end</span><span id="e848" class="nb lx it mw b gy ng nd l ne nf">end</span><span id="9a83" class="nb lx it mw b gy ng nd l ne nf">fido = Dog.new('Fido', 'Corgi')<br/>puts fido.introduce_self #=&gt; Hi, my name is Fido and I'm a Corgi.</span></pre><p id="4b09" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有了<code class="fe mt mu mv mw b">Struct</code>，你可以大大缩短让一只狗自我介绍的过程，改为写下:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="5dc9" class="nb lx it mw b gy nc nd l ne nf">Dog = Struct.new(:name, :breed) do<br/>  def introduce_self<br/>    "Hi, my name is #{name} and I'm a #{breed}."<br/>  end<br/>end</span><span id="c8b6" class="nb lx it mw b gy ng nd l ne nf">fido = Dog.new('Fido', 'Corgi')<br/>puts fido.introduce_self #=&gt; Hi, my name is Fido and I'm a Corgi.</span></pre><p id="a720" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不需要键入带有实例变量的<code class="fe mt mu mv mw b">attr_accessors</code>或<code class="fe mt mu mv mw b">initialize</code>方法，<code class="fe mt mu mv mw b">Struct</code>会为您处理所有这些。</p><h2 id="a0fd" class="nb lx it bd ly nh ni dn mc nj nk dp mg lh nl nm mi ll nn no mk lp np nq mm nr bi translated">4b。Ruby 2.5中的关键字结构</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nt l"/></div></figure><p id="5ebb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">回到谈论Ruby 2.5…</p><p id="b1fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们想用<code class="fe mt mu mv mw b">Struct</code>创建蜘蛛侠，如下所示:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="0fa7" class="nb lx it mw b gy nc nd l ne nf">Superhero = Struct.new(:name, :real_name) do<br/>  def introduce_self<br/>    "Hi, I'm #{name}, but my friends call me #{real_name}."<br/>  end<br/>end</span><span id="6805" class="nb lx it mw b gy ng nd l ne nf">spiderman = Superhero.new("Spiderman", "Peter")</span><span id="ca46" class="nb lx it mw b gy ng nd l ne nf">puts spiderman.introduce_self<br/>#=&gt; Hi, I’m Spiderman, but my friends call me Peter.</span></pre><p id="165c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设三个小时后，你想创造蝙蝠侠，但你总是忘记名字的顺序。是先说他的真名，还是先说他的超级英雄名？</p><p id="7317" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">多亏了Ruby 2.5的关键字structs，您现在可以使用关键字参数创建结构的实例，如下所示:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="8309" class="nb lx it mw b gy nc nd l ne nf">Superhero = Struct.new(:name, :real_name, :keyword_init =&gt; true) do<br/>  def introduce_self<br/>    "Hi, I'm #{name}, but my friends call me #{real_name}."<br/>  end<br/>end</span><span id="5191" class="nb lx it mw b gy ng nd l ne nf">batman = Superhero.new(real_name: "Bruce", name: "Batman")</span><span id="f5f0" class="nb lx it mw b gy ng nd l ne nf">puts batman.introduce_self<br/>#=&gt; Hi, I'm Batman, but my friends call me Bruce.</span></pre><p id="8c97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意顶部的<code class="fe mt mu mv mw b">:keyword_init =&gt; true</code>行，以及我们现在如何通过指定其键值对来创建超级英雄的新实例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nt l"/></div></figure><h1 id="7f53" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">如何安装</h1><p id="952a" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">那么，如何使用Ruby 2.5呢？</p><p id="5a61" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，检查一下自己是不是已经有了。在您的终端中键入:</p><p id="74df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mt mu mv mw b">ruby -v</code></p><p id="f741" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它应该会输出您当前拥有的版本。我的是:</p><p id="94b9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mt mu mv mw b">ruby 2.3.1p112</code></p><p id="defa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我落伍了。</p><p id="19d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过在终端键入以下命令，将<a class="ae lu" href="https://rvm.io/" rel="noopener ugc nofollow" target="_blank"> Ruby版本管理器</a>下载到您的机器上:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="f298" class="nb lx it mw b gy nc nd l ne nf">curl -L <a class="ae lu" href="https://get.rvm.io" rel="noopener ugc nofollow" target="_blank">https://get.rvm.io</a> | bash -s stable</span></pre><p id="5377" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后键入:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="a3ba" class="nb lx it mw b gy nc nd l ne nf">rvm install ruby-2.5.1</span></pre><p id="b7d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下载它应该需要时间。</p><p id="2b76" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下载完成后，通过输入以下命令将其设置为默认的Ruby版本:</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="e753" class="nb lx it mw b gy nc nd l ne nf">rvm --default use 2.5.1</span></pre><h1 id="fe41" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结束语</h1><p id="4af4" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">以上方法只是Ruby 2.5为了让你的生活变得更简单而引入的几个方法中的一小部分。请务必查看官方文档和前面提到的<a class="ae lu" href="https://speakerdeck.com/havenwood/a-deep-dive-into-new-ruby-features" rel="noopener ugc nofollow" target="_blank">幻灯片</a>，了解所有性能改进的列表和新的默认gem列表。</p><p id="b5d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有一个关于Ruby 2.5的非常优秀的博客系列<a class="ae lu" href="https://blog.bigbinary.com/categories/ruby-2-5/" rel="noopener ugc nofollow" target="_blank">。在我写这篇文章的时候，我也经常参考这个系列。</a></p><p id="1fdc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以一定要更新你的Ruby，保持最新！</p><p id="252c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lv">感谢阅读！请随意在下面留下一些掌声！</em></p></div></div>    
</body>
</html>
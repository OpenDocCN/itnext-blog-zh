<html>
<head>
<title>Jenkins Tutorial — Part 4 — Post Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jenkins教程—第4部分—发布操作</h1>
<blockquote>原文：<a href="https://itnext.io/jenkins-tutorial-part-4-post-actions-e5d0ef1e3c39?source=collection_archive---------1-----------------------#2021-08-27">https://itnext.io/jenkins-tutorial-part-4-post-actions-e5d0ef1e3c39?source=collection_archive---------1-----------------------#2021-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c518273176f996c36d381a98cf53ea9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isD_dDi7u493JTm4ZudxOw.jpeg"/></div></div></figure><p id="6b44" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Jenkins教程的这一部分，我将解释<strong class="ka ir"> Jenkins Post操作</strong>，并向您展示如何为您的管道编写Post操作。如果你没看过以前的文章，先看看吧。所以让我们开始派对吧。</p><p id="98b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/jenkins-tutorial-part-1-pipelines-bd1397cf5509"> Jenkins教程—第1部分—管道</a></p><p id="b30e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/jenkins-tutorial-part-2-pipeline-variables-5e4783aa2c07"> Jenkins教程—第2部分—管道变量</a></p><p id="7771" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/jenkins-tutorial-part-3-parameterized-pipeline-3898643ac6ad"> Jenkins教程—第3部分—参数化管道</a></p><h1 id="b055" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是Jenkins Pipeline Post操作？</h1><p id="2b0f" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">Post操作就像其他正常阶段一样，只是在特定条件下运行。Jenkins支持10个特殊动作条件，当这些条件满足时，这些条件就会运行。它们与运行状态相关，可在<code class="fe ma mb mc md b">post</code>块中为整个管道和每个阶段定义。</p><p id="29bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">总是</strong>顾名思义总是运行。此发布操作不绑定到任何特定的构建/运行状态。像发送通知和保存日志这样的操作可以在这个块中完成。</p><p id="43e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">变更</strong>仅在当前构建的状态与前一个<strong class="ka ir">不同</strong>时运行。发送通知和运行另一个管道来调查管道之类的操作可以在这个块中完成。</p><p id="a259" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">修复了</strong>在当前构建状态为<strong class="ka ir">成功</strong>且之前的构建失败或不稳定时运行。像发送通知或触发另一个管道这样的操作可以在这个块中完成。</p><p id="ba88" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">回归</strong>在当前构建状态为失败、中止或不稳定的情况下运行，上一次运行<strong class="ka ir">为</strong> <strong class="ka ir">成功</strong>。像回滚这样的操作，例如在CD管道中，可以在这个post块中完成。</p><p id="c8e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">不稳定</strong>当前状态标记为不稳定时运行。例如，当测试失败，或者应用程序代码覆盖率低于期望的百分比时。像尝试其他测试和运行lazy canary环境这样的一些操作可以在这个块中完成。</p><p id="25e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">中止</strong>在构建过程中止时运行，通常是手动中止。例如，在中止管道之前发生的所有事情都应该用这个post操作恢复。</p><p id="56d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">失败</strong>在当前构建状态为失败时运行。像发送警报、回滚CD管道、删除中间工件等一些操作应该在这个块中完成。</p><p id="8ac6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">成功</strong>在构建的当前状态为成功时运行。像保存工件、上传工件和触发CD管道这样的操作必须通过这个post操作来完成。</p><p id="f238" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">不成功</strong>当构建状态不是成功时运行。这种情况是失败、中止和不稳定状态的混合。你可以在这个街区做相关的事情。</p><p id="f0e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">清除</strong>总是在评估完所有其他条件后运行。所有清理过程，比如删除中间工件、日志、临时文件等等，都应该用这个动作来完成。</p><h1 id="7ba2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">完整的Jenkins Post操作示例:</h1><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="2df1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我应该提醒您，这些条件/块可以针对整个管道和每个阶段进行定义。在运行所有阶段后，评估在<code class="fe ma mb mc md b">stages</code>程序块之后定义的<code class="fe ma mb mc md b">post</code>程序块，并且在运行该阶段后，评估在<code class="fe ma mb mc md b">steps</code>程序块之后每个阶段定义的<code class="fe ma mb mc md b">post</code>程序块。在哪里定义这些条件或需要定义哪个条件取决于您的管道需求和管道的目标。在许多真实世界的管道中，您需要定义管道和每个阶段的各种条件。祝你一切顺利。</p><p id="3331" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关注我的领英<a class="ae kw" href="https://www.linkedin.com/in/ssbostan" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/ssbostan</a></p></div></div>    
</body>
</html>
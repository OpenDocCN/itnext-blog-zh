<html>
<head>
<title>Ask questions to your images using NLP and Python (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NLP和Python向图像提问(第1部分)</h1>
<blockquote>原文：<a href="https://itnext.io/ask-questions-to-your-images-using-nlp-and-python-7940c534d26c?source=collection_archive---------3-----------------------#2021-03-20">https://itnext.io/ask-questions-to-your-images-using-nlp-and-python-7940c534d26c?source=collection_archive---------3-----------------------#2021-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5520" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，</p><p id="c319" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，我们将学习如何使用自然语言处理，以图像作为我们的真理来源来提问。</p><p id="4ef0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此案例在以下方面非常有用:</p><ul class=""><li id="e163" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">视频监控</li><li id="d7b0" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">智能搜索Instagram、Pinterest等网站</li><li id="de33" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">对Sharepoint、GDrive等文件存储系统的搜索功能。</li><li id="75be" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">集成人工智能的高级增强现实系统</li><li id="5588" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">更多</li></ul><p id="8b77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们正在通过实践的道路，但对于更多的理论问题，这里是论文。</p><div class="kz la gp gr lb lc"><a href="https://arxiv.org/abs/1908.07490" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd ir gy z fp lh fr fs li fu fw ip bi translated">LXMERT:从变压器学习跨通道编码器表示</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">视觉和语言推理需要理解视觉概念、语言语义，最重要的是…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">arxiv.org</p></div></div></div></a></div><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="1c84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开始吧！</p><p id="899e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">笔记本</strong></p><p id="c4c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和几乎所有的NLP问题一样，我们将使用HuggingFace的神奇变形金刚库:)</p><pre class="ll lm ln lo gt ls lt lu lv aw lw bi"><span id="361d" class="lx ly iq lt b gy lz ma l mb mc">!git clone https://github.com/huggingface/transformers</span><span id="060e" class="lx ly iq lt b gy md ma l mb mc">%cd transformers/examples/lxmert</span><span id="1233" class="lx ly iq lt b gy md ma l mb mc">%pip install -r requirements.txt</span></pre><p id="d66a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">导入LxmertForQuestionAnswering和LxmertTokenizer</p><pre class="ll lm ln lo gt ls lt lu lv aw lw bi"><span id="5d39" class="lx ly iq lt b gy lz ma l mb mc">from IPython.display import clear_output, Image, display</span><span id="074c" class="lx ly iq lt b gy md ma l mb mc">import PIL.Image</span><span id="25f8" class="lx ly iq lt b gy md ma l mb mc">import io</span><span id="edaa" class="lx ly iq lt b gy md ma l mb mc">import json</span><span id="4707" class="lx ly iq lt b gy md ma l mb mc">import torch</span><span id="7351" class="lx ly iq lt b gy md ma l mb mc">import numpy as np</span><span id="2cfc" class="lx ly iq lt b gy md ma l mb mc">from processing_image import Preprocess</span><span id="5101" class="lx ly iq lt b gy md ma l mb mc">from visualizing_image import SingleImageViz</span><span id="15ea" class="lx ly iq lt b gy md ma l mb mc">from modeling_frcnn import GeneralizedRCNN</span><span id="6f8b" class="lx ly iq lt b gy md ma l mb mc">from utils import Config</span><span id="4896" class="lx ly iq lt b gy md ma l mb mc">import utils</span><span id="4183" class="lx ly iq lt b gy md ma l mb mc">from transformers import LxmertForQuestionAnswering, LxmertTokenizer</span><span id="106f" class="lx ly iq lt b gy md ma l mb mc">import wget</span><span id="1b81" class="lx ly iq lt b gy md ma l mb mc">import pickle</span><span id="2750" class="lx ly iq lt b gy md ma l mb mc">import os</span><span id="ce6c" class="lx ly iq lt b gy md ma l mb mc"># URL = "https://raw.githubusercontent.com/airsplay/py-bottom-up-attention/master/demo/data/images/input.jpg",</span><span id="b0d3" class="lx ly iq lt b gy md ma l mb mc">URL = "https://vqa.cloudcv.org/media/test2014/COCO_test2014_000000262567.jpg"</span><span id="8bb1" class="lx ly iq lt b gy md ma l mb mc">OBJ_URL = "https://raw.githubusercontent.com/airsplay/py-bottom-up-attention/master/demo/data/genome/1600-400-20/objects_vocab.txt"</span><span id="f916" class="lx ly iq lt b gy md ma l mb mc">ATTR_URL = "https://raw.githubusercontent.com/airsplay/py-bottom-up-attention/master/demo/data/genome/1600-400-20/attributes_vocab.txt"</span><span id="e2c8" class="lx ly iq lt b gy md ma l mb mc">GQA_URL = "https://raw.githubusercontent.com/airsplay/lxmert/master/data/gqa/trainval_label2ans.json"</span><span id="f580" class="lx ly iq lt b gy md ma l mb mc">VQA_URL = "https://raw.githubusercontent.com/airsplay/lxmert/master/data/vqa/trainval_label2ans.json"</span><span id="47d7" class="lx ly iq lt b gy md ma l mb mc">def showarray(a, fmt='jpeg'):</span><span id="4f53" class="lx ly iq lt b gy md ma l mb mc">a = np.uint8(np.clip(a, 0, 255))</span><span id="190b" class="lx ly iq lt b gy md ma l mb mc">f = io.BytesIO()</span><span id="bedb" class="lx ly iq lt b gy md ma l mb mc">PIL.Image.fromarray(a).save(f, fmt)</span><span id="6a89" class="lx ly iq lt b gy md ma l mb mc">display(Image(data=f.getvalue()))</span></pre><p id="87e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">加载对象、属性和答案标签。</p><pre class="ll lm ln lo gt ls lt lu lv aw lw bi"><span id="f7bc" class="lx ly iq lt b gy lz ma l mb mc">objids = utils.get_data(OBJ_URL)</span><span id="78e7" class="lx ly iq lt b gy md ma l mb mc">attrids = utils.get_data(ATTR_URL)</span><span id="6b9f" class="lx ly iq lt b gy md ma l mb mc">gqa_answers = utils.get_data(GQA_URL)</span><span id="eafb" class="lx ly iq lt b gy md ma l mb mc">vqa_answers = utils.get_data(VQA_URL)</span></pre><p id="4eb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">加载模型和模型组件。</p><pre class="ll lm ln lo gt ls lt lu lv aw lw bi"><span id="813e" class="lx ly iq lt b gy lz ma l mb mc">frcnn_cfg = Config.from_pretrained("unc-nlp/frcnn-vg-finetuned")</span><span id="85d5" class="lx ly iq lt b gy md ma l mb mc">frcnn = GeneralizedRCNN.from_pretrained("unc-nlp/frcnn-vg-finetuned", config=frcnn_cfg)</span><span id="01c3" class="lx ly iq lt b gy md ma l mb mc">image_preprocess = Preprocess(frcnn_cfg)</span><span id="12ac" class="lx ly iq lt b gy md ma l mb mc">lxmert_tokenizer = LxmertTokenizer.from_pretrained("unc-nlp/lxmert-base-uncased")</span><span id="b71d" class="lx ly iq lt b gy md ma l mb mc">lxmert_gqa = LxmertForQuestionAnswering.from_pretrained("unc-nlp/lxmert-gqa-uncased")</span><span id="ae95" class="lx ly iq lt b gy md ma l mb mc">lxmert_vqa = LxmertForQuestionAnswering.from_pretrained("unc-nlp/lxmert-vqa-uncased")</span></pre><p id="5ece" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">测试</strong>！</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi me"><img src="../Images/c9cb6164265b914ddd9df28af649cd1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*7jn1sgbhz3fNJweDFTHrrw.png"/></div></figure><p id="8194" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是加载的图像，现在我们可以就它提出问题。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/2c4cc9687288c9972c35177545010bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*zJLS_ZVjwlMWemed6csa1A.png"/></div></figure><p id="4737" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很棒吧？</p><p id="6b5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇文章中，我们将构建Docker文件。</p><p id="e29e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多信息请访问官方网站【https://github.com/airsplay/lxmert T4】</p></div></div>    
</body>
</html>
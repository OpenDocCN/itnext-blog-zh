<html>
<head>
<title>Setting up simple, self-hosted &amp; fast CI/CD solution with Drone</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用无人机设置简单、自托管且快速的CI/CD解决方案</h1>
<blockquote>原文：<a href="https://itnext.io/setting-up-simple-self-hosted-fast-ci-cd-solution-with-drone-ca0fbb176925?source=collection_archive---------13-----------------------#2019-02-11">https://itnext.io/setting-up-simple-self-hosted-fast-ci-cd-solution-with-drone-ca0fbb176925?source=collection_archive---------13-----------------------#2019-02-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1fb565d47879558b3374bef22a03e58c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-Pr7MdA1siW7ZKH5.png"/></div></div></figure><p id="cc9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在过去的几年里，持续集成和持续交付一直是DevOps世界中非常流行的话题。随着越来越多的组织努力改进他们的测试和发布过程，我们观察到在这个生态系统中出现了许多新的工具。所有主要的云提供商都在提供他们的自动化系统(<a class="ae kw" href="https://toxicbakery.github.io/vsts-devops/microsoft-devops-ci/" rel="noopener ugc nofollow" target="_blank">有些非常不成功</a>)，所以很难选择一个适合你的用例的。</p><p id="e536" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有相当多的服务(Travis，CircleCI，Google Cloud Builder)和自托管解决方案来构建、测试和部署您的代码，但实际上，只有少数是免费、开源和自托管的。</p><p id="fb61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最知名的CI/CD工具是Jenkins和GitLab CI(我最近在<a class="ae kw" href="https://dev.to/krusenas/whats-your-favourite-cicd-tool-and-why-52ll" rel="noopener ugc nofollow" target="_blank"> dev.to post </a>上问过这个问题)。然而，Jenkins占用了大量内存，因为它运行在Tomcat (Java)上，并且工作流是在Jenkins内部定义的，而不是在用于运行这些测试/构建作业的存储库中。</p><p id="666f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">至于GitLab CI，它非常好，但需要你运行自己的GitLab(这很大)或在gitlab.com上(虽然现在你可以将Github repos镜像到GitLab以自动开始构建，但是，这增加了复杂性)。你可以独立运行你自己的跑步工具，它们看起来很可靠。我帮助进行后端开发的一个组织正在使用Gitlab CI，并取得了巨大的成功，但正如我之前提到的，业务定价和服务器运行成本可能会很高。</p><blockquote class="kx ky kz"><p id="3346" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><em class="iq">免责声明:几年前我曾尝试过使用无人机，但并不满意。我不确定这是实际的产品问题还是文档问题，但是我无法实现我想要的。这一次似乎很不一样。产品是稳定的，文档是好的，一些非常好的例子就在他们自己的</em> <code class="fe le lf lg lh b"><em class="iq">.drone.yml</em></code> <em class="iq">文件中:</em><a class="ae kw" href="https://github.com/drone/drone/blob/master/.drone.yml" rel="noopener ugc nofollow" target="_blank"><em class="iq">【https://github.com/drone/drone/blob/master/.drone.yml】</em></a><em class="iq">。构建快速可靠。</em></p></blockquote><h1 id="60d7" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">输入无人机</h1><p id="d157" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我研究了许多备选方案，并决定至少对我来说，目前最好的CI/CD解决方案是<a class="ae kw" href="https://drone.io/" rel="noopener ugc nofollow" target="_blank"> Drone </a>。这是一个用Go编写的开源、非常轻量级的应用程序，可以作为SaaS或自托管服务器使用。无人机由两部分组成:</p><ul class=""><li id="03e8" class="ml mm iq ka b kb kc kf kg kj mn kn mo kr mp kv mq mr ms mt bi translated"><strong class="ka ir">服务器</strong>负责认证、存储库配置、用户、机密和接受webhooks。</li><li id="8a21" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv mq mr ms mt bi translated"><strong class="ka ir">代理</strong>接收构建任务并实际运行您的工作流。</li></ul><p id="3c0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">服务器和代理都是非常轻量级的服务，只使用大约10-15MB的RAM。这基本上意味着你甚至感觉不到它在你的笔记本电脑、台式机甚至是树莓派上运行。</p><h2 id="1d5e" class="mz lj iq bd lk na nb dn lo nc nd dp ls kj ne nf lw kn ng nh ma kr ni nj me nk bi translated">我的设置</h2><p id="46da" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我在Raspberry PI上运行无人机服务器，而代理在我的台式机上本地运行，我的台式机有大量RAM和16个CPU内核。这意味着构建比任何免费的公共服务都要快得多。此外，由于代理通过Webhook中继隧道连接到服务器，我可以将它们部署在Kubernetes、备用笔记本电脑或其他任何地方运行的机器上:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/39a948a20a1b68be36286fa68b07eeaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hr8TY-wMt-t9HH5A.png"/></div></div></figure><p id="edf0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种配置的好处:</p><ul class=""><li id="2adc" class="ml mm iq ka b kb kc kf kg kj mn kn mo kr mp kv mq mr ms mt bi translated">无需配置NAT，无人机服务器几乎不使用任何资源，因此它可以运行在廉价的硬件上。</li><li id="9929" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv mq mr ms mt bi translated">代理是分离的，可以在您的家庭/办公室机器上运行。通过隧道连接到它们，代理配置保持不变，无论它们部署在哪里(外部云提供商或内部办公室)。</li></ul><p id="55ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">未来的计划包括从用于无人机服务器的Raspberry Pi过渡到英特尔NUC(或其他一些低功耗替代产品)，并在同一台服务器上运行一些额外的无人机代理。</p><h1 id="e517" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">准备配置</h1><p id="d295" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">初始配置非常简单。首先，我们在Webhook Relay上创建一个隧道来获取我们的公共子域。然后，我们使用该子域创建一个Github OAuth应用程序。</p><p id="3016" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦服务器和隧道守护程序正在运行，您就可以毫不费力地连接/断开无人机代理。</p><h1 id="9645" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">为Github和远程访问设置隧道</h1><p id="8723" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我喜欢dogfooding，因此我们在整个堆栈中使用我们自己的隧道(CI/CD、监控仪表板、各种其他自动化)。在这种情况下，Webhook中继隧道提供了两个最重要的东西:</p><ul class=""><li id="0d0a" class="ml mm iq ka b kb kc kf kg kj mn kn mo kr mp kv mq mr ms mt bi translated">无论在哪里都可以访问无人机服务器(在您的笔记本电脑、台式机或某些Raspberry Pi上)，无需配置防火墙或路由器即可获得远程访问。</li><li id="3276" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv mq mr ms mt bi translated">Github的Webhooks将触发工作流。</li></ul><p id="a54a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">去你的<a class="ae kw" href="https://my.webhookrelay.com/tunnels" rel="noopener ugc nofollow" target="_blank">隧道页面</a>创建一个新的隧道。如果你在一个自由层，你会得到一个生成的子域，这很好。</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d71197aaa6ff1fd79021b45613a2ba5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/0*xS_2tTkUHijmcORW.png"/></div></figure><p id="80d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里:</p><ul class=""><li id="cb56" class="ml mm iq ka b kb kc kf kg kj mn kn mo kr mp kv mq mr ms mt bi translated">隧道的名字可以是任何东西，但是它必须与你在docker-compose.yaml中设置的webhookrelayd容器相匹配。</li><li id="7e32" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv mq mr ms mt bi translated"><strong class="ka ir">子域</strong>是你在<code class="fe le lf lg lh b">*.webrelay.io</code>下的公共子域。如果您参加的是免费计划，这将是自动生成的。</li><li id="99bf" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv mq mr ms mt bi translated"><strong class="ka ir">目的地</strong>是无人机服务器容器的地址。因为docker-compose配置虚拟网络，所以它必须匹配docker-compose.yaml中的服务名。</li><li id="a1a6" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv mq mr ms mt bi translated"><strong class="ka ir">加密类型</strong>可用于所有付费计划，基本上是HTTP/TLS。我会推荐订阅获取加密！否则，请给我发短信，我可以安排免费试用。</li></ul><h1 id="2c20" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">配置Github OAuth应用程序</h1><p id="96a4" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">在本指南中，我们将使用Github设置无人机。可以关注<a class="ae kw" href="https://docs.drone.io/installation/github/single-machine/" rel="noopener ugc nofollow" target="_blank">公文</a>。简而言之:</p><p id="0863" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建GitHub OAuth应用程序。消费者密钥和消费者秘密用于授权对Github资源的访问。授权回叫URL必须匹配以下格式和路径，并且必须使用您的确切服务器方案和主机。因此，如果您的Webhook中继隧道地址是<code class="fe le lf lg lh b">my-drone-subdomain.webrelay.io</code>，那么授权回调URL将是<code class="fe le lf lg lh b"><a class="ae kw" href="https://my-drone-subdomain.webrelay.io/login." rel="noopener ugc nofollow" target="_blank">https://my-drone-subdomain.webrelay.io/login</a></code> <a class="ae kw" href="https://my-drone-subdomain.webrelay.io/login." rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="e213" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">部署无人机服务器和代理</h1><p id="4a5a" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我最初开始使用Drone，服务器和代理都在我的桌面上运行，因为它只供我个人使用，很好。然而，后来我分离了服务器，并把它移到了一个树莓派。</p><p id="d2a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一体式配置如下所示:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="0865" class="mz lj iq lh b gy nv nw l nx ny">--- <br/>services: <br/>  drone-agent: <br/>    command: agent<br/>    container_name: drone-agent<br/>    depends_on: <br/>      - drone-server<br/>    environment: <br/>      - "DRONE_RPC_SERVER=<a class="ae kw" href="https://my-drone-subdomain.webrelay.io" rel="noopener ugc nofollow" target="_blank">https://my-drone-subdomain.webrelay.io</a>"<br/>      - "DRONE_RPC_SECRET=&lt;shared secret&gt;"<br/>      - DRONE_RUNNER_CAPACITY=2<br/>      - DRONE_RUNNER_NAME="local"<br/>    image: "drone/agent:1.0.0-rc.5"<br/>    restart: always<br/>    volumes: <br/>      - "/var/run/docker.sock:/var/run/docker.sock"<br/>  drone-server: <br/>    container_name: drone-server<br/>    environment: <br/>      - DRONE_SERVER_HOST=my-drone-subdomain.webrelay.io<br/>      - "DRONE_GITHUB_SERVER=<a class="ae kw" href="https://github.com" rel="noopener ugc nofollow" target="_blank">https://github.com</a>"<br/>      - "DRONE_ADMIN=&lt;your username&gt;"<br/>      - DRONE_GITHUB_CLIENT_ID=&lt;github-client-id&gt;<br/>      - DRONE_GITHUB_CLIENT_SECRET=&lt;github-client-secret&gt;<br/>      - DRONE_SERVER_PROTO=http<br/>      - "DRONE_RPC_SECRET=&lt;shared secret&gt;"<br/>    image: "drone/drone:1.0.0-rc.5"<br/>    ports: <br/>      - "8080:80"<br/>    restart: always<br/>    volumes: <br/>      - "db-data:/var/lib/drone/"<br/>  webhookrelay: <br/>    command: <br/>      - "--mode"<br/>      - tunnel<br/>      - "-t"<br/>      - drone<br/>    container_name: drone-webhookrelay<br/>    depends_on: <br/>      - drone-server<br/>    environment: <br/>      - KEY=&lt;whr-key&gt;<br/>      - SECRET=&lt;whr-secret&gt;<br/>    image: "webhookrelay/webhookrelayd:latest"<br/>    restart: always<br/>version: "3"<br/>volumes: <br/>  db-data: ~</span></pre><p id="03f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您需要另一台计算机上的另一个代理，仅代理配置:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="31ac" class="mz lj iq lh b gy nv nw l nx ny">--- <br/>services: <br/>  drone-agent: <br/>    command: agent<br/>    container_name: drone-agent<br/>    environment: <br/>      - "DRONE_RPC_SERVER=<a class="ae kw" href="https://my-drone-subdomain.webrelay.io" rel="noopener ugc nofollow" target="_blank">https://my-drone-subdomain.webrelay.io</a>"<br/>      - "DRONE_RPC_SECRET=&lt;shared secret&gt;"<br/>      - DRONE_RUNNER_CAPACITY=2<br/>      - DRONE_RUNNER_NAME="local"<br/>    image: "drone/agent:1.0.0-rc.5"<br/>    restart: always<br/>    volumes: <br/>      - "/var/run/docker.sock:/var/run/docker.sock"<br/>version: "3"</span></pre><p id="6941" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦有了配置:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="fd35" class="mz lj iq lh b gy nv nw l nx ny">docker-compose up</span></pre><p id="b3bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它会要求您使用您的Github凭证进行认证。</p><h1 id="285d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">使用无人机管道</h1><p id="5e66" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">无人机最好的一点是它们的管道配置。似乎在无人驾驶飞机展示了道路之后，行业紧随其后，现在大多数CI/CD服务通过Docker容器实现管道。这意味着您的构建和测试与物理主机分离，并且清理是通过设计进行的。一个示例流水线</p><ol class=""><li id="bb78" class="ml mm iq ka b kb kc kf kg kj mn kn mo kr mp kv nz mr ms mt bi translated">创建</li><li id="c565" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv nz mr ms mt bi translated">单元测试</li><li id="974d" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv nz mr ms mt bi translated">使用Postgres数据库运行端到端测试</li><li id="3893" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv nz mr ms mt bi translated">向时差发送一个网页挂钩</li><li id="d24f" class="ml mm iq ka b kb mu kf mv kj mw kn mx kr my kv nz mr ms mt bi translated">构建图像并将其推送到DockerHub</li></ol><p id="9315" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看起来像这样:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="6901" class="mz lj iq lh b gy nv nw l nx ny">--- <br/>kind: pipeline<br/>name: default<br/>services: <br/>  - <br/>    environment: <br/>      POSTGRES_DB: pgdb<br/>      POSTGRES_PASSWORD: pgpass<br/>      POSTGRES_USER: pguser<br/>    image: postgres<br/>    name: database<br/>steps: <br/>  - <br/>    commands: <br/>      - "cd cmd/app &amp;&amp; go build"<br/>    image: "golang:1.11.4"<br/>    name: build<br/>  - <br/>    commands: <br/>      - "go test -v `go list ./... `"<br/>    image: "golang:1.11.4"<br/>    name: unit-test<br/>  - <br/>    commands: <br/>      - "make install-transponder"<br/>      - "make e2e"<br/>    environment: <br/>      POSTGRES_DB: pgdb<br/>      POSTGRES_HOST: database<br/>      POSTGRES_PASSWORD: pgpass<br/>      POSTGRES_USER: pguser<br/>    image: "golang:1.11.4"<br/>    name: end-to-end<br/>  - <br/>    image: plugins/slack<br/>    name: slack<br/>    settings: <br/>      channel: general<br/>      icon_url: "<a class="ae kw" href="https://i.pinimg.com/originals/51/29/a4/5129a48ddad9e8408d2757dd10eb836f.jpg" rel="noopener ugc nofollow" target="_blank">https://i.pinimg.com/originals/51/29/a4/5129a48ddad9e8408d2757dd10eb836f.jpg</a>"<br/>      username: drone<br/>      webhook: <br/>        from_secret: slack_url<br/>  - <br/>    image: plugins/docker<br/>    name: docker<br/>    settings: <br/>      auto_tag: true<br/>      password: <br/>        from_secret: docker_password<br/>      repo: namespace/repo<br/>      username: <br/>        from_secret: docker_username<br/>workspace: <br/>  base: /go<br/>  path: src/github.com/webhookrelay/app</span></pre><p id="56e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过始终使用容器来运行管道，您将使您的构建和测试真正可移植。每当你按下Github，一个webhook就会点击Drone，它就会开始构建:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/79da18e01d80e55c9a92842d5f9dc25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CfuVXdDplKZPNLw3.png"/></div></div></figure><h1 id="210d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">提示和技巧</h1><p id="7a3b" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我还想分享一些非常有用的命令。要安装<code class="fe le lf lg lh b">drone</code> CLI，请遵循<a class="ae kw" href="https://docs.drone.io/cli/install/" rel="noopener ugc nofollow" target="_blank">正式文档</a>。</p><h2 id="8fa4" class="mz lj iq bd lk na nb dn lo nc nd dp ls kj ne nf lw kn ng nh ma kr ni nj me nk bi translated">直接执行管道</h2><p id="9208" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">您还可以使用无人机CLI直接运行管道:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="7e14" class="mz lj iq lh b gy nv nw l nx ny">drone exec --secret-file drone_secrets.yaml .drone.yml</span></pre><p id="3b48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">无人机秘密的模板:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="02da" class="mz lj iq lh b gy nv nw l nx ny">slack_url: https://hooks.slack.com/services/xxxxxxxxxxxx</span></pre><h2 id="b922" class="mz lj iq bd lk na nb dn lo nc nd dp ls kj ne nf lw kn ng nh ma kr ni nj me nk bi translated">通过CLI添加机密</h2><p id="83ea" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">您可以通过web用户界面添加密码，也可以直接从终端使用<code class="fe le lf lg lh b">drone</code>:</p><pre class="nm nn no np gt nr lh ns nt aw nu bi"><span id="30a3" class="mz lj iq lh b gy nv nw l nx ny">drone secret add -repository username/repository-name --name foo --data bar --allow-pull-request</span></pre><h1 id="e9e4" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">包扎</h1><p id="c051" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我广泛使用了Jenkins、Gitlab runners、CircleCI和Google Cloud Builder。我想我还是喜欢很多与GKE相关的云构建器，因为它可以快速构建图像，并且无需任何额外的工作就可以认证到GCR注册中心。然而，您确实会被他们的管道配置文件所困，并且不能真正地转移到任何其他供应商。对于Jenkins来说，很难想象如何高效地运行it和更小的服务器。无人机，至少对我来说，是一个现代服务的理想例子，它专注于效率和正确地做一件事。</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="b85b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="la">原载于2019年2月11日</em><a class="ae kw" href="https://webhookrelay.com/blog/2019/02/11/using-drone-for-simple-selfhosted-ci-cd/" rel="noopener ugc nofollow" target="_blank"><em class="la">【webhookrelay.com】</em></a><em class="la">。</em></p></div></div>    
</body>
</html>
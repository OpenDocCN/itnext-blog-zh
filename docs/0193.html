<html>
<head>
<title>Subdomain or Multi-Tenant in Ruby On Rails (Multi-Tenant SaaS App)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby On Rails中的子域或多租户(多租户SaaS应用程序)</h1>
<blockquote>原文：<a href="https://itnext.io/subdomain-or-multi-tenant-in-ruby-on-rails-multi-tenant-saas-app-881d989c8d98?source=collection_archive---------0-----------------------#2017-11-24">https://itnext.io/subdomain-or-multi-tenant-in-ruby-on-rails-multi-tenant-saas-app-881d989c8d98?source=collection_archive---------0-----------------------#2017-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/eab78da27f82a7059fe33d382d8dbdde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JrQOd_3j1E9a-Tf3kBik-A.jpeg"/></div></div></figure><p id="83bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">子域在许多不同的场景中非常有用。例如，假设您正在构建一个多用户应用程序。每个用户都有自己的空间。能够给每个用户一个唯一的子域允许你给用户他们自己的个人空间。</p><p id="51a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从安全角度来看，这也是非常有益的，因为所有子域都有自己的DB模式。所以，如果你没有访问权限，那么你就不能到达其他域。</p><p id="9885" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fsubdomain-or-multi-tenant-in-ruby-on-rails-multi-tenant-saas-app-881d989c8d98" rel="noopener ugc nofollow" target="_blank"> <em class="kx">点击这里在LinkedIn </em>上分享这篇文章</a></p><p id="d7b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们实现子域功能。我用PostgreSQL做数据库。</p><p id="71c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是以下步骤:</p><p id="5c5f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一步:在你的gem文件中添加下面一行。</strong></p><p id="b93d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了实现子域功能，我将使用“公寓”宝石。更多详情，你可以查看下面的网址。</p><p id="cac6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://github.com/influitive/apartment" rel="noopener ugc nofollow" target="_blank">https://github.com/influitive/apartment</a></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="12d7" class="lh li iq ld b gy lj lk l ll lm">gem 'apartment' gem 'devise', '~&gt; 4.2' gem 'devise_invitable', '~&gt; 1.7.1'</span></pre><p id="f50e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为设计gem实施，请参考下面的文章。<br/><a class="ae kw" href="http://qiita.com/alokrawat050/items/5267e6ab0e274ad1188a" rel="noopener ugc nofollow" target="_blank">http://qiita.com/alokrawat050/items/5267e6ab0e274ad1188a</a></p><p id="9881" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第二步:</strong>创建一些有用的控制器、模型，比如说账户。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6969" class="lh li iq ld b gy lj lk l ll lm">rails g controller account new rails g controller welcome index rails g model account new</span></pre><p id="5ef5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在控制器中写一些代码，<br/><strong class="ka ir">→accounts _ controller . Rb</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="15c7" class="lh li iq ld b gy lj lk l ll lm">class AccountsController &lt; ApplicationController<br/>  skip_before_filter :authenticate_user!, only: [:new, :create]<br/>  def new<br/>    @account = Account.new<br/>    @account.build_owner    <br/>    #store plan id in session<br/>    session[:plan_id] = params[:plan_id]<br/>  end<br/><br/>  def create<br/>    @account = Account.new(accounts_params)<br/>    @account.assign_attributes(:plan_id =&gt; session[:plan_id])<br/>    if @account.valid?<br/>      Apartment::Tenant.create(@account.subdomain_name)<br/>      Apartment::Tenant.switch!(@account.subdomain_name)<br/>      if @account.save<br/>        session[:plan_id] = nil<br/>        redirect_to new_user_session_url(subdomain: "#{@account.subdomain_name}.demo-alokrawat050")<br/>      else<br/>        render action: 'new'<br/>      end<br/>    else<br/>      render action: 'new'<br/>    end<br/>  end<br/><br/>  private<br/>    def accounts_params<br/>      params.require(:account).permit(:subdomain_name, owner_attributes: [:username, :is_admin, :email, :password, :password_confirmation, :password_updated_at])<br/>    end <br/>end</span></pre><p id="65e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> →welcome_controller.rb </strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="10b2" class="lh li iq ld b gy lj lk l ll lm">class WelcomeController &lt; ApplicationController<br/>  skip_before_filter :authenticate_user!, only: [:index, :find_team, :find_team_index]<br/>  def index<br/>  end<br/><br/>  def find_team<br/>    if params[:team_name].present? &amp;&amp; !params[:team_name].nil? &amp;&amp; !params[:team_name].blank?<br/>      Apartment::Tenant.switch!('public')<br/>      if search_team(params[:team_name])<br/>        Apartment::Tenant.switch!(params[:team_name])<br/>        redirect_to new_user_session_url(subdomain: "#{params[:team_name]}.demo-alokrawat050")<br/>      else<br/>        flash[:alert] = "Team Not Found."<br/>        redirect_to root_path<br/>      end<br/>    else<br/>      flash[:alert] = "Please Enter the Team Name."<br/>      redirect_to root_path<br/>    end<br/>  end<br/><br/>  def find_team_index<br/>  end<br/><br/>  protected<br/>  def search_team(team_name)<br/>    @account ||= Account.find_by(subdomain_name: team_name)<br/>  end<br/>end</span></pre><p id="6503" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">application _ controller . Rb</strong>文件看起来很像，</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a589" class="lh li iq ld b gy lj lk l ll lm">class ApplicationController &lt; ActionController::Base<br/>  # Prevent CSRF attacks by raising an exception.<br/>  # For APIs, you may want to use :null_session instead.<br/>  protect_from_forgery with: :exception<br/><br/>  before_filter :load_schema, :authenticate_user!, :set_mailer_host<br/>  before_filter :configure_permitted_parameters, if: :devise_controller?<br/><br/>  protected<br/>  def configure_permitted_parameters<br/>    devise_parameter_sanitizer.permit(:accept_invitation){|u|<br/>      u.permit(:username, :password, :password_confirmation, :invitation_token, :password_updated_at)<br/>    }<br/>  end<br/><br/>  private<br/>    def load_schema<br/>      Apartment::Tenant.switch!('public')<br/>      return unless get_subdomain_acc.present?<br/><br/>      if current_account<br/>        Apartment::Tenant.switch!(current_account.subdomain_name)<br/>      else<br/>        redirect_to root_url(subdomain: false)<br/>      end<br/>    end<br/><br/>    def current_account<br/>      @current_account ||= Account.find_by(subdomain_name: get_subdomain_acc)<br/>    end<br/><br/>    helper_method :current_account<br/><br/>    def set_mailer_host<br/>      subdomain = current_account ? "#{current_account.subdomain_name}." : ""<br/>      if Rails.env == "production"<br/>        ActionMailer::Base.default_url_options[:host] = "#{subdomain}&lt;your production name&gt;.com"<br/>      elsif Rails.env == "staging"<br/>        ActionMailer::Base.default_url_options[:host] = "#{subdomain}&lt;your staging name&gt;.com"<br/>      else<br/>        ActionMailer::Base.default_url_options[:host] = "#{subdomain}demo-alokrawat050.c9users.io"<br/>      end<br/>    end<br/><br/>    def get_subdomain_acc<br/>      if Rails.env == "production"<br/>        return request.subdomain<br/>      elsif Rails.env == "staging"<br/>        return request.subdomain<br/>      else<br/>        return request.subdomain.gsub!(".demo-alokrawat050","")<br/>      end<br/>    end<br/><br/>    def after_sign_out_path_for(resource_or_scope)<br/>      new_user_session_path<br/>    end<br/><br/>    def after_invite_path_for(resource)<br/>      #invite_users_path<br/>      root_path<br/>    end<br/>end</span></pre><p id="f520" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第三步:用助手方法做一些工作。<br/>在<strong class="ka ir"> application_helper.rb中，</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="683a" class="lh li iq ld b gy lj lk l ll lm">module ApplicationHelper<br/>    def get_subdomain<br/>        return request.subdomain.gsub!(".demo-alokrawat050","")<br/>    end<br/><br/>    def link_to_add_fields(name, f, association)<br/>        new_object = f.object.send(association).klass.new<br/>        id= new_object.object_id<br/>        fields=f.fields_for(association, new_object, child_index: id) do | builder |<br/>            render(association.to_s.singularize + "_fields", f: builder)<br/>        end<br/>        link_to(name, '#', class: "add_fields", data: {id: id, fields: fields.gsub("\n", "")})<br/>    end<br/><br/>    def check_is_admin_rights?<br/>        if current_user.is_admin<br/>          true<br/>        else <br/>          false<br/>        end<br/>    end<br/>end</span></pre><p id="8b26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个新的助手，<strong class="ka ir"> form_helper.rb </strong>和<strong class="ka ir"> layout_helper.rb </strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="8264" class="lh li iq ld b gy lj lk l ll lm">module FormHelper<br/>    def errors_for(form, field)<br/>        content_tag(:p, form.object.errors[field].try(:first), class: 'help-block')<br/>    end<br/><br/>    def form_group_for(form, field, opts={}, &amp;block)<br/>        label = opts.fetch(:label) { true }<br/>        has_errors = form.object.errors[field].present?<br/><br/>        content_tag :div, class: "form-group #{'has-error' if has_errors}" do<br/>            concat form.label(field, class: 'control-label') if label<br/>            concat capture(&amp;block)<br/>            concat errors_for(form, field)<br/>        end<br/>    end<br/>end</span><span id="76f9" class="lh li iq ld b gy ln lk l ll lm">module LayoutHelper<br/>    def flash_messages(opts={})<br/>        @layout_flash = opts.fetch(:layout_flash) { true }<br/><br/>        capture do<br/>           flash.each do | name, msg|<br/>              concat content_tag(:div, msg, id: "flash_#{name}") <br/>           end<br/>        end<br/>    end<br/><br/>    def show_layout_flash?<br/>        @layout_flash.nil? ? true : @layout_flash<br/>    end<br/>end</span></pre><p id="373b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候做一些验证了。<br/> <strong class="ka ir"> account.rb </strong>型号设置、</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="8d5a" class="lh li iq ld b gy lj lk l ll lm">class Account &lt; ActiveRecord::Base<br/><br/>    RESTRICTED_SUBDOMAIN = %w(www)<br/>    belongs_to :owner, class_name: 'User'<br/>    #validates :owner, presence: true<br/>    accepts_nested_attributes_for :owner, allow_destroy: true<br/><br/>    validates :subdomain_name, presence: true,<br/>                            uniqueness: { case_sensitive: false},<br/>                            format: { with: /\A[\w\-]+\Z/i, message: 'contains invalid characters' },<br/>                            exclusion: {in: RESTRICTED_SUBDOMAIN, message: 'restricted'}<br/><br/>    before_validation :downcase_account<br/><br/>    private<br/>        def downcase_account<br/>            self.subdomain_name = subdomain_name.try(:downcase) <br/>        end <br/>end</span></pre><p id="38d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里做一些数据库的工作。下面是我的迁移文件:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="81a8" class="lh li iq ld b gy lj lk l ll lm">def change<br/>  create_table :accounts do |t|<br/>      t.string :subdomain_name<br/>      t.integer :owner_id<br/>      t.integer :plan_id<br/>      t.string :updated_by<br/>      t.boolean :del_flag, default: false<br/>      t.timestamps null: false<br/>  end<br/> end</span></pre><p id="9688" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在这里的设计部分，就看你的了。但是我在这里做了一些工作。在视图中，</p><p id="c8b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">/视图/账户/new.html.erb </strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="db91" class="lh li iq ld b gy lj lk l ll lm">&lt;% def msg(status) return "#{status}" end %&gt;<br/>&lt;section id="download"&gt;<br/>    &lt;div class="container"&gt;<br/>        &lt;div class="row"&gt;<br/>            &lt;div class="col-md-7 col-md-offset-3 panel panel-default"&gt;<br/>                &lt;div class="panel-body"&gt;<br/>                    &lt;h2&gt;Create an Acccount&lt;/h2&gt;<br/>                    &lt;%= form_for @account do |f| %&gt;<br/>                        &lt;%= f.fields_for :owner do |o| %&gt;<br/>                            &lt;%= form_group_for o, :username, label: false  do %&gt;<br/>                                &lt;div class="input-group"&gt;<br/>                                    &lt;span class="input-group-addon"&gt;&lt;span class="fa fa-user fa-lg fa-fw"&gt;&lt;/span&gt;&lt;/span&gt;<br/>                                    &lt;%= o.text_field :username, class: 'form-control', placeholder: 'UserName' %&gt;<br/>                                &lt;/div&gt;<br/>                            &lt;% end %&gt;  <br/>                            &lt;%= form_group_for o, :email, label: false  do %&gt;<br/>                                &lt;div class="input-group"&gt;<br/>                                    &lt;span class="input-group-addon"&gt;&lt;span class="fa fa-envelope fa-lg fa-fw"&gt;&lt;/span&gt;&lt;/span&gt;<br/>                                    &lt;%= o.email_field :email, class: 'form-control', placeholder: 'Email' %&gt;<br/>                                &lt;/div&gt;<br/>                            &lt;% end %&gt;  <br/>                            &lt;%= form_group_for o, :password, label: false  do %&gt;<br/>                                &lt;div class="input-group"&gt;<br/>                                    &lt;span class="input-group-addon"&gt;&lt;span class="fa fa-key fa-lg fa-fw"&gt;&lt;/span&gt;&lt;/span&gt;<br/>                                    &lt;%= o.password_field :password, class: 'form-control', placeholder: 'Password' %&gt;<br/>                                &lt;/div&gt;<br/>                            &lt;% end %&gt;  <br/>                            &lt;%= form_group_for o, :password_confirmation, label: false  do %&gt;<br/>                                &lt;div class="input-group"&gt;<br/>                                    &lt;span class="input-group-addon"&gt;&lt;span class="fa fa-key fa-lg fa-fw"&gt;&lt;/span&gt;&lt;/span&gt;<br/>                                    &lt;%= o.password_field :password_confirmation, class: 'form-control', placeholder: 'Confirm Password' %&gt;<br/>                                &lt;/div&gt;<br/>                            &lt;% end %&gt;<br/><br/>                            &lt;%= o.hidden_field :password_updated_at, :value =&gt; Time.zone.now %&gt;<br/>                        &lt;% end %&gt;<br/>                        &lt;%= form_group_for f, :subdomain_name, label: false  do %&gt;<br/>                            &lt;div class="input-group"&gt;<br/>                                &lt;%= f.text_field :subdomain_name, class: 'form-control', placeholder: 'Company Name' %&gt;<br/>                                &lt;span class="input-group-addon"&gt;<br/>                                    &lt;% if Rails.env == "production" %&gt;<br/>                                        .&lt;your production name&gt;<br/>                                    &lt;% elsif Rails.env == "staging" %&gt;<br/>                                        .&lt;your staging name&gt;<br/>                                    &lt;% else %&gt;<br/>                                        .demo-alokrawat050.c9users.io       <br/>                                    &lt;% end %&gt;<br/>                                &lt;/span&gt;<br/>                            &lt;/div&gt;<br/>                        &lt;% end %&gt;<br/>                        &lt;%= f.submit("Create Account", class:"btn btn-primary", data: {:confirm =&gt; msg('Do you want to create account?'), :disable_with =&gt; 'Creating'}) %&gt;<br/>                    &lt;% end %&gt;<br/>                &lt;/div&gt;    <br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;  <br/>&lt;/section&gt;</span></pre><p id="1f74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有<strong class="ka ir">/views/welcome/index . html . erb</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4d05" class="lh li iq ld b gy lj lk l ll lm">&lt;div class="container"&gt;<br/>        &lt;div class="row"&gt;<br/>            &lt;div class="col-xs-6 col-sm-12 col-lg-6 wow fadeInUp" data-wow-delay="0.6s"&gt;<br/>                &lt;img src="/assets/find_team_img.png" class="img-responsive" alt="feature img" width="300px" height="200px"&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="col-xs-12 col-sm-12 col-lg-6 wow fadeInUp templatemo-box" data-wow-delay="0.3s"&gt;<br/>                &lt;p&gt;If already joined with us, then please provide the your team name.&lt;/p&gt;<br/>                &lt;div class="form-inline"&gt;<br/>                    &lt;div class="form-group"&gt;<br/>                        &lt;%= form_tag(:action =&gt; 'find_team') do |f| %&gt;<br/>                            &lt;%= text_field_tag 'team_name', @team_name, class: "form-control btn-lg", placeholder: "Team Name", style: "height:50px" %&gt;<br/>                            &lt;%= button_tag(type: "submit", class: "btn btn-default") do %&gt;<br/>                                &lt;i class="fa fa-search" aria-hidden="true"&gt;&lt;/i&gt; Find Team<br/>                            &lt;% end %&gt;<br/>                            &lt;%#= flash_messages layout_flash: false %&gt;<br/>                        &lt;% end %&gt;<br/>                    &lt;/div&gt;    <br/>                &lt;/div&gt;<br/>            &lt;/div&gt;          <br/>        &lt;/div&gt;<br/>    &lt;/div&gt;</span></pre><p id="92f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候为你的系统设置路线了。<br/>在<strong class="ka ir"> routes.rb </strong>文件中，</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2b99" class="lh li iq ld b gy lj lk l ll lm">class SubdomainPresent<br/>  def self.matches?(request)<br/>    if Rails.env == "production"<br/>        request.subdomain.present?<br/>    elsif Rails.env == "staging"<br/>      request.subdomain.present?<br/>    else<br/>      request.subdomain.gsub!(".demo-alokrawat050","").present?<br/>      end<br/>  end<br/>end<br/><br/>class SubdomainBlank<br/>  def self.matches?(request)<br/>    if Rails.env == "production"<br/>        request.subdomain.blank?<br/>    elsif Rails.env == "staging"<br/>      request.subdomain.blank?<br/>    else<br/>      request.subdomain.gsub!(".demo-alokrawat050","").blank?<br/>      end<br/>  end<br/>end<br/><br/>Rails.application.routes.draw do<br/>  constraints(SubdomainPresent) do <br/>    root 'home#index', as: :subdomain_root<br/>    devise_for :users,<br/>    controllers: { invitations: 'users/invitations' }<br/>    resources :invite_users<br/>    resources :users#, only: :index<br/>  end  <br/><br/>  constraints(SubdomainBlank) do <br/>    root 'welcome#index'<br/>    resources :accounts, only: [:new, :create]<br/>    resources :welcome do<br/>      collection { post :find_team<br/>      get :find_team_index}<br/>    end<br/>  end  <br/>end</span></pre><p id="db56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，为公寓宝石做一些设置。<br/>打开<strong class="ka ir"> /config/application.rb </strong>文件，在下面添加一行。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="1818" class="lh li iq ld b gy lj lk l ll lm">config.middleware.use 'Apartment::Elevators::Subdomain'</span></pre><p id="9651" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和<strong class="ka ir">/config/initializer/apartment . Rb</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="917b" class="lh li iq ld b gy lj lk l ll lm">Apartment.configure do |config|<br/>   config.tenant_names = -&gt; { Account.pluck(:subdomain_name) }<br/>   config.excluded_models = ['Account']  <br/># these models will not be multi-tenanted, but remain in the global (public) namespace<br/>   Apartment::Elevators::Subdomain.excluded_subdomains = ['www', 'demo-alokrawat050', 'admin', 'public']<br/>end</span></pre><p id="245d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这篇文章能帮助你理解，如何实现子域功能或SAAS概念。</p><p id="e284" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你有任何疑问，请与我分享。</p><p id="e934" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">享受编码</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/00c15ea30830a91f980a3d2aa696cdc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*KjLUJWSLsatWpRm8.png"/></div></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/1e949ee02049aa3952972f497a4ffe7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*zn6e47vZAsYa2X2j.png"/></div></figure><p id="be55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">谢谢&amp;最诚挚的问候，<br/> Alok Rawat </strong></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="183e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">最初发表于</em><a class="ae kw" href="https://qiita.com/alokrawat050/items/ee8aba55a9cccb82368f" rel="noopener ugc nofollow" target="_blank"><em class="kx"/></a><em class="kx">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Using MongoDB with Astro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用MongoDB和Astro</h1>
<blockquote>原文：<a href="https://itnext.io/using-mongodb-with-astro-5c9cf7f1be50?source=collection_archive---------1-----------------------#2022-09-03">https://itnext.io/using-mongodb-with-astro-5c9cf7f1be50?source=collection_archive---------1-----------------------#2022-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="d5f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个非常简单容易的教程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/46791047e2e1390e4fbcfc0d006cb644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gO0ALgUp4fGpZEDh4LKgVA.jpeg"/></div></div></figure><p id="eb07" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我最近开始在我的项目中使用Astro，它看起来很有前景。Astro在静态站点生成方面很棒，但是我更喜欢<a class="ae la" href="https://docs.astro.build/en/guides/server-side-rendering/" rel="noopener ugc nofollow" target="_blank">服务器端渲染</a> (SSR)。让我们看看如何在我们的Astro SSR项目中使用MongoDB。(本教程也适用于SSG)。</p><p id="c1be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完全回购👉:<a class="ae la" href="https://github.com/skolhustick/astro-mongodb" rel="noopener ugc nofollow" target="_blank">https://github.com/skolhustick/astro-mongodb</a></p><h2 id="327a" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">1.创建一个空白的天文项目</h2><pre class="kp kq kr ks gt lu lv lw lx aw ly bi"><span id="1aa8" class="lb lc it lv b gy lz ma l mb mc">npm create astro@latest</span></pre><p id="5d0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我通常选择空白模板。在本教程中，我们不使用Typescript。</p><h2 id="7d92" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">2.添加依赖关系</h2><p id="56ec" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">添加下列依赖项。我们将使用本地Node.js MongoDB驱动程序和Astro的Node.js适配器。Node.js适配器只有在需要服务器端渲染时才需要。我们也将Svelte用于交互组件。你可以用你喜欢的任何东西。</p><pre class="kp kq kr ks gt lu lv lw lx aw ly bi"><span id="1408" class="lb lc it lv b gy lz ma l mb mc">npm install --save mongodb<br/>npm install --save-dev @astrojs/node<br/>npm run astro add svelte</span></pre><h2 id="9a90" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">3.配置<code class="fe mi mj mk lv b">astro.config.mjs</code></h2><p id="7c1b" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">你的astro.config.mjs可能需要添加一些配置，添加Node.js适配器和svelte后，我的是这样的。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="207c" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">4.设置环境变量</h2><p id="1a02" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">创建一个<code class="fe mi mj mk lv b">.env</code>文件和你的MongoDB URI。</p><pre class="kp kq kr ks gt lu lv lw lx aw ly bi"><span id="72a8" class="lb lc it lv b gy lz ma l mb mc">NODE_ENV="development"<br/>MONGODB_URI="mongodb://localhost:27017"</span></pre><h2 id="863d" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">5.正在连接到MongoDB</h2><p id="3721" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">让我们添加一个名为<code class="fe mi mj mk lv b">mongodb.js</code>的文件。这个文件将帮助我们连接到我们的MongoDB。为了简单起见，我还在这个文件中导出了<code class="fe mi mj mk lv b">Users</code>集合。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="e8ec" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">6.读取和写入数据</h2><p id="8617" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">让我们创建几个助手函数来帮助我们从MongoDB中读取和写入数据。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="750c" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">7.创建API路由</h2><p id="4e9c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">让我们创建几个可以从客户端使用的API路由。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="38d6" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">8.添加表单以创建用户</h2><p id="74dd" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">这里有一个简单的组件，它向我们的API端点提交一个表单。一旦我们成功添加了用户，我们将重定向到一个列出所有用户的页面。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="3a4c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保您的<code class="fe mi mj mk lv b">.svelte</code>组件被添加到<code class="fe mi mj mk lv b">.astro</code>页面，并在客户端设置为水合物。否则，如果没有客户端JS，我们将无法提交表单。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mn"><img src="../Images/7729eecd413e19ebc4701349852a4a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BY6CvoIWgqkeIAi_JE-4yw.png"/></div></div></figure><h2 id="40fb" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">9.列出所有用户</h2><p id="5aea" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">只是另一个简单的页面，它从服务器获取数据。该页面上的数据将在服务器端呈现。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="1b0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样！以下是完整的回购协议:</p><div class="mo mp gp gr mq mr"><a href="https://github.com/skolhustick/astro-mongodb" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">GitHub-skolhustick/astro-mongodb:用Astro使用MongoDB的简单方法。</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">初始天文模板最小🧑‍🚀经验丰富的宇航员？删除此文件。玩得开心！在你的宇宙里…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">github.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ky mr"/></div></div></a></div></div></div>    
</body>
</html>
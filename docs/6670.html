<html>
<head>
<title>Treat security as a risk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将安全视为一种风险</h1>
<blockquote>原文：<a href="https://itnext.io/treat-security-as-risk-5300741f9736?source=collection_archive---------2-----------------------#2022-01-23">https://itnext.io/treat-security-as-risk-5300741f9736?source=collection_archive---------2-----------------------#2022-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/812fa12626849fc28c74eb52a1c17fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r4mTRvUhFDTMf1ne9o_ncA.jpeg"/></div></div></figure><p id="938c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安全性是非功能性需求的典型代表:大多数人并不关心，直到众所周知的粪便碰到旋转推进器。后果可能是名誉扫地、承担法律责任，甚至停业。在我的关于运行不安全代码的<a class="ae kw" href="https://blog.frankel.ch/running-untrusted-code/" rel="noopener ugc nofollow" target="_blank">帖子中，我得出结论，你应该把安全视为一种风险——并就此打住。我认为应该设立一个专门的职位。</a></p><p id="d3a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">风险管理是非常好的<a class="ae kw" href="https://en.wikipedia.org/wiki/Risk_management" rel="noopener ugc nofollow" target="_blank">有很多文件证明</a>。你可以在许多工程学科中找到它，如果不是每一个的话。风险管理流程由以下步骤组成:</p><p id="b0d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">辨认</strong> ⇨ <strong class="ka ir">分析</strong> ⇨ <strong class="ka ir">分清轻重缓急</strong> ⇨ <strong class="ka ir">请客</strong> ⇨ <strong class="ka ir">班长</strong></p><p id="5021" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以<a class="ae kw" href="https://blog.frankel.ch/jvm-security/4/" rel="noopener ugc nofollow" target="_blank"> Attach API </a>为例，让我们看看如何将它应用于安全性。</p><h1 id="35bb" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">识别风险</h1><p id="3dee" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">简而言之，Attach API允许用户改变已经加载到正在运行的JVM 1.6+中的字节码。为此，您需要:</p><ul class=""><li id="94ac" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">正在运行的JVM的PID</li><li id="ef25" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">在同一系统上运行另一个JVM的能力</li></ul><p id="4565" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当附加的JVM再次启动时，它会丢弃更新后的<em class="ma">字节码</em>，并从预期的位置加载代码。因此，没有迹象表明<em class="ma">字节码</em>已经通过这个特性被改变了。</p><p id="f825" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过Attach API，恶意参与者可以改变正在运行的应用程序的行为。例如，参与者可以将每笔交易的几分钱存入他们在银行系统中的账户。</p><h1 id="44f6" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">分析风险</h1><p id="fd63" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">既然我们已经正确地识别了风险，我们需要量化它的可能性:恶意行为者触发风险的可能性有多大？</p><p id="a88a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于我们的示例，我们需要评估以下情况的可能性:</p><ol class=""><li id="e034" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mp mh mi mj bi translated">进入系统</li><li id="0aa3" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mp mh mi mj bi translated">获取启动JVM的权限</li><li id="bc6c" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mp mh mi mj bi translated">获取JVM的PID</li></ol><p id="8569" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">系统访问和许可取决于这篇博文上下文中的未知因素。然而，如果您满足了另外两个条件，那么获得JVM的PID是很简单的。</p><p id="5481" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于低于版本9的JVM，我们需要默认使用<code class="fe mq mr ms mt b">Runtime</code>类并使用<code class="fe mq mr ms mt b">jps</code>命令:</p><pre class="mu mv mw mx gt my mt mz na aw nb bi"><span id="769e" class="nc ky iq mt b gy nd ne l nf ng">long pid = Runtime.getRuntime()<br/>               .exec("jps")<br/>               .inputStream<br/>               .bufferedReader(Charset.forName("UTF-8"))<br/>               .lines()<br/>               .map { it.split(" ").toTypedArray() }<br/>               .filter { it.size &gt; 1 &amp;&amp; it[1].endsWith("BusinessApplicationKt") }<br/>               .map { it[0] }</span></pre><p id="ed47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从9开始，JVM在流程API中增加了一个专用的<code class="fe mq mr ms mt b">ProcessHandle</code>类:</p><pre class="mu mv mw mx gt my mt mz na aw nb bi"><span id="9a62" class="nc ky iq mt b gy nd ne l nf ng">long pid = ProcessHandle.current().pid()</span></pre><h1 id="df62" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">优先考虑</h1><p id="ce28" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">为了确定优先级，我们需要评估一次成功攻击的影响。</p><p id="360c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Attach API的上下文中，它依赖于目标系统。这是非常依赖于上下文的，所以这里有一些领域的例子:</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/74dcc26b53079f7ccce5dd096a8748ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwW_9o0SnXuqUu3hochNoA.png"/></div></div></figure><h1 id="6204" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">款待</h1><p id="7917" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">治疗包括两件独立的事情:</p><ul class=""><li id="2e34" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">防止风险发生</li><li id="85cd" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><em class="ma">缓解措施</em>，如果有的话</li></ul><p id="0634" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">缓解措施可以降低攻击的影响。可能有几个缓解措施。对于每一种，你都需要描述:它减少了多少影响，花费了多少。</p><p id="4ad8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Attach API，默认情况下会启用该功能。处理方法是显式禁用它。我想不出任何缓解措施。一旦恶意行为者注入了<em class="ma">字节码</em>，后者就会自行其是。</p><h1 id="1dc7" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">现实世界中的风险管理</h1><p id="0e8f" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">安全不是一个非黑即白的问题。没有安全系统和不安全系统之分。对于特定的威胁，有些系统比其他系统更安全。此外，提高抵御威胁的安全性通常是有成本的。因此，人们需要在风险的可能性、其影响、治疗成本和可能的缓解措施之间找到正确的平衡。</p><p id="49d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你实施了我上面描述的所有风险管理步骤，你可能还是会失败。原因是我们在人类组织内工作:它涉及政治、指责游戏、逃避责任以及类似的公司相关细节。</p><p id="0c70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想有机会让风险管理发挥作用，你需要跟踪所做的决定。记录应包括上述所有内容:风险、描述、可能性、影响、缓解措施等。，没有忘记决定。可以是<em class="ma">接受</em>、<em class="ma">拒绝</em>或任何缓解行动。</p><p id="9516" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">缺少一条关键信息:做决定的人。通过让一个人负责，他们将<em class="ma">承诺</em>而不仅仅是<em class="ma">参与</em>。在这一点上，仍然没有保证。然而，该组织将更好地准备，以避免最糟糕的惨败，如<a class="ae kw" href="https://en.wikipedia.org/wiki/2017_Equifax_data_breach" rel="noopener ugc nofollow" target="_blank"> Equifax数据泄露</a>。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="9b60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ma">最初发表于</em> <a class="ae kw" href="https://blog.frankel.ch/treat-security-as-risk/" rel="noopener ugc nofollow" target="_blank"> <em class="ma">一个Java极客</em></a><em class="ma">2022年1月23日</em></p></div></div>    
</body>
</html>
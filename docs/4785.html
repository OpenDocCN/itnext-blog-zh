<html>
<head>
<title>OLED Display as a Web Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有机发光二极管显示为Web组件</h1>
<blockquote>原文：<a href="https://itnext.io/turning-arduino-oled-display-into-a-web-component-bf6bbb43a257?source=collection_archive---------3-----------------------#2020-09-17">https://itnext.io/turning-arduino-oled-display-into-a-web-component-bf6bbb43a257?source=collection_archive---------3-----------------------#2020-09-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们创建一个基于硬件设备的web组件！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/1f8bb2135cc48b36ef7f608471085e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o0ZGp85Db1qDN428NBrarQ.png"/></div></div></figure><p id="af05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">**注:我最初在Wokwi的官方博客上发表了这篇文章。</p><p id="1673" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下面的帖子中，我将描述我在硬件设备上制作web组件的个人经历，作为对“<a class="ae kx" href="https://elements.wokwi.com/?path=/story/rotary-dialer--default" rel="noopener ugc nofollow" target="_blank"> Wokwi-elements </a>”的贡献的一部分。这是一个由<a class="ae kx" href="https://medium.com/u/355b1dfe86ae" rel="noopener"> Uri Shaked </a>制作的非常酷的“Arduino元素”开源库。</p><p id="99aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Wokwi lib背后的创意立即吸引了我的注意力，我意识到这是一个尝试新技术和获得更多概念经验的机会。</p><p id="a54f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我很快尝试解释一下<a class="ae kx" href="https://wokwi.com/" rel="noopener ugc nofollow" target="_blank"> Wokwi </a>(目前)是什么，我会说——一个有趣的教程形式的虚拟Arduino游乐场环境，建立在令人印象深刻的Arduino AVR模拟器项目之上。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/3ec98dc3653629c4a23955cd6fda489a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVUePC6dBT9ngx1NIPQqZA.png"/></div></div></figure><p id="ca32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">制作硬件组件的web表单是一个有趣的过程。</p><p id="5529" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它要求:</p><ul class=""><li id="7e68" class="kz la iq jp b jq jr ju jv jy lb kc lc kg ld kk le lf lg lh bi translated">对组件做一些研究——获得它的实际大小(物理高度和宽度)。</li><li id="cb1d" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">注意其各部分之间的比例(比例)。</li><li id="4291" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">了解其使用方式，以便其网络行为尽可能接近原始设备，从而提供良好的用户体验。</li></ul><h2 id="5d6f" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">你说是有机发光二极管？</h2><p id="ae72" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">有机发光二极管是一种显示技术。你可能对液晶显示器很熟悉，那么有机发光二极管有什么特别之处呢？</p><p id="81fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有机发光二极管显示器是发射型的，这意味着当你给它们通电时，它们的像素会发光。这与液晶显示器形成对比，液晶显示器通过阻挡光线来显示图像。</p><p id="594f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这使得有机发光二极管的效率更高:因为它们自己发光，只有白色像素耗电，不需要耗电的背光(就像液晶显示器一样)。</p><p id="3075" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击了解更多关于有机发光二极管及其用途的信息。</p><div class="ml mm gp gr mn mo"><a href="https://www.adafruit.com/product/326" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">单色0.96英寸128x64有机发光二极管图形显示器- STEMMA QT</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">Adafruit Industries，独特的&amp;趣味DIY电子产品和套件单色0.96 128x64有机发光二极管图形显示器- STEMMA QT…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">www.adafruit.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc kv mo"/></div></div></a></div><p id="9327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">制作有机发光二极管显示器的目标是在使用I2C协议(SDA，SCL引脚)和使用其<a class="ae kx" href="https://github.com/adafruit/Adafruit_SSD1306/blob/68249c7803ef43988c433111411f69bfdd01114e/examples/ssd1306_128x64_i2c/ssd1306_128x64_i2c.ino" rel="noopener ugc nofollow" target="_blank">驱动程序API </a>连接<a class="ae kx" href="https://www.adafruit.com/product/938" rel="noopener ugc nofollow" target="_blank"><em class="nd">Adafruit</em></a><em class="nd">128 x64</em>像素显示器时模拟实际硬件。</p><p id="16f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Wokwi用户可以通过使用模拟器来测试他们的代码，并相信它在硬件上使用时能够正常运行，而且它还使与其他人共享代码和项目变得容易。</p><h2 id="ae2d" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">web化:从硬件到UI元素</h2><p id="837a" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">一旦我们在<a class="ae kx" href="https://www.adafruit.com/product/326#technical-details" rel="noopener ugc nofollow" target="_blank">规格</a>中找到元件尺寸，我们将开始设计它。说明组件的最简单方法是使用设计工具，如Inkscape、Sketch、Illustrator等..并导出SVG。</p><p id="a0ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">起初，我使用Sketch免费试用，我喜欢他们的UI，真的很简单，我甚至从一个设计师朋友那里得到了一些建议。后来，我开始使用Affinity Designer，它也很不错。</p><p id="2c9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">比方说，我想从elements png图像中重新创建一个SVG形式的电位计设备。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="ab gu cl ne"><img src="../Images/f2657beec79159511a0c7d9736123d58.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7qeTDo-EY14qa3RPuGJfxg.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">亲和力设计者</figcaption></figure><p id="ed04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一般来说，这样做的步骤是:</p><ol class=""><li id="8383" class="kz la iq jp b jq jr ju jv jy lb kc lc kg ld kk nj lf lg lh bi translated">从左侧菜单中选择矩形形状</li><li id="9969" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk nj lf lg lh bi translated">给它一个50%左右的颜色和不透明度，这样你就可以把它调整到原来的大小——在右边的菜单中，你也可以给角落一个半径。</li><li id="53dc" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk nj lf lg lh bi translated">对组成这个元素的内部形状做同样的操作——内部圆，角落里的4个小圆。</li><li id="2761" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk nj lf lg lh bi translated">添加文字，然后开始涂色，想怎么涂就怎么涂！</li><li id="4284" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk nj lf lg lh bi translated">将元素分组到一个SVG中并提取它</li></ol><p id="b4e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要看看Uri的教程，看看有多简单！</p><p id="a338" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">调整和优化SVG </strong></p><p id="17dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我认为每个经验丰富的前端开发人员在某个时候都会从设计者那里得到“有缺陷的”字体，并且不得不钻研原始的SVG。当你打开一个没有正确解压的SVG文件时，你会发现很多你不需要的东西。一些设计工具可以让你提取一个更干净的版本，但是我的下一步是使用一个叫做<a class="ae kx" href="https://jakearchibald.github.io/svgomg/" rel="noopener ugc nofollow" target="_blank"> SVG-OMG </a>(由Jake Archibald开发)的工具来清理它。</p><p id="1d03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我有了一个更干净的SVG，我就像使用HTML一样使用它，这样就更容易维护，例如，干燥SVG(删除重复的模式)。这是通过将重复出现的属性移动到聚合的<g>中来实现的。同样，如果只有一个文本元素:</g></p><pre class="km kn ko kp gt nk nl nm nn aw no bi"><span id="cc81" class="ln lo iq nl b gy np nq l nr ns">&lt;text&gt;&lt;tspan&gt; foo &lt;/tspan&gt;&lt;/text&gt;</span></pre><p id="9c68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将删除<tspan>，如果有一个过滤器，我可能会想把一些定义移动到CSS等..</tspan></p><p id="628b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">SSD1306是一个SVG元素，但128x64像素显示器实际上是一个<strong class="jp ir">画布</strong>元素。</p><p id="e137" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为什么？SVG非常适合矢量图形，但这是一种像素显示，所以我们需要一些方法来显示像素，因此Canvas是最终的候选。</p><p id="70a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用<code class="fe nt nu nv nl b"><a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/foreignObject" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">foreignObject</strong></a></code> <strong class="jp ir"> </strong>元素将其集成到SVG中，如下所示:(LIT)</p><pre class="km kn ko kp gt nk nl nm nn aw no bi"><span id="32e2" class="ln lo iq nl b gy np nq l nr ns">&lt;foreignObject  <br/>   ?visibility="${visibility}"  <br/>    width="${screenWidth}"  <br/>    height="${screenHeight}"&gt;  <br/>    &lt;canvas <br/>       width="${screenWidth}"                                                    height="${screenHeight}"&gt;<br/>    &lt;/canvas&gt;<br/>&lt;/foreignObject&gt;</span></pre><p id="b2f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">画布元素让我们提供图像绘制体验，因为在幕后我们使用它的2D上下文<a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/putImageData" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> putImageData </strong> </a>方法，每当用户向元素传递一个<a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/ImageData" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> imageData </strong> </a>时，它将被绘制到我们的画布显示中。</p><p id="e1d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nt nu nv nl b"><a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/API/ImageData" rel="noopener ugc nofollow" target="_blank">ImageData</a></code>对象表示画布对象的一个区域的底层像素数据。</p><p id="61f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">imageData对象持有一个<strong class="jp ir">数据</strong>属性，该属性是一个位于<code class="fe nt nu nv nl b">0</code>和<code class="fe nt nu nv nl b">255,</code>之间的8位无符号整数值数组，称为<code class="fe nt nu nv nl b"><a class="ae kx" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray" rel="noopener ugc nofollow" target="_blank">Uint8ClampedArra</a>y.</code></p><p id="0f0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个一维数据数组表示<a class="ae kx" href="https://en.wikipedia.org/wiki/RGBA_color_model" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> RGBA </strong> </a> —构成<a class="ae kx" href="https://en.wikipedia.org/wiki/Pixel" rel="noopener ugc nofollow" target="_blank">像素</a>的红色、绿色、蓝色和Alpha(不透明度)值。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="4993" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">使用LitElement制作Arduino组件</h2><p id="6f03" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">Wokwi元素最终是Web组件——这很棒，因为你可以在任何支持Web组件的框架上使用它们(Angular/Vew/React)。</p><p id="2386" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用原生API编写Web组件需要编写大量代码，这非常冗长，因此很容易忘记。</p><p id="bd82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用<a class="ae kx" href="https://lit-element.polymer-project.org/" rel="noopener ugc nofollow" target="_blank"> LitElement </a>抽象，它非常简单、直观，并且有很好的特性:简单的钩子、样式图和类图指令等等</p><p id="572f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ssd1306元素期望在元素初始化时使用单个imageData属性，为了实现这一点，我们使用了LIT <a class="ae kx" href="https://lit-element.polymer-project.org/guide/lifecycle#firstupdated" rel="noopener ugc nofollow" target="_blank"> firstUpdated </a>钩子。</p><pre class="km kn ko kp gt nk nl nm nn aw no bi"><span id="ed63" class="ln lo iq nl b gy np nq l nr ns">firstUpdated() {  <br/>    this.initContext();  <br/>    this.ctx?.putImageData(this.imageData, 0, 0);<br/>}</span></pre><p id="6daa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该API还公开了一个redraw()方法，以防用户希望更新图像或运行动画。</p><p id="7518" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个使用Typescript应用程序中的<wokwi-ssd1306>元素的示例:</wokwi-ssd1306></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ny nx l"/></div></figure><p id="e800" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看Wokwi SSD1306游乐场:</p><div class="ml mm gp gr mn mo"><a href="https://wokwi.com/playground/ssd1306" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">ssd1306 -使用Wokwi学习Arduino</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">有机发光二极管显示器连接在I C地址0x3D。单击右边的运行代码按钮来查看它的运行情况:您能…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">wokwi.com</p></div></div><div class="mx l"><div class="nz l mz na nb mx nc kv mo"/></div></div></a></div><p id="7ef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">综上所述，我想说的是，基于硬件制作网页元素的端到端体验(UI设计到编码)是惊人的，我真的很喜欢样式部分，以及在保留鼓励创造性思维的实际行为方面的技术挑战。</p><p id="d121" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我要感谢<a class="ae kx" href="https://medium.com/u/355b1dfe86ae" rel="noopener"> Uri Shaked </a>制作Wokwi和评论这篇帖子！</p><p id="7466" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">BR，</p><p id="1f0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">利伦。</p></div></div>    
</body>
</html>
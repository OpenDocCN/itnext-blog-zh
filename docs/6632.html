<html>
<head>
<title>Ambient Modules in TypeScript: What they are and how to work with them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript中的环境模块:它们是什么以及如何使用它们</h1>
<blockquote>原文：<a href="https://itnext.io/ambient-modules-in-typescript-what-they-are-and-how-to-work-with-them-8eed3e95441f?source=collection_archive---------4-----------------------#2022-01-10">https://itnext.io/ambient-modules-in-typescript-what-they-are-and-how-to-work-with-them-8eed3e95441f?source=collection_archive---------4-----------------------#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0bb3ca0064abba08fd2d56604f01c9eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hwycebyW79h2Cs0nthvO-g.png"/></div></div></figure><p id="5220" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这篇文章中，我们将探索TypeScript中的环境模块。我们将介绍什么是环境模块，如何使用它们，以及使用它们时的一些注意事项和技巧。</p><h1 id="f681" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">什么是环境模块？</h1><p id="6cf1" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">环境模块是一个TypeScript特性，它允许导入用JavaScript编写的库，并无缝、安全地使用它们，就像用TypeScript编写一样。</p><p id="a3c9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">环境声明文件是描述模块类型但不包含其实现的文件。环境声明文件不是透明的，所以它们不会被转换成JavaScript。它们纯粹用于类型安全和智能感知。它们遵循<code class="fe mc md me mf b">d.ts</code>文件格式。</p><p id="73fe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">TypeScript生态系统包含数千个这样的环境声明文件，您可以通过<a class="ae mg" href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types" rel="noopener ugc nofollow" target="_blank"> DefinitelyTyped </a>获得这些文件。DefinitelyTyped是一个包含由TypeScript社区提供和维护的声明文件的存储库。</p><p id="cbb6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你曾经在你的项目中使用这样的命令安装过类型:<br/> <code class="fe mc md me mf b">npm install --save-dev @types/node</code></p><p id="dccc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">那你肯定用过Typed。</p><p id="853a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">流行的JavaScript库的大多数类型都存在于明确的类型中。然而，如果您有一个JavaScript库，它的类型是DefinitelyTyped所缺少的，那么您总是可以为它编写自己的环境模块。</p><p id="fd4c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不必为外部库中的每一行代码都定义类型，只需为您正在使用的部分定义即可。</p><h1 id="1ebc" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">如何使用环境模块</h1><p id="9b93" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">在TypeScript中使用声明模块主要有三种方式:<br/> -使用三斜杠指令导入声明。<br/> -配置<code class="fe mc md me mf b">tsconfig</code>文件中的<code class="fe mc md me mf b">typeRoots</code>字段。<br/> -配置<code class="fe mc md me mf b">tsconfig</code>文件中的<code class="fe mc md me mf b">paths</code>字段。</p><p id="bac0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">三斜线指令是一个带有XML标记的单行注释，指示编译器在编译过程中包含附加文件。通常是这样的:<br/> <code class="fe mc md me mf b">/// &lt;reference path="../types/sample-module/index.d.ts" /&gt;</code></p><p id="837a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">注意:单斜线指令必须位于文件的顶部。</strong>如果你把它放在<code class="fe mc md me mf b">import</code>语句下面，它将被视为常规注释。</p><p id="fd4e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mc md me mf b">tsconfig</code>文件中的<a class="ae mg" href="https://www.typescriptlang.org/tsconfig#typeRoots" rel="noopener ugc nofollow" target="_blank"> typeRoots </a>字段用于指定包含声明文件的目录。编译器将在这些目录中搜索要包含在编译过程中的TypeScript声明文件。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/9ceed4a0ff2bf363a9e032e6aa63b5a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rc1oZ_03ZnLYOc0RFp3QxQ.png"/></div></div></figure><p id="f445" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">注意:您指定的目录是相对于</strong> <code class="fe mc md me mf b"><strong class="kd iu">tsconfig</strong></code> <strong class="kd iu">文件的位置。</strong></p><p id="8bb1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mc md me mf b">tsconfig</code>文件中的<a class="ae mg" href="https://www.typescriptlang.org/tsconfig#paths" rel="noopener ugc nofollow" target="_blank">路径</a>字段指定了TypeScript应该根据您提供的regex模式查找TypeScript文件的特定路径。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/943578579e7c33e2d885ea5aa201d9e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1BD6qyxrnrjTn_rmTTpxQ.png"/></div></div></figure><h1 id="e3ae" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">使用环境模块时的提示:</h1><h2 id="d61c" class="mm la it bd lb mn mo dn lf mp mq dp lj km mr ms ln kq mt mu lr ku mv mw lv mx bi translated">使用路径将自定义类型定义添加到项目中。</h2><p id="0720" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果您想为一个有自己类型定义的模块使用您定制的类型定义，您可以通过添加一个调整到<code class="fe mc md me mf b">paths</code>来覆盖编译器选项。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/f323de18dd5c0101148ce6189716d24e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1T5qvOWpVUzp0iHr7tSX1g.png"/></div></div></figure><p id="84f6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，TypeScript将使用来自自定义模块的类型，而不是外部库提供的类型。</p><h2 id="2abd" class="mm la it bd lb mn mo dn lf mp mq dp lj km mr ms ln kq mt mu lr ku mv mw lv mx bi translated">你如何申报你的进口商品很重要</h2><p id="5ce4" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">为第三方库创建TypeScript定义时，将所有导入声明放在模块声明中非常重要。</p><p id="7518" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">否则，您的声明模块将被视为一个<a class="ae mg" href="https://isamatov.com/typescript-module-augmentation/" rel="noopener ugc nofollow" target="_blank">增强</a>，并且您的自定义类型将不会被注册。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/5a0d84028de59122123d14dc5a8342d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*acPWpPcLLzYKxR9DAZ1icw.png"/></div></div></figure><p id="caf7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以上都不行。相反，您需要在模块内部声明您的导入:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/3058c451f3958a239770233be9679fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3vTshLLyoXDXdYSI77Ufw.png"/></div></div></figure><h2 id="d5fa" class="mm la it bd lb mn mo dn lf mp mq dp lj km mr ms ln kq mt mu lr ku mv mw lv mx bi translated">使用简写环境声明快速修复您的类型</h2><p id="bd16" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果你不想花时间创建声明来使用第三方库代码，你可以使用<a class="ae mg" href="https://github.com/Microsoft/TypeScript-Handbook/blob/master/pages/Modules.md#shorthand-ambient-modules" rel="noopener ugc nofollow" target="_blank">速记模块声明</a>来代替。<br/> <code class="fe mc md me mf b">declare module "sample-module";</code></p><p id="858f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当使用简写的环境声明时，从该模块的所有导入都将是类型<code class="fe mc md me mf b">any</code>。</p><h1 id="ebdd" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论</h1><p id="5a77" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">在这篇文章中，我们讨论了什么是环境模块以及如何使用它们。我们还列出了一些使用它们的技巧。希望这篇文章对你有帮助！</p><p id="1dc3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想获得更多的网络开发、反馈和打字技巧，可以考虑在Twitter上关注我，在那里我分享我学到的东西。<br/>快乐编码！</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="f42b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="nf">原载于2022年1月10日https://isamatov.com</em><em class="nf">的</em> <a class="ae mg" href="https://isamatov.com/typescript-ambient-module/" rel="noopener ugc nofollow" target="_blank"> <em class="nf">。</em></a></p></div></div>    
</body>
</html>
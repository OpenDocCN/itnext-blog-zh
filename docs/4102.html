<html>
<head>
<title>Android Dial Phone Programmatically</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android电话拨号程序</h1>
<blockquote>原文：<a href="https://itnext.io/android-dial-phone-programmatically-5ea3714d801d?source=collection_archive---------1-----------------------#2020-04-27">https://itnext.io/android-dial-phone-programmatically-5ea3714d801d?source=collection_archive---------1-----------------------#2020-04-27</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/db2d7be6d49becc04067ea6ec9415cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdGiuE6nZLWz3GNQ-9zz1w.png"/></div></div></figure><p id="1ae3" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi la translated">你想象过你的应用程序可以直接给你打电话吗？是的，Android手机只需几个步骤就可以轻松地为您做到这一点！</p><figure class="lk ll lm ln gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj lj"><img src="../Images/c96e8021dd358f685697016e414aa296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IUsxiZy3gWYrLMs-xZdiPA.png"/></div></div><figcaption class="lo lp gk gi gj lq lr bd b be z dk translated">直接打电话和拨号的思维导图</figcaption></figure><p id="764f" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">Android提供了两种从应用程序拨打电话号码的方式——一种是将用户引导至系统“电话”应用程序的<strong class="ke iv">键盘页面</strong>,另一种是<strong class="ke iv">直接为用户拨打</strong>电话。为了提供更流畅的用户体验，应该考虑后一种方法，但开发人员应该仔细考虑运行时权限(<code class="fe ls lt lu lv b">CALL_PHONE</code>)。</p><p id="4e44" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">在本文中，我将介绍实现这个流程的步骤和细节。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="3b55" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">电话URI标准</h1><figure class="lk ll lm ln gu jv gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/b6dad9acfa7ba2e066d6c0de0acb1b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*owb4CcigAOciCu1ltMpI5g.png"/></div></figure><p id="c4d9" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">在开始编码之前，有一个<a class="ae nc" href="https://tools.ietf.org/html/rfc3966" rel="noopener ugc nofollow" target="_blank"> IETF标准</a>为电话呼叫定义了URI规范。URI的一个电话包含四个部分:</p><ol class=""><li id="c507" class="nd ne iu ke b kf kg kj kk kn nf kr ng kv nh kz ni nj nk nl bi translated"><strong class="ke iv">模式</strong> : <code class="fe ls lt lu lv b">tel:</code>定义这个URI代表一个电话呼叫</li><li id="e892" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated"><strong class="ke iv">保留字符</strong> : "+"定义国家代码的开始</li><li id="c8c8" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated"><strong class="ke iv">国家代码</strong>:长度从1到4个数字，如<code class="fe ls lt lu lv b">852</code>代表香港</li><li id="79b8" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated"><strong class="ke iv">电话号码</strong>:不言自明</li></ol><p id="a336" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">下面是一个电话号码为“1878200”的URI打电话到香港(+852)的例子。整体URI为<code class="fe ls lt lu lv b">tel:+8521878200</code>。</p><figure class="lk ll lm ln gu jv"><div class="bz fq l di"><div class="nr ns l"/></div></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="3539" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">方法1)拨打一个号码(免权限)</h1><figure class="lk ll lm ln gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nt"><img src="../Images/80b177608a216068a610d974b1d9de01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1cKbQnMMlfrgkNqtwNHM6g.png"/></div></div><figcaption class="lo lp gk gi gj lq lr bd b be z dk translated">拨打电话号码的思维导图</figcaption></figure><figure class="lk ll lm ln gu jv"><div class="bz fq l di"><div class="nr ns l"/></div></figure><p id="e2ee" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><strong class="ke iv">第一步:<br/> </strong>我们要通过<code class="fe ls lt lu lv b">Uri.parse()</code>函数将可读的电话字符串解析为<code class="fe ls lt lu lv b">Uri</code>对象。</p><p id="c7bc" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><strong class="ke iv">第二步:</strong> <br/>将<code class="fe ls lt lu lv b">Intent</code>的<code class="fe ls lt lu lv b">Intent Action</code>设置为<code class="fe ls lt lu lv b">Intent.ACTION_DIAL</code>，这样安卓系统可以过滤并把拨号动作委托给任何可以打电话的app。</p><p id="7058" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><strong class="ke iv">步骤3: <br/> </strong>将电话呼叫URI设置到意向数据，以便将电话号码传递到目标电话呼叫app。</p><p id="6a13" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><strong class="ke iv">第四步:<br/> </strong>启动一个可以接受打电话的<code class="fe ls lt lu lv b">Activity</code>。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="24aa" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">方法2)直接打电话</h1><figure class="lk ll lm ln gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nu"><img src="../Images/98052202377b8adc3d958d0ccde833e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f1Uyj_P2mGU8qHBSgBdmcw.png"/></div></div><figcaption class="lo lp gk gi gj lq lr bd b be z dk translated">直接打电话的思维导图</figcaption></figure><figure class="lk ll lm ln gu jv"><div class="bz fq l di"><div class="nr ns l"/></div></figure><p id="dbd2" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">直接拨打电话的步骤类似于拨打电话，只是它需要运行时权限<code class="fe ls lt lu lv b">CALL_PHONE</code>和新的<code class="fe ls lt lu lv b">Intent Action</code> <code class="fe ls lt lu lv b">Intent.ACTION_CALL</code>(参见上面代码的第15行)。</p><p id="7dcb" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><a class="ae nc" href="https://developer.android.com/reference/android/Manifest.permission#CALL_PHONE" rel="noopener ugc nofollow" target="_blank"> CALL_PHONE </a>权限是一个危险的运行时权限，因为它可以直接实例化一个电话呼叫，而无需通过拨号用户界面让用户确认呼叫。</p><p id="dcf8" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">要请求<code class="fe ls lt lu lv b">CALL_PHONE</code>权限，建议使用简单的<code class="fe ls lt lu lv b">RxPermissions</code>库，它在请求权限期间负责<code class="fe ls lt lu lv b">Activity</code>的生命周期。有关设置，请参见第6行至第9行。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="a21b" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">摘要</h1><ol class=""><li id="cb36" class="nd ne iu ke b kf nv kj nw kn nx kr ny kv nz kz ni nj nk nl bi translated">应用程序可以帮助用户直接拨打电话或在系统电话应用程序中拨打电话号码。</li><li id="2c7d" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated">拨打一个电话号码是免权限的，而且很容易使用。然而，它不太用户友好，因为它要求用户按下拨号按钮来打电话。</li><li id="5bb1" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated">直接打电话需要<code class="fe ls lt lu lv b">CALL_PHONE</code>运行时权限，但可以提供更好的用户体验。</li><li id="84b6" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated">电话URI标准由IETF 定义，由4部分组成，即模式、保留加号、国家代码和电话号码。</li></ol></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="9bd4" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">参考</h1><ol class=""><li id="3eef" class="nd ne iu ke b kf nv kj nw kn nx kr ny kv nz kz ni nj nk nl bi translated"><a class="ae nc" href="https://developer.android.com/reference/android/Manifest.permission#CALL_PHONE" rel="noopener ugc nofollow" target="_blank">安卓权限通话_电话</a></li><li id="21e3" class="nd ne iu ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated"><a class="ae nc" href="https://www.ietf.org/rfc/rfc3966.txt" rel="noopener ugc nofollow" target="_blank"> IETF —电话号码的电话URI</a></li></ol></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="fabd" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">欢迎您关注我的<a class="ae nc" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ my rik _ chow</a>了解更多信息。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
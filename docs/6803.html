<html>
<head>
<title>Local Infrastructure for Web Software Development (MacOs, Linux, Windows)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络软件开发的本地基础设施(MacOs、Linux、Windows)</h1>
<blockquote>原文：<a href="https://itnext.io/local-infrastructure-for-web-software-development-macos-linux-windows-14c0a7acd82c?source=collection_archive---------5-----------------------#2022-03-01">https://itnext.io/local-infrastructure-for-web-software-development-macos-linux-windows-14c0a7acd82c?source=collection_archive---------5-----------------------#2022-03-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0ff5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本文的目的是介绍如何为所有项目使用一个独特的设置。Docker是一个强大的工具，我将向您展示我是如何帮助我自己和我的团队在不同的项目之间快速轻松地切换的。</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/b862ad7053824a4043a28551c06bd2ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L9Oho6ZjDvhXCZ9kLe9Zrg.png"/></div></div></figure><p id="9b0e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我已经开始了我在windows上的开发之路。用xampp &amp; notepad++开发php和javascript应用程序。那是8年前的事了，从那以后我逐渐改变了我的环境、框架和编程语言。一个合理的转变是转向Linux (Ubuntu ),在那里我可以更容易地管理Nginx、PHP和整个环境。从那时起，我转而使用Laravel &amp; Vue框架，这是一个完美的组合。与此同时，部署到服务器对我来说更自然，因为数据库、服务器、php、节点和其他一切我都在我的Linux上本地管理，切换php-fpm版本或带有nvm的节点并不困难，一切都很好，很流畅，但我想开始在Flutter框架中开发移动应用程序，这将我带到了我的第一个MacOs开发环境。</p><p id="541f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">与此同时，我成了公司的首席技术官，我必须能够定期从一个项目切换到另一个项目，这很快就成了一场噩梦。使用brew和valet和nvm来切换php，节点版本非常慢(同时我们为flutter和:D提供了一个fvm ),谢天谢地，我公司的CEO和我在<a class="ae lo" href="https://qedcode.io" rel="noopener ugc nofollow" target="_blank"> QED </a>的同事听到了我的问题，在他们的支持下，我能够为这个问题建立一个解决方案。</p><p id="a55e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在我开始之前，让我先说几个月前，我和码头工人一起工作时翻了翻白眼。所以是的，这是一个docker设置，但不要停止阅读！</p><h1 id="560d" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">这个想法</h1><p id="916f" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">设置背后的想法是能够在许多项目之间切换(目前的堆栈是Laravel — php，Vue.js &amp; Nuxt — node ),并且如果需要更快的开发，能够更快地加入新成员或重新排序成员。我必须概述5个以上的项目，一个使用composer 1，一些使用composer 2，他们在php版本从7.4到8.1和从节点12到16..时间就是金钱(花时间换东西很让人沮丧)。</p><p id="f577" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Laravel有laradock和sail，但我们希望为每个人创建一个封闭的docker环境，以便用最少的资源在几分钟内完成所有项目，这意味着不要一直停止和运行项目，不要有冲突的端口等。经验不足的开发人员在使用这些设置时会感到困惑，真的不知道后面会发生什么。</p><h1 id="97e7" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">设置</h1><p id="83b9" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">-每个项目都只排除了哪些需求(php，nginx，node)</p><p id="cc35" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-版本使用的数据库</p><p id="c89f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-节点服务器仅在需要时运行</p><p id="1477" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-每个都使用不同的端口，因此它们可以同时启动</p><p id="6bc5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">工作原理:</p><p id="6ad2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-包含基础设施项目的别名，让您的生活更轻松</p><p id="33d8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-创建命令，轻松地将项目从git存储库拉到正确的位置</p><p id="d438" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-本地的。env文件应该从基础设施中自动添加(因此，当它们在项目中更新时，也应该在这里更新)</p><p id="cf74" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-在运行create命令时添加数据库创建命令，同时创建dumps文件夹，如果dumps文件夹中存在项目的数据库转储，则将导入它</p><p id="7aab" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-所有命令都应该在init上执行(在长时间不活动后也应该工作以自动刷新)</p><p id="fbe6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">-通过导入别名，我们使用的所有命令，php，artisan，composer，npm都被重新路由到正确的docker容器，该容器将执行它</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="191a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">上面你可以看到代码结构，这是我个人选择的变体，但是你可以随意改变。</p><h1 id="33e7" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">用法</h1><p id="da0a" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">一旦我们克隆了基础设施的源代码，我们就可以开始初始化项目了。根目录start_setup.sh中的简单脚本将为数据库、应用程序和监控应用程序创建dockers。monitor app(这是基础设施源代码中包含的唯一项目)的目的是在一个地方拥有关于项目的设置、wiki、信息和链接。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mo"><img src="../Images/d6fe77621d9683cca99ec53ee6af69fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RmRjLsyFWHzr_wcO"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">监视器应用程序的屏幕截图</figcaption></figure><p id="8f55" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在这一步之后，它变得更加简单，init.sh脚本具有创建和运行这个设置中的每个项目的函数。假设您想要设置project_1_app_1，您可以使用init.sh project_1_app_1，然后等待(如果您的互联网连接很慢，请给自己冲杯咖啡:)</p><h2 id="fbe5" class="mt lq iq bd lr mu mv dn lv mw mx dp lz lb my mz mb lf na nb md lj nc nd mf ne bi translated">初始化设置说明</h2><p id="dc6b" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">init上发生了什么(现在我们只为Nuxt项目添加一个代码片段，这样您就明白了，但是我们稍后将在gitlab上添加一个示例(我们将在这里链接它):</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="d35d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因此，这只是背后逻辑的一个例子，而不是整个基础设施，但你得到了要点。</p><p id="0c33" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如前所述，运行init.sh monitor，应该可以让您的项目监视器在选定的端口(生成的版本)上启动和运行，瞧！</p><h2 id="e57e" class="mt lq iq bd lr mu mv dn lv mw mx dp lz lb my mz mb lf na nb md lj nc nd mf ne bi translated">监视器应用程序的docker编写示例</h2><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="60a8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">每个基于所需服务使用的应用程序容器都通过docker网络连接。像laravel的postgres，mailhog的emails，redis等..</p><h2 id="a3ee" class="mt lq iq bd lr mu mv dn lv mw mx dp lz lb my mz mb lf na nb md lj nc nd mf ne bi translated">最佳化</h2><p id="bd27" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">你可能会说这与laradock或sail没有太大区别，但它确实是经过优化的！只有你需要的容器才会被创建和运行，如果你可以有一个容器并且为每个项目创建数据库，为什么要有3个有冲突端口的postgres容器呢？</p><p id="91e6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果你只是需要概述项目，为什么你要费心设置项目，这样它就都启动并运行了，只需启动它，等待，然后在monitor应用程序上找到链接。不要担心node，php，databases的版本，哦，对了，我没有提到，在dumps文件夹中，你可以放入由project命名的数据库转储，在创建项目和数据库时，它会被自动导入。</p><p id="8c03" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">此外，节点容器仅在需要时启动，当您运行npm命令时，它会克隆容器，完成命令，然后删除自身。除非您在服务器/热重装模式下启动它。</p><h2 id="8766" class="mt lq iq bd lr mu mv dn lv mw mx dp lz lb my mz mb lf na nb md lj nc nd mf ne bi translated">奖金</h2><p id="fcb0" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">进入docker容器，或者在运行php artisan migrate或npm install之类的命令时调用容器执行是令人恼火的..非常..我做了一个愚蠢的小黑客，这让我的生活更容易。</p><p id="c590" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在第一个安装脚本中，我这样做</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="43fe" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">只需注入一个自定义别名文件，其中包含类似于init脚本中的函数，我们就可以识别命令，如果它在项目所在的某个文件夹中，它会在docker执行时重定向命令。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="6c08" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">也许有点粗糙，但绝对简单。每个项目中的命令都是原创的，composer这个，php artisan那个，npm做的东西。</p><h1 id="4f1b" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">实施至今</h1><p id="672c" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">应用程序</p><ul class=""><li id="e60b" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated">Cloudbeaver(有史以来最好的东西)</li><li id="93cb" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">便携式集装箱</li><li id="85d8" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">邮件猪</li><li id="94fb" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">特拉菲克</li></ul><p id="0ed2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">数据库</p><ul class=""><li id="6ada" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated">mysql(多个版本)</li><li id="0901" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">postgres</li><li id="4652" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">mongodb</li><li id="bf4b" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">雷迪斯</li><li id="eb7f" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">dynamodb</li></ul><p id="28a5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">框架和应用</p><ul class=""><li id="a51d" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated">Laravel + Vue</li><li id="b3dd" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">Vue spa</li><li id="2190" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">Nuxt Spa</li></ul><p id="4fda" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">临时演员</p><ul class=""><li id="fd8d" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated">laravel回声服务器</li><li id="365b" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">码头工人中的ngrok</li></ul><h1 id="3dae" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">算是结论吧</h1><p id="94c7" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">这篇文章或多或少是概念性的，解释了想法和结构，但如果你喜欢这个想法，我们会提供一些github要点链接，介绍一些laravel应用程序的实际设置，数据库设置(mongo，postgre，mysql，redis)，包括在mac os上运行docker sync的脚本等..</p><p id="2b90" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">对我来说，这改变了我的一生。我从事或正在从事的每个项目都一直在运行。我将在几分钟内让它变得生动和最新。我不需要停止任何其他容器来做到这一点。</p><p id="5316" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我需要这个，我们的CEO也需要这个(因为他也是一名开发人员)，这是毫无疑问的。但是为所有团队成员节省的时间，以及在随机项目中快速切换到次要任务的可能性是无价的。</p><p id="676a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们甚至没有完善这些设置，现在我们必须为本地环境设置aws lambdas设置，所以这将是一个不断增长的项目哈哈。我希望将来我会有更多的时间来推广qed本地基础设施，这样我们就可以与社区共享它。</p><p id="d121" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">它帮了我们很大的忙，通过更精确的设置，它可以处理更大的项目堆栈。如果你对这个设置感兴趣，或者有如何改进它的想法，请联系在<a class="ae lo" href="mailto:info@qedcode.net" rel="noopener ugc nofollow" target="_blank">info@qedcode.net</a>举办的某种研讨会，也可以关注我们的<a class="ae lo" href="https://qedcode.io/company/blog" rel="noopener ugc nofollow" target="_blank">博客</a>，了解关于这个主题和许多其他主题的未来更新(AWS即将推出)。</p><h1 id="412d" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">额外小费</h1><p id="67c9" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">为了绕过每个开发人员需要为每个新项目更新主机，我们得到了一个额外的域，通过dns指向每个本地主机端口。所以直接点播放右:)</p></div></div>    
</body>
</html>
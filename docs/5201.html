<html>
<head>
<title>Let’s Build a Real-Time Bitcoin Price Notification Project using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们使用Python构建一个实时比特币价格通知项目</h1>
<blockquote>原文：<a href="https://itnext.io/lets-build-a-real-time-bitcoin-price-notification-project-using-python-daaa7391f71b?source=collection_archive---------0-----------------------#2021-01-11">https://itnext.io/lets-build-a-real-time-bitcoin-price-notification-project-using-python-daaa7391f71b?source=collection_archive---------0-----------------------#2021-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c82315c28618ee3a6b4e96d5673b032a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1NBPnxK5Q2dyNfg6QpCBw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@wildbook?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">德米特里·德米德科</a>在<a class="ae kc" href="https://unsplash.com/s/photos/bitcoin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="1ab9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大家好，我知道我已经有一段时间没发东西了…但事实是我又带着另一个令人兴奋的python项目回来了！</p><p id="b214" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章最初发表在我的博客上，你可以在这里找到——<a class="ae kc" href="https://thecodingpie.com/post/lets-build-a-real-time-bitcoin-price-notification-python-project/" rel="noopener ugc nofollow" target="_blank">https://thecodingpie.com/</a></p><p id="32a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以从我的GitHub repo获得这个项目的完整代码—<a class="ae kc" href="https://github.com/the-coding-pie/bitcoin_price_tracker" rel="noopener ugc nofollow" target="_blank">https://github.com/the-coding-pie/bitcoin_price_tracker</a></p><p id="cb5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如今，加密货币是热门话题，最重要的是“比特币”。但问题是比特币的价格波动很大，你永远不会真正知道它最终会在哪里。很难跟踪不断变化的BTC价格，不是吗？</p><p id="dcab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，与其不断地在各种网站上查询最新价格，我们为什么不让Python来为我们做这项工作呢？！</p><p id="b413" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个项目中，我们将构建一个python脚本来跟踪最新的比特币价格。它会每30分钟给你发一条电报信息(你可以调整)，告诉你最新的6个比特币价格(你也可以调整)。您可以设置一个最小的<code class="fe lb lc ld le b">threshold</code>值，这样如果BTC价格低于该阈值，那么脚本将立即发送一条显示价格的警告消息。</p><p id="c2ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">听起来很酷，对吧？</p><h1 id="af10" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">要求</h1><p id="93d5" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">要制作这个脚本，您需要以下东西:</p><ul class=""><li id="6889" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">一个<a class="ae kc" href="https://pro.coinmarketcap.com/" rel="noopener ugc nofollow" target="_blank">coinmarketcap.com</a>API密钥。因为我们要利用他们的API来获取最新的比特币价格。</li><li id="ef9a" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">telegram应用程序，以及您的帐户的<code class="fe lb lc ld le b">chat_id</code>。</li><li id="b887" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">然后是一个<a class="ae kc" href="https://core.telegram.org/bots" rel="noopener ugc nofollow" target="_blank">电报机器人</a>和它的<code class="fe lb lc ld le b">token</code>钥匙。没有bot，您将无法发送编程消息。简而言之，<strong class="kf ir">如果你想从我们的python脚本向你的电报账户发送价格通知，那么你需要一个电报机器人。</strong></li><li id="d216" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">最后是Python3，以及您选择的文本编辑器。</li></ul><p id="6433" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我知道你们中的大多数人可能没有前三样东西，这就是为什么我把这个教程分成三个部分来简化生活:</p><ol class=""><li id="b5c2" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mw mo mp mq bi translated">获取Coinmarketcap API密钥</li><li id="1ee7" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mw mo mp mq bi translated">电报机器人和你的聊天ID</li><li id="fc8a" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mw mo mp mq bi translated">将所有东西组装在一起</li></ol><p id="39dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事不宜迟，我们开始吧。</p><h1 id="65b9" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">1).获取Coinmarketcap API密钥</h1><p id="b528" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">Coinmarketcap.com不再为匿名用户提供加密货币数据。所以我们需要一个<code class="fe lb lc ld le b">API key</code>来使用他们的服务。如果你在他们的网站上没有账户，那么先注册<a class="ae kc" href="https://coinmarketcap.com/api/" rel="noopener ugc nofollow" target="_blank">或登录</a>。</p><p id="232e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当您这样做时，您将被带到您的帐户控制面板，看起来像这样:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/b6919efc8dab8719c4d91fa1eef0eda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNq0hpJuXMZ8sp9JPzCALA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我的仪表板</figcaption></figure><p id="f527" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如你所见，在使用他们的API和他们的<strong class="kf ir">基本计划</strong>时有一个限制。但是一天的请求对我们来说太多了！如果你想使用他们的付费计划，请随意。</p><p id="81a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">记住，我们创建这个帐户是为了获得Coinmarketcap <code class="fe lb lc ld le b">API Key</code>。现在，您可以通过单击那个<strong class="kf ir">复制密钥</strong>按钮来获得它，当您将鼠标悬停在那个<strong class="kf ir"> API密钥</strong>框上时，该按钮会弹出。</p><p id="b753" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太棒了，现在我们有了自己的货币市场基金<code class="fe lb lc ld le b">API Key</code>。把这一页做成书签，因为我们以后会用到它。</p><h1 id="1f1e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">2).电报机器人和你的聊天ID</h1><p id="18bb" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">在继续此步骤之前，请确保您的手机/电脑上安装了Telegram应用程序，并且您已经创建了一个帐户。</p><p id="0812" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在谈谈逻辑。我们都知道，要发送一条<strong class="kf ir">消息</strong>，应该有两个实体，<strong class="kf ir">发送方</strong>和<strong class="kf ir">接收方</strong>。这里的<strong class="kf ir">发送者</strong>是我们将要创建的机器人，而<strong class="kf ir">接收者</strong>是<strong class="kf ir">你</strong>或者，确切地说，是你的<code class="fe lb lc ld le b">chat_id</code>。</p><p id="4e31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看，这就是为什么你需要自己的电报<code class="fe lb lc ld le b">bot</code>和T5。</p><p id="7c2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事实上，电报机器人太棒了。你可以从他们的官方文件中了解更多关于电报机器人有多棒的信息。</p><h1 id="b997" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">但是我如何创建一个机器人呢？</h1><p id="f5bd" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">只需与<a class="ae kc" href="https://core.telegram.org/bots#3-how-do-i-create-a-bot" rel="noopener ugc nofollow" target="_blank">机器人父亲</a>交谈，并遵循几个简单的步骤！</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/036d46dab024c322b66b7633218d2866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tHgMfmsFG6te_0jkVkAprg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">机器人父亲机器人</figcaption></figure><p id="952d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">机器人父亲是统治他们所有人的机器人。你可以用它来创建新的机器人帐户和管理你现有的机器人。</p><p id="07e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们制作自己的机器人:</p><ul class=""><li id="9a10" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">首先在电报app中搜索<strong class="kf ir"> BotFather </strong>。你会看到机器人父亲旁边有一个蓝色的验证勾。</li><li id="b6b9" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">点击这个机器人，输入消息/命令<code class="fe lb lc ld le b"><strong class="kf ir">/newbot</strong></code>并发送出去。<code class="fe lb lc ld le b"><strong class="kf ir">/newbot</strong></code>命令用于创建新的机器人。每当你向一个机器人输入命令时，你都应该在命令前使用<strong class="kf ir">正斜杠</strong> ( <strong class="kf ir"> / </strong>)。</li><li id="0475" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">现在机器人爸爸会要求你提供一个<strong class="kf ir">名字</strong>和一个<strong class="kf ir">用户名</strong>，请提供。</li><li id="36c7" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">然后，它会向您发送一条祝贺消息，其中包含指向您的机器人的链接和您的机器人的授权令牌。</li><li id="517b" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">现在让我们<strong class="kf ir">激活你的机器人</strong>。为此，点击<strong class="kf ir">机器人父亲</strong>给你的机器人的<strong class="kf ir">链接:</strong></li></ul><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/06b64ad5d4466776dd5f2712179c2f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*VdumqPpFKaAK5mIV7wd10w.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我的机器人的链接。你的看起来会像那样，但是有你的机器人的名字</figcaption></figure><ul class=""><li id="1b29" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">点击那个链接，发送一个<code class="fe lb lc ld le b"><strong class="kf ir">/start</strong></code>命令来激活它。</li></ul><p id="a769" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样，您已经创建了自己的bot并成功激活了它！</p><p id="37d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您为您的机器人获得的<strong class="kf ir">令牌</strong>是一个类似于<code class="fe lb lc ld le b">110201543:AAHdqTcvCH1vGWJxfSeofSAs0K5PALDsaw</code>的字符串。需要这个<strong class="kf ir">令牌</strong>来授权机器人并向<a class="ae kc" href="https://core.telegram.org/bots/api" rel="noopener ugc nofollow" target="_blank">机器人API </a>发送请求。保持你的令牌安全，并安全地存储它，它可以被任何人用来控制你的机器人😱。</p><p id="13ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">厉害！现在你有了你的机器人，重要的是它的<strong class="kf ir">令牌</strong>密钥。留着以后用。</p><h1 id="5dd3" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">获取您的聊天id</h1><p id="8733" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">下一步是获得你的电报<code class="fe lb lc ld le b">chat_id</code>。你可以通过一个名为'<strong class="kf ir"> IDBot </strong>'的现成机器人轻松实现:</p><ul class=""><li id="8de7" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">在电报应用中搜索“<strong class="kf ir"> IDBot </strong>”。它的图标如下所示:</li></ul><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/4f49f658003989ebb1540976494704b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*txGzJV-E9MJpHoXwq6HU3g.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">IDBot的图标</figcaption></figure><ul class=""><li id="1632" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">现在点击这个机器人，输入一条和这个<code class="fe lb lc ld le b"><strong class="kf ir">/getid</strong></code>一模一样的消息。这个<code class="fe lb lc ld le b"><strong class="kf ir">/getid</strong></code> <strong class="kf ir"> </strong>命令会得到你的<code class="fe lb lc ld le b">chat_id</code>。</li></ul><p id="a977" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">又牛逼了！现在你有了你的<code class="fe lb lc ld le b">chat_id</code>，把它保存在某个地方，因为我们以后会需要它。</p><h1 id="1acf" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">3).将所有东西组装在一起</h1><p id="dde0" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">确保你已经安装了<strong class="kf ir"> Python3.4+ </strong>和<strong class="kf ir"> pip3 </strong>。</p><h1 id="a888" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">初始设置</h1><p id="4b67" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">在开始之前，我们需要建立一个文件夹，虚拟环境，和所有的东西。为什么？因为这是一个很好的练习！</p><ul class=""><li id="b077" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">首先，在你电脑的任何地方创建一个名为<strong class="kf ir"> bitcoin_tracker </strong>的文件夹。</li><li id="98a4" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">然后<strong class="kf ir">在visual studio代码里面打开</strong>(我用的是vs代码作为我的文本编辑器)。</li><li id="7578" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">现在让我们<strong class="kf ir">使用<strong class="kf ir"> venv </strong>创建</strong>一个新的虚拟环境，然后<strong class="kf ir">激活</strong>它。为此:</li><li id="3775" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">在你的文本编辑器中，打开<strong class="kf ir">终端&gt;新终端</strong>或者你可以使用<strong class="kf ir">命令行</strong>(如果你在windows上)或者<strong class="kf ir"> bash/zsh </strong>终端(在Linux/Mac上)。</li><li id="8fdc" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">然后确保你在<strong class="kf ir">比特币追踪器</strong>目录中，或者请<strong class="kf ir"> cd </strong>进入该目录，并从那里在<strong class="kf ir">终端</strong>中键入以下命令:</li></ul><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="5a7c" class="nj lg iq le b gy nk nl l nm nn">python3 -m venv venv</span></pre><p id="06d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个命令将为我们创建一个名为<strong class="kf ir"> venv </strong>的虚拟环境。</p><ul class=""><li id="b1ce" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">要激活它，如果您在<strong class="kf ir">窗口</strong>上，请键入以下内容:</li></ul><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="8a9e" class="nj lg iq le b gy nk nl l nm nn">venv\Scripts\activate.bat</span></pre><ul class=""><li id="7921" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">如果您使用的是Linux/Mac系统，请键入以下内容:</li></ul><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="d2f5" class="nj lg iq le b gy nk nl l nm nn">source venv/bin/activate</span></pre><p id="1c23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您应该会看到类似这样的内容:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/457f11a3deffdada0889c2a4ad3a706f.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*kRtgvVVQOoFfWI9NF7azRw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">这个前缀意味着您已经成功激活了虚拟环境</figcaption></figure><ul class=""><li id="edda" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">最后，直接在<strong class="kf ir"> bitcoin_tracker </strong>文件夹中创建一个名为“<strong class="kf ir"> tracker.py </strong>的新文件。</li></ul><p id="b7b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您应该有一个类似如下的文件结构:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ead4460ed1c2f16db0251bf3370a8b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*vUwsjCYP6g_fj3Qb3CJouw.png"/></div></figure><p id="cdee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">注意</strong>:如果你仍然对如何建立一个虚拟环境感到困惑，那么请阅读这篇<a class="ae kc" href="https://thecodingpie.com/post/a-quick-guide-on-how-to-setup-a-python-virtual-environment-windows-linux-mac/" rel="noopener ugc nofollow" target="_blank">快速指南</a>。</p><p id="3457" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须从这个脚本发出一些HTTP请求，所以我们需要一个名为<strong class="kf ir"> requests </strong>的python模块，我们来安装它。</p><p id="4821" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<strong class="kf ir">终端</strong>中键入以下命令，以<strong class="kf ir">安装</strong>请求模块:</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="429d" class="nj lg iq le b gy nk nl l nm nn">pip install requests</span></pre><p id="88b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样，现在是写实际脚本的时候了！</p><h1 id="c16a" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">让我们开始吧…</h1><p id="b9e8" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">打开<strong class="kf ir"> tracker.py </strong>文件并键入:</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="5a18" class="nj lg iq le b gy nk nl l nm nn">import requests<br/>import time</span><span id="11c6" class="nj lg iq le b gy nq nl l nm nn"># global variables<br/>api_key = 'your_coinmarketcap_api_key'<br/>bot_token = 'your_telegram_bot_token'<br/>chat_id = 'your_telegram_account_chat_id_here'<br/>threshold = 30000<br/>time_interval = 5 * 60 # in seconds</span></pre><ul class=""><li id="2cb5" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">在这里，在最顶端，我们正在导入所需的模块。我们需要<code class="fe lb lc ld le b">requests</code>模块向Coinmarketcap API和telegram端点发出HTTP请求。</li><li id="911d" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">我们需要<code class="fe lb lc ld le b">time</code>模块来延迟我们的代码(使用<code class="fe lb lc ld le b">sleep()</code>函数)。</li><li id="9736" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">然后我们设置一些全局变量:</li><li id="497d" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe lb lc ld le b">api_key</code>= ' put _ your _ coin market cap _ API _ key _ here _ which _ we _ first _ obtain '</li><li id="8f9f" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe lb lc ld le b">bot_token</code>= ' put _ your _ own _ telegram _ bot _ token '</li><li id="386d" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe lb lc ld le b">chat_id</code> = 'put_your_telegram_chat_id '</li><li id="9268" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe lb lc ld le b">threshold</code> =放比特币价格的最低门槛</li><li id="795e" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe lb lc ld le b">time_interval</code> =秒。这里我用了5分钟。这意味着，我的脚本将每5分钟发出一个API请求，并将价格存储在一个python列表中。请记住，你每天只能提出333个免费请求。</li></ul><p id="d14f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们制作两个函数:</p><ul class=""><li id="71f8" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">一个名为<code class="fe lb lc ld le b">get_btc_price()</code>的将获取最新的加密货币价格，从中提取比特币价格，然后<code class="fe lb lc ld le b">return</code>它。</li><li id="451c" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">另一个名为<code class="fe lb lc ld le b">send_message(chat_id, msg)</code>，接受我们要发送的<code class="fe lb lc ld le b">chat_id</code>和<code class="fe lb lc ld le b">msg</code>。该功能将利用电报HTTPS端点向我们的电报账户发送消息。</li></ul><p id="7366" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">键入以下内容:</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="3aff" class="nj lg iq le b gy nk nl l nm nn">def get_btc_price():<br/>    url = '<a class="ae kc" href="https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'" rel="noopener ugc nofollow" target="_blank">https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'</a><br/>    headers = {<br/>        'Accepts': 'application/json',<br/>        'X-CMC_PRO_API_KEY': api_key<br/>    }<br/>    <br/>    # make a request to the coinmarketcap api<br/>    response = requests.get(url, headers=headers)<br/>    response_json = response.json()</span><span id="d62d" class="nj lg iq le b gy nq nl l nm nn"># extract the bitcoin price from the json data<br/>    btc_price = response_json['data'][0]<br/>    return btc_price['quote']['USD']['price']</span></pre><ul class=""><li id="e214" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">参见，<code class="fe lb lc ld le b">‘https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'</code>是获取最新加密货币价格的API端点。</li><li id="b8ce" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">记住你必须发送你的<code class="fe lb lc ld le b">api_key</code>。您可以通过以下两种方式之一提供:</li></ul><ol class=""><li id="1721" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mw mo mp mq bi translated">首选方法:通过名为<code class="fe lb lc ld le b">X-CMC_PRO_API_KEY</code>的自定义标题。我们使用这种方法是因为这是首选方法。</li><li id="1222" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mw mo mp mq bi translated">方便的方法:通过一个名为<code class="fe lb lc ld le b">CMC_PRO_API_KEY</code>的查询字符串参数</li></ol><ul class=""><li id="0c1d" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">在接下来的几行中，我们发出GET请求并将数据转换成<code class="fe lb lc ld le b">json()</code>格式。</li><li id="2c89" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">我们目前掌握的数据包含了大量信息。但是我们只需要比特币的价格。这就是我们在最后两行所做的。</li></ul><p id="fd52" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">API返回的数据在结构上可能会不时变化。如果上面的代码没有得到比特币价格，那么通过打印变量<code class="fe lb lc ld le b">response_json</code>中的值并据此更改最后两行，尝试找到比特币价格在哪里。</p><p id="edb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在如果我们调用上面的函数，它会<code class="fe lb lc ld le b">return</code>最新的比特币价格！</p><p id="67b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太棒了，现在让我们构建<code class="fe lb lc ld le b">send_message()</code>函数:</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="ae84" class="nj lg iq le b gy nk nl l nm nn"># fn to send_message through telegram<br/>def send_message(chat_id, msg):<br/>    url = f"<a class="ae kc" href="https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&amp;text={msg" rel="noopener ugc nofollow" target="_blank">https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&amp;text={msg</a>}"</span><span id="d9fb" class="nj lg iq le b gy nq nl l nm nn"># send the msg<br/>    requests.get(url)</span></pre><ul class=""><li id="c424" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">看，你在上面看到的<code class="fe lb lc ld le b">url</code>是我们必须用来从我们的机器人向我们的电报帐户发送电报消息的端点。这里我使用了<a class="ae kc" href="https://realpython.com/python-f-strings/" rel="noopener ugc nofollow" target="_blank"> f字符串</a>，这样我就可以把我想发送的<code class="fe lb lc ld le b">bot_token</code>、<code class="fe lb lc ld le b">chat_id</code>和<code class="fe lb lc ld le b">msg</code>连接成一个字符串。</li><li id="1305" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">然后我们向<code class="fe lb lc ld le b">url</code>发出GET请求，如果我们这样做了，你将在你的应用程序中收到一条来自你的机器人的消息。</li></ul><p id="958f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一个难题是按照我们希望的方式使用上面的函数。因此，让我们创建一个<code class="fe lb lc ld le b">main()</code>函数，它将调用上述两个函数:</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="06a6" class="nj lg iq le b gy nk nl l nm nn"># main fn<br/>def main():<br/>    price_list = []</span><span id="82f3" class="nj lg iq le b gy nq nl l nm nn"># infinite loop<br/>    while True:<br/>        price = get_btc_price()<br/>        price_list.append(price)</span><span id="f046" class="nj lg iq le b gy nq nl l nm nn"># if the price falls below threshold, send an immediate msg<br/>        if price &lt; threshold:<br/>            send_message(chat_id=chat_id, msg=f'BTC Price Drop Alert: {price}')</span><span id="0649" class="nj lg iq le b gy nq nl l nm nn"># send last 6 btc price<br/>        if len(price_list) &gt;= 6:<br/>            send_message(chat_id=chat_id, msg=price_list)<br/>            # empty the price_list<br/>            price_list = []</span><span id="8adb" class="nj lg iq le b gy nq nl l nm nn"># fetch the price for every dash minutes<br/>        time.sleep(time_interval)</span><span id="1212" class="nj lg iq le b gy nq nl l nm nn"># fancy way to activate the main() function<br/>if __name__ == '__main__':<br/>    main()</span></pre><ul class=""><li id="e683" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated">我们正在运行一个无限循环，它将在5分钟<code class="fe lb lc ld le b">time_interval</code>运行。</li><li id="95c6" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">对于每个<code class="fe lb lc ld le b">time_interval</code>，我们将调用<code class="fe lb lc ld le b">get_btc_price()</code>函数并将结果存储在<code class="fe lb lc ld le b">price_list</code>变量中。一旦它的长度变成<code class="fe lb lc ld le b">&gt;= 6</code>，我们用最后6个比特币价格调用<code class="fe lb lc ld le b">send_message()</code>函数，然后清空<code class="fe lb lc ld le b">price_list</code>。</li><li id="6f77" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated">如果BTC价格突然跌破<code class="fe lb lc ld le b">threshold</code>值，那么我们会立即发送一条消息，告知最新的比特币价格。</li></ul><p id="d4e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样，我们完成了我们的python脚本！如果你不理解最后2句“花里胡哨”的台词，那么对你来说这是一个小练习。谷歌那一行，并找出我在那里试图做什么！</p><h1 id="ae5f" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">让我们运行它…</h1><p id="c2c5" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">现在让我们运行我们的脚本。在<strong class="kf ir">终端</strong>中，输入:</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="e7df" class="nj lg iq le b gy nk nl l nm nn">python tracker.py</span></pre><p id="7183" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一切正常，那么你每30分钟就会收到一条信息！</p><p id="7dda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尝试调整<code class="fe lb lc ld le b">time_limit</code>和<code class="fe lb lc ld le b">threshold</code>值以获得即时消息。但是要时刻记住免费API的限制！您可以在任何服务器上在线部署它，并获得实时通知。</p><h1 id="51be" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">完全码</h1><p id="f8de" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">这是完整的代码。如果事情没有按预期的那样运行，用这个来交叉检查你的代码。</p><pre class="my mz na nb gt nf le ng nh aw ni bi"><span id="9c01" class="nj lg iq le b gy nk nl l nm nn">import requests<br/>import time</span><span id="8e59" class="nj lg iq le b gy nq nl l nm nn"># global variables<br/>api_key = 'your_coinmarketcap_api_key'<br/>bot_token = 'your_telegram_bot_token'<br/>chat_id = 'your_telegram_account_chat_id_here'<br/>threshold = 30000<br/>time_interval = 5 * 60 # in seconds</span><span id="3feb" class="nj lg iq le b gy nq nl l nm nn">def get_btc_price():<br/>    url = '<a class="ae kc" href="https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'" rel="noopener ugc nofollow" target="_blank">https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'</a><br/>    headers = {<br/>        'Accepts': 'application/json',<br/>        'X-CMC_PRO_API_KEY': api_key<br/>    }<br/>    <br/>    # make a request to the coinmarketcap api<br/>    response = requests.get(url, headers=headers)<br/>    response_json = response.json()</span><span id="219b" class="nj lg iq le b gy nq nl l nm nn"># extract the bitcoin price from the json data<br/>    btc_price = response_json['data'][0]<br/>    return btc_price['quote']['USD']['price']</span><span id="4fef" class="nj lg iq le b gy nq nl l nm nn"># fn to send_message through telegram<br/>def send_message(chat_id, msg):<br/>    url = f"<a class="ae kc" href="https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&amp;text={msg" rel="noopener ugc nofollow" target="_blank">https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&amp;text={msg</a>}"</span><span id="a703" class="nj lg iq le b gy nq nl l nm nn"># send the msg<br/>    requests.get(url)</span><span id="8615" class="nj lg iq le b gy nq nl l nm nn"># main fn<br/>def main():<br/>    price_list = []</span><span id="64c7" class="nj lg iq le b gy nq nl l nm nn"># infinite loop<br/>    while True:<br/>        price = get_btc_price()<br/>        price_list.append(price)</span><span id="2adc" class="nj lg iq le b gy nq nl l nm nn"># if the price falls below threshold, send an immediate msg<br/>        if price &lt; threshold:<br/>            send_message(chat_id=chat_id, msg=f'BTC Price Drop Alert: {price}')</span><span id="6e54" class="nj lg iq le b gy nq nl l nm nn"># send last 6 btc price<br/>        if len(price_list) &gt;= 6:<br/>            send_message(chat_id=chat_id, msg=price_list)<br/>            # empty the price_list<br/>            price_list = []</span><span id="942f" class="nj lg iq le b gy nq nl l nm nn"># fetch the price for every dash minutes<br/>        time.sleep(time_interval)</span><span id="e2aa" class="nj lg iq le b gy nq nl l nm nn"># fancy way to activate the main() function<br/>if __name__ == '__main__':<br/>    main()</span></pre><h1 id="c636" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">包扎</h1><p id="c4ce" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我希望你喜欢这个教程。如果你有任何疑问，请在下面评论。谢谢你，🥰.</p></div></div>    
</body>
</html>
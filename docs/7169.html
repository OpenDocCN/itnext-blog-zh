<html>
<head>
<title>Git Split Commit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Git拆分提交</h1>
<blockquote>原文：<a href="https://itnext.io/git-split-commit-b42a609a6bf3?source=collection_archive---------4-----------------------#2022-07-04">https://itnext.io/git-split-commit-b42a609a6bf3?source=collection_archive---------4-----------------------#2022-07-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="06d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在Git中拆分提交</h2></div><p id="bb82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有时我会想“这个承诺太大了，我需要把它分解成更小的”。可能的情况是，我在一次提交中做了两件事，我希望每件事都有一次提交。在这些时候，我想知道是否有可能做到这一点。你越早想做，就越容易。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/62366d3c101d44f3807c9b83271bcf68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZ22QbsIFcj8IAvP96nVow.png"/></div></div></figure><h1 id="0559" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">拆分最后一次提交</h1><p id="2237" class="pw-post-body-paragraph ki kj it kk b kl mi ju kn ko mj jx kq kr mk kt ku kv ml kx ky kz mm lb lc ld im bi translated">与往常一样，更改最后一次提交更容易。要拆分最后一次提交，需要“撤销”提交，部分准备更改，并创建多个提交。</p><p id="96e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先撤销提交:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="5e43" class="ms lr it mo b gy mt mu l mv mw">git reset HEAD^</span></pre><p id="ff42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该命令撤消最后一次提交，并保持更改不变。然后，您可以部分暂存更改并提交它们，例如:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="bcdc" class="ms lr it mo b gy mt mu l mv mw">git add README.md<br/>git commit -m "Add install section to README"<br/>git add requirements.txt<br/>git commit -m "Update the PIP requirements"</span></pre><p id="a905" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">人们可以使用交互式staging部分地存放文件，但是我们稍后会完整地存放它，特别是因为在新版本的git 中已经重写了<a class="ae mx" rel="noopener ugc nofollow" target="_blank" href="/git-2-37-is-out-31945b4862aa">。</a></p><p id="100a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，你现在不得不用租赁来推动<a class="ae mx" href="https://medium.com/itnext/git-force-vs-force-with-lease-9d0e753e8c41" rel="noopener">力量，因为你在历史上已经做了一些家务:</a></p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="9f77" class="ms lr it mo b gy mt mu l mv mw">git push --force-with-lease</span></pre><h1 id="f68d" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">拆分旧的提交</h1><p id="06ed" class="pw-post-body-paragraph ki kj it kk b kl mi ju kn ko mj jx kq kr mk kt ku kv ml kx ky kz mm lb lc ld im bi translated">现在，让我们假设我们想要分割两次提交之后的提交(因此，第三次提交，从最后一次开始计数)。为了找到我们想要编辑的提交，让我们做一个oneliner git日志:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="c375" class="ms lr it mo b gy mt mu l mv mw">git log --oneline</span></pre><p id="8550" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出如下所示:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="9b60" class="ms lr it mo b gy mt mu l mv mw">dd16fac (<strong class="mo iu">HEAD -&gt; master</strong>) Add GitHub page <br/>b8473cf Update README<br/>deba6a0 Add README and requirements.txt</span></pre><p id="f1ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里，<code class="fe my mz na mo b">Add GitHub page</code>是最后一次提交，我们要编辑<code class="fe my mz na mo b">Add README and requirements.txt</code>。为此，我们使用交互式重新设定基准:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="1027" class="ms lr it mo b gy mt mu l mv mw">git rebase -i HEAD~3</span></pre><p id="a203" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe my mz na mo b">HEAD~3</code>表明我们想回顾过去改变历史到什么程度。在本例中，是3次提交。通过运行此命令，将打开一个编辑器，其中包含以下内容:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="36a6" class="ms lr it mo b gy mt mu l mv mw">pick deba6a0 Add README and requirements.txt<br/>pick b8473cf Update README<br/>pick dd16fac Add GitHub page</span></pre><p id="0470" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，该顺序与git日志中的顺序不同。您想要更改的提交现在显示在第一行。要改变split up，你要改变它前面的动词，从<code class="fe my mz na mo b">pick</code>变成<code class="fe my mz na mo b">edit</code>。</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="f328" class="ms lr it mo b gy mt mu l mv mw"><strong class="mo iu">edit</strong> deba6a0 Add README <br/>pick b8473cf Update README<br/>pick dd16fac Add GitHub page</span></pre><p id="edfe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后保存文件并退出。您将返回到命令行，并有机会在该特定历史点进行更多更改:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="f47c" class="ms lr it mo b gy mt mu l mv mw">git reset HEAD^<br/>git add README.md<br/>git commit -m "Add README"<br/>git add requirements.txt<br/>git commit -m "Add the PIP requirements"</span></pre><p id="0c66" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这与我们在上一节中所做的相同。现在让交互式rebaser知道您已经完成了这里的工作，并希望继续:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="27a4" class="ms lr it mo b gy mt mu l mv mw">git rebase --continue</span></pre><p id="1ab9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将不会有冲突，你的rebase将成功完成。再做一次git日志，现在提交应该是两次提交:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="0003" class="ms lr it mo b gy mt mu l mv mw">git log -4</span></pre><p id="2feb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出如下所示:</p><pre class="lf lg lh li gt mn mo mp mq aw mr bi"><span id="e0ca" class="ms lr it mo b gy mt mu l mv mw">dd16fac (<strong class="mo iu">HEAD -&gt; master</strong>) Add GitHub page <br/>b8473cf Update README<br/>e870c58 Add README<br/>f853559 Add the PIP requirements</span></pre><h1 id="4da8" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">最后的话</h1><p id="350b" class="pw-post-body-paragraph ki kj it kk b kl mi ju kn ko mj jx kq kr mk kt ku kv ml kx ky kz mm lb lc ld im bi translated">我每周在git、GitHub和GitLab上写文章。</p><ul class=""><li id="38b4" class="nb nc it kk b kl km ko kp kr nd kv ne kz nf ld ng nh ni nj bi translated">订阅my Medium publishes，以便在新的Git周刊发布时获得通知。</li><li id="3cd8" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">关注Twitter上的<a class="ae mx" href="https://twitter.com/MohammadAliEN" rel="noopener ugc nofollow" target="_blank">我</a>获取git上的每周文章和每日推文。</li></ul></div></div>    
</body>
</html>
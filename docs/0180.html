<html>
<head>
<title>How to Deploy Angular Application to Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Angular应用程序部署到Heroku</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-deploy-angular-application-to-heroku-1d56e09c5147?source=collection_archive---------0-----------------------#2017-10-27">https://itnext.io/how-to-deploy-angular-application-to-heroku-1d56e09c5147?source=collection_archive---------0-----------------------#2017-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/577304c83fb2060dbe0397cdd8ebe6c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQRcX_spZzucM-o9uLoRaw.png"/></div></div></figure><p id="2acb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在你尝试之前，它总是“看起来”很容易。在heroku上部署了其他应用后，我最近在部署Angular 4时遇到了一系列挑战，但我最终度过了难关。所以我写信来详细解释我是如何做的。</p><p id="1980" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文将向您展示如何将Angular 2/4应用程序轻松部署到Heroku，更重要的是，避免常见的陷阱。</p><p id="e95a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这不是帮助你学习Angular的教程。我们假设您已经完成了开发并准备好部署。然而，我们将从开始和部署设置基本的角度项目。本教程将涵盖:</p><ul class=""><li id="2312" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">创建基本角度项目</li><li id="8bd8" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">设置从GitHub到Heroku的自动部署</li><li id="573a" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">在Heroku服务器上部署Angular应用程序</li></ul><h2 id="eaa8" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">设置您的角度应用</h2><p id="ad19" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">利用Angular CLI，通过运行以下命令设置一个新项目:</p><p id="3adb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">ng new demo-deploy</code></p><p id="7a44" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由此，我们的应用程序将被命名为<code class="fe mi mj mk ml b">demo-deploy</code>。留出几分钟时间来设置新项目和安装npm软件包。</p><p id="3de3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">启动应用</strong></p><p id="ac39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将目录更改为新项目，并使用下面的命令启动它。默认情况下，这将在端口4200上的新浏览器中打开。即<a class="ae mm" href="http://localhost:4200." rel="noopener ugc nofollow" target="_blank"> http://localhost:4200。</a></p><p id="399b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">cd demo-deploy<br/>ng serve</code></p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/adefcb13b06b20ded23dd443aacf7405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hls_8oM_-UbwUJ1AMcrR9g.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">Angular app欢迎您</figcaption></figure><p id="aeb7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的基本angular应用程序已经准备就绪，正在本地运行。让我们推到github</p><h2 id="1306" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">创建其GitHub repo和Push</h2><p id="cb95" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在这里，我们将创建一个新的github存储库，并将我们的应用程序推送到这个存储库中。</p><ul class=""><li id="c200" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">登录github并创建新的存储库。不需要用自述文件初始化存储库</li><li id="fcb5" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">在您的终端/CMD中打开新标签。或者按Ctrl+C停止运行app。然后运行以下命令:</li></ul><p id="7395" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">git remote add origin &lt;new_github_repository_url&gt;<br/>git add .<br/>git commit -m "initial commit"<br/>git push -u origin master</code></p><p id="6ff9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们的app在github上。</p><h2 id="95f2" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">设置从GitHub到Heroku的自动部署</h2><p id="81ee" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">这一步的好处是，一旦你对你的github库做了修改，它会自动将修改推送到heroku上的代码库中，然后在网上生效。这意味着，你只需要把你的修改推送到github，就完成了。</p><p id="f21a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你还没有账户，在heroku网站上创建一个。它是免费的。登录您的仪表盘并创建一个新应用程序。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/2d3f2aea3ed09b93038c2d459e3cef8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PQfjnAoCpujdC_K-30bZw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">在heroku上创建新的应用程序</figcaption></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/6f2902b077a458e39bd51f8b3546492c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6OIkJwHXC9PCS-rHfaZZbQ.png"/></div></div></figure><p id="8567" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击<strong class="ka ir">创建应用</strong></p><p id="7626" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">部署</strong>菜单中，在<strong class="ka ir">部署方式</strong>下，选择<strong class="ka ir"> GitHub </strong>。如果您还没有这样做，它会要求您登录您的github帐户，这样它就可以连接到它。</p><p id="de30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">输入GitHub库的名称，点击<strong class="ka ir">搜索</strong>。一旦回购显示如下，点击<strong class="ka ir">连接</strong>。维奥拉。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/e36b14b1ff2ef5178013baad74a91f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3dzwOO3ust4pcc06pqjrGQ.png"/></div></div></figure><p id="b5d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">呃，等等。还有两个简单的步骤。</p><ol class=""><li id="e2b7" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv mz lc ld le bi translated">在自动部署下，选择主分支，然后单击启用自动部署。</li></ol><p id="267b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.在手动部署下，单击部署分支。这是把我们的新代码推给heroku。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/6bb013d7d5f2a0d555c8b02dad0f63c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RdFdiX0dZSAjWZY0O751ng.png"/></div></div></figure><p id="740f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好了，我们真的完成了这个阶段。这可能需要一点时间，但完成后会向您显示成功部署的消息，如下所示:</p><div class="mo mp mq mr gt ab cb"><figure class="nb jr nc nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/a52c02ee08efbc769c53ecfb294c0780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1408/format:webp/1*FMVSVR5zPVOJ3zX1EEcVEg.png"/></div></figure><figure class="nb jr nh nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/0856642286f6496afe93f9276f540c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*Au4tL7MQz7SbIuSET0oReA.png"/></div></figure></div><p id="aa35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果单击查看，将会打开一个新选项卡，但不会显示您的应用程序。接下来的一系列步骤将指导您配置和旋转angular应用程序。</p><h1 id="193a" class="ni ll iq bd lm nj nk nl lp nm nn no ls np nq nr lv ns nt nu ly nv nw nx mb ny bi translated">配置您的Angular应用程序以在Heroku上正确部署</h1><p id="0c0e" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">以下是生产就绪的步骤，可以轻松、正确地部署您的应用程序，不会出现任何问题。</p><h2 id="e13a" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">确保您拥有最新版本的angular cli和angular编译器cli。</h2><p id="0cb4" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">通过在终端中运行以下命令，将它们安装到您的应用程序中:</p><p id="4d56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">npm install @angular/cli@latest @angular/compiler-cli --save-dev</code></p><p id="aaca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的package.json中，复制</p><p id="e96a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">"@angular/cli”: “1.4.9”,<br/>"@angular/compiler-cli": "^4.4.6",</code></p><p id="1d97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从依赖到依赖</p><h2 id="4af7" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">在package.json中创建安装后脚本</h2><p id="5873" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在“脚本”下，添加一个“heroku-postinstall”命令，如下所示:</p><pre class="mo mp mq mr gt nz ml oa ob aw oc bi"><span id="af26" class="lk ll iq ml b gy od oe l of og">"heroku-postbuild": "ng build"</span></pre><p id="be03" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这告诉Heroku使用提前(AOT)编译器构建应用程序，并使其可以投入生产。这将创建一个<code class="fe mi mj mk ml b">dist</code>文件夹，我们应用程序的所有html和javascript转换版本将从这里启动。</p><h2 id="19be" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">添加节点和NPM引擎</h2><p id="9a7f" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">您需要添加Heroku将用来运行您的应用程序的节点和NPM引擎。最好是，它应该与您机器上的版本相同。因此，运行<code class="fe mi mj mk ml b">node -v</code>和<code class="fe mi mj mk ml b">npm -v</code>来获得正确的版本，并将其包含在package.json文件中，如下所示:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="a3d7" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">将类型脚本复制到依赖项。</h2><p id="1577" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">将<code class="fe mi mj mk ml b">"typescript": "~2.3.3"</code>从devDependencies复制到Dependencies，以通知Heroku使用什么类型的脚本版本。</p><h2 id="7dc9" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">安装增强的解决方案3.3.0</h2><p id="b8fa" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">运行命令<code class="fe mi mj mk ml b">npm install enhanced-resolve@3.3.0 --save-dev</code></p><h2 id="a47e" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">安装服务器以运行您的应用程序</h2><p id="1f48" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在本地，我们从终端运行<code class="fe mi mj mk ml b">ng serve</code>，在本地浏览器上运行我们的应用。但是我们需要设置一个Express服务器来运行我们的生产就绪应用程序(从创建的dist文件夹中),以确保轻量级和快速加载。</p><p id="44b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过运行以下命令安装Express server:</p><p id="a46c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">npm install express path --save</code></p><p id="6826" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在应用程序的根目录下创建一个server.js文件，并粘贴以下代码。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="d80b" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">更改开始命令</h2><p id="95bf" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在package.json中，将“start”命令改为<code class="fe mi mj mk ml b">node server.js</code>，这样它就变成了:</p><p id="895d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">"start": "node server.js"</code></p><p id="b730" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是完整的package.json的样子。您的包可能包含更多内容，具体取决于您的应用程序特定的包。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="a846" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将更改推送到GitHub:</p><p id="c444" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">git add .<br/>git commit -m "updates to deploy to heroku"<br/>git push</code></p><p id="caa0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，Heroku上的应用程序将自动从GitHub获取更改并自我更新。</p><p id="6d60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，它会检查您的package.json并安装软件包。</p><p id="7e88" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它将运行postinstall，然后，<code class="fe mi mj mk ml b">node server.js</code>启动您的应用程序。</p><p id="0ed6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以检查Activity选项卡并打开构建日志来查看它实际上是如何运行的。</p><p id="8a16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你不应该遇到任何问题。我写这篇文章的时候也坚持了下来。</p><p id="f8d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">维奥拉。！我们的Angular应用程序已经准备好并投入使用！</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/dcd68cfbfbe9c2057f7ebd7d43f6cd08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PqDJrMujNDmNBykw6-0U8Q.png"/></div></div></figure><p id="e0c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">谢谢你一直坚持到现在。</p><p id="df83" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae mm" href="https://twitter.com/hellotunmbi" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或Medium上关注我。</p><p id="c218" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">说茄子！…如果您遇到任何问题或想要建议更好的方法，请在下面评论。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/hellotunmbi"><div class="gh gi ok"><img src="../Images/a629679250bd54970466aa64242e8f74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vzHMBQN2v_dshzof9eJZEQ.png"/></div></a></figure></div></div>    
</body>
</html>
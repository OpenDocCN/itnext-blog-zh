<html>
<head>
<title>Using Custom Labels to Maximize Protection with AWS WAF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用定制标签最大限度地保护AWS WAF</h1>
<blockquote>原文：<a href="https://itnext.io/using-custom-labels-to-maximize-protection-with-aws-waf-2b2532e8b51f?source=collection_archive---------2-----------------------#2022-05-21">https://itnext.io/using-custom-labels-to-maximize-protection-with-aws-waf-2b2532e8b51f?source=collection_archive---------2-----------------------#2022-05-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3531" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当您需要覆盖AWS管理的规则组时该做什么</h2></div><p id="9a5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在当今由API驱动的世界中，防火墙最需要的功能之一是能够通过解密web请求来检查HTTPS流量，并防止SQL注入和跨站点脚本等第7层利用——该列表通常被称为<a class="ae le" href="https://owasp.org/www-project-top-ten/" rel="noopener ugc nofollow" target="_blank"> OWASP Top 10。</a></p><p id="8983" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你曾经管理过防火墙设备，你会非常清楚这有多麻烦。这是一个不断平衡的过程，既要精心制定策略来提供最佳保护，又不能给用户和防火墙管理团队带来太多麻烦。幸运的是，受管防火墙解决方案正变得越来越普遍，几乎每个云提供商都有自己的产品。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/bb0a87a8cf7aedd25cb0af5d42afc431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CA61sfjS9wmLjA-X.png"/></div></div></figure><p id="5734" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天我们将深入探讨AWS WAF以及它的规则引擎是如何工作的。</p><h2 id="cd22" class="lr ls it bd lt lu lv dn lw lx ly dp lz kr ma mb mc kv md me mf kz mg mh mi mj bi translated">HTTP 101</h2><p id="8111" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">首先，重要的是要记住HTTP中的P代表协议——它可以被定义为一组管理设备之间数据交换或传输的规则。换句话说，你的浏览器和你所连接的网页所在的服务器有一个“契约”,规定了它们应该如何相互通信。服务器说:给我发送一个格式为x，y，z的请求，我会按照你期望的方式处理你的请求，然后给你发送一些你能理解并能在显示器上正确显示的东西。</p><p id="b886" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不出所料，浏览器构造对服务器的请求的主要方式是使用URL。典型的URL如下所示:</p><p id="a552" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">https://domain.com/path/subpath/page.aspx?field1=test&amp;T2【现场2 =测试</p><ol class=""><li id="917f" class="mp mq it kk b kl km ko kp kr mr kv ms kz mt ld mu mv mw mx bi translated">https://-这是你的浏览器正在使用的协议，现在大多数浏览器默认使用https-http的加密版本-有些甚至默认不显示它。如果您想使用普通的未加密http，只需从http://开始</li><li id="39a1" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">domain.com——这是你正在连接的实际计算机的域名或外行人的术语。互联网不理解这样的文本，它只理解像192.168.1.24这样的IP地址。您的浏览器在后台使用DNS(域名系统)将域名转换为正确的IP地址。</li><li id="7b18" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">/path/subpath/page . aspx-这是URI，统一资源标识符-有时也称为路径。这是您希望web服务器实际返回给您的文件——/ path/subpath实际上是您正在连接的服务器上的文件夹——就像您笔记本电脑上的文件夹一样。有时，page.aspx部分不会显示在URL中，默认情况下，web服务器会根据路径向您返回特定的页面。</li><li id="e3b9" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated"><a class="ae le" href="https://domain.com/path/subpath/page.aspx?field1=test&amp;field2=test" rel="noopener ugc nofollow" target="_blank">field 1 =测试&amp;field 2 =测试</a>—URI后，如果有问号(？)问号后面的部分称为查询字符串或查询参数。这是一种向web服务器传递某些参数的方式，您所请求的页面可能会使用这些参数来执行一些自定义逻辑。比如一次搜索。https://www.google.com/search?q=espn<a class="ae le" href="https://www.google.com/search?q=espn" rel="noopener ugc nofollow" target="_blank">这个网址将在谷歌上搜索ESPN。</a></li></ol><p id="8447" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大多数人对URL都很熟悉，因为他们每天都会看到它们，但实际上幕后发生的事情更多。您可以通过检查浏览器的开发工具(通常在Windows上按F12或在Mac上按Command+Option+I ),获得在web请求中发送的信息的完整视图。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nd"><img src="../Images/a6e837cfa9635f44e1e28e54d6afa0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSoQjqzfmHBE7g1F6JUG2g.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">这是我写这个博客时的页面。第一眼看到这个你会不知所措。当大多数人看到点击按钮时实际发生的事情时，他们会感到震惊。这只是网络请求。</figcaption></figure><p id="00c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据您在网上所做的事情，浏览器还会以以下3种方式包含信息:</p><ol class=""><li id="fa96" class="mp mq it kk b kl km ko kp kr mr kv ms kz mt ld mu mv mw mx bi translated">标题—当您检查请求标题时，您将看到其中包含的各种信息。下面是与普通用户最相关的3个标题，但是标题可以包含任何类型的信息:<br/> 1 .主机标题—这通常与您请求的站点的域相匹配。<br/> 2。用户代理—这包括有关您正在使用的浏览器类型的信息。这有助于web服务器返回一个与您的浏览器兼容的页面——对移动友好页面最有用<br/> 3。cookie——我想大多数人都熟悉cookie，它们是关于用户会话的信息——偏好、历史、购物车内容等。</li><li id="9337" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">HTTP方法—这有助于浏览器准确识别他们希望web服务器执行的操作，因为有时URIs可能会映射到幕后的不同进程。最常见的方法有:<br/> 1。GET —您希望服务器返回一些东西。上面提到的查询字符串通常用于GET请求。<br/> 2。POST —您希望web服务器创建一个记录。<br/> 3。PUT —您希望web服务器更新现有记录。<br/> 4。删除—您希望web服务器删除现有记录。</li><li id="8ecc" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">请求正文/有效负载—这是您可以传递给web服务器以完成请求的附加数据。这通常用于POST和PUT请求。当您填写一个在线表单并单击submit(像购物时一样)时，浏览器获取您的表单数据并将其放入请求正文中，然后发送一个POST或PUT请求。</li></ol></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="7338" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述每一个参数(以及其他一些参数)都是攻击者的媒介。不仅如此，在攻击者试图攻击您之前，您需要确切地知道他们的恶意请求是什么样的。你需要一个WAF(网络应用防火墙)来检查每一个位置和精心制定的规则。输入AWS WAF。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="a708" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">AWS管理<a class="ae le" href="https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-list.html" rel="noopener ugc nofollow" target="_blank">一个规则列表</a>,我们可以用它来保护通过与WAF相关的资源的流量。这通常是大多数人开始使用AWS WAF的地方。在随机应用规则之前，了解您要保护的应用程序在做什么以及有什么要求是很重要的。通常从以下5点开始并不是一个坏主意:</p><ol class=""><li id="55d6" class="mp mq it kk b kl km ko kp kr mr kv ms kz mt ld mu mv mw mx bi translated">核心规则集—包括防范:<br/> 1。EC2元数据服务SSRF <br/> 2。跨站脚本(XSS) <br/> 3。本地和远程文件包含<br/> 4。恶意文件扩展名<br/> 5。大小限制— AWS WAF在一个请求中只能检查这么多数据；举个例子，WAF在一个请求有效载荷中最多只能检查8KB。这对于寻求规避WAF的客户来说可能是一个媒介——他们可以用8 KB的绒毛填充恶意的有效载荷，WAF不会阻止它。了解了这一点，您可以配置WAF来阻止更大的请求，这样攻击者就无法绕过您的WAF。如果您的应用程序需要文件上传，您可能需要允许某些请求绕过大小限制块—也许是通过精确的URI。</li><li id="b891" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">已知的错误输入— <br/> 1。臭名昭著的Log4J漏洞<br/> 2。Java反序列化<br/> 3。主机头中的本地主机。<br/> 4。PROPFIND HTTP方法</li><li id="e396" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">Amazon IP信誉列表—防止已知的恶意IP地址。</li><li id="cb61" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">管理保护—为您提供阻止访问敏感URIs的方法。这不会捕捉一切，所以通常你可以添加自己的自定义规则来阻止这些URIs。</li><li id="79c2" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">不是托管规则，但基于速率的规则有助于防止洪水攻击。AWS以30秒为增量评估300秒内的速率，并根据第3层源IP或报头(如“X-Forwarded-For ”)阻止违规IP地址(如果流中有web代理和负载平衡器)。</li></ol><p id="9fa9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您使用的是SQL数据库，我建议您添加awsmanagerudlesqliruleset—以增加一层针对SQL注入攻击的保护。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="ad6b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">重要是要补充一点，你不应该完全依赖你的晶片来保护应用层。大多数浏览器实际上可以识别并阻止某些XSS攻击的发生。此外，应用程序应该添加逻辑来防止漏洞的发生——这个过程被称为<a class="ae le" href="https://findanyanswer.com/what-is-escaping-user-input" rel="noopener ugc nofollow" target="_blank">转义</a>或<a class="ae le" href="https://www.webopedia.com/definitions/input-sanitization/#:~:text=Input%20sanitization%20is%20a%20cybersecurity,harmful%20codes%20into%20the%20system." rel="noopener ugc nofollow" target="_blank">输入清理</a>。最好的安全性有多层保护，并且没有单点故障。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h2 id="da84" class="lr ls it bd lt lu lv dn lw lx ly dp lz kr ma mb mc kv md me mf kz mg mh mi mj bi translated">当您有误报并且需要覆盖时会发生什么？</h2><p id="c436" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">迟早你会接到用户打来的电话，说“嘿，我想在这个网站上做xyz，但上面只写着403禁止”。因此，您检查日志并看到以下内容:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi np"><img src="../Images/c0b90d0958dc5f7643e0d20ce5ca4a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3spZB0X370kwQUsPKmibQQ.png"/></div></div></figure><p id="f795" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中一个用户请求通过在请求体中包含一些可疑的内容来破坏本地文件包含规则。<a class="ae le" href="https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/" rel="noopener ugc nofollow" target="_blank"> LFI是一种网络请求查看服务器上目录的方式，这种方式通常是不允许的——会让你面临远程代码执行、跨站脚本或其他漏洞。</a>典型的本地文件包含模式是</p><pre class="lg lh li lj gt nq nr ns nt aw nu bi"><span id="7bae" class="lr ls it nr b gy nv nw l nx ny">/../../../somefile.txt</span></pre><p id="08ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您做了尽职调查，应用程序就是这样编码的，这并不一定是坏的——AWS特别编写了稍微严格的规则。无论如何，您需要允许流量通过WAF。你可以把通用的LFI体规则放在整个WAF的计数模式中，但是这可能会不必要地打开你。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nz"><img src="../Images/a1cb9ba46a8c5da905a6bfeb9760f0e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aObGrAiSdEbPUArnPXdCZw.png"/></div></div></figure><p id="6dda" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设您只想打开WAF，只忽略需要打开的特定URI的GenericLFI_BODY规则。要做到这一点，您需要了解WAF如何处理规则和应用标签。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oa"><img src="../Images/4786a06d14824d6f45320ae1d9717be9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8XFkLA4pZaCr8jM6_c3kA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">AWS WAF按照规则出现的顺序处理规则。</figcaption></figure><p id="2bc5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在你需要做更复杂的事情之前，这通常没什么关系——就像我们现在所处的场景。当您将规则置于计数模式时，AWS会将标签应用于该规则，使规则名称与请求相匹配。要查看可能分配的标签，请通过CLI运行此命令。根据需要更改供应商名称和名称参数。</p><pre class="lg lh li lj gt nq nr ns nt aw nu bi"><span id="834e" class="lr ls it nr b gy nv nw l nx ny">aws wafv2 describe-managed-rule-group \<br/> — vendor-name AWS \<br/> — name AWSManagedRulesCommonRuleSet \<br/> — scope REGIONAL — region us-east-1 — query AvailableLabels</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ob"><img src="../Images/1c88ed39bbd1f70d0d4738b4e9c0a3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-f1P-xIo2vmckDge1Vg6A.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">我们运行命令，我们看到这是应用于请求的标签，该请求在计数模式下触发核心规则集的GenericLFI_Body逻辑。</figcaption></figure><p id="1be4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下规则将阻止任何请求:如果在请求中应用了上述标签，并且请求不是针对批准的URI/my path/page . aspx，请注意操作是block。</p><pre class="lg lh li lj gt nq nr ns nt aw nu bi"><span id="f474" class="lr ls it nr b gy nv nw l nx ny">{<br/>  "Name": "allow-lfi",<br/>  "Priority": 0,<br/>  "Action": {<br/>    "Block": {}<br/>  },<br/>  "VisibilityConfig": {<br/>    "SampledRequestsEnabled": true,<br/>    "CloudWatchMetricsEnabled": true,<br/>    "MetricName": "allow-lfi"<br/>  },<br/>  "Statement": {<br/>    "AndStatement": {<br/>      "Statements": [<br/>        {<br/>          "LabelMatchStatement": {<br/>            "Scope": "LABEL",<br/>            "Key": "awswaf:managed:aws:core-rule-set:GenericLFI_Body"<br/>          }<br/>        },<br/>        {<br/>          "NotStatement": {<br/>            "Statement": {<br/>              "ByteMatchStatement": {<br/>                "FieldToMatch": {<br/>                  "UriPath": {}<br/>                },<br/>                "PositionalConstraint": "EXACTLY",<br/>                "SearchString": "/mypath/page.aspx",<br/>                "TextTransformations": [<br/>                  {<br/>                    "Type": "NONE",<br/>                    "Priority": 0<br/>                  }<br/>                ]<br/>              }<br/>            }<br/>          }<br/>        }<br/>      ]<br/>    }<br/>  }<br/>}</span></pre><p id="b048" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们只需确保我们的新规则在核心规则集将标签“AWS waf:managed:AWS:Core-Rule-Set:generic lfi _ Body”应用于请求之后得到处理。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oc"><img src="../Images/296b142156bc400701bfb5bdf90a6050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6F6gOsa2V4s-MEHnKkyraw.png"/></div></div></figure><h2 id="c477" class="lr ls it bd lt lu lv dn lw lx ly dp lz kr ma mb mc kv md me mf kz mg mh mi mj bi translated">如果我们需要做一些更复杂的事情呢？</h2><p id="6f3a" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">问题解决了对吗？没有。第二天，你会收到用户发来的电子邮件，说他们收到了更多的403错误。您检查日志，看到GenericLFI_Body规则在不同的URI上跳闸，现在您看到日志中有，它在相同的两个URIs上跳闸。你再次确认这是合法的交通，你需要允许它通过。但是怎么做呢？</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi od"><img src="../Images/bd39f15570e6b68bfe80785ba7f2a706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nto07k3q5H5615O-DKFgHQ.png"/></div></div></figure><p id="9986" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本上，您需要能够同时正确处理所有4个条件的逻辑，并应用一个块— 2个不同的模式匹配和不同的URI匹配。这基本上是嵌套在And语句中的Or语句，但这在WAF中是不可能的——至少在单个规则中是不可能的……</p><p id="dfea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">前进的道路是使用自定义标签。AWS WAF允许您根据特定逻辑对流量应用自定义标签，以便您可以将这些标签用于下游策略实施。</p><p id="b604" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将它们都包含在CloudFormation中，以便于阅读。注意，这个特殊的规则组有3个单独的规则WAF根据它们的优先级依次处理它们。<br/> 1。<strong class="kk iu"> GenericLFI_Label_Check </strong> —设置为计数。注意，这通过RuleLabels标志应用了一个标签<em class="oe">app:generic-RFI-label-check</em>。该标签将应用于任何包含标签的请求，该标签可以是<br/>* AWS waf:managed:AWS:core-rule-set:generic lfi _ query arguments<br/>* AWS waf:managed:AWS:core-rule-set:generic lfi _ Body<br/>2。<strong class="kk iu"> GenericLFI_Uri_Check </strong> —设置为计数。这将检查请求是否既不是/mypath/page.aspx也不是/otherpath/process.aspx，并应用标签<em class="oe">app:generic-RFI-allowed-uri</em>。注意这个逻辑中的not语句和and语句。<br/> 3。<strong class="kk iu"> GenericLFI_Block </strong> —这将检查请求是否具有上述两个自定义标签，如果有，将阻塞请求。</p><p id="3e52" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将它放在核心规则集下面，以确保正确应用核心规则集中的标签。我们还必须确保GenericLFI_QueryArguments规则被设置为在托管规则组中计数。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><pre class="lg lh li lj gt nq nr ns nt aw nu bi"><span id="7bc5" class="lr ls it nr b gy nv nw l nx ny">Parameters:<br/>  Application:<br/>    Type: String<br/>Resources:<br/>  GenericLFIAllowRule:<br/>      Type: AWS::WAFv2::RuleGroup<br/>      Properties:<br/>        Scope: REGIONAL<br/>        Capacity: 20<br/>        Description: !Sub ${Application}-GenericLFI-URI-Allow-List<br/>        Name: !Sub ${Application}-GenericLFI-URI-Allow-List<br/>        VisibilityConfig:<br/>          SampledRequestsEnabled: true<br/>          CloudWatchMetricsEnabled: true<br/>          MetricName: !Sub ${Application}-GenericLFI-URI-Allow-List<br/>        Rules:<br/>          - Name: GenericLFI_Label_Check<br/>            Priority: 0<br/>            RuleLabels:<br/>              - Name: app:generic-rfi-label-check<br/>            Action:<br/>              Count: {}<br/>            VisibilityConfig:<br/>              SampledRequestsEnabled: true<br/>              CloudWatchMetricsEnabled: true<br/>              MetricName: !Sub ${Application}-GenericLFI_Check<br/>            Statement:        <br/>              OrStatement:<br/>                  Statements:<br/>                    -  LabelMatchStatement:<br/>                        Key: awswaf:managed:aws:core-rule-set:GenericLFI_QueryArguments<br/>                        Scope: LABEL<br/>                    -  LabelMatchStatement:<br/>                        Key: awswaf:managed:aws:core-rule-set:GenericLFI_Body<br/>                        Scope: LABEL<br/>          - Name: GenericLFI_Uri_Check<br/>            Priority: 1<br/>            RuleLabels:<br/>              - Name: app:generic-rfi-allowed-uris<br/>            Action:<br/>              Count: {}<br/>            VisibilityConfig:<br/>              SampledRequestsEnabled: true<br/>              CloudWatchMetricsEnabled: true<br/>              MetricName: !Sub ${Application}-GenericLFI_Uri_Check<br/>            Statement:        <br/>              AndStatement:<br/>                  Statements:<br/>                    - NotStatement:<br/>                        Statement:<br/>                          ByteMatchStatement:<br/>                              FieldToMatch:<br/>                                UriPath: {}<br/>                              PositionalConstraint: EXACTLY<br/>                              SearchString: /mypath/page.aspx<br/>                              TextTransformations:<br/>                                - Type: NONE<br/>                                  Priority: 0<br/>                    - NotStatement:<br/>                        Statement:<br/>                          ByteMatchStatement:<br/>                              FieldToMatch:<br/>                                UriPath: {}<br/>                              PositionalConstraint: EXACTLY<br/>                              SearchString: /otherpath/process.aspx<br/>                              TextTransformations:<br/>                                - Type: NONE<br/>                                  Priority: 0<br/>          - Name: GenericLFI_Block<br/>            Priority: 2<br/>            RuleLabels:<br/>              - Name: app:generic-rfi-block<br/>            Action:<br/>              Block: {}<br/>            VisibilityConfig:<br/>              SampledRequestsEnabled: true<br/>              CloudWatchMetricsEnabled: true<br/>              MetricName: !Sub ${Application}-GenericLFI_Block<br/>            Statement:        <br/>              AndStatement:<br/>                  Statements:<br/>                    - LabelMatchStatement:<br/>                        Key: app:generic-rfi-label-check<br/>                        Scope: LABEL<br/>                    - LabelMatchStatement:<br/>                        Key: app:generic-rfi-allowed-uris<br/>                        Scope: LABEL</span></pre><p id="6b3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">即使使用托管防火墙解决方案，正确设计和维护它们也不是一件简单的任务。AWS已经做了大量的工作，减少了设计web应用程序防火墙的负担，该防火墙具有完全可扩展的策略引擎，能够检查web请求的每个方面，以防止恶意行为者破坏您的应用程序。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="d532" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Matthew是领先的AWS网络安全合作伙伴stackArmor的高级解决方案总监，该公司为希望满足合规框架安全要求的客户设计定制解决方案:FedRAMP、NIST 800系列、PCI-DSS、国防部SRG、HIPAA、FISMA、FIPS 140–2(和3)等。StackArmor提供了一个经过AWS审核的解决方案，可以加速FedRAMP ATO的运行并降低40%以上的成本。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Setting up Sass unit testing in your project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在项目中设置Sass单元测试</h1>
<blockquote>原文：<a href="https://itnext.io/setting-up-sass-unit-testing-in-your-project-b683a2e8ac03?source=collection_archive---------7-----------------------#2018-03-20">https://itnext.io/setting-up-sass-unit-testing-in-your-project-b683a2e8ac03?source=collection_archive---------7-----------------------#2018-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e8c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个演练将使您准备好对您的项目进行Sass测试。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/47d7efaf5fc32cb5544b46da5bb74433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*df4MOLWun1wQgs39."/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@der_maik_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Maik Jonietz </a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><blockquote class="lc ld le"><p id="18e3" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">https://github.com/diego-codes/sass-testing-template:</strong>结账演示项目:<br/><a class="ae lb" href="https://github.com/diego-codes/sass-testing-template" rel="noopener ugc nofollow" target="_blank"/></p></blockquote><h1 id="e3c3" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">为什么要单元测试Sass？</h1><p id="8ed1" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">Sass是一个强大的CSS预处理器，它使您能够编写逻辑并在代码中重用样式来生成CSS。如果您正在利用Sass函数和mixin特性，那么编写一些单元测试来确保您的代码按预期工作可能是一个很好的例子。尽管您的Sass编译没有错误，但是您的函数和mixins可能会产生意想不到的输出。此外，您可能不会马上注意到，因为CSS会无声无息地失败。</p><p id="f73e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了说明这一点，让我们来看一下将一个<code class="fe mm mn mo mp b">px</code>值转换成一个<code class="fe mm mn mo mp b">rem</code>值的函数:</p><p id="8563" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> src/rem.scss </strong></p><pre class="km kn ko kp gt mq mp mr ms aw mt bi"><span id="a738" class="mu lk iq mp b gy mv mw l mx my">@function px-to-rem ($px) {<br/>  $base: 16px;<br/>  @return #{$base / $px} * 1rem;<br/>}</span></pre><p id="38e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在当前实现中调用该函数不会引发任何Sass编译错误，但其结果可能不是您所期望的:</p><pre class="km kn ko kp gt mq mp mr ms aw mt bi"><span id="9439" class="mu lk iq mp b gy mv mw l mx my">px-to-rem(10); // =&gt; 1.6px * 1rem (Unexpected outcome)</span></pre><p id="0587" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你得到的不是<code class="fe mm mn mo mp b">1.6rem</code>，而是<code class="fe mm mn mo mp b">1.6px * 1rem</code>。这就是测试驱动开发(TDD)和一般良好的单元测试派上用场的地方。</p><h1 id="772c" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">设置Sass True</h1><p id="b41c" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">真正的是一个用Sass编写测试的开源工具。它依赖于一个Javascript测试框架，该框架提供了类似于<code class="fe mm mn mo mp b">describe</code>和<code class="fe mm mn mo mp b">it</code>的方法，如Jest或Mocha。在最近的项目中，我选择Jest作为测试框架。所以我的例子将使用Jest，但是你也可以使用你喜欢的框架。</p><h1 id="2a76" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">安装依赖项</h1><pre class="km kn ko kp gt mq mp mr ms aw mt bi"><span id="abc9" class="mu lk iq mp b gy mv mw l mx my">npm install --save-dev sass-true node-sass jest glob</span></pre><h1 id="c036" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">正在为JS测试框架创建shim文件</h1><p id="6866" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">如果您有特定的文件夹结构来对Javascript测试文件进行分组，或者在整个项目中有特定的文件命名约定，我建议您对Sass测试文件遵循相同的约定。这将减少所有参与者在您的项目中开始编写Sass测试的障碍。我喜欢使用<code class="fe mm mn mo mp b">*.spec.js</code>文件扩展名，所以shim文件将被命名为<code class="fe mm mn mo mp b">scss.spec.js</code>，它将搜索所有的<code class="fe mm mn mo mp b">*.spec.scss</code>文件，并使用:</p><pre class="km kn ko kp gt mq mp mr ms aw mt bi"><span id="0fe1" class="mu lk iq mp b gy mv mw l mx my">const path = require('path')<br/>const sassTrue = require('sass-true')<br/>const glob = require('glob')<br/></span><span id="e9d1" class="mu lk iq mp b gy mz mw l mx my">describe('Sass', () =&gt; {<br/>  const sassTestFiles = glob.sync(<br/>    path.resolve(process.cwd(), 'src/**/*.spec.scss')<br/>  )<br/>  <br/>  sassTestFiles.forEach(file =&gt;<br/>    sassTrue.runSass({ file }, describe, it)<br/>  )<br/>})</span></pre><h1 id="1514" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">写作测试</h1><p id="7b76" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">既然您已经创建了shim文件来运行Jest的所有真实测试，那么是时候编写一些测试了！回到我们之前的例子，你现在可以写一个测试<code class="fe mm mn mo mp b">rem</code>函数。</p><p id="f737" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> src/rem.spec.scss </strong></p><pre class="km kn ko kp gt mq mp mr ms aw mt bi"><span id="1640" class="mu lk iq mp b gy mv mw l mx my">@import 'true';<br/>@import 'rem';</span><span id="7d04" class="mu lk iq mp b gy mz mw l mx my">@include describe('rem()') {<br/>  @include it('should return a rem unit given a unitless value') {<br/>    @include assert-equal(px-to-rem(10), 1.6rem);<br/>  }<br/>}</span></pre><p id="b2a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你从本文开头的示例代码中所知，上面的测试将会失败。没关系。这意味着现在您可以开始调试该函数以获得预期的结果。</p><h1 id="c142" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">运行测试</h1><p id="f5cc" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">只要您的shim文件包含在要运行测试的文件中，Sass测试就会与Javascript测试一起运行。使用Jest，您可以从您的终端运行它，并且应该包括Sass测试的输出:</p><pre class="km kn ko kp gt mq mp mr ms aw mt bi"><span id="8c2a" class="mu lk iq mp b gy mv mw l mx my">jest</span></pre></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><p id="04c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！不要忘记查看<a class="ae lb" href="https://github.com/oddbird/true#usage" rel="noopener ugc nofollow" target="_blank"> True </a>的文档，了解更多测试你的Sassy代码的方法。非常感谢<a class="ae lb" href="https://twitter.com/mirisuzanne" rel="noopener ugc nofollow" target="_blank"> @mirisuzanne </a>让Sass测试成为现实！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Add GraphCMS to your Web App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将GraphCMS添加到您的Web应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/add-graphcms-to-your-web-app-2d5a2930070a?source=collection_archive---------5-----------------------#2021-02-27">https://itnext.io/add-graphcms-to-your-web-app-2d5a2930070a?source=collection_archive---------5-----------------------#2021-02-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="66a3" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">我谈到了graph CMS——一个无头的CMS以及如何将其添加到您的web应用程序中。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/4e6f8b33b2344b270c7c092d546da4f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miXGFFnfgmd7upN82LUGcg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated"><a class="ae lf" href="https://graphcms.com" rel="noopener ugc nofollow" target="_blank"> GraphCMS </a>模式管理<a class="ae lf" href="https://sumran.in" rel="noopener ugc nofollow" target="_blank"> Sumran </a></figcaption></figure><h2 id="774b" class="lg lh iq bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">介绍</h2><p id="3aed" class="pw-post-body-paragraph jq jr iq jt b ju mc jw jx jy md ka kb lp me ke kf lt mf ki kj lx mg km kn ko ij bi translated">内容往往需要维护。通过集成像<a class="ae lf" href="https://graphcms.com" rel="noopener ugc nofollow" target="_blank"> GraphCMS </a>这样的无头CMS，你可以卸载内容管理，专注于<strong class="jt ir">交付</strong>内容。</p><p id="ae6b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">GraphCMS有一些很棒的特性，您会喜欢的:</p><ul class=""><li id="4b1e" class="mh mi iq jt b ju jv jy jz lp mj lt mk lx ml ko mm mn mo mp bi translated">它是基于GraphQL的，所以它解决了欠取和过取的问题</li><li id="b775" class="mh mi iq jt b ju mq jy mr lp ms lt mt lx mu ko mm mn mo mp bi translated">它将您的内容缓存到全球190多个位置，以实现更快的交付</li><li id="a2c5" class="mh mi iq jt b ju mq jy mr lp ms lt mt lx mu ko mm mn mo mp bi translated">它支持角色，所以你可以选择给队友完全或有限的控制权</li><li id="fe4b" class="mh mi iq jt b ju mq jy mr lp ms lt mt lx mu ko mm mn mo mp bi translated">它允许您在抓取过程中转换图像内容，以优化交付</li><li id="1eaa" class="mh mi iq jt b ju mq jy mr lp ms lt mt lx mu ko mm mn mo mp bi translated">它有一个交互式的API操场来测试你的查询和变化</li><li id="3fb0" class="mh mi iq jt b ju mq jy mr lp ms lt mt lx mu ko mm mn mo mp bi translated">它有一个慷慨的、永远免费的层级</li></ul><h2 id="4d78" class="lg lh iq bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">装置</h2><p id="dd99" class="pw-post-body-paragraph jq jr iq jt b ju mc jw jx jy md ka kb lp me ke kf lt mf ki kj lx mg km kn ko ij bi translated">在GraphCMS中创建完项目和模式后，转到项目的“Settings &gt; API Access”页面，为“Content API Access”生成一个新的令牌。将此文件和“端点URL”复制到您的web应用程序的环境文件中。Next.js示例:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="30f8" class="lg lh iq mw b gy na nb l nc nd">// .env.local</span><span id="232d" class="lg lh iq mw b gy ne nb l nc nd">GRAPHCMS_ENDPOINT=<a class="ae lf" href="https://api-eu-central-1.graphcms.com/v2/ckless3iher0u01yy02aodwnk/master" rel="noopener ugc nofollow" target="_blank">https://api-xxx.graphcms.com/v2/x</a>xx<br/>GRAPHCMS_TOKEN=xxx.xxx.xxx</span></pre><p id="5166" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">Angular CLI项目示例:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="600c" class="lg lh iq mw b gy na nb l nc nd">// src/environments/environment.ts</span><span id="799e" class="lg lh iq mw b gy ne nb l nc nd">export const environment = {<br/>  graphcmsEndpoint: '<a class="ae lf" href="https://api-eu-central-1.graphcms.com/v2/ckless3iher0u01yy02aodwnk/master" rel="noopener ugc nofollow" target="_blank">https://api-xxx.graphcms.com/v2/x</a>xx',<br/>  graphcmsToken: 'xxx.xxx.xxx'<br/>};</span></pre><p id="64c4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">注意:不要忘记将这些环境变量添加到您的部署系统中(Vercel / Netlify /别处)。</p><p id="ec3f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">要发送GraphQL查询和变化，您可以选择使用一个库，而不是自己形成这些请求。graphql-request 是一个很好的轻量级选项。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="037e" class="lg lh iq mw b gy na nb l nc nd">// Command</span><span id="016e" class="lg lh iq mw b gy ne nb l nc nd">npm i graphql-request graphql</span></pre><p id="ca9a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">设置<code class="fe nf ng nh mw b">graphql-request</code>在每个请求的<code class="fe nf ng nh mw b">authorization</code>头中包含GraphCMS令牌:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="2d55" class="lg lh iq mw b gy na nb l nc nd">// Anywhere</span><span id="749b" class="lg lh iq mw b gy ne nb l nc nd">import { GraphQLClient } from 'graphql-request';</span><span id="72dd" class="lg lh iq mw b gy ne nb l nc nd">const <strong class="mw ir">graphcmsEndpoint</strong>: string<strong class="mw ir"> </strong>= ENVIRONMENT.GRAPHCMS_ENDPOINT;<br/>const <strong class="mw ir">graphcmsToken: </strong>string = ENVIRONMENT.GRAPHCMS_TOKEN;</span><span id="168a" class="lg lh iq mw b gy ne nb l nc nd">const <strong class="mw ir">headers </strong>= { authorization: `Bearer ${graphcmsToken}` };<br/>const <strong class="mw ir">graphqlClient </strong>= new GraphQLClient(graphcmsEndpoint, { headers });</span></pre><p id="1339" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">一旦你在GraphCMS的交互式游戏中测试了一个查询，你就可以把它粘贴到你的web应用程序中并发出请求:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="a4b1" class="lg lh iq mw b gy na nb l nc nd">// Anywhere</span><span id="2bf6" class="lg lh iq mw b gy ne nb l nc nd">import { gql, GraphQLClient } from 'graphql-request';</span><span id="9f79" class="lg lh iq mw b gy ne nb l nc nd">let products: Product[] = [];</span><span id="a336" class="lg lh iq mw b gy ne nb l nc nd">const <strong class="mw ir">getProductsQuery </strong>= gql`{<br/>  products(where: { isAvailable: true }) {<br/>    rate<br/>    name<br/>  }<br/>}`;</span><span id="e808" class="lg lh iq mw b gy ne nb l nc nd">try {</span><span id="5f69" class="lg lh iq mw b gy ne nb l nc nd">const getProductsResponse: { products: Product[] } = await graphqlClient.request&lt;{ products: Product[] }&gt;(getProductsQuery);<br/>  products = getProductsResponse.products;</span><span id="9d89" class="lg lh iq mw b gy ne nb l nc nd">} catch { products = []; }</span></pre><p id="9bf9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">要转换图像内容，向查询中添加必要的转换，如下所示:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="a372" class="lg lh iq mw b gy na nb l nc nd">// Anywhere</span><span id="8be4" class="lg lh iq mw b gy ne nb l nc nd">import { gql } from 'graphql-request';</span><span id="8ad3" class="lg lh iq mw b gy ne nb l nc nd">let informationCards: InformationCard[] = [];</span><span id="dfb4" class="lg lh iq mw b gy ne nb l nc nd">const <strong class="mw ir">getInformationCardsQuery</strong>: string = gql`{<br/>  informationCards {<br/>    id<br/>    image {<br/>      url (<br/>        transformation: {<br/>          image: { resize: { fit: crop, height: 800, width: 800 } }<br/>        }<br/>      )<br/>    }<br/>  }<br/>}`;</span></pre><p id="74df" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">就是这样！你可以在我做的一个简单的农产品定价web应用上看到GraphCMS的运行，这个应用叫做sum ran:<a class="ae lf" href="https://sumran.in" rel="noopener ugc nofollow" target="_blank">https://sum ran . in</a>。因为我使用Next.js来预呈现内容，所以您不会看到客户端发出的请求。来源公开:<a class="ae lf" href="https://github.com/karmasakshi/sumran/" rel="noopener ugc nofollow" target="_blank">https://github.com/karmasakshi/sumran</a>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ni"><img src="../Images/51fc9a6a59aba6bbeecc0916449d3181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ETin8A86nYc_N7zE3lKAjA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">Sumran显示来自GraphCMS的动态内容</figcaption></figure></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><p id="ae6f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lt kh ki kj lx kl km kn ko ij bi translated">干杯！</p></div></div>    
</body>
</html>
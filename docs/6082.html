<html>
<head>
<title>WebAssembly with Golang by scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过scratch使用Golang进行web组装</h1>
<blockquote>原文：<a href="https://itnext.io/webassemply-with-golang-by-scratch-e05ec5230558?source=collection_archive---------1-----------------------#2021-08-11">https://itnext.io/webassemply-with-golang-by-scratch-e05ec5230558?source=collection_archive---------1-----------------------#2021-08-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5b6cc7eabf63fff3b94f57353a180b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxxJM6SO8e3-guE-geE0Aw.jpeg"/></div></div></figure><p id="80a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我想向您介绍WebAssembly。我们还将为WebAssembly和Go开发一个小应用程序。不仅仅是告诉“跑什么和怎么跑”以及它是如何工作的。而且允许用一个命令启动它，以减少开始学习WebAssembly的激动人心的旅程的时间。</p><p id="4e4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文的最后，您可以打开终端，用一个命令构建项目，并在浏览器中运行它。在那之后，你已经可以试验这个项目了。</p><h2 id="c54d" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">什么是WebAssembly (WASM)</h2><p id="b1e9" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">web assembly(WASM)-是一种开放标准(技术)，可以用可移植的二进制代码编译您的应用程序，并在web浏览器中执行。与JavaScript相比，它被设计用来在网页上实现高性能的应用程序。</p><p id="a723" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">WASM不是汇编程序，它是二进制字节码的文本表示。你还需要记住，WASM不仅仅是浏览器。浏览器内置虚拟机，用于执行Web组装。</p><p id="02aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从2017年开始，我们就经常听说。WebAssembly的首次亮相是在2017年3月。</p><p id="7db4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每个人都知道WebAssembly很快，并且首先(但不仅仅是)被设计成在浏览器中工作。有人甚至称WebAssembly为JavaScript杀手，或者至少是它的强劲竞争对手。</p><p id="5831" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其实你可以试着自己去检验一下WASM vs JS的表现——<a class="ae lu" href="https://takahirox.github.io/WebAssembly-benchmark/](https://takahirox.github.io/WebAssembly-benchmark/)" rel="noopener ugc nofollow" target="_blank">https://takahirox.github.io/WebAssembly-benchmark/</a></p><h2 id="c639" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">WebAssembly的应用(WASM)</h2><p id="cf8d" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">WebAssembly最初应该用在哪里？首先，在任务中直接在浏览器中处理重型任务。</p><ul class=""><li id="6436" class="lv lw iq ka b kb kc kf kg kj lx kn ly kr lz kv ma mb mc md bi translated">游戏开发</li><li id="dcf4" class="lv lw iq ka b kb me kf mf kj mg kn mh kr mi kv ma mb mc md bi translated">视频编辑/流媒体</li><li id="baba" class="lv lw iq ka b kb me kf mf kj mg kn mh kr mi kv ma mb mc md bi translated">加密</li><li id="ee98" class="lv lw iq ka b kb me kf mf kj mg kn mh kr mi kv ma mb mc md bi translated">图像识别</li></ul><p id="1da3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有很多应用程序、附带项目和用例都是用WebAssembly制作的——https://madewithwebassembly.com/<a class="ae lu" href="https://madewithwebassembly.com/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9fbb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中之一是TinyGo，如果你的目标是最小尺寸的话——https://madewithwebassembly.com/showcase/tinygo/、<a class="ae lu" href="https://tinygo.org/docs/guides/webassembly/" rel="noopener ugc nofollow" target="_blank">https://tinygo.org/docs/guides/webassembly/</a>。您可以将TinyGo + WebAssembly用于微控制器和现代web浏览器。</p><p id="0653" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，您可以在浏览器中运行TensorFlow，性能提升10倍(与普通JS相比)——<a class="ae lu" href="https://madewithwebassembly.com/showcase/tensorflow" rel="noopener ugc nofollow" target="_blank">https://madewithwebassembly.com/showcase/tensorflow</a></p><p id="500b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然还有用Unity + WebAssembly做一个浏览器的游戏——<a class="ae lu" href="https://madewithwebassembly.com/showcase/unity" rel="noopener ugc nofollow" target="_blank">https://madewithwebassembly.com/showcase/unity</a></p><p id="4e8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里你可以确保支持你的编程语言和web assembly—<a class="ae lu" href="https://github.com/appcypher/awesome-wasm-langs](https://github.com/appcypher/awesome-wasm-langs)" rel="noopener ugc nofollow" target="_blank">https://github.com/appcypher/awesome-wasm-langs</a></p><p id="f85e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，甚至有一个选项支持PHP(实际上是PIB)——【https://github.com/appcypher/awesome-wasm-langs#php】T2</p><h2 id="c1c7" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">创建我们的第一个Web组装项目(WASM) + Go</h2><p id="711a" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">让我们试着自己创建一个简单的项目来尝试WebAssembly。这可以在网上完成——https://webassembly.studio/<a class="ae lu" href="https://webassembly.studio/" rel="noopener ugc nofollow" target="_blank"/>。但事实上，这并不那么方便，也不允许你感觉这个代码是“你自己的”。</p><p id="f12d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，你需要安装Go。这可以根据本指令<a class="ae lu" href="https://golang.org/doc/install" rel="noopener ugc nofollow" target="_blank">https://golang.org/doc/install</a>来完成。</p><p id="7e47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第一部分中，我们将创建一个简单的golang包，并编译它以在浏览器中工作——我们将获得wasm文件“main.wasm”。第二部分将添加所有必要的东西，以便我们的main.wasm可以在浏览器中工作。</p><h1 id="61c4" class="mj kx iq bd ky mk ml mm lb mn mo mp le mq mr ms lh mt mu mv lk mw mx my ln mz bi translated">1.我们构建“main.wasm”。</h1><h2 id="2498" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">1.1使用新项目创建目录:</h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="4dc4" class="kw kx iq nf b gy nj nk l nl nm">mkdir example.com</span></pre><p id="1825" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">去吧</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="193e" class="kw kx iq nf b gy nj nk l nl nm">cd example.com</span></pre><p id="233c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">应用程序的主要代码，我们的域的代码将直接位于(业务逻辑)将在' main。走吧。让我们创建它:</p><p id="63a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">mkdir app &amp;&amp;触摸app/main.go</p><h2 id="a235" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">1.2让我们用内容填充我们的应用程序</h2><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/2ea5b6133e28c8845a4cacd2d93189bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJk4ASkkf8SMbqtT2-f82A.png"/></div></div></figure><h2 id="99d7" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">1.3现在是时候构建我们的应用程序了</h2><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/a85cf6dea8ca94825fefcdd4257c17b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRwUWzFI52OvDsYRzeqPbw.png"/></div></div></figure><p id="61ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个命令将把我们的go应用程序编译到主文件中。wasm(带有wasm字节码)是一个web程序集的可执行模块。请注意，您的golang包必须是“主包”。</p><h1 id="d1c1" class="mj kx iq bd ky mk ml mm lb mn mo mp le mq mr ms lh mt mu mv lk mw mx my ln mz bi translated">2.在浏览器中工作抛出JavaScript库(只有一个文件)。</h1><h2 id="e3a2" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">2.1在我们项目的根目录中，我们将复制wasm_exec.js</h2><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/d7c25abafefdf1a798b5eac0c2dd8518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MUhnzPuVk7-KHiHrA7-e6w.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk translated">复制Web程序集的支持js</figcaption></figure><p id="076c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其实你的电脑上已经有wasm_exec.js了。这个命令只是将它从Go源代码复制到我们的项目中。</p><h2 id="a34c" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">2.2你还需要一台网络服务器。</h2><p id="7520" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">让我们在移动中创建一个简单的web服务器。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/b648ff1c4bfbca47c1e0b33ff5d598c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJ66tfO1Y_0d7duCMGlU5w.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk translated">移动中的简单web服务器</figcaption></figure><h2 id="efc6" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">2.3不要忘记创建一个包含对Web程序集的应用程序调用的HTML页面。</h2><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/3595a8a6705e1159fc898dbc69a74241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bA9DuCzjWfcxXacg796NAw.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk translated">HTML页上的Web程序集</figcaption></figure><p id="f60b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这不是乏味的，你设法一步一步地做每件事。因此，您应该能够:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="f31d" class="kw kx iq nf b gy nj nk l nl nm">.<br/>└── example.com<br/>    ├── app<br/>    │   └── main.go<br/>    ├── index.html<br/>    ├── main.wasm<br/>    ├── server.go<br/>    └── wasm_exec.js</span></pre><p id="c7aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里'<a class="ae lu" href="http://example.com" rel="noopener ugc nofollow" target="_blank">example.com</a>'—项目的名称。你可以称之为‘我的_牛逼_项目’。</p><h2 id="6bef" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">2.4之后，我们启动服务器</h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="533b" class="kw kx iq nf b gy nj nk l nl nm">go run server.go</span></pre><p id="de05" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并在浏览器中打开该地址</p><blockquote class="nw nx ny"><p id="528f" class="jy jz nz ka b kb kc kd ke kf kg kh ki oa kk kl km ob ko kp kq oc ks kt ku kv ij bi translated"><a class="ae lu" href="http://127.0.0.1:8080" rel="noopener ugc nofollow" target="_blank"><em class="iq">http://127 . 0 . 0 . 1:8080</em></a></p></blockquote><p id="e8ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在“DevTools &gt;控制台”中，您可以看到输出:</p><blockquote class="nw nx ny"><p id="4941" class="jy jz nz ka b kb kc kd ke kf kg kh ki oa kk kl km ob ko kp kq oc ks kt ku kv ij bi translated"><em class="iq">您好，用户</em></p></blockquote><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/7efd4d3a0388e98524a582fcb65c3010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*ViTWLepQWvFH5qBs_8z3VA.png"/></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk translated">Web组件在web浏览器中的应用</figcaption></figure><h1 id="561b" class="mj kx iq bd ky mk ml mm lb mn mo mp le mq mr ms lh mt mu mv lk mw mx my ln mz bi translated">多合一</h1><p id="a0e7" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">此外，您可以在一个命令中运行所有这些</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="9224" class="kw kx iq nf b gy nj nk l nl nm">wget -qO - https://gist.githubusercontent.com/romanitalian/cd28becfb130506d5f65ea48d8780ba9/raw/wasm_init.sh | bash /dev/stdin example.com</span></pre><p id="08fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="a7b6" class="kw kx iq nf b gy nj nk l nl nm">wget -qO - https://bit.ly/3lVlO1i | bash /dev/stdin example.com</span></pre><p id="97a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个命令下载bash脚本，并以一种简单的方式从头开始创建您的项目。</p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="c3be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于2021年，我们可以说WebAssembly还没有在JavaScript之上“起飞”。但是很受欢迎。而且以后，你肯定会需要的。</p></div></div>    
</body>
</html>
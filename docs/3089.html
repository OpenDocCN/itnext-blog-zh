<html>
<head>
<title>What is the GitHub deployments API?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是GitHub部署API？</h1>
<blockquote>原文：<a href="https://itnext.io/what-is-the-github-deployments-api-638ce3088ed2?source=collection_archive---------3-----------------------#2019-10-01">https://itnext.io/what-is-the-github-deployments-api-638ce3088ed2?source=collection_archive---------3-----------------------#2019-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c82c6b14289631a3d514f1b6b0fd3eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cj8DKu1s-s3t-ouIOTsVcA.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="01ed" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">一个鲜为人知的工具，它可以将你的代码装载到GitHub中。</h2></div><p id="7bf9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="lp">这是关于构建</em><a class="ae lq" href="http://deliverybot.github.io/" rel="noopener ugc nofollow" target="_blank"><em class="lp">delivery bot</em></a><em class="lp">的系列帖子的一部分，这是一个在GitHub上实现简单部署自动化的部署工具。</em></p><p id="7375" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">大约一年前，我在GitHub中发现了一个有趣的特性，叫做部署api。它看起来有点像GitHub文档中丢失的部分，与其他组件断开连接，不像GitHub中的几乎所有东西，我真的没有使用过它。在过去一个月左右的时间里，我花了一些时间研究部署API，并希望为那些已经接触到它并想知道它是什么的人解释这一点。</p><p id="6b95" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">GitHub部署API实际上是一个用于<strong class="kv jf">触发</strong>部署的解耦API。GitHub不会尝试并实际为我们部署代码，它只是给我们一个事件，让我们自己的系统响应并实际部署代码。</p><p id="f13c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">工作流程似乎相对简单:</p><ul class=""><li id="fbee" class="lr ls je kv b kw kx kz la lc lt lg lu lk lv lo lw lx ly lz bi translated">GitHub用一些有效载荷开始部署事件。</li><li id="f905" class="lr ls je kv b kw ma kz mb lc mc lg md lk me lo lw lx ly lz bi translated">我的系统从GitHub接收一个事件，并运行实际的部署。</li></ul><p id="36af" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">当我发现这一点时，我觉得这很酷。我可以用更现代、更API驱动的东西取代我的Jenkins管道。此外，它通过使用GitHub作为所有需要发生的自动化的真实来源，将工具彼此解耦。推送事件决定何时构建我的代码，部署事件决定何时部署我的代码。</p><p id="62cd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">GitHub还增加了一些新的用户界面，为特定的拉取请求提供了一幅部署图:</p><figure class="mg mh mi mj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mf"><img src="../Images/ab567969f7f1fc422bb88c7a886bf324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ridTijg0ADBaF74zQs9EsA.png"/></div></div></figure><p id="55d8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们还可以通过访问项目上的“环境”选项卡来查看所有环境的部署列表:</p><figure class="mg mh mi mj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mk"><img src="../Images/b21c7f0849c5f5210963915d6e6de0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lNvo8KfH2Y6cgESST2zN1Q.png"/></div></div></figure><h2 id="d700" class="ml mm je bd mn mo mp dn mq mr ms dp mt lc mu mv mw lg mx my mz lk na nb nc nd bi translated">完成图片</h2><p id="96df" class="pw-post-body-paragraph kt ku je kv b kw ne kf ky kz nf ki lb lc ng le lf lg nh li lj lk ni lm ln lo im bi translated">到目前为止一切顺利。然而，当我去连接我的集成时，我意识到这个故事缺少了一部分。GitHub部署API的工作流程大致如下图所示。</p><figure class="mg mh mi mj gt iv"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="6bfe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这意味着部署的情况如下:</p><ol class=""><li id="5d1a" class="lr ls je kv b kw kx kz la lc lt lg lu lk lv lo nl lx ly lz bi translated"><em class="lp">工具调用GitHub API来说“部署这个提交”</em></li><li id="e8b0" class="lr ls je kv b kw ma kz mb lc mc lg md lk me lo nl lx ly lz bi translated">GitHub向采取行动部署提交的系统触发webhooks。</li><li id="8b73" class="lr ls je kv b kw ma kz mb lc mc lg md lk me lo nl lx ly lz bi translated">当这个系统接收到webhook时，您的代码就被部署了。</li></ol><p id="3cc6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">第三步，我们可以使用GitHub动作，或者我们甚至可以启动一个lambda函数来监听http事件，以部署我们的代码。第二步全部由GitHub处理。这个故事的第一步就是这个问题。我们还没有一个标准化的工具包来调用这个API。</p><p id="a6b6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我马上想到我在这里想要的几样东西:</p><ol class=""><li id="af71" class="lr ls je kv b kw kx kz la lc lt lg lu lk lv lo nl lx ly lz bi translated">我想要一种在分支上发生推送事件时自动触发该API的方法。</li><li id="cc03" class="lr ls je kv b kw ma kz mb lc mc lg md lk me lo nl lx ly lz bi translated">我想从Slack (ChatOps)使用酷斜线命令部署的方式。</li><li id="819f" class="lr ls je kv b kw ma kz mb lc mc lg md lk me lo nl lx ly lz bi translated">我想在拉取请求中使用这些来部署短暂的环境。</li></ol><p id="bc5f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">还有机会在此基础上构建高级工作流。我们可以要求在进行部署之前通过某些状态检查。我们还可以监听部署成功事件，以触发对不同环境的其他部署。拥有一个API甚至驱动平台给了我们很大的权力和自由。</p><h2 id="64a8" class="ml mm je bd mn mo mp dn mq mr ms dp mt lc mu mv mw lg mx my mz lk na nb nc nd bi translated">什么是<a class="ae lq" href="https://deliverybot.dev" rel="noopener ugc nofollow" target="_blank"> Deliverybot </a>？</h2><p id="d3f6" class="pw-post-body-paragraph kt ku je kv b kw ne kf ky kz nf ki lb lc ng le lf lg nh li lj lk ni lm ln lo im bi translated">在研究所有这些工具时，我想要一个GitHub应用程序来填补这些空白。送货机器人是这些差距的答案。它允许您简单地点击commit并触发部署事件，让GitHub操作或您自己的工具处理事件并实际执行部署。试试看，让我知道你的想法！</p><p id="f71f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="lp">感谢您的阅读，敬请关注更多关于部署和开发运维的精彩文章。在twitter上关注我</em><a class="ae lq" href="https://twitter.com/@colinjfw" rel="noopener ugc nofollow" target="_blank"><em class="lp">@ colinjfw</em></a><em class="lp">。</em></p></div></div>    
</body>
</html>
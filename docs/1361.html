<html>
<head>
<title>Unleash the hidden superpowers of react-intl (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">释放react-intl隐藏的超能力(第2部分)</h1>
<blockquote>原文：<a href="https://itnext.io/unleash-the-hidden-superpowers-of-react-intl-part-2-b9b3d9fa4188?source=collection_archive---------2-----------------------#2018-09-24">https://itnext.io/unleash-the-hidden-superpowers-of-react-intl-part-2-b9b3d9fa4188?source=collection_archive---------2-----------------------#2018-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="1ed7" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">第2部分:使用react-intl让react.js应用程序为本地化做好准备</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/38d66b12887e6ba6763ea368183ef64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ds-vry9icWK4-nnAN0R8ow.png"/></div></div></figure><p id="3d33" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">在第一部分中，您学习了如何使用babel宏来改进您的标记。</p><p id="b9af" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">你可以在这里找到这个系列的第一部分:<a class="ae lv" href="https://medium.com/@jamuhl/unleash-the-hidden-superpowers-of-react-intl-part-1-d6f99a32ef84" rel="noopener">https://medium . com/@ jamuhl/unleash-the-hidden-super powers-of-react-intl-part-1-d6f 99 a 32 ef 84</a></p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi md"><img src="../Images/0441acdb8fcaea77ab79104f5d6e643e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNNz5zpOmTkRhQQvSXN3eQ.png"/></div></div></figure><p id="a206" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="kz ir">在这一部分</strong>采用了<a class="ae lv" href="https://github.com/locize/locize-react-intl-example" rel="noopener ugc nofollow" target="_blank">演示项目</a>的所有功能后，您将能够:</p><ul class=""><li id="b5db" class="me mf iq kz b la lb le lf li mg lm mh lq mi lu mj mk ml mm bi translated">将翻译分成多个文件</li><li id="cdcb" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">使用上下文编辑器</li><li id="4f0c" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">从CDN加载翻译</li><li id="3a3b" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">检测用户语言</li><li id="30b9" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">自动将缺少的新字符串添加到翻译项目中</li><li id="92ec" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">更新参考语言中已更改的字符串</li><li id="3a10" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">将描述提交给翻译上下文</li><li id="8073" class="me mf iq kz b la mn le mo li mp lm mq lq mr lu mj mk ml mm bi translated">设置上次使用的信息，以便您可以安全地删除不再使用的密钥</li></ul><h2 id="f6c8" class="ms jo iq bd jp mt mu dn jt mv mw dp jx li mx my kb lm mz na kf lq nb nc kj nd bi translated">从国际化到本土化</h2><p id="9f31" class="pw-post-body-paragraph kx ky iq kz b la ne lc ld le nf lg lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">虽然第一部分的重点是帮助开发人员编写更好的jsx标记，但现在我们将把重点放在通过简化翻译人员的工作来帮助他们。在我们这个快节奏的时代，最重要的事情之一是实现快速反馈循环，这也是所有常见的“敏捷”方法所推荐的。</p><p id="17c0" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">所以让我们更进一步:</p><h2 id="c392" class="ms jo iq bd jp mt mu dn jt mv mw dp jx li mx my kb lm mz na kf lq nb nc kj nd bi translated">从国际化到持续本地化</h2><p id="75f1" class="pw-post-body-paragraph kx ky iq kz b la ne lc ld le nf lg lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">我们喜欢创新本地化流程，打破导出提取的翻译、将其传递给翻译人员并再次导入的缓慢循环。这种旧的过程不适合使用持续开发和敏捷方法的现代开发环境。</p><p id="6f10" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="kz ir">我们想要的:</strong>您的应用程序中的新内容应该立即在您的翻译管理工具中为您的翻译人员提供，新完成的翻译应该传递给应用程序，而无需开发人员向存储库添加文件或从翻译管理部门接受PR。</p><h2 id="c83f" class="ms jo iq bd jp mt mu dn jt mv mw dp jx li mx my kb lm mz na kf lq nb nc kj nd bi translated">将您的应用程序连接到翻译管理</h2><p id="0448" class="pw-post-body-paragraph kx ky iq kz b la ne lc ld le nf lg lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">在此示例中，我们将使用<a class="ae lv" href="https://locize.com" rel="noopener ugc nofollow" target="_blank">https://locize.com</a>作为我们的翻译管理工具，因为它公开了将本地化提升到持续本地化水平所需的所有功能。</p><p id="3921" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">有一个locizer脚本可以将您的应用程序与翻译项目连接起来:<a class="ae lv" href="https://github.com/locize/locizer" rel="noopener ugc nofollow" target="_blank">https://github.com/locize/locizer</a></p><p id="a9ed" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">使用它，您可以加载翻译文件，保存或更新翻译片段。</p><p id="987a" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="kz ir">步骤1:我们需要一种在开发过程中扩展react-intl组件的方法</strong></p><p id="5da9" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这应该相当容易:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="5083" class="ms jo iq nk b gy no np l nq nr">import { FormattedMessage as FM } from 'react-intl';</span><span id="e5ec" class="ms jo iq nk b gy ns np l nq nr">// find out if our react app runs in dev mode<br/>const IS_DEV = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';</span><span id="0401" class="ms jo iq nk b gy ns np l nq nr">// export a extended replacer component while development and original while in production<br/>export const FormattedMessage = IS_DEV ? <strong class="nk ir">supportLocize()</strong>(FM) : FM;</span></pre><p id="072e" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">现在让我们了解一下<code class="fe nt nu nv nk b">supportLocize()</code>是什么:</p><p id="86a6" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="kz ir">步骤2:让组件向翻译服务发送新内容</strong></p><p id="0319" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">在我们的代码中，我们像在常规的react-intl项目中一样使用<code class="fe nt nu nv nk b">FormattedMessages</code>,但是我们在开发过程中使用被覆盖的组件:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="fe71" class="ms jo iq nk b gy no np l nq nr">// see ./locize/index.js in development mode the<br/>// react-intl components are extended to provide<br/>// features like save of new ids, ...<br/>// in production you get the regular unextended<br/>// react-intl components<br/>import { FormattedMessage } from 'locize';</span><span id="ad64" class="ms jo iq nk b gy ns np l nq nr">&lt;FormattedMessage<br/>  id="app.title"<br/>  defaultMessage="Welcome to {what} combined with locize"<br/>  description="Welcome header on app main page"<br/>  values={{ what: 'react-intl' }}<br/>/&gt;</span></pre><p id="649c" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们的扩展组件将获取这些道具，并使用<em class="nw"> id </em>和<em class="nw"> defaultMessage </em>在locize上创建新的翻译片段</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="5643" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">基于翻译目录中是否已经存在默认消息，或者默认消息已经改变，我们使用locizer函数来创建或更新源语言的翻译段。</p><p id="ed0b" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">太棒了，现在每当我们添加一个新的<code class="fe nt nu nv nk b">FormattedMessage</code>或改变一个<code class="fe nt nu nv nk b">defaultMessage</code>时，那些值会立即在你的翻译项目中被添加或改变。</p><p id="08d1" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="kz ir">第三步:直接加载翻译</strong></p><p id="1c98" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">通过覆盖<code class="fe nt nu nv nk b">IntlProvider</code>，我们可以使用locizer脚本直接加载发布到由<a class="ae lv" href="https://locize.com" rel="noopener ugc nofollow" target="_blank"> locize </a>提供的本地化CDN的翻译。</p><p id="99d4" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">该组件主要做的是获取一个适当的名称空间来加载翻译文件和所需的intl语言环境数据:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="c1af" class="ms jo iq nk b gy no np l nq nr">// load the given file form locize<br/>// and detect language while doing so<br/>locizer.load(namespace, (err, messages, locale) =&gt; {<br/>  currentLocale = locale;<br/>  translations[locale] = messages;</span><span id="130b" class="ms jo iq nk b gy ns np l nq nr">// load react intl locale data<br/>  import('react-intl/locale-data/' + locale)<br/>    .then(localeData =&gt; {<br/>      addLocaleData(localeData);</span><span id="646a" class="ms jo iq nk b gy ns np l nq nr"><strong class="nk ir">// update state to render children</strong><br/>      this.setState({<br/>        locale,<br/>        messages<br/>      });<br/>    });<br/>  });<br/>}</span></pre><p id="7b6f" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">完整的代码非常简单你可以在这里找到演示库:<a class="ae lv" href="https://github.com/locize/locize-react-intl-example/blob/master/src/locize/index.js#L32" rel="noopener ugc nofollow" target="_blank">https://github . com/locize/locize-react-intl-example/blob/master/src/locize/index . js # L32</a></p><p id="edd5" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">因此，这不仅使我们能够加载一个翻译目录，而且通过使用该IntlProvider，我们可以加载多个文件，并通过将它们分成多个更小的文件来简化翻译。</p><p id="f1f8" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="kz ir">步骤4:在应用程序的上下文中启用翻译</strong></p><p id="b47f" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">还有“一件事”(我的意思是，<a class="ae lv" href="https://github.com/locize/locize-editor" rel="noopener ugc nofollow" target="_blank">多一个脚本</a>)可以从locize中使用，它使您能够将翻译编辑器集成到您的应用程序中。通过这种方式，翻译人员可以点击您网站上的任何内容，并直接在您的应用程序环境中进行翻译。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi md"><img src="../Images/0441acdb8fcaea77ab79104f5d6e643e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNNz5zpOmTkRhQQvSXN3eQ.png"/></div></div></figure><p id="5b78" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">locize编辑器的集成非常简单:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="c400" class="ms jo iq nk b gy no np l nq nr">locizeEditor.init({<br/>  lng: locale,<br/>  defaultNS: DEFAULTNAMESPACE,<br/>  referenceLng: REFERENCELANGUAGE,<br/>  projectId: PROJECTID,<br/>  private: PRIVATE<br/>});</span></pre><p id="8e1c" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">现在，您可以打开添加了querystring参数<code class="fe nt nu nv nk b">?locize=true</code>的网站，您将看到上下文编辑器。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="b72d" class="jn jo iq bd jp jq nz js jt ju oa jw jx jy ob ka kb kc oc ke kf kg od ki kj kk bi translated">摘要</h1><p id="bbcf" class="pw-post-body-paragraph kx ky iq kz b la ne lc ld le nf lg lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">你看，国际化很容易，本地化也不难。使用正确的工具，您不仅可以缩短开发-翻译周期，还可以提高质量，节省时间和金钱。</p><p id="f774" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">你可以在这里找到完整的样本:【https://github.com/locize/locize-react-intl-example T2】</p><p id="216b" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">抓住机会，亲自体验一下locize.com<a class="ae lv" href="https://locize.com" rel="noopener ugc nofollow" target="_blank">的14天免费试用期。</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to control and record voice calls with Node.js serverless functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js无服务器函数控制和记录语音通话</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-control-and-record-voice-calls-with-node-js-serverless-functions-76b530f44d56?source=collection_archive---------9-----------------------#2019-05-20">https://itnext.io/how-to-control-and-record-voice-calls-with-node-js-serverless-functions-76b530f44d56?source=collection_archive---------9-----------------------#2019-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="940b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有很多方法可以和你的朋友和家人交流。你可能会使用传统的短信、Whatsapp、电子邮件，当然还有电话。最近，我遇到了一种令人惊讶的新的交流方式。这一切都始于我的朋友米凯拉在推特上问了一个问题。</p><blockquote class="km kn ko"><p id="c604" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">有没有可能从Twilio的语音通话中生成一个RSS提要？</em></p></blockquote><p id="f8d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">她在寻找的是一种将电话转换成引用电话录音的RSS提要的方法。为什么？因为她听很多播客，通过Whatsapp给她的一个朋友发很长的语音信息。由于这些消息通常不需要及时回复，他们都更喜欢所有的语音消息出现在他们的播客中，而不是Whatsapp。</p><p id="ccc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我给你介绍一下<a class="ae kl" href="https://podbot.netlify.com" rel="noopener ugc nofollow" target="_blank">“播客机器人——来自你朋友的惊喜播客”</a>的创意。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/85e4563a959f94b6a17fe29800043172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2U1Ne1VqUSGY8l8-.jpg"/></div></div></figure><p id="1d65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个想法是这样的:要发布一个新的播客剧集，你所要做的就是打个电话。不需要麦克风设置，也不需要录制、存储或上传音频文件到播客平台。</p><h1 id="280a" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">语音呼叫驱动的播客网站的要求</h1><p id="e16d" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">要创建一个电话驱动的播客网站，你需要几样东西。</p><p id="7ad7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您需要一个可以编程控制的电话号码。幸运的是，<a class="ae kl" href="https://www.twilio.com/voice" rel="noopener ugc nofollow" target="_blank"> Twilio Voice </a>提供了这一功能。</p><p id="49a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，您需要一种方法来存储信息和传入电话的转录。<a class="ae kl" href="https://www.youtube.com/watch?v=UGN6EUi4Yio" rel="noopener ugc nofollow" target="_blank"> Google sheets </a>或云数据库可以与Node.js一起使用，因此可以提供用于<a class="ae kl" href="https://www.twilio.com/functions" rel="noopener ugc nofollow" target="_blank"> Twilio无服务器功能</a>的快速数据存储。</p><p id="aeb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，你需要一个网站托管者来为你的播客网站提供服务。</p><p id="f675" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">配置可编程语音通话、下载音频文件和建立一个包含所有信息的网站是一项繁重的工作。这就是为什么我们将构建<em class="kp"> PodBot </em>及其所有任务分成几个教程的原因。</p><p id="92b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这第一个教程中，我们将使用Twilio serverless函数来接受和管理电话呼叫、录音和语音转录。在后面的教程中，我们将扩展函数以写入数据存储，并且我们将使用这些数据通过<a class="ae kl" href="https://www.gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>构建播客站点，包括强制RSS播客提要。听起来不错吧？那么，让我们开始编写函数吧！🎉</p><p id="c79f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是你今天需要的:</p><ul class=""><li id="2381" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">购买电话号码和接听电话的Twilio帐户</li><li id="5e65" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">已安装Node.js和npm</li></ul><h1 id="55e9" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">功能驱动的语音呼叫救援</h1><p id="201a" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">为了定义当有人拨打Twilio电话号码时会发生什么，您必须以基于XML的格式提供一些配置，称为<a class="ae kl" href="https://www.twilio.com/docs/glossary/what-is-twilio-markup-language-twiml" rel="noopener ugc nofollow" target="_blank"> TwiML </a>。Twilio API会在有呼叫时立即请求这个配置。您可以通过<a class="ae kl" href="https://www.twilio.com/blog/2017/11/twiml-bins-a-serverless-and-codeless-way-to-try-twilio.html" rel="noopener ugc nofollow" target="_blank">TwiML bin</a>提供TwiML，通过webhooks或无服务器功能提供您定制的应用程序。</p><p id="8b55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们实现这个功能之前，让我们回顾并思考一下我们需要构建什么。当有人呼叫<em class="kp"> PodBot </em>时，我们需要收集以下事件信息:</p><ul class=""><li id="ff61" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">标题</li><li id="40b3" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">录制URL</li><li id="606f" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">插曲转录</li></ul><p id="d5bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，Twilio提供了检索所有呼叫信息的方法。下面你会看到TwiML配置来请求剧集标题，录制它并获得录制内容的副本。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/38dca7f4b8bb7a08c1e17637b1bc1126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Li07rxDtu_wKcmhe.jpg"/></div></div></figure><p id="801c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们来详细说说；当有人呼叫您的Twilio号码时(步骤1)，Twilio会向您定义的无服务器函数询问一些TwiML配置(步骤2)。响应的TwiML定义询问剧集的标题并记录答案(步骤3)。关于完整记录的信息应该被发送到一个<code class="fe mw mx my mz b">/call-exit/</code>端点。<code class="fe mw mx my mz b">/call-exit/</code>的响应将通过使用更多的TwiML来控制接下来发生的事情。最初的TwiML还指定生成的抄本应该发送给<code class="fe mw mx my mz b">/transcribe-title/</code>。</p><p id="4804" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Twilio收到这个初始的TwiML配置后，PodBot对呼叫者说“告诉我你的剧集的标题。”(第四步)。然后，它等待并记录答案，直到五秒钟的沉默过去。魔法？神奇！</p><p id="fa6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像上面这样的TwiML配置可以链接在一起。此选项可让您询问剧集标题并进行录制，然后采取另一个动作来结束通话或录制更多数据，如剧集本身。</p><p id="672c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在一个新项目中设置呼叫处理。🎉</p><p id="8727" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了使本教程简洁明了，我们将只录制和转录剧集标题。您可以在本文末尾找到一个解决方案，您可以根据自己的需要进行调整，并在本地快速运行。</p><h1 id="bb0b" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">无服务器功能的创建</h1><p id="3a69" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">为这个项目创建一个新目录，同时在<code class="fe mw mx my mz b">functions</code>目录下创建三个JavaScript文件:<code class="fe mw mx my mz b">call-enter.js</code>、<code class="fe mw mx my mz b">transcribe-title.js</code>和<code class="fe mw mx my mz b">call-exit.js</code>。</p><pre class="ku kv kw kx gt na mz nb nc aw nd bi"><span id="6ceb" class="ne lg iq mz b gy nf ng l nh ni">$ mkdir podbot-functions <br/>$ cd podbot-functions <br/>$ mkdir functions <br/>$ touch functions/call-enter.js functions/transcribe-title.js functions/call-exit.js</span></pre><p id="ebaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些JavaScript文件中的每一个都代表一个HTTP端点。当Twilio API请求配置时，这些端点必须用TwiML进行响应。要构建TwiML响应，可以使用Twilio函数中全局可用的<a class="ae kl" href="https://www.npmjs.com/package/twilio-js" rel="noopener ugc nofollow" target="_blank"> Twilio JS客户端</a>。</p><h1 id="d688" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">电话呼叫的无服务器入口点</h1><p id="3daa" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated"><code class="fe mw mx my mz b">call-enter.js</code>是某人呼叫您的号码时Twilio请求的第一个端点。</p><pre class="ku kv kw kx gt na mz nb nc aw nd bi"><span id="65cf" class="ne lg iq mz b gy nf ng l nh ni">// File: /functions/call-enter.js<br/>'use strict';<br/><br/>exports.handler = function(context, event, callback) {<br/> let response = new Twilio.twiml.VoiceResponse();<br/><br/> // documentation for say<br/> // -&gt; https://www.twilio.com/docs/voice/twiml/say<br/> response.say(<br/>   { voice: 'woman', language: 'en-US' },<br/>   'Welcome to PodBot. Tell me the title of your episode.'<br/> );<br/><br/> // documentation for record<br/> // -&gt; https://www.twilio.com/docs/voice/twiml/record<br/> response.record({<br/>   action: '/call-exit',<br/>   timeout: '5',<br/>   transcribe: 'true',<br/>   transcribeCallback: '/transcribe-title'<br/> });<br/><br/> callback(null, response);<br/>};</span></pre><p id="18cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面定义的无服务器功能将用<code class="fe mw mx my mz b"><a class="ae kl" href="https://www.twilio.com/docs/runtime/functions/invocation#handler-arguments" rel="noopener ugc nofollow" target="_blank">context</a></code><a class="ae kl" href="https://www.twilio.com/docs/runtime/functions/invocation#handler-arguments" rel="noopener ugc nofollow" target="_blank"/><code class="fe mw mx my mz b"><a class="ae kl" href="https://www.twilio.com/docs/runtime/functions/invocation#handler-arguments" rel="noopener ugc nofollow" target="_blank">event</a></code><a class="ae kl" href="https://www.twilio.com/docs/runtime/functions/invocation#handler-arguments" rel="noopener ugc nofollow" target="_blank">和一个</a> <code class="fe mw mx my mz b"><a class="ae kl" href="https://www.twilio.com/docs/runtime/functions/invocation#handler-arguments" rel="noopener ugc nofollow" target="_blank">callback</a></code>来调用<a class="ae kl" href="https://www.twilio.com/docs/runtime/functions/invocation#handler-arguments" rel="noopener ugc nofollow" target="_blank">。<code class="fe mw mx my mz b">context</code>对象提供关于当前执行环境的信息，<code class="fe mw mx my mz b">event</code>包含传递给函数的请求参数，您可以使用<code class="fe mw mx my mz b">callback</code>来响应请求。</a></p><p id="d160" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过将<code class="fe mw mx my mz b">null</code>作为第一个参数来调用<code class="fe mw mx my mz b">callback</code>，您发出了没有错误的信号。第二个参数是一个<code class="fe mw mx my mz b">VoiceResponse</code>，您可以使用全局<code class="fe mw mx my mz b">Twilio</code>对象来创建它。</p><p id="e93c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过定义<code class="fe mw mx my mz b">Record</code>动词及其包含的<code class="fe mw mx my mz b">action</code>属性，第二个端点将在调用者静默五秒钟后被调用。</p><p id="06fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，<code class="fe mw mx my mz b">transcribeCallback</code>定义了端点，以便在转录就绪时检索转录。</p><h1 id="aa5d" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">记录录音并说再见</h1><p id="b3a3" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">在呼叫者给出剧集名称并保持沉默5秒钟后，下一个端点(<code class="fe mw mx my mz b">/call-exit/</code>)被呼叫以请求附加配置并继续电话呼叫。</p><pre class="ku kv kw kx gt na mz nb nc aw nd bi"><span id="1273" class="ne lg iq mz b gy nf ng l nh ni">// File: /functions/call-exit.js<br/>'use strict';<br/><br/>exports.handler = function(context, event, callback) {<br/> // do something with the data here<br/> console.log(event.CallSid, event.RecordingUrl);<br/> // CallSid: ‘CA3ac5f19...’<br/> // RecordingUrl: ‘https://api.twilio.com/2010-04-01/Accounts/ACa3.../Recordings/RE92...’<br/><br/> const response = new Twilio.twiml.VoiceResponse();<br/><br/> // documentation for say<br/> // -&gt; https://www.twilio.com/docs/voice/twiml/say<br/> response.say({ voice: 'woman', language: 'en-US' }, 'Thanks');<br/><br/> callback(null, response);<br/>};</span></pre><p id="d982" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面你看到了在无服务器功能中记录电话呼叫的第一个重要部分。使用<code class="fe mw mx my mz b">event</code>对象，您可以访问请求中包含的数据Twilio。<code class="fe mw mx my mz b">CallSid</code>是电话呼叫的唯一标识符。该标识符在三种功能的电话呼叫中保持不变。</p><p id="58d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">录制URL也是可访问的。要请求MP3格式的录音，将<code class="fe mw mx my mz b">.mp3</code>添加到<code class="fe mw mx my mz b">event</code>对象的<code class="fe mw mx my mz b">RecordingUrl</code>属性中。</p><p id="31cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在这个函数只记录信息，但是有了<code class="fe mw mx my mz b">CallSid</code>和<code class="fe mw mx my mz b">RecordingUrl</code>你可以将这些数据存储在数据库或其他存储器中。</p><p id="1ebe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要结束通话，请配置<code class="fe mw mx my mz b">VoiceResponse</code>说“谢谢”。</p><h1 id="e575" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">文字记录</h1><p id="2219" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">你需要的最后一个函数是<code class="fe mw mx my mz b">transcribe-title.js</code>。端点的唯一工作是记录剧集标题的抄本。它不必提供任何额外的配置。用<code class="fe mw mx my mz b">null</code>调用<code class="fe mw mx my mz b">callback</code>,表示没有错误，可以开始了。</p><pre class="ku kv kw kx gt na mz nb nc aw nd bi"><span id="501c" class="ne lg iq mz b gy nf ng l nh ni">// File: /functions/transcribe-title.js<br/>'use strict';<br/><br/>exports.handler = function(context, event, callback) {<br/> // do something with the data here<br/> console.log(event.CallSid, event.TranscriptionText);<br/> // CallSid: ‘CA3ac5f19...’<br/> // RecordingUrl: “Hello everybody I hope...”<br/><br/> callback(null);<br/>};</span></pre><p id="0a97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，您已经有了三个端点，它们可以接受和控制Twilio语音消息，并记录录音URL和抄本。有了这个设置，是时候用你的第一个电话来测试这些了。</p><h1 id="2e00" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">在本地运行Twilio函数</h1><p id="0da6" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">要在本地运行Twilio函数，您可以使用<a class="ae kl" href="https://www.npmjs.com/package/twilio-run" rel="noopener ugc nofollow" target="_blank"> twilio-run </a>。您可以将该工具安装到您的项目中，但是由于最近的npm版本附带了<a class="ae kl" href="https://www.npmjs.com/package/npx" rel="noopener ugc nofollow" target="_blank"> npx </a>，您所要做的就是在项目目录的根目录下运行一个命令。</p><p id="d9ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您的环境中没有<code class="fe mw mx my mz b">npm-run</code>，这个命令会下载并运行它。<code class="fe mw mx my mz b">twilio-run</code>查找您已经准备好的<code class="fe mw mx my mz b">functions</code>目录。<code class="fe mw mx my mz b">--live</code>标志确保当本地服务器启动时函数不会被缓存。此标志允许您编写函数，而不需要重新启动命令。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/2fdd7d3978961739efe2719c92fade06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tlRwfMbbB9FX8O8n.jpg"/></div></div></figure><p id="22d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行该命令后，本地服务器将启动来调试和测试您的功能。不幸的是，您的本地主机无法在互联网上访问。这就是为什么<code class="fe mw mx my mz b">twilio-run</code>有另一个漂亮的配置。如果您使用<code class="fe mw mx my mz b">--ngrok</code>标志运行它，它会自动旋转一个公开可用的URL，将所有请求通过隧道发送到您的本地机器。</p><pre class="ku kv kw kx gt na mz nb nc aw nd bi"><span id="06e7" class="ne lg iq mz b gy nf ng l nh ni">$ npx twilio-run --live --ngrok</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/6a7bef349a25cee9728c28f3c9722653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RmSK9OPwX3rRLbhR.jpg"/></div></div></figure><p id="8506" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">提供的URL是您最终设置呼叫处理所需要的。</p><h1 id="67a1" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">将您的Twilio号码与无服务器功能连接</h1><p id="fd17" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">购买号码<a class="ae kl" href="https://support.twilio.com/hc/en-us/articles/223135247-How-to-Search-for-and-Buy-a-Twilio-Phone-Number-from-Console" rel="noopener ugc nofollow" target="_blank">后，你可以设置它在有电话打进来时使用本地功能。在特定号码的配置页面上，您可以找到来电设置。为来电选择webhook选项，并复制/粘贴<code class="fe mw mx my mz b">/call-enter/</code>的公共URL。打</a></p><p id="89c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“保存”并拨打您的号码。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/5b68263228a45639a190b3ce3b3016a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AC0kRaA90-pAqSzj.jpg"/></div></div></figure><p id="010d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你拨打你的号码并告诉PodBot播客的标题时，你应该会看到<code class="fe mw mx my mz b">CallSid</code>、<code class="fe mw mx my mz b">RecordingUrl</code>和<code class="fe mw mx my mz b">TranscriptionText</code>记录在你的终端上。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/6463af52091e9b970f0921e118be8d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*epUGSl2oWIGaGxG0.jpg"/></div></div></figure><p id="f2f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe mw mx my mz b">twilio-run</code>您可以直接从命令行在您的本地环境中开发功能。如果您对本地函数的功能感到满意，那么您可以将它们移动到Twilio控制台中的<a class="ae kl" href="https://www.twilio.com/console/runtime/functions/manage" rel="noopener ugc nofollow" target="_blank">functions区域，并调整您的编号以使用您的函数而不是webhooks。</a></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/ed67f0dab2c6e82e6d737ebaf35e969b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sC81X_-kfh4-WjoL.jpg"/></div></div></figure><p id="b11a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在将功能转移到Twilio并调整来电处理后，您就有了一个在云中运行的语音机器人，它可以随时记录信息以供进一步使用。此时，您将不再需要本地设置。</p><p id="ce27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本教程是构建PodBot的第一步。有了这三个功能，你就可以使用Twilio管理和记录电话。如果你想玩玩它，你可以在GitHub上看看我的<a class="ae kl" href="https://github.com/stefanjudis/podbot-functions" rel="noopener ugc nofollow" target="_blank"> podbot-functions </a> repo或者看看<a class="ae kl" href="https://www.twilio.com/docs/runtime/functions" rel="noopener ugc nofollow" target="_blank">functions docs</a>。</p><p id="34d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想开始自己的播客业务，或者只是想说声“嗨”，你可以通过以下渠道联系我。</p><ul class=""><li id="f43f" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">电子邮件:<a class="ae kl" href="mailto:sjudis@twilio.com" rel="noopener ugc nofollow" target="_blank">sjudis@twilio.com</a></li><li id="c780" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">Github: <a class="ae kl" href="https://github.com/stefanjudis" rel="noopener ugc nofollow" target="_blank"> stefanjudis </a></li><li id="8f86" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">推特:<a class="ae kl" href="https://twitter.com/stefanjudis" rel="noopener ugc nofollow" target="_blank"> @stefanjudis </a></li></ul></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><p id="3dda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kp">最初发表于</em><a class="ae kl" href="https://www.twilio.com/blog/control-and-record-voice-messages-with-node-js-serverless-functions" rel="noopener ugc nofollow" target="_blank">T5【https://www.twilio.com】</a><em class="kp">。</em></p></div></div>    
</body>
</html>
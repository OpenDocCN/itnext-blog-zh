# 为什么你不应该忽视第二天库伯内特斯

> 原文：<https://itnext.io/why-you-shouldnt-overlook-day-2-kubernetes-a3e9fa5f542d?source=collection_archive---------6----------------------->

## 是的，第二天的 Kubernetes 很有挑战性。介绍克服第二天的现代方法。

![](img/8152df5efb5b24e181001ae44915de62.png)

第二天库伯内特斯很有挑战性。这就是为什么你不应该忽视它的含义。照片由亚历山大·巴甫洛夫·博尔莫廷/ Unsplash 拍摄。

决定实现 Kubernetes(第 0 天)然后让您的第一个部署启动并运行(第 1 天)已经够难了。但接下来的一切，通常被称为第二天 Kubernetes。许多组织忽略了这个充满挑战和问题的阶段。

一旦最初的兴奋消退，第二天就是成败的关键时刻，你的团队需要想出如何长期管理和维护 Kubernetes。否则，当您向应用添加功能并增加部署的复杂性时，成本会以昂贵的停机、集成问题和开发速度损失的形式累积起来。

我花了一年时间与几十个一流的 DevOps 团队讨论如何克服工程团队在与 Kubernetes 争论时面临的一些常见运营挑战。

[](https://github.com/pluralsh/plural) [## GitHub - pluralsh/plural:以创纪录的时间在 kubernetes 上部署开源软件。🚀

### Plural 使您能够在 Kubernetes 上构建和维护云原生和生产就绪的开源基础设施…

github.com](https://github.com/pluralsh/plural) 

以下是我学到的东西:

# 为什么解决第二天的 Kubernetes 是至关重要的

![](img/86e732cbf2ccd83d799659169c10449a.png)

对于大多数工程团队来说，Kubernetes 经常让人觉得是个难题。Markus Winkler / Unsplash 拍摄的照片

第 2 天 Kubernetes 介绍了维护集群性能和可靠性的 DevOps 流程，如监控、测试、操作手册和警报。通常，在最初推动尽快部署 Kubernetes 时，没有仔细考虑这些操作。毕竟，为了进入 [Kubernetes](https://www.plural.sh/blog/kubernetes-statefulsets-are-broken/) 并弄清楚基础知识，比如如何将 Docker Compose 文件转换成生产 K8s 服务，有大量的术语和概念要学习。

然而，在确定初始部署的同时，提前考虑第 2 天和以后的事情也很重要。与任何开源技术一样，选择自托管 Kubernetes 而不是托管解决方案可以节省大量成本并提高灵活性，但这也带来了风险。

如果您的 Kubernetes 集群没有得到很好的管理、监控或理解，您的工程师可能会花费大量的时间来查找根本原因和修复故障。安全漏洞或治理问题可能会导致公关或合规灾难。由于配置不当，您可能会增加云成本。总的来说，士气可能会受到打击，因为工程师花在编写掌舵图上的时间比他们花在产品功能上的时间还多。

# 组织在第 2 天 Kubernetes 中面临哪些问题？

![](img/56c471e18e91722c6acf804aa10f7eca.png)

虽然因组织而异，但您可以将 Kubernetes 第 2 天的问题分为以下五个方面。照片由 Rob Wicks / Unsplash 拍摄

工程组织在管理 K8s 时遇到的问题可以分为以下五个方面:

# 学习曲线和知识转移

无论您是将 Kubernetes 仅用于您的数据堆栈，还是将您的整个单片系统转换为分布式微服务，您都希望避免只有一两名工程师负责维护您的解决方案的情况。然而，关于 K8s 有一个陡峭的学习曲线和大量的材料。

此外，你不仅要掌握核心的 Kubernetes API，还要掌握管理 K8s 的工具链。不同的工具有如此多的选择(头盔或 Kustomize？Terraform 还是 Ansible？)，你的解决方案往往会非常专业化，让你很难吸收新的工程师或者失去组织中少数工程师的知识。

# 能见度

在大多数情况下，尤其是如果您使用 AWS，您不会有内置的 Kubernetes 仪表板。要了解您的所有资源是什么，您需要使用命令行界面(kubectl)——虽然有些人对此非常熟悉，但大多数人并不熟悉，他们需要可视化界面的好处。

# 第三方应用集成

通常，你在第二天遇到的问题并不是技术上的问题。相反，其他应用程序如何与 K8s 交互的操作特性会让您头疼。例如，如果您想在 Kubernetes 上部署 Airflow，您可能不知道如何扩展它下面的数据库，或者如何扩展工作人员，要可视化哪些指标，或者要进行哪些 CPU/内存权衡。

这种操作知识对于每个应用程序来说都是独一无二的，每当您想在 Kubernetes 上使用一个新的开源工具时，都必须从头开始学习。任何错误的配置都可能导致比您真正需要花费的更高的云账单。

# 监控、警报和灾难恢复

虽然 K8s 内置了一些日志记录功能，但在第 2 天，设置您的日志以连接到一个中央系统(或一组工具)是非常重要的，您可以使用该系统进行观察和报警。记录像 Kubernetes 这样的动态分布式系统是复杂的。您需要监控多个层(例如节点和集群级别)，每个层都有自己的生命周期和不同种类的日志。

除了日志记录，警报和灾难恢复策略也是第二天 Kubernetes 的必备条件。同样，由于系统的分布式本质，团队在这里可能会遇到问题。可能并不总是清楚每项服务的所有者是谁，因此值班人员可能不知道在停电的情况下该做什么，甚至不知道该联系谁。

# 安全和治理

从安全角度来看，Kubernetes 可能是有益的。如果你有一个使用 K8s 的整合网络层，你不必担心暴露更多的数据，你可以在潜在的不太安全的第三方应用程序上运行一个额外的安全层。

然而，您存储秘密和检查漏洞的方式需要适应 Kubernetes，如果您是管理分布式系统的新手，这可能特别具有挑战性。此外，您需要设置新的访问控制，以遵循公司在治理和法规遵从性方面的最佳实践。

# Kubernetes 第二天的解决方案是什么样的

![](img/6d4bd3e524111c2f15759400e50c917c.png)

*Kubernetes 第 2 天解决方案必须至少涵盖以下六个组成部分。Antonio Janeski / Unsplash 拍摄的照片*

根据我的经验，第 2 天 Kubernetes 的解决方案至少需要具备以下组件:

*   **Dashboarding:** 为不想使用命令行的人提供的管理资源的可视化界面。
*   **集成测试套件:**当你把一个新版本的包推向生产时，你会想办法自动地把它部署到测试集群中，并运行健康检查以确保一切都运行良好。
*   **访问控制:**从一个中心位置为您的集群设置访问控制应该很容易，并且审计跟踪应该是固定的。
*   **可观察性和警报:**如果出现任何问题，您需要能够快速找到问题的根源，并向正确的人发出警报。
*   **灾难恢复操作手册:**出现问题时，您需要操作手册，以便随时待命的任何人都可以快速实施修复。这就引出了最后一点…
*   **自动化:**很多时候，团队在管理 Kubernetes 时，最终会重新发明轮子。当您想要在 K8s 上部署任何东西时，您应该能够快速找到您需要的所有仪表板、所有用于扩展的钩子以及使该过程可重复的交互式操作手册。

许多公司试图将不同分散的 DevOps 解决方案中的这些组件串在一起。然而，要有一个真正有效的解决方案，你需要整个套件协同工作。当一个警报触发时，它应该会连接到一个运行手册，并为您指出修复方法。你所有的操作都应该是自动化的——团队中的每个人，而不仅仅是几个工程师，都应该可以访问和使用关于这些操作的知识。

要了解 Plural 如何工作以及我们如何帮助世界各地的工程团队在云生产环境中部署开源应用程序，请查看我们的 Github 立即开始。

加入我们的 [Discord channel](https://discord.gg/pluralsh) 进行提问、讨论，并与社区的其他成员见面。

*本文由我们的社区负责人 Abhi Vaidyanatha 共同撰写。*
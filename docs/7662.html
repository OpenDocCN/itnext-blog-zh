<html>
<head>
<title>Floating Action Button in Jetpack Compose with Material 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">喷气背包中的浮动动作按钮由材料3组成</h1>
<blockquote>原文：<a href="https://itnext.io/floating-action-button-in-jetpack-compose-with-material-3-10ba8bff415a?source=collection_archive---------0-----------------------#2022-12-12">https://itnext.io/floating-action-button-in-jetpack-compose-with-material-3-10ba8bff415a?source=collection_archive---------0-----------------------#2022-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a1c5f32c55fe83cdb0f094bd9f6c5aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6nzn_MmYmxdmJJqwpKXuvA.png"/></div></div></figure><blockquote class="jy jz ka"><p id="cb1b" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">他代表了屏幕上最重要的动作。它使关键行动触手可及。FAB通常包含一个图标，对于带文本和图标的FAB，参见<code class="fe la lb lc ld b"><a class="ae le" href="https://developer.android.com/reference/kotlin/androidx/compose/material3/package-summary#ExtendedFloatingActionButton(kotlin.Function0,androidx.compose.ui.Modifier,androidx.compose.ui.graphics.Shape,androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Color,androidx.compose.material3.FloatingActionButtonElevation,androidx.compose.foundation.interaction.MutableInteractionSource,kotlin.Function1)" rel="noopener ugc nofollow" target="_blank">ExtendedFloatingActionButton</a></code>。</p></blockquote><h1 id="e8d2" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">目录</h1><ul class=""><li id="4ccd" class="md me iq ke b kf mf kj mg mh mi mj mk ml mm kz mn mo mp mq bi translated"><a class="ae le" href="#714f" rel="noopener ugc nofollow">入门</a></li><li id="5cd1" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated">浮动动作按钮<br/>-<a class="ae le" href="#c409" rel="noopener ugc nofollow">FAB</a>-<br/>大型FAB-<br/>-<a class="ae le" href="#866b" rel="noopener ugc nofollow">小型FAB &amp;扩展FAB </a></li><li id="8ead" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated"><a class="ae le" href="#d457" rel="noopener ugc nofollow">FAB with shared view model&amp;lazy column(列表)</a></li></ul><h1 id="714f" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">入门指南</h1><p id="c59b" class="pw-post-body-paragraph kb kc iq ke b kf mf kh ki kj mg kl km mh mw kp kq mj mx kt ku ml my kx ky kz ij bi translated">首先，让我们添加材料3依赖。您可以在<a class="ae le" href="https://developer.android.com/jetpack/androidx/releases/compose-material3" rel="noopener ugc nofollow" target="_blank">合成材料3发布页面</a>上查看最新的M3版本。</p><pre class="mz na nb nc gt nd ld ne bn nf ng bi"><span id="e796" class="nh lg iq ld b be ni nj l nk nl">def material3_version = "1.0.1"<br/>implementation "androidx.compose.material3:material3:$material3_version"</span></pre><p id="4251" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">可选地，如果你已经在使用材料2，你可以跟随<a class="ae le" href="https://material.io/blog/migrating-material-3" rel="noopener ugc nofollow" target="_blank">这篇博客</a>迁移到材料3。</p><h1 id="ac57" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">浮动操作按钮</h1><p id="1783" class="pw-post-body-paragraph kb kc iq ke b kf mf kh ki kj mg kl km mh mw kp kq mj mx kt ku ml my kx ky kz ij bi translated"><code class="fe la lb lc ld b">FAB</code>实现非常容易。对于物料3，我们有4种不同的<code class="fe la lb lc ld b">FAB</code>选项可供选择。</p><h2 id="c409" class="nm lg iq bd lh nn no dn ll np nq dp lp mh nr ns lt mj nt nu lx ml nv nw mb nx bi translated">极好的</h2><pre class="mz na nb nc gt nd ld ne bn nf ng bi"><span id="edf8" class="nh lg iq ld b be ni nj l nk nl">FloatingActionButton(<br/>    onClick = {<br/>        //OnClick Method<br/>    },<br/>    containerColor = MaterialTheme.colors.secondary,<br/>    shape = RoundedCornerShape(16.dp),<br/>) {<br/>    Icon(<br/>        imageVector = Icons.Rounded.Add,<br/>        contentDescription = "Add FAB",<br/>        tint = Color.White,<br/>    )<br/>}</span></pre><p id="e6de" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">containerColor</code>，该FAB的背景颜色。</p><p id="7a68" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">shape</code>，定义该FAB的容器形状。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/10686b6afd2f26202a2489c5eac120e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*-DnhKHlfcR1JFRHi7Mjxqg.png"/></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">极好的</figcaption></figure><h2 id="0f89" class="nm lg iq bd lh nn no dn ll np nq dp lp mh nr ns lt mj nt nu lx ml nv nw mb nx bi translated">大型晶圆厂</h2><blockquote class="jy jz ka"><p id="7b2f" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">Large FAB</code>在布局要求清晰突出的主要动作时，以及在较大的覆盖面积有助于用户参与的情况下很有用。例如，当出现在更高和更大的设备屏幕上时。</p></blockquote><pre class="mz na nb nc gt nd ld ne bn nf ng bi"><span id="169b" class="nh lg iq ld b be ni nj l nk nl">LargeFloatingActionButton(<br/>    onClick = {<br/>        //OnClick Method<br/>    },<br/>    containerColor = MaterialTheme.colors.secondary,<br/>) {<br/>    Icon(<br/>        imageVector = Icons.Rounded.Add,<br/>        contentDescription = "Add FAB",<br/>        tint = Color.White,<br/>    )<br/>}</span></pre><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/258c463f63fe50b6d1e2ba2a63dfc0b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*wXonT5JHrxG_V3qy9RGYPw.png"/></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">大型晶圆厂。在小屏幕上真的不好看:)</figcaption></figure><h2 id="866b" class="nm lg iq bd lh nn no dn ll np nq dp lp mh nr ns lt mj nt nu lx ml nv nw mb nx bi translated">小型工厂和扩展工厂</h2><blockquote class="jy jz ka"><p id="c170" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">Small FAB</code>用于辅助、支持动作，或替代较小屏幕上的默认FAB。一个或多个小型制造厂可以与默认制造厂或扩展制造厂配对。</p><p id="b41d" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">Extended FAB</code>是视觉上最突出的按钮。在具有长滚动视图的屏幕上使用扩展FAB，这种屏幕需要持续访问某个动作，例如结账屏幕。不要在不能滚动的视图中使用扩展FAB。</p></blockquote><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="3378" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">Small FAB</code> &amp; <code class="fe la lb lc ld b">Extended FAB</code>实现与<code class="fe la lb lc ld b">FAB</code>非常相似。唯一不同的是<code class="fe la lb lc ld b">Extended FAB</code>有<code class="fe la lb lc ld b">text</code>，可选<code class="fe la lb lc ld b">icon</code>和<code class="fe la lb lc ld b">expanded</code>参数。</p><p id="2110" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">expanded</code>，控制该FAB的扩展状态。在展开状态下，FAB将显示<code class="fe la lb lc ld b">icon</code>和<code class="fe la lb lc ld b">text</code>。在折叠状态下，FAB将只显示<code class="fe la lb lc ld b">icon</code>。</p><p id="7f46" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">你可能已经注意到了，<code class="fe la lb lc ld b">onClick</code> &amp; <code class="fe la lb lc ld b">expanded</code>正在使用<code class="fe la lb lc ld b">sharedViewModel</code>。在下一节中，我们将实现<code class="fe la lb lc ld b">SharedViewModel</code>并看看它是如何工作的。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/ee4a6eb6944132cb60b8977ee92e1557.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*Uy6X2cXo1eZi5FJCi_scQw.png"/></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated">小型工厂和扩展工厂</figcaption></figure><h1 id="d457" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">具有SharedViewModel和LazyColumn的FAB(列表)</h1><p id="97c0" class="pw-post-body-paragraph kb kc iq ke b kf mf kh ki kj mg kl km mh mw kp kq mj mx kt ku ml my kx ky kz ij bi translated">我们先创建<code class="fe la lb lc ld b">SharedViewModel</code>，</p><pre class="mz na nb nc gt nd ld ne bn nf ng bi"><span id="abbf" class="nh lg iq ld b be ni nj l nk nl">class SharedViewModel: ViewModel() {<br/>    var fabOnClick = mutableStateOf({})<br/>    var smallFabOnClick = mutableStateOf({})<br/><br/>    val expandedFab = mutableStateOf(true)<br/>}</span></pre><p id="4302" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">现在我们可以创建示例屏幕，</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="od oe l"/></div></figure><blockquote class="jy jz ka"><p id="999c" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">derivedStateOf</code>当你的状态或按键变化超过你想要更新的UI时使用。</p></blockquote><p id="e9b0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">如果<code class="fe la lb lc ld b">LazyColumn</code>中第一个可见项索引为0，则<code class="fe la lb lc ld b">expandedFabState</code>为真，否则为假。当<code class="fe la lb lc ld b">expandedFabState</code>发生变化时，<code class="fe la lb lc ld b">LaunchedEffect</code>将被触发并更新<code class="fe la lb lc ld b">sharedViewModel.expandedFab</code>。</p><p id="1bf3" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">同样，我们使用<code class="fe la lb lc ld b">LaunchedEffect(key1 = Unit)</code>一次，当我们进入Composable时，它将设置<code class="fe la lb lc ld b">fabOnClick</code>和<code class="fe la lb lc ld b">smallFabOnClick</code>。我们可以用同样的方法为不同的屏幕设置不同的值。</p><p id="4988" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">最后，在<code class="fe la lb lc ld b">LazyColumn</code>中，我们设置<code class="fe la lb lc ld b">state</code>值来对滚动位置的变化做出反应。</p><p id="683a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">就是这样！我希望它是有用的。👋👋</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/f81b1889d4aa7cbc38fc6f31b5ec19f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*O5R6Qo1KeifSEQ5b"/></div></figure><h2 id="4f8c" class="nm lg iq bd lh nn no dn ll np nq dp lp mh nr ns lt mj nt nu lx ml nv nw mb nx bi translated">来源:</h2><ul class=""><li id="14fe" class="md me iq ke b kf mf kj mg mh mi mj mk ml mm kz mn mo mp mq bi translated">[ <a class="ae le" href="https://m3.material.io/components/floating-action-button/overview" rel="noopener ugc nofollow" target="_blank"> FAB —材料设计3 </a></li><li id="53fe" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated">[<a class="ae le" href="https://developer.android.com/reference/kotlin/androidx/compose/material3/package-summary#floatingactionbutton" rel="noopener ugc nofollow" target="_blank">androidx . compose . material 3 | Android开发者</a> ]</li><li id="3f36" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated">[ <a class="ae le" href="https://m3.material.io/components/extended-fab/overview" rel="noopener ugc nofollow" target="_blank">扩展FAB —材料设计3 </a></li><li id="4db8" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated">[<a class="ae le" href="https://developer.android.com/reference/kotlin/androidx/compose/material3/package-summary#ExtendedFloatingActionButton(kotlin.Function0,androidx.compose.ui.Modifier,androidx.compose.ui.graphics.Shape,androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Color,androidx.compose.material3.FloatingActionButtonElevation,androidx.compose.foundation.interaction.MutableInteractionSource,kotlin.Function1)" rel="noopener ugc nofollow" target="_blank">androidx . compose . material 3 | Android开发者</a></li><li id="dc36" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated"><a class="ae le" href="https://stackoverflow.com/questions/70144298/compose-remember-with-keys-vs-derivedstateof" rel="noopener ugc nofollow" target="_blank">kot Lin—Compose:memory()with key vs . derivedStateOf()—堆栈溢出</a></li></ul></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><p id="1732" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km mh ko kp kq mj ks kt ku ml kw kx ky kz ij bi translated">你可以联系我，</p><ul class=""><li id="3e08" class="md me iq ke b kf kg kj kk mh oo mj op ml oq kz mn mo mp mq bi translated"><a class="ae le" href="https://www.linkedin.com/in/burak-fidan/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="aae7" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated"><a class="ae le" href="https://github.com/MrNtlu" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="25a5" class="md me iq ke b kf mr kj ms mh mt mj mu ml mv kz mn mo mp mq bi translated"><a class="ae le" href="https://twitter.com/BurakFNtlu" rel="noopener ugc nofollow" target="_blank">推特</a></li></ul></div></div>    
</body>
</html>
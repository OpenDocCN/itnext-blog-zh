<html>
<head>
<title>Jenkins Tutorial — Part 2 — Pipeline Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jenkins教程—第2部分—管道变量</h1>
<blockquote>原文：<a href="https://itnext.io/jenkins-tutorial-part-2-pipeline-variables-5e4783aa2c07?source=collection_archive---------0-----------------------#2021-08-01">https://itnext.io/jenkins-tutorial-part-2-pipeline-variables-5e4783aa2c07?source=collection_archive---------0-----------------------#2021-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c518273176f996c36d381a98cf53ea9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isD_dDi7u493JTm4ZudxOw.jpeg"/></div></div></figure><p id="de39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我将介绍在管道中定义和使用变量的方法。如果你还没有阅读<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/jenkins-tutorial-part-1-pipelines-bd1397cf5509">之前的</a>部分。变量是管道中最重要的部分，它使我们能够制作可重复的管道，并将代码从配置中分离出来。这就是为什么你应该学习如何定义和使用变量。那么，我们开始吧。</p><h1 id="4784" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">在继续阅读之前:</h1><p id="0537" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">如果您需要一个完整的Jenkins堆栈，其中包含一组工具和插件，您可以部署我在我们公司、培训课程和本系列文章中使用的那个。这个堆栈可用于Kubernetes和Docker。</p><div class="ma mb gp gr mc md"><a href="https://github.com/ssbostan/jenkins-stack-kubernetes" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">GitHub-ssbo stan/jenkins-stack-kubernetes:在Kubernetes上部署Jenkins的脚本和清单</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">注意:此存储库是“DevOps with Saeid”类的一部分。部署Jenkins的脚本和清单…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">github.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr jw md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://github.com/ssbostan/jenkins-stack-docker" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">GitHub-ssbo stan/Jenkins-stack-Docker:Docker-compose版本的jenkins-stack-kubernetes</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">Permalink无法加载最新的提交信息。docker-撰写版本的詹金斯-栈-kubernetes。要查看…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">github.com</p></div></div><div class="mm l"><div class="ms l mo mp mq mm mr jw md"/></div></div></a></div><h1 id="a5ee" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">詹金斯管道环境变量:</h1><p id="a55b" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">管道环境变量可在<code class="fe mt mu mv mw b">environment</code>部分定义。这个部分可以在整个管道上全局定义，也可以在特定的管道阶段定义。您可以同时在全局和每个阶段中定义环境变量。全局定义的变量可以在所有阶段中使用，但是阶段定义的变量只能在该阶段中使用。可以使用<code class="fe mt mu mv mw b">NAME = VALUE</code>语法定义环境变量。要访问变量值，您可以使用这三种方法<code class="fe mt mu mv mw b">$env.NAME</code>、<code class="fe mt mu mv mw b">$NAME</code>或<code class="fe mt mu mv mw b">${NAME}</code>，这三种方法没有区别。这是一个包含环境变量的完整管道示例。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="b68a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Jenkins凭证和环境变量:</h1><p id="6535" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">一个有用的助手方法可以用作环境变量的值来访问预定义的Jenkins凭证。所有众所周知的凭证——秘密文本、秘密文件、用户名/密码和带私钥的SSH以及由其他插件安装的其他凭证类型——都可以使用<code class="fe mt mu mv mw b">credentials(id)</code> helper进行访问。这里有一个例子。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="74da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">重要提示:</strong></p><p id="6dd0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们使用<strong class="ka ir">“用户名/密码”</strong>或<strong class="ka ir">“带私钥的SSH”</strong>凭证之一时，除了我们定义的变量名之外，Jenkins还自动定义了另外两个环境变量。这两个自动定义的变量被命名为<code class="fe mt mu mv mw b">VARNAME_USR</code>和<code class="fe mt mu mv mw b">VARNAME_PSW</code>，定义这些额外的变量是因为这些类型的凭证不是单值凭证。这些额外自动定义的变量的值是我们最初定义的变量所访问的整个凭证的一部分。</p><p id="50c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">“用户名/密码”</strong>凭证的情况下，假设你定义了一个名为<code class="fe mt mu mv mw b">MYUSERPASS</code>的变量，分别是<code class="fe mt mu mv mw b">MYUSERPASS</code>的值为<code class="fe mt mu mv mw b">username:password</code>、<code class="fe mt mu mv mw b">MYUSERPASS_USR</code>的值为<code class="fe mt mu mv mw b">username</code>和<code class="fe mt mu mv mw b">MYUSERPASS_PSW</code>的值为<code class="fe mt mu mv mw b">password</code>。这里有一个例子。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="0cce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">“带私有密钥的SSH”</strong>凭证的情况下，假设您定义了一个环境变量<code class="fe mt mu mv mw b">MYSSHINFO</code>,<code class="fe mt mu mv mw b">MYSSHINFO</code>的值是SSH密钥文件的位置。如果该凭证有一个SSH用户名和密码，那么会自动定义<code class="fe mt mu mv mw b">MYSSHINFO_USR</code>和<code class="fe mt mu mv mw b">MYSSHINFO_PSW</code>，并将这些值分别分配给这些变量。</p><p id="3e71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在哪里可以使用环境变量，哪些Jenkins方法/函数可以接受环境变量以及其他定义/访问变量的方法将在以后的文章中介绍。如果你感兴趣，请订阅我的个人资料。</p><p id="b78b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关注我的领英【https://www.linkedin.com/in/ssbostan T21】</p></div></div>    
</body>
</html>
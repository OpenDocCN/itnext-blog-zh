<html>
<head>
<title>Load Local html file into WebView in Flutter. Call JS function from Flutter.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter中将本地html文件加载到WebView中。从Flutter调用JS函数。</h1>
<blockquote>原文：<a href="https://itnext.io/load-local-html-file-into-webview-in-flutter-call-js-function-from-flutter-2d9404c8f7d4?source=collection_archive---------0-----------------------#2020-12-31">https://itnext.io/load-local-html-file-into-webview-in-flutter-call-js-function-from-flutter-2d9404c8f7d4?source=collection_archive---------0-----------------------#2020-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5252" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将看到如何在Flutter中用本地Html加载Webview，并从Flutter调用其中的Javascript函数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/a125510450ddfdaa2aad941dd61b5162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNvAdAf-vtcT4nsQ45ONNQ.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">WebView颤振</figcaption></figure><h1 id="a08b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">添加依赖关系</strong></h1><p id="9084" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">你首先需要的是webview插件本身，你可以从下面的链接得到它【https://pub.dev/packages/webview_flutter<br/>T3</p><p id="2eb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<em class="mf"> pubspec.yaml </em>文件，添加依赖关系</p><pre class="km kn ko kp gt mg mh mi mj aw mk bi"><span id="6158" class="ml lc iq mh b gy mm mn l mo mp">dependencies:   <br/>    webview_flutter: ^1.0.7</span></pre><h1 id="bd1c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">观看视频教程</strong></h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="3d76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是我们将要加载到webview <br/>中的HTML代码示例，我已经将该文件保存在项目根目录下名为“files”的文件夹中。</p><p id="29a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了让应用程序访问该目录，请确保在<em class="mf"> pubspec.yaml </em>文件中添加该文件夹。</p><p id="920e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<em class="mf"> pubspec.yaml </em>文件后，转到assets部分，在那里添加这个文件夹“<em class="mf"> files </em>”。</p><p id="9ee9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">#要将资产添加到您的应用程序中，请添加一个资产部分，如下所示:<br/>资产:<br/> —图像/ <br/> — json/ <br/> —视频/ <br/> — <strong class="jp ir">文件/ </strong></p><h2 id="099c" class="ml lc iq bd ld ms mt dn lh mu mv dp ll jy mw mx lp kc my mz lt kg na nb lx nc bi translated"><strong class="ak"> HTML文件</strong></h2><pre class="km kn ko kp gt mg mh mi mj aw mk bi"><span id="b803" class="ml lc iq mh b gy mm mn l mo mp">&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=2"&gt;<br/>    &lt;script type="text/javascript"&gt;<br/>        function add(num1, num2) {<br/>            var result = num1 + num2;<br/>            document.getElementById("result").innerHTML<br/>                = num1 + " + " + num2 + " = " + result;<br/>        }<br/>    &lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;p&gt;Hello from Flutter&lt;/p&gt;<br/>    &lt;p id="result"&gt;&lt;/p&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="fd24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">接下来，我们将通过添加webview来创建用户界面。</strong></p><p id="003b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是完整的源代码。这里，我们首先使用空Url加载webview，当webview返回'<strong class="jp ir"><em class="mf">onwebview created</em></strong>'回调时，我们将初始化<strong class="jp ir"><em class="mf">webview controller</em></strong>，然后使用它加载本地HTML文件。webViewController实例还用于使用<strong class="jp ir"><em class="mf">evaluate javascript</em></strong>方法调用JavaScript函数。<br/>这里我们调用本地html文件中的'<strong class="jp ir"> <em class="mf"> add </em> </strong>'函数，该函数添加了从Flutter发送的两个数字，并显示在Webview的p标签中。</p><p id="523d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mf">这里是完整的代码</em></p><pre class="km kn ko kp gt mg mh mi mj aw mk bi"><span id="64f1" class="ml lc iq mh b gy mm mn l mo mp">import 'package:flutter/material.dart';<br/>import 'package:flutter/services.dart';<br/>import 'dart:convert';<br/>import 'package:webview_flutter/webview_flutter.dart';<br/> <br/>class WebViewTest extends StatefulWidget {<br/>  <a class="ae me" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>  State&lt;StatefulWidget&gt; createState() {<br/>    return _WebViewTestState();<br/>  }<br/>}<br/> <br/>class _WebViewTestState extends State&lt;WebViewTest&gt; {<br/>  //<br/>  WebViewController _webViewController;<br/>  String filePath = 'files/test.html';<br/> <br/>  <a class="ae me" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>  Widget build(BuildContext context) {<br/>    return Scaffold(<br/>      appBar: AppBar(title: Text('Webview Demo')),<br/>      body: WebView(<br/>        initialUrl: '',<br/>        javascriptMode: JavascriptMode.unrestricted,<br/>        onWebViewCreated: (WebViewController webViewController) {<br/>          _webViewController = webViewController;<br/>          _loadHtmlFromAssets();<br/>        },<br/>      ),<br/>      floatingActionButton: FloatingActionButton(<br/>        child: const Icon(Icons.add),<br/>        onPressed: () {<br/>          _webViewController.evaluateJavascript('add(10, 10)');<br/>        },<br/>      ),<br/>    );<br/>  }<br/> <br/>  _loadHtmlFromAssets() async {<br/>    String fileHtmlContents = await rootBundle.loadString(filePath);<br/>    _webViewController.loadUrl(Uri.dataFromString(fileHtmlContents,<br/>            mimeType: 'text/html', encoding: Encoding.getByName('utf-8'))<br/>        .toString());<br/>  }<br/>}</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/02505ce9781e02c47f78702e3a94beaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TkZRQjVO1O70GYB0WGKOVA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">从Flutter调用JS函数</figcaption></figure><p id="69cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请分享和评论你的宝贵想法。</p><p id="d395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在youtube上关注我以获得更多教程</p><div class="ne nf gp gr ng nh"><a href="https://www.youtube.com/channel/UC5lbdURzjB0irr-FTbjWN1A" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">移动程序员</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">这个频道将帮助你学习移动技术，如Fluttter，React Native，Android和iOS。</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">www.youtube.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv kv nh"/></div></div></a></div><p id="66f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢大家！！！祝你新年健康快乐…</p></div></div>    
</body>
</html>
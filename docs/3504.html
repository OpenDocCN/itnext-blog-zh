<html>
<head>
<title>Using Google Sheets as a Makeshift Database for React Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Sheets作为React应用程序的临时数据库</h1>
<blockquote>原文：<a href="https://itnext.io/using-google-sheets-as-a-database-for-react-apps-6c15b4481680?source=collection_archive---------0-----------------------#2019-12-29">https://itnext.io/using-google-sheets-as-a-database-for-react-apps-6c15b4481680?source=collection_archive---------0-----------------------#2019-12-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e6cba124edc89c599fa57db1a103a69a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQTAxxj5Eb243_Des06H0g.jpeg"/></div></div></figure><p id="5617" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们想要一个定制的网站，一只小鸟告诉我们<a class="ae kw" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>是这些天来酷孩子所追求的——比如，它比<a class="ae kw" href="https://wordpress.com/" rel="noopener ugc nofollow" target="_blank"> Wordpress </a>更快、可扩展、易于更新？但是我们希望能够自己更新内容。什么都有。哦，波斯特……<em class="kx">什么？</em>T6】Postgres？那是什么？不，我们也不知道<a class="ae kw" href="https://www.mysql.com/" rel="noopener ugc nofollow" target="_blank"> MySQL </a>。<a class="ae kw" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank">火基</a>？我感觉又被另一种技术术语攻击了！为什么我们不能直接用Google Sheets？！是的，现在你可以了。</p><p id="8b55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我很抱歉把React和Wordpress做比较。它们是完全不同的野兽，服务于不同的目的——React是Javascript框架，Wordpress是内容管理系统(CMS)。你可以把Wordpress绑在一把椅子上，然后把所有的宿舍(所有的三个部分)都放在上面，或者像爱国者队的粉丝崇拜汤姆·布拉迪一样赞美它(对不起，我永远是老鹰队的粉丝)。但是我和我认识的大多数人一样，已经离开了Wordpress。出于各种各样的原因——我认为这些原因最适合Reddit。好了，回到反应问题上来。</p><h1 id="11fe" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">背景</h1><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/d031841cf81a4162eef9ce494be49b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*tNA3JGFWSEaV1233JJ4Vjw.jpeg"/></div></figure><p id="8366" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">几年前，作为我志愿创业公司<a class="ae kw" href="http://evoxlabs.org/" rel="noopener ugc nofollow" target="_blank"> EvoXLabs </a>的一部分，我运营了<a class="ae kw" href="http://evoxlabs.org/projects/fawn" rel="noopener ugc nofollow" target="_blank"> FAWN Initiative </a>(免费且可访问的非营利网站)。大多数情况下，这些都是信息网站，需要经常更新。然而，更新并不是交易的一部分，因为该倡议背后的想法是促进和倡导网站的可访问性。这也是为什么选择React的原因之一——不是因为它神奇地让网站变得可访问，而是因为它不是由一堆视觉上和功能上吸引人的小部件组成，这些小部件完全没有可访问性。是的，<a class="ae kw" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank">角</a>和<a class="ae kw" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue </a>在这一点上几乎是一样的，但是React是毒药。无论如何，更新。对于更新，有两种方法:要么该组织的工作人员/志愿者对React感到满意，要么他们能够在传统数据库中导航。这很快成为一个问题，再加上缺乏资源来满足需求，FAWN倡议变得不活跃，并一直如此。</p><h1 id="c839" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">进入谷歌工作表</h1><figure class="lx ly lz ma gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/a7a3791a64bbb8c1b528d111beb559d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3M5MC2-I-gKtFyus_tEPA.png"/></div></div></figure><p id="a64c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大约一年前，我开始思考作为一名React开发人员，我可以为我所关心的事业做出贡献的其他方式。我还能为非营利组织制作网站，而不成为他们自己添加/删除/修改内容的瓶颈吗？所以，我开始询问人们在网上用来存储和获取信息的最常用的工具是什么。在科技界，这个问题的答案是一份自成一本书的清单。在科技世界之外，只有一个答案引人注目——谷歌表单。Excel/CSV文件排在第二位，但是人们对修改和部署文件的整个过程犹豫不决。幸运的是，Google Sheets和大多数其他Google产品一样，有一个非常棒的API。哪里有空气污染指数，哪里就有光明。</p><p id="789a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Google Sheets无法与传统数据库相提并论，也无法取代传统数据库。但是Google Sheets作为一个临时的数据库可能真正有益的一个地方是它的开箱即用跟踪历史的能力，在传统数据库中，这是通过额外的手段来处理的。</p><h1 id="0050" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">让我们来谈谈技术</h1><p id="2beb" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">好的，我们有一个API。React是一个Javascript框架。所以，<code class="fe mh mi mj mk b"><a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" rel="noopener ugc nofollow" target="_blank">fetch</a></code>来电，对吧？或者<code class="fe mh mi mj mk b"><a class="ae kw" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank">axios</a></code>，如果你喜欢的话。应该很简单，对吧？不完全是。</p><p id="933d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">React最棒的一点是它的路由功能。当浏览页面和子组件时，不需要重新加载整个页面。所以才快。所以，假设你有几个组件(在这个上下文中，与页面同义)，每个组件都有一个<code class="fe mh mi mj mk b">fetch</code>调用。会发生什么？每次加载组件时(取决于<code class="fe mh mi mj mk b">fetch</code>调用的位置)，都会有一个网络调用。网络调用可能会大大降低性能。但这还不是全部。每次进行Google Sheets API调用时，都会被计入调用配额。来自<a class="ae kw" href="https://developers.google.com/sheets/api" rel="noopener ugc nofollow" target="_blank"> Google Sheets API v4 </a>的<a class="ae kw" href="https://developers.google.com/sheets/api/limits" rel="noopener ugc nofollow" target="_blank">使用限制</a>部分:</p><blockquote class="ml mm mn"><p id="5e49" class="jy jz kx ka b kb kc kd ke kf kg kh ki mo kk kl km mp ko kp kq mq ks kt ku kv ij bi translated">这个版本的Google Sheets API限制每个项目每100秒500个请求，每个用户每100秒100个请求。分别跟踪读取和写入的限制。没有每日使用量限制。</p></blockquote><p id="0391" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">长话短说，考虑到这些限制，我们真正想要的是尽可能地限制网络调用。这使得我们的网站更快，我们最大限度地利用配额。如果您的预期流量超出了使用限制，传统数据库可能最适合您的需求。后面的“何时不使用Google Sheets”一节将介绍这种情况。</p><h1 id="3808" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Metis简介</h1><p id="5758" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated"><a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank"> Metis </a>是一个<a class="ae kw" href="https://reactjs.org/docs/higher-order-components.html" rel="noopener ugc nofollow" target="_blank">高阶组件(HOC) </a>，它允许React应用程序使用Google Sheets作为临时数据库。如果你想知道，<a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank">梅蒂斯</a>是以希腊智慧女神命名的。<a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank"> Metis </a>有两个主要组成部分:<code class="fe mh mi mj mk b">GoogleSheetsProvider</code>和<code class="fe mh mi mj mk b">withGoogleSheets</code>。</p><h2 id="2f82" class="mr kz iq bd la ms mt dn le mu mv dp li kj mw mx lm kn my mz lq kr na nb lu nc bi translated">GoogleSheetsProvider</h2><p id="4b65" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated"><code class="fe mh mi mj mk b">GoogleSheetsProvider</code>很像React的<code class="fe mh mi mj mk b"><a class="ae kw" href="https://reactjs.org/docs/context.html#contextprovider" rel="noopener ugc nofollow" target="_blank">Context.Provider</a></code>。它包装React应用程序，从Google Sheets文档中获取所有的工作表，将来自API的原始结果转换成可读的键/值(kv)存储，并将这个kv存储发布到上下文。这允许从组件树中的任何地方访问kv存储。</p><h2 id="5ca1" class="mr kz iq bd la ms mt dn le mu mv dp li kj mw mx lm kn my mz lq kr na nb lu nc bi translated">使用GoogleSheets</h2><p id="875c" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated"><code class="fe mh mi mj mk b">withGoogleSheets</code>是一个高阶组件，它使得从上下文的特定工作表中获取数据(通过GoogleSheetsProvider完成)并通过<code class="fe mh mi mj mk b"><a class="ae kw" href="https://reactjs.org/docs/components-and-props.html" rel="noopener ugc nofollow" target="_blank">props</a></code>使其对组件可用变得非常容易。</p><p id="6f93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认情况下，<code class="fe mh mi mj mk b">withGoogleSheets</code>附带了一个非常基本的组件，用于在从Google Sheets API获取数据不成功的情况下进行渲染(不正确的权限，达到配额等)。).这个特设允许定制这个默认组件，也可以用一个完全不同的定制组件来替换它。</p><p id="356b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mh mi mj mk b">withGoogleSheets</code>被设计成将单个表名或一组表名作为获取数据的参数。获取所有的工作表而不单独指定每个工作表也是受支持的，并且<a class="ae kw" href="https://github.com/athersharif/metis/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">很好地记录了</a>和<a class="ae kw" href="https://github.com/athersharif/metis/tree/master/example" rel="noopener ugc nofollow" target="_blank">示例</a>。</p><h2 id="d978" class="mr kz iq bd la ms mt dn le mu mv dp li kj mw mx lm kn my mz lq kr na nb lu nc bi translated">基本示例</h2><p id="2eb3" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated"><strong class="ka ir">安装</strong></p><pre class="lx ly lz ma gt nd mk ne nf aw ng bi"><span id="8d52" class="mr kz iq mk b gy nh ni l nj nk">npm install react-db-google-sheets --save</span></pre><p id="4af3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">。环境</strong></p><pre class="lx ly lz ma gt nd mk ne nf aw ng bi"><span id="afe7" class="mr kz iq mk b gy nh ni l nj nk">REACT_APP_GOOGLE_SHEETS_API_KEY=[YOUR-API-KEY]<br/>REACT_APP_GOOGLE_SHEETS_DOC_ID=[YOUR-DOC-ID]</span></pre><p id="007e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> App.js </strong></p><pre class="lx ly lz ma gt nd mk ne nf aw ng bi"><span id="33d0" class="mr kz iq mk b gy nh ni l nj nk">import React from 'react';<br/>import GoogleSheetsProvider from 'react-db-google-sheets';</span><span id="34d9" class="mr kz iq mk b gy nl ni l nj nk">const App = () =&gt; (<br/>  &lt;GoogleSheetsProvider&gt;<br/>    &lt;MyApp /&gt;<br/>  &lt;/GoogleSheetsProvider&gt;<br/>);</span><span id="e83c" class="mr kz iq mk b gy nl ni l nj nk">export default App;</span></pre><p id="b246" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">组件(say Hello.js) </strong></p><pre class="lx ly lz ma gt nd mk ne nf aw ng bi"><span id="f37d" class="mr kz iq mk b gy nh ni l nj nk">import React from 'react';<br/>import { withGoogleSheets } from 'react-db-google-sheets';</span><span id="488c" class="mr kz iq mk b gy nl ni l nj nk">const Hello = props =&gt; (<br/>  &lt;div&gt;<br/>    {props.db.sheet1.map(data =&gt; (<br/>      &lt;span&gt;{data.id}&lt;/span&gt;<br/>    ))}<br/>  &lt;/div&gt;<br/>);</span><span id="f078" class="mr kz iq mk b gy nl ni l nj nk">export default withGoogleSheets('sheet1')(Hello);</span></pre><p id="b32d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更多示例在<a class="ae kw" href="https://github.com/athersharif/metis/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">文档</a>和<a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a>上的<a class="ae kw" href="https://github.com/athersharif/metis/tree/master/example" rel="noopener ugc nofollow" target="_blank">示例子文件夹</a>下提及。</p><h1 id="488b" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">何时不使用谷歌工作表</h1><p id="ca15" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">希望到现在为止，你至少对使用Google Sheets作为React应用程序的临时数据库的想法感兴趣。但是你也可能会想到这并不是一个好的解决方案。确实如此——有几个这样的例子。就像编程世界中的任何事物一样，工具的使用完全取决于需求，Metis 也不例外。</p><p id="208a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，如前所述，如果您预计您的网站会有大量流量，即使使用<code class="fe mh mi mj mk b">GoogleSheetsProvider</code>来限制每个初始网站负载一次网络调用，您也应该使用传统的数据库或考虑使用Google Sheets API的付费计划。其次，为了将Google Sheets用作临时数据库，需要将doc上的权限设置为公开可见。因此，如果您的数据包含密码或保证用户访问权限的敏感信息，您最应该使用传统的数据库并实现适当的安全协议。Metis 和使用Google Sheets作为临时数据库的目的是为了在信息或简历/投资组合网站等公开可见的数据。</p><p id="0796" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，如果您需要外键(充当表之间交叉引用的列Google Sheets术语中的表),那么您最好使用关系数据库。<a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank"> Metis </a>将提供助手功能和指南，指导如何在未来使用Google Sheets实现这一目标，但评估您的需求并决定什么是最适合您用例的工具<strong class="ka ir">强烈推荐</strong>。</p><p id="c06b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">更新:</strong>在与一些人交谈后，值得<em class="kx">重申一下</em>Google Sheets本身是<strong class="ka ir"> <em class="kx">而不是</em> </strong>一个数据库。它无法扩展，没有利用传统数据库的任何优势，因为它根本就不是一个数据库。但是在非常具体的用例中，可伸缩性不是问题，构建CMS是不切实际的，向不精通技术的内容维护者培训新工具的开销太高，Metis可能是有益的。评估您的需求和用例，然后为此目的选择合适的工具是至关重要的——可以说，这应该是决定是否使用Metis的首要因素。</p><h1 id="4898" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h1><p id="d375" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">Metis 旨在作为一个工具来添加/修改/删除你网站上的内容，使用Google Sheets很容易，而不必担心代码更改和部署过程等等。您甚至可以通过在Google Sheets Doc上的一个表单中指定颜色、字体大小和其他样式组件来管理网站的设计和布局。可能性是无限的，易用性是非常性感的。但是同样，您应该评估您的需求并选择最适合您需求的工具。</p><p id="2c2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">给<a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank">梅蒂斯</a>一个机会。欢迎反馈、投稿、提问！请随意在<a class="ae kw" href="https://github.com/athersharif/metis" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>上提出问题，或者给我发电子邮件或者发<a class="ae kw" href="https://twitter.com/athersharif" rel="noopener ugc nofollow" target="_blank"> Tweet </a>给我你的问题/反馈！</p><p id="4c1e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">快乐的反应？快乐的谷歌搜索？<em class="kx">叹，我试试。</em></p></div></div>    
</body>
</html>
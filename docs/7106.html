<html>
<head>
<title>Using the Terraform Apply Command</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Terraform应用命令</h1>
<blockquote>原文：<a href="https://itnext.io/using-the-terraform-apply-command-a2b8413f6e77?source=collection_archive---------3-----------------------#2022-06-14">https://itnext.io/using-the-terraform-apply-command-a2b8413f6e77?source=collection_archive---------3-----------------------#2022-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a966" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇文章中，我将解释<code class="fe ko kp kq kr b">terraform apply</code>命令的用途、作用、可用选项以及何时运行它。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/524513204f55aa4716022bd84b4c1948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KwZbDki7FyLedGpwu-HBKw.jpeg"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">Nubelson Fernandes 在<a class="ae li" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="e9c5" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">什么是地形应用？</h2><p id="1d83" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply</code>命令执行<code class="fe ko kp kq kr b">terraform plan.</code>中提出的动作，它用于部署您的基础设施。通常<code class="fe ko kp kq kr b">apply</code>应该在<code class="fe ko kp kq kr b">terraform init</code>和<code class="fe ko kp kq kr b">terraform plan</code>之后运行。</p><h2 id="1602" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">terraform应用命令有什么作用？</h2><p id="6f9b" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">如果在没有任何选项的情况下运行<code class="fe ko kp kq kr b">apply</code>命令，它将首先运行<code class="fe ko kp kq kr b">terraform plan</code>，要求用户确认计划的行动，然后在确认后执行这些更改。</p><p id="a43e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">apply</code>命令也可用于先前从<code class="fe ko kp kq kr b">terraform plan -out=&lt;path to file&gt;.</code>生成的平面文件</p><h2 id="c3aa" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">快速使用示例</h2><p id="8c1a" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply</code> —根据配置文件创建或更新基础结构。默认情况下，将首先生成一个计划，并需要在应用之前进行审批。</p><p id="56c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply -auto-approve</code> —应用更改，无需对计划交互键入“是”。在自动化CI/CD管道中很有用。</p><p id="d16c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply &lt;planfilename&gt;</code> —提供使用<code class="fe ko kp kq kr b">terraform plan -out</code>命令生成的文件。如果提供，Terraform将在没有任何确认提示的情况下采取计划中的措施。</p><p id="ed8d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply -var="domainpassword=password123"</code> —传入一个变量值。</p><p id="a0b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply -var-file="varfile.tfvars"</code> —传入包含在文件中的变量。</p><p id="0d85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply -target=”module.appgw.0"</code> —仅将更改应用于目标资源。</p><p id="8c36" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply -lock=false</code> —在地形应用操作期间，不要持有状态锁。如果其他工程师可能对同一工作空间运行并发命令，请谨慎使用。</p><p id="f2cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply -parallelism=&lt;n&gt;</code> —指定并行运行的操作数量。</p><h2 id="235a" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">多次运行terraform apply是否安全？</h2><p id="4479" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">如果与当前Terraform状态相比，配置文件中没有变化，则不会对基础设施进行任何更改。Terraform是一种声明性语言，所以多次运行<code class="fe ko kp kq kr b">apply</code>命令是绝对安全的。</p><h2 id="2ade" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">在自动化中运行terraform应用程序</h2><p id="0174" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">在自动化中<code class="fe ko kp kq kr b">terraform apply</code>可以在计划阶段后运行，传入计划输出文件。如果在应用阶段之前没有计划阶段(不推荐)，那么可以使用<code class="fe ko kp kq kr b">terraform apply -auto-approve</code>选项。在一些CI/CD系统(如Azure DevOps)中运行管道时，避免编码问题的另一个有用选项是<code class="fe ko kp kq kr b">terraform apply -no-color</code>选项，因为构建代理无法正确处理彩色输出。</p><h2 id="bc10" class="lj lk it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">摘要</h2><p id="f3df" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><code class="fe ko kp kq kr b">terraform apply</code>是Terraform工作流中的核心命令，用于部署配置文件中描述的基础架构。</p><p id="2956" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有关<code class="fe ko kp kq kr b">terraform apply</code>命令的更多文档，请访问Hashicorp网站:</p><div class="mh mi gp gr mj mk"><a href="https://www.terraform.io/cli/commands/apply" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab fo"><div class="mm ab mn cl cj mo"><h2 class="bd iu gy z fp mp fr fs mq fu fw is bi translated">命令:应用|哈希公司的Terraform</h2><div class="mr l"><h3 class="bd b gy z fp mp fr fs mq fu fw dk translated">搜索Terraform文档动手操作:尝试HashiCorp Learn上的Terraform: Get Started集合。更多信息…</h3></div><div class="ms l"><p class="bd b dl z fp mp fr fs mq fu fw dk translated">www.terraform.io</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my lc mk"/></div></div></a></div><p id="4693" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">想要更多的Terraform内容？点击这里查看我在Terraform上的其他文章。</p><p id="4536" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">干杯！🍻</p><div class="mh mi gp gr mj mk"><a href="https://www.buymeacoffee.com/jackwesleyroper" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab fo"><div class="mm ab mn cl cj mo"><h2 class="bd iu gy z fp mp fr fs mq fu fw is bi translated">Jack Roper正在Azure、Azure DevOps、Terraform、Kubernetes和Cloud tech上写博客！</h2><div class="mr l"><h3 class="bd b gy z fp mp fr fs mq fu fw dk translated">希望我的博客能帮到你，你会喜欢它的内容！我真的很喜欢写技术内容和分享…</h3></div><div class="ms l"><p class="bd b dl z fp mp fr fs mq fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="mt l"><div class="mz l mv mw mx mt my lc mk"/></div></div></a></div><p id="2a41" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="na">最初发表于</em><a class="ae li" href="https://spacelift.io/" rel="noopener ugc nofollow" target="_blank"><em class="na">space lift . io</em></a><em class="na">。</em></p></div></div>    
</body>
</html>
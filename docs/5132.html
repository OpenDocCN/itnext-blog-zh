<html>
<head>
<title>Deploying Jakarta EE 9 applications to Apache TomEE using Cargo maven plugin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cargo maven插件将Jakarta EE 9应用程序部署到Apache TomEE</h1>
<blockquote>原文：<a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-apache-tomee-using-cargo-maven-plugin-164644dc9828?source=collection_archive---------8-----------------------#2020-12-17">https://itnext.io/deploying-jakarta-ee-9-applications-to-apache-tomee-using-cargo-maven-plugin-164644dc9828?source=collection_archive---------8-----------------------#2020-12-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d42c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/deploying-jakarta-ee-9-applications-to-apache-tomee-e1a9b9399d9b">将Jakarta EE 9应用程序部署到Apache TomEE之外，</a>在本文中使用Cargo Maven插件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/bbe525b66addc9069a161aebd3e74370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZgar-TMaqJ9r-ovXsLz_A.png"/></div></div></figure><p id="e3b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经讨论了使用官方tomee-maven-plugin对Apache TomEE 的<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/deploy-tomee.md" rel="noopener ugc nofollow" target="_blank">部署。使用tomee-maven-plugin，很容易下载Apache tomee发行版的副本，启动TomEE服务器，然后将应用程序部署到其上。或者将您的应用程序部署到正在运行的TomEE服务器上。官方的maven插件在大多数情况下都很棒，但是它缺乏将应用程序部署到具有细粒度配置的本地安装服务器的能力。</a></p><p id="e91a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Cargo maven插件1.8.3为TomEE 9.0带来了更新，这与Jakarta EE 9一致，有几个部署选项。</p><ul class=""><li id="34df" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">使用独立配置部署到本地TomEE服务器</li><li id="cc2e" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">使用现有配置部署到本地TomEE服务器</li><li id="b2a8" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">使用运行时配置部署到正在运行的TomEE服务器</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="1897" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">先决条件</h1><p id="a7e0" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">确保您已经安装了以下软件。</p><ul class=""><li id="6692" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">Java 8或Java 11 ( <a class="ae kl" href="https://openjdk.java.net/install/" rel="noopener ugc nofollow" target="_blank"> OpenJDK </a>或<a class="ae kl" href="https://adoptopenjdk.net/installation.html" rel="noopener ugc nofollow" target="_blank"> AdoptOpenJDK </a>)</li><li id="7924" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><a class="ae kl" href="http://tomee.apache.org/download-ng.html" rel="noopener ugc nofollow" target="_blank">阿帕奇托米(羽)9.0.0-M3 </a></li><li id="f5d5" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><a class="ae kl" href="http://maven.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇Maven </a></li><li id="b747" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">了解<a class="ae kl" href="https://codehaus-cargo.github.io/" rel="noopener ugc nofollow" target="_blank"> Cargo maven插件</a>的基础。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="9a32" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">部署到本地TomEE服务器</h1><p id="d6df" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">以下配置使用本地安装的服务器，带有<strong class="jp ir">独立</strong>配置。</p><pre class="kn ko kp kq gt mw mx my mz aw na bi"><span id="16e6" class="nb lu iq mx b gy nc nd l ne nf">&lt;profile&gt;<br/>    &lt;id&gt;tomee-local&lt;/id&gt;<br/>    &lt;properties&gt;<br/>        &lt;tomee.home&gt;${project.build.directory}/apache-tomee-plume-${tomee.version}&lt;/tomee.home&gt;<br/>    &lt;/properties&gt;<br/>    &lt;build&gt;<br/>        &lt;plugins&gt;<br/>            &lt;plugin&gt;<br/>                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;<br/>                &lt;executions&gt;<br/>                    &lt;execution&gt;<br/>                        &lt;id&gt;unpack&lt;/id&gt;<br/>                        &lt;phase&gt;process-resources&lt;/phase&gt;<br/>                        &lt;goals&gt;<br/>                            &lt;goal&gt;unpack&lt;/goal&gt;<br/>                        &lt;/goals&gt;<br/>                        &lt;configuration&gt;<br/>                            &lt;artifactItems&gt;<br/>                                &lt;artifactItem&gt;<br/>                                    &lt;groupId&gt;org.apache.tomee.jakarta&lt;/groupId&gt;<br/>                                    &lt;artifactId&gt;apache-tomee&lt;/artifactId&gt;<br/>                                    &lt;version&gt;${tomee.version}&lt;/version&gt;<br/>                                    &lt;classifier&gt;plume&lt;/classifier&gt;<br/>                                    &lt;type&gt;zip&lt;/type&gt;<br/>                                    &lt;overWrite&gt;false&lt;/overWrite&gt;<br/>                                    &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;<br/>                                &lt;/artifactItem&gt;<br/>                            &lt;/artifactItems&gt;<br/>                        &lt;/configuration&gt;<br/>                    &lt;/execution&gt;<br/>                &lt;/executions&gt;<br/>            &lt;/plugin&gt;<br/>            &lt;plugin&gt;<br/>                &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>                &lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>                &lt;configuration&gt;<br/>                    &lt;container&gt;<br/>                        &lt;containerId&gt;tomee9x&lt;/containerId&gt;<br/>                        &lt;type&gt;installed&lt;/type&gt;<br/>                        &lt;home&gt;${tomee.home}&lt;/home&gt;<br/>                    &lt;/container&gt;<br/>                    &lt;configuration&gt;<br/>                        &lt;type&gt;standalone&lt;/type&gt;<br/>                        &lt;properties&gt;<br/>                        &lt;/properties&gt;<br/>                    &lt;/configuration&gt;<br/>                &lt;/configuration&gt;<br/>            &lt;/plugin&gt;<br/>        &lt;/plugins&gt;<br/>    &lt;/build&gt;<br/>&lt;/profile&gt;</span></pre><p id="b2e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个配置中，我们使用依赖maven插件为你准备一个TomEE服务器，当然你也可以使用本地现有的服务器来代替。</p><p id="6997" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe ng nh ni mx b">container</code>部分，使用了<strong class="jp ir">安装</strong>类型，并指定<em class="nj"> home </em>到TomEE服务器的<strong class="jp ir">位置。</strong></p><p id="8eb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe ng nh ni mx b">configuration</code>部分，我们在这里使用一个<strong class="jp ir">独立</strong>配置。</p><blockquote class="nk nl nm"><p id="1f72" class="jn jo nj jp b jq jr js jt ju jv jw jx nn jz ka kb no kd ke kf np kh ki kj kk ij bi translated"><em class="iq">关于TomEE属性的更多细节，参见</em> <a class="ae kl" href="https://codehaus-cargo.github.io/cargo/TomEE+9.x.html" rel="noopener ugc nofollow" target="_blank"> <em class="iq">货物TomEE 9.x集装箱页面</em> </a> <em class="iq">。</em></p></blockquote><p id="0b19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行以下命令来部署我们的应用程序。</p><pre class="kn ko kp kq gt mw mx my mz aw na bi"><span id="8229" class="nb lu iq mx b gy nc nd l ne nf">mvn clean package cargo:run -Ptomee-local</span></pre><p id="b380" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它将执行一系列任务，包括:</p><ul class=""><li id="0402" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">构建项目并将其打包到目标文件夹中的war中。</li><li id="4fbd" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">下载Apache TomEE的副本，并将文件解压缩到目标文件夹。</li><li id="7572" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">然后在目标文件夹中创建一个新的<strong class="jp ir">独立</strong>配置，该配置仅用于该应用程序。</li><li id="b000" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">使用创建的<strong class="jp ir">独立</strong>配置启动TomEE服务器。</li><li id="27d1" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">最后将war部署到正在运行的服务器上。</li></ul><blockquote class="nk nl nm"><p id="c050" class="jn jo nj jp b jq jr js jt ju jv jw jx nn jz ka kb no kd ke kf np kh ki kj kk ij bi translated"><em class="iq">默认情况下，Apache Tomcat和Apache TomEE不包含多域/实例的配置，但有可能，</em> <a class="ae kl" href="https://www.google.com/search?client=firefox-b-d&amp;q=tomcat+multi+instance" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Google搜索结果</em> </a> <em class="iq">中有很多文章。货物生成</em> <strong class="jp ir"> <em class="iq">单机</em> </strong> <em class="iq">配置是配置新实例的一个例子。</em></p></blockquote><p id="5912" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想重新使用TomEE服务器中的默认配置，请将<code class="fe ng nh ni mx b">configuraiton</code>部分更改为以下内容。</p><pre class="kn ko kp kq gt mw mx my mz aw na bi"><span id="2dca" class="nb lu iq mx b gy nc nd l ne nf">&lt;configuration&gt;<br/>    &lt;type&gt;existing&lt;/type&gt;<br/>    &lt;home&gt;&lt;/home&gt;<br/>&lt;/configuration&gt;</span></pre><p id="fd23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个配置中，将type值设置为现有的中的<strong class="jp ir">，并且<em class="nj"> home </em>与<code class="fe ng nh ni mx b">container</code>部分中的home相同，因为对于Glassfish这样的域实例没有特定的配置。</strong></p><p id="3f4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要取消应用程序的部署，只需向控制台发送一个<code class="fe ng nh ni mx b">CTRL+C</code>。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="cf60" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">部署到正在运行的TomEE服务器</h1><p id="cfed" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">部署到正在运行的TomEE服务器，尤其是。它位于不同的主机中，使用以下配置。</p><pre class="kn ko kp kq gt mw mx my mz aw na bi"><span id="e8c3" class="nb lu iq mx b gy nc nd l ne nf">&lt;profile&gt;<br/>    &lt;id&gt;tomee-remote&lt;/id&gt;<br/>    &lt;!-- Add `manager-script` role to the tomee user in tomee/conf/tomcat-users.xml --&gt;<br/>    &lt;!-- Run `mvn clean cargo:deploy -Ptomee-remote` to the running TomEE--&gt;<br/>    &lt;build&gt;<br/>        &lt;plugins&gt;<br/>            &lt;plugin&gt;<br/>                &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>                &lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>                &lt;configuration&gt;<br/>                    &lt;container&gt;<br/>                        &lt;containerId&gt;tomee9x&lt;/containerId&gt;<br/>                        &lt;type&gt;remote&lt;/type&gt;<br/>                    &lt;/container&gt;<br/>                    &lt;configuration&gt;<br/>                        &lt;type&gt;runtime&lt;/type&gt;<br/>                        &lt;properties&gt;<br/>                            &lt;cargo.remote.username&gt;tomee&lt;/cargo.remote.username&gt;<br/>                            &lt;cargo.remote.password&gt;tomee&lt;/cargo.remote.password&gt;<br/>                        &lt;/properties&gt;<br/>                    &lt;/configuration&gt;<br/>                &lt;/configuration&gt;<br/>            &lt;/plugin&gt;<br/>        &lt;/plugins&gt;<br/>    &lt;/build&gt;<br/>        &lt;/profile&gt;</span></pre><p id="a2f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此配置中，在<code class="fe ng nh ni mx b">container</code>部分，将类型设置为<strong class="jp ir">远程</strong>，在<code class="fe ng nh ni mx b">configuration</code>部分将类型设置为<code class="fe ng nh ni mx b">runtime</code>，并且不要忘记设置用于连接远程服务器的用户名和密码。</p><p id="4f56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与Apache Tomcat类似，Cargo也要求配置的用户拥有一个<strong class="jp ir">管理器-脚本</strong>角色。打开<em class="nj">tomee dir/conf/Tomcat-users . XML</em>文件，确保在角色中设置了<strong class="jp ir">管理器脚本</strong>。</p><pre class="kn ko kp kq gt mw mx my mz aw na bi"><span id="e830" class="nb lu iq mx b gy nc nd l ne nf">&lt;user username="tomee" password="tomee" roles="tomee-admin,manager-gui,manager-script" /&gt;</span></pre><p id="b3a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行以下命令来部署和取消部署应用程序。</p><pre class="kn ko kp kq gt mw mx my mz aw na bi"><span id="4c31" class="nb lu iq mx b gy nc nd l ne nf"># deploy applications<br/>mvn clean package cargo:deploy -Ptomee-remote</span><span id="5381" class="nb lu iq mx b gy nq nd l ne nf"># undeploy<br/>mvn cargo:undeploy -Ptomee-remote</span></pre><p id="17f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从我的Github </strong> 中抓取 <a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">源代码。</strong></a></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to build TreeView from JSON in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android中从JSON构建TreeView</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-build-treeview-from-json-in-android-9ec342a6205?source=collection_archive---------3-----------------------#2022-04-11">https://itnext.io/how-to-build-treeview-from-json-in-android-9ec342a6205?source=collection_archive---------3-----------------------#2022-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9b50694b6431a49641f68f2a69900a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2qpeP_-YnTO7obLvYc6AOg.png"/></div></div></figure><p id="0043" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好，上周我已经介绍了Android中的一个新的树形视图实现。在这篇文章中，我将向大家展示如何将JSON数据转换成嵌套的树形视图节点。</p><p id="0f14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您的数据不在本地，但您将作为API响应或从本地字符串接收它们，这种情况会非常有用。在本例中，我们将使用字符串数据作为示例，但如果您从API获取数据，同样的代码也可以工作。</p><p id="9387" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一件事是将TreeView和GSON库添加到项目中。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="d104" class="lg lh iq lc b gy li lj l lk ll">implementation 'io.github.amrdeveloper:treeview:1.0.0'<br/>implementation 'com.google.code.gson:gson:2.9.0'</span></pre><p id="eeb8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为TreeView准备好您的XML布局，不要担心您只需要添加一个RecyclerView，在文档中您会找到如何定制它，并使它支持2d滚动。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="bbe7" class="lg lh iq lc b gy li lj l lk ll">&lt;androidx.recyclerview.widget.RecyclerView<br/>    android:id="@+id/recycler_view"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"/&gt;</span></pre><p id="422a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，您需要创建一个<em class="lm"> TreeViewHolderFactory来将每个视图持有者映射到他的布局</em></p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="d2ca" class="lg lh iq lc b gy li lj l lk ll">TreeViewHolderFactory factory = (v, layout) -&gt; new FileViewHolder(v);</span></pre><p id="4755" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于自定义视图容器的所有细节和文档都在TreeView网站上，在Github存储库中有很多例子。</p><p id="5568" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">设置RecyclerView后，您需要创建一个TreeViewAdapter并设置它</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="3d78" class="lg lh iq lc b gy li lj l lk ll">treeViewAdapter = new TreeViewAdapter(factory); recyclerView.setAdapter(treeViewAdapter);</span></pre><p id="30bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的例子中，想要构建嵌套节点，例如节点JavaFiles节点将Src作为子节点，Src将File1.java节点作为子节点，所以我们的json应该是这样的，你可以扩展它并添加图标、图像等。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/e68554d997ff2f9579f1b846a2b2d1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYM-qXsjB310USPAlfntlQ.png"/></div></div></figure><p id="9fe2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们将创建一个名为TreeNodes的类类型，它将保存一个树节点列表。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/6bc943700f2789f10a21aaadc086dc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyOuyqOXVD4KaUUubapr0w.png"/></div></div></figure><p id="4eb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我们需要创建一个定制的JsonDeserializer，它可以将我们的json数据解析为TreeNodes，这应该取决于您的响应模式。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/5dbf52f403c3cc36ed5d608cd0ac3431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OmqMODAZnHefg7qXZpZYew.png"/></div></div></figure><p id="5958" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后可以在这里使用Gson库获取TreeNodes实例，并将其传递给TreeViewAdapter。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/ebf268b488673c5d173e2db68df4a818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mXZvFObaWqYBzfFl10n6yg.png"/></div></div></figure><p id="8423" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最终的结果将是这样的，但没有图标:D</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/9154707ffc7140544b8d0880daed573d.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*IOlPyPsREgvQj1d75rXYeg.png"/></div></figure><p id="3a54" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在TreeView documentations网站和<a class="ae kw" href="https://github.com/amrdeveloper/treeview" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Github </strong> </a>库上找到本文中的所有代码。</p><p id="0568" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">TreeView Github:<a class="ae kw" href="https://github.com/amrdeveloper/treeview" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">AMR developer/TreeView</strong></a><br/>TreeView网站:<a class="ae kw" href="https://amrdeveloper.github.io/TreeView/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">Github.io/TreeView</strong></a></p><p id="16fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在:<a class="ae kw" href="https://github.com/amrdeveloper" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> GitHub </strong> </a>，<a class="ae kw" href="https://www.linkedin.com/in/amrdeveloper/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> LinkedIn </strong> </a>，<a class="ae kw" href="https://twitter.com/amrdeveloper" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Twitter </strong> </a>上找到我。</p><p id="99dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">享受编程😋。</p></div></div>    
</body>
</html>
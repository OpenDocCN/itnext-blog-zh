<html>
<head>
<title>Svelte Web Component — 5.4KB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">纤薄的Web组件— 5.4KB</h1>
<blockquote>原文：<a href="https://itnext.io/svelte-web-component-5-4kb-4afe46590d99?source=collection_archive---------2-----------------------#2020-04-26">https://itnext.io/svelte-web-component-5-4kb-4afe46590d99?source=collection_archive---------2-----------------------#2020-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="621e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看看如何制作真实的Web组件，并将其与使用不同框架创建的类似Web组件进行比较。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b23380237f24514c5033b9940f03f2cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSdPKak0J9ymchIKD1lFZA.png"/></div></div></figure><p id="d067" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">声明:这不是苗条和棱角的对比。这是如何创建苗条的网页组件，作为一个旁注，我分享了类似的网页组件用Angular创建。在我看来，它们是非常不同的，这不是一篇比较框架的文章。</p><h1 id="c3a2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是苗条？</h1><blockquote class="lv lw lx"><p id="6ba8" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated">“苗条是构建用户界面的一种全新方式。React和Vue等传统框架在<em class="iq">浏览器</em>中完成大部分工作，而Svelte将这些工作转变为<em class="iq">编译步骤</em>，这发生在你构建应用的时候。”</p></blockquote><p id="65ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个解释直接来自<a class="ae mc" href="https://svelte.dev/" rel="noopener ugc nofollow" target="_blank"> Svelte.dev </a>网站。请访问网站了解更多信息。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="96db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">查看GitHub repo和Readme了解更多信息</strong></p><blockquote class="lv lw lx"><p id="15ef" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated"><em class="iq">👨‍💻</em> <a class="ae mc" href="https://github.com/gogakoreli/svelte-snake-web-component" rel="noopener ugc nofollow" target="_blank"> <em class="iq">瘦Web组件GitHub库</em> </a> <em class="iq"> <br/>🎮</em> <a class="ae mc" href="https://gogakoreli.github.io/svelte-snake-web-component/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">这里看一下成品</em> </a> <em class="iq"> <br/> </em> <strong class="jp ir">📝</strong> <a class="ae mc" rel="noopener ugc nofollow" target="_blank" href="/angular-9-snake-web-component-96f61e63b158"> <em class="iq">阅读第二篇:</em> <strong class="jp ir"> <em class="iq"> </em> </strong> <em class="iq">棱角分明的蛇网组件— 51KB </em> </a></p></blockquote></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><h1 id="4c9d" class="kx ky iq bd kz la mk lc ld le ml lg lh li mm lk ll lm mn lo lp lq mo ls lt lu bi translated">如何创建苗条的Web组件？</h1><h2 id="bdbf" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">1.设置苗条项目</h2><p id="8bba" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">从Svelte提供的克隆模板和设置软件包开始</p><pre class="km kn ko kp gt ng nh ni nj aw nk bi"><span id="5ad0" class="mp ky iq nh b gy nl nm l nn no">npx degit sveltejs/template svelte-web-component<br/>cd svelte-web-component<br/>npm install<br/>npm run dev</span></pre><h2 id="a1f1" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">2.使用TypeScript(可选)</h2><p id="d028" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">尽管Svelte还没有对TypeScript的官方支持，但是有一种方法可以做到。社区里有VS代码扩展和模板。但是现在我将坚持使用JavaScript，我将独立地使用TypeScript来编写和编译TS文件，并将它们用作JS文件。看看官方<a class="ae mc" href="https://github.com/sveltejs/svelte/issues/4518" rel="noopener ugc nofollow" target="_blank">路线图</a>。</p><p id="7e00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe np nq nr nh b">tsc --init</code>将创建<code class="fe np nq nr nh b">tsconfig.json</code>文件，您需要指定几个选项。<code class="fe np nq nr nh b">"outDir": "./src", "rootDir": "./ts", "baseUrl": "./ts",</code>这样你就可以把ts文件放在TS文件夹里，在TS watcher的帮助下，它们会被编译并保存到src文件夹里。</p><pre class="km kn ko kp gt ng nh ni nj aw nk bi"><span id="52b9" class="mp ky iq nh b gy nl nm l nn no">npm install <em class="ly">typescript </em>--save-dev<br/>tsc --init<br/>tsc --watch</span></pre><h2 id="6f80" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">3.创建苗条的组件</h2><p id="99f2" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated"><code class="fe np nq nr nh b">App.svelte</code>组件将位于来自模板的src文件夹中。它将被导入到创建和导出应用程序的<code class="fe np nq nr nh b">main.js</code>文件中。</p><ul class=""><li id="7ba2" class="ns nt iq jp b jq jr ju jv jy nu kc nv kg nw kk nx ny nz oa bi translated">首先你需要更新<code class="fe np nq nr nh b">rollup.config.js</code>:</li></ul><pre class="km kn ko kp gt ng nh ni nj aw nk bi"><span id="c73f" class="mp ky iq nh b gy nl nm l nn no">plugins: [<br/>  svelte({<br/>    <strong class="nh ir">customElement: true,</strong></span></pre><ul class=""><li id="d19b" class="ns nt iq jp b jq jr ju jv jy nu kc nv kg nw kk nx ny nz oa bi translated">然后我改名为<code class="fe np nq nr nh b"><strong class="jp ir">App.svelte -&gt; snake.svelte</strong></code> <strong class="jp ir"> </strong>并相应地更新了<code class="fe np nq nr nh b">main.js</code></li><li id="e5e2" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">您需要告诉Svelte，您将把您的组件导出为Web组件。在细长组件中使用这一行:<br/> <code class="fe np nq nr nh b"><strong class="jp ir">&lt;svelte:options tag=”svelte-snake” immutable={true} /&gt;</strong></code> <strong class="jp ir"> </strong> <br/>无论您在标签中放入什么，都会在最后的<code class="fe np nq nr nh b">bundle.js</code>中成为实际的web组件标签。<strong class="jp ir">另外，请注意我使用的是</strong> <code class="fe np nq nr nh b"><strong class="jp ir">immutable={true}</strong></code>，因为我的状态是不可变的，因此Svelte使用引用相等检查来提高性能。</li><li id="042d" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">您不需要在<code class="fe np nq nr nh b">main.js</code>中实际创建组件，因为我们将导出为web组件。您只需要导入和导出组件。看一下我举的<code class="fe np nq nr nh b">main.js</code> : <br/> <code class="fe np nq nr nh b"><strong class="jp ir">import Snake from ‘./snake.svelte’;<br/>export default Snake;</strong></code>的例子</li><li id="ed0e" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">更新<code class="fe np nq nr nh b">public/index.html</code>以使用我们的Web组件，以便它在开发过程中正确显示在浏览器中。<br/> <code class="fe np nq nr nh b"><strong class="jp ir">&lt;body&gt; &lt;svelte-snake&gt;&lt;/svelte-snake&gt; &lt;/body&gt;</strong></code></li></ul><p id="e5ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您已经准备好开发<code class="fe np nq nr nh b">snake.svelte</code>组件，然后我们将把它导出为Web组件。</p><h2 id="1683" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">4.构建和部署</h2><p id="cc72" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">执行<code class="fe np nq nr nh b"><strong class="jp ir">npm run build</strong></code>和<code class="fe np nq nr nh b">bundle.js</code>文件将在<code class="fe np nq nr nh b">public/build</code>文件夹中创建。它包含我们完成的网页组件的风格和Svelte的额外代码，使其工作。</p><p id="549f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将Web组件发布到GitHub页面。你也可以这样做，看看<a class="ae mc" href="https://help.github.com/en/github/working-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site" rel="noopener ugc nofollow" target="_blank">GitHub入门页面</a>。它也将服务于<code class="fe np nq nr nh b">bundle.js</code>文件gzipped，这就是为什么我不自己做。</p><ul class=""><li id="93ee" class="ns nt iq jp b jq jr ju jv jy nu kc nv kg nw kk nx ny nz oa bi translated">在项目的根文件夹中创建<code class="fe np nq nr nh b">docs</code>文件夹</li><li id="363c" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">将<code class="fe np nq nr nh b">bundle.js</code>复制到文档文件夹中</li><li id="3009" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">创建<code class="fe np nq nr nh b">index.html</code>文件并放入<code class="fe np nq nr nh b">docs</code>文件夹。它需要适当的基础href和脚本导入。看一下我的例子:<br/> <code class="fe np nq nr nh b">&lt;base href=”https://gogakoreli.github.io/svelte-snake-web-component/"&gt;<br/>&lt;script defer src=’bundle.js’&gt;&lt;/script&gt;</code></li><li id="cc28" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">最后你可以使用:<code class="fe np nq nr nh b">&lt;body&gt; &lt;svelte-snake&gt;&lt;/svelte-snake&gt; &lt;/body&gt;</code></li><li id="683b" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">你可以告诉GitHub从你的项目的<code class="fe np nq nr nh b">docs</code>文件夹中提供静态文件。<br/>进入GitHub库设置- &gt;选项- &gt; GitHub页面- &gt;来源- &gt; <code class="fe np nq nr nh b">master branch /docs folder</code></li></ul><h2 id="3c07" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">5.捆绑大小</h2><p id="a2d5" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">项目的<code class="fe np nq nr nh b">src</code>文件夹包含几个JS文件和一个Svelte组件。</p><p id="e011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看它们的尺寸:</p><ul class=""><li id="f896" class="ns nt iq jp b jq jr ju jv jy nu kc nv kg nw kk nx ny nz oa bi translated"><code class="fe np nq nr nh b"><strong class="jp ir">input.js, main.js, map.js, models.js, snake.js, store.js</strong></code> <strong class="jp ir"> : ~10.7KB，~2.6KB (Gzipped) </strong></li><li id="0c48" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated"><code class="fe np nq nr nh b"><strong class="jp ir">snake.svelte</strong></code> <strong class="jp ir"> : ~3.5KB，~1.2KB (Gzipped) </strong></li></ul><p id="c4e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe np nq nr nh b">npm run build</code>之后，Svelte将所有的源文件编译成一个<code class="fe np nq nr nh b">bundle.js</code>文件，该文件包含了使Web组件工作所需的所有Svelte函数。在Svelte中没有运行时，有一些功能可以使模板根据变化进行相应的更新，所有的反应代码都可以正常工作。这段代码是在编译时生成的。我没有使用的任何东西都不会出现在<code class="fe np nq nr nh b">bundle.js</code>中。还有<code class="fe np nq nr nh b">bundle.js</code>被缩小变丑。</p><ul class=""><li id="52ed" class="ns nt iq jp b jq jr ju jv jy nu kc nv kg nw kk nx ny nz oa bi translated"><code class="fe np nq nr nh b"><strong class="jp ir">bundle.js</strong></code> <strong class="jp ir"> : ~13.7KB，~ 5.4 kb(gzip)</strong></li></ul><h2 id="3847" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">6。自己尝试苗条的网络组件</h2><p id="ed58" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated"><code class="fe np nq nr nh b">bundle.js</code>包含使<code class="fe np nq nr nh b">svelte-snake</code> Web组件工作所需的所有代码。您可以在您的计算机上创建样本<code class="fe np nq nr nh b">index.html</code>，在浏览器中打开它，并查看成品和捆尺寸。以下列<code class="fe np nq nr nh b">index.html</code>为例:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="og oh l"/></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk translated">index.html样本</figcaption></figure><h2 id="5c8b" class="mp ky iq bd kz mq mr dn ld ms mt dp lh jy mu mv ll kc mw mx lp kg my mz lt na bi translated">7.与有角蛇形腹板部件相比</h2><p id="23c3" class="pw-post-body-paragraph jn jo iq jp b jq nb js jt ju nc jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated"><strong class="jp ir">📝</strong> <a class="ae mc" rel="noopener ugc nofollow" target="_blank" href="/angular-9-snake-web-component-96f61e63b158"> <strong class="jp ir"> Angular Snake Web组件— 51KB </strong> </a> <strong class="jp ir"> : </strong>阅读我的另一篇文章，在那里我创建了与Angular 9完全相同的Web组件。Angular的最终包大小要大得多:大约51KB (Gzipped)对大约5.4KB (Gzipped)，但这并不意味着Angular或Svelte在创建Web组件方面更好。</p><ul class=""><li id="1904" class="ns nt iq jp b jq jr ju jv jy nu kc nv kg nw kk nx ny nz oa bi translated">Angular附带了运行时，由于RxJS，bundle也变大了。Angular是一个完整的框架，即使在产品构建期间有一个非常好的树摇动过程，Angular也是有成本的。当构建最小的包大小不是最优先考虑的应用程序时，这个成本可以忽略不计。Angular拥有非常完善的生态系统，拥有更大的足迹是有道理的。在我看来，Angular Web组件是有意义的，它们有自己的目标用例。</li><li id="565a" class="ns nt iq jp b jq ob ju oc jy od kc oe kg of kk nx ny nz oa bi translated">因为没有运行时，所以Svelte的占用空间更小。Svelte设法在编译时确定组件工作所需的内容。然后注入特定的瘦函数，使模板、绑定和反应代码工作。没有单独的运行时来查找对更新模板的更改。你写反应式代码，Svelte把它变成命令式的对应物以获得性能。</li></ul></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="3adb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">查看GitHub repo和Readme了解更多信息</strong></p><blockquote class="lv lw lx"><p id="019c" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated"><em class="iq">👨‍💻</em> <a class="ae mc" href="https://github.com/gogakoreli/svelte-snake-web-component" rel="noopener ugc nofollow" target="_blank"> <em class="iq">瘦Web组件GitHub库</em> </a> <em class="iq"> <br/>🎮</em> <a class="ae mc" href="https://gogakoreli.github.io/svelte-snake-web-component/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">这里看一下成品</em> </a> <em class="iq"> <br/> </em> <strong class="jp ir">📝</strong> <a class="ae mc" rel="noopener ugc nofollow" target="_blank" href="/angular-9-snake-web-component-96f61e63b158"> <em class="iq">阅读第二篇:</em> <strong class="jp ir"> <em class="iq"> </em> </strong> <em class="iq">棱角分明的蛇网组件— 51KB </em> </a></p></blockquote></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="9ea9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你认为这篇文章有趣吗？</p><p id="c2b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">单击👏按钮</strong>传播文章<br/> <a class="ae mc" href="https://twitter.com/GogaKoreli" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">在Twitter上关注我@ gogakoreli</strong></a><strong class="jp ir"><br/></strong>在Medium上关注我<a class="om on ep" href="https://medium.com/u/9d3b09790759?source=post_page-----4afe46590d99--------------------------------" rel="noopener" target="_blank">戈加Koreli </a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Angular-Subjects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度-主题</h1>
<blockquote>原文：<a href="https://itnext.io/angular-subjects-8ed5bf7c4f00?source=collection_archive---------0-----------------------#2018-10-10">https://itnext.io/angular-subjects-8ed5bf7c4f00?source=collection_archive---------0-----------------------#2018-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3b52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我最近写了一个关于使用<code class="fe km kn ko kp b">Input</code> s和<code class="fe km kn ko kp b">Output</code> s在父组件和子组件之间来回传递数据的<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/angular-input-output-f0418ab4cc91">故事</a>。如果我们有一个多对多的关系，而不是一对多或多对一的父子数据关系。在这种情况下，<code class="fe km kn ko kp b">Input</code> s和<code class="fe km kn ko kp b">Output</code> s不是最佳选择。相反，我们可以用<code class="fe km kn ko kp b">Subject</code> s</p><p id="e981" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">反应式编程语言Rxjs 非常强大，有很好的类型脚本支持。Rxjs的核心是使用observables让任何人在任何地方都能听到价值变化。<code class="fe km kn ko kp b">Observable</code>是监听数据变化的最基本的实现，但是我发现<code class="fe km kn ko kp b">BehaviorSubject</code>更容易使用，并且通常有更广泛的用例。<code class="fe km kn ko kp b">BehaviorSubject</code>和<code class="fe km kn ko kp b">Subject</code>的唯一区别是<code class="fe km kn ko kp b">BehaviorSubject</code>有一个初始值，当订阅时会发出。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/740645478c4c24a662f54daafecca89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k8d6fftoiv55muX8Nc5sSA.png"/></div></div></figure><h1 id="54c7" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">行为主体</h1><p id="4c2b" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe km kn ko kp b">BehaviorSubject</code>从<code class="fe km kn ko kp b">rxjs</code>库中导入，这是生成的角度项目中的标准。</p><pre class="kr ks kt ku gt mf kp mg mh aw mi bi"><span id="6584" class="mj ld iq kp b gy mk ml l mm mn">// <em class="mo">grocery-store.service.ts</em></span><span id="7604" class="mj ld iq kp b gy mp ml l mm mn">import { Injectable } from '@angular/core';<br/>import { BehaviorSubject } from 'rxjs';</span><span id="f4e8" class="mj ld iq kp b gy mp ml l mm mn">@Injectable({<br/>  providedIn: 'root'<br/>})</span><span id="18c7" class="mj ld iq kp b gy mp ml l mm mn">export <strong class="kp ir">class</strong> GroceryStoreService {<br/>  <strong class="kp ir">private</strong> appleBasket: BehaviorSubject&lt;number&gt; = new BehaviorSubject&lt;number&gt;(0);<br/>  <strong class="kp ir">private</strong> limeBasket: BehaviorSubject&lt;number&gt; = new BehaviorSubject&lt;number&gt;(10);<br/>  <strong class="kp ir">constructor</strong>() {}</span><span id="605b" class="mj ld iq kp b gy mp ml l mm mn">  getAppleBasket(): BehaviorSubject&lt;number&gt; {<br/>    return this.appleBasket;<br/>  }</span><span id="53c0" class="mj ld iq kp b gy mp ml l mm mn">  getLimeBasket(): BehaviorSubject&lt;number&gt; {<br/>    return this.limeBasket;<br/>  }<br/>}</span></pre><p id="d86c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们用创建一个新的<code class="fe km kn ko kp b">BehaviorSubject</code></p><pre class="kr ks kt ku gt mf kp mg mh aw mi bi"><span id="8142" class="mj ld iq kp b gy mk ml l mm mn"><strong class="kp ir">private</strong> limeBasket: BehaviorSubject&lt;number&gt; = new BehaviorSubject&lt;number&gt;(10);</span></pre><p id="514f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它简单地说明了<code class="fe km kn ko kp b">limeBasket</code>的类型是number，应该用<code class="fe km kn ko kp b">10</code>初始化。</p><p id="d15c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">limeBasket</code>有两个主要方法，<code class="fe km kn ko kp b">subscribe</code>和<code class="fe km kn ko kp b">next</code>。<code class="fe km kn ko kp b">subscribe</code>每当有变化时，广播该值。<code class="fe km kn ko kp b">next</code>向<code class="fe km kn ko kp b">limeBasket</code>传递新值，从而触发<code class="fe km kn ko kp b">subscribe</code>进行广播。凡是订阅了<code class="fe km kn ko kp b">limeBasket</code>的，都将获得价值。</p><pre class="kr ks kt ku gt mf kp mg mh aw mi bi"><span id="1ebe" class="mj ld iq kp b gy mk ml l mm mn">// app.component.ts</span><span id="cc08" class="mj ld iq kp b gy mp ml l mm mn">...</span><span id="e1b9" class="mj ld iq kp b gy mp ml l mm mn"><strong class="kp ir">constructor</strong>(<br/>  <strong class="kp ir">private</strong> groceryStoreService: GroceryStoreService<br/>) {</span><span id="9499" class="mj ld iq kp b gy mp ml l mm mn">  ...</span><span id="c68c" class="mj ld iq kp b gy mp ml l mm mn">  this.limesBasket$ = this.groceryStoreService.getLimeBasket();</span><span id="209c" class="mj ld iq kp b gy mp ml l mm mn">  ...</span><span id="e9a6" class="mj ld iq kp b gy mp ml l mm mn">  this.limesBasket$.subscribe(value <strong class="kp ir">=&gt;</strong> {<br/>    this.lastEvent = `Limes basket now has ${value} limes(s)`;<br/>  });<br/>}</span><span id="62b7" class="mj ld iq kp b gy mp ml l mm mn">...</span></pre><p id="34a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了向<code class="fe km kn ko kp b">BehaviorSubject</code>发送一个新值，我们称之为<code class="fe km kn ko kp b">next()</code>。</p><pre class="kr ks kt ku gt mf kp mg mh aw mi bi"><span id="0636" class="mj ld iq kp b gy mk ml l mm mn">// <em class="mo">app.component.ts</em></span><span id="bb7f" class="mj ld iq kp b gy mp ml l mm mn">...</span><span id="b8a5" class="mj ld iq kp b gy mp ml l mm mn">changeLimes() {<br/>  this.limesBasket$.next(this.numberOfLimes);<br/>}</span><span id="937f" class="mj ld iq kp b gy mp ml l mm mn">...</span></pre><p id="6423" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Angular的一个很好的特性是，如果你的标记中只有<strong class="jp ir">和</strong>需要主题的值，你可以避免订阅<code class="fe km kn ko kp b">BehaviorSubject</code>。</p><pre class="kr ks kt ku gt mf kp mg mh aw mi bi"><span id="1b05" class="mj ld iq kp b gy mk ml l mm mn">// <em class="mo">lime.component.html</em></span><span id="efc4" class="mj ld iq kp b gy mp ml l mm mn">&lt;div class="container"&gt;<br/>  Number of limes: {{ limesBasket$ | async }}<br/>&lt;/div&gt;</span></pre><p id="0039" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个<code class="fe km kn ko kp b">async</code>管道是Angular的开箱即用，基本上是说，“嘿，这是某种类型的可观测值，所以为我订阅，把值放在这里。”</p><h1 id="a7b3" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">注释</strong></h1><ul class=""><li id="3d0b" class="mq mr iq jp b jq ma ju mb jy ms kc mt kg mu kk mv mw mx my bi translated">确保将您的服务作为提供者包含在<code class="fe km kn ko kp b">app.module.ts</code>中。</li><li id="494d" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">在属性/变量<code class="fe km kn ko kp b">limeBasket$</code>的末尾添加一个<code class="fe km kn ko kp b">$</code>，是用于表示可观察类型的通用约定。</li></ul><h1 id="faea" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">摘要</h1><p id="09f5" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe km kn ko kp b">BehaviorSubject</code>是在大量组件之间来回传递数据的好方法。两个主要方法是<code class="fe km kn ko kp b">subscribe</code>，用于监听新值，和<code class="fe km kn ko kp b">next</code>，用于设置新值。</p><p id="c7cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看我在Github上的例子:<a class="ae kl" href="https://github.com/orange-bees/angular-concepts-tutorials" rel="noopener ugc nofollow" target="_blank">https://github.com/orange-bees/angular-concepts-tutorials</a>。</p><h1 id="9a03" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">关于我</h1><p id="e877" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我在南卡罗来纳州格林维尔的一家软件工程咨询公司<a class="ae kl" href="https://orangebees.com/" rel="noopener ugc nofollow" target="_blank"> Orange Bees </a>担任首席工程师。我写得棱角分明。NET应用，在Azure架构项目(Azure Developer Associate认证)，涉猎ElasticSearch和node . js<br/>你可以在<a class="ae kl" href="https://www.linkedin.com/in/james-l-gross/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上找我。</p></div></div>    
</body>
</html>
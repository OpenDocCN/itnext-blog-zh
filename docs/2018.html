<html>
<head>
<title>The Reality of JavaScript Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript性能的现实</h1>
<blockquote>原文：<a href="https://itnext.io/the-reality-of-javascript-performance-4ec9747882d3?source=collection_archive---------4-----------------------#2019-03-17">https://itnext.io/the-reality-of-javascript-performance-4ec9747882d3?source=collection_archive---------4-----------------------#2019-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/44c78a531eaea594faeced2b827a6389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i-1ANpnQ2Nzz0FWs"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">由<a class="ae jd" href="https://unsplash.com/@joelmmathey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔尔·M·马修</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="b6ea" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">速度妖龟！</h2></div><p id="0150" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想知道如何让JavaScript更快，这篇文章将解释这在现实世界中是多么的无关紧要。</p><p id="b05f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我特别指的是普通的JavaScript开发人员。如果你是一名数据科学家，大量的数据就是你的生命；我明白了。</p><h1 id="0f13" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">JavaScript开发则不同</h1><p id="a417" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在典型的web应用程序中，您一次处理3-20个项目，因此性能可以忽略不计。</p><p id="8c1a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您知道JavaScript中不同数据结构的性能差异吗？我知道我没有，但我有一些想法。问题是，我在JavaScript中很少遇到大型数据集。大多数时候，我在遗留应用程序中发现它们。尽管如此，通常还有更大的性能瓶颈。</p><p id="3d2f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可能正在处理大型数据集。即使在Node.js中，通常也是对数据进行分页，让数据库来处理繁重的工作。考虑到很少能看到多个条目，我遇到过很多真正关心JavaScript性能的人。</p><p id="6dae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我认识的一个人在嵌入式系统领域工作了多年。我也在里面工作过。性能、内存、输出代码大小，在这些场景中，一切都很重要。但是他喜欢把这种心态带到我们的前端代码中。因为他对速度的需求，他创造了许多不可读的代码，这些代码最终被删除并重写。</p><p id="aef2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">还有一种情况是2016年左右我开始写功能代码的时候。我记得在一次代码审查中，有人抱怨连续两次使用<code class="fe mp mq mr ms b">map</code>函数。</p><p id="cbf7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是一个由3个条目组成的数组，使用了两个<code class="fe mp mq mr ms b">map</code>语句使得它更容易阅读，但是在那个评论中有人担心它会降低执行速度。速度上的差异可能只有几微秒，但这对那些开发者来说很重要。</p><p id="7e78" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">几乎在所有情况下，我都担心代码的可读性和可维护性。我关心的是，其他开发人员是否很容易进来并弄清楚发生了什么。我担心6个月后我可能不得不重构或修复代码中的一个bug。</p><p id="7ad9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在JavaScript领域，我的观点是性能应该被忽略。让它工作，让它可维护，然后再考虑改进它。因为改进JavaScript很可能会使代码变得不可读。</p><h1 id="796a" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">当下的表现</h1><p id="12cc" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">应用程序的性能在很大程度上取决于JavaScript解释器。在很大程度上，随着未来解释器的更新，你过去写的很多东西会变得更快。</p><p id="dc0d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但也可能是相反的。你可以用janky方法X写你的代码，因为你听说它更快。</p><p id="2e10" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当V8得到升级时，方法Y突然变得和它应该的一样快，但是现在你有了用janky方式编写的所有遗留代码。除非您真的需要这种性能，否则您只是让自己成为了一个传统的应用程序。</p><p id="34c0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不相信我？不讨论节点10与节点8的性能数据，让我们来看一个几年前让我着迷的真实例子。</p><p id="8cda" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们来看看这个2010年的StackOverflow回答:<br/>T3】https://stack overflow . com/questions/2781686/JavaScript-string-concatenation-slow-performance-array-join/2781854 # 2781854</p><blockquote class="mt mu mv"><p id="81eb" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated">看来Array.join()在大多数情况下跨浏览器更快。</p></blockquote><p id="befe" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">而这篇文章也出自2010:<br/><a class="ae jd" href="https://www.sitepoint.com/javascript-fast-string-concatenation/" rel="noopener ugc nofollow" target="_blank">https://www . site point . com/JavaScript-fast-string-concatenation/</a></p><blockquote class="mt mu mv"><p id="9eb7" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated">Chrome 6.0 :标准的字符串追加通常比数组连接更快，但都在10毫秒内完成。</p><p id="3de1" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated"><strong class="kx jh"> Opera 10.6 </strong>:同样，标准追加更快，但差别很小——通常是15毫秒，而数组连接是17毫秒。</p><p id="dcf6" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated"><strong class="kx jh"> Firefox 3.6 </strong>:浏览器通常需要30毫秒左右的时间。数组连接通常有边缘，但只有几毫秒。</p><p id="19a4" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated"><strong class="kx jh"> IE 8.0 </strong>:标准的追加需要30毫秒，而数组连接需要两倍以上的时间——通常为70毫秒。</p><p id="bb8b" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated"><strong class="kx jh"> Safari 5.0.1 </strong>:奇怪的是，一个标准的append不超过5ms，但是一个数组join却慢了十倍以上，为55ms。</p></blockquote><p id="2ca6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">字符串串联和<code class="fe mp mq mr ms b">Array.prototype.join</code>相比真的那么慢吗？没有。不再是了。但是由于这篇文章，您可能会看到一些遗留代码仍然在使用它。为什么？</p><blockquote class="mt mu mv"><p id="cee8" class="kv kw lr kx b ky kz kh la lb lc kk ld mw lf lg lh mx lj lk ll my ln lo lp lq ij bi translated">IE7和更低版本使用串联处理程序重复复制字符串，导致时间和内存使用呈指数级增长。相比之下，阵列连接在不到200毫秒的时间内完成，快了800多倍。</p></blockquote><p id="bd9c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">多年前，我搞砸了一个代码项目，因为我选择了“更快”<code class="fe mp mq mr ms b">join</code>的方法。我的代码根本不可读，更不用说速度了。</p><p id="867c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为IE7，我曾经不得不做一些奇怪的事情来提高性能。但是你猜怎么着？在现实世界中，这些表现都无关紧要；至少，不包括我正在开发的应用程序。</p><h1 id="7e38" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">真是个伪君子</h1><p id="b289" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">实际上，我最近遇到了一种情况，我需要更快的执行时间。为此我使用了转换器，并写了几篇关于T2 JavaScript处理速度的文章。那个项目有一个20K项的列表，这无疑导致了一个性能瓶颈。</p><p id="dc82" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是我不是说过你不会碰到这种东西吗？</p><p id="e437" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于这种独一无二的情况，真正的解决方案不是自己解决，而是获得一个预先格式化的JSON文件。</p><p id="1eae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这样，我就不必处理数据，公司也可以静态托管数据。即使在客户端创建文件需要一分钟，这也是一台工作机的时间和资源，而不是每次打开浏览器时每台客户机的时间和资源。</p><p id="4962" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我写了自己的解决方案作为临时措施，但是在证明了那个解决方案之后，他们接管格式化是有意义的。</p><p id="6ba0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以真正的解决方案是让别人来写代码。有点逃避，但这也是我在行业中遇到的:“让后端开发人员管理他们自己的数据”。</p><h1 id="2056" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">DOM渲染</h1><p id="cecb" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我认为很多性能问题都来自于没有处理异步代码。这就是我在职业生涯中发现真正性能瓶颈的地方。</p><p id="128e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">比如:</p><ul class=""><li id="1945" class="mz na jg kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated">点击一个按钮，但没有给出任何迹象表明后台正在发生的事情(看看你的蒸汽注册过程！).</li><li id="305c" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">呈现文本输入，但不允许用户一看到它就点击并开始输入。</li></ul><p id="134c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">允许您的应用程序并发运行可以解决用户感觉到的性能问题。例如，React有异步模式，现在称为并发模式。它允许以更高的优先级呈现对某些用户难以处理的组件的更改。</p><p id="d0a4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更快地加载数据没有帮助，因为这是一个更深层次的基本问题:DOM很慢。事实上，任何“打印”命令都会很慢。想想输出到控制台，甚至一个真正的纸打印机。</p><h1 id="50d0" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">结论</h1><p id="2f2d" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">处理速度重要吗？只有在非常特殊的情况下。找出那些在哪里，并在那些部分上工作。不要为了获得几微秒的额外执行时间而使整个代码库不可读。</p><p id="e62e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请记住，你必须雇用其他开发人员来从事这些项目，你希望他们高兴！当你可以把时间花在改善用户体验上时，不要浪费时间担心性能。</p><h1 id="740a" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">更多阅读</h1><p id="963d" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如果您想了解更多关于JavaScript性能的内容，请查看以下文章:</p><ul class=""><li id="cae4" class="mz na jg kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/speed-up-javascript-array-processing-8d601c57bb0d">加速JavaScript数组处理</a></li><li id="6786" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/using-transducers-to-speed-up-javascript-arrays-92677d000096">使用转换器加速JavaScript数组</a></li></ul><p id="73c7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢你所读的，请查看我关于类似的令人大开眼界的主题的其他文章:</p><ul class=""><li id="8d9c" class="mz na jg kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/the-definitive-guide-to-callbacks-in-javascript-44a39c065292">试听:权威指南</a></li><li id="9398" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/promises-the-definitive-guide-6a49e0dbf3b7">承诺:权威指南</a></li><li id="e1de" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated"><a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/feature-flags-be-truly-agile-820ff50294c">特性标志:真正敏捷</a></li><li id="f767" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">用食物表情符号制作便便</li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>VMware vSAN memory consumption and vSCSIstats dashboards — Opvizor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VMware vSAN内存消耗和vSCSIstats控制面板— Opvizor</h1>
<blockquote>原文：<a href="https://itnext.io/vmware-vsan-memory-consumption-and-vscsistats-dashboards-opvizor-59725cbb0eed?source=collection_archive---------5-----------------------#2019-03-19">https://itnext.io/vmware-vsan-memory-consumption-and-vscsistats-dashboards-opvizor-59725cbb0eed?source=collection_archive---------5-----------------------#2019-03-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0ef4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">VMware vSAN社区发展迅速，我们看到越来越多的客户将我们的vSAN插件集成到Performance Analyzer中。</p><p id="317f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据大量反馈和一些有趣的发现，我们更新并添加了一些控制面板，以显示每个虚拟机的存储直方图，并计算当前和未来的vSAN内存消耗。尤其是内存消耗并不是每个客户都清楚的，我们希望显示真实的数字。</p><p id="c2b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从VMware vSAN内存消耗开始，它是什么，它是如何计算的，为什么它是一个话题。</p><p id="8b0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所需的内存量是强制性的，无法避免，也不应该减少以保持优化的性能。内存开销对于任何虚拟存储系统都是已知的，只是数量有所不同。谈到vSAN，最大的区别是，您不会将内存消耗视为任务、进程或虚拟机。当虚拟存储解决方案运行虚拟机时，可以在虚拟机级别简单地检查内存使用情况，这是最大的区别。</p><p id="e6d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在设计VMware vSAN环境时，牢记内存消耗非常重要。当运行一个家庭实验室时，这个数量可能是令人痛苦的。</p><p id="8c57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一篇关于它的非常好的VMware知识库文章:<a class="ae kl" href="https://kb.vmware.com/s/article/2113954" rel="noopener ugc nofollow" target="_blank">https://kb.vmware.com/s/article/2113954</a></p><p id="fcf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在使用https://kb.vmware.com/s/article/2071753的虚拟存储区域网<a class="ae kl" href="https://kb.vmware.com/s/article/2071753" rel="noopener ugc nofollow" target="_blank">时，你肯定想避免缺点</a></p><p id="3264" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">知识库文章描述了计算以适当的方式运行vSAN的内存消耗的公式，作为所涉及的组件</p><p id="fb02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要计算这些版本中的vSAN内存消耗，请使用以下公式:</p><p id="608d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">base consumption+(NumDiskGroups *(diskgroupbasecoumption+(SSDMemOverheadPerGB * SSDSize))+(NumCapacityDisks * capacitydiskbasecoumption)</strong></p><p id="2ef9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中:</p><ul class=""><li id="d845" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">BaseConsumption:是每个ESXi主机的vSAN消耗的固定内存量。</li><li id="5ab3" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">NumDiskGroups:是主机中磁盘组的数量，该值的范围应为1到5。</li><li id="28b4" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">DiskGroupBaseConsumption:是分配给主机中每个磁盘组的固定内存量。这主要用于在每个磁盘组级别上分配用于支持动态操作的资源。</li><li id="b683" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">SSDMemOverheadPerGB:是每GB SSD分配的内存量。</li><li id="c0f3" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">SSDSize:是SSD磁盘的大小，以GB为单位。</li><li id="b6ca" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">NumCapacityDisks:是主机中容量磁盘的数量(跨所有磁盘组)。</li><li id="2067" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">CapacityDiskBaseConsumption:是每个容量磁盘分配的内存量。</li></ul><p id="10d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:所有闪存的SSD大小上限为600GB，因此使用大于600 GB的SSD不会消耗额外的内存。常数</p><ul class=""><li id="df43" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">基本消耗= 5426 MB</li><li id="88e5" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">磁盘组基础消耗= 636 MB</li><li id="49e4" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">SSDMemOverheadPerGB(hydrid)= 8 MB</li><li id="bd50" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">SSDMemOverheadPerGB(全闪存)= 14 MB</li><li id="593d" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">CapacityDiskBaseConsumption = 70 MB</li></ul><p id="3587" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:在这些版本中，加密和重复数据删除功能对内存消耗没有影响。</p><p id="8e83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">坏事——谁愿意坐下来计算数字。因此，我们创建了一个仪表板来为您进行计算，并以一种很好的方式将其可视化。此外，您可以在混合计算和全闪存计算之间切换，控制面板名为“VMware vSAN:容量和平衡”。它显示了所有vSAN节点的分布。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/a5829f1158b23df81abde9c2454b510e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jtVymebYgdM3vI-v.png"/></div></div></figure><p id="f941" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们花时间开发的另一个重要主题是存储配置文件直方图。它允许您检查系统的存储配置文件。更多读取，更多写入，什么块大小。这有助于规划存储升级。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/09a9b0d724025529ab3283c573d186c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YXVlwpAqTb2Iz_cG.png"/></div></div></figure><p id="56ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">独立如果您正在使用VMware vSAN或任何其他存储系统，并且需要获得数据存储区、单个虚拟机或整个群集的存储配置文件，请务必查看我们将vSCSIstats引入Performance Analyzer的最新集成。</p><p id="01af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一台虚拟机:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/9e2c65893bfbb4a68bb1744bd09162fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sdlROaZYfdEJxxLc.png"/></div></div></figure><p id="b148" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是数据存储视图:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/0def1ed75b4e5797a13003bd60c886f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m0Z2ATr4ik0OwwmQ.png"/></div></div></figure><p id="48b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请务必遵循我们的指南如何激活我们的vSCSIstats收集器。</p><p id="2255" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://opvizor.atlassian.net/wiki/spaces/OPVPA/pages/860160001/vscsiStats" rel="noopener ugc nofollow" target="_blank">https://opvizor . atlassian . net/wiki/spaces/op VPA/pages/860160001/vscsiStats</a></p><p id="34b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于vscsiStats本身会消耗一些主机资源，因此不建议让它一直运行。但是，如果您必须对存储性能进行故障排除，它会非常有帮助。</p><p id="e6c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要启用性能分析器vSCSIstats收集器，只需向要监视的主机添加一个自定义属性“opvizor.vscsistats ”,并将其设置为1以开始数据收集。将其设置为0以停止数据收集。</p><p id="2b3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想了解有关vSCSIstats的更多信息，请查看博客文章:<a class="ae kl" href="http://buildvirtual.net/using-vscsistats-to-gather-storage-performance-data/" rel="noopener ugc nofollow" target="_blank">http://buildvirtual . net/using-vSCSIstats-to-gather-storage-performance-data/</a></p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="5f42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【www.opvizor.com】最初发表于<a class="ae kl" href="https://www.opvizor.com/vmware-vsan-memory-consumption-and-vscsistats-dashboards" rel="noopener ugc nofollow" target="_blank"><em class="lt"/></a><em class="lt">。</em></p></div></div>    
</body>
</html>
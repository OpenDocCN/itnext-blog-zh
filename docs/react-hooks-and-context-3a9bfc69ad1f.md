# 反应钩子和上下文

> 原文：<https://itnext.io/react-hooks-and-context-3a9bfc69ad1f?source=collection_archive---------2----------------------->

## 使用管理用户数据的指南

## React 给了我们许多强大的特性，利用这些特性，我们可以很容易地创建一个内存用户管理钩子。

![](img/f0db8064198e0bd0b938060dd52bc57d.png)

钩子为我们提供了一种简单的方法来存储数据，更新数据，并且在我们需要的时候运行不同的函数。在最近的一个项目中研究存储用户令牌的最佳方式时，我遇到了一个问题，我想在内存中存储一个用户令牌。为了存储和共享这个令牌，我不得不使用 React 的上下文来确保数据持久化和挂钩，以便将导入保持在最低限度并访问这些数据。但是有几个问题需要先处理。

## 数据不会在钩子中持久化

当在 React 代码中调用一个钩子时，它会创建钩子的单独实例。在下面的例子中，我们有一个小程序，其中 ComponentOne 使用钩子显示数据，ComponentTwo 更新数据。当我们运行此代码时，组件一将显示“这是数据”，而组件二将显示“这也是数据”。这里可以查看运行代码[。](https://codesandbox.io/s/hook-state-unpersisted-bkx7m)

为了确保我们的用户钩子能够有效地存储和共享使用数据，我们将使用一个名为 createContext 的 React 函数。

## 在上下文中存储状态

Context 旨在共享可以被视为 React 组件树的“全局”数据，例如当前经过身份验证的用户、主题或首选语言。在下面的例子中，我们将创建一些存储用户名的上下文。你可以在这里看到运行[的代码](https://codesandbox.io/s/persistusername-1qkhq?file=/src/App.js:0-909)。

当运行这两个组件时，它们现在都显示名称“Santa”。这是因为我们设置了一个“提供者”。每个上下文对象都有一个提供者。提供者将总是接受一个值属性，在本例中，我们传递了一个带有用户名的对象和一个名为 set username 的方法。现在，当我们调用我们的使用上下文时，我们会得到一个包含这些值的对象。

## 定制挂钩的改进

上面的代码有一个小问题，我们可以通过使用自定义钩子来解决。在像这样的小应用程序中，这很好，我们所有的代码都是本地的，易于使用。但是在一个更大的应用程序中，每次我们想要使用 AuthContext 时，我们都必须定义两个导入。我们必须从 React 导入 useContext，从我们自己的代码导入 AuthContext。

我们可以不这样做，而是通过构建一个自定义钩子来导入。你可以在这里看到现场代码。

我们现在可以简单地导入我们的 useAuth 钩子，而不是两次导入，这使我们可以访问 AuthContext 上存在的所有方法和属性。

## 结论

使用钩子、上下文或 React 等库提供的任何其他特性没有对错之分。这一切都是为了找出最适合你的方法。我希望这个例子有助于你理解用钩子共享状态。

如果您想注册访问更多媒体内容，请点击以下[链接](https://thewebuiguy.com/membership)。这将使我能够写更多的故事，通过一个小的委员会从媒体。
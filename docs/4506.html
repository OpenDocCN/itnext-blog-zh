<html>
<head>
<title>Creating a Custom Library with Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用角度创建自定义库</h1>
<blockquote>原文：<a href="https://itnext.io/creating-a-custom-library-with-angular-888a7e3689ca?source=collection_archive---------0-----------------------#2020-07-15">https://itnext.io/creating-a-custom-library-with-angular-888a7e3689ca?source=collection_archive---------0-----------------------#2020-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0e8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">嘿伙计们，我今天在这里谈论自定义库。我希望在本文结束时，你会知道如何创建自己的自定义库。😊</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/26c75b9972b92f3aa0fdbb2197e0cdd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnvAq1eyq-LzlSpvm-Esfw.png"/></div></div></figure></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="d9bb" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">介绍</h1><p id="3aec" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">当您对Angular架构进行初步规划时，您可能会发现您的一个共享资源需要在多个应用程序之间共享。例如，你想把它放在<a class="ae mk" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>中，或者放在你的公司可能使用的内部<a class="ae mk" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>中。这样，多个应用程序都可以利用它。听起来不错？是的，听起来很棒😊。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="40a0" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">创建自定义库</strong></h1><p id="22f1" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">首先，您需要使用CLI创建一个新项目。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/de010b6e9dc9c388203109f0bd97b679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*5pBX2EchIUbsLLyc-JU0_A.png"/></div></figure><p id="4c55" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这一点上我们应该都很好。从这里开始，我们需要使用Angular 6或更高版本中CLI提供的命令，即<em class="mm"> ng generate </em>。这个<em class="mm"> ng生成</em>库被设计用来创建一个定制的共享库。然后，通过为您的库命名，它将被添加到一个单独的项目中，这个项目称为工作区。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mn"><img src="../Images/f4c29ff78bb99903ef6cf57916ba24eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3PT8dXKv5SWgK8R5mFsG-g.png"/></div></div></figure><p id="737b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当你做<em class="mm"> ng new </em>的时候，你会得到一个包含一个项目的工作空间，这个项目就是你的web项目。这个<em class="mm"> ng generate </em>将在工作区中添加第二个版本，这样我们就可以在Angular应用程序中测试我们的库，而无需发布到npm或任何其他资源。现在，这将修改<em class="mm"> tsconfig </em>文件，该文件将被更新，以便Angular项目(工作区中的独立项目)了解如何访问我们将要构建的库，即共享库。</p><p id="7ecf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，您可以使用<em class="mm"> ng build </em>命令构建您的库，然后为它命名您的项目，如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/c0516c931bd51979acab80cf7d45954d.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*hiB1ue_yMN9KiCd-gEF6xQ.png"/></div></figure><p id="70e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以使用它，并在工作空间内的另一个Angular项目中直接测试它。因此，它使做这件事变得非常容易，而不必在某个地方发布到npm。在那之后，一旦我们准备就绪，我们将希望发布到npm，我们已经对它进行了测试，它看起来不错，因为我们希望能够从npm引入，无论它是任何人都可以访问的npm，还是您公司可能拥有的内部npm。我们希望将这些应用程序整合到我们不同的应用程序中，这样我们就可以得到重用。如果你是npm的新手，有一个<a class="ae mk" href="https://docs.npmjs.com/packages-and-modules/contributing-packages-to-the-registry" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/595491293cd1ed0e112ff262f1e14cd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*2vvUVeU1hBAZ-CUmENPFgA.png"/></div></figure><p id="5905" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要这样做才能进入dist文件夹，其中将包含package.json文件。这将用于向npm发布。我们只需要编写以下命令:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/8bc5582a1d196d588403865a1b3fc7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*nOphXW6Q9x4g24ZQ2FEQ_A.png"/></div></figure><p id="db26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么，我们应该看到我们的解决方案中的不同之处吗？我们走吧，☺.</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/5043cc6d09328ed5b43e80bf0616a3db.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*7FX97rjxlKWxoZAWJyHT6w.png"/></div></figure><p id="744b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，你会注意到我们有一个<em class="mm">项目</em>文件夹。我们现在也有了更新的<em class="mm"> tsconfig </em>，如下图所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/028f423184b69febbda455e5fcd50e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*7BULtldHQMJjhh6i4tKJpQ.png"/></div></figure><p id="c4c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它添加了路径，我们最终将在哪里建立我们的dist文件夹，一旦我们做了一个构建，这就是为什么你必须先构建，然后你才能这样做，因为TypeScript实际上是要指望这能够使这一切工作。</p><p id="feeb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，已经完成的另一件大事是我们的<em class="mm"> angular.json </em>文件中有一个新项目:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mt"><img src="../Images/115d179e5611c606cbc510c0c020d9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iBfmFus71ecAspWSw_WnoA.png"/></div></div></figure><p id="cefb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我们在这里有一个二级项目，这是我们的braga-lib，你会注意到这个项目的根的路径。现在，构建和测试所需的一切都包括在内了。这些是它修改的主要内容。现在，我们可以从这里对我们的库进行更改。因此，如果我们进入，您将在这里看到普通文件和一个src文件夹，然后他们添加的是一个lib，如您所见:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/5a5f31aa172dce6390767ac8713008db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*Ov1U--0S8cQzp9XKmlv3fw.png"/></div></figure><p id="ed4a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">lib将会有我们的组件，我们的模块，甚至一个服务，如果你想要的话。如果你打开组件文件，它几乎只是说“braga-lib工作！”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mv"><img src="../Images/c76506d6742213d969c7631063183ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4pl21itG7Y8bKsYCScFjQ.png"/></div></div></figure><p id="9753" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在请注意选择器“lib-braga-lib”。你可以改变这一点，但现在让我们让它保持原样，让我们使用它在我们的角度项目。让我们看看那个？哦，是的，☺</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="0e9b" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">消费自定义库</strong></h1><p id="98dc" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">现在让我们看看如何使用我们的共享库。因此，我将转到我们的app.component.html，删除他们放在此文件上的大部分内容，并添加我们的共享库标记。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mw"><img src="../Images/b03d6d14a86ee238300f45a6a73c96ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQsjVMd0W-jPI2czrUw6ew.png"/></div></div></figure><p id="ef31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以看到我们的共享库标签变成了红色。那是因为我们还没有导入共享库模块。这很容易解决。我们可以转到app.module，将我们的共享库添加到导入中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mx"><img src="../Images/0c01a6c9a685a987b35415127fdb3ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oJL8hkDQcwuf_D7zUoRU_A.png"/></div></div></figure><p id="ef5f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里，导入行是'<em class="mm">../../projects/Braga-lib/src/public-API</em>'。他们所做的是创建这个公共API来导出这个特定共享组件内部的内容。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi my"><img src="../Images/fe06a82acb7075754df5fd641235fe26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*BcCVNPIatzuaRM42R57QSQ.png"/></div></figure><p id="1659" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如上面所说，这是公共API服务。请注意，共享模块(我们的braga.lib模块)是他们导出的内容之一，对于本练习来说已经足够了。我们可以回到我们的<em class="mm">app.component.html</em>，我们的红线将会消失。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mz"><img src="../Images/8cffeb07f8e23558123be62068f59acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5l0nCH58RAErmCcVav3YVQ.png"/></div></div></figure><p id="804b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们准备去☺.我们可以首先尝试通过执行"<em class="mm"> ng serve -o </em>"来运行项目，但是我们会得到一个错误，因为我们还没有共享库的dist文件夹。因此，我们需要做的第一件事是运行"<em class="mm"> ng build braga-lib </em>"。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi na"><img src="../Images/8e196091dfe310471cffcdef59c0e685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05dweTdm1yjZ5xF2AEg4mQ.png"/></div></div></figure><p id="0303" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们可以做常规的"<em class="mm"> ng serve -o </em>"来启动我们的共享库项目。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nb"><img src="../Images/8934f3e4eed841f197ac2c546cd66d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IkmVlQNv6Zr-tLxiY4Jn5A.png"/></div></div></figure><p id="ed16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如你所见，我们现在在Angular项目中有了我们的共享库。只需很少的努力，几分钟之内，您就可以建立并运行一个共享库。最后一步是实际向国家预防机制发布。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="f93e" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">结论</h1><p id="e44d" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">当你和你的团队计划未来的实现时，这是非常有用的。现在你可以说:我们的许多应用程序都将使用这些特定的小部件，所以让我们计划创建一个库，而不是将它们放在应用程序的共享文件夹中，然后在应用程序之间复制和粘贴！</p></div></div>    
</body>
</html>
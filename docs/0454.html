<html>
<head>
<title>Effective Function Parameters in Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript中的有效函数参数</h1>
<blockquote>原文：<a href="https://itnext.io/effective-function-parameters-in-javascript-1c4f2f4602ee?source=collection_archive---------3-----------------------#2018-03-12">https://itnext.io/effective-function-parameters-in-javascript-1c4f2f4602ee?source=collection_archive---------3-----------------------#2018-03-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d1e87ff64996ce61bf42136c22297139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZI-gWwOSWJfvr99nQLXmBA.jpeg"/></div></div></figure><p id="a6f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于编程和编程风格的最重要的书籍之一是一本名为《干净的代码》的书。在这本书里，有一个至关重要的提示是我一直试图遵循的:<strong class="ka ir">函数参数的最大数量应该是3个，你应该总是尽量使用2个或更少的</strong>。最初我并没有意识到为什么这很重要，但是随着我继续写大量的Javascript，我开始意识到这一点。</p><p id="e04c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们定义了下面的函数，我们有六个潜在的参数值。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="5383" class="lf lg iq lb b gy lh li l lj lk">const addToInventory = function(itemName, category, brokerName, sellingCost, initialCost, inStock) {</span><span id="a370" class="lf lg iq lb b gy ll li l lj lk">// Some code goes here</span><span id="b443" class="lf lg iq lb b gy ll li l lj lk">};</span></pre><p id="eab9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从函数定义的角度来看，这非常有意义，因为每个参数都有变量。这些变量命名得很好，它们在函数代码中有一定的意义。然而，我们在执行函数时会遇到清晰度的问题以及设置默认参数的问题。调用这个函数可能看起来像这样</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="aeb3" class="lf lg iq lb b gy lh li l lj lk">addToInventory("Awesome Thing", "Toys", "Chester McChester", 12, 6, false);</span></pre><p id="ddbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你和我一样，那么如果你回头再看这段代码，你会对这些值的含义感到困惑。“12”应该是什么？谁是切斯特·麦克彻斯特？为什么会有随机的“假”传入？</p><p id="3d7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们假设这些参数中的一些是可选的，我们可以像这样调用函数</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="a26b" class="lf lg iq lb b gy lh li l lj lk">addToInventory("Awesome Thing", "Toys");</span></pre><p id="cffc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就清晰度而言，还不算太差……但是当你想设定初始成本时会发生什么呢？你需要设置代理名和销售成本吗？或者你可以这样做</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="cb58" class="lf lg iq lb b gy lh li l lj lk">addToInventory("Awesome Thing", "Toys", undefined, undefined, 6);</span></pre><p id="0563" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好像设置没有上下文的参数值已经够混乱的了，抛出随机的“未定义”只是增加了额外的一层“这里发生了什么事？”</p><h1 id="b6f0" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">将参数值包装在对象中！</h1><p id="00da" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">让我们重构“addToInventory ”,改为使用一个对象来保存我们所有的参数。我将使用析构来展示如何轻松地解包params对象的值。如果你没有用过析构，那么我建议你去<a class="ae mo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Object_destructuring" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Operators/destructing _ assignment # Object _ destructing</a>上了解一下。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="c60d" class="lf lg iq lb b gy lh li l lj lk">const addToInventory = function(params) {</span><span id="4da2" class="lf lg iq lb b gy ll li l lj lk">const {itemName, category, brokerName, sellingCost, initialCost, inStock} = params;</span><span id="8279" class="lf lg iq lb b gy ll li l lj lk">// Some code goes here</span><span id="8cfb" class="lf lg iq lb b gy ll li l lj lk">};</span><span id="41fb" class="lf lg iq lb b gy ll li l lj lk"><br/>// Or you could you could destructure right <br/>// in the function parameter declaration</span><span id="248d" class="lf lg iq lb b gy ll li l lj lk">const addToInventory = function({itemName, category, brokerName, sellingCost, initialCost, inStock}) {</span><span id="3ec7" class="lf lg iq lb b gy ll li l lj lk">// Some code goes here</span><span id="40d8" class="lf lg iq lb b gy ll li l lj lk">};</span></pre><p id="f0b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们看看调用这个函数会是什么样子。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="646f" class="lf lg iq lb b gy lh li l lj lk">const params = {<br/>  itemName: "Awesome Thing",<br/>  category: "Toys",<br/>  brokerName: "Chester McChester",<br/>  sellingCost: 12,<br/>  initialCost: 6,<br/>  inStock: false<br/>};</span><span id="455f" class="lf lg iq lb b gy ll li l lj lk">addToInventory(params);</span><span id="88da" class="lf lg iq lb b gy ll li l lj lk">// And with optional values</span><span id="3ff5" class="lf lg iq lb b gy ll li l lj lk">const params = {<br/>  itemName: "Awesome Thing",<br/>  category: "Toys",<br/>  initialCost: 6<br/>};</span><span id="7d76" class="lf lg iq lb b gy ll li l lj lk">addToInventory(params);</span></pre><p id="7e22" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嘣。现在，当我稍后再回到这段代码时，我将大致了解这些值的含义，因为对象键可以为我提供指导。我明白“棒极了的东西”是项目名称，而不是其他随机值。我们也不需要以任何特定的顺序设置对象值，我们可以跳过可选值。</p><p id="c55c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么下一个问题是，对于违约你会怎么做？</p><h1 id="16a5" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">ES6中的默认值</h1><p id="a12e" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">我在前面的例子中使用了析构，因为它有一个额外的好处。析构允许我们为从参数中提取的每个变量设置默认值(你可以在<a class="ae mo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Default_values_2" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Operators/destructioning _ assignment # Default _ values _ 2</a>了解更多信息)。</p><p id="955c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看看如何使用析构来设置默认值。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="2a37" class="lf lg iq lb b gy lh li l lj lk">const addToInventory = function(params) {</span><span id="2a1a" class="lf lg iq lb b gy ll li l lj lk">const {itemName = 'someName', brokerName, sellingCost, initialCost = 0, inStock = true} = params;</span><span id="d759" class="lf lg iq lb b gy ll li l lj lk">// Some code goes here</span><span id="bd54" class="lf lg iq lb b gy ll li l lj lk">};</span></pre><p id="0cf0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这种技术，itemName将默认为“someName”，initialCost将默认为0，inStock将默认为“true”。</p><p id="abd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用析构默认值对于对象来说是非常好的，但是我们最初说过，当使用一两个参数时，对象是不必要的。当我们不使用一个对象时，设置默认值怎么样？</p><h2 id="6515" class="lf lg iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">ES6默认参数</h2><p id="b1fa" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">我不能写一篇关于参数的文章而不提到ES6默认参数。如果你有三个以上的参数，你应该使用一个对象。如果没有，那么你应该检查一下<a class="ae mo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters" rel="noopener ugc nofollow" target="_blank"> ES6的默认参数。</a></p><p id="138d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">过去，Javascript程序员经常不得不这样设置默认值</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="a29e" class="lf lg iq lb b gy lh li l lj lk">const myFunc1 = function(param1, param2) {<br/>  if(param1 === undefined) {<br/>    param1 = myDefault1;<br/>  }<br/>  if(param2 === undefined) {<br/>    param2 = myDefault2;<br/>  }<br/>  // Some code goes here<br/>};</span><span id="1d18" class="lf lg iq lb b gy ll li l lj lk">// Or the more concise and risky</span><span id="6e48" class="lf lg iq lb b gy ll li l lj lk">const myFunc2 = function(param1, param2) {<br/>  param1 = param1 || myDefault1;<br/>  param2 = param2 || myDefault2;<br/>  // Some code goes here<br/>};</span></pre><p id="e84f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这经常让开发人员感到恼火，因为其他语言有设置默认参数的简单方法。幸运的是，ES6添加了默认参数，现在您可以这样做了。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="943d" class="lf lg iq lb b gy lh li l lj lk">const myFunc = function(param1 = myDefault1, param2 = myDefault2) {<br/>    // Some code goes here<br/>};</span></pre><p id="89aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认参数有助于摆脱乏味的编程，并有助于远离关于Javascript 中的falsy值的<a class="ae mo" href="https://youtu.be/v2ifWcnQs6M?t=19m43s" rel="noopener ugc nofollow" target="_blank">垃圾站火灾。</a></p><h1 id="5b70" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">ES5中的默认值</h1><p id="dee1" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">我想为那些受困于支持旧浏览器和不能使用<a class="ae mo" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel的人添加一个快速部分。</a></p><p id="124d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有使用过<a class="ae mo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" rel="noopener ugc nofollow" target="_blank"> Object.assign </a>，那么我强烈建议你去看看。MDN的官方总结称。</p><blockquote class="na nb nc"><p id="ced3" class="jy jz nd ka b kb kc kd ke kf kg kh ki ne kk kl km nf ko kp kq ng ks kt ku kv ij bi translated">“Object.assign()”方法用于将所有可枚举自身属性的值从一个或多个源对象复制到目标对象。它将返回目标对象。</p></blockquote><p id="d9c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一种微妙但强大的方法，因为您可以轻松地合并对象，进行克隆，并根据源的顺序设置对象优先级。</p><p id="1110" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看看用‘addtoinventory’函数设置默认值会是什么样子。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="8862" class="lf lg iq lb b gy lh li l lj lk">const addToInventory = function(params) {<br/>  params = Object.assign({<br/>    itemName: "",<br/>    category: "Other",<br/>    brokerName: "General",<br/>    sellingCost: 0,<br/>    initialCost: 0,<br/>    inStock: false<br/>  }, params);<br/>  <br/>  const {itemName, category, brokerName, sellingCost, initialCost, inStock} = params;</span><span id="ffd3" class="lf lg iq lb b gy ll li l lj lk">  // Some code goes here</span><span id="1f0d" class="lf lg iq lb b gy ll li l lj lk">};</span></pre><p id="a0e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，初始的“目标”被设置为所有我们想要的缺省参数，传入的params对象根据需要覆盖缺省值。如果您的defaults对象位于函数之外(比如在全局配置对象中)，您甚至可以将一个空对象设置为目标，并将默认值设置为源。</p><p id="6bce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">注意，目标会发生变异，所以你不应该将全局对象设置为目标参数。</strong></p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ca1a" class="lf lg iq lb b gy lh li l lj lk">const addToInventory = function(params) {<br/>  params = Object.assign({}, myDefaults, params);</span><span id="c4f1" class="lf lg iq lb b gy ll li l lj lk">  const {itemName, category, brokerName, sellingCost, initialCost, inStock} = params;</span><span id="9690" class="lf lg iq lb b gy ll li l lj lk">  // Some code goes here</span><span id="e467" class="lf lg iq lb b gy ll li l lj lk">};</span></pre><p id="ff07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是如果我想使用所有的默认值呢？Object.assign的一个妙处是它会忽略未定义的源。这意味着在上面的函数中，params对象可以作为“undefined”传入，Object.assign仍然可以正常工作。</p><h1 id="afd4" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">摘要</h1><p id="ce5a" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">基本上，你可以做的是清理你的函数参数并有效地设置默认值</p><ul class=""><li id="ab1a" class="nh ni iq ka b kb kc kf kg kj nj kn nk kr nl kv nm nn no np bi translated">将函数参数的数量保持在3个或更少</li><li id="41cf" class="nh ni iq ka b kb nq kf nr kj ns kn nt kr nu kv nm nn no np bi translated">如果需要3个以上的参数值，请使用对象</li><li id="f4c7" class="nh ni iq ka b kb nq kf nr kj ns kn nt kr nu kv nm nn no np bi translated">如果您使用一个对象并且可以使用ES6，请使用析构来设置默认值</li><li id="6fa9" class="nh ni iq ka b kb nq kf nr kj ns kn nt kr nu kv nm nn no np bi translated">如果您使用对象而不能使用ES6，请使用Object.assign轻松设置默认值</li><li id="589a" class="nh ni iq ka b kb nq kf nr kj ns kn nt kr nu kv nm nn no np bi translated">如果没有使用对象作为参数，并且可以使用ES6，请使用ES6默认参数</li><li id="fffa" class="nh ni iq ka b kb nq kf nr kj ns kn nt kr nu kv nm nn no np bi translated">如果您没有使用对象作为参数，并且不能使用ES6，您只需检查值是否未定义</li></ul><p id="6062" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望这有所帮助！</p></div></div>    
</body>
</html>
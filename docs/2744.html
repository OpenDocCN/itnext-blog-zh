<html>
<head>
<title>Creating a useGestures hook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个useGestures挂钩</h1>
<blockquote>原文：<a href="https://itnext.io/creating-a-usegestures-hook-b4b02b9e00a3?source=collection_archive---------5-----------------------#2019-07-25">https://itnext.io/creating-a-usegestures-hook-b4b02b9e00a3?source=collection_archive---------5-----------------------#2019-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5c33" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">TL；博士；医生</h2></div><p id="52f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里是到<a class="ae lb" href="https://www.npmjs.com/package/use-gestures" rel="noopener ugc nofollow" target="_blank"> npm包</a>和<a class="ae lb" href="https://giladl82.github.io/use-gestures-app/" rel="noopener ugc nofollow" target="_blank">演示站点</a>的链接</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/fd987683edbc6b6a36a3543e2315265c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*rjtB-5n3TnNctp2r6WJ3dg.png"/></div></figure></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h2 id="d2d8" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">我的动力</h2><p id="1c3f" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">最近我一直在用cordova开发这个手机应用程序😥这是我参与的最糟糕的项目之一。但有时你可能会发现塞翁失马焉知非福🙄。出于这个项目的痛苦，使用react的新版本和钩子作为合法的模式，我决定尝试一下，创建一个自定义钩子来处理移动手势。</p><h2 id="262a" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">履行</h2><p id="f2ee" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">移动手势是触摸事件的结果。<br/>现在react有了一个事件监听器来处理像<code class="fe mp mq mr ms b">onTouchStart</code>这样的事件，但是我需要以一种更通用的方式使用它，而不仅仅是把它放在一个元素上。因此，我在这项工作中使用了两个挂钩。<code class="fe mp mq mr ms b">useRef</code>和<code class="fe mp mq mr ms b">useEffect</code></p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="008e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个钩子从react内置钩子<code class="fe mp mq mr ms b">useRef</code>中获得一个ref对象。</p><blockquote class="mv mw mx"><p id="b612" class="kf kg my kh b ki kj jr kk kl km ju kn mz kp kq kr na kt ku kv nb kx ky kz la ij bi translated">"<code class="fe mp mq mr ms b"><em class="iq">useRef</em></code> <em class="iq"> </em>返回一个可变ref对象，其<code class="fe mp mq mr ms b">.current</code>属性初始化为传递的参数(<code class="fe mp mq mr ms b">initialValue</code>)。返回的对象将在组件的整个生命周期内存在”“<a class="ae lb" href="https://reactjs.org/docs/hooks-reference.html#useeffect" rel="noopener ugc nofollow" target="_blank">钩子API引用</a></p></blockquote><p id="be7a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe mp mq mr ms b">useEffect</code>钩子，我将触摸事件监听器附加到被引用的元素上，或者从被引用的元素上分离。</p><p id="d09e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">useEffect</code>的定义有点长，所以我在这里跳过它，只说<code class="fe mp mq mr ms b">useEffect</code>在每次渲染后运行，这是你将组件附加到外部副作用(因此得名)的方式，如通用触摸事件。</p><h2 id="f659" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">将触摸事件转换为手势</h2><p id="8719" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">实现三种手势类型:平移、滑动和挤压。<br/> <strong class="kh ir">平移</strong>和<strong class="kh ir">滑动</strong>都是简单的触摸事件，差别很小。<br/> <strong class="kh ir">滑动</strong>事件有方向，只有当触摸移动距离大于最小值时才会被触发。<br/> <strong class="kh ir">捏</strong>事件是两个手指触碰事件。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5a0d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我已经删除了所有我说过的代码，还有一些我稍后会讲到的代码。</p><p id="20f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有两件事需要注意</p><ol class=""><li id="0b47" class="nc nd iq kh b ki kj kl km ko ne ks nf kw ng la nh ni nj nk bi translated">在每个事件处理器上，我们需要确定触摸是否是挤压事件(确切地说是两个触摸指针)</li><li id="40c6" class="nc nd iq kh b ki nl kl nm ko nn ks no kw np la nh ni nj nk bi translated">在触摸移动和触摸结束时，我们需要检查手势是否触发了滑动事件</li></ol><h2 id="9021" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">助手功能</h2><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="6574" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们有四个帮助函数</p><p id="99ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">getDistance</code>返回两个指针(触摸)之间的距离</p><p id="9c08" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">getAngleDeg</code>返回这些指针之间的角度，以度为单位。</p><p id="9d7c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">callHandler</code>获取一个事件名和事件对象到事件处理程序的监听器函数，并分派附属的监听器函数。</p><p id="8952" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">getCurrentTouches</code>负责理解原始触摸事件，并确定我们稍后使用的自定义事件对象。</p><h2 id="f947" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">一个例子</h2><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8a44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个使用<code class="fe mp mq mr ms b">useGestures</code>钩子旋转图像的简单例子。<br/>你可以在这个<a class="ae lb" href="https://giladl82.github.io/use-gestures-app/" rel="noopener ugc nofollow" target="_blank">演示页面</a>上找到这个例子以及更多</p><p id="4feb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样<br/>我希望这篇文章对你有帮助，我也希望我的<a class="ae lb" href="https://www.npmjs.com/package/use-gestures" rel="noopener ugc nofollow" target="_blank">使用手势</a>包对你有帮助😀</p></div></div>    
</body>
</html>
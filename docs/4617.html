<html>
<head>
<title>Rancher 2.4 &amp; Kubernetes on your macOS laptop with Docker &amp; k3d</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">macOS笔记本电脑上的Rancher 2.4 &amp; Kubernetes和Docker &amp; k3d</h1>
<blockquote>原文：<a href="https://itnext.io/rancher-2-4-kubernetes-on-your-macos-laptop-with-docker-k3d-b578b1c7568b?source=collection_archive---------2-----------------------#2020-08-05">https://itnext.io/rancher-2-4-kubernetes-on-your-macos-laptop-with-docker-k3d-b578b1c7568b?source=collection_archive---------2-----------------------#2020-08-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/98fed9d422b10024423731ab69d62131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKbyHzS4keoOUiAinh5UgA.png"/></div></div></figure><p id="48e3" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">这篇文章描述了如何使用由Rancher(最近被SUSE收购)监控的k3d在macOS Catalina上建立一个Kubernetes (k8s)测试/开发环境，并且受到了这个惊人的<a class="ae la" href="https://www.youtube.com/watch?v=hMr3prm9gDM" rel="noopener ugc nofollow" target="_blank">视频</a>和由<a class="lb lc ep" href="https://medium.com/u/f4cb33e4a07f?source=post_page-----b578b1c7568b--------------------------------" rel="noopener" target="_blank"> Thorsten K </a>制作的<a class="ae la" href="https://github.com/iwilltry42/k3d-demo" rel="noopener ugc nofollow" target="_blank"> repo </a>的启发</p><h2 id="8b5c" class="ld le iu bd lf lg lh dn li lj lk dp ll kn lm ln lo kr lp lq lr kv ls lt lu lv bi translated">本文的目标是在本地建立一个Kubernetes集群来进行实验并了解kubectl</h2><blockquote class="lw lx ly"><p id="76e8" class="kc kd lz ke b kf kg kh ki kj kk kl km ma ko kp kq mb ks kt ku mc kw kx ky kz in bi translated">另见:<a class="ae la" href="https://medium.com/@jyeee/kubernetes-on-your-macos-laptop-with-multipass-k3s-and-rancher-2-4-6e9cbf013f58" rel="noopener">https://medium . com/@ jyeee/kubernetes-on-your-MAC OS-laptop-with-multipass-k3s-and-rancher-2-4-6e 9 CBF 013 f 58</a></p></blockquote><p id="910f" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">在获得了一点k8s的使用体验后，我想不出比一个app容器化部署到k8s更好的实现“写一次到处跑”梦想的方法了！在k8s之上，我发现Rancher是部署应用程序和操作/维护集群的最佳界面。</p><p id="4186" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">我很幸运在一家伟大的公司/客户那里工作，这让我能够获得惊人的资源，在那里我可以运行多个集群。对于我可能没有这些资源的家庭项目，我想在我的笔记本电脑上建立一个实验室，这样我就可以练习了。</p><figure class="me mf mg mh gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj md"><img src="../Images/9c45f83407fea6b73117cbe3ca4a159b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*T8cdYffoU-yowpzSFRIjWw.gif"/></div></div></figure><h1 id="7af1" class="mi le iu bd lf mj mk ml li mm mn mo ll mp mq mr lo ms mt mu lr mv mw mx lu my bi translated">先决条件</h1><ol class=""><li id="b2ab" class="mz na iu ke b kf nb kj nc kn nd kr ne kv nf kz ng nh ni nj bi translated">MAC OS Catalina(10.15)w/8gb mem(lmk如果你能用更少的来做！)</li><li id="3388" class="mz na iu ke b kf nk kj nl kn nm kr nn kv no kz ng nh ni nj bi translated">Docker CE桌面(<a class="ae la" href="https://hub.docker.com/editions/community/docker-ce-desktop-mac/" rel="noopener ugc nofollow" target="_blank">安装文档</a>)</li><li id="13c8" class="mz na iu ke b kf nk kj nl kn nm kr nn kv no kz ng nh ni nj bi translated">自制软件(<a class="ae la" href="https://docs.brew.sh/Installation" rel="noopener ugc nofollow" target="_blank">安装文档</a>)，用于安装k3d、kubectl和helm</li></ol><h1 id="1c06" class="mi le iu bd lf mj mk ml li mm mn mo ll mp mq mr lo ms mt mu lr mv mw mx lu my bi translated">概观</h1><ol class=""><li id="c8c2" class="mz na iu ke b kf nb kj nc kn nd kr ne kv nf kz ng nh ni nj bi translated">安装k3d和k8s工具helm &amp; kubectl</li><li id="2f0f" class="mz na iu ke b kf nk kj nl kn nm kr nn kv no kz ng nh ni nj bi translated">创建一个k8s集群并添加Rancher来管理它</li><li id="de34" class="mz na iu ke b kf nk kj nl kn nm kr nn kv no kz ng nh ni nj bi translated">通过Rancher测试/开发k8s</li></ol><h1 id="3fdf" class="mi le iu bd lf mj mk ml li mm mn mo ll mp mq mr lo ms mt mu lr mv mw mx lu my bi translated">1/3安装k3d和k8s工具头盔和kubectl</h1><p id="0589" class="pw-post-body-paragraph kc kd iu ke b kf nb kh ki kj nc kl km kn np kp kq kr nq kt ku kv nr kx ky kz in bi translated">我们没有使用整个虚拟机作为k8s集群中的一个节点，而是使用<a class="ae la" href="https://k3s.io/" rel="noopener ugc nofollow" target="_blank"> k3s，这是一个轻量级认证的Kubernetes发行版</a>，为物联网&amp;边缘计算而构建，已经<a class="ae la" href="https://thenewstack.io/how-the-u-s-air-force-deployed-kubernetes-and-istio-on-an-f-16-in-45-days/" rel="noopener ugc nofollow" target="_blank">在美国空军F-16战斗机上使用(真的！)</a>。</p><p id="f10b" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">我们将使用轻量级包装器<a class="ae la" href="https://k3d.io/" rel="noopener ugc nofollow" target="_blank"> k3d在docker </a>中运行k3s，然后我们将使用kubectl管理k8s集群。</p><p id="c6a1" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">一旦我们有了k8s集群，我们将希望使用k8s 的包管理器<a class="ae la" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank"> helm来安装应用程序/依赖项，就像我们使用brew、apt、yum或choco这样的包管理器一样。</a></p><p id="d788" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">有很多话，但我们需要的所有东西都是通过一个命令安装的，这要感谢你终端中的自制软件🙌</p><pre class="me mf mg mh gu ns nt nu nv aw nw bi"><span id="5d54" class="ld le iu nt b gz nx ny l nz oa"><strong class="nt iv">$ brew install k3d kubectl helm<br/></strong>==&gt; Downloading <a class="ae la" href="https://homebrew.bintray.com/bottles/k3d-3.0.0.catalina.bottle.tar.gz" rel="noopener ugc nofollow" target="_blank">https://homebrew.bintray.com/bottles/k3d-3.0.0.catalina.bottle.tar.gz</a><br/>...<br/>=&gt; Pouring k3d-3.0.0.catalina.bottle.tar.gz<br/>🍺  /usr/local/Cellar/k3d/3.0.0: 5 files, 24.1MB<br/>...<br/>==&gt; Summary<br/>🍺  /usr/local/Cellar/kubernetes-cli/1.18.6: 232 files, 49.2MB<br/>...<br/>==&gt; Summary<br/>🍺  /usr/local/Cellar/helm/3.2.4_1: 54 files, 42.7MB<br/>==&gt; helm<br/>Bash completion has been installed to:<br/>  /usr/local/etc/bash_completion.d</span><span id="e481" class="ld le iu nt b gz ob ny l nz oa">zsh completions have been installed to:<br/>  /usr/local/share/zsh/site-functions</span></pre><h1 id="59f9" class="mi le iu bd lf mj mk ml li mm mn mo ll mp mq mr lo ms mt mu lr mv mw mx lu my bi translated">2/3创建一个k8s集群，并添加牧场主来管理它</h1><p id="9e3e" class="pw-post-body-paragraph kc kd iu ke b kf nb kh ki kj nc kl km kn np kp kq kr nq kt ku kv nr kx ky kz in bi translated">现在您已经安装了k8s工具，创建k8s集群并使用这些命令安装Rancher(这也可以用作脚本，所以您可以随意将其全部复制并粘贴到您的终端中)</p><figure class="me mf mg mh gu jv"><div class="bz fq l di"><div class="oc od l"/></div></figure><figure class="me mf mg mh gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oe"><img src="../Images/f608cb5df28320541bc188a2b1829693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mnA8nAt9aOOwN7o51Byosw.png"/></div></div></figure><p id="4dda" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">这些命令(可以作为脚本运行)执行以下操作:</p><p id="67c3" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">1.使用k3d创建一个集群，将端口443连接到k3d提供的负载平衡器</p><p id="5a83" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">2.设置一个kubeconfig，这样您就可以在当前会话中使用kubectl</p><p id="bef2" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">3.根据文档<a class="ae la" href="https://rancher.com/docs/rancher/v2.x/en/installation/k8s-install/helm-rancher/" rel="noopener ugc nofollow" target="_blank">https://Rancher . com/docs/Rancher/v2 . x/en/installation/k8s-install/helm-Rancher/</a>使用helm安装Rancher(及其依赖证书管理器)</p></div><div class="ab cl of og hy oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="in io ip iq ir"><h1 id="cf28" class="mi le iu bd lf mj om ml li mm on mo ll mp oo mr lo ms op mu lr mv oq mx lu my bi translated">3/3测试/开发k8s via Rancher</h1><p id="a0b0" class="pw-post-body-paragraph kc kd iu ke b kf nb kh ki kj nc kl km kn np kp kq kr nq kt ku kv nr kx ky kz in bi translated">打开浏览器，进入<a class="ae la" href="https://rancher.k3d.localhost" rel="noopener ugc nofollow" target="_blank">https://rancher . k3d . localhost</a></p><p id="911f" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">如果在Chrome/Brave ( <a class="ae la" href="https://codereview.chromium.org/938093003" rel="noopener ugc nofollow" target="_blank">哪个解析。本地主机域到回环</a>)，使用<code class="fe or os ot nt b">thisisunsafe</code>技巧进入并让Rancher满意证书(<a class="ae la" href="https://dev.to/brettimus/this-is-unsafe-and-a-bad-idea-5ej4" rel="noopener ugc nofollow" target="_blank">https://dev.to/brettimus/this-is-unsafe-and-a-bad-idea-5ej4</a>)。</p><p id="c3e4" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">如果使用另一个浏览器，您必须编辑您的/etc/hosts以将rancher.k3d.localhost指向您的回环(添加行` 127.0.0.1 rancher.k3d.localhost `)</p><figure class="me mf mg mh gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ou"><img src="../Images/48450bf34f1601e36f466a8106e68a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G_9beOTljjr_5JSQ3LJrCA.png"/></div></div><figcaption class="ov ow gk gi gj ox oy bd b be z dk translated">不开玩笑，点击红色三角形并输入“这是不安全的”</figcaption></figure><p id="48e6" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">为Rancher选择一个密码，并确认Rancher服务器URL。</p><figure class="me mf mg mh gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oz"><img src="../Images/99c05b5bd1716f160eaa85bb2a061676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oOIbQLtC7WaHg1rQ-LDbHg.png"/></div></div></figure><blockquote class="lw lx ly"><p id="c9e0" class="kc kd lz ke b kf kg kh ki kj kk kl km ma ko kp kq mb ks kt ku mc kw kx ky kz in bi translated">如果群集表示它处于非活动状态，请刷新页面，您将看到您的群集转变为活动状态</p></blockquote><p id="fd6e" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">现在点击本地集群，享受Rancher的奇妙GUI来管理k8s集群！下面的gif显示了如何启用监控，这可以在Grafana中可视化，如下一个gif所示</p><figure class="me mf mg mh gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj md"><img src="../Images/9c45f83407fea6b73117cbe3ca4a159b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*T8cdYffoU-yowpzSFRIjWw.gif"/></div></div></figure><p id="9148" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">Grafana在你的笔记本上！</p><figure class="me mf mg mh gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj md"><img src="../Images/8686ef547a32cfcddb45820156574db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*74qJ35N2Xg15WSOBACKoUg.gif"/></div></div></figure><h1 id="da8b" class="mi le iu bd lf mj mk ml li mm mn mo ll mp mq mr lo ms mt mu lr mv mw mx lu my bi translated">结论</h1><p id="ad73" class="pw-post-body-paragraph kc kd iu ke b kf nb kh ki kj nc kl km kn np kp kq kr nq kt ku kv nr kx ky kz in bi translated">就是这样！现在，您的笔记本电脑上有了一个最小的Kubernetes集群，可以用作个人实验室。</p><p id="0e37" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">我想看的下一个视频是Thorsten K的Rancher k3d演示，它让我意识到使用k3d来构建一个dev env【https://www.youtube.com/watch?v=hMr3prm9gDM】T3<a class="ae la" href="https://github.com/iwilltry42/k3d-demo" rel="noopener ugc nofollow" target="_blank">https://github.com/iwilltry42/k3d-demo</a>是多么容易</p><p id="5098" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">现在我已经有了一个集群，我要读的下一篇文章是如何将这样的webapp容器化<a class="ae la" href="https://dev.to/rieckpil/deploy-a-react-application-to-kubernetes-in-5-easy-steps-516j" rel="noopener ugc nofollow" target="_blank">https://dev . to/rieckpil/deploy-a-react-application-to-kubernetes-in-5-easy-steps-516j</a>——一旦你将它容器化并推送到repo，你就可以在本地集群中部署它。</p><p id="0355" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">欢迎🤙！</p><p id="4c8f" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">来加入我的技术智能解决方案(<a class="ae la" href="https://www.techint.us/" rel="noopener ugc nofollow" target="_blank">https://www.techint.us/</a>)！<a class="ae la" href="https://www.linkedin.com/in/jyeee/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jyeee/</a></p></div></div>    
</body>
</html>
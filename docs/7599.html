<html>
<head>
<title>Linux: saving laptop’s battery energy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Linux:节省笔记本电脑的电池能量</h1>
<blockquote>原文：<a href="https://itnext.io/linux-saving-laptops-battery-energy-33eddfea0de6?source=collection_archive---------2-----------------------#2022-11-19">https://itnext.io/linux-saving-laptops-battery-energy-33eddfea0de6?source=collection_archive---------2-----------------------#2022-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/152efa1cd184eb54fbbb405641ee1174.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*1ychgWUdivjVChpWAXNHcQ.png"/></div></figure><p id="f392" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这一次，我开始感兴趣了——有没有可能以某种方式节省笔记本电脑电池的电量？不是说它放电快，工作5–6小时就够了，但也不会太多，尤其是现在乌克兰停电的情况下。</p><p id="d8e8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">找到了几个实用程序，今天我将写下它们。</p><h1 id="39a5" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">uppower</h1><p id="f8b4" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">第一个——<code class="fe lv lw lx ly b">upower</code>:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="33a5" class="mh kt iq ly b be mi mj l mk ml">$ sudo pacman -S upower</span></pre><p id="ba70" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，你可以用选项<code class="fe lv lw lx ly b">--monitor-detail</code>打电话——会实时显示关于电池状态的信息:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="29b5" class="mh kt iq ly b be mi mj l mk ml">$ sudo upower --monitor-detail<br/>Monitoring activity from the power daemon. Press Ctrl+C to cancel.<br/>[20:42:20.071] device changed: /org/freedesktop/UPower/devices/battery_BAT0<br/>native-path: BAT0<br/>vendor: SMP<br/>model: LNV-5B10W13895<br/>serial: 2056<br/>power supply: yes<br/>updated: Fri Nov 18 20:42:20 2022 (0 seconds ago)<br/>has history: yes<br/>has statistics: yes<br/>battery<br/>present: yes<br/>rechargeable: yes<br/>state: charging<br/>warning-level: none<br/>energy: 36.7 Wh<br/>energy-empty: 0 Wh<br/>energy-full: 0 Wh<br/>energy-full-design: 0 Wh<br/>energy-rate: 15.538 W<br/>voltage: 12.391 V<br/>charge-cycles: N/A<br/>time to full: 22.7 minutes<br/>percentage: 86%<br/>technology: lithium-polymer<br/>icon-name: ‘battery-full-charging-symbolic’<br/>History (charge):<br/>1668796940 86.000 charging<br/>1668796850 85.000 charging<br/>History (rate):<br/>1668796940 15.538 charging<br/>1668796910 15.784 charging<br/>1668796880 16.006 charging<br/>1668796850 16.253 charging</span></pre><p id="1308" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里，我们可以看到笔记本电脑电池的型号——LNV-5b 10 W 13895，以及它的状态——正在使用的瓦特小时数(36.7 Wh)，现在的功耗是多少(15.538 W)，功率是多少(12.391 V)</p><p id="8d77" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以用安培小时来计算:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="ab21" class="mh kt iq ly b be mi mj l mk ml">&gt;&gt;&gt; 37.31/12.3<br/>3.03</span></pre><p id="208c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">也就是现在电池里有3033 mAh的电量。</p><p id="0166" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，我们还看到了电池装置本身——<code class="fe lv lw lx ly b">/org/freedesktop/UPower/devices/battery_BAT0</code>。</p><p id="b44a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">无需监控，只需一次即可获得相关信息——设备<code class="fe lv lw lx ly b">sudo upower -i /org/freedesktop/UPower/devices/battery_BAT0</code>的一个选项<code class="fe lv lw lx ly b">-i</code>。</p><h1 id="2421" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">高级配置与电源接口(Advanced Configuration and Power Interface)</h1><p id="2e7f" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">另一个类似的实用程序——<code class="fe lv lw lx ly b">acpi</code>，也可以显示温度(而且不仅仅是，关于ACPI 见<a class="ae mm" href="https://tldp.org/HOWTO/html_single/ACPI-HOWTO/#aboutacpi" rel="noopener ugc nofollow" target="_blank">):</a></p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="567c" class="mh kt iq ly b be mi mj l mk ml">$ sudo pacman -S acpi</span></pre><p id="fc86" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">获取有关电池的信息:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="249b" class="mh kt iq ly b be mi mj l mk ml">$ acpi -i<br/>Battery 0: Charging, 91%, 00:21:40 until charged<br/>Battery 0: design capacity 3649 mAh, last full capacity 3431 mAh = 94%</span></pre><p id="a28c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">“设计容量3649 mAh”——几乎与上面计算的一样，只是他们采用了目前的充电量，现在约为设计容量的94%。</p><h1 id="bb42" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">Batstat</h1><p id="804e" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">第三个有用的东西——<code class="fe lv lw lx ly b">batstat</code>。很简单，但是很有用。</p><p id="db1e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下载存储库，用<code class="fe lv lw lx ly b">make</code>构建它:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="6a9a" class="mh kt iq ly b be mi mj l mk ml">$ git clone https://github.com/Juve45/batstat.git<br/>$ cd batstat<br/>$ make<br/>$ chmod +x batstat<br/>$ sudo mv batstat /usr/local/bin/</span></pre><p id="02b7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行它:</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/3496859195bd4aead79d0ff9c2b5b440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/0*xaKhECt5lqnN0JD4.png"/></div></figure><h1 id="ca52" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">Powertop</h1><p id="f621" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">Powertop不仅能够显示关于电池的信息，而且首先能够显示关于消耗能量的过程的信息，其次，它可以执行设置以节省电荷。</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="44a1" class="mh kt iq ly b be mi mj l mk ml">$ sudo pacman -S powertop</span></pre><p id="f114" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在<code class="fe lv lw lx ly b">root</code>用户下运行</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="5f52" class="mh kt iq ly b be mi mj l mk ml">$ sudo powertop</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/37b7f190d0425c12fea62b134236a451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LEKh77X78t3hIY7Y.png"/></div></div></figure><p id="6da0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mt">可调参数</em>选项卡显示可优化能耗的设置信息。</p><p id="5cdb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">选择所需的项目，按Enter键—选项会切换:</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mu"><img src="../Images/1cd9870458d889de3e0de504fbc60527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JpF3u5w47vlZJROo.png"/></div></div></figure><p id="d48a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，还可以生成一个HTML报告:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="e261" class="mh kt iq ly b be mi mj l mk ml">$ sudo powertop --html=powerreport.html</span></pre><p id="2a11" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">其结果是:</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mv"><img src="../Images/5b523ae1996c3824ba7f534680154b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GAt9y7S2JlJAqdGi.jpg"/></div></div></figure><p id="0dfa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以添加一个systemd服务，它将在系统启动时执行自动调整。</p><p id="07ab" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">创建一个新文件<code class="fe lv lw lx ly b">/etc/systemd/system/powertop.service</code>:</p><pre class="lz ma mb mc gt md ly mw mx aw my bi"><span id="9190" class="mz kt iq ly b gy na nb l nc ml">[Unit]<br/>Description=Powertop tunings<br/><br/>[Service]<br/>Type=oneshot<br/>RemainAfterExit=yes<br/>ExecStart=/usr/bin/powertop --auto-tune<br/><br/>[Install]<br/>WantedBy=multi-user.target</span></pre><p id="d9f3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">激活它:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="ff8f" class="mh kt iq ly b be mi mj l mk ml">$ sudo systemctl start powertop.service<br/>$ sudo systemctl enable powertop.service</span></pre><h1 id="3472" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">TLP</h1><p id="3c3d" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">它只是一个怪物。不如多读点资料<a class="ae mm" href="https://linuxconfig.org/how-to-optimize-laptop-battery-life-with-tlp-on-linux" rel="noopener ugc nofollow" target="_blank">这里&gt; &gt; &gt; </a>和<a class="ae mm" href="https://wiki.archlinux.org/title/TLP" rel="noopener ugc nofollow" target="_blank">这里&gt; &gt; &gt; </a>，现在说说主要特点。</p><p id="6ceb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="345b" class="mh kt iq ly b be mi mj l mk ml">$ sudo pacman -S tlp<br/>$ sudo pacman -S tlp-rdw</span></pre><p id="40e1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有一个图形界面:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="34d2" class="mh kt iq ly b be mi mj l mk ml">$ yay -S tlpui<br/>$ sudo tlpui</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mv"><img src="../Images/759988cb042e6f7ce5f62be2816b262e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VoOxHz1Q1KzhRGXH.jpg"/></div></div></figure><p id="4ffb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在引擎盖下，它已经有了所有的设置，所以最好禁用<code class="fe lv lw lx ly b">powertop.service</code>。</p><p id="a46a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">启动服务:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="f7fe" class="mh kt iq ly b be mi mj l mk ml">$ sudo systemctl enable tlp.service</span></pre><p id="d4aa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并屏蔽(<code class="fe lv lw lx ly b"><a class="ae mm" href="https://wiki.archlinux.org/title/Systemd#Using_units" rel="noopener ugc nofollow" target="_blank">mask</a></code>)可能干扰的服务<code class="fe lv lw lx ly b">tlp</code>:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="8cbf" class="mh kt iq ly b be mi mj l mk ml">$ sudo systemctl mask systemd-rfkill.service<br/>$ sudo systemctl mask systemd-rfkill.socket</span></pre><p id="085c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">配置文件— <code class="fe lv lw lx ly b">/etc/tlp.conf</code>，您可以将自己的配置放在<code class="fe lv lw lx ly b">/etc/tlp.d/</code>目录下。</p><p id="0248" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">显示当前设置:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="42b0" class="mh kt iq ly b be mi mj l mk ml">$ sudo tlp-stat<br/> — — TLP 1.5.0 — — — — — — — — — — — — — — — — — — — — — — <br/>+++ Configured Settings:<br/>defaults.conf L0004: TLP_ENABLE=”1"<br/>defaults.conf L0005: TLP_WARN_LEVEL=”3"<br/>defaults.conf L0006: TLP_PERSISTENT_DEFAULT=”0"<br/>defaults.conf L0007: DISK_IDLE_SECS_ON_AC=”0"<br/>…</span></pre><p id="e4d0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">带来一堆硬件和优化选项，都是可定制的。</p><h1 id="5da6" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">一般建议</h1><p id="1ff8" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">我们不要忘记最基本的事情。</p><p id="e961" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，这当然是屏幕的亮度——用Fn+/-亮度按钮降低它，或者通过一个文件，我在<code class="fe lv lw lx ly b">/sys/class/backlight/amdgpu_bl0/brightness</code>中有它:</p><pre class="lz ma mb mc gt md ly me bn mf mg bi"><span id="3c6d" class="mh kt iq ly b be mi mj l mk ml">$ sudo bash -c 'echo -n 25 &gt; /sys/class/backlight/amdgpu_bl0/brightness'</span></pre><p id="5650" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，您可以关闭不必要的USB设备，如鼠标/键盘/外部驱动器和蓝牙和/或WiFi(如果通过电缆连接)。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="2a54" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mt">最初发布于</em> <a class="ae mm" href="https://rtfm.co.ua/en/linux-saving-laptops-battery-energy/" rel="noopener ugc nofollow" target="_blank"> <em class="mt"> RTFM: Linux、DevOps、系统管理</em> </a> <em class="mt">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Store multiple grid coordinates in 1 word via bitwise encoding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过逐位编码在一个字中存储多个网格坐标</h1>
<blockquote>原文：<a href="https://itnext.io/store-grid-coordinates-in-1-word-via-bitwise-ops-91e9c9b0d012?source=collection_archive---------3-----------------------#2018-08-05">https://itnext.io/store-grid-coordinates-in-1-word-via-bitwise-ops-91e9c9b0d012?source=collection_archive---------3-----------------------#2018-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b11a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我应该先解释一下，我不是位运算符、有符号整数、二进制补码或网格方面的专家。但是在偶然发现这种技术(在各种“code golf”和“JS1K”解决方案中)之后，我发现它非常有趣，并且认为其他人可能会喜欢我分享它。</p><p id="123e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以技术本质上是我们可以<strong class="jp ir">通过使用逐位编码将一个8x4网格的值存储到一个6字符的字</strong>中。一般来说，使用这种技术，值不一定是网格的值，它们可以是任何值，但我认为这是一个很好的例子。放到网格上…</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="b399" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">网格</h1><p id="2948" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">所以网格是8x4，所以它有32个值，这是由于JS max整数值是32位长。这非常重要，因为我们的限制现在是32个值。</p><p id="c794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得注意的是，JS实际上可以表示高达52位的整数(更高的数字进入指数部分，因此开始失去准确性)，它只是位操作被限制为32位。</p><p id="66a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从技术上来说，如果我们使用网格，它可以是任何大小，但中间的值块必须是8x4</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/2d34525baada35bebfdaeab6769396f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:170/format:webp/1*nMun9GW_g8X3--YXYrmIzA.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">我们的8x4网格和值(X)</figcaption></figure><p id="9307" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">左边的值是7，12，20，24，27，28，30。它们各自对应于一个位置(索引为0，即7是第8个项目，依此类推。)</p><p id="21e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些特定值可以存储为单词“<strong class="jp ir"> <em class="mh"> opmfeo </em> </strong>”。让我们看看它是如何工作的。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="ecc9" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">术语</h1><p id="1cdf" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">首先要介绍一些要点。</p><ul class=""><li id="abfd" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">二进制与十进制系统；有不同的方法来表示同一个数字。二进制使用二进制，而十进制使用十进制。十进制的8是二进制的1000。</li><li id="7b4e" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">按位运算符；在二进制水平上对整数进行运算的符号。对我们的一组值执行OR运算，在我们的上下文中，它会将两个值相加。<code class="fe mw mx my mz b">&lt;&lt;</code>可用于在给定位置移位，例如<code class="fe mw mx my mz b">1 &lt;&lt; 3 </code>(是1000个二进制或8个十进制)。请注意，所有按位运算符的操作数都被转换为二进制补码格式的有符号32位整数</li><li id="c322" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">二的补码；计算机表示整数的方法。对于一个N位数，它被定义为“<em class="mh"> N的2次方</em>”，例如4的2次方是2*2*2*2，即16。利用这一点可以计算出哪个位位置产生哪个值(即翻转位4产生十进制值16)。</li></ul><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi na"><img src="../Images/80c6cb00561d21e1ea6a4d6fe11f8b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*rQ8XObhW_UJwP8GI2MNPYg.jpeg"/></div></figure><ul class=""><li id="4509" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">口罩；用于定义要保留的位和要清除的位。通过位运算将掩码应用于给定值。</li></ul></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="c851" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">编码</strong></h1><p id="9217" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">在我们的编码中，我们将把我们的网格值组转换成一个单词。我们将使用二进制补码作为掩码(即<code class="fe mw mx my mz b">1 &lt;&lt; X</code>)。</p><p id="4502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤:</p><ol class=""><li id="9230" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk nb mo mp mq bi translated">翻转每个位置的位(产生新的二进制/十进制数)</li><li id="fb58" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk nb mo mp mq bi translated">将它们加在一起成为一个整数(在我们的例子中，总数是<code class="fe mw mx my mz b">1494225024 </code>)</li><li id="7a74" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk nb mo mp mq bi translated">基数36编码新单词</li></ol><pre class="lw lx ly lz gt nc mz nd ne aw nf bi"><span id="ee49" class="ng kt iq mz b gy nh ni l nj nk">const gridEncoded = 1 &lt;&lt; 7 | 1 &lt;&lt; 12 | 1 &lt;&lt; 20 | 1 &lt;&lt; 24 | 1 &lt;&lt; 27 | 1 &lt;&lt; 28 | 1 &lt;&lt; 30;</span><span id="b815" class="ng kt iq mz b gy nl ni l nj nk">const slimEncode = (gridEncoded).toString(36);</span></pre><p id="05e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面产生了"<strong class="jp ir"><em class="mh">【OPM FeO】</em></strong>，但是它可以用任何数字的变体来完成。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="bd7c" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">解码</h1><p id="894d" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">在我们的解码过程中，我们会把我们的单词还原成一组数字。</p><p id="8262" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤:</p><ol class=""><li id="83a2" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk nb mo mp mq bi translated">基数36将该值解码成一个数</li><li id="1b9c" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk nb mo mp mq bi translated">迭代32次，每次移动一位，使用按位AND (&amp;)运算符确定匹配</li></ol><pre class="lw lx ly lz gt nc mz nd ne aw nf bi"><span id="1e01" class="ng kt iq mz b gy nh ni l nj nk">const gridDecoded = parseInt(slimEncode, 36);<br/>const MAX_JS_INT_BITS = 32;</span><span id="97bc" class="ng kt iq mz b gy nl ni l nj nk">const gridPositions = [];<br/>for(i=0; i&lt;MAX_JS_INT_BITS; i++) { <br/>  if (puzzleEncoded &amp; 1&lt;&lt;i) {<br/>    gridPositions.push(i);<br/>  }<br/>}</span><span id="3faf" class="ng kt iq mz b gy nl ni l nj nk">// gridPositions.length is 7</span></pre><p id="7cdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们只剩下一组初始的<code class="fe mw mx my mz b">gridEncoded</code>值。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="8097" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">有什么意义？</h1><p id="fccd" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">我发现了解JS中关于整数的实际情况以及位操作符的实际可能性是很有趣的。</p><p id="803e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个特殊的例子可以通过最小化所需的字节来优化数据的存储或传输，尽管这种形式不太可能节省很多。如前所述，我注意到它以类似的形式出现在所有在线Javascript挑战中。</p><p id="c31f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将来使用新的“大整数”数据类型，我们将能够拥有比32位大得多的数据类型(允许这种编码技术有更多更高的值)。“大整数”实际上没有上限，这完全取决于可用内存。</p><p id="ecc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你觉得这些有趣，我真的很感激鼓掌或评论作为反馈:)</p><p id="ffeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢X</p></div></div>    
</body>
</html>
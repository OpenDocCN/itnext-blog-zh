<html>
<head>
<title>5 Pitfalls of NoSQL Databases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NoSQL数据库的5个陷阱</h1>
<blockquote>原文：<a href="https://itnext.io/5-pitfalls-of-nosql-databases-c35012431a80?source=collection_archive---------1-----------------------#2020-09-20">https://itnext.io/5-pitfalls-of-nosql-databases-c35012431a80?source=collection_archive---------1-----------------------#2020-09-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/45f3c16be0187e799aa40b89ec1825e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8f-bGs_pkByyaGYHBdCeoQ.jpeg"/></div></div></figure><div class=""/><p id="7f06" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我录制了一段视频，在视频中我讲述了NoSQL数据库的优势。这个回答很有趣，但我的印象是，并不是每个人都看到硬币的两面。事实是它们会给我们带来很多问题😉。</p><h1 id="1ee4" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">模式管理</h1><p id="4596" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">每个NoSQL数据库都以自己的方式处理模式。有些没有模式(<a class="ae kz" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>)，有些是动态的(<a class="ae kz" href="https://www.elastic.co/elasticsearch/" rel="noopener ugc nofollow" target="_blank"> Elasticsearch </a>)，有些类似于来自关系数据库的模式(<a class="ae kz" href="https://cassandra.apache.org/" rel="noopener ugc nofollow" target="_blank"> Cassandra </a>)。在概念模型中，数据<strong class="kd jf">总是</strong>有一个模式。实体、字段、名称、类型、关系。无论基础的类型如何，物理模型都是概念模型的表示。</p><p id="5849" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">NoSQL数据库在模式方面给了我们更多的自由。在MongoDB中，我们可以添加两个具有相同字段名但不同类型的不同文档。这有道理吗？不太可能。这可能发生吗？当然可以。一个简单的人为错误可能会破坏我们的应用程序。</p><p id="4942" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">另一个问题与实体之间的关系有关。即使我们的数据库中没有关系，我们也必须记录数据之间的关系。从关系数据库中我们可以生成一个<a class="ae kz" href="https://en.wikipedia.org/wiki/Entity%E2%80%93relationship_model" rel="noopener ugc nofollow" target="_blank"> ERD图</a>。在NoSQL数据库的情况下，这可能不起作用。</p><p id="022b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用NoSQL数据库时，我们必须记住模式管理和数据验证问题。没有它，数据可能会“爆炸”。有趣的事实:一些<a class="ae kz" href="http://blog.shippable.com/why-we-moved-from-nosql-mongodb-to-postgressql" rel="noopener ugc nofollow" target="_blank">公司用PostgreSQL </a>替换MongoDB。</p><h1 id="5229" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">误差下限</h1><p id="7d57" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">NoSQL数据库的性能是正确的数据建模、索引和分区的结果。在关系数据库中，我们可以添加列、转换表、将数据从一个表翻转到另一个表、添加索引(如果我们以前忘记了)。对于NoSQL数据库，这并不是在所有情况下都可行的。我们可能需要使用一些外部工具，比如Apache Spark，或者甚至删除并重新创建我们的数据模型。</p><p id="6abc" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在Elasticsearch中，如果我们没有得到索引的模式/映射，我们必须使用例如<a class="ae kz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html" rel="noopener ugc nofollow" target="_blank"> Reindex API </a>，这意味着我们必须将数据重新索引到另一个索引。</p><p id="e491" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在Cassandra中，我们只能通过分区和聚类键进行过滤。如果我们忘记向键中添加一列，就有可能添加一个索引，但是如果集合的基数很大，这可能会降低性能。</p><h1 id="d61f" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">没有酸</h1><p id="c010" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">ACID属性简化了代码编写。我们不需要处理与X表中的数据已经存在而Y表中还没有(如果有的话)这一事实相关的错误。从<a class="ae kz" href="https://en.wikipedia.org/wiki/CAP_theorem" rel="noopener ugc nofollow" target="_blank"> CAP </a>定理我们知道有一致的和<a class="ae kz" href="https://en.wikipedia.org/wiki/Eventual_consistency" rel="noopener ugc nofollow" target="_blank">最终一致的</a>数据库。这种类型最流行的数据库是Apache Cassandra。最终的一致性需要不同的数据建模和应用程序逻辑方法。应该以一种更具防御性的方式编写代码，因为不能确定您刚刚更改的记录是否已经可以从应用程序的另一部分获得。HBase是一致性数据库的一个例子，但即使是<a class="ae kz" href="https://blog.cloudera.com/apache-hbase-dos-and-donts/" rel="noopener ugc nofollow" target="_blank"> Cloudera也认为它不会取代关系数据库。</a>有些数据库标榜自己是一致的，只是在一定程度上保证了一致性。比如MongoDB提供了事务，但是<a class="ae kz" href="https://www.mongodb.com/blog/post/mongodb-multi-document-acid-transactions-general-availability" rel="noopener ugc nofollow" target="_blank">多文档事务只有从4.0版本开始才有。</a></p><h1 id="aa81" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">没有SQL</h1><p id="be5e" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">NoSQL的缺点是缺乏… SQL😁。我们可能喜欢也可能不喜欢，但是SQL是数据的基础。许多分析师每天都在使用SQL，学习另一种语言可能会阻碍他们使用数据库。创建<a class="ae kz" href="https://databricks.com/glossary/what-is-spark-sql" rel="noopener ugc nofollow" target="_blank">火花SQL </a>或<a class="ae kz" href="https://beam.apache.org/documentation/dsls/sql/overview/" rel="noopener ugc nofollow" target="_blank">光束SQL </a>是有原因的。</p><h1 id="1486" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">有限的分析和/或无连接</h1><p id="447c" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">这是对<a class="ae kz" href="https://en.wikipedia.org/wiki/Online_transaction_processing" rel="noopener ugc nofollow" target="_blank"> OLTP </a>和<a class="ae kz" href="https://en.wikipedia.org/wiki/Online_analytical_processing" rel="noopener ugc nofollow" target="_blank"> OLAP </a>系统之间差异的一点讨论。我们习惯于使用GROUP BY和JOIN子句，但并不是每个数据库都提供这样的功能。由于数据库的性质，聚合和合并可能非常有限(如果可能)。在Apache Cassandra的例子中，分析功能通常是通过组合Apache Spark集群来实现的。你将从<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/how-to-start-with-apache-spark-and-apache-cassandra-886a648bd2fb">我的这个故事</a>中学到如何把一个和另一个联系起来。</p><h1 id="5b5e" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">摘要</h1><p id="c6bf" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">那么，使用NoSQL值得吗？当然是了。我们必须记住，每个数据库都是为了解决一类问题而创建的。弯曲“命运”是可能的，但会有后果。螺丝更容易用螺丝刀拧进去，用锤子敲钉子，用滚筒敲打墙壁。</p><p id="e687" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一个有趣的选择是NewSQL数据库。这种底座的一个例子是<a class="ae kz" href="https://www.cockroachlabs.com/product/" rel="noopener ugc nofollow" target="_blank">cocroach db</a>和<a class="ae kz" href="https://cloud.google.com/spanner" rel="noopener ugc nofollow" target="_blank">扳手</a>。它们解决了传统关系数据库的问题(主要是伸缩问题)，同时保持了<a class="ae kz" href="https://pl.wikipedia.org/wiki/ACID" rel="noopener ugc nofollow" target="_blank"> ACID </a>属性。</p></div></div>    
</body>
</html>
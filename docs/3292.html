<html>
<head>
<title>Collecting Code Coverage for a Jenkins Shared Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">收集Jenkins共享库的代码覆盖率</h1>
<blockquote>原文：<a href="https://itnext.io/collecting-code-coverage-for-a-jenkins-shared-library-c2d8f502732e?source=collection_archive---------1-----------------------#2019-11-15">https://itnext.io/collecting-code-coverage-for-a-jenkins-shared-library-c2d8f502732e?source=collection_archive---------1-----------------------#2019-11-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ea54" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我的Jenkins共享库系列的第四部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9746f5e21ebee43ceaaaf97de40026bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xY4qH6IqSRQ7SJnVJDDZw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://jenkins.io/" rel="noopener ugc nofollow" target="_blank">https://jenkins.io/</a></figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="c3a1" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在我之前的文章中，我们讨论了如何为Jenkins共享库编写单元测试。在我的Jenkins共享库系列的第四篇也是最后一篇文章中，我将向您展示如何对您的共享库进行一些小的更改，这将允许您收集代码覆盖率并将结果发布到<a class="ae kv" href="https://www.sonarqube.org/" rel="noopener ugc nofollow" target="_blank"> Sonarqube </a>。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="beb6" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">先决条件</h1><p id="6425" class="pw-post-body-paragraph ld le iq lf b lg mr jr li lj ms ju ll lm mt lo lp lq mu ls lt lu mv lw lx ly ij bi translated">对于本教程，我们需要在本地安装Sonarqube。您可以遵循此处提供的<a class="ae kv" href="https://hub.docker.com/_/sonarqube/" rel="noopener ugc nofollow" target="_blank">说明。查找“两分钟入门指南”下的说明。这应该会让您在</a><a class="ae kv" href="http://localhost:9000/about" rel="noopener ugc nofollow" target="_blank"> http://localhost:9000 </a>获得一个正在运行的Sonarqube实例。您可以使用默认用户名<code class="fe mw mx my mz b">admin</code>和密码<code class="fe mw mx my mz b">admin</code>登录。</p><p id="9ac1" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们需要做的下一件事是安装SonarQube Groovy插件。登录后，导航至<a class="ae kv" href="http://localhost:9000/admin/marketplace" rel="noopener ugc nofollow" target="_blank">http://localhost:9000/admin/market place</a>。您将看到这样一个屏幕:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/c6ec63d41a5f7efbc657cd254e135ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtMSz19FqNAmZ0uEU0eySQ.png"/></div></div></figure><p id="322b" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在插件下的搜索框中，搜索<code class="fe mw mx my mz b">groovy</code>，然后点击插件右侧的<code class="fe mw mx my mz b">install</code>按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/be6fc1ea1027b39613465d437bbb888a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32oh7Q274gtESrv6wjm1Qw.png"/></div></div></figure><p id="a071" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">当你点击<code class="fe mw mx my mz b">Install</code>，你会看到一条信息告诉你重启Sonarqube。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/311122b5c3f27bae7da1fd69ad3c4202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ajirtctQZSHb7pSWpmg64A.png"/></div></div></figure><p id="dec5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">点击<code class="fe mw mx my mz b">Restart</code>。</p><p id="360f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">Sonarqube将重新启动，然后会要求您再次登录。使用之前的默认用户名和密码。一旦完成，Sonarqube就可以开始运行了！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="9e0c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">入门指南</h1><p id="68ab" class="pw-post-body-paragraph ld le iq lf b lg mr jr li lj ms ju ll lm mt lo lp lq mu ls lt lu mv lw lx ly ij bi translated">本教程从系列文章的第三部分<a class="ae kv" href="https://medium.com/@werne2j/unit-testing-a-jenkins-shared-library-9bfb6b599748" rel="noopener">开始。如果你还没有跟上，我推荐你回到本系列的第一部分，或者你可以从https://github.com/werne2j/jenkins-shared-library克隆共享库。我们将继续在<code class="fe mw mx my mz b">tests</code>分公司工作。运行<code class="fe mw mx my mz b">git checkout tests</code>，这将让你回到我们开始的地方。</a></p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="fc34" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">收集代码覆盖率</h1><p id="8576" class="pw-post-body-paragraph ld le iq lf b lg mr jr li lj ms ju ll lm mt lo lp lq mu ls lt lu mv lw lx ly ij bi translated">我们将使用<a class="ae kv" href="https://github.com/jacoco/jacoco" rel="noopener ugc nofollow" target="_blank"> JaCoCo </a>为我们的共享库收集代码覆盖率。这需要对我们的<code class="fe mw mx my mz b">pom.xml</code>文件做一些修改。</p><p id="343e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们要添加的第一件事是Sonarqube需要的一些属性。在<code class="fe mw mx my mz b">properties</code>标签下，我们将添加:</p><pre class="kg kh ki kj gt nd mz ne nf aw ng bi"><span id="7a81" class="nh ma iq mz b gy ni nj l nk nl">&lt;properties&gt;</span><span id="6870" class="nh ma iq mz b gy nm nj l nk nl">...</span><span id="aef8" class="nh ma iq mz b gy nm nj l nk nl">&lt;sonar.projectName&gt;jenkins-shared-library&lt;/sonar.projectName&gt;<br/>  &lt;sonar.projectKey&gt;jenkins-shared-library&lt;/sonar.projectKey&gt;<br/>  &lt;sonar.sources&gt;src,vars&lt;/sonar.sources&gt;<br/>  &lt;sonar.tests&gt;test&lt;/sonar.test&gt;<br/>&lt;sonar.groovy.jacoco.reportPath&gt;target/jacoco.exec&lt;/sonar.groovy.jacoco.reportPath&gt;<br/>&lt;/properties&gt;</span></pre><p id="e30f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这告诉Sonarqube用<code class="fe mw mx my mz b">projectName</code>和<code class="fe mw mx my mz b">projectKey</code>向什么项目报告。代码分析的位置和测试的位置。最后，在哪里寻找代码覆盖率分析。</p><p id="dd7f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">接下来，我们需要在<code class="fe mw mx my mz b">pluginManagement —&gt; plugin</code>标签下添加JaCoCo插件。</p><pre class="kg kh ki kj gt nd mz ne nf aw ng bi"><span id="875e" class="nh ma iq mz b gy ni nj l nk nl">&lt;build&gt;<br/>  &lt;pluginManagement&gt;<br/>    &lt;plugins&gt;<br/>      ...<br/>      &lt;plugin&gt;<br/>        &lt;groupId&gt;org.jacoco&lt;/groupId&gt;<br/>        &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;<br/>        &lt;version&gt;0.8.3&lt;/version&gt;<br/>        &lt;executions&gt;<br/>          &lt;execution&gt;<br/>            &lt;goals&gt;<br/>              &lt;goal&gt;prepare-agent&lt;/goal&gt;<br/>            &lt;/goals&gt;<br/>          &lt;/execution&gt;<br/>          &lt;execution&gt;<br/>            &lt;id&gt;report&lt;/id&gt;<br/>            &lt;phase&gt;test&lt;/phase&gt;<br/>            &lt;goals&gt;<br/>              &lt;goal&gt;report&lt;/goal&gt;<br/>            &lt;/goals&gt;<br/>          &lt;/execution&gt;<br/>        &lt;/executions&gt;<br/>      &lt;/plugin&gt;<br/>    &lt;/plugins&gt;<br/>  &lt;/pluginManagement&gt;<br/>  &lt;plugins&gt;<br/>    ...<br/>    &lt;plugin&gt;<br/>      &lt;groupId&gt;org.jacoco&lt;/groupId&gt;<br/>      &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;<br/>    &lt;/plugin&gt;<br/>  &lt;/plugins&gt;<br/>&lt;/build&gt;</span></pre><p id="08ac" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这使得插件可以使用，并告诉插件在<code class="fe mw mx my mz b">test</code>阶段运行。因此，当我们运行<code class="fe mw mx my mz b">mvn test</code>时，将会创建一个覆盖报告。</p><p id="4669" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">就是这样！</p><p id="e04c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">让我们测试收集代码覆盖率，看看我们得到了什么！</p><p id="423c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们将运行<code class="fe mw mx my mz b">mvn clean test</code>来生成一个JaCoCo报告。</p><p id="436b" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们应该得到这样的输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/b36c5ace636f684ad1777440bb46aade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lbK6kCzYFq9fOJQI1X4i5A.png"/></div></div></figure><p id="a606" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果您向下看测试的输出，您将会看到<code class="fe mw mx my mz b">jacoco-maven-plugin</code>生成一个覆盖报告。现在我们将把这份报告发给Sonarqube，看看结果如何。</p><p id="d4b5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，在您的终端中，运行<code class="fe mw mx my mz b">mvn sonar:sonar</code>。这将分析项目并向Sonarqube报告其结果。命令完成后，您可以导航到<a class="ae kv" href="http://localhost:9000/dashboard?id=jenkins-shared-library" rel="noopener ugc nofollow" target="_blank">http://localhost:9000/dashboard？id=jenkins-shared-library </a>并查看分析结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/0cc8a65fea0888cc45e2bebdc36116b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhPcWJzNpmdJDi5NexdsuQ.png"/></div></div></figure><p id="e19e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">但是等等，有些事情看起来不对劲——我们没有看到任何代码覆盖率。这其实是意料之中的。如果你看看詹金斯-斯波克杂志上的这篇评论，它谈到收集报道是多么不容易。</p><p id="848d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">然而，通过我收集代码覆盖率的尝试和磨难，我能够提出这个问题的解决方案。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="c07f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">重构共享库</h1><p id="1622" class="pw-post-body-paragraph ld le iq lf b lg mr jr li lj ms ju ll lm mt lo lp lq mu ls lt lu mv lw lx ly ij bi translated">为了收集共享库的代码覆盖率，我们将把全局变量的逻辑移到<code class="fe mw mx my mz b">src</code>目录中。</p><p id="e642" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们将在<code class="fe mw mx my mz b">src/org/example</code>中创建两个类<code class="fe mw mx my mz b">BuildJavascriptApp</code>和<code class="fe mw mx my mz b">Notify</code>。为了与之匹配，我们将创建两个新的测试文件<code class="fe mw mx my mz b">BuildJavascriptAppSpec</code>和<code class="fe mw mx my mz b">NotifySpec</code>，它们将位于<code class="fe mw mx my mz b">test/src/org/example</code>中。目录结构现在应该看起来像这样:</p><pre class="kg kh ki kj gt nd mz ne nf aw ng bi"><span id="7780" class="nh ma iq mz b gy ni nj l nk nl">├── jenkins-shared-library<br/>│   ├── src<br/>│   │   ├── org<br/>│   │   │   ├── example<br/>│   │   │   │   ├── BuildJavascriptApp.groovy<br/>│   │   │   │   ├── Constants.groovy<br/>│   │   │   │   ├── Notify.groovy<br/>│   ├── test<br/>│   │   ├── resources<br/>|   │   ├── src<br/>│   │   |   ├── org<br/>│   │   │   |   ├── example<br/>│   │   │   │   |   ├── BuildJavascriptAppSpec.groovy<br/>│   │   │   │   |   ├── NotifySpec.groovy<br/>│   │   ├── vars<br/>│   ├── vars<br/>│   │   ├── buildJavascriptApp.groovy<br/>│   │   ├── notify.groovy</span></pre><p id="012d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">看看我们的类，它们看起来和全局变量非常相似。例如，下面是<code class="fe mw mx my mz b">BuildJavascriptApp.groovy</code>的样子:</p><pre class="kg kh ki kj gt nd mz ne nf aw ng bi"><span id="1580" class="nh ma iq mz b gy ni nj l nk nl">package org.example</span><span id="c4be" class="nh ma iq mz b gy nm nj l nk nl">class BuildJavascriptApp {<br/>  def exec(Map config=[:], Closure body={}) {<br/>    node {<br/>      git url: "<a class="ae kv" href="https://github.com/werne2j/sample-nodejs" rel="noopener ugc nofollow" target="_blank">https://github.com/werne2j/sample-nodejs</a>"</span><span id="7092" class="nh ma iq mz b gy nm nj l nk nl">      stage("Install") {<br/>        sh "npm install"<br/>      }</span><span id="4ea2" class="nh ma iq mz b gy nm nj l nk nl">      stage("Test") {<br/>        sh "npm test"<br/>      }</span><span id="7fc2" class="nh ma iq mz b gy nm nj l nk nl">      stage("Deploy") {<br/>        if (config.deploy) {<br/>          sh "npm publish"<br/>        }<br/>      }</span><span id="96a8" class="nh ma iq mz b gy nm nj l nk nl">      body()<br/>    }<br/>  }<br/>}</span></pre><p id="7ca1" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们获取全局变量，并将其包装在一个类的<code class="fe mw mx my mz b">exec</code>方法中。</p><p id="db74" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在对于我们的全局变量，我们将更新它来调用我们的新类。</p><pre class="kg kh ki kj gt nd mz ne nf aw ng bi"><span id="980a" class="nh ma iq mz b gy ni nj l nk nl">import org.example.BuildJavascriptApp</span><span id="6612" class="nh ma iq mz b gy nm nj l nk nl">def call(Map config=[:], Closure body={}) {<br/>    def buildJavascriptApp = new BuildJavascriptApp()<br/>    buildJavascriptApp.exec(config, body)<br/>}</span></pre><p id="eee9" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在我们的全局变量非常简单，只调用我们的新类。</p><p id="7553" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">最后要做的事情是更新测试。我们将把测试从<code class="fe mw mx my mz b">test/vars/BuildJavascriptAppSpec.groovy</code>复制到我们在<code class="fe mw mx my mz b">test/src/org/example/BuildJavascriptAppSpec.groovy</code>创建的新测试文件中。我们唯一要做的就是做一些小调整。我们将装入类而不是变量，因为我们将所有的逻辑都移到了类中。然后我们将调用<code class="fe mw mx my mz b">exec</code>方法，而不是调用变量。代码应该如下所示:</p><pre class="kg kh ki kj gt nd mz ne nf aw ng bi"><span id="7b99" class="nh ma iq mz b gy ni nj l nk nl">import com.homeaway.devtools.jenkins.testing.JenkinsPipelineSpecification<br/>import org.example.BuildJavascriptApp</span><span id="5d00" class="nh ma iq mz b gy nm nj l nk nl">class BuildJavascriptAppSpec extends JenkinsPipelineSpecification {<br/>  def buildJavascriptApp = null</span><span id="7ac5" class="nh ma iq mz b gy nm nj l nk nl">  def setup() {<br/>    buildJavascriptApp = new BuildJavascriptApp()<br/>  }</span><span id="c7e1" class="nh ma iq mz b gy nm nj l nk nl">  def "[buildJavascriptApp] will run npm publish if deploy is true"() {<br/>    when:<br/>      buildJavascriptApp.exec(deploy: true)<br/>    then:<br/>      1 * getPipelineMock("sh")("npm publish")<br/>  }</span><span id="54ca" class="nh ma iq mz b gy nm nj l nk nl">  def "[buildJavascriptApp] will not npm publish if deploy is false"() {<br/>    when:<br/>      buildJavascriptApp.exec(deploy: false)<br/>    then:<br/>      0 * getPipelineMock("sh")("npm publish")<br/>  }</span><span id="e770" class="nh ma iq mz b gy nm nj l nk nl">  def "[buildJavascriptApp] will call closure if passed"() {<br/>    setup:<br/>      def body = Mock(Closure)<br/>    when:<br/>      buildJavascriptApp.exec(deploy: false, body)<br/>    then:<br/>      1 * body()<br/>  }<br/>}</span></pre><p id="5878" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">您现在可以删除位于<code class="fe mw mx my mz b">test/vars</code>目录中的先前测试。这是我们需要做的最后一件事，来转换代码，以便能够收集代码覆盖率。我会让你试着将<code class="fe mw mx my mz b">notify</code>变量转换成一个类中的逻辑，就像我们对<code class="fe mw mx my mz b">buildJavascriptApp</code>所做的那样。</p><p id="6e9a" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果你想看最终的结果，在<a class="ae kv" href="https://github.com/werne2j/jenkins-shared-library/tree/sonarqube" rel="noopener ugc nofollow" target="_blank">https://github . com/werne 2j/Jenkins-shared-library/tree/sonar qube</a>有一个完整的例子。</p><p id="b40c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">一旦库被重新构建，我们将重新运行测试，并尝试用Sonarqube重新分析库。</p><p id="34c1" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">同样，我们将运行<code class="fe mw mx my mz b">mvn clean test</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/0e37eed24d122224d52fde9417bb1c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fchKjo5h2T-UVb71AzItCw.png"/></div></div></figure><p id="b74b" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们看到测试已经成功，我们的新报告已经生成。</p><p id="d577" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在让我们再运行一次<code class="fe mw mx my mz b">mvn sonar:sonar</code>。当命令运行完毕后，导航回<a class="ae kv" href="http://localhost:9000/dashboard?id=jenkins-shared-library" rel="noopener ugc nofollow" target="_blank">http://localhost:9000/dashboard？id=jenkins共享库</a>。或者刷新页面，如果你还有它。我们应该看到新的东西。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/1b1182d8091ba6cd16251ef0a7c4a7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7IHllWOHaUoGkFHFqbKWmA.png"/></div></div></figure><p id="9bed" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这就是我们的覆盖范围！</p><h1 id="3ad3" class="lz ma iq bd mb mc nr me mf mg ns mi mj jw nt jx ml jz nu ka mn kc nv kd mp mq bi translated">结论</h1><p id="a152" class="pw-post-body-paragraph ld le iq lf b lg mr jr li lj ms ju ll lm mt lo lp lq mu ls lt lu mv lw lx ly ij bi translated">有了这个策略，我们现在可以在Jenkins共享库上收集代码覆盖率。这对于想要了解代码覆盖率是增加还是减少，或者是否被收集的经理或团队领导来说是非常好的。</p><p id="d9b3" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">感谢您阅读我的Jenkins共享库系列的第四部分。</p><p id="1b08" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我真的希望你喜欢我关于Jenkins共享库的系列文章。我们已经从解释什么是库以及如何使用它们，到编写测试，然后收集代码覆盖率。</p><p id="3355" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">希望你能从这个系列中学到知识，并将其应用到你的工作或个人努力中。</p><p id="7daa" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">再次感谢你，祝你在詹金斯共享图书馆的冒险中好运！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="3aac" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">我的詹金斯共享图书馆系列</h1><div class="nw nx gp gr ny nz"><a href="https://medium.com/@werne2j/jenkins-shared-libraries-part-1-5ba3d072536a" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">什么是Jenkins共享库，为什么你应该使用它们</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">Jenkins共享库系列文章的第1部分</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">medium.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on kp nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://medium.com/@werne2j/how-to-build-your-own-jenkins-shared-library-9dc129db260c" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">如何构建自己的Jenkins共享库</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">我的Jenkins共享库系列的第二部分</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">medium.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on kp nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://medium.com/@werne2j/unit-testing-a-jenkins-shared-library-9bfb6b599748" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">Jenkins共享库的单元测试</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">Jenkins共享库系列文章的第三部分</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">medium.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on kp nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://medium.com/@werne2j/collecting-code-coverage-for-a-jenkins-shared-library-c2d8f502732e" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">收集Jenkins共享库的代码覆盖率</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">我的Jenkins共享库系列的第四部分</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">medium.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on kp nz"/></div></div></a></div></div></div>    
</body>
</html>
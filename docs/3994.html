<html>
<head>
<title>Make Elements Fade In While Scrolling — Daily Vue Tip 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">滚动时让元素淡入Vue每日提示3</h1>
<blockquote>原文：<a href="https://itnext.io/make-elements-fade-in-while-scrolling-daily-vue-tip-3-6540dd975c7e?source=collection_archive---------3-----------------------#2020-04-07">https://itnext.io/make-elements-fade-in-while-scrolling-daily-vue-tip-3-6540dd975c7e?source=collection_archive---------3-----------------------#2020-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/22e3803a76756d074bdb50249ae2a177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_1ZxvqTcRaKfyLCF"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">托马斯·米洛特在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="da7a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">伟大的网站对用户的交互反应灵敏。一个很好的方法是对某人向下滚动你的页面做出反应。</p><p id="2b76" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了<a class="ae jg" href="https://learnvue.co/2020/04/a-beautiful-parallax-scrolling-effect-in-vuejs-daily-vue-tips-2/" rel="noopener ugc nofollow" target="_blank">视差组件</a>和滚动事件，一个增加响应触摸的好方法是当视图滚动时让元素淡入。</p><p id="c853" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇每日技巧中，我研究了如何在Vue3中使用<a class="ae jg" href="https://learnvue.co/2020/01/a-vue-event-handling-cheatsheet-the-essentials" rel="noopener ugc nofollow" target="_blank">滚动事件</a>和CSS转换来实现这一点。</p><p id="d0c1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我们将在本教程中学习如何构建的一个屏幕截图。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi le"><img src="../Images/6d33509b0c5359931aa9c5204ee1c314.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*CaYUcLoSpdJj2hHl.gif"/></div></figure><p id="1d21" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">准备好了吗？让我们开始编码；</p><h2 id="0bbd" class="lj lk jj bd ll lm ln dn lo lp lq dp lr kr ls lt lu kv lv lw lx kz ly lz ma mb bi translated">设计淡入元素的样式</h2><p id="ba31" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们要做的第一件事是构建模板并设计组件的样式。在这个例子中，我们将使用空块来展示事情是如何工作的。</p><p id="2ce0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以在我们的模板中，我们只想…</p><ul class=""><li id="7471" class="mh mi jj ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">包装容器</li><li id="f644" class="mh mi jj ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">几个全宽元素</li><li id="63f6" class="mh mi jj ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">一些半宽元素增加一些变化</li></ul><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="3ce8" class="lj lk jj mw b gy na nb l nc nd">&lt;template&gt;<br/>  &lt;div class='container'&gt;<br/>    &lt;div class='fade-in full-width' /&gt;<br/>    &lt;div class='fade-in full-width' /&gt;<br/>    &lt;div class='half-width fade-in' /&gt;<br/>    &lt;div class='half-width fade-in' /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="f7c4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，为了样式化它们，我们想要构建一个基本的容器，然后用一些填充、颜色和适当的宽度来样式化我们的块。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="5d87" class="lj lk jj mw b gy na nb l nc nd">&lt;style scoped&gt;<br/><br/>  .container {<br/>    width: 80%;<br/>    min-width: 450px;<br/>    margin: 0 auto;<br/>  }<br/><br/>  .fade-in {<br/>    background-color: #2ecc71;<br/>    height: 500px;<br/>    margin-bottom: 50px;<br/>    opacity: 0;<br/>    transition: 0.3s all ease-out;<br/>    transform: scale(0.8);<br/>    box-sizing: border-box;<br/>    padding: 20px;<br/>    display: inline-block;<br/>  }<br/>  .full-width{<br/>    width: 100%;<br/>  }<br/><br/>  .half-width {<br/>    width: 47.5%;<br/>  }<br/><br/>  .half-width:nth-of-type(2n + 1) {<br/>    margin-right: 2.5%;<br/>  }<br/><br/>  .half-width:nth-of-type(2n) {<br/>    margin-left: 2.5%;<br/>  }<br/>&lt;/style&gt;</span></pre><p id="bc47" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">需要注意的一点是，我们所有的淡入元素都是从默认的不透明度0开始的。我们会用我们的脚本处理淡入它们。我们还将改变元素的比例。</p><p id="bf0f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的<a class="ae jg" href="https://learnvue.co/2020/02/vuejs-animations-for-beginners/" rel="noopener ugc nofollow" target="_blank">淡入元素被赋予了一个过渡属性</a>，这意味着当我们改变不透明度和比例时，它将在我们的两个值之间平滑过渡——给我们带来我们想要的平滑效果。</p><p id="46f9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，如果我们加载我们的页面，我们不应该看到任何东西，但我们应该能够向下滚动页面，因为我们的元素在那里，但完全透明。</p><p id="d1a6" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们实际上使用一些Javascript使它们可见。</p><h2 id="ef99" class="lj lk jj bd ll lm ln dn lo lp lq dp lr kr ls lt lu kv lv lw lx kz ly lz ma mb bi translated">让我们的元素淡入</h2><p id="182d" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">对于本教程，我们将使用<a class="ae jg" href="https://learnvue.co/2019/12/a-first-look-at-vue3-a-vue-composition-api-tutorial/" rel="noopener ugc nofollow" target="_blank"> Vue组合API</a>——因此在我们的脚本中，我们首先要创建我们的设置方法并导入一些生命周期挂钩。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="3aa0" class="lj lk jj mw b gy na nb l nc nd">&lt;script&gt;<br/>import { onMounted, onUnmounted } from 'vue'<br/>export default {<br/>  setup () {<br/><br/>    onMounted(() =&gt; {<br/><br/>    })<br/><br/>    onUnmounted(() =&gt; {<br/><br/>    })<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="c863" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，让我们创建一个所有淡入元素的数组。我们可以通过使用<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName" rel="noopener ugc nofollow" target="_blank">document . getelementsbyclassname</a>来做到这一点——然而，这返回了一个HTMLCollection，我们需要一个数组，所以我们可以使用Javascript的Arr <code class="fe ne nf ng mw b">ay.from </code>方法来转换它。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="db7f" class="lj lk jj mw b gy na nb l nc nd">onMounted(() =&gt; {<br/>      fadeInElements = Array.from(document.getElementsByClassName('fade-in'))<br/>    })</span></pre><p id="bdfa" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经有了一个我们想要淡入的所有元素的数组，我们想要做一些事情:</p><ol class=""><li id="65f7" class="mh mi jj ki b kj kk kn ko kr mj kv mk kz ml ld nh mn mo mp bi translated">每当滚动视图时迭代它们</li><li id="3163" class="mh mi jj ki b kj mq kn mr kr ms kv mt kz mu ld nh mn mo mp bi translated">确定元素是否可见</li><li id="6c73" class="mh mi jj ki b kj mq kn mr kr ms kv mt kz mu ld nh mn mo mp bi translated">如果是，淡入并从我们的数组中移除</li></ol><p id="3380" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好吧。</p><p id="6486" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们希望在组件挂载时创建滚动监听器，并在组件卸载时删除它。我们想做的另一件事是，当我们的组件被挂载时，调用我们的handleScroll方法，这样一些内容就可以加载，而用户不必滚动来查看一些内容。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="1857" class="lj lk jj mw b gy na nb l nc nd">var fadeInElements = []<br/><br/>onMounted(() =&gt; {<br/>      fadeInElements = Array.from(document.getElementsByClassName('fade-in'))<br/>      document.addEventListener('scroll', handleScroll)<br/>      handleScroll()<br/>})<br/><br/>onUnmounted(() =&gt; {<br/>      document.removeEventListener('scroll', handleScroll)<br/>})</span></pre><p id="3b10" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的滚动侦听器中，让我们创建一个for循环，遍历我们创建的淡入元素数组。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="f2d9" class="lj lk jj mw b gy na nb l nc nd">const handleScroll = (evt) =&gt; {<br/>      for (var i = 0; i &lt; fadeInElements.length; i++) {<br/>        var elem = fadeInElements[i]<br/>      }<br/>}</span></pre><p id="3834" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，我们需要某种帮助方法来确定一个元素是否可见。为此，我们将使用元素的<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect" rel="noopener ugc nofollow" target="_blank">边界矩形</a>，它返回元素相对于视口的大小和位置。</p><p id="4a4a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还将添加一点缓冲，这样在淡入之前至少有200像素的元素是可见的。这将真正增强效果，因为它确保网站访问者将看到发生了什么。如果没有这个缓冲区，当元素的1个像素在屏幕上并且大部分在视窗之外时，淡入过渡就会触发。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="10e2" class="lj lk jj mw b gy na nb l nc nd">const isElemVisible = (el) =&gt; {<br/>      var rect = el.getBoundingClientRect()<br/>      var elemTop = rect.top + 200 // 200 = buffer<br/>      var elemBottom = rect.bottom<br/>      return elemTop &lt; window.innerHeight &amp;&amp; elemBottom &gt;= 0<br/>}</span></pre><p id="f3fe" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回到我们的滚动事件监听器，我们想看看我们的<code class="fe ne nf ng mw b">isElemVisible </code>辅助方法是否对每个元素都是真的。如果是，我们希望改变元素的不透明度和比例，然后将它从数组中移除。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="267c" class="lj lk jj mw b gy na nb l nc nd">for (var i = 0; i &lt; fadeInElements.length; i++) {<br/>        var elem = fadeInElements[i]<br/>        if (isElemVisible(elem)) {<br/>          elem.style.opacity = '1'<br/>          elem.style.transform = 'scale(1)'<br/>          fadeInElements.splice(i, 1) // only allow it to run once<br/>        }<br/>}</span></pre><p id="c771" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，如果我们回到我们的应用程序并检查它，您会看到当我们滚动时，元素变得可见。正是我们想要的！</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi le"><img src="../Images/b0eacc82ac7b50bb286c5f16ec66e4ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*J7OKWgZlaCa7otD-.gif"/></div></figure><h2 id="a0b5" class="lj lk jj bd ll lm ln dn lo lp lq dp lr kr ls lt lu kv lv lw lx kz ly lz ma mb bi translated">如果你想的话，我们结束了！</h2><p id="c09f" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">所以我们有了我们一直在寻找的滚动淡入效果！有很多方法可以扩展这种效果，例如:</p><ul class=""><li id="5b27" class="mh mi jj ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">让元素在滚动时淡出，以便可以再次淡入</li><li id="8742" class="mh mi jj ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">使用CSS动画而不是过渡添加更多高级内容</li><li id="43ee" class="mh mi jj ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">将逻辑提取到一个<a class="ae jg" href="https://learnvue.co/2020/01/creating-your-first-vuejs-custom-directive/" rel="noopener ugc nofollow" target="_blank">定制指令</a>中，这样就可以在整个项目中重用<a class="ae jg" href="https://learnvue.co/2020/03/extract-and-reuse-logic-in-the-vue-composition-api/" rel="noopener ugc nofollow" target="_blank"/></li></ul><p id="0c2c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只要你掌握了使用滚动监听器和CSS动画/过渡的诀窍，天空就是真正的极限。</p><p id="9a43" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你学到了一些东西，并能想出一些很酷的方法来将这些技术添加到你自己的Vue项目中。</p><p id="7c8c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有任何问题、意见或任何事情，请告诉我。我很想收到你的来信，看看你都做了些什么！</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="61bc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有兴趣了解更多关于Vue 3的知识，请下载我的免费Vue 3备忘单，里面有一些基本知识，比如合成API、Vue 3模板语法和事件处理。</p></div></div>    
</body>
</html>
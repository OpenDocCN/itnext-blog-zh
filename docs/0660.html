<html>
<head>
<title>Anyway, here’s how to make AJAX &amp; API calls with Vue JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不管怎样，下面是如何用Vue JS进行AJAX &amp; API调用</h1>
<blockquote>原文：<a href="https://itnext.io/anyway-heres-how-to-do-ajax-api-calls-with-vue-js-e71e57d5cf12?source=collection_archive---------0-----------------------#2018-05-02">https://itnext.io/anyway-heres-how-to-do-ajax-api-calls-with-vue-js-e71e57d5cf12?source=collection_archive---------0-----------------------#2018-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9e88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想用法语发布这个故事，但是…对不起，我的法国朋友，它会先用英语。</p><p id="1f68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近，我看到有人问如何用Vue处理AJAX请求和T2 API调用。</p><p id="eab3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">起初，我真的不明白为什么人们对此感到困惑，因为这不是一个Vue问题，而是一个JavaScript问题。</p><p id="40c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后……照明！我发现了为什么人们对此如此困惑:<br/>这是因为Vue非常灵活，没有任何规则，让你来做决定。</p><p id="eaac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然这对于小型项目可能是好的，但是对于中型到大型的项目，您需要知道何时以及如何分离关注点。</p><h2 id="b837" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">哪里可以做API调用？Mixins？Vuex动作？组件？</h2><p id="70b9" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">如果你只是想要最后的答案，那就去下一个标题。<br/>如果你想要一个详细的解释来成为一个更好的开发者，让我们看看所有的选项及其优缺点:</p><ul class=""><li id="0cc4" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated"><strong class="jp ir"> Mixins </strong>:你可以把它放在一个共享的mixin中，当你需要它的时候导入它<br/> - <strong class="jp ir">优点</strong>:你只在你需要它的时候加载<br/> - <strong class="jp ir"> CONS </strong>:你必须把它作为一个方法添加，因此，混合了模板使用的方法和与模板无关的JS逻辑使用的方法</li><li id="77b1" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated"><strong class="jp ir"> Vuex动作</strong>:你可以为每个AJAX请求创建一个Vuex动作<br/> - <strong class="jp ir">优点</strong>:它集中在你的组件中可用，可以改变全局状态<br/> - <strong class="jp ir"> CONS </strong>:嗯……你需要加载Vuex lol。如果您的项目不需要它，那么只为AJAX调用加载它就有点大材小用了。尤其是如果你没有在你的行为中做出改变，在我看来这就变成了一个<br/>反模式</li></ul><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/2b3d8fed34ea2c68fb750e980a99df32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*7Hkh8kNcJqIOAm3B59qsRg.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">来自Vuex的文档</figcaption></figure><ul class=""><li id="4ec6" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated"><strong class="jp ir">组件</strong>:你可以直接在你的组件<br/> - <strong class="jp ir">优点</strong>的方法中进行AJAX调用:你只需使用你需要的，不会过载<br/> - <strong class="jp ir"> CONS </strong>:你的调用分散在各处，维护起来会变得非常困难。如果两个组件需要相同的API调用，您可以创建代码复制</li></ul><p id="1adf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，<strong class="jp ir">它们都有优点和缺点</strong>那么哪一个是最好的呢？<br/>嗯，一个都没有，或者应该说:<strong class="jp ir">全部</strong>？</p><p id="1b7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这不是Vue的问题，是JavaScript架构的问题。</p><p id="39a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你应该问自己的问题是:我的API调用与Vue相关吗？<br/>答案是:<strong class="jp ir">不，它们和你的app </strong>有关。</p><p id="e76f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">凡是可以抽象的东西:<strong class="jp ir">抽象出来！</strong></p><h2 id="418e" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">解决方案:创建一个单独的JS文件来导入</h2><p id="2744" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">解决方案实际上很简单。你的API调用需要集中化和可重用，所以为什么不使用普通JS拥有的东西:一个<strong class="jp ir">类</strong>或<strong class="jp ir">对象文字</strong>。</p><p id="2ea6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于每个API资源，创建一个带有对象文字或静态类的API文件，或者只导出进行API调用的函数。</p><h2 id="eefa" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">为什么这样更好？</h2><ul class=""><li id="5629" class="lk ll iq jp b jq lf ju lg jy mk kc ml kg mm kk lp lq lr ls bi translated">如果您在另一个不是Vue项目的项目中需要它，那么:它是可重用的！它只是一个JS文件，对吗？</li><li id="348d" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">如果API中的路径/ url发生变化，它是集中的，所以不需要记住它是在哪个动作或哪个组件中被调用的，只需转到您的API文件并在那里进行更改:)</li><li id="4ebd" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">抽象总是比紧密耦合的逻辑更好</li></ul><p id="fd5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里有一些屏幕来理解我所说的。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/3aa7463f7a5a826a074e0f1e2d0ccf34.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*OTw15TodjuqZzfgjwAnhIA.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">这是全新安装</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/6397b7ce25ea44f8b71642588c022ddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*8WnrdKIVVAzWPmSDGEa0Ig.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">这是main.js文件，我在其中配置axios，AJAX库(它可以是任何其他库或fetch API)</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/e340cd8ff32f2fa9b2ba502b336906f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQDra2i5sDjB30BOknKtTw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">在这里，我创建了一个文件夹“services”和一个子文件夹“api ”,其中有我的API文件“Posts ”,它基本上只是一个带有方法的对象文字，我将这些方法导出为我的文件的默认值(es模块)</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mu"><img src="../Images/3d9aa12d8e74bca90aedb1c90001fbef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*thP5C3SOxHLbTILhY3deHQ.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">现在，这里是如何在你的组件中进行API调用，在Vuex动作中也是一样的。</figcaption></figure><p id="6faf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望这很清楚。API或GraphQL调用不能直接耦合到Vue。它们是独立的，不依赖于你的视图层，所以你可以抽象它们。</p><p id="b12a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是我在大中型Vue项目中总结的一些东西:</p><ul class=""><li id="2e2c" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated">自定义验证程序</li><li id="ed4a" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">Api或其他AJAX请求</li><li id="0906" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">模型(这里的模型不像后端模型，它更像一个数据格式化器，主要用于API文件中，在我将数据传递给组件之前格式化数据)</li><li id="814a" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">效用函数(但是大多数时候我直接将它们创建为mixins)</li><li id="da71" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">分析包装器/谷歌Api包装器/脸书包装器… <br/>任何不相关的Vue服务，我可以有</li></ul><p id="1813" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">记住，那些只是JS文件，你可以在组件或者Vuex存储或者Mixins等等中导入它们。</p><h2 id="c894" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">【Vuex商店示例(编辑)</h2><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mv"><img src="../Images/2898d88a482a3a7e2aa2bee631588040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLg5XEqyhVCE9GTcVKL9kQ.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">这是我的存储，其中有一个命名空间模块。不需要在我的组件中导入我的API处理程序，因为导入它的是我的存储。不要忘记在行动中回报承诺，这样你以后用的时候就可以链起来</figcaption></figure><p id="2863" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">框架和库很好，但是，<a class="ae kl" href="https://scotch.io/bar-talk/4-javascript-design-patterns-you-should-know" rel="noopener ugc nofollow" target="_blank"> JavaScript设计模式</a>更好。</p><p id="9801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个好处是，你也可以把它导入到Vue-router navigation guards或者任何其他你可以挂接到并执行一些API调用的库中:)</p><p id="9bcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PS:如果你想学习如何创建高级组件，可以查看我的课程:<a class="ae kl" href="https://courses.maisonfutari.com/mastering-vue-components-creating-a-ui-library-from-scratch?coupon=PRESALE" rel="noopener ugc nofollow" target="_blank">https://courses . maison futari . com/mastering-vue-components-creating-a-ui-library-from-scratch？优惠券=M </a> EDIUM</p><p id="4cfa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">有50%的折扣，因为你来自这个故事。</strong></p></div></div>    
</body>
</html>
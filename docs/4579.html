<html>
<head>
<title>How to remove sensitive files from GitHub commit history?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从GitHub提交历史中删除敏感文件？</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-remove-sensitive-files-from-github-commit-history-638a3f291f74?source=collection_archive---------2-----------------------#2020-07-29">https://itnext.io/how-to-remove-sensitive-files-from-github-commit-history-638a3f291f74?source=collection_archive---------2-----------------------#2020-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/7672299ce9ada4ff120240a1193443db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A7t1590y6mDVbDMR"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@yancymin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">扬西·敏</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6c44" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我学习CI/CD的时候，我不小心把我的数据库配置文件提交到了我的GitHub帐户，让它工作。</p><p id="d139" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只有在我这样做之后，我才发现环境变量可以用于像这样敏感的事情。所以我很快删除了数据库配置文件，但我仍然有一个问题。这是一个开源项目，所以每个人仍然可以在提交历史中看到我完整的配置文件。</p><p id="4b33" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，有一种方法可以去除它。你还不能用GitHub desktop做到这一点，所以你需要使用命令行。转到您的分支并执行以下命令(确保添加您的文件路径)</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="80b7" class="ln lo it lj b gy lp lq l lr ls">git filter-branch --force --index-filter \</span><span id="284e" class="ln lo it lj b gy lt lq l lr ls">"git rm --cached --ignore-unmatch INSERT_PATH_TO_FILE_HERE" \</span><span id="bc6c" class="ln lo it lj b gy lt lq l lr ls">--prune-empty --tag-name-filter cat -- --all</span></pre><p id="a6ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你有了这个，你可以在你的GitHub桌面上检查历史，你会看到这个文件不再存在于你的任何提交历史中。但是，你仍然会在GitHub网站上看到它。简单的推拉不会在这里切断它。如果您尝试这样做，您将看到以下错误:<strong class="ki iu"> <em class="lu">无法合并该存储库中不相关的历史。</em> </strong></p><p id="b3e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要正确执行此操作，您需要使用以下命令进行强制推送</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c749" class="ln lo it lj b gy lp lq l lr ls">git push origin --force --all</span></pre><p id="8dd3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就对了。您的敏感文件将从您的提交历史记录中完全删除，您再也不用担心人们会发现它们！</p><p id="c5f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读！</p><p id="e5ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">推特:@tadaspetra</p><p id="aaae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">YouTube:<a class="ae kf" href="https://www.youtube.com/amateurcoder" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/tadaspetra</a></p></div></div>    
</body>
</html>
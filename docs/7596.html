<html>
<head>
<title>How to customise Firebase In-App Messaging on iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在iOS上定制Firebase应用内消息</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-customise-firebase-in-app-messaging-on-ios-56594bac94dd?source=collection_archive---------2-----------------------#2022-11-18">https://itnext.io/how-to-customise-firebase-in-app-messaging-on-ios-56594bac94dd?source=collection_archive---------2-----------------------#2022-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b690" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Firebase提供了定制应用内消息的“开箱即用”功能。但是有一个更简单的方法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/225098fc2a60fb3f7c1e6f6c0e008bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CmHM-wP5xXN9596V"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">沃洛季米尔·赫里先科在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6682" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">应用内消息是您发送给用户的消息，以响应他们在您的应用中执行的操作。这一强大的功能可以提高参与度和客户认同度。你当然可以想象使用这些信息来推动特色产品或应用程序的个性化。Firebase提供了开箱即用的功能，但是定制这些消息的行为相当复杂。</p><p id="1cef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Firebase文档建议直接在库中编辑故事板文件。虽然这很容易做到，但它有一个明显的缺点；如果没有迁移对故事板文件所做的更改，您将无法更新库。</p><p id="1a5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是还有一个选择。</p><h1 id="5e4f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">显示自定义消息</h1><p id="fd5f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">尽管Firebase具有消息的所有必要功能(包括分析事件)，但我们发现默认设置有某种“Google-y”的外观，这不符合我们正在编写的应用程序的品牌。因此，我们决定创造自己的视图，与品牌相匹配。我们发现我们可以在导入“FirebaseInAppMessaging”时实现“InAppMessagingDisplay ”,这允许我们决定显示什么视图来响应Firebase想要显示的消息类型。</p><p id="e711" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是我们如何做到这一点的一个例子:</p><p id="8fbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们基本上是打开“InAppMessagingDisplayMessage”的“类型”。重要的是不要忘记这里的委托方法，即当消息被显示/消除时，调用相关函数来告诉firebase X消息已经被显示和消除，这允许firebase对消息进行排队，并确保后续消息被正确显示。</p><p id="5920" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在创建我们自己的自定义视图时，我们可以更好地控制何时显示某些类型的消息。例如，我们希望提高人们在应用程序中接受通知权限的选择加入率，为此，我们认为针对特定事件(如购买或产品返回库存)的目标消息可以反映所采取的行动，从而提高选择加入率。</p><p id="52cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里的问题是，我们不想向已经选择了推送通知的用户显示这条消息。Firebase不知道哪些用户选择了加入还是没有加入，因此开箱即用的消息无法进行区分。</p><p id="51c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们新的定制信息管理器中，你可以通过几种方式做到这一点。当您在操作按钮中看到某个URL时，您可以检查通知的状态，或者检查消息中附加数据字段的某个字段。记住，如果你决定不显示消息，你必须调用委托上的解除函数，让Firebase知道你的应用程序准备好显示另一条消息。</p><p id="4c4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，创建我们自己的定制视图意味着我们不得不重写视图的显示逻辑，以便让消息感觉自然，而不只是出现在屏幕上。当我们展示卡片、纯图像或模态信息时，我们会将背景灰化，并从底部将视图动画化。这感觉很自然，符合应用程序的UX。对于横幅广告，我们模拟了标准iOS通知的行为，视图在顶部出现了几秒钟，然后消失。</p><p id="8ab6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鉴于我们现在已经实现了“InAppMessagingDisplay ”,我们能够定制我们想要显示到我们心中的内容的消息。</p><p id="1a45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于版本控制的说明；当我们添加新的视图/操作来响应消息时，我们必须注意它们所在的应用程序版本，因为它们需要新的版本才能显示。我们通过confluence跟踪什么消息/动作处于什么版本，并确保在设置新的活动时，我们只针对控制台中的那个版本。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="9e5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mw">最初发表于</em><a class="ae kv" href="https://www.brightec.co.uk/blog/what-is-the-best-way-to-customise-firebase-in-app-messaging-on-ios" rel="noopener ugc nofollow" target="_blank"><em class="mw">【https://www.brightec.co.uk】</em></a><em class="mw">。</em></p></div></div>    
</body>
</html>
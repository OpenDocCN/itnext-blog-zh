<html>
<head>
<title>Android Proximity Sensor As Clear As Possible</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android接近传感器尽可能清晰</h1>
<blockquote>原文：<a href="https://itnext.io/android-proximity-sensor-as-clear-as-possible-593774d90dd2?source=collection_archive---------1-----------------------#2020-12-30">https://itnext.io/android-proximity-sensor-as-clear-as-possible-593774d90dd2?source=collection_archive---------1-----------------------#2020-12-30</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5c2d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">近程传感器可以检测短距离(约5厘米)</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/222bdf0e5f0a9393a85b6a3fd2e3b2e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dn5lQ4zcQINoecKv"/></div></div></figure><p id="f72c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi lr translated"><span class="l ls lt lu bm lv lw lx ly lz di"> P </span>近距离传感器是一种近距离检测元件。最大距离约为5厘米。Google提供<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager" rel="noopener ugc nofollow" target="_blank">SensorManager</a></code>来处理app和硬件传感器之间的操作。开发人员可以使用距离信息来提供更好的UX，例如，当用户接听电话时将屏幕变暗。</p><div class="kk kl km kn gu ab cb"><figure class="mf ko mg mh mi mj mk paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><img src="../Images/ca95c6185733bb69cc3ff93b44f8988b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*D3CmyEzuOMbjqNmqyE2n_w.png"/></div></figure><figure class="mf ko ml mh mi mj mk paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><img src="../Images/7943dda953d557c8127d1a9df5cbd239.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*rl6xB79ZyRlXOQrlClrQ-g.png"/></div><figcaption class="mm mn gk gi gj mo mp bd b be z dk mq di mr ms translated">不同类型的接近传感器；左:三星Galaxy Note 5 (2015) Vs右:三星Galaxy S10+ (2019)</figcaption></figure></div><p id="4824" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">此外，市场上主要有两种类型的接近传感器。它们既可以嵌入边框，也可以放在屏幕下面。</p><p id="556c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Android中近程传感器的实现很简单，只需要3个步骤！让我们深入研究一下。</p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="e4e4" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">一体化代码</h1><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ns nt l"/></div></figure></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="7eab" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">逐步说明</h1><h2 id="2a92" class="nu nb iu bd nc nv nw dn ng nx ny dp nk le nz oa nm li ob oc no lm od oe nq of bi translated">步骤1:获取SensorManager系统服务</h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ns nt l"/></div></figure><p id="6373" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager" rel="noopener ugc nofollow" target="_blank">SensorManager</a></code>是安卓系统服务。我们可以使用<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/content/Context#getSystemService(java.lang.String)" rel="noopener ugc nofollow" target="_blank">getSystemService</a>()</code>很容易地取回它。</p><h2 id="97e1" class="nu nb iu bd nc nv nw dn ng nx ny dp nk le nz oa nm li ob oc no lm od oe nq of bi translated">步骤2:通过SensorManager访问近程传感器</h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ns nt l"/></div></figure><p id="e43d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">然而，接近传感器在现代Android设备中只是一个可选组件，尤其是对于平板电脑。我们必须添加一个空检查来防止任何运行时错误！</p><h2 id="a9a4" class="nu nb iu bd nc nv nw dn ng nx ny dp nk le nz oa nm li ob oc no lm od oe nq of bi translated">第三步:注册<code class="fe ma mb mc md b">SensorEventListener</code></h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ns nt l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj og"><img src="../Images/53cc0cb367e79dd4d212c99166456578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVEQhAX8K-Di5g08HVSKeg.png"/></div></div></figure><p id="142b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorEventListener" rel="noopener ugc nofollow" target="_blank">SensorEventListener</a></code>是所有硬件传感器的通用监听器。不同的传感器会传回不同种类的数据。根据官方文档，接近传感器检测到的距离存储在返回的<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorEvent" rel="noopener ugc nofollow" target="_blank">SensorEvent</a></code>对象中<code class="fe ma mb mc md b">values</code>字段的第一个元素。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oh"><img src="../Images/ff6d75d8a91cc14348733726b814410d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*Ce6oFO048QGAzY3P.gif"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oi"><img src="../Images/ecb31a76c67235f17e7e8a78d3cd5494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h3lFs4YyUIqRGd3x0Y1CJA.png"/></div></div></figure><p id="c578" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">构建并运行您的应用程序。如果您的手不断地在接近传感器上来回移动，就会显示上面的日志。</p><blockquote class="oj ok ol"><p id="392d" class="kv kw om kx b ky kz jv la lb lc jy ld on lf lg lh oo lj lk ll op ln lo lp lq in bi translated">顺便说一下，不是所有的接近传感器都会返回准确的检测距离。有些传感器会返回一个二进制值，以显示它是“近”值还是“远”值。</p></blockquote></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="bf81" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">准确(性)</h1><p id="aec9" class="pw-post-body-paragraph kv kw iu kx b ky oq jv la lb or jy ld le os lg lh li ot lk ll lm ou lo lp lq in bi translated">在不同的情况下，例如温度，传感器可以具有不同的灵敏度和精度。我们必须从原始数据中过滤出那些不准确的数据。</p><p id="c1fe" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">从<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorEventListener" rel="noopener ugc nofollow" target="_blank">SensorEventListener</a></code>返回的总共有五个可能的精度等级:</p><ol class=""><li id="45f3" class="ov ow iu kx b ky kz lb lc le ox li oy lm oz lq pa pb pc pd bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_STATUS_ACCURACY_HIGH" rel="noopener ugc nofollow" target="_blank"><strong class="kx iv">SENSOR_STATUS_ACCURACY_HIGH</strong></a></code> <br/>传感器以其<strong class="kx iv">最大精度</strong>运行，数据最可靠。</li><li id="df96" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_STATUS_ACCURACY_MEDIUM" rel="noopener ugc nofollow" target="_blank"><strong class="kx iv">SENSOR_STATUS_ACCURACY_MEDIUM</strong></a></code> <br/>精度尚可接受，但建议校准以提高精度。</li><li id="31b0" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_STATUS_ACCURACY_LOW" rel="noopener ugc nofollow" target="_blank"><strong class="kx iv">SENSOR_STATUS_ACCURACY_LOW</strong></a></code> <br/>误差较大，强烈建议校准。</li><li id="d906" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_STATUS_UNRELIABLE" rel="noopener ugc nofollow" target="_blank"><strong class="kx iv">SENSOR_STATUS_UNRELIABLE</strong></a></code> <br/>数据不可信，因为传感器没有正常工作。</li><li id="1948" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_STATUS_NO_CONTACT" rel="noopener ugc nofollow" target="_blank"><strong class="kx iv">SENSOR_STATUS_NO_CONTACT</strong></a></code> <br/>(不适用于近程传感器)传感器没有与其测量对象接触。</li></ol><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ns nt l"/></div></figure><p id="a436" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">因此，<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorEventListener#onSensorChanged(android.hardware.SensorEvent)" rel="noopener ugc nofollow" target="_blank">onSensorChanged</a></code>回调应该更新到上面的代码以获得更可靠的数据。</p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="f84e" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">最大距离</h1><p id="caf3" class="pw-post-body-paragraph kv kw iu kx b ky oq jv la lb or jy ld le os lg lh li ot lk ll lm ou lo lp lq in bi translated">如上所述，接近传感器可以检测大约5厘米的距离。然而，不同的传感器会有不同的范围。您可以通过以下方式获得最大距离:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ns nt l"/></div></figure><p id="7649" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我在以下设备上运行了一个示例应用程序，结果如下:</p><ol class=""><li id="59a8" class="ov ow iu kx b ky kz lb lc le ox li oy lm oz lq pa pb pc pd bi translated"><strong class="kx iv">三星Galaxy Nexus (2012) </strong> : 5cm</li><li id="577c" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><strong class="kx iv">三星Galaxy Note 5 (2015) </strong> : 8cm</li><li id="60da" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><strong class="kx iv">像素3a (2019) </strong> : 5cm</li></ol></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="c31a" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">您可能会喜欢下面的文章:</h1><div class="pj pk gq gs pl pm"><a href="https://myrickchow.medium.com/ios-proximity-sensor-as-simple-as-possible-a473df883dc9" rel="noopener follow" target="_blank"><div class="pn ab fp"><div class="po ab pp cl cj pq"><h2 class="bd iv gz z fq pr fs ft ps fv fx it bi translated">iOS接近传感器尽可能简单</h2><div class="pt l"><h3 class="bd b gz z fq pr fs ft ps fv fx dk translated">接近传感器是一个小部件，可以检测大约10厘米的短距离。我们如何观察信号…</h3></div><div class="pu l"><p class="bd b dl z fq pr fs ft ps fv fx dk translated">myrickchow.medium.com</p></div></div><div class="pv l"><div class="pw l px py pz pv qa kt pm"/></div></div></a></div></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="1bb9" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">摘要</h1><ol class=""><li id="c6f6" class="ov ow iu kx b ky oq lb or le qb li qc lm qd lq pa pb pc pd bi translated">接近传感器用于检测大约5厘米的短距离。一些设备甚至可以探测到8厘米远的距离。</li><li id="651f" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated">我们可以使用<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager" rel="noopener ugc nofollow" target="_blank">SensorManager</a></code>访问接近传感器，并在<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorEventListener" rel="noopener ugc nofollow" target="_blank">SensorEventListener</a></code>的<code class="fe ma mb mc md b"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorEventListener#onSensorChanged(android.hardware.SensorEvent)" rel="noopener ugc nofollow" target="_blank">onSensorChanged</a></code>回调处检索检测到的距离。</li><li id="278a" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated">不同接近传感器在不同情况下具有不同的精度。一个好的开发人员应该过滤掉那些准确性不可接受的数据。</li></ol></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="772d" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">你可能会感兴趣</h1><div class="pj pk gq gs pl pm"><a rel="noopener  ugc nofollow" target="_blank" href="/android-step-counter-sensor-all-in-one-77564e5b6c2a"><div class="pn ab fp"><div class="po ab pp cl cj pq"><h2 class="bd iv gz z fq pr fs ft ps fv fx it bi translated">Android计步传感器一体化</h2><div class="pt l"><h3 class="bd b gz z fq pr fs ft ps fv fx dk translated">计步传感器在健身应用中用于监控用户的运动。如何实现到安卓App？怎么…</h3></div><div class="pu l"><p class="bd b dl z fq pr fs ft ps fv fx dk translated">itnext.io</p></div></div><div class="pv l"><div class="qe l px py pz pv qa kt pm"/></div></div></a></div></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="d592" class="na nb iu bd nc nd ne nf ng nh ni nj nk ka nl kb nm kd nn ke no kg np kh nq nr bi translated">参考</h1><ol class=""><li id="acf2" class="ov ow iu kx b ky oq lb or le qb li qc lm qd lq pa pb pc pd bi translated"><a class="ae me" href="https://developer.android.com/guide/topics/sensors/sensors_position" rel="noopener ugc nofollow" target="_blank">位置传感器官方文件</a></li><li id="b460" class="ov ow iu kx b ky pe lb pf le pg li ph lm pi lq pa pb pc pd bi translated"><a class="ae me" href="https://developer.android.com/reference/android/hardware/SensorManager" rel="noopener ugc nofollow" target="_blank"> SensorManager官方文档</a></li></ol></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj qf"><img src="../Images/9f93e55181c407f6c0b5d8b81f87b736.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*gTVKa-WBAQtyzzid.png"/></div></figure><p id="f401" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">欢迎您关注我，在<a class="ae me" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ my rik _ chow</a>获取更多信息和文章。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
# AKS 故障排除:诊断和解决问题刀片

> 原文：<https://itnext.io/troubleshooting-diagnose-and-solve-problems-blade-2ef98d501fd7?source=collection_archive---------7----------------------->

> 利用门户中的诊断和解决问题工具来帮助解决 AKS 集群的常见问题

![](img/94f6ce20fe74e51ba9b4f00184601a15.png)

如果代码能帮你发现问题，为什么不让它发现呢？

# 诊断和解决 AKS 刀片的问题

> 一个基于门户的工具，可用于诊断和排除常见的、有时难以理解的问题，帮助您节省时间

库伯内特是一种相当大的野兽。即使使用托管解决方案，如 AKS，仍有可能出错，您可能需要排除故障。微软已经投入了大量的时间来编写有助于检测问题的代码，这样您就不必这么做了。

面向 AKS 的诊断和解决方案刀片是一个不断发展的工具包，微软正在开发该工具包以降低复杂性、提高可见性并为其消费者提供对其集群的成功至关重要的信息。该工具将允许您对集群运行大量的运行状况检查，这可能会影响其上托管的应用程序的可靠性和性能。

它不仅会告诉您是否存在它可以识别的问题，还会就您可以采取的措施给出建议。在许多情况下，甚至有关于问题如何产生的更深入的描述和数据来帮助人们确切地理解正在发生什么以及如何处理它。

# 先检查简单的东西

> 除非必要，否则不要下兔子洞

根据经验，我可以告诉您，AKS 提供的诊断和解决问题的产品相当广泛，可以用来跟踪模糊的问题，否则这些问题可能会非常耗时或难以运行(例如关于基于节点和磁盘 IO 的节流的信息)。

![](img/86ce4987c758046fefb8d37853fcf88d.png)

要使用该产品，您只需登录门户网站，转到您的 AKS 集群并选择左侧的`Diagnose and solve problems`选项。

这里的视觉效果可能会随着时间的推移而改变，因为微软会不断地添加、改进和重组它们。写这篇文章的时候，你看到这一页给了你三个选择；搜索、集群洞察或网络

![](img/02fb1bcd4b66198d38aab25823d7d4c3.png)

现在的三大巨头，搜索，集群洞察，网络

# 使用搜索

> 你有什么特别想看的吗？尝试使用搜索

![](img/58a08b425206cabad96da8ee9b11a4cc.png)

这里一切都好！

搜索选项让您可以查找特定的内容，例如`certificates`，它可以让我看到我的集群证书已经过期以及何时到期。或者具体来说，如果您怀疑某种形式的节流，您可以调出磁盘 IO 节流信息，等等。

如果你想知道你可以搜索什么，只需点击搜索框，它会显示微软编写的所有不同的检测器，你可以加载到。其中许多对您来说可能是绿色的，除非您有特定的问题。

![](img/afa7048c593d9babc212771c85fe93b4.png)

所有问题检测器的完整列表

# 使用集群洞察力

> 节省时间，一次运行所有内容

如果你不是那种只想猜测和手动点击的人，不要担心。您可以选择 Cluster Insights，它将同时运行**所有**问题检测器，并在发现它设计检测的特定问题时向您发出警报。

![](img/c5af382662b25f5df9b6b29435f45bf5.png)

一次运行所有检查！

这可能是一种有用的方法(我就是这样做的),可以发现 Microsoft 创建的任何问题检测器是否会触发并警告您可能影响集群稳定性和可用性的潜在问题。正如我前面所说，这些检查通常会影响集群上托管的应用程序的可靠性和性能，因此请务必阅读警告和错误，以确保它们不会给您带来困扰。

# 使用网络

> 这是更紧密的组织，并提供了点击通过的经验

我之前提到过，微软正在不断改进这些产品，您可以通过网络选项清楚地看到这一点。您会注意到体验有所不同，更加友好和有指导，但最终提供的信息与 Cluster Insights 相同。

![](img/6939fe233c336d78f8cf467c0ecd118b.png)

虽然看起来有所不同，但此处返回的数据与这些选项的 cluster insights 相同

# 切片时间

> 请务必正确设置您的时间，以避免误报或解决过去的问题

![](img/2537afcdb02aea671648f971b580a32a.png)

如果需要的话，用这些时间切片器把它分成更小的范围

无论您在哪个问题检测器中，总有一个相关的时间范围，检测器使用该时间范围来查找问题。默认情况下，会检查过去 24 小时，这可能意味着您可能会收到当前未影响您的群集的问题的警报。

让我们举一个磁盘 IO 限制的例子——假设我在一个节点上一次性部署了一组 pod，并且仅在 pod 部署期间使操作系统磁盘的负载超过了安全限制。这可能会导致一个漂亮的红色大你已经被节流的消息，但当我挖进去，我可以发现节流的时间范围是在过去 24 小时内，可能不是一个问题了。

记住这一点，如果你正在寻找更近的问题，一定要正确使用时间切片器。最大回顾时间为 24 小时，最小回顾时间为 15 分钟。

# 最后的想法

这是一种非常快速有效的方法，可以帮助您找到 Microsoft 能够检测到的问题。在许多情况下，这些探测器不仅会告诉你发生了什么，什么时候发生了什么，它们还会就你如何自己快速解决问题提供建议。

微软正在不断改进这些功能。尽管如此，来自像您这样的用户的反馈不仅有助于使当前的检测器更加有用，还可能让微软有一个新的基于用户的视角，并了解什么对您更有用。考虑到这一点，使用探测器反馈选项，让微软知道什么是好的，什么是坏的，什么是丑陋的，以及你的梦想是什么，这样就可以分享观点并做出改进！

![](img/d9008902fef731c87fcc2181c96dddea.png)

发送反馈！
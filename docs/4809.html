<html>
<head>
<title>Copy Files to/from Pods in Java using Fabric8 Kubernetes Client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fabric8 Kubernetes客户端在Java中复制文件</h1>
<blockquote>原文：<a href="https://itnext.io/copy-files-to-from-pods-in-java-using-fabric8-kubernetes-client-485e73335cb6?source=collection_archive---------0-----------------------#2020-09-24">https://itnext.io/copy-files-to-from-pods-in-java-using-fabric8-kubernetes-client-485e73335cb6?source=collection_archive---------0-----------------------#2020-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6f8fc6c970d4c4727c35fbb5b811bc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*-58gIpXpeckgKtH8jJPUfA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/fabric8io/kubernetes-client" rel="noopener ugc nofollow" target="_blank"> Fabric8 Kubernetes客户端</a></figcaption></figure><p id="1059" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">有时候，我们希望将一些文件复制到运行在Kubernetes中的应用程序窗格中，或者从应用程序窗格中将一些文件下载到本地系统中。你可以在网上看到各种关于<code class="fe kx ky kz la b">kubectl cp</code>的文章，但是这篇文章主要关注使用<a class="ae jy" href="https://github.com/fabric8io/kubernetes-client" rel="noopener ugc nofollow" target="_blank"> Fabric8 Kubernetes Client </a>用Java以编程方式完成所有这些工作</p><h1 id="be37" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">获取客户端:</strong></h1><p id="4158" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">你可以像往常一样在<a class="ae jy" href="https://search.maven.org/search?q=g:io.fabric8%20a:kubernetes-client" rel="noopener ugc nofollow" target="_blank"> maven central </a>上找到客户端。您可以将它作为依赖项添加到您的<a class="ae jy" href="https://maven.apache.org/" rel="noopener ugc nofollow" target="_blank"> maven </a>项目中:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">fabric 8 Kubernetes POM . XML中的客户端依赖项</figcaption></figure><p id="83d5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果你正在使用<a class="ae jy" href="https://gradle.org/" rel="noopener ugc nofollow" target="_blank"> gradle </a>，你可能想使用这个:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">Fabric8 Kubernetes通过gradle groovy DSL实现客户端依赖性</figcaption></figure><p id="83a7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">一旦添加为依赖项，您就可以开始使用客户端了。文件复制操作包括压缩/解压缩文件/目录。Fabric8 Kubernetes客户端包括commons-codec和commons-compress作为可选的依赖项。因此，您需要将它们添加到您的项目中，以便利用这些功能:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">向类路径添加公共编码和公共压缩的可选依赖项</figcaption></figure><h1 id="7360" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">将文件从Pod复制到本地(下载):</strong></h1><p id="d451" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">。让我们假设我有一个pod在Kubernetes中运行，如下所示:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">一个简单的<a class="ae jy" href="https://quarkus.io/" rel="noopener ugc nofollow" target="_blank"> Quarkus </a>应用程序舱正在运行</figcaption></figure><p id="1af4" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我想使用Kubernetes客户端以编程方式将这个文件<code class="fe kx ky kz la b">/deployments/quarkus-1.0.0-runner.jar</code>复制到我的本地机器上。我会这样做:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">从Pod下载文件到您的机器。参见代号<a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/DownloadFileFromPod.java" rel="noopener ugc nofollow" target="_blank">DownloadFileFromPod.java</a></figcaption></figure><h1 id="7484" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">将文件从本地复制到Pod(上传):</strong></h1><p id="e0ed" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">假设您在本地系统中有一个路径为<code class="fe kx ky kz la b">/home/rohaan/work/k8s-resource-yamls/jobExample.yml</code>的文件，您想将该文件复制到路径为<code class="fe kx ky kz la b">/tmp/jobExample.yml</code>的pod中。你可以这样做:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">上传文件到Pod。UploadFileToPod.java见<a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/UploadFileToPod.java" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><h1 id="3c98" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">通过InputStream从Pod读取文件(下载):</h1><p id="472d" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">让我们试着读取我们在前面的上传文件到pod的例子中复制的相同文件，但是使用java流。你可以这样做:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">使用InputStream从Pod读取文件。参见ReadFileAsStream.java的<a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/ReadFileAsStream.java" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><h1 id="f2bf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">将本地目录复制到Pod(上传):</strong></h1><p id="4361" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">我有一个包含这两个文本文件的小目录:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="4ce7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我想把这个文件夹<code class="fe kx ky kz la b">test-dir</code>复制到我的Pod中。我会这样做:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">上传一个目录到Kubernetes Pod。参见<a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/UploadDirectoryToPod.java" rel="noopener ugc nofollow" target="_blank">UploadDirectoryToPod.java</a></figcaption></figure><h1 id="f765" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">向/从多容器窗格复制时指定容器:</h1><p id="d37f" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">您还可以使用为您过滤容器的<code class="fe kx ky kz la b">inContainer(String containerName)</code> DSL方法来指定选择哪个容器。它适用于从pod上传和下载文件。以下是从Pod下载文件时选择容器的示例:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">从具有多个容器的Pod中复制文件。参见<a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/DownloadFileFromMultiContainerPod.java" rel="noopener ugc nofollow" target="_blank">DownloadFileFromMultiContainerPod.java</a></figcaption></figure><p id="db66" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我今天的博客到此结束。我希望它是有用的。非常感谢您抽出时间阅读。你可以在我的Github库中找到上面的gists共享代码:</p><div class="mk ml gp gr mm mn"><a href="https://github.com/rohanKanojia/kubernetes-client-demo" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">rohanKanojia/kubernetes-客户端-演示</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">该项目包含Fabric8 Kubernetes客户端不同用法的各种示例。我通常在我的…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">github.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb js mn"/></div></div></a></div><h1 id="1c0f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">加入我们:</h1><p id="2fbc" class="pw-post-body-paragraph jz ka iq kb b kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw ij bi translated">你喜欢Fabric8 Kubernetes的客户，并希望参与项目的开发。随意参与方法:</p><ul class=""><li id="b4c0" class="nc nd iq kb b kc kd kg kh kk ne ko nf ks ng kw nh ni nj nk bi translated">当某些东西不能按预期工作时，创建<a class="ae jy" href="https://github.com/fabric8io/kubernetes-client/issues" rel="noopener ugc nofollow" target="_blank"> Github问题</a></li><li id="3160" class="nc nd iq kb b kc nl kg nm kk nn ko no ks np kw nh ni nj nk bi translated">向我们发送<a class="ae jy" href="https://github.com/fabric8io/kubernetes-client/pulls" rel="noopener ugc nofollow" target="_blank">拉请求</a>以修复错误/添加增强功能</li><li id="5c5e" class="nc nd iq kb b kc nl kg nm kk nn ko no ks np kw nh ni nj nk bi translated">在我们的<a class="ae jy" href="https://gitter.im/fabric8io/kubernetes-client?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" rel="noopener ugc nofollow" target="_blank"> Gitter频道</a>上与我们聊天</li><li id="3b3f" class="nc nd iq kb b kc nl kg nm kk nn ko no ks np kw nh ni nj nk bi translated">在<a class="ae jy" href="https://twitter.com/fabric8io/" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我们</li></ul><p id="831e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">最初发表于<a class="ae jy" href="https://r0haan.wordpress.com/2020/09/25/copy-files-to-from-pods-in-java-using-fabric8-kubernetes-client/" rel="noopener ugc nofollow" target="_blank"> Wordpress </a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Drawing Charts in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中绘制图表</h1>
<blockquote>原文：<a href="https://itnext.io/drawing-charts-in-swiftui-a5a87ac8cf9?source=collection_archive---------2-----------------------#2021-04-08">https://itnext.io/drawing-charts-in-swiftui-a5a87ac8cf9?source=collection_archive---------2-----------------------#2021-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2d74" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何在SwiftUI应用程序中绘制图表的教程。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/332984d1b5be400dcf7288caec3ca99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7ZHSDGCe9ya6TjUAGpC8g.png"/></div></div></figure><p id="daf1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我不时需要在一些好看的图表中可视化数据。这篇文章将展示如何在SwiftUI应用程序中绘制图表。</p><p id="5df1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">由于时间和预算的限制，从零开始制作图表包不是一个选择，所以我不得不寻找现有的解决方案。</p><p id="7a2c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我投票支持swi ify-Charts，它提供了非常漂亮的图表和简单的集成。</p><h2 id="49fa" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">设置和项目配置</h2><p id="4be8" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">我们首先在XCode中创建一个项目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/260acdb738025603244140669370b206.png" data-original-src="https://miro.medium.com/v2/format:webp/1*9Qd9E79MdDa7Yl9s9tCAyQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/0bef8a74dcc0d6fb5ce3a61f3831878b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*zbzJKInuHakYT-k4nAOz6A.png"/></div></figure><p id="12e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">起点是标准的SwiftUI应用程序，它将被修改以显示图形。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/7ceafade3c81b3a3ce20cb12810190e9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xX2ssxJ_6ztl6TzjYNsYHQ.png"/></div></figure><p id="b89a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下一步中，将通过首先打开项目设置来添加包。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/c7226c80d7c489633acee9a8d3b5f104.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1o0xd7GbB9y59kFupydzfw.png"/></div></figure><p id="fc78" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按下“加号”按钮，可以添加一个新的包。这里，需要提供存储库的完整路径:<code class="fe mq mr ms mt b"><a class="ae lq" href="https://github.com/spacenation/swiftui-charts.git." rel="noopener ugc nofollow" target="_blank">https://github.com/spacenation/swiftui-charts.git</a></code> <a class="ae lq" href="https://github.com/spacenation/swiftui-charts.git." rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/9308d6615ed58e4014a82840b28d2788.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Q1HAzDxKH3kRE_4gdd6LiA.png"/></div></figure><p id="f5dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下一个屏幕中，我保留了所有的默认值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/af6afab8cdab538933522e2d08e9f6be.png" data-original-src="https://miro.medium.com/v2/format:webp/1*AUDpuEqIZoLu3g7iAIk4Eg.png"/></div></figure><p id="bc39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在最后一个屏幕中，我也保留了默认值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/61dd47bed279bd52dacda6fee8a0657f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*K9R6Oue9LTslLg0aB2gLYw.png"/></div></figure><h2 id="7edf" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">显示常量数据</h2><p id="f2a8" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">是时候添加代码了。对于第一个测试，我只是从Github-Readme中提取了一些代码片段，并将其添加到我的<code class="fe mq mr ms mt b">ContentView</code>:</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="7031" class="lr ls it mt b gy my mz l na nb">import Charts<br/>import SwiftUI<br/><br/>struct ContentView: View {<br/>    var body: some View {<br/>        Chart(data: [0.1, 0.3, 0.2, 0.5, 0.4, 0.9, 0.1])<br/>            .chartStyle(<br/>                LineChartStyle(.quadCurve, lineColor: .blue, lineWidth: 5)<br/>            )<br/>    }<br/>}</span></pre><p id="5792" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当在模拟器中运行时，将会绘制一个漂亮的图形来显示常量值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/373d92191f8227e91ec5eacd22d6d90a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-FMAcEpig14x2c2BRLLeLA.png"/></div></figure><p id="f40a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是第一次成功的测试。</p><h2 id="7b56" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">显示动态数据</h2><p id="d34b" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">在我工作的领域中，我必须将数据可视化，例如来自感官输入的数据。让我们扩展这个例子，根据数据的变化动态地更新图形。</p><p id="bdfd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">“传感器”应该是一类每500毫秒发布一个随机值的<code class="fe mq mr ms mt b">ObservableObject</code>。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="8a60" class="lr ls it mt b gy my mz l na nb">import Foundation<br/><br/>class ValuePublisher: ObservableObject {<br/>    @Published var value: Double = 0.0<br/>    <br/>    init() {<br/>        Timer.scheduledTimer(withTimeInterval: 0.5, repeats: true) { timer in<br/>            self.value = Double.random(in: 0...1.0)<br/>        }<br/>    }<br/>}</span></pre><p id="3fd1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这需要在<code class="fe mq mr ms mt b">ContentView</code>中被实例化为一个<code class="fe mq mr ms mt b">@State</code>变量。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="c74f" class="lr ls it mt b gy my mz l na nb">@StateObject var valuePublisher = ValuePublisher()</span></pre><p id="8e94" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mq mr ms mt b">ValuePublisher</code>只发出单个值，但是我们需要在一个列表中提供这些值。一个简单的队列结构就可以做到这一点。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="3eaa" class="lr ls it mt b gy my mz l na nb">struct Queue&lt;T&gt; {<br/>    var list = [T]()<br/>    <br/>    mutating func enqueue(_ element: T) {<br/>        list.append(element)<br/>    }<br/>    <br/>    mutating func dequeue() -&gt; T? {<br/>        if !list.isEmpty {<br/>            return list.removeFirst()<br/>        } else {<br/>            return nil<br/>        }<br/>    }<br/>    <br/>    func peek() -&gt; T? {<br/>        if !list.isEmpty {<br/>            return list[0]<br/>        } else {<br/>            return nil<br/>        }<br/>    }<br/>}</span></pre><p id="2879" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该队列将被实例化为<code class="fe mq mr ms mt b">ContentView</code>中的<code class="fe mq mr ms mt b">@State</code>变量</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="5318" class="lr ls it mt b gy my mz l na nb">@State var doubleQueue = Queue&lt;Double&gt;()</span></pre><p id="94ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当视图出现时，需要初始化底层列表。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="d21f" class="lr ls it mt b gy my mz l na nb">.onAppear {<br/>    doubleQueue.list = [Double](repeating: 0.0, count: 50)<br/>}</span></pre><p id="17b3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">图表还需要知道保存值的列表。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="9869" class="lr ls it mt b gy my mz l na nb">Chart(data: doubleQueue.list)</span></pre><p id="e1af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在最后一步中，必须将<code class="fe mq mr ms mt b">ValuePublisher</code>的发布值添加到队列中，并且必须移除队列中最早的值。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="9111" class="lr ls it mt b gy my mz l na nb">.onChange(of: valuePublisher.value) { value in<br/>    self.doubleQueue.enqueue(value)<br/>    _ = self.doubleQueue.dequeue()<br/>}</span></pre><p id="06cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">大概就是这样，这里是完整的<code class="fe mq mr ms mt b">ContentView</code>，我也稍微改变了一下图表的外观。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="2f3e" class="lr ls it mt b gy my mz l na nb">import Charts<br/>import SwiftUI<br/><br/>struct ContentView: View {<br/>    <br/>    @State var doubleQueue = Queue&lt;Double&gt;()<br/>    <br/>    @StateObject var valuePublisher = ValuePublisher()<br/>    <br/>    var body: some View {<br/>        Chart(data: doubleQueue.list)<br/>            .chartStyle(<br/>                AreaChartStyle(.quadCurve, fill:<br/>                    LinearGradient(gradient: .init(colors: [Color.blue.opacity(1.0), Color.blue.opacity(0.5)]), startPoint: .top, endPoint: .bottom)<br/>                )<br/>            )<br/>            .onAppear {<br/>                doubleQueue.list = [Double](repeating: 0.0, count: 50)<br/>            }<br/>            .onChange(of: valuePublisher.value) { value in<br/>                self.doubleQueue.enqueue(value)<br/>                _ = self.doubleQueue.dequeue()<br/>            }<br/>            .padding()<br/>    }<br/>}</span></pre><p id="b2f1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是最终应用程序的屏幕截图</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/332984d1b5be400dcf7288caec3ca99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7ZHSDGCe9ya6TjUAGpC8g.png"/></div></div></figure><p id="23e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我还上传了一个视频，让你看看当值动态更新时是什么样子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="e75a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你喜欢这篇文章，请给我买杯咖啡。</p><h2 id="fb74" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">资源</h2><ul class=""><li id="5dfc" class="ne nf it kw b kx mk la ml ld ng lh nh ll ni lp nj nk nl nm bi translated"><a class="ae lq" href="https://github.com/spacenation/swiftui-charts" rel="noopener ugc nofollow" target="_blank"> SwiftUI-Charts </a></li><li id="790e" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated"><a class="ae lq" href="https://medium.com/@JoyceMatos/data-structures-in-swift-queues-and-stacks-e7d715634f07" rel="noopener">Swift中的数据结构:队列和堆栈</a></li></ul></div></div>    
</body>
</html>
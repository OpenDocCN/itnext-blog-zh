<html>
<head>
<title>Undo Git Rebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">撤消Git Rebase</h1>
<blockquote>原文：<a href="https://itnext.io/undo-git-rebase-77aefc9e0f08?source=collection_archive---------3-----------------------#2022-12-12">https://itnext.io/undo-git-rebase-77aefc9e0f08?source=collection_archive---------3-----------------------#2022-12-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8f1f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Git Reflog简介</h2></div><p id="d20c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://medium.com/@aerabi/list/git-weekly-9fe103e35b4b" rel="noopener"> Git周刊</a> #26 <br/>等级:高级🥇</p><p id="66e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">撤销常规的git操作相当容易。我们总是可以使用<code class="fe lf lg lh li b">git log</code>查看git历史，并及时回到某一点。撤销上一次提交就是一个例子:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="fd8a" class="lr ls it li b be lt lu l lv lw">$ git log --oneline<br/>3f4176f (HEAD -&gt; my-branch, master) :gear: Add icon and update metadata (#3)<br/>30c4219 :wrench: Load the list of Git Weekly issues and render it (#2)<br/>4d5389c :pencil: Add README<br/>41d064b :gear: Initial commit</span></pre><p id="419c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了放弃散列值为<code class="fe lf lg lh li b">3f4176f</code>的最后一次提交，我们执行以下操作:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="0706" class="lr ls it li b be lt lu l lv lw">$ git reset --hard HEAD~1</span></pre><p id="6005" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们在日志中所示，<code class="fe lf lg lh li b">HEAD</code>指的是最后一次提交。所以，<code class="fe lf lg lh li b">HEAD~1</code>后面是一个commit。</p><p id="f82e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这只有在我们想要撤销的git命令不改变历史的情况下才有效。改变历史的命令的一个很好的例子是我们刚刚使用的<code class="fe lf lg lh li b">git reset --hard</code>命令。另一个当然是rebase。</p><figure class="lj lk ll lm gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lx"><img src="../Images/2b51a639b3a4487484bb26267a34d36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJNE-4v97UBZykRntYdrRg.png"/></div></div></figure><h1 id="9808" class="mf ls it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">Git引用日志简介</h1><p id="612a" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">Git reflog是一个强大的Git版本控制系统工具，它允许用户将丢失或被覆盖的更改恢复到他们的存储库中。与git中的永久历史记录(只跟踪提交的更改)不同，reflog记录了对本地存储库的所有更改，即使它们没有提交。这意味着reflog可用于恢复由于意外重置或在推送到远程存储库期间被覆盖而丢失的更改。</p><p id="1aea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要查看git存储库的reflog，可以使用<code class="fe lf lg lh li b">git reflog</code>命令。这将显示存储库中发生的所有变更的列表，包括分支更新、重置和提交。reflog中的每个条目都包括提交的SHA-1散列、更新的引用以及描述更改的简短消息。</p><p id="6a62" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，假设您的存储库中有一个名为“my-branch”的分支，您意外地将其重置为早期提交。您可以使用reflog来查找被覆盖的提交的SHA-1哈希，然后使用该哈希来恢复丢失的更改。这看起来会像这样:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="35fe" class="lr ls it li b be lt lu l lv lw">$ git reflog<br/>30c4219 (HEAD -&gt; my-branch) HEAD@{0}: reset: moving to HEAD~1<br/>3f4176f (origin/master, master) HEAD@{1}: checkout: moving from master to my-branch<br/>3f4176f (origin/master, master) HEAD@{2}: pull: Fast-forward<br/>...</span></pre><p id="c7c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本例中，对存储库的最新更改是对<code class="fe lf lg lh li b">HEAD~1</code>的重置。reflog中的这个状态由<code class="fe lf lg lh li b">HEAD@{0}</code>注释。先前的状态被标注为<code class="fe lf lg lh li b">HEAD@{1}</code>，这就是我们想要返回的状态。类似于撤销最后一次提交，我们使用git reset:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="39f0" class="lr ls it li b be lt lu l lv lw">$ git reset --hard HEAD@{1}</span></pre><p id="3570" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们做另一个git日志来看看结果:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="3ecb" class="lr ls it li b be lt lu l lv lw">$ git log --oneline<br/>3f4176f (HEAD -&gt; my-branch, master) :gear: Add icon and update metadata (#3)<br/>30c4219 :wrench: Load the list of Git Weekly issues and render it (#2)<br/>4d5389c :pencil: Add README<br/>41d064b :gear: Initial commit</span></pre><h1 id="4d74" class="mf ls it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">撤消重置基础</h1><p id="d034" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">现在，让我们做一个交互式的重新排序，将第二个提交放到最后一个提交:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="4b6d" class="lr ls it li b be lt lu l lv lw">$ git rebase -i HEAD~3</span></pre><p id="3f46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在待办事项列表中:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="3b68" class="lr ls it li b be lt lu l lv lw">pick 4d5389c :pencil: Add README<br/>drop 30c4219 :wrench: Load the list of Git Weekly issues and render it (#2)<br/>pick 69ef8bf :gear: Add icon and update metadata (#3)</span></pre><p id="f69a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">保存并退出。现在日志看起来像这样:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="9791" class="lr ls it li b be lt lu l lv lw">$ git log --oneline<br/>fad1087 (HEAD -&gt; my-branch) :gear: Add icon and update metadata (#3)<br/>4d5389c :pencil: Add README<br/>41d064b :gear: Initial commit</span></pre><p id="8997" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">reflog看起来像这样:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="fdbf" class="lr ls it li b be lt lu l lv lw">$ git reflog<br/>8e19365 (HEAD -&gt; my-branch) HEAD@{0}: rebase (finish): returning to refs/heads/my-branch<br/>8e19365 (HEAD -&gt; my-branch) HEAD@{1}: rebase (pick): :gear: Add icon and update metadata (#3)<br/>4d5389c HEAD@{2}: rebase (start): checkout HEAD~3<br/>3f4176f (origin/master, my-branch-bak, master) HEAD@{3}: reset: moving to HEAD@{1}<br/>30c4219 HEAD@{4}: reset: moving to HEAD~1<br/>...</span></pre><p id="1473" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在reflog中，这种交互式的重建基础分为三步:开始、拾取和完成。我们想回到<code class="fe lf lg lh li b">HEAD@{3}</code>，那里还没有开始重定基数:</p><pre class="lj lk ll lm gt ln li lo bn lp lq bi"><span id="d083" class="lr ls it li b be lt lu l lv lw">$ git reset --hard HEAD@{3}</span></pre><p id="46a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，非交互式重定基础可能需要更少的时间(例如2个步骤)。撤销重置基础时，总是先查看参考日志。</p><h1 id="4f60" class="mf ls it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">最后的话</h1><p id="5e74" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">我每周都会在git上写一篇博文。</p><ul class=""><li id="a973" class="nb nc it kk b kl km ko kp kr nd kv ne kz nf ld ng nh ni nj bi translated"><a class="ae le" href="https://medium.com/subscribe/@aerabi" rel="noopener">订阅</a>my Medium publishes，以便在新的Git周刊发布时获得通知。</li><li id="1bfa" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">在Twitter 上关注<a class="ae le" href="https://twitter.com/MohammadAliEN" rel="noopener ugc nofollow" target="_blank">我，了解其他平台上发布的更多更新和文章。</a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Converting a traditional web app into a PWA using OutSystems and JavaScript!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用OutSystems和JavaScript将传统的web应用程序转换成PWA！</h1>
<blockquote>原文：<a href="https://itnext.io/converting-a-traditional-web-app-into-a-pwa-using-outsystems-and-javascript-f757b9dc3a06?source=collection_archive---------0-----------------------#2019-12-02">https://itnext.io/converting-a-traditional-web-app-into-a-pwa-using-outsystems-and-javascript-f757b9dc3a06?source=collection_archive---------0-----------------------#2019-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1ed5313e127df84ceab16adb433497d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EH8p2rdE6LgGIVbpIGNsA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">演示:<a class="ae kc" href="https://simoessalvador.outsystemscloud.com/PWA/Home.aspx?_ts=637069171908097702" rel="noopener ugc nofollow" target="_blank">https://simoessalvador.outsystemscloud.com/PWA/Home.aspx</a></figcaption></figure><p id="3d68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">渐进式网络应用程序(PWAs)如今不仅仅是一个时髦的词，它们是一种结合了网络和应用程序精华的令人敬畏的体验。服务工作者等现代Web APIs和应用外壳架构的组合，为Web应用提供本地应用体验。</p><p id="16d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本教程中，我们将通过结合两种不同的技术OutSystems(世界领先的低代码)和JavaScript来构建一个PWA。为了将本教程放在上下文中，我们将从一个关于技术概念的简短解释开始。</p><h1 id="d17f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">低代码和外部系统</strong></h1><p id="d5b7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">简单地说，低级代码就是将现有代码的可视块拖放到工作流中以创建应用程序的过程。这项技术旨在为商业用户和专业开发人员服务。</p><p id="eab5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于商业用户或“公民开发人员”来说，OutSystems能够在IT专业人员有经验的指导下创建有用的设计应用程序。</p><p id="83b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于熟练的开发人员来说，它可以加快工作速度和更好的治理，从而使那些专业人员更加高效并专注于解决业务需求。</p><h1 id="2a7a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak"> PWA </strong></h1><p id="7e6b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">它们可以被描述为离线优先的移动应用或网页的移动优化版本，类似于常规应用，但排除了必须从应用商店下载的不便。渐进式的含义来自于这样一个概念，即这些应用消除了web和移动中相同应用的体验之间的摩擦。</p><h1 id="50df" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">我们是怎么做到的？</h1><p id="78ea" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">所以我们从在OutSystems中创建一个非常简单的传统web应用程序开始，只有一个模块和一个屏幕，上面有一些显示文本的卡片……这里没什么特别的。</p><p id="9939" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，我们创建了一个manifest文件(文件的格式/语言是JSON，扩展名可以是。json或者。manifest ),它包含诸如名称、显示类型、语言、开始URL、图标等信息。正如您在下面看到的，这个文件中有两个图标。这些图标需要作为资源添加到您的OutSystems应用程序中，并部署到目标目录中，以便可以从这个文件中引用它们。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ab89" class="mn lc iq mj b gy mo mp l mq mr">{<br/>  "dir": "ltr",<br/>  "lang": "en",<br/>  "name": "OutSystems PWA is cool!",<br/>  "scope": "/PWA",<br/>  "display": "standalone",<br/>  "start_url": "https://simoessalvador.outsystemscloud.com/PWA/Home.aspx",<br/>  "short_name": "OutSystems PWA",<br/>  "theme_color": "#039dfc",<br/>  "description": "How to convert a traditional web app into a progressive web app using OutSystems and open source",<br/>  "orientation": "any",<br/>  "background_color": "transparent",<br/>  "icons": [<br/>    {<br/>      "src": "/PWA/manifest-icon-192.png",<br/>      "sizes": "192x192",<br/>      "type": "image/png"<br/>    },<br/>    {<br/>      "src": "/PWA/manifest-icon-512.png",<br/>      "sizes": "512x512",<br/>      "type": "image/png"<br/>    }<br/>  ],<br/>  "generated": "true"<br/>}</span></pre><p id="7ad1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">manifest文件主要负责使应用程序独立，这意味着它定义了当它被添加到主屏幕时将如何启动。</p><p id="d1f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是生成启动图像和应用程序图标，并将其作为资源添加到OutSystems应用程序中。当您的应用程序打开时，将使用这些图像来增加与用户的互动。我们使用了一个生成器来自动创建这些图像；你可以在这里找到关于这个生成器的更多信息，这个生成器由nder Ceylan构建:<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/pwa-splash-screen-and-icon-generator-a74ebb8a130">https://it next . io/pwa-splash-screen-and-icon-generator-a 74 ebb 8 a 130</a></p><p id="e56f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，我们已经有了一个OutSystems传统web应用程序，它有一个屏幕、几个闪屏图像、一些图标和一个包含配置的清单文件。</p><p id="fa26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦这些都准备好了，我们就可以将这些信息注入到HTML页面头中。我们发现最快捷的方法是在准备屏幕时使用名为“AddPostProcessingFilter”的OutSystems操作，并搜索标记“”并用以下内容替换它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="22aa" class="mn lc iq mj b gy mo mp l mq mr">"&lt;/title&gt;<br/>&lt;link rel='manifest' href='/PWA/Manifest.manifest'&gt;<br/><br/>&lt;link rel='apple-touch-icon' sizes='180x180' href='/PWA/apple-icon-180.png'&gt;<br/>&lt;link rel='apple-touch-icon' sizes='167x167' href='/PWA/apple-icon-167.png'&gt;<br/>&lt;link rel='apple-touch-icon' sizes='152x152' href='/PWA/apple-icon-152.png'&gt;<br/>&lt;link rel='apple-touch-icon' sizes='120x120' href='/PWA/apple-icon-120.png'&gt;<br/><br/>&lt;meta name='apple-mobile-web-app-capable' content='yes'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2048-2732.png'<br/>    media='(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2732-2048.png'<br/>    media='(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1668-2388.png'<br/>    media='(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2388-1668.png'<br/>    media='(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1668-2224.png'<br/>    media='(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2224-1668.png'<br/>    media='(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1536-2048.png'<br/>    media='(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2048-1536.png'<br/>    media='(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1242-2688.png'<br/>    media='(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2688-1242.png'<br/>    media='(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1125-2436.png'<br/>    media='(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2436-1125.png'<br/>    media='(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-828-1792.png'<br/>    media='(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1792-828.png'<br/>    media='(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1242-2208.png'<br/>    media='(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-2208-1242.png'<br/>    media='(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-750-1334.png'<br/>    media='(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1334-750.png'<br/>    media='(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-640-1136.png'<br/>    media='(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)'&gt;<br/>&lt;link rel='apple-touch-startup-image'<br/>    href='/PWA/apple-splash-1136-640.png'<br/>    media='(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)'&gt;"</span></pre><p id="e0d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过这一步，我们完成了PWA的独立功能。</p><h1 id="8f82" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">但是PWA不仅仅是你的网络应用程序的快捷方式</h1><p id="a466" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">出于同样的原因，我们决定实现一个服务工作者来缓存信息，并使我们的应用程序加载更快。我们决定实现缓存，但我们也可以实现服务人员可用的任何其他Web API，目的是实现一个作为示例。</p><p id="1515" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们访问了<a class="ae kc" href="https://developers.google.com/web/tools/workbox/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/tools/workbox/</a>，并决定实施缓存优先战略。我们为服务工作者实现创建了一个新的js文件，其内容如下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f8c1" class="mn lc iq mj b gy mo mp l mq mr">importScripts('https://storage.googleapis.com/workbox-cdn/releases/4.1.0/workbox-sw.js');<br/><br/>if (workbox) {<br/>  console.log(`Yay! Workbox is loaded`);<br/><br/>  const shellHandler = new workbox.strategies.CacheFirst({<br/>    cacheName: 'shell',<br/>    plugins: [<br/>      new workbox.cacheableResponse.Plugin({<br/>        statuses: [0, 200]<br/>      }),<br/>      new workbox.expiration.Plugin({<br/>        maxEntries: 60,<br/>        maxAgeSeconds: 7 * 24 * 60 * 60, // 7 Days<br/>      }),<br/>    ]<br/>  });<br/><br/>  const imageHandler = new workbox.strategies.CacheFirst({<br/>    cacheName: 'images',<br/>    plugins: [<br/>      new workbox.expiration.Plugin({<br/>        maxEntries: 60,<br/>        maxAgeSeconds: 30 * 24 * 60 * 60, // 30 Days<br/>      }),<br/>    ],<br/>  });  <br/><br/>  const fontHandler = new workbox.strategies.CacheFirst({<br/>    cacheName: 'font',<br/>    plugins: [<br/>      new workbox.expiration.Plugin({<br/>        maxEntries: 60,<br/>        maxAgeSeconds: 365 * 24 * 60 * 60, // 365 Days<br/>      }),<br/>    ],<br/>  });<br/><br/>  const htmlHandler = new workbox.strategies.StaleWhileRevalidate({<br/>    cacheName: 'index',<br/>    plugins: [<br/>      new workbox.expiration.Plugin({<br/>        maxEntries: 60,<br/>        maxAgeSeconds: 10 * 60 * 60, // 10 Minutes<br/>      }),<br/>    ],<br/>  });<br/><br/>  // image responses<br/>  workbox.routing.registerRoute(<br/>    /\.(?:png|gif|jpg|jpeg|svg)$/,<br/>    imageHandler,<br/>  );<br/><br/>  // html responses<br/>  workbox.routing.registerRoute(<br/>    /.*(?:aspx|html|htm)$/,<br/>    htmlHandler,<br/>  );<br/><br/>   workbox.precaching.precacheAndRoute([<br/>    '/PWA/Theme.PWA.extra.css',<br/>    '/PWA/Theme.PWA.css',<br/>    '/EPA_Taskbox/Blocks/EPA_Taskbox/Inbox_Flow/Inbox.css',<br/>    '/OutSystemsUIWeb/Theme.BaseTheme.css',<br/>    { url: '/PWA/Home.aspx', revision: 'abcd1234' },<br/>  ], {<br/>    // Ignore all URL parameters.<br/>    ignoreURLParametersMatching: [/.*/]<br/>  });<br/><br/>  workbox.routing.registerRoute(<br/>    new RegExp('.*(Theme.FontAwesome.css|Icon.css)|.*.(woff|woff2|eot|ttf).*'),<br/>    fontHandler<br/>  );<br/><br/>} else {<br/>  console.log(`Boo! Workbox didn't load`);<br/>}</span></pre><p id="3d6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个脚本中有一个很小但非常重要的部分我们想强调一下；CSS文件必须包含在服务工作者缓存策略中，作为应用程序外壳缓存的一部分，如果没有这个神奇的步骤，应用程序将无法按照您的预期呈现。</p><p id="8cec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们的服务工作者文件准备好了，它就可以被上传，同样可以被包含在应用程序的资源中，并被部署到目标目录，就像我们对清单文件所做的那样。此服务工作者文件必须通过调用navigator . service worker . register注册到您的应用程序。这可以通过在页面的HTML head部分添加以下脚本块来完成:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d2ed" class="mn lc iq mj b gy mo mp l mq mr">&lt;script type='text/javascript'&gt; <br/>if ('serviceWorker' in navigator) {<br/>  window.addEventListener('load', function() {<br/>    navigator.serviceWorker.register('/PWA/sw.js');<br/>  });<br/>}<br/>&lt;/script&gt;</span></pre><p id="75e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">瞧啊！</p><p id="8747" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这段经历是由Ceylan 和Ruben Bonito 共同完成的！</p><p id="06f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">演示:<a class="ae kc" href="https://simoessalvador.outsystemscloud.com/PWA/Home.aspx?_ts=637069171908097702" rel="noopener ugc nofollow" target="_blank">https://simoessalvador.outsystemscloud.com/PWA/Home.aspx</a></p></div></div>    
</body>
</html>
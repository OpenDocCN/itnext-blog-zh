<html>
<head>
<title>Using i18n with Next.js &amp; React context API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将i18n与Next.js和React上下文API一起使用</h1>
<blockquote>原文：<a href="https://itnext.io/using-i18n-with-next-js-react-context-api-ab208659cee8?source=collection_archive---------0-----------------------#2019-11-05">https://itnext.io/using-i18n-with-next-js-react-context-api-ab208659cee8?source=collection_archive---------0-----------------------#2019-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="64e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个国际化的HTTP/2 React应用程序，速度快，搜索引擎友好</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/ef38885cf68a4748f367c544e089b8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Dzt2d-PTfD309UGNufW1g.png"/></div></div></figure><h1 id="9ab3" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为什么要国际化？</h1><p id="0dc5" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">作为一个非英语母语的人，我喜欢认为我很好地理解了英语，当我面对一个不是用我的母语写的网站或产品时，我不会感到困扰。如果它不是英语，也不是我的母语，那就是另一回事了！</p><p id="e831" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">截至2019年，有超过90种语言的使用人数超过1000万。</p><p id="066d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们面对现实吧，在你的网络应用程序上提供不同的语言支持可能是UX的最佳实践，而且无论你的转换指标是什么，也肯定会增加。这就是为什么你的网络应用不应该默认硬编码成你的母语。</p><h1 id="753f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为javascript输入i18next，为Next.js输入next-i18 next…</h1><p id="14ef" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">数字i18n代表国际化的单词T2。就是第一个和最后一个字母，18代表单词第一个<strong class="jp ir"> i </strong>和最后一个<strong class="jp ir">T7】n</strong>之间的字母数。</p><p id="52ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于这种国际化需求，为javascript构建了一个名为<strong class="jp ir"> i18next </strong>的框架。</p><blockquote class="mb mc md"><p id="d4a2" class="jn jo ma jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">I18next是一个用JavaScript编写的国际化框架<strong class="jp ir">。但远不止如此。</strong></p><p id="6e8d" class="jn jo ma jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">i18next不仅仅提供标准的i18n特性，比如(复数、上下文、插值、格式)。它为您提供了一个完整的解决方案，将您的产品从web本地化到移动和桌面。</p></blockquote><p id="4e20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些年来，社区围绕它创建了一个很好的生态系统，并且几乎为所有主要的前端框架建立了一个集成。</p><p id="9a08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> next-i18next </strong>除了名字容易混淆之外，就是整合了<strong class="jp ir"> <em class="ma"> i18next </em>为<strong class="jp ir"> <em class="ma"> Next.js </em> </strong>框架。我们将使用它来简单地为我们的Next.js应用程序提供国际化。</strong></p><h1 id="9f62" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">我们要建造什么</h1><p id="1b9d" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们的目标是构建一个小型应用程序，超越他们的Github repo上提供的next-i18next的基本使用示例。</p><p id="fd68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的应用将涵盖这些部分:</p><ul class=""><li id="c089" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated">使用Fastify而不是Express作为提供HTTP/2支持的更快/更小的服务器框架</li><li id="5b7e" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">提供用户语言的自动检测</li><li id="4440" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">通过React上下文API存储和使用用户语言首选项</li><li id="401a" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">在我们的组件代码中提供语言更改监听器，以更新特殊的text/lib(在本例中使用typed.js组件)</li></ul><p id="46e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它还将使用Next.js &gt;9.1.0，该版本优先于<em class="ma">公共</em>文件夹引入了<em class="ma">静态</em>文件夹的折旧。</p><h1 id="2e41" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">让我们深入研究一下实现</h1><p id="c6fb" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">下面是我们将要采取的步骤</p><ul class=""><li id="3e6f" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated">1.设置项目，并使用Fastify实现一个定制服务器</li><li id="ab76" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">2.创建前端应用程序(使用react-bootstrap)，并添加next-i18next集成</li><li id="a43b" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">3.使用React context API构建一个用户上下文，它存储语言首选项并在我们的组件方法中提供语言更新侦听器</li></ul><ol class=""><li id="890c" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mv mn mo mp bi translated"><strong class="jp ir">设置&amp;定制Fastify服务器<br/> </strong>像往常一样，首先初始化一个npm包:</li></ol><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="196e" class="nb ky iq mx b gy nc nd l ne nf">mkdir next-fastify-i18n-example<br/>cd next-fastify-i18n-example<br/>npm init<br/>npm install next @zeit/next-css eventemitter3 react react-dom react-bootstrap react-typed fastify fastify-nextjs fastify-static i18next next-i18next --save<br/>npm install cross-env rimraf --save-dev</span></pre><p id="3978" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您可以在项目的根目录下创建一个基本的next.config.js文件，主要用于设置CSS配置:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div><figcaption class="ni nj gj gh gi nk nl bd b be z dk translated">next.config.js</figcaption></figure><p id="b05e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> next-i18next </strong>提供了一个Express.js服务器中间件。但由于我们正在构建一个主要是静态的网站，我们将使用Fastify而不是Express。其中一个优势是它很容易切换，而且Fastify支持Express中间件API，所以所有适用于Express的中间件，也适用于Fastify。</p><blockquote class="mb mc md"><p id="02b2" class="jn jo ma jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">Fastify是一个高度专注于以最少的开销和强大的插件架构提供最佳开发者体验的web框架。它的灵感来自哈比神和Express，据我们所知，它是目前最快的web框架之一。</p></blockquote><p id="7f0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在项目的根目录下创建server.js文件。这将是我们国际化所需的定制服务器。该文件有三个主要部分:</p><ul class=""><li id="d32c" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir"> Fastify服务器设置</strong> <br/>我选择启用http/2支持，所以需要提供本地生成的证书。为此，我在package.json中添加了一个使用OpenSSL的npm脚本</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="57c4" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">next . js</strong>的设置以及与Fastify &amp; i18next <br/>的集成在这一点上，代码非常简单明了:</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="8acb" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">启动Fastify listening </strong> <br/>就这样，我们基本上有了正在运行的http/2服务器:</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="ab1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。带有next-i18n的前端应用程序</strong></p><ul class=""><li id="1327" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir"> Next-i18next setup <br/> </strong>在自定义服务器配置上，您可能已经发现了一个<em class="ma">要求</em>到一个<strong class="jp ir"> <em class="ma"> i18n </em> </strong>文件。该文件导出一个配置i18n的<strong class="jp ir"> NextI18Next </strong>对象。您可以在存储库的根目录下创建这个i18n.js文件，并对其进行如下配置:</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="c239" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">next-i18next支持一个有趣的特性:<strong class="jp ir">局部子路径。正如他们所描述的，用例子来解释是最简单的:</strong></p><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="7da3" class="nb ky iq mx b gy nc nd l ne nf">myapp.com        ---&gt; Homepage in default lang<br/>myapp.com/de     ---&gt; Homepage in German</span></pre><p id="7446" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它在默认情况下是不启用的，我认为它在某些情况下可能是有用的，但由于它需要next.js应用程序使用特殊链接来支持这一点，我们不打算在我们的应用程序中使用它。</p><ul class=""><li id="7ba3" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir"> Next.js前端设置<br/>T33】这里有两个步骤。</strong></li></ul><p id="04c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">&gt;创建一个使用next-i18 next<strong class="jp ir"><em class="ma">appwithflatement</em></strong>HOC的_app.js</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="eed6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">&gt;在所有页面和组件中使用第二个next-i18next的HOC: <strong class="jp ir"> <em class="ma"> withTranslation，</em> </strong>，并为页面指定翻译名称空间</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="e653" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">翻译内容</strong></li></ul><p id="2abf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后<strong class="jp ir"> next-i18next </strong>用JSON文件保存你的翻译，期待这种文件夹架构<em class="ma">(注意，我们用的是最新的next.js，不赞成静态文件夹)</em></p><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="0b11" class="nb ky iq mx b gy nc nd l ne nf">.<br/>└── public<br/>    └── locales<br/>        ├── en<br/>        |   └── common.json<br/>        └── fr<br/>            └── common.json</span></pre><ul class=""><li id="493f" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">组件和页面中的用法</strong></li></ul><p id="4566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">next-i18next HOC增加了一个<strong class="jp ir"> <em class="ma"> props.t </em> </strong>，就是你可以用来引用你的JSON文档结构的翻译函数:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="d1b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它将一个字符串作为第一个参数，首先是可从组件访问的翻译名称空间，然后是冒号和JSON中的对象路径。</p><p id="e1e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。使用React上下文API更改和访问语言首选项</strong></p><p id="c004" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更改语言将自动导致使用来自JSON文件的新数据进行重绘。这是通过调用以下命令来完成的:</p><p id="aea9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nm nn no mx b">i18n.changeLanguage("fr")</code></p><p id="34b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但在大多数情况下，你会想要更多。一种常见的方法是:</p><ul class=""><li id="88c7" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated">从浏览器设置中自动检测用户语言，</li><li id="6421" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">提供一个允许用户更改语言的图标(或下拉菜单)</li><li id="b475" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">存储您的用户语言设置(如果他更改了设置)</li><li id="4155" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">通知回调，当语言改变时需要手动更新库或特定内容的代码片段。</li></ul><p id="6c8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢<a class="ae np" href="https://reactjs.org/docs/context.html#dynamic-context" rel="noopener ugc nofollow" target="_blank"> React上下文API </a>，我们将能够在定制的用户上下文中轻松实现这一点。React上下文带有一个提供者和消费者类。在这种情况下，我们将创建我们的自定义上下文提供程序来处理语言设置操作</p><blockquote class="mb mc md"><p id="8040" class="jn jo ma jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">React Context提供了一种通过组件树传递数据的方式，而不必在每一层手动向下传递属性。</p></blockquote><ul class=""><li id="0f46" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">创建user-context.js文件</strong></li></ul><p id="1e3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在组件文件夹中创建一个<strong class="jp ir"><em class="ma">user-context . js</em></strong>文件。首先，我们创建我们的上下文:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2245" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上下文在创建时需要一个对象。然后，我们将创建一个自定义提供程序组件，并使用其状态来定义实际值:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="1de1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码片段中，我们还使用<strong class="jp ir"> eventemitter3，</strong>实例化了一个EventEmitter，它将用于在我们的语言发生变化时处理回调触发。</p><p id="fa0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们可以添加组件初始化方法，尝试从本地存储中获取以前的用户设置，如果没有检测到，则使用默认的浏览器语言:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2e86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们实现了在上下文中声明的组件方法，以切换语言并注册将侦听语言更改的回调:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="80b3" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">在我们的导航栏组件中使用我们的上下文</strong></li></ul><p id="a7b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们创建一个navbar组件，它将包含一个标志图标，用户可以单击该图标来切换语言。在类组件中使用上下文是这样完成的:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="32dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您只需要定义一个静态的<strong class="jp ir"> contextType，</strong>，然后从<strong class="jp ir"> this.context. </strong>中获取您的上下文，然后您将从我们的用户上下文提供程序中调用<strong class="jp ir"> toggleLang() </strong>方法，该方法将更改其状态，触发<strong class="jp ir"> i18n.changeLanguage() </strong>并用相应的语言文件重新呈现，最后用eventemitter传播给任何需要它的人。很酷，不是吗？</p><ul class=""><li id="8ceb" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><strong class="jp ir">注册一个关于语言变化的方法来更新代码中的内容</strong></li></ul><p id="1c3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们创建一个组件，它将使用<strong class="jp ir"> Typed.js </strong> lib，并且需要在语言改变时更新react-typed组件属性。我们将这个组件称为banner.js。</p><p id="4fb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，这个组件将使用我们的用户上下文，但是它将使用我们的register和unregister监听器方法，而不是使用<strong class="jp ir"> toggleLang()，</strong>。</p><p id="91c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们用本地状态设置<strong class="jp ir">类型的</strong>:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="f5b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们只需添加mount和unmount方法，将我们的<strong class="jp ir"> updateTyped() </strong>注册为用户上下文语言更改的监听器:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="03c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样，我们的类型化组件现在会在用户改变它时用相应的语言重新设置它自己。它还可以通过在组件卸载时取消注册回调来避免内存泄漏。</p><h1 id="2c18" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="f7cf" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">就这样，您现在已经有了构建完全国际化的网站或web应用程序的良好基础，它使用服务器端呈现，并且可以支持您需要的任何语言。</p><p id="bc4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步可能是将谷歌分析整合到你的网站上，以跟踪你的访问者的来源国，创建相应的翻译文件，并愉快地为他们提供一个母语网站。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nq"><img src="../Images/c0c123bd43bb0d617551e5736a8ec3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3hHhGogklZrcOLqyO42YPA.jpeg"/></div></div></figure><p id="5c6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整代码可在此处找到:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/typedef42/nextjs-fastify-i18n" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">typedef42/nextjs-fastify-i18n</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kv nu"/></div></div></a></div><p id="a3c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是如何启动和运行此回购的快速回顾:</p><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="e443" class="nb ky iq mx b gy nc nd l ne nf">git clone <a class="ae np" href="https://github.com/typedef42/nextjs-fastify-i18n.git" rel="noopener ugc nofollow" target="_blank">https://github.com/typedef42/nextjs-fastify-i18n.git</a><br/>cd nextjs-fastify-i18n<br/>npm install<br/>npm run generate-certs</span></pre><p id="2eec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后将其用于生产设置:</p><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="e27a" class="nb ky iq mx b gy nc nd l ne nf">npm run release<br/>npm run stage</span></pre><p id="5ee3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者在开发中:</p><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="f93b" class="nb ky iq mx b gy nc nd l ne nf">npm run dev</span></pre><p id="1952" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，在<code class="fe nm nn no mx b"><a class="ae np" href="https://localhost:5000/" rel="noopener ugc nofollow" target="_blank">https://localhost:5000/</a></code>启动您最喜欢的浏览器</p></div></div>    
</body>
</html>
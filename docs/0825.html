<html>
<head>
<title>Easy way to deploy a Angular 5 application to Azure Web App using VSTS pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用VSTS管道将Angular 5应用程序部署到Azure Web App的简单方法</h1>
<blockquote>原文：<a href="https://itnext.io/easy-way-to-deploy-a-angular-5-application-to-azure-web-app-using-vsts-pipelines-4a288b9deae1?source=collection_archive---------1-----------------------#2018-06-05">https://itnext.io/easy-way-to-deploy-a-angular-5-application-to-azure-web-app-using-vsts-pipelines-4a288b9deae1?source=collection_archive---------1-----------------------#2018-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3a6551a07d0f4bd63c97b9da6bae82df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVY4ao0SoUm2yMRIAnuwWw.png"/></div></div></figure></div><div class="ab cl jy jz hu ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ij ik il im in"><p id="0d9e" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">最近，我不得不将一个简单的Angular 5应用程序部署到Azure环境中，所以我决定使用VSTS部署管道来加速这个过程，但我错了。互联网上有如此多的错误信息，以至于我花了将近两天的时间才完成了这个版本的创建。</p><p id="5e60" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">所以我决定写这篇文章来帮助像我这样的人，他们想要一种快速简单的方法来将Angular应用程序部署到Azure，而没有痛苦。</p><h1 id="a093" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">以下是步骤:</h1><h2 id="1cb5" class="mb le iq bd lf mc md dn lj me mf dp ln kq mg mh lr ku mi mj lv ky mk ml lz mm bi translated">web.config文件</h2><p id="2f98" class="pw-post-body-paragraph kf kg iq kh b ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky mr la lb lc ij bi translated">这是解决方案中最重要的部分。你必须告诉Azure你正在使用一个节点应用，你需要启动它。我尝试了很多我在网上找到的解决方法，但是解决我的问题的是这个。以下是完整的web.config文件:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="0bb8" class="mb le iq mx b gy nb nc l nd ne">&lt;configuration&gt;<br/>    &lt;system.webServer&gt;<br/>      &lt;rewrite&gt;<br/>        &lt;rules&gt;<br/>          &lt;rule name="Angular" stopProcessing="true"&gt;<br/>            &lt;match url=".*" /&gt;<br/>            &lt;conditions logicalGrouping="MatchAll"&gt;<br/>              &lt;add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" /&gt;<br/>              &lt;add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" /&gt;<br/>            &lt;/conditions&gt;<br/>            &lt;action type="Rewrite" url="/" /&gt;<br/>          &lt;/rule&gt;<br/>        &lt;/rules&gt;<br/>      &lt;/rewrite&gt;<br/>    &lt;/system.webServer&gt;<br/>&lt;/configuration&gt;</span></pre><p id="0394" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">你必须把这个文件放在<em class="nf"> /src/ </em>文件夹中，并在<em class="nf">资产</em>区域的<em class="nf"> angular.json </em>文件中引用它，就像这样:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/f166619acb25915e91c77112978f36e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*XEOk-kIfboFG4pw4Z6OoJw.png"/></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">请参考Angular.json文件上的web.config文件</figcaption></figure><h2 id="5c8d" class="mb le iq bd lf mc md dn lj me mf dp ln kq mg mh lr ku mi mj lv ky mk ml lz mm bi translated">VSTS大厦</h2><p id="43d1" class="pw-post-body-paragraph kf kg iq kh b ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky mr la lb lc ij bi translated">现在是时候创建您的构建并配置正确的步骤了。</p><p id="f301" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">创建新的构建，选择相关的源和项目以及该构建将处理的分支。</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/b86ed51f267e461fee1c6cc1c6a5e3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCieblkMbrd1HmNMxkuDAg.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">创建VSTS版本</figcaption></figure><p id="ec81" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">由于我们没有azure上的Angular应用程序模板，请在下一个屏幕中单击“<strong class="kh ir">清空管道</strong>”。您将看到这个屏幕:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/866d08329d99c19c9b6ee2fe8997bf77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i51Zdo2EqrgYjISjOS13kQ.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">空管道模板</figcaption></figure><p id="2050" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">单击第1阶段代理的“<strong class="kh ir"> + </strong>”，并在“添加任务”屏幕的搜索框中键入“<em class="nf"> npm </em>”。选择npm任务，点击<em class="nf">添加</em></p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/e4a733ea863d9b4e1307082b78cfb4f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPO9ZN5WecQlaCEn3OGn5A.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">将npm任务添加到阶段1</figcaption></figure><p id="fd56" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在，选择您在左侧面板中添加的npm任务，并像这样配置它:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/bd4b37257049f8335212b54de8215eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XNpYpnXLEm4AHoR6cM4rEw.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">配置npm以安装angular cli</figcaption></figure><p id="5551" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">不用担心<em class="nf">自定义注册表、控制选项和输出变量</em>。你不需要改变它。</p><p id="3f5a" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">回到左侧面板的阶段1，再次点击“<strong class="kh ir"> + </strong>”。添加另一个<em class="nf"> npm </em>任务，并像这样配置它:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/44cca690533d052ba014d79d9cb7b51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XK5m9xUoUmpffxeiOi9MuQ.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">配置npm以安装节点模块</figcaption></figure><p id="bd96" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">添加第三个<em class="nf"> npm </em>任务，并将其配置如下:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/cc6056d2cd62c193e0de831bcb41a465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AHxCSmo8zjokkzztcdRdgQ.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">配置npm以构建应用程序</figcaption></figure><p id="c335" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在，添加一个名为<em class="nf"> Publish Build Artifacts的任务，</em>这个任务将把你的构建上传到azure。像这样配置它:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/6e9bb47ad189d75053da99343f2503c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BiwSnj5ZLKD0HtuAlVaThw.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">配置工件发布</figcaption></figure><p id="e1c0" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在是时候将你的工件部署到azure了。添加一个名为<em class="nf"> Azure App Service Deploy </em>的任务，配置如下:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/a3f3f2275d5407c6793739d1c30a9197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YYiltOMPlVkpyNAPT_qRnw.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">正在配置Azure应用部署</figcaption></figure><p id="a726" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">选择合适的<em class="nf"> Azure订阅</em>和之前创建的<em class="nf">应用服务</em>来部署你的应用。仍在本节中，配置<em class="nf">附加部署选项</em>，并如下图所示进行设置:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/f482d226e7b4bac7984cd39940799ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DID7f4l3WRHKBYkB7OTIA.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">设置应用服务部署任务的其他部署选项</figcaption></figure><p id="2d7f" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">您的管道已经准备好进行测试，您可以点击<em class="nf"> Save &amp; queue </em>来保存您的更改并对构建进行排队。但是，如果您想要配置CI/CD并在您的分支上每次更新后构建您的管道，请转到<em class="nf">触发器</em>选项卡并选择<em class="nf">启用持续集成。</em></p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/e635165d42514e5c141bb28167db16ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0AgFVcB60RgKQgfOhEOHQ.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">配置持续集成</figcaption></figure><p id="7f30" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">您还可以计划构建并在构建完成后执行任务。</p><p id="fb59" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">这是一张没有警告就执行的完整构建的图片:</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/ba8ccb086b1e501d63387e4b667d3eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gKSKQZ6F1dvVhAnLdjtfpA.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">构建日志</figcaption></figure><p id="36fb" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">这是一个非常简单的管道，但是你可以添加单元测试，集成测试，一些其他的验证等等。这取决于你！</p><p id="071d" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">希望这能帮助和我有同样问题的人。</p><p id="f72a" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">再见！</p></div></div>    
</body>
</html>
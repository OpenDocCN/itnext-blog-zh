<html>
<head>
<title>NextJS + StorybookJS + Material-UI + Jest + SWR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">next js+storybook js+Material-UI+Jest+SWR</h1>
<blockquote>原文：<a href="https://itnext.io/nextjs-storybookjs-material-ui-jest-swr-fe2ff5cb9af8?source=collection_archive---------3-----------------------#2021-08-10">https://itnext.io/nextjs-storybookjs-material-ui-jest-swr-fe2ff5cb9af8?source=collection_archive---------3-----------------------#2021-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0b0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我最喜欢的新应用程序设置，我想你也会喜欢的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/afca586f6186b934132abced44edbb3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqD0B88-KfRdtrAYotR8Yw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">米格尔·Á拍摄的照片。帕德里纳来自<a class="ae le" href="https://www.pexels.com/photo/paper-boats-on-solid-surface-194094/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a></figcaption></figure><p id="aa12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像NextJS(<a class="ae le" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/</a>)这样的框架可以帮助你在几秒钟内启动一个React应用程序。您只需安装几个NPM软件包，创建一个文件，瞧，您就拥有了React应用程序，它具有卓越的功能支持，以及一个由解决方案、示例、文档和开发人员组成的庞大生态系统，随时可以帮助您构建您梦想中的SaaS应用程序或媒体网站。</p><p id="0ef3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我来说，这是理想的堆栈(截至2021年8月):</p><ul class=""><li id="ee1c" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">NextJS:(<a class="ae le" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/</a>)对所有现代React特性和工具无与伦比的支持。</li><li id="5ccc" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">TypeScript:(<a class="ae le" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">https://www.typescriptlang.org/</a>)及早发现一系列可能会困扰你的应用程序的错误。</li><li id="3969" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">material UI:(<a class="ae le" href="https://material-ui.com/" rel="noopener ugc nofollow" target="_blank">https://material-ui.com/</a>)这个UI套件有完整的类型脚本支持和一套非常完整的组件，还有一个很棒的主题API和通用的<code class="fe lt lu lv lw b">Box</code>和<code class="fe lt lu lv lw b">Grid</code>组件。</li><li id="926d" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">storybook js:(<a class="ae le" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank">https://storybook.js.org/</a>)在React应用中，没有更好更简单的方法来构建界面了。</li><li id="70f9" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">笑话:(<a class="ae le" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank">https://jestjs.io/</a>)测试？肯定的！否则你怎么知道你的代码是正确的。从小单元测试开始，然后进行更复杂的集成测试。</li><li id="68ef" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">SWR:(<a class="ae le" href="https://swr.vercel.app/" rel="noopener ugc nofollow" target="_blank">https://swr.vercel.app/</a>)我们喜欢这套用于获取数据的小钩子。有足够多的不可知论者，如果我们愿意，我们可以将它与REST或GraphQL一起使用。(我用<code class="fe lt lu lv lw b">axios</code>做HTTP客户端)</li></ul><h2 id="86e2" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">引导NextJS应用程序。</h2><p id="5520" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">让我们为我们的应用程序引导一个saas-app文件夹，并安装所有的NextJS依赖项，包括TypeScript。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="1d8a" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ mkdir saas-app<br/>$ cd saas-app<br/>$ yarn init -y</strong><br/>yarn init v1.22.11</span><span id="2274" class="lx ly it lw b gy nd na l nb nc">warning The yes flag has been set. This will automatically answer yes to all questions, which may have security implications.</span><span id="d647" class="lx ly it lw b gy nd na l nb nc">success Saved package.json</span><span id="5385" class="lx ly it lw b gy nd na l nb nc">✨  Done in 0.05s.</span><span id="4780" class="lx ly it lw b gy nd na l nb nc"><strong class="lw iu">$ yarn add next react react-dom</strong><br/>yarn add v1.22.11<br/>info No lockfile found.<br/>[1/4] 🔍  Resolving packages...<br/>warning next &gt; native-url &gt; querystring@0.2.1: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.<br/>warning next &gt; node-libs-browser &gt; url &gt; querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...</span><span id="645d" class="lx ly it lw b gy nd na l nb nc">success Saved lockfile.<br/>success Saved 197 new dependencies.<br/>info Direct dependencies<br/>├─ next@11.0.1<br/>├─ react-dom@17.0.2<br/>└─ react@17.0.2<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/babel/code-frame" rel="noopener ugc nofollow" target="_blank">@babel/code-frame</a>@7.12.11<br/>├─ <a class="ae le" href="http://twitter.com/babel/helper-validator-identifi" rel="noopener ugc nofollow" target="_blank">@babel/helper-validator-identifi</a>er@7.14.9<br/>...</span></pre><p id="8705" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一步是在<code class="fe lt lu lv lw b">package.json</code>文件上为<code class="fe lt lu lv lw b">dev</code>、<code class="fe lt lu lv lw b">build</code>、<code class="fe lt lu lv lw b">start</code>和<code class="fe lt lu lv lw b">lint</code>创建必要的脚本(最近在v11上支持)。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="ebc5" class="lx ly it lw b gy mz na l nb nc">{<br/>  "name": "saas-app",<br/>  "version": "1.0.0",<br/>  "main": "index.js",<br/>  "license": "MIT",<br/>  <strong class="lw iu">"scripts": {<br/>    "dev": "next",<br/>    "build": "next build",<br/>    "start": "next start",<br/>    "lint": "next lint"<br/>  },</strong><br/>  "dependencies": {<br/>    "next": "^11.0.1",<br/>    "react": "^17.0.2",<br/>    "react-dom": "^17.0.2"<br/>  }<br/>}</span></pre><p id="4b0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用TypeScript在<code class="fe lt lu lv lw b">src/pages/index.tsx</code>创建你的第一个页面(这将告诉NextJS我们想要使用它，所以它可以推荐必要的依赖项)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="e76e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行<code class="fe lt lu lv lw b">yarn dev</code></p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="d341" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn dev</strong><br/>yarn run v1.22.11<br/>$ next<br/>ready - started server on 0.0.0.0:3000, url: <a class="ae le" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a><br/>info  - Using webpack 5. Reason: Enabled by default <a class="ae le" href="https://nextjs.org/docs/messages/webpack5" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/docs/messages/webpack5</a><br/>It looks like you're trying to use TypeScript but do not have the required package(s) installed.</span><span id="c863" class="lx ly it lw b gy nd na l nb nc">Please install typescript and <a class="ae le" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a> by running:</span><span id="7fdd" class="lx ly it lw b gy nd na l nb nc">yarn add --dev typescript <a class="ae le" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a></span><span id="0e02" class="lx ly it lw b gy nd na l nb nc">If you are not trying to use TypeScript, please remove the tsconfig.json file from your package root (and any TypeScript files in your pages directory).</span><span id="b9ad" class="lx ly it lw b gy nd na l nb nc">error Command failed with exit code 1.<br/>info Visit <a class="ae le" href="https://yarnpkg.com/en/docs/cli/run" rel="noopener ugc nofollow" target="_blank">https://yarnpkg.com/en/docs/cli/run</a> for documentation about this command.</span></pre><p id="7b3b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如你所见，要求我们安装TypeScript依赖项，然后再次运行<code class="fe lt lu lv lw b">yarn dev</code>。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="4c9d" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn add --dev typescript </strong><a class="ae le" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">@types/react</strong></a><br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...<br/>success Saved lockfile.<br/>success Saved 5 new dependencies.<br/>info Direct dependencies<br/>├─ <a class="ae le" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a>@17.0.16<br/>└─ typescript@4.3.5<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/types/prop-types" rel="noopener ugc nofollow" target="_blank">@types/prop-types</a>@15.7.4<br/>├─ <a class="ae le" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a>@17.0.16<br/>├─ <a class="ae le" href="http://twitter.com/types/scheduler" rel="noopener ugc nofollow" target="_blank">@types/scheduler</a>@0.16.2<br/>├─ csstype@3.0.8<br/>└─ typescript@4.3.5<br/>✨  Done in 1.65s.</span><span id="e85f" class="lx ly it lw b gy nd na l nb nc"><strong class="lw iu">$ yarn dev</strong><br/>yarn run v1.22.11<br/>$ next<br/>ready - started server on 0.0.0.0:3000, url: <a class="ae le" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a><br/>info  - Using webpack 5. Reason: Enabled by default <a class="ae le" href="https://nextjs.org/docs/messages/webpack5" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/docs/messages/webpack5</a><br/>event - compiled successfully</span></pre><p id="6509" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">导航至<code class="fe lt lu lv lw b"><a class="ae le" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>您将看到…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/a7058f5af8e076c44caca95f009284fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7SROrnU6AeO9K4MSAw8Sw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">NextJS应用程序正在运行</figcaption></figure><p id="61f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置NextJS的最后一步是运行linter(包含在v11中):</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="0f1e" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn lint</strong><br/>yarn run v1.22.11<br/>$ next lint<br/>To use ESLint, additional required package(s) must be installed.</span><span id="8f43" class="lx ly it lw b gy nd na l nb nc">Please install eslint and eslint-config-next by running:</span><span id="851c" class="lx ly it lw b gy nd na l nb nc">yarn add --dev eslint eslint-config-next</span><span id="09ac" class="lx ly it lw b gy nd na l nb nc">Once installed, run next lint again.</span><span id="a70c" class="lx ly it lw b gy nd na l nb nc">error Command failed with exit code 1.<br/>info Visit <a class="ae le" href="https://yarnpkg.com/en/docs/cli/run" rel="noopener ugc nofollow" target="_blank">https://yarnpkg.com/en/docs/cli/run</a> for documentation about this command.</span></pre><p id="0d2f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">NextJS再次要求我们安装所需的依赖项:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="2d4c" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn add --dev eslint eslint-config-next</strong><br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...<br/>success Saved lockfile.<br/>success Saved 137 new dependencies.<br/>info Direct dependencies<br/>├─ eslint-config-next@11.0.1<br/>└─ eslint@7.32.0<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/babel/runtime-corejs3" rel="noopener ugc nofollow" target="_blank">@babel/runtime-corejs3</a>@7.14.9<br/>├─ <a class="ae le" href="http://twitter.com/babel/runtime" rel="noopener ugc nofollow" target="_blank">@babel/runtime</a>@7.14.8<br/>...</span></pre><p id="9811" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">安装后，我们可以:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="d49c" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn lint</strong><br/>yarn run v1.22.11<br/>$ next lint<br/>We created the .eslintrc file for you and included the base Next.js ESLint configuration.<br/>info  - Using webpack 5. Reason: Enabled by default <a class="ae le" href="https://nextjs.org/docs/messages/webpack5" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/docs/messages/webpack5</a><br/>✔ No ESLint warnings or errors<br/>✨  Done in 1.67s.</span></pre><p id="fa68" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">耶！没有错误或警告</p><p id="3371" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将在NextJS config上为TypeScript更改的最后一个设置是修改tsconfig.json文件上的baseUrl属性，以将所有代码的基本路径更改为从src文件夹开始，这样我们就可以避免导入相对路径，而总是使用从src文件夹开始的绝对路径。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="3e37" class="lx ly it lw b gy mz na l nb nc">{<br/>  "compilerOptions": {<br/>    "target": "es5",<br/>    "lib": [<br/>      "dom",<br/>      "dom.iterable",<br/>      "esnext"<br/>    ],<br/>    "allowJs": true,<br/>    "skipLibCheck": true,<br/>    "strict": false,<br/>    "forceConsistentCasingInFileNames": true,<br/>    "noEmit": true,<br/>    "esModuleInterop": true,<br/>    "module": "esnext",<br/>    "moduleResolution": "node",<br/>    "resolveJsonModule": true,<br/>    "isolatedModules": true,<br/>    "jsx": "preserve",<br/>    <strong class="lw iu">"baseUrl": "./src"</strong><br/>  },<br/>  "include": [<br/>    "next-env.d.ts",<br/>    "**/*.ts",<br/>    "**/*.tsx"<br/>  ],<br/>  "exclude": [<br/>    "node_modules"<br/>  ]<br/>}</span></pre><h2 id="86ba" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">使用MaterialUI创建组件</h2><p id="d752" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">安装MaterialUI核心模块和图标模块。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="d6a1" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn add </strong><a class="ae le" href="http://twitter.com/material" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">@material</strong></a><strong class="lw iu">-ui/core </strong><a class="ae le" href="http://twitter.com/material" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">@material</strong></a><strong class="lw iu">-ui/icons</strong><br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...</span><span id="a898" class="lx ly it lw b gy nd na l nb nc">success Saved lockfile.<br/>success Saved 19 new dependencies.<br/>info Direct dependencies<br/>├─ <a class="ae le" href="http://twitter.com/material" rel="noopener ugc nofollow" target="_blank">@material</a>-ui/core@4.12.3<br/>└─ <a class="ae le" href="http://twitter.com/material" rel="noopener ugc nofollow" target="_blank">@material</a>-ui/icons@4.11.2<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/emotion/hash" rel="noopener ugc nofollow" target="_blank">@emotion/hash</a>@0.8.0<br/>├─ <a class="ae le" href="http://twitter.com/material" rel="noopener ugc nofollow" target="_blank">@material</a>-ui/core@4.12.3<br/>...</span></pre><p id="0976" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了让MaterialUI在服务器端渲染(SSR)应用程序和基于客户端的应用程序上都能很好地工作，我们需要修改我们的NextJS应用程序上的两个文件:<code class="fe lt lu lv lw b">src/pages/_app.tsx</code>和<code class="fe lt lu lv lw b">src/pages/_document.tsx</code></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/pages/_app.tsx文件</figcaption></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/pages/_document.tsx文件</figcaption></figure><p id="98d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了这些文件，我们现在可以修改index.tsx页面以包含实际的MaterialUI组件:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">带有MaterialUI组件的src/pages/index.tsx文件</figcaption></figure><p id="9ba1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用yarn dev运行我们的应用程序将为我们带来:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/955027e316b83135849444dfcae62570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXHKFQAYE8eR-S7Vnn79Og.png"/></div></div></figure><h2 id="797b" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">在StorybookJS上创建组件</h2><p id="82e5" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">来自StorybookJS网站:</p><blockquote class="nh ni nj"><p id="3c5d" class="jq jr nk js b jt ju jv jw jx jy jz ka nl kc kd ke nm kg kh ki nn kk kl km kn im bi translated">Storybook是一个UI开发工具。它通过隔离组件使开发更快更容易。这允许您一次处理一个组件。您可以开发整个ui，而不需要启动复杂的开发堆栈、将某些数据强制输入数据库或在应用程序中导航。</p></blockquote><p id="6f75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要在您的项目中安装它，请执行以下操作:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="7172" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ npx sb init</strong></span><span id="5e37" class="lx ly it lw b gy nd na l nb nc">sb init - the simplest way to add a Storybook to your project.</span><span id="0e74" class="lx ly it lw b gy nd na l nb nc">• Detecting project type. ✓<br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...<br/>success Saved lockfile.<br/>success Saved 552 new dependencies.<br/>info Direct dependencies<br/>├─ <a class="ae le" href="http://twitter.com/babel/core" rel="noopener ugc nofollow" target="_blank">@babel/core</a>@7.15.0<br/>├─ <a class="ae le" href="http://twitter.com/storybook/addon-actions" rel="noopener ugc nofollow" target="_blank">@storybook/addon-actions</a>@6.3.7<br/>├─ <a class="ae le" href="http://twitter.com/storybook/addon-essentials" rel="noopener ugc nofollow" target="_blank">@storybook/addon-essentials</a>@6.3.7<br/>├─ <a class="ae le" href="http://twitter.com/storybook/addon-links" rel="noopener ugc nofollow" target="_blank">@storybook/addon-links</a>@6.3.7<br/>└─ <a class="ae le" href="http://twitter.com/storybook/react" rel="noopener ugc nofollow" target="_blank">@storybook/react</a>@6.3.7<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/babel/code-frame" rel="noopener ugc nofollow" target="_blank">@babel/code-frame</a>@7.14.5<br/>├─ <a class="ae le" href="http://twitter.com/babel/compat-data" rel="noopener ugc nofollow" target="_blank">@babel/compat-data</a>@7.15.0<br/>...<br/>└─ yargs@16.2.0<br/>✨  Done in 35.16s.<br/>. ✓<br/> • Preparing to install dependencies. ✓</span><span id="be0b" class="lx ly it lw b gy nd na l nb nc">yarn install v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>success Already up-to-date.<br/>✨  Done in 0.58s.<br/>. ✓</span><span id="2152" class="lx ly it lw b gy nd na l nb nc">To run your Storybook, type:</span><span id="5012" class="lx ly it lw b gy nd na l nb nc">yarn storybook</span><span id="08fc" class="lx ly it lw b gy nd na l nb nc">For more information visit: <a class="ae le" href="https://storybook.js.org" rel="noopener ugc nofollow" target="_blank">https://storybook.js.org</a></span></pre><p id="14aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">安装完成后，我们已经可以运行<code class="fe lt lu lv lw b">yarn storybook</code>来查看故事书和自动安装的例子。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="4697" class="lx ly it lw b gy mz na l nb nc">$ yarn storybook<br/>...<br/>╭────────────────────────────────────────────────────╮<br/>│                                                    │<br/>│   Storybook 6.3.7 started                          │<br/>│   7.7 s for preview                                │<br/>│                                                    │<br/>│    Local:            <a class="ae le" href="http://localhost:6006/" rel="noopener ugc nofollow" target="_blank">http://localhost:6006/</a>        │<br/>│    On your network:  <a class="ae le" href="http://10.183.191.72:6006/" rel="noopener ugc nofollow" target="_blank">http://10.183.191.72:6006/</a>    │<br/>│                                                    │<br/>╰────────────────────────────────────────────────────╯</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/d7cad91c213b1eb3f403c89bf9b823e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fS0WLYY8TPHKU0jNLTZs3g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">故事书</figcaption></figure><p id="a4a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要修改一些东西，使这本故事书与我们的NextJS和MaterialUI设置兼容。首先，让我们安装<code class="fe lt lu lv lw b">storybook-addon-material-ui addon</code>并在故事书设置文件中配置它。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="1da7" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn add --dev storybook-addon-material-ui</strong><br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...<br/>success Saved lockfile.<br/>success Saved 12 new dependencies.<br/>info Direct dependencies<br/>└─ storybook-addon-material-ui@0.9.0-alpha.24<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/usulpro/color-picker" rel="noopener ugc nofollow" target="_blank">@usulpro/color-picker</a>@1.1.4<br/>├─ abbrev@1.1.1<br/>├─ babel-runtime@6.26.0<br/>...<br/>✨  Done in 7.15s.</span></pre><p id="6243" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">.storybook/main.js</code>应修改为包括以下行(粗体):</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="eda8" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">const path = require('path')</strong></span><span id="5d6f" class="lx ly it lw b gy nd na l nb nc">module.exports = {<br/>  <strong class="lw iu">webpackFinal: async config =&gt; {<br/>    config.resolve.modules.push(path.resolve(__dirname, '../src'))<br/>    return config<br/>  },</strong><br/>  stories: [<br/>    '../src/**/*.stories.mdx', <br/>    '../src/**/*.stories.@(js|jsx|ts|tsx)'<br/>  ],<br/>  addons: [<br/>    '<a class="ae le" href="http://twitter.com/storybook/addon-links" rel="noopener ugc nofollow" target="_blank">@storybook/addon-links</a>', <br/>    '<a class="ae le" href="http://twitter.com/storybook/addon-essentials" rel="noopener ugc nofollow" target="_blank">@storybook/addon-essentials</a>', <br/>    <strong class="lw iu">'storybook-addon-material-ui'</strong><br/>  ]<br/>}</span></pre><p id="8fd9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe lt lu lv lw b">.storybook/preview.js</code>文件中，我们应该包含MaterialUI主题插件装饰器:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="17aa" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">import { muiTheme } from 'storybook-addon-material-ui'</strong></span><span id="46b1" class="lx ly it lw b gy nd na l nb nc"><strong class="lw iu">export const decorators = [muiTheme()]</strong></span><span id="9476" class="lx ly it lw b gy nd na l nb nc">export const parameters = {<br/>  actions: { argTypesRegex: '^on[A-Z].*' },<br/>  controls: {<br/>    matchers: {<br/>      color: /(background|color)$/i,<br/>      date: /Date$/<br/>    }<br/>  }<br/>}</span></pre><p id="84fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">删除src/storybook文件夹，其中包含storybook安装中的演示示例。让我们创建自己的组件，并把它放在故事书里。</p><p id="bff1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">组件是在src/components文件夹中自己的文件夹中创建的:<code class="fe lt lu lv lw b">src/components/SubscribeHero/SubscribeHero.tsx</code></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/components/subscribe hero/subscribe hero . tsx</figcaption></figure><p id="b092" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个组件的故事书:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/components/subscribe hero/subscribe hero . stories . tsx</figcaption></figure><p id="ea47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行故事书并检查您的新故事。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/24dd24861433572e819aecb9e8cf6c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7bPV03PIbYsY1VN1-MjuiA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">订户组件</figcaption></figure><h2 id="dba4" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">用笑话测试很容易。</h2><p id="c99c" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">单元测试应该很容易添加到您的项目中。我知道对于一个SaaS MVP来说，这听起来有点过头了。我的方法是为一些控制我的应用程序逻辑的重要部分的函数创建它们。</p><p id="4fa7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了在我们的项目中增加对Jest测试的支持，我们安装了:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="27be" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn add --dev jest </strong><a class="ae le" href="http://twitter.com/types/jest" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">@types/jest</strong></a><strong class="lw iu"> ts-jest      </strong><br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...<br/>success Saved lockfile.<br/>success Saved 77 new dependencies.<br/>info Direct dependencies<br/>├─ <a class="ae le" href="http://twitter.com/types/jest" rel="noopener ugc nofollow" target="_blank">@types/jest</a>@26.0.24<br/>├─ jest@27.0.6<br/>└─ ts-jest@27.0.4<br/>info All dependencies<br/>├─ <a class="ae le" href="http://twitter.com/babel/plugin-syntax-bigint" rel="noopener ugc nofollow" target="_blank">@babel/plugin-syntax-bigint</a>@7.8.3<br/>├─ <a class="ae le" href="http://twitter.com/babel/plugin-syntax-import-meta" rel="noopener ugc nofollow" target="_blank">@babel/plugin-syntax-import-meta</a>@7.10.4<br/>...<br/>✨  Done in 9.09s.</span></pre><p id="82c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">修改<code class="fe lt lu lv lw b">package.json</code>文件，添加<code class="fe lt lu lv lw b">test</code>脚本:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="d785" class="lx ly it lw b gy mz na l nb nc">{<br/>  "name": "saas-app",<br/>  "version": "1.0.0",<br/>  "main": "index.js",<br/>  "license": "MIT",<br/>  "scripts": {<br/>    ...<br/>    <strong class="lw iu">"test": "jest"</strong><br/>  },<br/>  "dependencies": {<br/>    ...<br/>  },<br/>  "devDependencies": {<br/>    ...<br/>  }<br/>}</span></pre><p id="23de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这之后，我们创建了<code class="fe lt lu lv lw b">jest.config.js</code>文件:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="2d2f" class="lx ly it lw b gy mz na l nb nc">module.exports = {<br/>  modulePaths: ['&lt;rootDir&gt;/src'],<br/>  testPathIgnorePatterns: [<br/>    '&lt;rootDir&gt;/.next/', <br/>    '&lt;rootDir&gt;/node_modules/'<br/>  ]<br/>}</span></pre><p id="6404" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了确保我们也可以使用TypeScript编写测试，我们需要在根文件夹上添加一个<code class="fe lt lu lv lw b">.babelrc</code>。</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="5d63" class="lx ly it lw b gy mz na l nb nc">{<br/>  "presets": ["next/babel"]<br/>}</span></pre><p id="6e10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并用一个简单的函数及其测试来尝试这一切。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/lib/email.ts</figcaption></figure><p id="819b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">测试将在嵌套文件夹<code class="fe lt lu lv lw b">__tests__</code>上创建</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/lib/_ _ tests _ _/email . test . ts</figcaption></figure><p id="4854" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行测试将为我们提供:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="d463" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn test</strong><br/>yarn run v1.22.11<br/>$ jest<br/> PASS  src/lib/__tests__/email.test.ts<br/>  isValidEmail<br/>    ✓ valid email (1 ms)<br/>    ✓ invalid email</span><span id="8d1b" class="lx ly it lw b gy nd na l nb nc">Test Suites: 1 passed, 1 total<br/>Tests:       2 passed, 2 total<br/>Snapshots:   0 total<br/>Time:        0.687 s, estimated 1 s<br/>Ran all test suites.<br/>✨  Done in 1.77s.</span></pre><p id="0fbd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">全绿！！</p><h1 id="78c6" class="np ly it bd lz nq nr ns mc nt nu nv mf nw nx ny mi nz oa ob ml oc od oe mo of bi translated">API和数据获取完成您的设置。</h1><p id="35c3" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">SaaS MVP不需要复杂的微服务架构。当然有些人会，但大多数人不会。</p><p id="f6c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">NextJS还支持创建API，因此我们将使用它来创建一个注册API后端，并在浏览器中使用它来:</p><ol class=""><li id="fdc3" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn og ll lm ln bi translated">提交订阅的电子邮件地址</li><li id="a503" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn og ll lm ln bi translated">查询订阅的电子邮件地址以显示在网格组件上</li></ol><p id="8144" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了提交数据，我喜欢使用一个定制的钩子来包装<code class="fe lt lu lv lw b">axios</code>客户机，以便向服务器API发送POST请求。</p><p id="1802" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了获取数据，SWR获取挂钩是一个很好的选择。react-query(<a class="ae le" href="https://react-query.tanstack.com/" rel="noopener ugc nofollow" target="_blank">https://react-query.tanstack.com/</a>)也是一个不错的解决方案。</p><p id="44af" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">next-connect(<a class="ae le" href="https://www.npmjs.com/package/next-connect" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/next-connect</a>)是一个漂亮的小NPM模块，帮助你在NextJS上构建API端点</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="f43f" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ yarn add axios swr next-connect</strong><br/>yarn add v1.22.11<br/>[1/4] 🔍  Resolving packages...<br/>[2/4] 🚚  Fetching packages...<br/>[3/4] 🔗  Linking dependencies...<br/>[4/4] 🔨  Building fresh packages...<br/>success Saved lockfile.<br/>success Saved 4 new dependencies.<br/>info Direct dependencies<br/>├─ axios@0.21.1<br/>├─ next-connect@0.10.2<br/>└─ swr@0.5.6<br/>info All dependencies<br/>├─ axios@0.21.1<br/>...<br/>✨  Done in 6.83s.</span></pre><h2 id="5a19" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">首先是几个API。</h2><p id="1c46" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">我们的两个端点将:</p><ol class=""><li id="796b" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn og ll lm ln bi translated">POST <code class="fe lt lu lv lw b">/api/subscriptions</code>创建一个新的订阅，只在JSON对象中传递电子邮件。电子邮件将使用我们在上一步中创建的函数进行验证。</li><li id="c50c" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn og ll lm ln bi translated">获取<code class="fe lt lu lv lw b">/api/subscriptions</code>以查询所有现有订阅</li></ol><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/pages/api/subscriptions.ts</figcaption></figure><p id="f015" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了文件和运行的应用程序，我们可以进行查询:</p><pre class="kp kq kr ks gt mv lw mw mx aw my bi"><span id="d69f" class="lx ly it lw b gy mz na l nb nc"><strong class="lw iu">$ curl -X POST </strong><a class="ae le" href="http://localhost:3000/api/subscriptions" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">http://localhost:3000/api/subscriptions</strong></a><strong class="lw iu"> \<br/>-H 'content-type: application/json' \<br/>-d '{"email": "john@gmail.com"}'</strong></span><span id="7ae7" class="lx ly it lw b gy nd na l nb nc"><strong class="lw iu">$ curl </strong><a class="ae le" href="http://localhost:3000/api/subscriptions" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">http://localhost:3000/api/subscriptions</strong></a><br/>[{"email":"john@gmail.com","updated":1628614626605}]</span><span id="89c0" class="lx ly it lw b gy nd na l nb nc"><strong class="lw iu">$ curl -X POST </strong><a class="ae le" href="http://localhost:3000/api/subscriptions" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu">http://localhost:3000/api/subscriptions</strong></a><strong class="lw iu"> \<br/>-H 'content-type: application/json' \<br/>-d '{"email": "johngmail.com"}'<br/></strong>{"error":"invalid-email"}</span></pre><h2 id="97f4" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">订阅列表组件</h2><p id="3ec1" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">另一个可视组件:<code class="fe lt lu lv lw b">SubscriptionList</code></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/components/subscription list/subscription list . tsx</figcaption></figure><p id="32b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">故事也是，为了故事书。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/components/subscription list/subscription list . stories . tsx</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/5c88f9a641497388faa9f8f5b159cd3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDnAGdn1TP5bdoPlBFXSkA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">故事书上的订阅列表组件</figcaption></figure><p id="194f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我用来向后端API获取和发送数据的定制钩子如下:</p><ol class=""><li id="24c0" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn og ll lm ln bi translated"><code class="fe lt lu lv lw b">useAPIPost</code>:向API发送POST请求的自定义钩子。支持，加载，重置，最后发布，完全键入。</li><li id="88a4" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn og ll lm ln bi translated"><code class="fe lt lu lv lw b">secureLoader</code>:接收一个<code class="fe lt lu lv lw b">apiURL</code>基函数和一个异步<code class="fe lt lu lv lw b">getToken</code>函数，并为SWR钩子返回一个fetcher函数。也是全打。</li></ol><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">src/lib/api.ts</figcaption></figure><p id="f69e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后是我们在<code class="fe lt lu lv lw b">index.tsx</code>页面上的代码。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="1111" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在浏览器上，我们的应用程序将如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/7f72ab96ae187d55cdf9de88d6e5fd30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eOxWT_sP4SXUfC5jr7o2g.png"/></div></div></figure><h1 id="951e" class="np ly it bd lz nq nr ns mc nt nu nv mf nw nx ny mi nz oa ob ml oc od oe mo of bi translated">最后…</h1><ul class=""><li id="58db" class="lf lg it js b jt mq jx mr kb oh kf oi kj oj kn lk ll lm ln bi translated">检查StorybookJS的Storyshot插件来执行视觉测试:<a class="ae le" href="https://www.npmjs.com/package/@storybook/addon-storyshots" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/@storybook/addon-storyshots</a></li><li id="4599" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">作为一个SaaS应用程序，集成Stripe可能是一个好主意。查看此报告以了解如何:<a class="ae le" href="https://github.com/stripe-samples/nextjs-typescript-react-stripe-js" rel="noopener ugc nofollow" target="_blank">https://github . com/stripe-samples/nextjs-typescript-react-stripe-js</a></li><li id="6825" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">用赛普拉斯(<a class="ae le" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank">https://www.cypress.io/</a>)进行自动化测试是一件轻而易举的事情，并且在交付给客户之前肯定有很多价值要测试。</li><li id="f391" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">你可以将这段代码作为你下一个应用的模板:<a class="ae le" href="https://github.com/outsrc/next-mui" rel="noopener ugc nofollow" target="_blank">https://github.com/outsrc/next-mui</a></li><li id="3868" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">查看运行于:<a class="ae le" href="https://next-mui-two.vercel.app/" rel="noopener ugc nofollow" target="_blank">https://next-mui-two.vercel.app/</a>的最终应用(将在3个月后或2021年11月10日移除)</li></ul><h2 id="fc19" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">阅读第2部分:NextJS + API Routes + MongoDB</h2><div class="ok ol gp gr om on"><a rel="noopener  ugc nofollow" target="_blank" href="/part-2-nextjs-api-routes-mongodb-b6895232c27"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">第2部分:NextJS + API Routes + MongoDB</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">将MongoDB数据库添加到我们在本博客系列的第一部分中构建的SaaS MVP应用程序中。</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">itnext.io</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ky on"/></div></div></a></div><p id="84a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">黑客快乐…</p></div></div>    
</body>
</html>
<html>
<head>
<title>End-to-end encryption using EnRoute and Linkerd</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用途中和链路的端到端加密</h1>
<blockquote>原文：<a href="https://itnext.io/end-to-end-encryption-using-enroute-and-linkerd-2d58875cd59b?source=collection_archive---------3-----------------------#2022-04-15">https://itnext.io/end-to-end-encryption-using-enroute-and-linkerd-2d58875cd59b?source=collection_archive---------3-----------------------#2022-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a5b9bbe0cb3565f81ed6417f22a232e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pAOkzjxcKuSSD4yTE0bRPw.jpeg"/></div></div></figure><h1 id="5633" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">1.介绍</h1><p id="d14b" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">本文描述了EnRoute OneStep与Linkerd service-mesh的集成有多容易。LinkerD是CNCF毕业的服务网格项目，它使用轻量级代理在Kubernetes内部设置网格。</p><p id="0ec4" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">与Linkerd的途中集成可以一步完成。集成EnRoute和Linkerd需要设置一个标志</p><p id="7678" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">从高层次来看，端到端加密包括-</p><ul class=""><li id="5a52" class="lz ma iq ky b kz lu ld lv lh mb ll mc lp md lt me mf mg mh bi translated">从客户端到途中的加密，以及</li><li id="95f5" class="lz ma iq ky b kz mi ld mj lh mk ll ml lp mm lt me mf mg mh bi translated">从途中到网状网内部MTL的加密</li></ul><p id="54c8" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们通过将linkerd代理注入到它们的pod中来网状化工作负载和路由，然后设置客户端证书。</p><ul class=""><li id="e2c6" class="lz ma iq ky b kz lu ld lv lh mb ll mc lp md lt me mf mg mh bi translated">我们首先设置集群，安装linkerd，添加一个示例工作负载emojivoto，并通过注入linkerd来划分这个工作负载</li><li id="6f40" class="lz ma iq ky b kz mi ld mj lh mk ll ml lp mm lt me mf mg mh bi translated">接下来，我们安装EnRoute，公开不带TLS的emojivoto应用程序，在EnRoute pod中注入linkerd代理以将其添加到网格中</li><li id="011c" class="lz ma iq ky b kz mi ld mj lh mk ll ml lp mm lt me mf mg mh bi translated">最后一步，我们使用JetStack cert manager为emojivoto应用程序生成、签名并安装一个let's Encrypt证书</li></ul><p id="19d5" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">在监视集群的linkerd代理注入时，我们跟踪上述每个步骤。</p><p id="4061" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们还在Bouyant cloud(及其免费层)上验证了上面的一些步骤，它在不同的UI屏幕上显示了上面的步骤</p><h1 id="644e" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">2.先决条件</h1><p id="7d33" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这个设置需要一个Kubernetes集群。我们有一个包含两个节点的集群设置-</p><p id="9b95" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">检查Kubernetes集群</strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="fa3a" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">kubectl get nodes</strong></span><span id="552e" class="mw jz iq ms b gy nb my l mz na">NAME                   STATUS   ROLES    AGE   VERSION<br/>pool-twnynczzy-u9k34   Ready    &lt;none&gt;   8d    v1.21.10<br/>pool-twnynczzy-u9k3i   Ready    &lt;none&gt;   8d    v1.21.10</span></pre><p id="7020" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">安装并检查Linkerd安装</strong></p><p id="4de0" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">linkerd网站上的入门指南中介绍了linkerd的安装步骤，这里不做介绍。一旦安装了linkerd，我们就可以验证它的安装。</p><p id="516f" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">检查linkerd安装是否正常</strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="fa3e" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">linkerd check</strong></span><span id="db21" class="mw jz iq ms b gy nb my l mz na">Linkerd core checks<br/><strong class="ms ir">===================</strong><br/><br/>kubernetes-api<br/>--------------<br/>√ can initialize the client<br/>√ can query the Kubernetes API<br/><br/>kubernetes-version<br/>------------------<br/>√ is running the minimum Kubernetes API version<br/>√ is running the minimum kubectl version<br/><br/>...<br/><br/>linkerd-control-plane-proxy<br/>---------------------------<br/>√ control plane proxies are healthy<br/>√ control plane proxies are up-to-date<br/>√ control plane proxies and cli versions match<br/><br/>Status check results are √</span></pre><h1 id="4f78" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">3.安装途中和Emojivoto工作负载</h1><p id="9ce1" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="ky ir">安装示例工作负载Emojivoto </strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="0604" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">curl -fsL https://run.linkerd.io/emojivoto.yml | kubectl apply -f -</strong></span><span id="7c45" class="mw jz iq ms b gy nb my l mz na">Linkerd core checks<br/>namespace/emojivoto created<br/>serviceaccount/emoji created<br/>serviceaccount/voting created<br/>serviceaccount/web created<br/>service/emoji-svc created<br/>service/voting-svc created<br/>service/web-svc created<br/>deployment.apps/emoji created<br/>deployment.apps/vote-bot created<br/>deployment.apps/voting created<br/>deployment.apps/web created</span></pre><h2 id="4a08" class="mw jz iq bd ka nc nd dn ke ne nf dp ki lh ng nh km ll ni nj kq lp nk nl ku nm bi translated"><strong class="ak">安装途中一步</strong></h2><p id="829e" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="ky ir">添加舵仓</strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="37c6" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">helm repo add saaras https://getenroute.io<br/>helm repo add jetstack https://charts.jetstack.io<br/>helm repo update<br/>helm search repo</strong></span></pre><p id="32e2" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">使用舵安装途中一步</strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="b039" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">helm install enroute-linkerd-meshed saaras/enroute \<br/>	--set enrouteService.rbac.create=true \<br/>	--create-namespace \<br/>	--namespace demo</strong></span><span id="d8ba" class="mw jz iq ms b gy nb my l mz na">NAME: enroute-linkerd-meshed<br/>LAST DEPLOYED: Mon Mar <strong class="ms ir">21</strong> 03:19:46 <strong class="ms ir">2022</strong><br/>NAMESPACE: demo<br/>STATUS: deployed<br/>REVISION: <strong class="ms ir">1</strong><br/>TEST SUITE: None<br/>NOTES:<br/>𝙴𝚗𝚁𝚘𝚞𝚝𝚎 Ingress API Gateway Community Edition Installed!<br/>-------------------------------------------------------<br/>Request a free evaluation license <strong class="ms ir">for</strong> enterprise version<br/>by sending an email to contact@saaras.io<br/><br/>Slack Channel         - https://slack.saaras.io<br/>Getting Started Guide - https://getenroute.io/docs/getting-started-enroute-ingress-controller/<br/>EnRoute Features      - https://getenroute.io/features/</span></pre><h1 id="e3e9" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">4.为Linkerd配置途中</h1><p id="fa9d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">与linkerd在途中啮合只需要在<code class="fe nn no np ms b">GlobalConfig</code>上设置一个标志<code class="fe nn no np ms b">linkerd_enabled</code></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="8ba0" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">cat &lt;&lt;EOF | kubectl apply -f -<br/>apiVersion: enroute.saaras.io/v1<br/>kind: GlobalConfig<br/>metadata:<br/>  labels:<br/>    app: web<br/>  name: enable-linkerd<br/>  namespace: default<br/>spec:<br/>  name: linkerd-global-config<br/>  type: globalconfig_globals<br/>  config: |<br/>        {<br/>          "linkerd_enabled": true<br/>        }<br/>EOF</strong></span><span id="5a72" class="mw jz iq ms b gy nb my l mz na">globalconfig.enroute.saaras.io/enable-linkerd configured</span></pre><h1 id="ccce" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">5.网状路由和Emojivoto工作负载—集群内的加密</h1><p id="e293" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="ky ir">在Emojivoto工作量中注入Linkerd</strong></p><p id="02e9" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">示例工作负载没有划分到linkerd网格中。为了将其网格化，我们需要为部署提供一个注释来注入linkerd</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="fd3f" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">kubectl get -n emojivoto deploy -o yaml | linkerd inject - | kubectl apply -f -</strong></span><span id="2b61" class="mw jz iq ms b gy nb my l mz na">deployment "emoji" injected<br/>deployment "vote-bot" injected<br/>deployment "voting" injected<br/>deployment "web" injected<br/><br/>deployment.apps/emoji configured<br/>deployment.apps/vote-bot configured<br/>deployment.apps/voting configured<br/>deployment.apps/web configured</span></pre><p id="1927" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">这将安装linkerd代理以及示例应用程序组件</p><p id="0c9a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">在航路吊舱中注入连接器</strong></p><p id="faae" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">一旦EnRoute准备好使用linkerd，我们就在EnRoute pod中注入linkerd代理</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="2f6d" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">kubectl get -n demo deploy -o yaml | linkerd inject - | kubectl apply -f -</strong></span><span id="fe42" class="mw jz iq ms b gy nb my l mz na">deployment "enroute-linkerd-meshed" injected<br/>deployment.apps/enroute-linkerd-meshed configured</span></pre><p id="51c0" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们使用漂浮云来追踪linkerd注入和网格形成的状态。下面的图片显示了如何在途中部署中添加linkerd代理，这是在bouyant cloud的几个屏幕上捕捉到的</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/691cc321643b3dcb564f4b8b02db165c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmTUsFjuX7Fq-a18ErlmgA.jpeg"/></div></div></figure><p id="a50f" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">事件屏幕还捕获了linkerd代理注入-</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/90acad012d4b97f3a89c6c51edbad60c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Hqpavlp98yMKBb8uN-lJQ.jpeg"/></div></div></figure><p id="32da" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们还可以使用<code class="fe nn no np ms b">kubectl</code>来检查pod，以查看linkerd是否插入到pod中</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="11f6" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">kubectl get pods -n demo -o jsonpath='{range .items[*]}{"\n"}{.metadata.name}{":\t"}{range .spec.containers[*]}{.image}{", "}{end}{end}' |sort</strong></span><span id="65ac" class="mw jz iq ms b gy nb my l mz na">enroute-linkerd-meshed-5d9575d575-4bskt:        cr.l5d.io/linkerd/proxy:stable-2.11.1, saarasio/enroute-gwi:latest, redis:latest, envoyproxy/envoy:v1.21.1,</span></pre><h1 id="c96a" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">6.从客户端到途中的加密</h1><p id="769e" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">安装服务策略图表，通过L7策略对外公开服务</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="0bc3" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">helm install emojivoto-service-policy saaras/service-policy   \<br/>--set service.name=web-svc   \<br/>--set service.prefix=/ \<br/>--set service.port=80 \<br/>--namespace emojivoto \<br/>--set service.fqdn=enroute-linkerd-mesh.enroutedemo.com \<br/>--set service.enableTLS=false</strong></span><span id="78b6" class="mw jz iq ms b gy nb my l mz na">NAME: emojivoto-service-policy<br/>LAST DEPLOYED: Mon Mar <strong class="ms ir">21</strong> 05:04:39 <strong class="ms ir">2022</strong><br/>NAMESPACE: emojivoto<br/>STATUS: deployed<br/>REVISION: <strong class="ms ir">1</strong><br/>NOTES:<br/>------------------ Configuration Graph -----------------------------------<br/>Filters enabled <strong class="ms ir">for</strong> service <strong class="ms ir">[</strong>web-svc<strong class="ms ir">]</strong><br/>         <strong class="ms ir">|</strong><br/>    web-svc-80-luatestfilter<br/>    kubectl edit -n emojivoto httpfilters.enroute.saaras.io web-svc-80-luatestfilter<br/>         <strong class="ms ir">|</strong><br/>    web-svc-80-rl2<br/>    kubectl edit -n emojivoto routefilters.enroute.saaras.io web-svc-80-rl2 <strong class="ms ir">(</strong>per-route ratelimit<strong class="ms ir">)</strong><br/>    kubectl edit -n emojivoto globalconfigs.enroute.saaras.io web-svc-rl-global-config <strong class="ms ir">(</strong>ratelimit engine global config<strong class="ms ir">)</strong><br/><br/>𝙴𝚗𝚁𝚘𝚞𝚝𝚎 Community Edition Service Policy<br/>----------------------------------------<br/>Request an evaluation license <strong class="ms ir">for</strong> enterprise version - contact@saaras.io<br/><br/>Slack Channel         - https://slack.saaras.io<br/>Getting Started Guide - https://getenroute.io/docs/getting-started-enroute-ingress-controller/<br/>EnRoute Features      - https://getenroute.io/features/</span></pre><p id="9c53" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">发送一些流量</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="0ee5" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">curl -I enroute-linkerd-mesh.enroutedemo.com</strong></span><span id="343d" class="mw jz iq ms b gy nb my l mz na">HTTP/1.1 <strong class="ms ir">200</strong> OK<br/>content-type: text/html<br/>date: Mon, <strong class="ms ir">21</strong> Mar <strong class="ms ir">2022</strong> 05:09:51 GMT<br/>content-length: <strong class="ms ir">560</strong><br/>x-envoy-upstream-service-time: <strong class="ms ir">4</strong><br/>vary: Accept-Encoding<br/>lua-filter-says: Hello<br/>server: envoy</span><span id="7159" class="mw jz iq ms b gy nb my l mz na"><strong class="ms ir">while true; do enroute-linkerd-mesh.enroutedemo.com &amp;&gt; /dev/null; done</strong></span></pre><h2 id="1326" class="mw jz iq bd ka nc nd dn ke ne nf dp ki lh ng nh km ll ni nj kq lp nk nl ku nm bi translated">通过为下游客户端连接启用TLS来启用端到端TLS</h2><p id="bf72" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们将使用<a class="ae ns" href="https://getenroute.io/reference/cookbook/cert-manager-with-enroute-ingress/" rel="noopener ugc nofollow" target="_blank"> JetStack证书管理器集成</a>来安装证书，例如workload emojivoto。我们需要设置DNS来自动验证证书。</p><p id="1f0f" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">设置DNS</p><p id="437a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们为一个域创建一个DNS条目，以启用证书验证(使用Let's Encrypt安装),并将其安装在我们的示例工作负载上</p><p id="3f8c" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">获取ExternalIP</p><p id="e62d" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">检查路由服务是否安装了外部IP</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="1649" class="mw jz iq ms b gy mx my l mz na"><strong class="ms ir">kubectl get service -n demo</strong></span><span id="d68a" class="mw jz iq ms b gy nb my l mz na">NAME                     TYPE           CLUSTER-IP       EXTERNAL-IP       PORT<strong class="ms ir">(</strong>S<strong class="ms ir">)</strong>                      AGE<br/>enroute-linkerd-meshed   LoadBalancer   10.245.139.117   137.184.245.252   80:30695/TCP,443:31864/TCP   94m</span></pre><p id="f5c1" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">创建DNS条目</strong></p><p id="d827" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">创建一个从域名到外部IP的DNS条目。验证DNS设置是否正确-</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="d24f" class="mw jz iq ms b gy mx my l mz na">ping enroute-linkerd-mesh.enroutedemo.com</span></pre><p id="79ff" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">在服务检查证书上安装证书</strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="7aa8" class="mw jz iq ms b gy mx my l mz na">kubectl get certificates.cert-manager.io --all-namespaces</span><span id="a011" class="mw jz iq ms b gy nb my l mz na">NAMESPACE NAME READY SECRET AGE <br/>emojivoto enroute-linkerd-mesh.enroutedemo.com True enroute-linkerd-mesh.enroutedemo.com 63s</span></pre><p id="4a13" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">发送流量</strong></p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="dac4" class="mw jz iq ms b gy mx my l mz na">curl -I -v <a class="ae ns" href="https://enroute-linkerd-mesh.enroutedemo.com" rel="noopener ugc nofollow" target="_blank">https://enroute-linkerd-mesh.enroutedemo.com</a></span></pre><p id="3d68" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">让我们验证端到端加密</p><p id="1ac6" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">使用我们在emojivoto应用上安装的证书加密浏览器到路由的连接-</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/62b0be315c4838e09f9f202932397112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*S-Vd4mHwByQb1c59.jpeg"/></div></div></figure><p id="5d96" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们还可以在下面的“网格”列中看到工作负载和途中网格</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/0a621a272e3c348b0b5f9b18df34a11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YGNOL_NRUTXan9Lf.jpeg"/></div></div></figure><p id="b441" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们还可以看到，传入流量显示为应用程序TLS</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/4b03e85fa3f059474b862d199828d396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8rA2ax9fMHyThZ_P.jpeg"/></div></div></figure><p id="05ac" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">拓扑屏幕还显示服务和流量方向之间的MTL</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/36aa1aef7f91b75bd5c5f9af6e9cba1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3mXayFMhDOI8l5Qr.jpeg"/></div></div></figure><p id="2375" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">在完成上述步骤后，还可以浏览下面视频中概述的步骤</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="d3d7" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="9dfc" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">EnRoute提供了与linkerd的极其简单的集成。</p><p id="375e" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">EnRoute可与linkerd和Istio服务网络轻松集成。与istio服务网格的集成将在另一篇文章中介绍。</p><p id="af6a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">随着微服务导致攻击面增加，使用零信任原则保护和划分工作负载的需求变得至关重要。EnRoute与服务网格集成，在集群边界和集群内部实现零信任。有关零信任、SPIFFE、加密强制身份、基于身份的分段以及与其他服务网格集成的更多信息，请参阅以下文章</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="68db" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><em class="od">最初发布于</em><a class="ae ns" href="https://getenroute.io/blog/end-to-end-encryption-mtls-linkerd-enroute/" rel="noopener ugc nofollow" target="_blank"><em class="od">https://geten route . io</em></a><em class="od">。</em></p></div></div>    
</body>
</html>
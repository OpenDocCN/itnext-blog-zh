<html>
<head>
<title>compare-pdf: Standalone PDF file comparison node module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">compare-pdf:独立的pdf文件比较节点模块</h1>
<blockquote>原文：<a href="https://itnext.io/compare-pdf-standalone-pdf-file-comparison-node-module-33222cace70f?source=collection_archive---------3-----------------------#2020-01-27">https://itnext.io/compare-pdf-standalone-pdf-file-comparison-node-module-33222cace70f?source=collection_archive---------3-----------------------#2020-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f126dd5aca580f0091b71a1c710af43d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxZkD_sfh3TBDtEmkJ_gcw.png"/></div></div></figure><h1 id="3e05" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">让我们从“为什么”开始？</h1><p id="474c" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在我的上一篇<a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/chai-pdf-awesome-chai-plugin-for-testing-pdf-files-a0752f42e489">帖子</a>中，我展示了一个名为<a class="ae lu" href="https://www.npmjs.com/package/chai-pdf" rel="noopener ugc nofollow" target="_blank"> chai-pdf </a>的<a class="ae lu" href="https://www.chaijs.com/" rel="noopener ugc nofollow" target="_blank"> chai </a>插件，它可以让你进行pdf比较。</p><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/chai-pdf-awesome-chai-plugin-for-testing-pdf-files-a0752f42e489"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">chai-pdf:测试pdf文件的强大chai插件</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">您曾经遇到过项目要求您验证pdf文件的情况吗？如果是这样，那么请继续阅读。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">itnext.io</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm jw ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a href="https://www.npmjs.com/package/chai-pdf" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">柴-pdf</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">牛逼的chai插件测试PDF文件安装以下系统依赖项安装npm模块npm安装…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.npmjs.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm jw ly"/></div></div></a></div><p id="3a5c" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">虽然它确实工作得很好，但因为它是作为插件创建的，所以在添加新特性或功能方面有点限制。此外，它在整合到一个<a class="ae lu" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>项目中也有一些问题。当时我想，为什么我不创建一个独立的pdf比较模块来解决这些问题，所以我们在这里。介绍<a class="ae lu" href="https://www.npmjs.com/package/compare-pdf" rel="noopener ugc nofollow" target="_blank"> compare-pdf </a>。</p><div class="lv lw gp gr lx ly"><a href="https://www.npmjs.com/package/compare-pdf" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">比较-pdf</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">比较pdf的独立节点模块安装以下系统依赖项安装npm模块npm安装…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.npmjs.com</p></div></div><div class="mh l"><div class="mt l mj mk ml mh mm jw ly"/></div></div></a></div><p id="5f00" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">与<a class="ae lu" href="https://www.npmjs.com/package/chai-pdf" rel="noopener ugc nofollow" target="_blank"> chai-pdf </a>类似，默认情况下，该模块将通过将基线和实际pdf文件的每一页转换为图像(png)来比较pdf，然后进行比较。</p><h1 id="fc1b" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">设置它</h1><p id="41eb" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">安装以下系统依赖项:</p><ul class=""><li id="cfc1" class="mu mv iq ky b kz mo ld mp lh mw ll mx lp my lt mz na nb nc bi translated"><a class="ae lu" href="https://www.ghostscript.com/" rel="noopener ugc nofollow" target="_blank">代写本</a></li><li id="2c74" class="mu mv iq ky b kz nd ld ne lh nf ll ng lp nh lt mz na nb nc bi translated"><a class="ae lu" href="http://www.graphicsmagick.org/README.html" rel="noopener ugc nofollow" target="_blank">图形图像</a></li><li id="dfab" class="mu mv iq ky b kz nd ld ne lh nf ll ng lp nh lt mz na nb nc bi translated"><a class="ae lu" href="https://imagemagick.org/index.php" rel="noopener ugc nofollow" target="_blank"> ImageMagick </a></li></ul><p id="f484" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">一旦安装了这些依赖项，您现在可以将compare-pdf模块安装到您的项目中</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="7ea0" class="nr jz iq nn b gy ns nt l nu nv">npm install compare-pdf</span></pre><p id="53d6" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">以下是显示路径和图像比较设置的默认配置:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">比较-pdf默认配置</figcaption></figure><h1 id="cc6c" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">告诉我怎么做</h1><p id="ef97" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在下面的要点中，你可以看到如何将compare-pdf集成到你的测试自动化框架中，在这个例子中使用了<a class="ae lu" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank"> mocha </a>。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">使用mocha比较pdf</figcaption></figure><h1 id="5dde" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">更多功能，更多乐趣</h1><p id="02d6" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">以下是<a class="ae lu" href="https://www.npmjs.com/package/compare-pdf" rel="noopener ugc nofollow" target="_blank"> compare-pdf </a>提供的特性和功能列表:</p><p id="d9b6" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated"><strong class="ky ir">屏蔽(addMask，addMasks) </strong></p><p id="0b6b" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">当您测试包含动态数据(如收据号码)的pdf文件时。Id或日期，您可以通过在测试期间屏蔽这些值来避免假阳性。此功能将在页面索引(从0开始)上绘制一个黑色矩形，并在比较之前为基线和实际图像提供坐标。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">比较-pdf蒙版要点</figcaption></figure><p id="0b05" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">使用<em class="oc">添加掩码</em>添加单个页面索引和坐标对象，使用<em class="oc">添加掩码</em>添加多个页面索引和坐标条目。</p><p id="75a4" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated"><strong class="ky ir">裁剪(cropPage，cropPages) </strong></p><p id="ebdf" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">可能会出现这样的情况:您只在测试了pdf文件中的某个区域之后。或者也许你的策略是模块化你的pdf验证，并希望分离你的测试，并将其分解到pdf页面的不同区域。此功能允许您指定页面索引和坐标，以便在比较之前裁剪基线和实际图像。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">比较-pdf裁剪要点</figcaption></figure><p id="dd40" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">您可以使用<em class="oc"> cropPage </em>方法来裁剪单个页面，或者使用<em class="oc"> cropPages </em>方法来添加指定页面索引和坐标的对象数组。</p><p id="46b7" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated"><strong class="ky ir">比较特定页面(onlyPageIndexes) </strong></p><p id="2788" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">您在验证pdf文件时可能遇到的另一种情况是只需要测试特定的页面。为此，您可以使用方法<em class="oc"> onlyPageIndexes </em>来添加特定的页面索引(从0开始)进行比较。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">比较-pdf特定页面要点</figcaption></figure><p id="311d" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated"><strong class="ky ir">跳过页面(skipPageIndexes) </strong></p><p id="490a" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">或者，您可能需要跳过验证pdf文件中的特定页面。在这种情况下，您可以使用skipPageIndexes方法。只需添加您想要跳过的特定页面索引。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">比较-pdf跳过页面要点</figcaption></figure><p id="fdee" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated"><strong class="ky ir">按Base64比较</strong></p><p id="4f1d" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">正如我前面提到的，默认情况下，这个模块会将pdf文件转换成图像文件进行比较。这个过程确实需要时间，但好处是，最后，您将有一个差异文件，它将显示pdf页面的哪个特定区域失败了。</p><p id="78a4" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">另一方面，通过base64编码比较pdf文件的速度非常快。然而，如果一个比较失败了，你就不会知道它失败的原因。</p><p id="44c1" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">那么，为什么不两全其美呢？该模块提供了另一种比较模式:ByBase64。如以下要点所示，当pdf文件失败时，您可以结合base64比较的速度和图像比较的diff输出。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">比较-pdf比较模式要点</figcaption></figure><h1 id="015d" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="e8b9" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">总之，这个用于pdf比较的独立节点模块提供了大量的功能，甚至是一个利用base64比较模式加速测试执行的解决方案。</p><p id="8e2e" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">我希望这对你的项目有用。如果你有意见或建议，请写在下面的评论里。</p><p id="2f11" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated">一如既往，保持牛逼，下集再见！</p><p id="e772" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ms lr ls lt ij bi translated"><strong class="ky ir">马尔克达茨</strong></p></div></div>    
</body>
</html>
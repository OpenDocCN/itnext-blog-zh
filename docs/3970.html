<html>
<head>
<title>Stay in control with your private npm registry</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保持对您的私人npm注册表的控制</h1>
<blockquote>原文：<a href="https://itnext.io/stay-in-control-with-your-private-npm-registry-f7d1d4791698?source=collection_archive---------6-----------------------#2020-04-03">https://itnext.io/stay-in-control-with-your-private-npm-registry-f7d1d4791698?source=collection_archive---------6-----------------------#2020-04-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="7ba9" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">网站从头开始建立的时代已经一去不复返了(有人记得CGI-BIN吗？众所周知，今天的快节奏、交互式网络是建立在模块化技术之上的，网站经常使用数百甚至数千个Javascript包。当某人或某物坏了会发生什么？</p></blockquote><p id="d1d3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><em class="js">完全披露:我是bytes safe(https://bytesafe.dev/)产品的创始人之一，该产品提供免费、安全和高度可用的私人国家预防机制注册。</em></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/085a643b1b4cde85f2df8a33c1b1a9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eesxt-cwcViKOpmQ"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated"><a class="ae li" href="https://unsplash.com/@neural_notworks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">邵杰</a>在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="cd1d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">今天，大多数开发人员只接触运行他们构建的网站所需的一小部分代码。这当然是一件美妙的事情:能够使用和重用其他人编写的代码，并且(希望)仍然维护着这些代码。这也是能够快速交付高质量结果的关键。</p><p id="b1a0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">大型网站超过1000(！)依赖。例如，对于那些想开始学习脸书设计框架React的人来说，有一个官方的“React getting starter app”(<a class="ae li" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank">https://create-react-app.dev/</a>)，它使用React和其他依赖项建立了一个现代的web应用。根据版本的不同，React应用程序对数百个贡献者提供的不同javascript包有1500多个依赖项。</p><p id="2af4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">想象一下，这些开发人员中的一个过了糟糕的一天，或者更糟:失去了他的<a class="ae li" href="https://www.zdnet.com/article/a-hacker-is-wiping-git-repositories-and-asking-for-a-ransom/" rel="noopener ugc nofollow" target="_blank">证书，他的Github账户被黑。</a>这样的事件会如何影响全球开发者和公司的日常生活？我想起了一个著名的事件:<a class="ae li" href="https://medium.com/@mproberts/a-discussion-about-the-breaking-of-the-internet-3d4d2a83aa4d" rel="noopener">当开发者Azer Koç ulu从npm中删除了他的一个包。</a>这导致了2016年3月初世界各地的大量构建中断。</p><p id="1f98" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">保护自己的一种方法是使用npm代理，它位于您(或您的开发团队)和您的应用程序所使用的不断变化的大型依赖关系网络之间。</p><p id="9955" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">这是我们着手用<a class="ae li" href="https://bytesafe.dev/" rel="noopener ugc nofollow" target="_blank">字节安全(https://bytesafe.dev/)</a>解决的挑战之一，它最基本的形式可以用作npm代理。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/f6dd19fe21c2b70f577d427565fca2d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*-e-JUhHz_OJPmVtCc2wvhg.png"/></div></figure><p id="8c2b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用这样的NPM代理，您可以在您的依赖项在互联网上发生问题时获得通知，而不是从您的CI/CD管道中获得不及时的故障警报。当你的竞争对手做不到的时候，你也许可以发布下一个版本。</p><p id="e55d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">那么，如何使用私有npm注册表呢？很简单，使用你已经知道的工具。我们努力兼容常用的工具，如npm、yarn等，因此入门门槛不应太高。</p><p id="0ca0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">首先在<a class="ae li" href="https://bytesafe.dev" rel="noopener ugc nofollow" target="_blank">https://bytes safe . dev</a>创建一个免费帐户(点击注册)为你的帐户选择一个唯一的名称，登录，瞧！你已经准备好了！</p><p id="63c8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">一旦建立了帐户，就创建了初始(“默认”)注册表。创建额外的注册中心有两种方法，从web或者从bytesafe CLI(如果您喜欢您的终端的话)。</p><p id="cd19" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用你的Bytesafe缺省注册表，你可以连接到外部世界，我们设置了一个缺省的<em class="js">上游，</em>，它使你能够从你保存私有包的同一个注册表中从npmjs拉包。关于上游的更多信息，<a class="ae li" href="https://bytesafe.dev/posts/using-bytesafe-upstreams/" rel="noopener ugc nofollow" target="_blank">见本文</a>。这简化了您的工作流程，因此您不必使用多个注册表。</p><p id="ba5a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在客户端，您需要做的第一件事是让您的环境知道您的新注册表:</p><pre class="kt ku kv kw gt lk ll lm ln aw lo bi"><span id="bd34" class="lp lq iq ll b gy lr ls l lt lu">npm config set registry '<a class="ae li" href="https://example.bytesafe.dev/r/default'" rel="noopener ugc nofollow" target="_blank">https://example.bytesafe.dev/r/default'</a><br/>npm login</span></pre><p id="a7d5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">提供您的凭据，这些凭据在bytesafe.dev上的注册表页面上可见。</p><p id="91e5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">从注册表中取出一个包就像:</p><pre class="kt ku kv kw gt lk ll lm ln aw lo bi"><span id="a787" class="lp lq iq ll b gy lr ls l lt lu">npm install 'some-package'</span></pre><p id="8b88" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如果指定的Bytesafe注册表不包含特定的包，则该包将从上游(如果已配置)提取，并将<strong class="jt ir">存储在注册表中。</strong></p><p id="94f6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">发布到您的私有注册表也同样简单:</p><pre class="kt ku kv kw gt lk ll lm ln aw lo bi"><span id="34a2" class="lp lq iq ll b gy lr ls l lt lu">npm publish ‘some-package’</span></pre></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h1 id="ddd8" class="mc lq iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi">0.11.1 ? 0.11.2?</h1><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mz"><img src="../Images/7680bcbd1989c50350328f687db49a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rdTbbDpCSw8bZ0NQ"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@simmerdownjpg?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰克逊煨</a>在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="da21" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">作为开发人员，我们经常遇到的另一个挑战是确保团队中的每个人(以及我们与之互动的团队)都使用这些包和版本。</p><p id="c67f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">开发人员/CD/QA环境并不总是同步的，这是错误、混乱和浪费时间的常见原因。</p><p id="0aff" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">您是否曾经花时间试图帮助同事理解为什么没有编译，而相同的代码在您的本地env中运行良好？只是后来才明白，他或她使用的是某种依赖的不同版本，而你早就忘记了当初为什么需要它？我有。</p><p id="d624" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">当然有很多方法可以解决这个问题。在Bytesafe中，我们使用了两个特性(我们称之为策略):不可变版本和冻结，我们相信这将有助于避免这种情况(<a class="ae li" href="https://bytesafe.dev/posts/introducing-policies-plugins/" rel="noopener ugc nofollow" target="_blank">在此阅读更多内容</a>)</p><p id="b935" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">好的可靠的工作流不是微不足道的，我将在以后的文章中讨论如何在您的工作流中使用Bytesafe。</p><p id="287b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">保护您的代码供应链，检查这些依赖性，祝您编码愉快！</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="0ff1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">❗️ <strong class="jt ir">更新于2020年4月27日</strong> : <a class="ae li" rel="noopener ugc nofollow" target="_blank" href="/automate-javascript-deployment-of-npm-packages-with-github-actions-ad82e2acb075">继续阅读本文</a>，获得一个简单的分步示例，了解如何创建Javascript部署到您自己的私有注册中心的管道。</p></div></div>    
</body>
</html>
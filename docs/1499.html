<html>
<head>
<title>An alternative to React Redux by React Hooks API (For both JavaScript and TypeScript)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Hooks API是React Redux的替代方法(适用于JavaScript和TypeScript)</h1>
<blockquote>原文：<a href="https://itnext.io/an-alternative-to-react-redux-by-react-hooks-api-for-both-javascript-and-typescript-c5e9a351ba0b?source=collection_archive---------0-----------------------#2018-11-04">https://itnext.io/an-alternative-to-react-redux-by-react-hooks-api-for-both-javascript-and-typescript-c5e9a351ba0b?source=collection_archive---------0-----------------------#2018-11-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="591a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">React钩子很牛逼。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c9f64f136e002abfe2b7d6dd24344d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2PwzaXHLpvrSnLO5qRZKA.png"/></div></div></figure><h2 id="2ced" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">动机</h2><p id="db05" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">每个人都对新的React Hooks API感到兴奋。我也是。一直在思考如何管理全局状态，Hooks API似乎很有前途。对了，我很喜欢Redux，但是不太喜欢react-redux a.k.a <code class="fe ly lz ma mb b">connect</code>。初学者用起来太复杂了。例如，重新选择/记忆是一个很难解释的概念。我的建议是构建一个全局状态，这样<code class="fe ly lz ma mb b">mapStateToProps</code>只需要选择状态的一部分，不需要任何逻辑。如果你真的可以自由地构造一个全局状态，你可以让它选择状态的直接属性，这意味着“一个深度”。</p><h2 id="653b" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">我的图书馆</h2><p id="4bdd" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">考虑到这一点，我一直在开发一个用于管理全局状态的库。</p><div class="mc md gp gr me mf"><a href="https://github.com/dai-shi/react-hooks-global-state" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">戴式/反应钩式-全局-状态</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">钩子API反应的简单全局状态。通过创造一个新的世界，为Dai-Shi/react-hooks-global-state的发展作出贡献</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">github.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ky mf"/></div></div></a></div><p id="cfe8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该库中的全局状态是由项目组成的对象。例如:</p><pre class="kp kq kr ks gt mu mb mv mw aw mx bi"><span id="816b" class="la lb it mb b gy my mz l na nb">const state = {<br/>  name: 'foo',<br/>  age: 23,<br/>  hobbies: ['reading', 'videogaming'],<br/>  scores: { stageA: 3, stageB: 7, stageC: 2 },<br/>};</span></pre><p id="8f85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种状态由4项组成(姓名、年龄、爱好、分数)。每一项都有一个值，它不仅可以是基元值，也可以是数组或对象。您可以连接到每个项目，以便在值更新时得到通知，但不是对象树中的深层值。</p><p id="9152" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个库最近支持一个用于更新状态的reducer。因此，您可能会认为它是React的Redux的替代品。也许是，也许不是。你们自己会看到的。</p><h2 id="6d49" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">示例代码</h2><p id="fc75" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">您定义一个全局状态并导出一些方法，如下所示。</p><pre class="kp kq kr ks gt mu mb mv mw aw mx bi"><span id="a4f1" class="la lb it mb b gy my mz l na nb">import { createStore } from 'react-hooks-global-state';<br/><br/>type Action =<br/>  | { type: 'increment' }<br/>  | { type: 'decrement' }<br/>  | { type: 'setFirstName', firstName: string }<br/>  | { type: 'setLastName', lastName: string }<br/>  | { type: 'setAge', age: number };<br/><br/>export const { GlobalStateProvider, dispatch, useGlobalState } = createStore(<br/>  (state, action: Action) =&gt; {<br/>    switch (action.type) {<br/>      case 'increment': return {<br/>        ...state,<br/>        counter: state.counter + 1,<br/>      };<br/>      case 'decrement': return {<br/>        ...state,<br/>        counter: state.counter - 1,<br/>      };<br/>      case 'setFirstName': return {<br/>        ...state,<br/>        person: {<br/>          ...state.person,<br/>          firstName: action.firstName,<br/>        },<br/>      };<br/>      case 'setLastName': return {<br/>        ...state,<br/>        person: {<br/>          ...state.person,<br/>          lastName: action.lastName,<br/>        },<br/>      };<br/>      case 'setAge': return {<br/>        ...state,<br/>        person: {<br/>          ...state.person,<br/>          age: action.age,<br/>        },<br/>      };<br/>      default: return state;<br/>    }<br/>  },<br/>  {<br/>    counter: 0,<br/>    person: {<br/>      age: 0,<br/>      firstName: '',<br/>      lastName: '',<br/>    },<br/>  },<br/>);</span></pre><p id="7de3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你不熟悉TypeScript，不要被<code class="fe ly lz ma mb b">Action</code>类型所困扰。<code class="fe ly lz ma mb b">createGlobalState</code>的第一个参数是一个reducer，如果你用过Redux的话应该看起来很熟悉。将所需的初始全局状态传递给第二个参数。如果你喜欢，你可以用<code class="fe ly lz ma mb b">combineReducers</code>。注意<code class="fe ly lz ma mb b">createGlobalState</code>的结果被导出。</p><p id="e81d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您需要用<code class="fe ly lz ma mb b">GlobalStateProvider</code>包装您的顶层组件，以附加一个保存全局状态的上下文。</p><pre class="kp kq kr ks gt mu mb mv mw aw mx bi"><span id="03ae" class="la lb it mb b gy my mz l na nb">import * as React from 'react';<br/><br/>import { GlobalStateProvider } from './state';<br/><br/>import Counter from './Counter';<br/>import Person from './Person';<br/><br/>const App = () =&gt; (<br/>  &lt;GlobalStateProvider&gt;<br/>    &lt;h1&gt;Counter&lt;/h1&gt;<br/>    &lt;Counter /&gt;<br/>    &lt;Counter /&gt;<br/>    &lt;h1&gt;Person&lt;/h1&gt;<br/>    &lt;Person /&gt;<br/>    &lt;Person /&gt;<br/>  &lt;/GlobalStateProvider&gt;<br/>);<br/><br/>export default App;</span></pre><p id="3e5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是如何在组件中使用计数器。</p><pre class="kp kq kr ks gt mu mb mv mw aw mx bi"><span id="67a9" class="la lb it mb b gy my mz l na nb">import * as React from 'react';</span><span id="4733" class="la lb it mb b gy nc mz l na nb">import { dispatch, useGlobalState } from './state';<br/><br/>const increment = () =&gt; dispatch({ type: 'increment' });<br/>const decrement = () =&gt; dispatch({ type: 'decrement' });<br/><br/>const Counter = () =&gt; {<br/>  const [value] = useGlobalState('counter');<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;span&gt;Count: {value}&lt;/span&gt;<br/>      &lt;button type="button" onClick={increment}&gt;+1&lt;/button&gt;<br/>      &lt;button type="button" onClick={decrement}&gt;-1&lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="fbf1" class="la lb it mb b gy nc mz l na nb">export default Counter;</span></pre><p id="7e5a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这应该很容易。<code class="fe ly lz ma mb b">dispatch</code>和<code class="fe ly lz ma mb b">useGlobalState</code>是从以前的文件中导入的。两个回调被定义并使用<code class="fe ly lz ma mb b">dispatch</code>。你可能想知道为什么我们的<code class="fe ly lz ma mb b">dispatch</code>有点全球化。这当然减少了代码隔离，但是这允许在组件之外定义动作。如果我误解了什么，请纠正我。我们也可以在另一个上下文中提供<code class="fe ly lz ma mb b">dispatch</code>和类似<code class="fe ly lz ma mb b">useDispatch</code>的东西。</p><p id="9f11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">包括Person组件在内的其余代码可以在存储库中找到:<a class="ae nd" href="https://github.com/dai-shi/react-hooks-global-state/tree/master/examples/06_reducer" rel="noopener ugc nofollow" target="_blank">https://github . com/Dai-Shi/react-hooks-global-state/tree/master/examples/06 _ reducer</a></p><p id="e7c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以通过以下方式运行该示例:</p><pre class="kp kq kr ks gt mu mb mv mw aw mx bi"><span id="1e43" class="la lb it mb b gy my mz l na nb">git clone <a class="ae nd" href="https://github.com/dai-shi/react-hooks-global-state.git" rel="noopener ugc nofollow" target="_blank">https://github.com/dai-shi/react-hooks-global-state.git</a><br/>npm install<br/>npm run examples:reducer</span></pre><p id="d309" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，在浏览器中打开<a class="ae nd" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>。</p><h2 id="4958" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">重要注意事项</h2><p id="bfa0" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">React Hooks API还没有发布，这个库仍然是一个实验。欢迎反馈，以改善图书馆。我想知道许多人正在尝试类似的事情，如果可能的话，我想得到一些想法。</p><h2 id="15d5" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">变更日志</h2><ul class=""><li id="95c9" class="ne nf it js b jt lt jx lu kb ng kf nh kj ni kn nj nk nl nm bi translated"><em class="nn">【2018–11–04】:首发。</em></li><li id="02f0" class="ne nf it js b jt no jx np kb nq kf nr kj ns kn nj nk nl nm bi translated"><em class="nn">【2018–11–08】:跟随库API变化，让例子更直观。</em></li><li id="707b" class="ne nf it js b jt no jx np kb nq kf nr kj ns kn nj nk nl nm bi translated"><em class="nn">【2018–11–12】:基于上下文API再次改变库API。</em></li></ul></div></div>    
</body>
</html>
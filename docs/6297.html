<html>
<head>
<title>How to Manage Thrift, Dubbo, Redis, and Any Layer-7 Protocol in an Istio Service Mesh?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Istio服务网格中管理Thrift、Dubbo、Redis和任何第7层协议？</h1>
<blockquote>原文：<a href="https://itnext.io/aeraki-manage-any-layer-7-protocol-in-istio-service-mesh-6eca64f77adb?source=collection_archive---------5-----------------------#2021-10-11">https://itnext.io/aeraki-manage-any-layer-7-protocol-in-istio-service-mesh-6eca64f77adb?source=collection_archive---------5-----------------------#2021-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a5b27659bebb569411303584c19fd31e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gY9Lfrddx14CsIY-"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kf" href="https://unsplash.com/@karlacar" rel="noopener ugc nofollow" target="_blank">卡拉车</a>拍摄</figcaption></figure><p id="138d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Aeraki [Air-rah-ki] Mesh是我大约一年前开始的一个开源服务Mesh，直到最近我一直在为它工作。Aeraki是希腊语中“微风”的意思。虽然Istio在服务网格中连接微服务，但Aeraki Mesh提供了一种非侵入性、高度可扩展的方式，允许Istio支持非HTTP开源和专有协议。希望这股微风能帮助Istio和service mesh航行得更远一点。</p><h1 id="c01d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">服务网格中缺乏协议支持</h1><p id="d4db" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在，我们在服务网格方面面临一些挑战:</p><ul class=""><li id="54c6" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">Istio和其他流行的服务网格实现对非HTTP协议的支持非常有限。</li><li id="65ec" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">Envoy RDS(路由发现服务)是专为HTTP设计的。其他协议(如Dubbo和Thrift)只能使用监听器内嵌路由进行流量管理，当路由改变时会中断现有连接。</li><li id="bcaa" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">将专有协议引入服务网格需要付出很大的努力。您需要编写一个特使过滤器来处理数据平面中的流量，并编写一个控制平面来管理这些特使。</li></ul><p id="26c3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些障碍使得用户很难管理微服务中其他广泛使用的第7层协议的流量。例如，在微服务应用中，我们可能有以下协议:</p><ul class=""><li id="e9d0" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated"><strong class="ki iu"> RPC: </strong> HTTP，gRPC，Thrift，Dubbo，专有RPC协议…</li><li id="b0e2" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated"><strong class="ki iu">消息:</strong>卡夫卡，RabbitMQ …</li><li id="57ff" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated"><strong class="ki iu">缓存:</strong> Redis，Memcached …</li><li id="1faf" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated"><strong class="ki iu">数据库:</strong> MySQL，PostgreSQL，MongoDB …</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/a3f5d29aa469ba0ab769935d6ed56f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPM8HOyIKQ4PBN1ypzgX-A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">微服务中使用的常见第7层协议</figcaption></figure><p id="7eef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您已经在迁移到服务网格方面投入了大量的精力，当然，您希望从中获得最大的收益——管理您的微服务中所有协议的流量，而不仅仅是HTTP。</p><h1 id="0333" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Aeraki Mesh的方法</h1><p id="4f82" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了解决这些问题，我创建了开源项目，<a class="ae kf" href="https://github.com/aeraki-framework" rel="noopener ugc nofollow" target="_blank"> Aeraki </a> Mesh，以提供一种非侵入性的、可扩展的方式来管理Istio服务网格中的任何第7层流量。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/d71364eced1d1884e010ee080f64839a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QHwrNyoFHpo4cHIo.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">阿拉基建筑</figcaption></figure><p id="9028" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如图所示，Aeraki Mesh由以下组件组成:</p><ul class=""><li id="f622" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">Aeraki: <a class="ae kf" href="https://github.com/aeraki-framework/aeraki" rel="noopener ugc nofollow" target="_blank"> Aeraki </a>为运营提供高级的、用户友好的流量管理规则，将规则转换为特使过滤器配置，并利用Istio的<code class="fe nb nc nd ne b">EnvoyFilter</code> API将配置推送到边车代理。Aeraki还充当数据平面中元协议代理的RDS服务器。与专注于HTTP的Envoy RDS相反，Aeraki RDS旨在为所有第7层协议提供通用动态路由功能。</li><li id="274a" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">元协议代理:<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy" rel="noopener ugc nofollow" target="_blank">元协议代理</a>为第7层协议提供通用功能，如负载均衡、断路器、负载均衡、路由、速率限制、故障注入和授权。第7层协议可以建立在元协议之上。要将新协议添加到服务网格中，您唯一需要做的事情就是实现<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/blob/ac788327239bd794e745ce18b382da858ddf3355/src/meta_protocol_proxy/codec/codec.h#L118" rel="noopener ugc nofollow" target="_blank">编解码器接口</a>和几行配置。如果您有内置功能无法满足的特殊需求，元协议代理还有一个应用程序级的过滤器链机制，允许用户编写自己的第7层过滤器，将自定义逻辑添加到元协议代理中。</li></ul><p id="cfa9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Dubbo 和<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/tree/master/src/application_protocols/thrift" rel="noopener ugc nofollow" target="_blank"> Thrift </a>已经基于元协议实现。更多的协议正在制定中。如果您使用的是封闭源代码的专有协议，那么您也可以在服务网格中管理它，只需为它编写一个元协议编解码器。</p><p id="0050" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大多数请求/响应风格的无状态协议可以建立在元协议代理之上。然而，有些协议的路由策略过于“特殊”，无法在元协议中规范化。例如，Redis代理使用插槽号将客户机查询映射到特定的Redis服务器节点，插槽号是由请求中的键计算的。只要在特使代理端有一个可用的特使过滤器，Aeraki仍然可以管理这些协议。目前，对于该类别的协议，Aeraki支持<a class="ae kf" href="https://github.com/aeraki-framework/aeraki/blob/master/docs/zh/redis.md" rel="noopener ugc nofollow" target="_blank"> Redis </a>和Kafka。</p><h1 id="671e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">深入研究元协议</h1><p id="c63e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">让我们看看元协议是如何工作的。在引入元协议之前，如果我们想要为特定协议代理流量，我们需要编写一个理解该协议的特使过滤器，并添加代码来操纵流量，包括路由、报头修改、故障注入、流量镜像等。</p><p id="df1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于大多数请求/响应类型的协议，流量操作的代码非常相似。因此，为了避免在不同的特使过滤器中重复这些功能，Aeraki Mesh在一个地方实现了第7层协议代理的大多数常见功能，即元协议代理过滤器。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/02d4af6db2ecc3afada011c25818cd1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HElccCzJMW9Nf3Mu.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">元协议代理</figcaption></figure><p id="836a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种方法大大降低了编写新的Envoy过滤器的障碍:现在您只需要实现编解码器接口，而不是编写一个功能完整的过滤器。除此之外，控制平面已经就位——Aeraki在控制平面上工作，为构建在元协议之上的所有协议提供元协议配置和动态路由。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/63cb3e3e11a68b871fa3a7189034ac6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T_qrEoir7kwhjbbq.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在元协议之前和之后编写特使过滤器</figcaption></figure><p id="ef18" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">元协议代理中有两种重要的数据结构:元数据和变异。元数据用于路由，变异用于头操作。</p><p id="42ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在请求路径，解码器(编解码器实现的解码方法)用从请求解析的键值对填充元数据数据结构，然后元数据将被传递到元协议路由器。路由器在匹配它通过RDS和元数据从Aeraki接收的路由配置之后，选择适当的上游集群。</p><p id="d3fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果需要修改请求，定制过滤器可以用任意的键-值对填充变异数据结构:添加一个头或者改变头的值。然后，突变数据结构将被传递给编码器(编解码器实现的编码方法)。编码器负责将键值对写入有线协议。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/7550a125e0c1606a859229f18ac4eff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cwYUdJWgps506k66.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">请求路径</figcaption></figure><p id="398e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">响应路径类似于请求路径，只是方向不同。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/d46c7c82cdd9542476493c9766a2076e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uuv4KHDPmrswPJSt.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">响应路径</figcaption></figure><h1 id="4850" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一个例子</h1><p id="ed38" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Dubbo 和<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/tree/master/src/application_protocols/thrift" rel="noopener ugc nofollow" target="_blank"> Thrift </a>已经基于元协议实现，由Aeraki Mesh开箱即用支持。如果您需要实现另一个协议，您可以遵循以下步骤(以<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/tree/master/src/application_protocols/thrift" rel="noopener ugc nofollow" target="_blank">节俭</a>为例):</p><h2 id="2292" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">数据平面</h2><ul class=""><li id="085c" class="mh mi it ki b kj mc kn md kr nt kv nu kz nv ld mm mn mo mp bi translated">实现<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/blob/ac788327239bd794e745ce18b382da858ddf3355/src/meta_protocol_proxy/codec/codec.h#L118" rel="noopener ugc nofollow" target="_blank">编解码接口</a>，对协议包进行编解码。你可以参考<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/tree/master/src/application_protocols/dubbo" rel="noopener ugc nofollow" target="_blank"> Dubbo codec </a>和<a class="ae kf" href="https://github.com/aeraki-framework/meta-protocol-proxy/tree/master/src/application_protocols/thrift" rel="noopener ugc nofollow" target="_blank"> Thrift codec </a>编写自己的实现。</li><li id="5526" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">使用Aeraki应用协议CRD定义协议，如以下YAML片段所示:</li></ul><pre class="mw mx my mz gt nw ne nx ny aw nz bi"><span id="1a30" class="nh lf it ne b gy oa ob l oc od">apiVersion: metaprotocol.aeraki.io/v1alpha1<br/>kind: ApplicationProtocol<br/>metadata:<br/>  name: thrift<br/>  namespace: istio-system<br/>spec:<br/>  protocol: thrift<br/>  codec: aeraki.meta_protocol.codec.thrift</span></pre><h2 id="4231" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">制导机</h2><p id="b053" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">您不需要实现控制平面。Aeraki监视服务和流量规则，为sidecar代理生成配置，并通过EnvoyFilter和MetaRoute RDS将配置发送到数据层。</p><h2 id="b0f9" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">协议选择</h2><p id="0dec" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">与Istio类似，协议由服务端口前缀标识。请使用此模式命名服务端口:TCP-元协议-{第7层协议}-xxx。例如，节俭服务端口应该命名为tcp-metaprotocol-thrift。</p><h2 id="f09a" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">交通管理</h2><p id="b435" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">您可以通过马塔鲁特CRD机场变更路线。例如:向v1发送20%的请求，向v2发送80%的请求:</p><pre class="mw mx my mz gt nw ne nx ny aw nz bi"><span id="3c1e" class="nh lf it ne b gy oa ob l oc od">apiVersion: metaprotocol.aeraki.io/v1alpha1<br/>kind: MetaRouter<br/>metadata:<br/>  name: test-metaprotocol-route<br/>spec:<br/>  hosts:<br/>    - thrift-sample-server.thrift.svc.cluster.local<br/>  routes:<br/>    - name: traffic-spilt<br/>      route:<br/>        - destination:<br/>            host: thrift-sample-server.thrift.svc.cluster.local<br/>            subset: v1<br/>          weight: 20<br/>        - destination:<br/>            host: thrift-sample-server.thrift.svc.cluster.local<br/>            subset: v2<br/>          weight: 80</span></pre><h1 id="d634" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">演示</h1><p id="11cd" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated"><a class="ae kf" href="http://aeraki.zhaohuabing.com:20001/" rel="noopener ugc nofollow" target="_blank">现场演示:kiali仪表盘</a></p><p id="3876" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="http://aeraki.zhaohuabing.com:3000/d/pgz7wp-Gz/aeraki-demo?orgId=1&amp;refresh=10s&amp;kiosk" rel="noopener ugc nofollow" target="_blank">现场演示:服务指标:Grafana </a></p><p id="b8b5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="http://aeraki.zhaohuabing.com:9090/new/graph?g0.expr=envoy_dubbo_inbound_20880___response_success&amp;g0.tab=0&amp;g0.stacked=1&amp;g0.range_input=1h&amp;g1.expr=envoy_dubbo_outbound_20880__org_apache_dubbo_samples_basic_api_demoservice_request&amp;g1.tab=0&amp;g1.stacked=1&amp;g1.range_input=1h&amp;g2.expr=envoy_thrift_inbound_9090___response&amp;g2.tab=0&amp;g2.stacked=1&amp;g2.range_input=1h&amp;g3.expr=envoy_thrift_outbound_9090__thrift_sample_server_thrift_svc_cluster_local_response_success&amp;g3.tab=0&amp;g3.stacked=1&amp;g3.range_input=1h&amp;g4.expr=envoy_thrift_outbound_9090__thrift_sample_server_thrift_svc_cluster_local_request&amp;g4.tab=0&amp;g4.stacked=1&amp;g4.range_input=1h" rel="noopener ugc nofollow" target="_blank">现场演示:服务指标:普罗米修斯</a></p><p id="b182" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">屏幕截图:服务指标:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/aa9cb205c733f74ad5763168680fb57f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IdmSvH3oLUfkWKAW.png"/></div></div></figure><p id="388c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">录制的演示:Dubbo和节俭交通管理</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/706535ef1ff55a66fca4e36fdf9dcf1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rfqXD8U2KOzgtjhW.jpg"/></div></div></figure><h1 id="b85b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">安装</h1><h2 id="1cd6" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">先决条件:</h2><ul class=""><li id="d1c8" class="mh mi it ki b kj mc kn md kr nt kv nu kz nv ld mm mn mo mp bi translated">正在运行的Kubernetes集群，可以是云中的集群，也可以是使用kind/minikube创建的本地集群</li><li id="3db6" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">安装了Kubectl，在第一步中,<code class="fe nb nc nd ne b">~/.kube/conf</code>指向集群</li><li id="6aba" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">头盔已安装，将用于安装演示中的一些组件</li></ul><h2 id="018a" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">从Github下载Aeraki</h2><pre class="mw mx my mz gt nw ne nx ny aw nz bi"><span id="8631" class="nh lf it ne b gy oa ob l oc od">git clone <a class="ae kf" href="https://github.com/aeraki-mesh/aeraiki" rel="noopener ugc nofollow" target="_blank">https://github.com/aeraki-mesh/aeraki.git</a></span></pre><h2 id="256d" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">安装Istio、Aeraki和演示应用程序</h2><pre class="mw mx my mz gt nw ne nx ny aw nz bi"><span id="1b41" class="nh lf it ne b gy oa ob l oc od">make demo</span></pre><p id="7053" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:Aeraki需要用智能DNS配置Istio。如果您已经安装了Istio，但不知道如何打开智能DNS，请卸载它。<em class="og">制作演示</em>将为您安装Istio。</p><h2 id="0eb6" class="nh lf it bd lg ni nj dn lk nk nl dp lo kr nm nn ls kv no np lw kz nq nr ma ns bi translated">在您的浏览器中打开以下URL来玩Aeraki并查看服务指标</h2><ul class=""><li id="32f8" class="mh mi it ki b kj mc kn md kr nt kv nu kz nv ld mm mn mo mp bi translated">凯里<code class="fe nb nc nd ne b"><a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/{istio-ingressgateway_external_ip}:20001/">http://{istio-ingressgateway_external_ip}:20001</a></code></li><li id="4d15" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">格拉夫纳<code class="fe nb nc nd ne b"><a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/{istio-ingressgateway_external_ip}:3000/">http://{istio-ingressgateway_external_ip}:3000</a></code></li><li id="9b86" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">普罗米修斯<code class="fe nb nc nd ne b"><a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/{istio-ingressgateway_external_ip}:9090/">http://{istio-ingressgateway_external_ip}:9090</a></code></li></ul><p id="7f6f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以将Aeraki演示仪表板从文件<code class="fe nb nc nd ne b"><a class="ae kf" href="https://raw.githubusercontent.com/aeraki-mesh/aeraki/master/demo/grafana-dashboard.json" rel="noopener ugc nofollow" target="_blank">demo/</a></code><a class="ae kf" href="https://raw.githubusercontent.com/aeraki-mesh/aeraki/master/demo/grafana-dashboard.json" rel="noopener ugc nofollow" target="_blank">grafana-dashboard . JSON</a>导入到Grafana中。</p><p id="4e16" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您需要在服务网格中管理HTTP以外的协议，希望这有所帮助。如果您有任何问题或评论，请联系(<a class="ae kf" href="https://twitter.com/zhaohuabing" rel="noopener ugc nofollow" target="_blank">@赵华兵</a><a class="ae kf" href="mailto: zhaohuabing@gmail.com" rel="noopener ugc nofollow" target="_blank">zhaohuabing@gmail.com</a>)！</p><p id="bde2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">github:<a class="ae kf" href="https://github.com/aeraki-mesh" rel="noopener ugc nofollow" target="_blank">https://github.com/aeraki-mesh</a></p><p id="9c33" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">网址:<a class="ae kf" href="https://aeraki.net" rel="noopener ugc nofollow" target="_blank">https://aeraki.net</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Easy A/B testing on Android with AndroidX Navigation Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Android导航组件在Android上进行简单的A/B测试</h1>
<blockquote>原文：<a href="https://itnext.io/easy-a-b-testing-on-android-with-androidx-navigation-component-64d057e5bdce?source=collection_archive---------3-----------------------#2020-04-05">https://itnext.io/easy-a-b-testing-on-android-with-androidx-navigation-component-64d057e5bdce?source=collection_archive---------3-----------------------#2020-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/96f9586a8461d0b3f90a1855efebc830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_4JSZP1hRtIq0lKttUyCSg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/s/photos/compass?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kc" href="https://unsplash.com/@freegraphictoday?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">absolute vision</a>拍摄</figcaption></figure><p id="5c25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个成功的应用程序需要采取数据驱动的决策。从用户那里收集有价值的见解的一个很好的工具是A/B测试。网上有很多资源解释其背后的理论(比如这里的<a class="ae kc" href="https://www.optimizely.com/optimization-glossary/ab-testing/" rel="noopener ugc nofollow" target="_blank"/>)，但本质上是将一个功能的两个或更多不同的变体部署到不同的用户群，并将这些变体的表现与预定义的目标(比如增加第一天的保留率、转换率等)进行比较。结果，你将(希望)有一个获胜的变体，它将胜过其他的，并将成为所有用户的新标准(当然其他变体将永远消失……)</p><p id="dc68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在技术方面，当A/B测试时，主要的挑战是不要用特定于测试的代码污染您的业务逻辑和/或主要代码库，并设计一个解决方案，使必要的测试后清理变得容易，使结果代码保持良好的状态，就像那里从未发生过测试一样。</p><h1 id="1985" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">导航挑战</h1><p id="11ae" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">谷歌在2018年发布了AndroidX导航组件库，作为Jetpack的一部分。它偏爱一个活动——多片段应用程序架构，隐藏了大多数怪异/糟糕的生命周期相关问题。它很强大，同时也很容易使用，提供了一个很好的图形导航编辑器，并使令人害怕的开发者在使用它们时感觉更舒服。如果你还没有尝试过，你可以在这里阅读更多关于它的内容，在这里看看codelab <a class="ae kc" href="https://codelabs.developers.google.com/codelabs/android-navigation/#0" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/bd4a7cd4466552afd8fa9aef801a66d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFcKXdO2Uu1LXNwvwuLYuQ.jpeg"/></div></div></figure><p id="73ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们为导航组件找到的另一个很好的用例是(你猜对了)A/B测试，并且已经被证明非常成功地帮助解决了所描述的技术挑战。</p><p id="58cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">考虑这样一个场景，您想要测试一个特性(例如用户入职)，您有3个不同的版本，每个版本有4个屏幕。基线，变体1具有完全不同的屏幕，变体2以不同的顺序混合了新屏幕和变体1屏幕。</p><p id="2ba7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设计导航逻辑看起来就像一场噩梦，到处都是if和whens，使用一个ViewPager或只是片段管理器，手动处理所有的片段事务。但是有了导航组件，所有这些问题都不存在了！</p><p id="8dff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了演示使用导航组件的新方法，我创建了一个新的玩具项目，完整的源代码在这里:</p><div class="mj mk gp gr ml mm"><a href="https://github.com/tpakis/ABNavigationExample" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd ir gy z fp mr fr fs ms fu fw ip bi translated">tpakis/异常示例</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">github.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na jw mm"/></div></div></a></div><h1 id="2f30" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">救援导航组件</h1><p id="7430" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">主要思想是应该有3个不同的导航图，AB测试的每个变化(基线，变化1，变化2)一个。每个导航图将包含4个目的地(根据我们之前描述的测试场景，但是它可以是任何数量，甚至在变化之间也不相同)，它们是片段，以及连接目的地的3个动作。为了帮助可视化，我从android studio导航编辑器中截取了一些截图。目的片段是彩色方框，动作是箭头。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/c1e91583d5b45c4dc08e586172cca25d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WU8IY1w3HWT5HmadiXjiJw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">AB测试基线导航图</figcaption></figure><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/fde66dca7ab4625eff2708687565bee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t56fPR_lblrzeBKcedlbhg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">第一个变体的导航图</figcaption></figure><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/92f1365a748a204078502c1b118fa6a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hD-SgwpxNipS_V3usAJNxQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">AB测试第二种变化的导航图。请注意，第一步和第三步与第一步相同，但顺序不同(第三步现在是第一步，反之亦然)</figcaption></figure><p id="15f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个<strong class="kf ir">不同的(有些是变体之间共享的)</strong>片段都有不同的类和XML布局文件。在实际场景中，这对于清理目的来说非常有效，因为这是一个A/B测试，在测试结束时，我们将删除所有没有通过的片段类和布局文件，而不用担心对获胜者变体的重构。</p><p id="df22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">A/B测试特性的托管活动<em class="nc">(项目中的ABTestActivity)</em>需要知道要膨胀哪个导航图。在一个大项目中，我们希望注入这些信息，但是为了简单起见，现在有一个枚举类ABTestVariation，并且适当的变化与活动的启动意图一起传递:</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cfcd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种方法非常简单，看起来也很干净，但是有一个很大的挑战。为了在片段之间导航，您必须指定您想要导航到的目的地或者您应该采取的动作，这两者都需要一个id:</p><pre class="mf mg mh mi gt nf ng nh ni aw nj bi"><span id="4154" class="nk lc iq ng b gy nl nm l nn no">findNavController().navigate(R.id.action_b_to_a)</span></pre><p id="c283" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们在3个不同的XML导航图中有4个不同的目的地和3个不同的动作，我们如何知道在处理它们的活动中使用哪个id呢？看起来我们又陷入了whens和if的陷阱，或者片段应该以某种方式获取这些信息并将其传递回父活动，这也不是很好。</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="170d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，经过大量的试验和错误，尝试多种方法，终于有了<strong class="kf ir">发现</strong>的时刻！不同图中的目的地id不必不同，甚至在同一导航图中的动作id也不必不同！这意味着我们可以用<strong class="kf ir"> id将每个动作命名为next </strong>，然后活动将尝试导航到… next！！如果这个动作不存在，那就意味着我们到达了图的末端！那太容易了！</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="ca2d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试后的清理也非常简单，只需删除片段、它们的布局和导航图(如果你愿意，让活动膨胀相同的图，而不传递这个信息)。</p><p id="e4ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">A/B测试快乐！</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="np ne l"/></div></figure></div></div>    
</body>
</html>
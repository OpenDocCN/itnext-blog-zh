<html>
<head>
<title>OTPfy — Securing Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OTPfy —保护应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/otpfy-securing-applications-6dd249444338?source=collection_archive---------4-----------------------#2021-03-25">https://itnext.io/otpfy-securing-applications-6dd249444338?source=collection_archive---------4-----------------------#2021-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b8721adb674935e8e3c00f234db660f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wLuHC25Xv3GGo39BwYH8A.png"/></div></div></figure><p id="c48d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>是最近才出来的全新产品。一个软件即服务平台，您将能够生成一次性密码和神奇的链接，以保护您的应用程序流。工程时间是宝贵的，保护您的应用程序流可能既具有挑战性又非常耗时。使用OTPfy，您可以轻松保护应用程序的任何部分，而不会浪费更多的时间和资源。</p><p id="3e4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我将指导您完成使用<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>保护您的应用程序的步骤，在文章结束时，您将熟悉OTP密钥、Magic Link密钥和<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>，我们将通过Node.js使用它们。</p><h1 id="117c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤1:在<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>中创建一个团队</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/9c0e95309e7511c38f40035b1dee4d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZLH2vEoBLCm7lupW.png"/></div></div></figure><p id="b9d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">进入<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank">https://otpfy.com</a>，然后点击右上角的<code class="fe ma mb mc md b">sign up</code>按钮。这将带您进入注册表单以创建个人帐户。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/aba7d981a998618894b2377bbb238e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/0*n7cy7olBmIplvOV2.png"/></div></figure><p id="397c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们填写表格，用您的个人数据创建一个帐户。</p><p id="da32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">填写表格后，您的个人帐户将被创建，我们可以继续创建OTPfy团队。点击右上角的<code class="fe ma mb mc md b">Create team</code>粉色按钮，它会带你到这个表格，在这里你会被提示填写你的公司数据。如果您决定以后使用付费许可证，所有这些数据都将用于计费。OTPfy中的所有团队都有一个<code class="fe ma mb mc md b">Free</code>许可证，这个许可证足以开始开发您的应用程序，并在开发时保护您的流程。稍后，您可以根据需要使用付费许可来增加团队的限制。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/68ccde30673ba261b68a548d1695b85b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*zJHVfDW6rDtgpdT0.png"/></div></figure><p id="78d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">填写完表格后，您的团队将准备就绪，并会将您重定向到您的仪表板，您可以开始使用<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>进行工作。让我们看看您团队在第2步中的仪表盘。</p><h1 id="0b68" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第2步:仪表板概述</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/adb1de464e6eac61bd7fe6000d0857f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-gij73NG5rrZrcGt.png"/></div></div></figure><p id="59b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是您团队的仪表板。在这里，您可以获得关于您的OTP和Magic Links如何运行的概述，以及团队许可证使用情况的快速概述。</p><p id="cdb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从左到右描述导航菜单:</p><ul class=""><li id="97ae" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir">仪表板</strong>:获取您团队的概览&amp;见解。</li><li id="46bf" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">团队</strong>:在这个页面中，您可以更新您的团队详细信息，添加和删除团队成员以及您的个人通知。在OTPfy中，通知是在每个团队的基础上处理的，这意味着您可以独立地定制每个团队的通知。</li><li id="21cc" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">密钥</strong>:这是您将生成OTP密钥和魔法链接密钥的页面。这些密钥是OTPfy的基石，通过这些密钥，您可以为您的用户、应用程序和流程生成OTP代码和神奇链接。</li><li id="5a35" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">模板</strong>:在这里您将能够生成和配置模板，这些模板将被发送给请求OTP或神奇链接的用户。模板是完全可定制的HTML，你可以使用默认的或得到创造性的。</li><li id="8a6f" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">许可证</strong>:这个页面会显示你当前团队的许可证(免费&amp;无限制)，你可以升级到任何付费许可证:<code class="fe ma mb mc md b">PRO</code>、<code class="fe ma mb mc md b">STARTUP</code>或<code class="fe ma mb mc md b">BUSINESS</code>。订阅后，您可以在期限结束时取消您的许可证，或者如果您已经取消了它，请重新启用它。请记住，所有年度许可证都有20%的折扣！此外，在此页面上，您将能够查看您生成的发票或支付到期发票。</li><li id="8185" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">付款详情</strong>:在这里您可以更新您的付款详情，以防您因信用卡过期或其他相关原因而需要。</li></ul><p id="ed07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">个人资料下拉导航</p><ul class=""><li id="ce9a" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir">账户设置</strong>:更新您的个人信息，如图片、名字、姓氏和电话。</li><li id="486c" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">改变团队</strong>:选择一个不同的团队和你一起工作。</li><li id="a94b" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">支持</strong>:访问支持系统来报告你可能遇到的任何问题(希望你不用用这么多！)</li><li id="16db" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">登出</strong>:关闭您在OTPfy的会话。</li></ul><h1 id="8e5c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤3:为OTP密钥创建模板。</h1><p id="c463" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">您需要做的第一件事是创建一个模板。让我们开始吧！转到<code class="fe ma mb mc md b">Templates</code>页面，点击出现在页面右侧的<code class="fe ma mb mc md b">Create template</code>粉色按钮，这将显示一个模式窗口，其中包含以下要填写的字段:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/f3d2b56a05f5c87b33f24535d5992e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/0*_qsk34Okv4KTMko7.png"/></div></figure><p id="74c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建过程完成后，您将被带到<code class="fe ma mb mc md b">Template Edition</code>页面，在这里您可以更新之前的详细信息并访问HTML模板编辑器。你也可以预览你的HTML模板将会是什么样子！</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/b679c4f9859ee9a1bcc3e2c7ec8a9f06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZMxqmL0RVy5y8fG7.png"/></div></div></figure><h1 id="18ce" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤4:创建OTP密钥</h1><p id="0a8d" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">接下来要做的事情是创建一个OTP密钥，这个密钥将允许您使用在这个密钥上设置的配置来生成一个用于保护流的OTP。点击<code class="fe ma mb mc md b">Keys</code>导航菜单进入<code class="fe ma mb mc md b">Keys</code>页面，在这里您可以大致了解<code class="fe ma mb mc md b">OTPs</code>和<code class="fe ma mb mc md b">Magic Links</code>按键的操作情况。点击<code class="fe ma mb mc md b">OTP</code>二级导航元素。您将看到一个带有精美插图空白页面，告诉您还没有创建任何OTP密钥。让我们点击页面右侧的<code class="fe ma mb mc md b">Add OTP key</code>粉色按钮。此操作将显示一个模式窗口，其中有一个表单，您可以在其中配置此OTP密钥的行为方式:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/9da34923323f80ebe3b8bbd26e93d11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0mADrQqlQnxgPPyH.png"/></div></div></figure><p id="2d2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们详细了解一下配置:</p><ul class=""><li id="f330" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir">密钥标识符</strong>:这个密钥标识符是您将在<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>上使用的，以告知将使用哪个OTP密钥，它将从。</li><li id="154c" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">名称</strong>:仪表板上用于识别的按键名称。</li><li id="c85e" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">描述</strong>:仪表板上用于识别的关键描述。</li><li id="1cca" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">模板</strong>:在这里您将选择我们之前在步骤3中创建的模板。</li><li id="12f5" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">码长</strong>:该码的字符长度，可以输入6到24之间的任意数字。</li><li id="6547" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">到期时间(秒)</strong>:动态口令生成后有效的秒数，可以输入60到300之间的任意秒数。</li><li id="e028" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">颜色</strong>:仪表板上用于识别的关键颜色。</li><li id="584e" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">附加配置</strong>:</li><li id="6d24" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">使用数字</strong>:该设置将告诉OTPfy在生成的OTP上包含数字。</li><li id="3f7b" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">使用大写字符</strong>:该设置将告诉OTPfy在生成的OTP中包含大写字符。</li><li id="8c22" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">使用特殊字符</strong>:该设置将告诉OTPfy在生成的OTP中包含特殊字符。</li></ul><p id="46fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成数据设置后，点击<code class="fe ma mb mc md b">Add OTP key</code>按钮生成该密钥，并能够通过<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>使用它。</p><p id="7da4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你很好奇，你可以点击你的全新<code class="fe ma mb mc md b">OTP key</code>的<code class="fe ma mb mc md b">More details</code>按钮，以获得关于这个<code class="fe ma mb mc md b">OTP key</code>如何表现的具体细节。</p><h1 id="1e5f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤5:获取您团队的私钥</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/6e3e61d1e3ece4edf858f1b3959df8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KkYiggF0MFW6_G9W.png"/></div></div></figure><p id="59cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您导航到您的<code class="fe ma mb mc md b">Team</code>页面并访问<code class="fe ma mb mc md b">Details</code>选项卡，您将在详细信息的底部看到一个写有<code class="fe ma mb mc md b">Private key</code>的部分。要显示您的私人密钥，请单击该行右侧的<code class="fe ma mb mc md b">Reveal private key</code>白色按钮，这将显示您唯一的团队私人密钥，如果您再次单击该按钮，它将自动复制到您的剪贴板。</p><h1 id="9c24" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤6:安装<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a></h1><p id="2320" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">下一步是在Node.js应用程序中安装<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>(目前我们只发布了Node SDK，但我们正在努力为任何后端语言发布更多SDK！).</p><p id="ebd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过控制台访问您的项目，并键入:</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="b917" class="ne ky iq md b gy nf ng l nh ni">yarn add @otpfy/sdk</span></pre><p id="2869" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在您的后端应用程序中安装<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>。该模块需要使用<code class="fe ma mb mc md b">node-fetch</code>作为依赖项，但它没有与SDK捆绑在一起，以避免增加捆绑包的大小。这意味着您将不得不单独安装<code class="fe ma mb mc md b">node-fetch</code>作为后端项目的依赖项。</p><h1 id="f482" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤7: SDK初始化</h1><p id="46f1" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">为了成功初始化，您的团队私有密钥需要作为唯一的参数传递给初始化函数。确保这个私钥总是安全可靠的，这样就没有人能够代表您的团队提出请求。</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="8b7a" class="ne ky iq md b gy nf ng l nh ni">import sdk from '@otpfy/sdk';</span><span id="382f" class="ne ky iq md b gy nj ng l nh ni">const otpfy = sdk('TEAM_PRIVATE_KEY');</span></pre><h1 id="481d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤8:动态口令生成</h1><p id="d5c0" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">访问您希望生成动态口令的应用程序的任何流程，并粘贴下面的代码，您将对其进行一些修改。</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="5b38" class="ne ky iq md b gy nf ng l nh ni">const generateResponse = await otpfy.generateOTP({<br/>  email: 'me@gmail.com',<br/>  external_identifier: '978c324ab78dd92',<br/>  key: 'AUTH'<br/>});</span></pre><p id="94b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该代码将告诉<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>使用以下配置生成一个OTP:</p><ul class=""><li id="10ec" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir"> email </strong>:将要生成的OTP的收件人邮箱。</li><li id="accc" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir"> external_identifier </strong>:您必须提供的惟一ID，以便为特定用户或流惟一地标识这个OTP。通常，按照这个例子，这将是在您的数据库上生成的用户标识符。</li><li id="f84e" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">密钥</strong>:您之前在生成OTP密钥时使用的<em class="nk">密钥标识符</em>。这将采用您之前设置的所有配置。</li></ul><p id="0763" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">generateResponse</code>变量将是一个具有以下形状的对象:</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="792f" class="ne ky iq md b gy nf ng l nh ni">type GenerateResponse = {<br/>  status: number;<br/>  code: string;<br/>  identifier: string;<br/>  message?: string;<br/>};</span></pre><p id="4226" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">status</code>属性将包含操作的状态代码，如果成功是<code class="fe ma mb mc md b">OK</code>或<code class="fe ma mb mc md b">400</code>到<code class="fe ma mb mc md b">500</code>，则可能是200，这取决于发生的错误。<br/><code class="fe ma mb mc md b">code</code>属性将包含一个消息表单OTPfy，告诉发生了什么，如果一切正常，可能包含一个类似于<code class="fe ma mb mc md b">SUCCESS</code>的消息，或者包含一个类似于<code class="fe ma mb mc md b">BAD_REQUEST</code>或<code class="fe ma mb mc md b">UNEXPECTED_ERROR</code>的消息，这取决于是什么导致了它。<br/><code class="fe ma mb mc md b">identifier</code>属性是您必须存储的内容，以便稍后验证您刚刚生成的OTP。<br/>如果状态不是200，就会出现<code class="fe ma mb mc md b">message</code>属性，它会告诉你更多关于错误原因的信息。</p><h1 id="fd11" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤9:动态口令验证</h1><p id="d1a3" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">对您的应用程序的任何流的访问，您想要检查的OTP是从您的用户处接收的，并粘贴下面的代码，您将对其进行一些修改。</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="44fb" class="ne ky iq md b gy nf ng l nh ni">const verifyResponse = await otpfy.verifyOTP({<br/>  code: '45$6AFd65',<br/>  external_identifier: '978c324ab78dd92',<br/>  key: 'AUTH',<br/>  identifier: '123cb8945bd0943'<br/>});</span></pre><p id="d06b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该代码将告诉<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>使用以下配置验证OTP:</p><ul class=""><li id="4fe9" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir">代码</strong>:用户通过邮件收到的代码。</li><li id="449c" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir"> external_identifier </strong>:你方提供的唯一标识符，用于标识此神奇链接。通常这可能是您的用户ID或一些唯一的标识符。</li><li id="d0d4" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">密钥</strong>:您之前在生成OTP密钥时使用的<em class="nk">密钥标识符</em>。这将采用您之前设置的所有配置。</li><li id="7ab8" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">标识符</strong>:从<code class="fe ma mb mc md b">otpfy.generateOTP</code>函数返回的标识符。</li></ul><p id="724b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">verifyResponse</code>变量将是一个具有以下形状的对象:</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="5022" class="ne ky iq md b gy nf ng l nh ni">type VerifyResponse = {<br/>  status: number;<br/>  code: string;<br/>  message?: string;<br/>};</span></pre><p id="0cad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">status</code>属性将包含操作的状态代码，如果成功是<code class="fe ma mb mc md b">OK</code>或<code class="fe ma mb mc md b">400</code>到<code class="fe ma mb mc md b">500</code>则可能是200，这取决于发生的错误。<br/><code class="fe ma mb mc md b">code</code>属性将包含一个消息表单OTPfy，告知发生了什么，如果一切正常，可能包含一个类似于<code class="fe ma mb mc md b">SUCCESS</code>的消息，或者包含一个类似于<code class="fe ma mb mc md b">BAD_REQUEST</code>或<code class="fe ma mb mc md b">UNEXPECTED_ERROR</code>的消息，这取决于是什么导致了它。<br/>如果状态不同于200，则<code class="fe ma mb mc md b">message</code>属性将会出现，并告诉您关于导致错误的原因的更多信息。</p><p id="fdd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果<code class="fe ma mb mc md b">verifyResponse.status</code>等于<code class="fe ma mb mc md b">200</code>将意味着用户和代码的真实性，并且该过程是成功的，您可以授予该人访问他们试图安全访问的任何内容的权限。</p><h1 id="f866" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤10.1:创建神奇链接密钥(可选)</h1><p id="4769" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">Magic Link key密钥将允许您生成一个Magic Link，以便使用您在此密钥上设置的配置来保护流。点击<code class="fe ma mb mc md b">Keys</code>导航菜单进入<code class="fe ma mb mc md b">Keys</code>页面，在这里你可以大致了解<code class="fe ma mb mc md b">OTPs</code>和<code class="fe ma mb mc md b">Magic Links</code>按键的操作情况。点击<code class="fe ma mb mc md b">MAgic Link</code>二级导航元素。您将看到一个带有精美插图空白页面，告诉您还没有创建任何Magic Link key。让我们点击本页右侧的<code class="fe ma mb mc md b">Add Magic Link</code>粉色按钮。此操作将显示一个模式窗口，其中有一个表单，您可以在其中配置此神奇链接键的行为方式:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/23f8a1cc12ec93ba74d53422896786f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ueeLiM2bMuu0e67q.png"/></div></div></figure><p id="99ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们详细了解一下配置:</p><ul class=""><li id="3545" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir">密钥标识符</strong>:这个密钥标识符是您将在<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>上使用的，以告知将使用哪个Magic Link密钥，它将从。</li><li id="1997" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">名称</strong>:仪表板上用于识别的按键名称。</li><li id="25e1" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">描述</strong>:仪表板上用于识别的关键描述。</li><li id="e003" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">模板</strong>:在这里你将选择我们之前在步骤3中创建的模板。</li><li id="1412" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">到期时间(秒)</strong>:魔法链接生成后有效的秒数，可以输入60到300之间的任意秒数。</li><li id="209a" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">颜色</strong>:仪表板上用于识别的关键颜色。</li></ul><p id="defb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成数据设置后，单击<code class="fe ma mb mc md b">Add Magic Link</code>按钮生成该密钥，并能够通过<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>使用它。</p><p id="182e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你很好奇，你可以点击你的全新<code class="fe ma mb mc md b">Magic Link key</code>的<code class="fe ma mb mc md b">More details</code>按钮，以获得关于这个<code class="fe ma mb mc md b">Magic Link key</code>如何表现的具体细节。</p><h1 id="8bed" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤10.2:神奇链接生成(可选)</h1><p id="cb21" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">为了生成一个新的保护特定流的神奇链接，您需要导入<a class="ae kw" href="https://otpfy.com/docs/node" rel="noopener ugc nofollow" target="_blank"> OTPfy SDK </a>，初始化它，然后调用<code class="fe ma mb mc md b">optfy.generateMagicLink</code>方法。</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="4d87" class="ne ky iq md b gy nf ng l nh ni">import sdk from '@otpfy/sdk';</span><span id="0d0a" class="ne ky iq md b gy nj ng l nh ni">const otpfy = sdk('TEAM_PRIVATE_KEY');</span><span id="7373" class="ne ky iq md b gy nj ng l nh ni">const generateResponse = await otpfy.generateMagicLink({<br/>  email: 'me@gmail.com',<br/>  external_identifier: '978c324ab78dd92',<br/>  key: 'AUTH',<br/>  callbacks: {<br/>    success: 'https://myapp.com/authentication/success?id=123123123'<br/>    error: 'https://myapp.com/authentication/error?id=123123123'<br/>  }<br/>});</span></pre><p id="e1f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这段代码将告诉<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>使用以下配置生成一个神奇的链接:</p><ul class=""><li id="0fa5" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><strong class="ka ir">电子邮件</strong>:根据您在OTPfy仪表板上创建和选择的模板，将向该目标电子邮件发送一封电子邮件，其中包含生成的神奇链接。</li><li id="7aae" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir"> external_identifier </strong>:你方提供的唯一标识符，用于标识此神奇链接。通常这可能是您的用户ID或一些唯一的标识符。</li><li id="4f68" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">密钥</strong>:您之前在Magic Link密钥生成中使用的<em class="nk">密钥标识符</em>。这将采用您之前设置的所有配置。</li><li id="c7a2" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">回调</strong>:如果验证成功或失败，这两个属性将用于将用户重定向到应用程序的特定部分。</li><li id="c7cb" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">成功</strong>:如果魔术链接验证成功，用户将被重定向到的URL。</li><li id="24d8" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><strong class="ka ir">错误</strong>:如果魔法链接验证错误，用户将被重定向到的URL。</li></ul><p id="c82b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>生成神奇的链接非常简单，您甚至可以定制回调来传递您在重定向用户时需要的任何数据(比如试图验证的用户id或其他任何东西)。</p><h1 id="fd74" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤11:使用SDK检查您团队的许可证(可选)</h1><p id="c05d" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">您可以使用OTPfy SDK中的这个简便方法来检查您团队的当前许可状态。</p><pre class="lw lx ly lz gt na md nb nc aw nd bi"><span id="a421" class="ne ky iq md b gy nf ng l nh ni">const licenseStatus = await otpfy.checkLicense();</span></pre><p id="a142" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">licenseStatus</code>将保存具有以下任何值和含义的字符串文字:</p><ul class=""><li id="60ff" class="mg mh iq ka b kb kc kf kg kj mi kn mj kr mk kv ml mm mn mo bi translated"><code class="fe ma mb mc md b">VALID_LICENSE</code>:您当前的许可证是有效的，您可以使用并访问任何<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>服务。</li><li id="71dc" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><code class="fe ma mb mc md b">UNAUTHORIZED</code>SDK初始化时提供的团队私钥无效，因此您无权检查许可证状态。</li><li id="1413" class="mg mh iq ka b kb mp kf mq kj mr kn ms kr mt kv ml mm mn mo bi translated"><code class="fe ma mb mc md b">TEAM_BLOCKED</code>:由于一张过期未付的发票，您的团队目前被禁止使用<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>服务。请访问您在<a class="ae kw" href="https://otpfy.com/license" rel="noopener ugc nofollow" target="_blank">https://otpfy.com/license</a>的仪表盘，继续支付发票款项，以便解锁许可证并继续使用<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>服务。</li></ul><p id="eda0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望大家喜欢这篇文章，并开始使用<a class="ae kw" href="https://otpfy.com/" rel="noopener ugc nofollow" target="_blank"> OTPfy </a>保护您的应用程序流！</p></div></div>    
</body>
</html>
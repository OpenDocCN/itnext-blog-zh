<html>
<head>
<title>An Introduction of a Microservices with ASP.net core 3x(Part-2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ASP.net core 3x微服务介绍(下)</h1>
<blockquote>原文：<a href="https://itnext.io/an-introduction-of-a-microservices-with-asp-net-core-3x-part-2-628acc712a85?source=collection_archive---------3-----------------------#2020-05-23">https://itnext.io/an-introduction-of-a-microservices-with-asp-net-core-3x-part-2-628acc712a85?source=collection_archive---------3-----------------------#2020-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="40a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在您继续之前…</p><p id="6a20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们希望开始编写代码，并将我们的微服务部署到Amazon Web Services。所以你需要准备一些东西。</p><p id="8202" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一步:准备好源代码控制系统。拥有一个源代码控制系统最简单的方法就是在https://github.com<a class="ae kl" href="https://github.com/" rel="noopener ugc nofollow" target="_blank">的GitHub注册一个免费账户。</a></p><p id="4632" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:</strong>安装。NET Core SDK。它可以是任何。网芯SDK只要不是。Net Core 3.0或3.1 <br/>安装Visual Studio 2017或更高版本</p><p id="5d82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三步:在AWS(<a class="ae kl" href="https://aws.amazon.com/free" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/free</a>)创建一个免费账户。您将需要此帐户来部署您的微服务。</p><p id="8c2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您没有联系第1部分，请点击下面的链接。<br/>(关于微服务架构和单片应用/架构及问题的介绍。)<br/>采用ASP.net酷睿3x的微服务介绍(第一部分)<br/><a class="ae kl" href="https://qiita.com/alokrawat050/items/66a512dc840827107260" rel="noopener ugc nofollow" target="_blank">https://qiita.com/alokrawat050/items/66a512dc840827107260</a></p><p id="87f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这一部分，我们将进行注册，确认电子邮件，并将使用AWS设置。<br/>让我们创建一个项目文件，并将进行AWS Cognito设置部分:</p><p id="512c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一步:打开you vs代码，创建一个. net核心应用。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/8696d638b737029792cd53c4728965d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DjGptGjQkeQbL3Wh"/></div></div></figure><p id="5934" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">1————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ky"><img src="../Images/76924d678140c88267f4df52ce00614f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MzTzJyv76dHmEJh3"/></div></div></figure><p id="580b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">2————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kz"><img src="../Images/149be082a78ed8a5df03373a2c19b9e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*csgAcQYyLoEWj5kn"/></div></div></figure><p id="7997" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">3————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi la"><img src="../Images/84c577d431d9ac62c41b7de97137b849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*92r-9pKc_cq7GCWc"/></div></div></figure><p id="c755" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:在</strong>项目中添加几个AWS包<br/>进入“<strong class="jp ir">项目</strong>”-&gt;“<strong class="jp ir">管理NuGet包……</strong>”</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/c96c8df9ad9c8afe76a2acc7bd0ef7ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/0*cvoQic18Fx8Wh-Vn"/></div></figure><p id="7d22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后搜索“<strong class="jp ir">亚马逊。AspNetCore . identity . cognito</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/e8e24acb31a5fdd6134911552a0bf243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4yyzXaFF6jBX0aQh"/></div></div></figure><p id="eeb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后搜索“<strong class="jp ir">亚马逊。扩展. CognitoAuthentication </strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ld"><img src="../Images/e7ec52ea03ef97dcb9c543a302467d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NC8g3G71SmqrG44W"/></div></div></figure><p id="522f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三步:在AWS </strong> <br/>中创建一个新用户这里我已经创建了一个名为“<strong class="jp ir"> ad_word_user </strong>的新用户</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/1e70d5c3b0741ee134eff07cf87da830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CuSBnQUYmPLsG_4U"/></div></div></figure><p id="abbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">1————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lf"><img src="../Images/a6dd0e6173eac2738e007aced49a83f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5gaLTr75CXKobpzK"/></div></div></figure><p id="11ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">2————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/5d8fb87fbdf7d51bf7d38521a18f3e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dYJnu5O8joko2Tgw"/></div></div></figure><p id="20eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在设置一个新的权限，<strong class="jp ir">Amazon cognitodeveloperauthenticatedidentities</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/168fe59c86bb5443a4f357e0290d476a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*20VhZH2jn8p45y8X"/></div></div></figure><p id="2566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四步:设置AWS认知到</strong> <br/>从您的仪表板中搜索<strong class="jp ir">认知到</strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lg"><img src="../Images/79ce75e073c9f444a9e1ac30bb57368e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BEgmAAHLDhzJ2s0H"/></div></div></figure><p id="256a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">3————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lh"><img src="../Images/1e2ba93a4ebe8bd755486f26a5ad2bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ec6zQWarAi9KVQfB"/></div></div></figure><p id="6208" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">4————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/ee402e92404c864930d07cfe46068e64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dXHaCoyoG34_K9Ia"/></div></div></figure><p id="7694" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">&lt;: — — — — — — — — — — — — — — -5— — — — — — — — — — — — — -:&gt;</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/8c402e2458d116ef6a86b3b55be44c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wvThzHaodKBcjKrm"/></div></div></figure><p id="01bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">6————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/a91e872778c90194cd87a0494ee2f1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rKtB_n0zq8kWFOjm"/></div></div></figure><p id="f70e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">7————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi li"><img src="../Images/3b923e1d12e289175a3a4b61f8dd31b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AhVOA0evqmL36Ej4"/></div></div></figure><p id="ce8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">8————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/53bc000383e304a62c3e8e1dadfa84ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YtSXJCzrqhxk8Q2I"/></div></div></figure><p id="10ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">9————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/4b0f29ea97d791535abadaeba0680841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Oy8lS_LCMAtBRHMF"/></div></div></figure><p id="0db4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">10————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lj"><img src="../Images/bffaf1dfa16735d095e66acff90bc9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3Q9vQOgk2NP3T0j6"/></div></div></figure><p id="65cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">11————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/6445f0fd766e97492b4a9bd9728423a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*brdvGZjk-iNrmuTs"/></div></div></figure><p id="c3ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">1<strong class="jp ir">2</strong>————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lk"><img src="../Images/800910ecc8ce55d4c42b2fd8a72ac149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*89ebZ52WYHxsBkqg"/></div></div></figure><p id="89a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">13————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/067bcfa9cb09ddd6a2112e33ffba3914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tGA6K6pMkEfd6kKV"/></div></div></figure><p id="e9b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第五步:新建一个app客户端</strong> <br/>新建一个App客户端，复制<strong class="jp ir"> app_client_id </strong>和<strong class="jp ir"> app_client_secret </strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/fbf1e56828d1b707182318e6767f2a89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b0Tv8as2WPLMHCDA"/></div></div></figure><p id="e74b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">1————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ll"><img src="../Images/534b63e4083085bd61473aa20b46bffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*akMBU2v_3CsHg8rg"/></div></div></figure><p id="666d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><: class="jp ir">2————&gt;</:></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lm"><img src="../Images/ac0c50f203e299218ebf506a6ee1fa19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xbGNwikCWBIuI1jT"/></div></div></figure><p id="7931" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第六步:设置app客户端ID和客户端密码</strong> <br/>打开文件<strong class="jp ir"> appsettings.json </strong>复制以下代码粘贴到你的文件中。</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="84c0" class="ls lt iq lo b gy lu lv l lw lx">{<br/>  "Logging": {<br/>    "LogLevel": {<br/>      "Default": "Information",<br/>      "Microsoft": "Warning",<br/>      "Microsoft.Hosting.Lifetime": "Information"<br/>    }<br/>  },<br/>  "AllowedHosts": "*",<br/>  "AWS": {<br/>    "Region": "&lt;YOUR_REGION&gt;",<br/>    "UserPoolClientId": "&lt;YOUR_CLIENT_ID&gt;",<br/>    "UserPoolClientSecret": "&lt;YOUR_CLIENT_SECRET&gt;",<br/>    "UserPoolId": "&lt;YOUR_POOL_ID&gt;"<br/>  }<br/>}</span></pre><p id="cbcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">用户池Id </strong>，</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/3e6dde1ace919b21f527f082b5a79142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0I2iYu0bk7obasMK"/></div></div></figure><p id="b723" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第七步:在以下目录下创建以下文件:</strong> <br/> ■。在<strong class="jp ir">控制器</strong>目录下，创建一个<strong class="jp ir"> Accounts.cs </strong>控制器。</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="b74e" class="ls lt iq lo b gy lu lv l lw lx">right-click on Controllers directory<br/>   add -&gt; new file<br/>   ASP.NET Core -&gt; MVC Controller Class</span></pre><p id="93c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">■.在<strong class="jp ir"> Models </strong>目录下，新建一个名为<strong class="jp ir"> Accounts </strong>的目录，在新建的目录下，新建两个模型文件<strong class="jp ir"> ConfirmModel.cs </strong>和<strong class="jp ir"> SignupModel.cs </strong></p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="2e39" class="ls lt iq lo b gy lu lv l lw lx">right-click on Models directory<br/>   add -&gt; new folder -&gt; [Accounts]</span><span id="fb52" class="ls lt iq lo b gy ly lv l lw lx">   then right-click on the newly created directory, called Accounts<br/>   add -&gt; new class<br/>   General -&gt; Empty Class</span></pre><p id="66b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">■.在<strong class="jp ir">视图</strong>目录中，创建一个名为<strong class="jp ir"> Accounts </strong>的新目录，并在新创建的目录中创建两个模型文件<strong class="jp ir"> Confirm.cshtml </strong>和<strong class="jp ir"> Signup.cshtml </strong></p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="787a" class="ls lt iq lo b gy lu lv l lw lx">right-click on Views directory<br/>   add -&gt; new folder -&gt; [Accounts]</span><span id="418f" class="ls lt iq lo b gy ly lv l lw lx">   then right-click on newly created directory, called Accounts<br/>   add -&gt; new file<br/>   ASP.NET Core -&gt; Razor Page</span></pre><p id="ae2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第八步:<strong class="jp ir"> Accounts.cs </strong>文件中的编码:</strong>T63，</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="f916" class="ls lt iq lo b gy lu lv l lw lx">using System.Threading.Tasks;<br/>using Amazon.AspNetCore.Identity.Cognito;<br/>using Amazon.Extensions.CognitoAuthentication;<br/>using Microsoft.AspNetCore.Identity;<br/>using Microsoft.AspNetCore.Mvc;<br/>using WebAdWord.Models.Accounts;</span><span id="36f7" class="ls lt iq lo b gy ly lv l lw lx">public class Accounts : Controller<br/>    {<br/>        private readonly SignInManager&lt;CognitoUser&gt; _signInManager;<br/>        private readonly UserManager&lt;CognitoUser&gt; _userManager;<br/>        private readonly CognitoUserPool _pool;</span><span id="4fcd" class="ls lt iq lo b gy ly lv l lw lx">        public Accounts(SignInManager&lt;CognitoUser&gt; signInManager, UserManager&lt;CognitoUser&gt; userManager, CognitoUserPool pool)<br/>        {<br/>            _signInManager = signInManager;<br/>            _userManager = userManager;<br/>            _pool = pool;<br/>        }<br/>    }</span><span id="982a" class="ls lt iq lo b gy ly lv l lw lx">public async Task&lt;IActionResult&gt; Signup()<br/>        {<br/>            var model = new SignupModel();<br/>            return View(model);<br/>        }</span><span id="6a22" class="ls lt iq lo b gy ly lv l lw lx">[HttpPost]<br/>        public async Task&lt;IActionResult&gt; Signup(SignupModel model)<br/>        {<br/>            if (ModelState.IsValid)<br/>            {<br/>                var user = _pool.GetUser(model.Email);<br/>                if (user.Status != null)<br/>                {<br/>                    ModelState.AddModelError("UserExists", "User with this email alred exits");<br/>                    return View(model);<br/>                }</span><span id="c453" class="ls lt iq lo b gy ly lv l lw lx">                user.Attributes.Add(CognitoAttribute.Name.AttributeName, model.Email);<br/>                var createdUser = await _userManager.CreateAsync(user, model.Password).ConfigureAwait(false);</span><span id="1fc9" class="ls lt iq lo b gy ly lv l lw lx">                if (createdUser.Succeeded)<br/>                {<br/>                    RedirectToAction("Confirm");<br/>                }<br/>            }<br/>            return View();<br/>        }</span><span id="e841" class="ls lt iq lo b gy ly lv l lw lx">[HttpGet]<br/>        public async Task&lt;IActionResult&gt; Confirm(ConfirmModel model)<br/>        {            <br/>            return View(model);<br/>        }</span><span id="7522" class="ls lt iq lo b gy ly lv l lw lx">        [HttpPost]<br/>        [ActionName("Confirm")]<br/>        public async Task&lt;IActionResult&gt; Confirm_Post(ConfirmModel model)<br/>        {<br/>            if (ModelState.IsValid)<br/>            {<br/>                var user = await _userManager.FindByEmailAsync(model.Email).ConfigureAwait(false);<br/>                if (user == null)<br/>                {<br/>                    ModelState.AddModelError("NotFound", "A user with the given email address was not found.");<br/>                    return View(model);<br/>                }</span><span id="b6ea" class="ls lt iq lo b gy ly lv l lw lx">                var result = await (_userManager as CognitoUserManager&lt;CognitoUser&gt;).ConfirmSignUpAsync(user, model.Code, true).ConfigureAwait(false);<br/>                if (result.Succeeded)<br/>                {<br/>                    return RedirectToAction("Index", "Home");<br/>                }<br/>                else<br/>                {<br/>                    foreach(var item in result.Errors)<br/>                    {<br/>                        ModelState.AddModelError(item.Code, item.Description);<br/>                    }</span><span id="9491" class="ls lt iq lo b gy ly lv l lw lx">                    return View(model);<br/>                }<br/>            }</span><span id="a744" class="ls lt iq lo b gy ly lv l lw lx">            return View(model);<br/>        }</span></pre><p id="512a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上所有代码属于⬇︎ <br/> <strong class="jp ir">公共类账户:控制人{ <br/> —此处— <br/> } </strong></p><p id="6c4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<strong class="jp ir">模型/账户/SignupModel.cs </strong>文件中，</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="87d6" class="ls lt iq lo b gy lu lv l lw lx">using System.ComponentModel.DataAnnotations;</span><span id="fdb7" class="ls lt iq lo b gy ly lv l lw lx">namespace WebAdWord.Models.Accounts<br/>{<br/>    public class SignupModel<br/>    {<br/>        [Required]<br/>        [EmailAddress]<br/>        [Display(Name ="Email")]<br/>        public string Email{ get; set; }</span><span id="e0ec" class="ls lt iq lo b gy ly lv l lw lx">        [Required]<br/>        [DataType(DataType.Password)]<br/>        [StringLength(8, ErrorMessage ="Password must be at least six characters long!")]<br/>        [Display(Name ="Password")]<br/>        public string Password { get; set; }</span><span id="dead" class="ls lt iq lo b gy ly lv l lw lx">        [Required]<br/>        [DataType(DataType.Password)]<br/>        [Compare("Password", ErrorMessage ="Password and its confirmation do not match")]<br/>        public string ConfirmPassword { get; set; }</span><span id="d7cc" class="ls lt iq lo b gy ly lv l lw lx">        public SignupModel()<br/>        {<br/>        }<br/>    }<br/>}</span></pre><p id="3765" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<strong class="jp ir">模型/账户/确认模型. cs </strong>文件中，</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="1921" class="ls lt iq lo b gy lu lv l lw lx">using System.ComponentModel.DataAnnotations;</span><span id="9c55" class="ls lt iq lo b gy ly lv l lw lx">namespace WebAdWord.Models.Accounts<br/>{<br/>    public class ConfirmModel<br/>    {<br/>        [Required(ErrorMessage = "Email is required.")]<br/>        [Display(Name ="Email")]<br/>        [EmailAddress]<br/>        public string Email { get; set; }</span><span id="ea66" class="ls lt iq lo b gy ly lv l lw lx">        [Required(ErrorMessage ="Code is required.")]<br/>        public string Code { get; set; }        <br/>    }<br/>}</span></pre><p id="b2ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<strong class="jp ir">Views/Accounts/sign up . cs html</strong>文件中，</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="ee87" class="ls lt iq lo b gy lu lv l lw lx">@{<br/>    ViewData["Title"] = "SignUp Page";<br/>}</span><span id="27f8" class="ls lt iq lo b gy ly lv l lw lx">@model WebAdWord.Models.Accounts.SignupModel;</span><span id="8ffa" class="ls lt iq lo b gy ly lv l lw lx">&lt;div class="row"&gt;<br/>    &lt;div class="col-md-4"&gt;<br/>        &lt;form method="post" asp-controller="Accounts" asp-action="Signup"&gt;<br/>            &lt;h4&gt;Create a new account&lt;/h4&gt;<br/>            &lt;hr /&gt;<br/>            &lt;div asp-validation-summary="All" class="text-danger"&gt;</span><span id="8a78" class="ls lt iq lo b gy ly lv l lw lx">            &lt;/div&gt;</span><span id="8696" class="ls lt iq lo b gy ly lv l lw lx">            &lt;div class="form-group"&gt;<br/>                &lt;label asp-for="Email"&gt;&lt;/label&gt;<br/>                &lt;input asp-for="Email" class="form-control" /&gt;<br/>                &lt;span asp-validation-for="Email" class="text-danger"&gt;&lt;/span&gt;<br/>            &lt;/div&gt;</span><span id="4e5b" class="ls lt iq lo b gy ly lv l lw lx">            &lt;div class="form-group"&gt;<br/>                &lt;label asp-for="Password"&gt;&lt;/label&gt;<br/>                &lt;input asp-for="Password" class="form-control" /&gt;<br/>                &lt;span asp-validation-for="Password" class="text-danger"&gt;&lt;/span&gt;<br/>            &lt;/div&gt;</span><span id="0eee" class="ls lt iq lo b gy ly lv l lw lx">            &lt;div class="form-group"&gt;<br/>                &lt;label asp-for="ConfirmPassword"&gt;&lt;/label&gt;<br/>                &lt;input asp-for="ConfirmPassword" class="form-control" /&gt;<br/>                &lt;span asp-validation-for="ConfirmPassword" class="text-danger"&gt;&lt;/span&gt;<br/>            &lt;/div&gt;</span><span id="4d9b" class="ls lt iq lo b gy ly lv l lw lx">            &lt;button type="submit" class="btn btn-default"&gt;Sign Up&lt;/button&gt;<br/>        &lt;/form&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="be4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<strong class="jp ir">Views/Accounts/confirm . cs html</strong>文件中，</p><pre class="kn ko kp kq gt ln lo lp lq aw lr bi"><span id="537d" class="ls lt iq lo b gy lu lv l lw lx">@{<br/>    ViewData["Title"] = "Confirm Page";<br/>}</span><span id="e72d" class="ls lt iq lo b gy ly lv l lw lx">@model WebAdWord.Models.Accounts.ConfirmModel;</span><span id="cd72" class="ls lt iq lo b gy ly lv l lw lx">&lt;div class="row"&gt;<br/>    &lt;div class="col-md-4"&gt;<br/>        &lt;form method="post" asp-controller="Accounts" asp-action="Confirm"&gt;<br/>            &lt;h4&gt;Confirm the new account&lt;/h4&gt;<br/>            &lt;hr /&gt;<br/>            &lt;div asp-validation-summary="All" class="text-danger"&gt;&lt;/div&gt;</span><span id="e24a" class="ls lt iq lo b gy ly lv l lw lx">            &lt;div class="form-group"&gt;<br/>                &lt;label asp-for="Email"&gt;&lt;/label&gt;<br/>                &lt;input asp-for="Email" /&gt;<br/>                &lt;span asp-validation-for="Email" class="text-danger"&gt;&lt;/span&gt;<br/>            &lt;/div&gt;</span><span id="165f" class="ls lt iq lo b gy ly lv l lw lx">            &lt;div class="form-group"&gt;<br/>                &lt;label asp-for="Code"&gt;&lt;/label&gt;<br/>                &lt;input asp-for="Code" /&gt;<br/>                &lt;span asp-validation-for="Code" class="text-danger"&gt;&lt;/span&gt;<br/>            &lt;/div&gt;</span><span id="f905" class="ls lt iq lo b gy ly lv l lw lx">            &lt;button type="submit"&gt;Confirm&lt;/button&gt;<br/>        &lt;/form&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="28f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第九步:调试代码:</strong></p><p id="279e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注册网址:<a class="ae kl" href="https://localhost:5001/Accounts/Confirm" rel="noopener ugc nofollow" target="_blank">https://localhost:5001/Accounts/</a>注册</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lz"><img src="../Images/166f6ca59fc3b235dce14c532e0d3a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ge0vGLsbV0ZbV8hh"/></div></div></figure><p id="8940" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注册后，你会收到一封邮件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/037293e1d809428c0b85b1ec8d0499b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/0*9hW2D8TAPkAUI3HE"/></div></figure><p id="f81e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复制验证码然后进入下面的网址:<br/>T3】https://localhost:5001/Accounts/Confirm</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/712340c0d046e177d586fa0f60916f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/0*hrDX_glyQItYVxGz"/></div></figure><p id="0f80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功确认后，您将重定向到主页。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mc"><img src="../Images/65993ae47e4c551a4125027205fde9a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0jYdX_SnKiT_H5jU"/></div></div></figure><p id="3e57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤10: AWS Cognito仪表板</strong> <br/>在这里，您可以看到新创建的用户在仪表板中的显示。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/68c8e4f28de948f5a240546162319a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kXYwZD2xc5USqWxe"/></div></div></figure><p id="2b3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一部分中，我们将实现登录、忘记密码和重置密码功能。</p><p id="e463" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你遇到任何错误，请与我分享。<br/>如果本指南对您和您的团队有所帮助，请与他人分享！</p><p id="b343" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">感谢&amp;最诚挚的问候，<br/> Alok Rawat </strong></p></div></div>    
</body>
</html>
<html>
<head>
<title>Classify Clothes Using Python and Artificial Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和人工神经网络对衣服进行分类</h1>
<blockquote>原文：<a href="https://itnext.io/classify-clothes-using-python-and-artificial-neural-networks-3f417ed66bb?source=collection_archive---------4-----------------------#2019-09-08">https://itnext.io/classify-clothes-using-python-and-artificial-neural-networks-3f417ed66bb?source=collection_archive---------4-----------------------#2019-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8bd96d285f365b694be5a28f95f80c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6XNOMPKRLeUku5kP29vaQ.png"/></div></div></figure><p id="c527" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我将向您展示如何使用<strong class="kd iu"> python编程语言</strong>和一种称为<strong class="kd iu">人工神经网络的机器学习技术，从<a class="ae kz" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">时尚MNIST </strong> </a> <strong class="kd iu">数据集</strong>中对服装</strong>进行分类！</p><p id="1481" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你不想读这篇文章，想要一个视频演示，你可以看看下面的<a class="ae kz" href="https://youtu.be/011zH9n6ag4" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">视频</strong> </a>。它详细介绍了本文中的所有内容，并且将有助于您轻松地开始编写自己的人工神经网络(ANN)模型，即使您的计算机上没有安装编程语言Python。或者你可以把视频和这篇文章都作为学习安氏症的补充材料！</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><h1 id="4704" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">开始编程:</h1><p id="2790" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">首先我会写一份这个程序将会做什么的描述。这样，当我将来回头看它时，我或其他人就能确切地知道它在做什么。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="8ee9" class="mo lh it mk b gy mp mq l mr ms"># Description: This program classifies clothes from the Fashion MNIST data set</span></pre><p id="074d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我需要<strong class="kd iu">安装依赖项/包</strong>。如果您还没有安装这些包，请在您的终端、命令提示符或Google Colab网站(取决于您安装python编程语言的位置)中运行以下命令。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="2012" class="mo lh it mk b gy mp mq l mr ms">pip install tensorflow keras numpy matplotlib</span></pre><p id="d3f0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我已经安装完了所有必要的包，我想把这些包导入到我的程序中。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="ba55" class="mo lh it mk b gy mp mq l mr ms">#Import the libraries<br/>import tensorflow as tf<br/>from tensorflow import keras<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span></pre><p id="e23e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，<strong class="kd iu">将数据集</strong>加载到变量<code class="fe mt mu mv mk b">train_images</code>(包含要训练的图像的变量)、<code class="fe mt mu mv mk b">train_labels</code>(包含训练集中图像的标签的变量)、<code class="fe mt mu mv mk b">test_images</code>(包含要测试的图像的变量)和<code class="fe mt mu mv mk b">test_labels</code>(包含测试集中图像的标签的变量)。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="b6ad" class="mo lh it mk b gy mp mq l mr ms">#Load the data set<br/>fashion_mnist = keras.datasets.fashion_mnist<br/>(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()</span></pre><p id="eb8f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">获取<code class="fe mt mu mv mk b">train_images</code>和<code class="fe mt mu mv mk b">test_images</code>中的图像数量。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="7fd1" class="mo lh it mk b gy mp mq l mr ms">#Print the shape <br/>print(train_images.shape)# 60,000 rows of 28 x 28 pixel images<br/>print(test_images.shape) # 10,000 rows of 28 x 28 pixel images</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/9b967c50cabdc2b5c1157df1c77755e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*eUPKfr19G1RNAlllSmGGvg.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated"><strong class="bd li">训练_图像:</strong> 60，000行28×28像素图像，<strong class="bd li">测试_图像:</strong> 10，000行28×28像素图像</figcaption></figure><p id="264f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">查看训练图像，并打印标签。</p><blockquote class="nb nc nd"><p id="11e8" class="kb kc ne kd b ke kf kg kh ki kj kk kl nf kn ko kp ng kr ks kt nh kv kw kx ky im bi translated"><strong class="kd iu">数据集的标签:</strong> <br/> 0 = T恤/上衣<br/>1 =裤子<br/>2 =套头衫<br/>3 =连衣裙<br/>4 =外套<br/>5 =凉鞋<br/>6 =衬衫<br/>7 =运动鞋<br/>8 =包包包<br/>9 =短靴</p></blockquote><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="c40f" class="mo lh it mk b gy mp mq l mr ms">#View a training image<br/>img_index = 2 #&lt;&lt;&lt; You can update this value to look at other images<br/>img = train_images[img_index]<br/>print("Image Label: " + str(train_labels[img_index]))<br/>plt.imshow(img)</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b4deb5e0027b606c407c10b65b4c5fde.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*J5Ma5jwfRq3yu04QBte08A.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">标签为“0”的图像= T恤</figcaption></figure><p id="b34f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">建立3层模型</strong>(1层将图像展平为28 x 28 = 784矢量，1层128个神经元和relu激活函数&amp; 1层10个神经元和Softmax函数)。我们有10个神经元，因为图像数据集有10个标签。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="cd10" class="mo lh it mk b gy mp mq l mr ms">#Build the model<br/># 3 layers, 1 layer to flatten the image to a 28 x 28 = 784 vector<br/>#           1 layer with 128 neurons and relu function<br/>#           1 layer with 10 neurons and softmax function</span><span id="7a72" class="mo lh it mk b gy nj mq l mr ms">#Create the neural network model<br/>model = keras.Sequential([<br/>    keras.layers.Flatten(input_shape=(28,28)),<br/>    keras.layers.Dense(128, activation=tf.nn.relu),<br/>    keras.layers.Dense(10, activation=tf.nn.softmax)<br/>])</span></pre><p id="3b80" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">使用损失函数<code class="fe mt mu mv mk b">sparse_categorical_crossentropy</code>编译模型</strong>，该函数用于大于2的类，因为我们将有9个类，所以我们将使用该函数。这些类是从0到9的数字，例如:0，1，2，3，…9。我还将添加一个指标来显示模型的准确性。<code class="fe mt mu mv mk b">Adam</code>是一种优化算法，可以用来代替经典的随机梯度下降过程来更新训练数据上的网络权重。</p><blockquote class="nb nc nd"><p id="54e0" class="kb kc ne kd b ke kf kg kh ki kj kk kl nf kn ko kp ng kr ks kt nh kv kw kx ky im bi translated"><strong class="kd iu">优化函数:</strong>寻求最小化损失函数的函数</p><p id="a800" class="kb kc ne kd b ke kf kg kh ki kj kk kl nf kn ko kp ng kr ks kt nh kv kw kx ky im bi translated"><strong class="kd iu">损失函数:</strong>在数学优化和决策理论中，损失函数或成本函数是将事件或一个或多个变量的值映射到一个实数上的函数，该实数直观地表示与该事件相关的一些“成本”。本质上，它是一种评估你的算法对你的数据集建模有多好的方法。</p></blockquote><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="1f07" class="mo lh it mk b gy mp mq l mr ms">#Compile the model<br/>#The loss function measures how well the model did on training , and then tries <br/>#to improve on it using the optimizer<br/><br/>model.compile(<br/>   optimizer=tf.train.AdamOptimizer(), <br/>   loss='sparse_categorical_crossentropy', <br/>   metrics = ['accuracy'])</span></pre><p id="28b4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">使用<code class="fe mt mu mv mk b">train_images</code>和<code class="fe mt mu mv mk b">train_labels</code>变量(包含训练数据的变量/数据集)训练模式</strong> l。我将在整个数据集上迭代5次进行训练，每次梯度更新32个样本进行训练。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="b3dc" class="mo lh it mk b gy mp mq l mr ms">#Train the model</span><span id="32f9" class="mo lh it mk b gy nj mq l mr ms">model.fit(train_images, <br/>          train_labels,  #It expects integers because of the <!-- -->sparse_categorical_crossentropy loss function<br/>          epochs=5, #number of iterations over the entire dataset to train on<br/>          batch_size=32)#number of samples per gradient update for training</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/d03584e235f2a9dd1f9337d71b32da25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7zQhy7KU8QD87lbDOAa9A.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">每个训练步骤/时期的模型损失和准确性</figcaption></figure><p id="9275" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在是时候<strong class="kd iu">评估模型</strong>了，看看它在测试数据集上的表现如何。该模型表现良好，准确率约为81.15%。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="cdfb" class="mo lh it mk b gy mp mq l mr ms">#Evaluate the model<br/>model.evaluate(test_images, test_labels)</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/246f78dbae2e16078a81a0be89ccb86f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOgu7zUnG3jw19U2yZlukQ.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">图像显示损失约为0.7431，准确度约为78.22%</figcaption></figure><p id="6092" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">注意:</strong>您可以将该模型保存在一个. h5文件中，以便以后在另一个程序中使用该模型/模型权重。确保包括您想要保存模型/文件的位置。例如'<strong class="kd iu"> Desktop/model.h5 </strong>'。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="cf15" class="mo lh it mk b gy mp mq l mr ms">#model.save_weights('model.h5')</span></pre><p id="b21f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用模型进行预测。我将使用这个模型预测前5个测试图像的类别，以及实际的标签。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="4b4e" class="mo lh it mk b gy mp mq l mr ms">#Make a prediction<br/>predictions = model.predict(test_images[:5])<br/>print(np.argmax(predictions, axis=1)) #Print the predicted labels<br/>print(test_labels[:5]) #Print the actual labels</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/445a83835611766c2e00b21b7b364658.png" data-original-src="https://miro.medium.com/v2/resize:fit:222/format:webp/1*TI-Euo_VsCwVWJMHOqlEjw.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">模型的预测和实际标签</figcaption></figure><p id="0d55" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后我将<strong class="kd iu">把服装时尚图片</strong>打印到屏幕上。更具体地说，我将把测试数据的前5幅图像以28 x 28像素的灰色打印到屏幕上。</p><p id="bf4f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意:使用下面的代码，你可以读入任何大小的图像，这段代码会将图像大小调整为28 x 28像素，并打印到屏幕上。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="7d2d" class="mo lh it mk b gy mp mq l mr ms">for i in range(0,5):<br/>  first_image = test_images[i]<br/>  first_image = np.array(first_image, dtype='float')<br/>  pixels = first_image.reshape((28, 28))<br/>  plt.imshow(pixels, cmap='gray')<br/>  plt.show()</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/2b36b7040a81d727a70343278a9982b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*ZB0CRmqcryNKrGfmLFv5iA.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">踝靴的图像(9)</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d12b311242ced669a099600d4707ef53.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*GSoCVPs8ltj11kYjMfXkKw.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">靠边停车的图像(2)</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/14577099f7559428962446161db40936.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*qCRLdhv9Bj01RJ6lLB_Y9Q.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">裤子的图像(1)</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/a72299af4770368d87af93c3bd7fab49.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*AM7NS0TrRWH4DOMqWe0-AQ.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">裤子的图像(1)</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/a60efccbf0df64cb1d49f0e2228c531e.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*xg4GOWHH8aH-9FMraGX16A.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">衬衫的图像(6)</figcaption></figure><p id="c7ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以看上面的视频，了解我是如何编写这个程序的，并和我一起编写一些更详细的解释，或者你可以点击YouTube上的<a class="ae kz" href="https://youtu.be/011zH9n6ag4" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">链接，这里是</strong> </a>。</p><p id="9a91" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你也有兴趣阅读更多关于机器学习的内容，以立即开始处理问题和示例，那么我强烈建议你查看<a class="ae kz" href="https://www.amazon.com/gp/product/1491962291?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;linkCode=xm2&amp;creativeASIN=1491962291" rel="noopener ugc nofollow" target="_blank">用Scikit-Learn和TensorFlow进行机器学习实践:构建智能系统的概念、工具和技术</a>。这是一本帮助初学者学习如何编写机器学习程序和理解机器学习概念的好书。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/5de9639473f99c0aff5ef3bedc135209.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/0*4ighPYHP4uMtRnjX.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated"><a class="ae kz" href="https://www.amazon.com/gp/product/1491962291?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;linkCode=xm2&amp;creativeASIN=1491962291" rel="noopener ugc nofollow" target="_blank">使用Scikit-Learn和TensorFlow进行机器学习:构建智能系统的概念、工具和技术</a></figcaption></figure><p id="2e65" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢你阅读这篇文章，希望对你有所帮助！如果你喜欢这篇文章，并发现它很有帮助，请留下一些掌声，以示感谢。坚持学习，如果你喜欢机器学习、数学、计算机科学、编程或算法分析，请访问并订阅我的<a class="ae kz" href="https://www.youtube.com/channel/UCaV_0qp2NZd319K4_K8Z5SQ" rel="noopener ugc nofollow" target="_blank"> YouTube </a>频道(<a class="ae kz" href="https://www.youtube.com/channel/UCaV_0qp2NZd319K4_K8Z5SQ" rel="noopener ugc nofollow" target="_blank">randers 112358</a>&amp;<a class="ae kz" href="https://www.youtube.com/channel/UCbmb5IoBtHZTpYZCDBOC1CA" rel="noopener ugc nofollow" target="_blank">compsci 112358</a>)。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b3a0c3a29d076796b1a84b5f36570ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/0*TKpIfA_tMwe3opNG.png"/></div></figure><h1 id="a7d8" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">资源:</h1><p id="6a88" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">[1] <a class="ae kz" href="https://victorzhou.com/blog/keras-neural-network-tutorial/" rel="noopener ugc nofollow" target="_blank"> Keras神经网络教程</a><br/>【2】<a class="ae kz" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank">Keras网站</a><br/>【3】<a class="ae kz" href="https://levelup.gitconnected.com/classify-hand-written-digits-5fdbe5d99ee7" rel="noopener ugc nofollow" target="_blank">利用Python和人工神经网络对手写数字进行分类</a></p></div></div>    
</body>
</html>
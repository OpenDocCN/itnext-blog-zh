<html>
<head>
<title>Kubernetes Command Line Tools</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes命令行工具</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-command-line-tools-acad11683794?source=collection_archive---------1-----------------------#2019-01-10">https://itnext.io/kubernetes-command-line-tools-acad11683794?source=collection_archive---------1-----------------------#2019-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/90cc1bb74ffdb2d725ceb19eba091d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*PZokaqGQdijgeaeZDkIIrA.jpeg"/></div></figure><p id="5e5c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您经常与Kubernetes集群进行交互，您可能会发现自己对输入重复命令的时间感到沮丧。减少这种挫折感的一种方法是通过使用针对<code class="fe ks kt ku kv b">kubectl</code>的CLI工具，Kubernetes命令行界面。本文将重点介绍几种用于简化<code class="fe ks kt ku kv b">kubectl</code>的使用并节省时间的工具。</p><p id="a62d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">将涵盖以下工具:</p><ul class=""><li id="3467" class="kw kx iq jw b jx jy kb kc kf ky kj kz kn la kr lb lc ld le bi translated"><a class="ae lf" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/#enabling-shell-autocompletion" rel="noopener ugc nofollow" target="_blank">外壳自动完成</a>:自动完成<code class="fe ks kt ku kv b">kubectl</code></li><li id="309c" class="kw kx iq jw b jx lg kb lh kf li kj lj kn lk kr lb lc ld le bi translated">kubectx &amp; kubens :在Kubernetes上下文和名称空间之间来回切换</li><li id="d932" class="kw kx iq jw b jx lg kb lh kf li kj lj kn lk kr lb lc ld le bi translated"><a class="ae lf" href="https://github.com/jonmosco/kube-ps1" rel="noopener ugc nofollow" target="_blank"> kube-ps1 </a> : Kubernetes提示bash和zsh:上下文/名称空间信息到您的shell提示</li><li id="16d2" class="kw kx iq jw b jx lg kb lh kf li kj lj kn lk kr lb lc ld le bi translated"><a class="ae lf" href="https://github.com/ahmetb/kubectl-aliases" rel="noopener ugc nofollow" target="_blank"> kubectl别名</a>:创建自己的别名与<code class="fe ks kt ku kv b">kubectl</code>交互</li></ul><p id="4ee3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">先决条件</strong>:确保您已经安装了<code class="fe ks kt ku kv b">kubectl</code>命令行实用程序，并且可以访问Kubernetes集群。关于安装<code class="fe ks kt ku kv b">kubectl</code>的说明，请查看本文。按照这个<a class="ae lf" href="http://www.oracle.com/webfolder/technetwork/tutorials/obe/oci/oke-full/index.html" rel="noopener ugc nofollow" target="_blank">友好指南</a>使用Oracle Container Engine for Kubernetes(OKE)访问Kubernetes集群。</p><h1 id="ace6" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">Shell自动完成:kubectl的自动完成</h1><p id="0d4a" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">如果您发现自己花了太多时间编写长的<code class="fe ks kt ku kv b">kubectl</code>命令，那么配置shell自动完成功能是值得的。这类似于bash、zsh等中的shell补全。这个工具很有用，因为它可以用来自动完成所有基本的<code class="fe ks kt ku kv b">kubectl</code>命令以及部署、服务等。从您的集群。Autocomplete从您当前的上下文中提取信息，使您不必键入可能很长的部署名称。查看本文中关于如何为<code class="fe ks kt ku kv b">kubectl</code>配置shell自动完成的说明。</p><p id="a01d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要使用带有<code class="fe ks kt ku kv b">kubectl</code>的shell自动补全功能，只需在编写命令时按下<strong class="jw ir">标签</strong>。例如，我们可以输入<code class="fe ks kt ku kv b">g</code>，然后按下<strong class="jw ir">标签</strong>来自动完成<code class="fe ks kt ku kv b">get</code>。</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="df31" class="mw lm iq kv b gy mx my l mz na">$ kubectl g [TAB]<br/>$ kubectl get</span></pre><p id="8eda" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当我们键入<code class="fe ks kt ku kv b">s</code>时，您可能会期望按下<strong class="jw ir"> tab键</strong>会自动完成服务，但是在这种情况下，以<code class="fe ks kt ku kv b">s</code>开头的单词有很多选项。</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="eaac" class="mw lm iq kv b gy mx my l mz na">$ kubectl get s [TAB]<br/>secrets                                signalfxs.config.istio.io<br/>serviceaccounts                        solarwindses.config.istio.io<br/>servicecontrolreports.config.istio.io  stackdrivers.config.istio.io<br/>servicecontrols.config.istio.io        statefulsets.apps<br/>serviceentries.networking.istio.io     statsds.config.istio.io<br/>servicerolebindings.rbac.istio.io      stdios.config.istio.io<br/>serviceroles.rbac.istio.io             storageclasses.storage.k8s.io<br/>services</span></pre><p id="4078" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您写出<code class="fe ks kt ku kv b">service</code>，您可以<strong class="jw ir"> tab键</strong>来显示您当前名称空间中所有可用的服务。</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="1666" class="mw lm iq kv b gy mx my l mz na">$ kubectl get service [TAB]<br/>details      helloworld   kubernetes   productpage  ratings      reviews</span></pre><p id="0f8d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要查看可用命令的完整列表，请键入<code class="fe ks kt ku kv b">kubectl</code>后跟两个<strong class="jw ir"> tab' </strong>。</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="e5cb" class="mw lm iq kv b gy mx my l mz na">$ kubectl [TAB][TAB]<br/>annotate       certificate    create         explain        plugin         set<br/>api-resources  cluster-info   delete         expose         port-forward   taint<br/>api-versions   completion     describe       get            proxy          top<br/>apply          config         diff           label          replace        uncordon<br/>attach         convert        drain          logs           rollout        version<br/>auth           cordon         edit           options        run            wait<br/>autoscale      cp             exec           patch          scale</span></pre><h1 id="8d5a" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">kubectx &amp; kubens:在Kubernetes上下文和名称空间之间来回切换</h1><p id="7450" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">如果您发现自己在多个Kubernetes上下文和/或多个名称空间之间来回切换，使用工具来缩短这个过程会很有帮助。使用<code class="fe ks kt ku kv b">kubectx</code>您可以轻松地列出、切换、重命名和删除上下文。<code class="fe ks kt ku kv b">kubens</code>同样允许您列出名称空间并在名称空间之间切换。这两种工具也支持<strong class="jw ir">标签</strong>完成。</p><p id="fd48" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">关于如何配置<code class="fe ks kt ku kv b">kubectx</code>和<code class="fe ks kt ku kv b">kubens</code>的说明，请查看本文。</p><p id="bd55" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，您可以通过添加交互式菜单，如<code class="fe ks kt ku kv b">fzf</code>，使<code class="fe ks kt ku kv b">kubectx</code>和<code class="fe ks kt ku kv b">kubens</code>更加方便。按照这些步骤安装<code class="fe ks kt ku kv b">fzf</code>。<code class="fe ks kt ku kv b">fzf</code>是一个命令行模糊查找器，它为您提供了一个上下文或名称空间的交互式菜单供您选择。</p><h1 id="c147" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">使用kubectx</h1><p id="ba0c" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">要列出上下文:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="876a" class="mw lm iq kv b gy mx my l mz na">$ kubectx<br/>context-ctdazdbmi3t<br/>docker-for-desktop</span></pre><p id="bf43" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要切换上下文:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="60e5" class="mw lm iq kv b gy mx my l mz na">$ kubectx docker-for-desktop<br/>Switched to context "docker-for-desktop".</span></pre><p id="b644" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要返回到上一个上下文:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="386e" class="mw lm iq kv b gy mx my l mz na">$ kubectx -<br/>Switched to context "context-ctdazdbmi3t".</span></pre><p id="2d2c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要重命名上下文:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="6a21" class="mw lm iq kv b gy mx my l mz na">$ kubectx oracle=context-ctdazdbmi3t<br/>Context "context-ctdazdbmi3t" renamed to "oracle".</span></pre><p id="87ce" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当<code class="fe ks kt ku kv b">kubectx</code>与<code class="fe ks kt ku kv b">fzf</code>一起使用时，同样的命令也适用。唯一的区别是交互式菜单的外观。</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="dcb5" class="mw lm iq kv b gy mx my l mz na">$ kubectx</span><span id="2c6d" class="mw lm iq kv b gy nb my l mz na">&gt; docker-for-desktop<br/>  context-ctdazdbmi3t<br/>  2/2</span></pre><h1 id="c31c" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">使用kubens</h1><p id="e89a" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">要列出名称空间:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="7c9f" class="mw lm iq kv b gy mx my l mz na">$ kubens<br/>default<br/>istio-system<br/>kube-public<br/>kube-system<br/>sample<br/>spinnaker</span></pre><p id="9290" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要切换名称空间:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="5f7b" class="mw lm iq kv b gy mx my l mz na">$ kubens spinnaker<br/>Context "context-ctdazdbmi3t" modified.<br/>Active namespace is "spinnaker".</span></pre><p id="c525" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要返回到上一个名称空间:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="a6c1" class="mw lm iq kv b gy mx my l mz na">$ kubens - <br/>Context "context-ctdazdbmi3t" modified.<br/>Active namespace is "default"</span></pre><h1 id="5560" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">将kubectx与fzf一起使用</h1><p id="440c" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">当<code class="fe ks kt ku kv b">kubens</code>与<code class="fe ks kt ku kv b">fzf</code>一起使用时，同样的命令也适用。与<code class="fe ks kt ku kv b">kubectx</code>一样，唯一的区别是交互式菜单的外观。</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="9546" class="mw lm iq kv b gy mx my l mz na">$ kubens </span><span id="93a7" class="mw lm iq kv b gy nb my l mz na">&gt; default<br/>  istio-system<br/>  kube-public<br/>  kube-system<br/>  sample<br/>  spinnaker<br/>  6/6</span></pre><h1 id="ae2f" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">kube-ps1: Kubernetes对bash和zsh的提示</h1><p id="251a" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">kube-ps1将当前的Kubernetes上下文和名称空间添加到提示字符串中。这个工具让您不必在每次需要检查上下文或确定当前名称空间时都键入<code class="fe ks kt ku kv b">kubectl config current-context</code>。这是一个简单的改变，可以使与集群的交互变得更加容易。</p><p id="08fc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另外，如果您厌倦了在提示字符串中看到您的上下文和名称空间，您可以简单地在shell会话中使用<code class="fe ks kt ku kv b">kubeoff</code>关闭kube-ps1。它可以用<code class="fe ks kt ku kv b">kubeon</code>重新打开。要使这一更改在shell会话中全局生效，请在命令末尾添加<code class="fe ks kt ku kv b">-g</code>标志。</p><p id="6dc0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看<a class="ae lf" href="https://github.com/jonmosco/kube-ps1" rel="noopener ugc nofollow" target="_blank">这篇文章</a>了解如何配置kube-ps1的说明。</p><p id="dadc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装完成后，您的shell应该看起来像这样:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="9296" class="mw lm iq kv b gy mx my l mz na">(⎈ |[context]:[namespace]) $ </span></pre><p id="7de3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">例如，我的提示字符串如下所示:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="0408" class="mw lm iq kv b gy mx my l mz na">(⎈ |context-ctdazdbmi3t:default) $</span></pre><h1 id="bad1" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">kubectl别名</h1><p id="695b" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">bash、zsh等的Shell别名。可以用来缩短任何和所有的shell命令，而不仅仅是那些与<code class="fe ks kt ku kv b">kubectl</code>相关的命令。在这种情况下，您的环境中不需要额外安装任何东西。将与<code class="fe ks kt ku kv b">kubectl</code>相关的别名分离到它们自己的文件中，并在您的shell运行时配置(例如bashrc)中找到它，这是一个很好的实践。要创建自己的一组<code class="fe ks kt ku kv b">kubectl</code>别名，首先在$HOME目录中创建一个文件，例如一个名为。kube _别名:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="1d5b" class="mw lm iq kv b gy mx my l mz na">$ vi .kube_alias</span></pre><p id="027e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先添加一个简单的别名，比如<code class="fe ks kt ku kv b">alias k=’kubectl’</code>，然后保存文件。编辑您的。巴沙尔或者。zshrc文件，包含以下内容:</p><pre class="mo mp mq mr gt ms kv mt mu aw mv bi"><span id="e21e" class="mw lm iq kv b gy mx my l mz na">[ -f ~/.kubectl_alias ] &amp;&amp; source ~/.kubectl_alias</span></pre><p id="3fd4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将告诉您的shell引用您新创建的别名文件。下次您在shell中输入<code class="fe ks kt ku kv b">k</code>时，它将被视为您输入了<code class="fe ks kt ku kv b">kubectl</code>。</p><p id="0ea7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">可以创建别名来简化任意数量的命令。例如，如果您发现自己经常键入<code class="fe ks kt ku kv b">kubectl get pods --all-namespaces</code>来获得集群中每个名称空间中运行的pods列表，那么您可以编写一个别名，比如<code class="fe ks kt ku kv b">kgpall</code>来缩短命令。在你的。kube_alias文件，这个别名应该是这样的:<code class="fe ks kt ku kv b">alias kpgall=’kubectl get pod --all-namespaces’</code>。</p><p id="40e5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae lf" href="https://github.com/ahmetb/kubectl-aliases" rel="noopener ugc nofollow" target="_blank">这个页面</a>有很多有用的别名，可以和Kubernetes一起使用。即使你选择不使用这个列表，它也可以给你一些有用的想法，让你自己写别名。</p><h1 id="99c9" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="c3b0" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">读完这篇文章后，我希望您对命令行工具有更好的理解，这些工具可以让您更容易地与Kubernetes交互。我还希望您能受到启发，探索可用工具的生态系统，甚至创建自己的工具。</p></div></div>    
</body>
</html>
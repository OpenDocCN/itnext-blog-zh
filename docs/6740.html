<html>
<head>
<title>Redis vs etcd with Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redis vs etcd与Golang</h1>
<blockquote>原文：<a href="https://itnext.io/redis-vs-etcd-with-golang-39e7325bc029?source=collection_archive---------0-----------------------#2022-02-15">https://itnext.io/redis-vs-etcd-with-golang-39e7325bc029?source=collection_archive---------0-----------------------#2022-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f5cc949001c1e68fa3224836f1fef4ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nL_jBpgYKlwW670Z"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">克洛维斯伍德摄影在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4c9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天我们将比较Redis和etcd。<br/>让我们比较一下它们的性能。考虑它们的应用领域-案例。</p><p id="af4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Redis —内存中的数据结构存储，用作数据库、缓存和消息代理。它通常被称为数据结构服务器，因为键可以包含字符串、散列、列表、集合和排序集合。</p><p id="66f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Etcd —是一个高度一致的分布式键值存储，它提供了一种可靠的方式来存储需要由分布式系统或机器集群访问的数据。etcd在网络分区期间优雅地处理主设备选举，并容忍机器故障，包括主设备故障。</p><p id="45e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Redis的优点<br/> -性能<br/> -内存缓存<br/> -高级键值缓存<br/> -开源<br/> -简单易用</p><p id="fafd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">etcd的优点<br/> -服务发现<br/> -容错键值存储<br/> -与coreos捆绑<br/> -开源<br/> -特权访问管理<br/> -安全</p><p id="5b95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Redis有优秀的文件<a class="ae kc" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank">https://redis.io/</a>。几年来，Redis一直是全世界开发者的首选工具。<br/>与其他键值不同，Redis数据类型包括字符串、列表、集合、存储集、哈希、位图、超级日志、流、地理空间。</p><p id="0242" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Redis的用例非常多样:<br/> -缓存<br/> -聊天、消息和队列<br/> -会话存储<br/> -媒体流<br/> -地理空间<br/> -机器学习</p><p id="de98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">etcd拥有现代文献<a class="ae kc" href="https://etcd.io/" rel="noopener ugc nofollow" target="_blank">https://etcd.io/</a>。<br/>开箱即用etcd有HTTP API(工具)。您的应用程序可以“监视”特定键或目录的变化，并对值的变化做出反应。</p><p id="d780" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">许多组织使用etcd来实现生产系统<br/>——所有的Kubernetes系统。<br/> - OpenTable —内部服务发现和集群配置管理。【cycoresys.com T2】—为计算系统提供架构和工程设计。<br/> - Radius智能—多种内部工具、Kubernetes集群、可引导系统配置。<br/> - Vonage — kubernetes、vault后端、微服务的系统配置、调度、锁(未来—服务发现)。<br/> - PD — PD(布局驱动程序)是TiDB集群中的中央控制器。<br/> -华为——覆盖网络(Canal)系统配置。<br/> -七牛云—微服务、分布式锁的系统配置。<br/> - QingCloud — appcenter集群，用于作为metad后端的服务发现。<br/> - Yandex —服务的系统配置，服务发现。<br/> -腾讯游戏-服务发现、Kubernetes等的元数据和配置数据。<br/> - Hyper.sh — Kubernetes、分布式锁等。<br/> -美图—测试环境中服务、服务发现、Kubernetes的系统配置。<br/> - Grab —服务的系统配置，服务发现。<br/> - DaoCloud.io —容器管理。<br/>-branch . io-在Kubernetes系统中。<br/> -百度外卖SkyDNS、Kubernetes、UDC、CMDB等分布式系统。<br/>-Salesforce.com——在库伯内特系统。<br/> -托管石墨——服务发现、锁定、短暂应用数据。<br/>-Transwarp——Transwarp数据云，trans warp操作系统，trans warp数据中枢，Sophon。</p><p id="04ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，etcd是一个CNCF项目。这真的很酷。</p><p id="2319" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Etcd用例:<br/>-core OS的容器Linux。<br/>——库伯内特系统公司。<br/> -适用于各种应用的快速、分布式、容错和简单配置系统。</p><p id="768d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更多关于用例及使用领域的信息，请参见第<a class="ae kc" href="https://etcd.io/docs/v3.3/learning/why/" rel="noopener ugc nofollow" target="_blank">页https://etcd.io/docs/v3.3/learning/why/</a>页。</p><h1 id="c362" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">让我们从一个基本的Redis + Golang应用程序开始。</h1><p id="2874" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当然，您可以很容易地在本地或您的主机上开始使用它。<br/>例如，用几个命令在本地用docker运行Redis:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在您的机器上运行Redis</figcaption></figure><p id="c031" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在从Golang应用程序连接到Redis。创建一个真正基本和简单的golang应用程序，并连接到Redis主机。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">初始化go应用程序</figcaption></figure><p id="572d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和“hello-world”基本应用程序本身。</p><p id="8ff1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">cat ~/my-golang-redis-app/main . go</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="beec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查此应用程序的操作。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="9530" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是您在Golang开始使用Redis的全部内容。然后，您应用团队中采用的代码组织实践和一般架构模式。</p><h1 id="749b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">现在谈谈基本的etcd + Golang应用程序。</h1><p id="6130" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">先说一下如何启动etcd和golang应用。</p><p id="4c25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您的机器上还没有etcd，让我们安装它。用几个命令检查它的工作。同时，让我们直接了解一下它的cli。</p><p id="1040" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">进入官方安装文档页面<a class="ae kc" href="https://etcd.io/docs/v3.5/install/" rel="noopener ugc nofollow" target="_blank">https://etcd.io/docs/v3.5/install/</a>。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="77ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使main.go的内容匹配</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="df82" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些都是概念性的应用。</p><p id="cb4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在检查一下它将在循环中执行多少次操作—写/读。参见下面代码中的循环:</p><pre class="me mf mg mh gt mk ml mm mn aw mo bi"><span id="7a5e" class="mp lc iq ml b gy mq mr l ms mt">for i := 0; i &lt; cnt; i++ {<br/> // write/read<br/>}</span></pre><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">循环读写</figcaption></figure><p id="18a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们看到执行10，000次写和读操作需要多长时间。<br/> Redis显示读写时间相同——7秒以上。<br/>但etcd显示它“写”得慢，但读得快得多。<br/>如果我们只比较读操作，那么etcd赢了5次。</p><p id="a2b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，我们“有义务”检查golang应用程序的内部操作花费了多少时间和内存，以进行内置基准测试。</p><p id="524a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">主_测试. go</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">基准结果</figcaption></figure><p id="fd5b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如所料，在这里，我们看到在写入etcd时，在资源消耗和时间方面有很大的优势。<br/>与此同时，etcd在录音方面成为领头羊。</p><h1 id="2b4b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">极限呢？</h1><p id="4446" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你首先要注意的，当然是Redis和etcd在性能上的限制。<br/>它们包括:<br/> -将这些技术带入团队的资源；<br/> -为各种环境(开发、阶段和生产)维护和恢复(在故障情况下)Redis和etcd所需的资源；<br/> -任何资源运行的一个不可或缺的部分是它们的技术限制<br/> —考虑数据累积的吞吐量(性能)<br/> —以及内存和数据存储的最终限制(每个节点/主机和群集作为一个整体)。</p><p id="3a5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以为Redis分配的限制:<br/>-100万个小键- &gt;字符串值对使用~ 85MB内存。<br/>-100万个键- &gt;哈希值，代表一个有5个字段的对象，使用~ 160 MB内存。<br/> -单个Redis实例的最大键数— 2个键。<br/>实际上，你把自己限制在RAM。</p><p id="7b15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Etcd限制:<br/> -任何请求的最大大小(默认)为1.5 MiB(该限制可通过etcd服务器的max-request-bytes标志进行配置)。<br/> -存储容量— 8GB。但实际操作中，即使16GB也可以使用etc。超过20GB时，您会发现超时。</p><p id="118b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Redis和etcd当然是不同类的键值存储，目的也不同，但是它们也有显著的交集。<br/>首先是键值存储。如果您需要从存储中读取更多内容，那么您应该仔细看看etcd。如果你需要经常写/读，并且你想要更多的特性，那么你应该仔细看看Redis。</p><p id="b061" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就目前的情况来看，大部分开发者和架构都选择Redis。首先，这是一个熟悉的工具。它允许你扩展你的功能。<br/>但与此同时，我也遇到过几次使用“非传统”Redis的提议，即etcd作为配置存储的键值存储。</p><p id="b09d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">顺便说一句，配置应用程序是一个很大的主题，值得在这方面单独写一篇文章。你怎么想？</p><p id="3789" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本报告中所有可用的源代码—<a class="ae kc" href="https://github.com/romanitalian/redis_vs_etc_with_go" rel="noopener ugc nofollow" target="_blank">https://github.com/romanitalian/redis_vs_etc_with_go</a>。</p></div></div>    
</body>
</html>
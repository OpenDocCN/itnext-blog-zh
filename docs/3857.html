<html>
<head>
<title>Singleton in Swift for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">适用于初学者的Singleton</h1>
<blockquote>原文：<a href="https://itnext.io/singleton-in-swift-for-beginners-50f3a3d660dd?source=collection_archive---------2-----------------------#2020-03-12">https://itnext.io/singleton-in-swift-for-beginners-50f3a3d660dd?source=collection_archive---------2-----------------------#2020-03-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ff56c2e98cecd95eb51bca04b2c37c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3hdPHh81PA_7EXLN6KPRhg.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">克林特·王茂林在<a class="ae jg" href="https://unsplash.com/s/photos/connection-structure?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="df13" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">单例设计模式将一个类的实例化限制为一个对象。</p><p id="a265" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你不知道这句话是什么意思🤯？那这篇文章就送给你了，继续看！</p><p id="e850" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一种常见且相对简单的技术，Swift开发人员经常使用这种技术在项目的几个部分之间共享数据。</p><p id="0955" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你是一个初学者，你会从学习单例设计模式中受益匪浅。</p><h1 id="70fd" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">理解引用类型</h1><p id="7401" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">好了，先来一点理论。Swift中的类遵循<em class="mh">引用类型逻辑</em>。</p><p id="7678" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着如果你有一个类型为类的变量，那么这个变量不包含实际的对象😱。<br/>它只包含一个对象的引用(或指针)。</p><h2 id="2485" class="mi lf jj bd lg mj mk dn lk ml mm dp lo kr mn mo ls kv mp mq lw kz mr ms ma mt bi translated">等等…再告诉我一遍🤔</h2><p id="ddf2" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">好吧，让我们试着更好地理解使用狗意味着什么🐶。</p><p id="4e33" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们来定义一下我们的<code class="fe mu mv mw mx b">Dog</code>类。</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="068f" class="mi lf jj mx b gy ng nh l ni nj">class Dog {<br/>    var color: String?<br/>}</span></pre><p id="7646" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们创建一个<code class="fe mu mv mw mx b">Dog</code>。</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="4940" class="mi lf jj mx b gy ng nh l ni nj">let oscar = Dog()</span></pre><p id="54dc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在执行这一行之后，在内存中创建了两个实体:</p><ul class=""><li id="b621" class="nk nl jj ki b kj kk kn ko kr nm kv nn kz no ld np nq nr ns bi translated"><code class="fe mu mv mw mx b">oscar</code>:引用狗实例的变量</li><li id="cbf2" class="nk nl jj ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated">一个<code class="fe mu mv mw mx b">Dog</code>实例</li></ul><p id="0975" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以把<code class="fe mu mv mw mx b">dog</code>变量想成一个<code class="fe mu mv mw mx b">leash</code>，把<code class="fe mu mv mw mx b">Dog</code>实例想成一只真正的狗。</p><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/2f0b34cc0d68dfd949f7476504959bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*2Yxc4AeBZ94f0FaNRZyU3g.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><em class="nz">图标由</em> <a class="ae jg" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank">制作<em class="nz"> Freepik </em> </a> <em class="nz">出自</em><a class="ae jg" href="http://www.flaticon.com" rel="noopener ugc nofollow" target="_blank"><em class="nz">www.flaticon.com</em></a></figcaption></figure><p id="9c00" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">酷，现在每次你应用一个变化到你的<code class="fe mu mv mw mx b">oscar</code>变量Swift将<strong class="ki jk">跟随皮带</strong>直到它找到实际连接的<code class="fe mu mv mw mx b">Dog</code>，然后将应用变化。</p><p id="6265" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例子</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="e05a" class="mi lf jj mx b gy ng nh l ni nj">oscar.color = "Blue"</span></pre><p id="1f06" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该指令将改变皮带另一端的<code class="fe mu mv mw mx b">Dog</code>的颜色。</p><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/5196a84fe32756bf3fa06b35038da026.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*FA-OMu1iBIbmj9qrVLz_0w.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><em class="nz">图标由</em><a class="ae jg" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank"><em class="nz">Freepik</em></a><em class="nz">来自</em><a class="ae jg" href="http://www.flaticon.com" rel="noopener ugc nofollow" target="_blank">【www.flaticon.com】</a></figcaption></figure><h2 id="4356" class="mi lf jj bd lg mj mk dn lk ml mm dp lo kr mn mo ls kv mp mq lw kz mr ms ma mt bi translated">让我们添加另一个皮带…或参考</h2><p id="a699" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在让我们运行下面一行代码</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="8403" class="mi lf jj mx b gy ng nh l ni nj">let charlie = oscar</span></pre><p id="d6ce" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们为<strong class="ki jk">同一只狗</strong>创建了一个新的引用(<code class="fe mu mv mw mx b">charlie</code>)。</p><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/fa9b8da6f5f761b212d8e83da1e910e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*ObF59940Nb59CwJx0uwPtQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><em class="nz">图标由</em><a class="ae jg" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank"><em class="nz">Freepik</em></a><em class="nz">转自</em><a class="ae jg" href="http://www.flaticon.com" rel="noopener ugc nofollow" target="_blank"><em class="nz">www.flaticon.com</em></a></figcaption></figure><p id="cf2a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就像有两条不同的皮带拴在同一只狗身上。这意味着对<code class="fe mu mv mw mx b">oscar</code>应用一个改变会影响<code class="fe mu mv mw mx b">charlie</code>，反之亦然，因为这是同一只狗<strong class="ki jk"/>。</p><p id="751b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们测试一下</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="70a0" class="mi lf jj mx b gy ng nh l ni nj">let oscar = Dog()<br/>let charlie = oscar</span><span id="310c" class="mi lf jj mx b gy oa nh l ni nj">print(charlie.color) // prints nil<br/>oscar.color = "Blue"<br/>print(charlie.color) // prints "Blue"</span></pre><h2 id="6287" class="mi lf jj bd lg mj mk dn lk ml mm dp lo kr mn mo ls kv mp mq lw kz mr ms ma mt bi translated">创造新的狗</h2><p id="0284" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">因为还没有实现Singleton，记住你仍然可以创建一个新的<code class="fe mu mv mw mx b">Dog</code>。它将被视为不同的对象，改变它将<strong class="ki jk">而不是</strong>影响其他狗。</p><p id="a5cb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请看下面的代码</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="2ad8" class="mi lf jj mx b gy ng nh l ni nj">let oscar = Dog()<br/>let charlie = oscar<br/>oscar.color = "Blue"</span><span id="73d8" class="mi lf jj mx b gy oa nh l ni nj">let jack = Dog() // jack is a new Dog<br/>jack.color = "Green"</span><span id="517c" class="mi lf jj mx b gy oa nh l ni nj">print(oscar.color) // prints "Blue"<br/>print(charlie.color) // prints "Blue"<br/>print(jack.color) // prints "Green"</span></pre><p id="90b2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们有3条皮带和2条狗。</p><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/71016fccca5be908215612044d098d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*VllfOTjuZuQ98bEi0eMvzw.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><em class="nz">图标由</em><a class="ae jg" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank"><em class="nz">Freepik</em></a><em class="nz">来自</em><a class="ae jg" href="http://www.flaticon.com" rel="noopener ugc nofollow" target="_blank">【www.flaticon.com】</a></figcaption></figure><h1 id="7db6" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">构建单例</h1><p id="dc87" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在引用类型的概念似乎不那么晦涩了，对吗？</p><p id="1235" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">太酷了，我们终于可以理解单例是如何工作的了。</p><p id="8b7c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用Singleton，无论你在项目的什么地方，你都可以访问同一个对象(<code class="fe mu mv mw mx b">Dog</code>)。这太神奇了，因为你存进那个<code class="fe mu mv mw mx b">Dog</code>的任何价值都将随处可用！</p><p id="836a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们建立一个单例。</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="206d" class="mi lf jj mx b gy ng nh l ni nj">final class Dog {<br/>    static let shared = Dog()<br/>    private init() { }</span><span id="a434" class="mi lf jj mx b gy oa nh l ni nj">    var color: String?<br/>}</span></pre><p id="9fc2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是怎么回事？👆</p><ul class=""><li id="6a8c" class="nk nl jj ki b kj kk kn ko kr nm kv nn kz no ld np nq nr ns bi translated">用一个<code class="fe mu mv mw mx b">Dog</code>填充<code class="fe mu mv mw mx b">static let shared</code>属性。就像<strong class="ki jk">万能牵引绳</strong>。现在，无论你在哪里，只要调用<code class="fe mu mv mw mx b">Dog.shared</code>，你就会得到一个对<code class="fe mu mv mw mx b">Dog</code>对象的引用。</li><li id="dc2b" class="nk nl jj ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated">用<code class="fe mu mv mw mx b">private init</code>我们隐藏了初始化器。所以我们在阻止新<code class="fe mu mv mw mx b">Dog(s)</code>的产生。</li><li id="5281" class="nk nl jj ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated">我们用关键字<code class="fe mu mv mw mx b">final</code>标记了这个类，以防止子类化。事实上，它可以用来再次暴露初始化器。</li></ul><p id="5180" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样。</p><h1 id="9ca8" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用单例</h1><p id="b7c1" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在您可以在项目中的任何地方使用<code class="fe mu mv mw mx b">Dog</code>。</p><p id="fd83" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要访问它，只需写</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="6028" class="mi lf jj mx b gy ng nh l ni nj">Dog.shared</span></pre><p id="0aed" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看一个例子。您可以从一个文件中填充<code class="fe mu mv mw mx b">color</code>属性</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="7b86" class="mi lf jj mx b gy ng nh l ni nj">// HomeViewController.swift</span><span id="f4b4" class="mi lf jj mx b gy oa nh l ni nj">...<br/>Dog.shared.color = "Black"<br/>...</span></pre><p id="fd4b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并从另一个文件中读取它</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="5e84" class="mi lf jj mx b gy ng nh l ni nj">// DetailViewController.swift<br/>...</span><span id="9319" class="mi lf jj mx b gy oa nh l ni nj">print(Dog.shared.color) // prints "Black"<br/>...</span></pre><h1 id="4ac9" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="9b54" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在，您可以为您的应用程序创建一个单例。当然，你可以给它取一个更合适的名字。</p><pre class="my mz na nb gt nc mx nd ne aw nf bi"><span id="3893" class="mi lf jj mx b gy ng nh l ni nj">final class UserData {<br/>    static let shared = UserData()<br/>    private init() { }</span><span id="a693" class="mi lf jj mx b gy oa nh l ni nj">    var name: String?<br/>    var permissions: [String] = []<br/>    // TODO: add more properties here...</span><span id="12c6" class="mi lf jj mx b gy oa nh l ni nj">}</span></pre><p id="aa41" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住，无论您在哪里，您都可以通过简单地编写<code class="fe mu mv mw mx b">UserData.shared</code>来检索共享对象。</p></div></div>    
</body>
</html>
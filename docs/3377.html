<html>
<head>
<title>Laravel and Vue: Creating a Portfolio website with a CRUD admin panel — Chapter Nine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第九章</h1>
<blockquote>原文：<a href="https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-nine-7acf3268ee0d?source=collection_archive---------2-----------------------#2019-12-01">https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-nine-7acf3268ee0d?source=collection_archive---------2-----------------------#2019-12-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8df0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">组合编辑器的更新模式</h2></div><p id="0631" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们从第八章的结尾继续，在那里我们导入了更新项目模式文件</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="57b5" class="ln lo it lj b gy lp lq l lr ls">&lt;section&gt;<br/>    &lt;h1&gt;Portfolio Editor&lt;/h1&gt;<br/>    <strong class="lj iu">&lt;update-item-modal <em class="lt">v-if</em>="updateItemModal" <em class="lt">:item</em>="item"/&gt;</strong><br/>    &lt;portfolio-editor-table <em class="lt">:items</em>="items"/&gt;<br/>&lt;/section&gt;</span></pre><p id="c8b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当在浏览器中看到PortfolioEditor时，我们需要将updateItemModal设置为FALSE。</p><p id="42dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当单击编辑按钮时，我们需要将updateItemModal设置为TRUE。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="bc9f" class="ln lo it lj b gy lp lq l lr ls">data() {<br/>    <em class="lt">return </em>{<br/>        items: '',<br/>        updateItemModal: <em class="lt">false</em>,<br/>        item: '',<br/>    }<br/>},</span></pre><p id="d447" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是edititempubup(item)函数正在做的事情。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="7c24" class="ln lo it lj b gy lp lq l lr ls">editItemPopup(item) {<br/>    <em class="lt">this</em>.item = item;<br/>    <em class="lt">if </em>(<em class="lt">this</em>.updateItemModal === <em class="lt">false</em>) {<br/>        <em class="lt">this</em>.updateItemModal = <em class="lt">true</em>;<br/>    }<br/>    <em class="lt">else if </em>(<em class="lt">this</em>.updateItemModal === <em class="lt">true</em>) {<br/>        <em class="lt">this</em>.updateItemModal = <em class="lt">false</em>;<br/>    }<br/>},</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="135a" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">开始编写模型</h2><p id="ed63" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">让我们开始编写<strong class="kk iu"> updateItemModal.vue </strong>文件</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="92fe" class="ln lo it lj b gy lp lq l lr ls">&lt;template&gt;<br/>&lt;transition <em class="lt">name</em>="fade"&gt;<br/>        &lt;div <em class="lt">class</em>="modal"&gt;<br/>            &lt;div <em class="lt">class</em>="modal-body"&gt;<em class="lt"><br/>            </em>&lt;/div&gt;<br/>        &lt;/div&gt;<br/> &lt;/transition&gt;<br/>&lt;/template&gt;</span></pre><p id="1187" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">添加一个关闭模式的方法</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c96b" class="ln lo it lj b gy lp lq l lr ls">&lt;div <em class="lt">@click</em>="closeModal" <em class="lt">class</em>="modal"&gt;</span></pre><p id="76e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mx my mz lj b">methods: {}</code>中编写方法</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c2c5" class="ln lo it lj b gy lp lq l lr ls">closeModal(event) {<br/>    <em class="lt">if </em>(event.target.matches('.modal')) {<br/>        <em class="lt">this</em>.$parent.updateItemModal = <em class="lt">false</em>;<br/>    }<br/>},</span></pre><blockquote class="na nb nc"><p id="2352" class="ki kj lt kk b kl km ju kn ko kp jx kq nd ks kt ku ne kw kx ky nf la lb lc ld im bi translated">代码解释:<code class="fe mx my mz lj b">event.target</code>指你点击的任何元素。这意味着如果被点击的元素有modal类，那么updateItemModal将是<code class="fe mx my mz lj b"><strong class="kk iu">false</strong></code>。</p></blockquote></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="c695" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">定位模态</h2><p id="0674" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">我们还需要将updateItemModal放在其余元素的前面(就像一个Modal)。</p><p id="5f3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这可以通过将模态的<code class="fe mx my mz lj b"><strong class="kk iu">position</strong></code>设置为<code class="fe mx my mz lj b"><strong class="kk iu">fixed</strong></code>并将<code class="fe mx my mz lj b"><strong class="kk iu">z-index</strong></code>设置为<code class="fe mx my mz lj b"><strong class="kk iu">1</strong></code>来实现，同时工作台的z索引可以设置为0。z索引号决定哪个固定元素出现在前面，即如果有一个z索引为2的固定元素，它将出现在模态的前面，依此类推。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="e78b" class="ln lo it lj b gy lp lq l lr ls">.modal {<br/>    <strong class="lj iu">position: fixed;z-index:1;</strong><br/>}</span></pre><p id="2846" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们将顶部、底部、左侧和右侧设置为0</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="1a23" class="ln lo it lj b gy lp lq l lr ls">.modal {<br/>    position: fixed;z-index:1;<br/>    <strong class="lj iu">top: 0;<br/>    bottom: 0;<br/>    left: 0;<br/>    right: 0;</strong><br/>}</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="2a54" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">使用rgba的背景色</h2><p id="bf8e" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">我们应该使用<code class="fe mx my mz lj b">rgba</code>设置背景颜色。rgba允许你设置背景色的透明度，前三个数字组成颜色，第四个数字代表透明度。</p><p id="7e22" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，<code class="fe mx my mz lj b">rgba(0,0,0,1)</code>是可以完全看到的黑色。而<code class="fe mx my mz lj b">rgba(0,0,0,0)</code>将不会显示任何黑色。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="d21e" class="ln lo it lj b gy lp lq l lr ls">.modal {<br/>    position: fixed;z-index:1;<br/>    top: 0;<br/>    bottom: 0;<br/>    left: 0;<br/>    right: 0;<br/>    <strong class="lj iu">background-color: rgba(0, 0, 0, 0.3);</strong><br/>}</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="c5da" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">使模体居中</h2><p id="d9c7" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">现在我们应该使用modal类中的<code class="fe mx my mz lj b"><strong class="kk iu">display:flex; justify-content:center; align-items:center</strong></code> <strong class="kk iu"> </strong>让modal body div出现在中间</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="f980" class="ln lo it lj b gy lp lq l lr ls">.modal {<br/>    position: fixed;<br/>    top: 0;<br/>    bottom: 0;<br/>    left: 0;<br/>    right: 0;<br/>    background-color: rgba(0, 0, 0, 0.3);<br/>    <strong class="lj iu">display: flex;<br/>    justify-content: center;<br/>    align-items: center;</strong><br/>}</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="6f20" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">时间</h2><p id="ed24" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">在模态体中，我们需要一种形式。该表单将是updateItemModal.vue文件的子组件，我们将使用<strong class="kk iu">插槽</strong>。</p><p id="a22b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">modalForm.vue👇</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="6b62" class="ln lo it lj b gy lp lq l lr ls">&lt;template&gt;<br/>    &lt;form <em class="lt">enctype</em>="multipart/form-data"&gt;<br/>        &lt;div <em class="lt">class</em>="form-inputs"&gt;<br/>            &lt;input <em class="lt">type</em>="file" <em class="lt">@change</em>="p.selectFile" <em class="lt">name</em>="itempic"&gt;<br/>            &lt;input <em class="lt">type</em>="text" <em class="lt">@change</em>="disabled = <em class="lt">false</em>"&gt;<br/>            &lt;textarea <em class="lt">placeholder</em>="description"/&gt;<br/>        &lt;/div&gt;<br/>        <strong class="lj iu">&lt;slot <em class="lt">name</em>="submit"/&gt;<br/>        &lt;slot <em class="lt">name</em>="validation" <em class="lt">class</em>="errorBar"/&gt;</strong><br/>    &lt;/form&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>    <em class="lt">export default </em>{<br/>        data() {<br/>            <em class="lt">return </em>{<br/>                p: <em class="lt">this</em>.$parent,<br/>            }<br/>        }<br/>    }<br/>&lt;/script&gt;</span></pre><p id="0af5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在创建表单和更新表单中，我们有相同的输入，但是有不同的提交按钮和不同的验证。这就是<strong class="kk iu">槽</strong>的用途。</p><p id="a19d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以在表单组件和模态组件中设置槽，我们可以填充这些槽。所以在updateItemModal组件文件中，我们可以有这样的内容:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="15a4" class="ln lo it lj b gy lp lq l lr ls">&lt;modal-form&gt;<br/>    &lt;button <strong class="lj iu"><em class="lt">slot</em>="submit"</strong> <em class="lt">@click.prevent</em>="update(item)" <em class="lt">:disabled</em>="disabled"&gt;Change Item Details&lt;/button&gt;<br/>    &lt;div <strong class="lj iu"><em class="lt">slot</em>="validation"</strong>&gt;{{validation}}&lt;/div&gt;<br/>&lt;/modal-form&gt;</span></pre><p id="c1e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mx my mz lj b"><strong class="kk iu">slot="submit"</strong></code>允许您填充提交槽，<code class="fe mx my mz lj b"><strong class="kk iu">slot="validation"</strong></code>允许您填充验证槽。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="4e2e" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">将当前数据输入输入</h2><p id="212d" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">当您通过更改描述等方式更新项目时，查看您正在更改的描述可能会很有用。我们应该将项目数据输入到表单输入中。</p><p id="fad3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">updateItemModal的数据():</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="75ae" class="ln lo it lj b gy lp lq l lr ls">data() {<br/>    <em class="lt">return </em>{<br/>        name: <em class="lt">this</em>.item.name,<br/>        description: <em class="lt">this</em>.item.description,<em class="lt"><br/>    </em>}<br/>},</span></pre><p id="b183" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在表格中使用v-model</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="5c63" class="ln lo it lj b gy lp lq l lr ls">&lt;form <em class="lt">enctype</em>="multipart/form-data"&gt;<br/>    &lt;div <em class="lt">class</em>="form-inputs"&gt;<br/>        &lt;input <em class="lt">type</em>="text" <strong class="lj iu"><em class="lt">v-model</em>="p.name"</strong> <em class="lt">@change</em>="disabled = <em class="lt">false</em>"&gt;<br/>        &lt;textarea <strong class="lj iu"><em class="lt">v-model</em>="p.description"</strong> <em class="lt">placeholder</em>="description"/&gt;<br/>    &lt;/div&gt;<br/>    &lt;slot <em class="lt">name</em>="submit"/&gt;<br/>    &lt;slot <em class="lt">name</em>="validation" <em class="lt">class</em>="errorBar"/&gt;<br/>&lt;/form&gt;</span></pre><p id="05b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在名称和描述应该出现在表单输入中。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="74b4" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">更新Modal的提交方法</h2><p id="4715" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">这里的提交方式是<code class="fe mx my mz lj b"><strong class="kk iu">update(item)</strong></code></p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c5d3" class="ln lo it lj b gy lp lq l lr ls">&lt;button <em class="lt">slot</em>="submit" <em class="lt">@click.prevent</em>="update(item)" <em class="lt">:disabled</em>="disabled"&gt;Change Item Details&lt;/button&gt;</span></pre><p id="1235" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它通过提交按钮运行。</p><figure class="le lf lg lh gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="2769" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要追加表单数据并发布它。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="5a7a" class="ln lo it lj b gy lp lq l lr ls">update(item) {<br/>    <em class="lt">let </em>fd = <em class="lt">new </em>FormData();<br/>    fd.append('itempic', <em class="lt">this</em>.file);<br/>    fd.append('name', <em class="lt">this</em>.name);<br/>    fd.append('description', <em class="lt">this</em>.description);<br/>    <br/>    axios.post(`api/portfolio/${item.id}`,fd)<br/>},</span></pre><p id="ad8a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们重构一下。我们可以在单独的函数中追加表单数据并返回<code class="fe mx my mz lj b"><strong class="kk iu">fd</strong></code>。</p><p id="84e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mx my mz lj b"><strong class="kk iu">this.appendFormData()</strong></code> <strong class="kk iu"> </strong>将代表返回的<code class="fe mx my mz lj b"><strong class="kk iu">fd</strong></code></p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="be30" class="ln lo it lj b gy lp lq l lr ls">appendFormData() {<br/>    <em class="lt">let</em><strong class="lj iu"><em class="lt"> </em>fd</strong> = <em class="lt">new </em>FormData();<br/>    fd.append('itempic', <em class="lt">this</em>.file);<br/>    fd.append('name', <em class="lt">this</em>.name);<br/>    fd.append('description', <em class="lt">this</em>.description);<br/>    <strong class="lj iu"><em class="lt">return </em>fd;</strong><br/>},<br/>update(item) {<br/>    <em class="lt">let </em>fd = <strong class="lj iu"><em class="lt">this</em>.appendFormData();</strong><br/>    axios.post(`api/portfolio/${item.id}`,fd)<br/>}</span></pre><p id="efbf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以将<code class="fe mx my mz lj b"><strong class="kk iu">this.appendFormData()</strong></code>缩短为<code class="fe mx my mz lj b"><strong class="kk iu">let</strong></code>，用axios.post发布</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="cc27" class="ln lo it lj b gy lp lq l lr ls">update(item) {<br/>    <em class="lt">let </em><strong class="lj iu">fd</strong> = <em class="lt">this</em>.appendFormData()<strong class="lj iu">;</strong><br/>    axios.post(`api/portfolio/${item.id}`,<strong class="lj iu">fd</strong>)<br/>}</span></pre><p id="95f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">submit按钮将被禁用，直到computed中的validation()通过。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="6fbd" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">前端验证(用于更新)</h2><p id="1459" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">我们需要检查至少有一个字段与检索到的数据不同。</p><p id="5730" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仅当输入与检索到的数据不同时，才将this.disabled设置为true</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="f1b0" class="ln lo it lj b gy lp lq l lr ls">validation(){<br/>    <em class="lt">let </em>i = <em class="lt">this</em>.item;<br/>    <em class="lt">if </em>(<em class="lt">this</em>.name !== i.name || <em class="lt">this</em>.description !== i.description) {<br/>        <em class="lt">this</em>.disabled = <em class="lt">false<br/>    </em>} <em class="lt">else </em>{<br/>        <em class="lt">this</em>.disabled = <em class="lt">true<br/>    </em>}<br/>}</span></pre><p id="d57b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">较短的版本</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="4a55" class="ln lo it lj b gy lp lq l lr ls">validation(){<br/>    <em class="lt">let </em>i = <em class="lt">this</em>.item;<br/>    <em class="lt">this</em>.disabled = !(<em class="lt">this</em>.name !== i.name || <em class="lt">this</em>.description !== i.description);<br/>}</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="f7de" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">api路线</h2><p id="c701" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">如果用户通过前端验证，按钮将被启用，新数据将被发布。为此，我们需要在api routes文件中键入以下内容。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="0a7b" class="ln lo it lj b gy lp lq l lr ls">Route::<em class="lt">post</em>('/portfolio/{id}', 'PortfolioController@update');</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="e999" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">投资组合控制器的更新功能</h2><p id="8ff0" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">我们来写更新函数吧。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="6403" class="ln lo it lj b gy lp lq l lr ls"><em class="lt">public function </em>update(Request $request, <strong class="lj iu">$id</strong>)<br/>{<br/>    $file = $request-&gt;itempic;<br/>    $hashName = $file-&gt;hashName();<br/>    $this-&gt;resizeAndStore($file, $hashName);<br/>    $this-&gt;<strong class="lj iu">updateDetails</strong>($hashName, <strong class="lj iu">$id</strong>);<br/>}</span><span id="cb2e" class="ln lo it lj b gy nj lq l lr ls"><em class="lt">public function </em>store(Request $request) {<br/>    $file = $request-&gt;itempic;<br/>    $hashName = $file-&gt;hashName();<br/>    $this-&gt;resizeAndStore($file, $hashName);<br/>    $this-&gt;storeDetails($hashName);<br/>}</span></pre><p id="6c24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意update和store函数之间的相似之处和不同之处。两个函数都需要<strong class="kk iu"> itempic </strong>并且都需要<strong class="kk iu">散列itempic文件的名称</strong>。</p><p id="b510" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不同之处在于最后，store函数需要存储新的细节，而update函数需要更新已经存在的项目的细节。</p><p id="2ade" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还没有<code class="fe mx my mz lj b"><strong class="kk iu">updateDetails</strong>($hashName, <strong class="kk iu">$id</strong>)</code>功能。让我们创造它</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="1c22" class="ln lo it lj b gy lp lq l lr ls"><em class="lt">private function </em>updateDetails($hashName, <strong class="lj iu">$id</strong>) {<br/>    $item = <strong class="lj iu">PortfolioItem::<em class="lt">find</em>($id);</strong><br/>    $item-&gt;img_path = $hashName;<br/>    $item-&gt;description = request()-&gt;description;<br/>    $item-&gt;name = request()-&gt;name;<br/>    <em class="lt">return </em>$item-&gt;save();<br/>}</span></pre><p id="de0e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，除了第一行之外，updateDetails函数和storeDetails函数没有太大的区别。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="8c4f" class="ln lo it lj b gy lp lq l lr ls"><em class="lt">private function </em>storeDetails($hashName) {<br/>    $item = <em class="lt">new </em>PortfolioItem();<br/>    $item-&gt;img_path = $hashName;<br/>    $item-&gt;description = request()-&gt;description;<br/>    $item-&gt;name = request()-&gt;name;<br/>    $item-&gt;save();<br/>}</span></pre><p id="fac4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以重构这个。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="03a1" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">重构存储()和更新()</h2><p id="7778" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">我们可以移动私有函数的第一行来存储、更新和传递<code class="fe mx my mz lj b"><strong class="kk iu">$item</strong></code></p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="d8cd" class="ln lo it lj b gy lp lq l lr ls"><em class="lt">public function </em>store(Request $request) {<br/>    $file = $request-&gt;itempic;<br/>    $hashName = $file-&gt;hashName();<br/>    $this-&gt;resizeAndStore($file, $hashName);<br/>    <strong class="lj iu">$item = <em class="lt">new </em>PortfolioItem();</strong><br/>    $this-&gt;storeDetails($hashName, <strong class="lj iu">$item</strong>);<br/>}</span><span id="32ca" class="ln lo it lj b gy nj lq l lr ls"><em class="lt">private function </em>storeDetails($hashName, <strong class="lj iu">$item</strong>) {<br/>    $item-&gt;img_path = $hashName;<br/>    $item-&gt;description = request()-&gt;description;<br/>    $item-&gt;name = request()-&gt;name;<br/>    $item-&gt;save();<br/>}</span></pre><p id="61db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在这个相同的<code class="fe mx my mz lj b"><strong class="kk iu">storeDetails()</strong></code>函数可以用于<code class="fe mx my mz lj b"><strong class="kk iu">update()</strong></code>函数。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="1402" class="ln lo it lj b gy lp lq l lr ls">$file = $request-&gt;itempic;<br/>$hashName = $file-&gt;hashName();<br/>$this-&gt;resizeAndStore($file, $hashName);<br/><strong class="lj iu">$item = PortfolioItem::<em class="lt">find</em>($id);</strong><br/>$this-&gt;<strong class="lj iu">storeDetails</strong>($hashName, <strong class="lj iu">$item</strong>);</span></pre><p id="aa75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在可以删除updateDetails()</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="d71b" class="ln lo it bd mb mc md dn me mf mg dp mh kr mi mj mk kv ml mm mn kz mo mp mq mr bi translated">勾选清单</h2><p id="3a78" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr mu kt ku kv mv kx ky kz mw lb lc ld im bi translated">我们可以从列表中勾掉前端验证。</p><ul class=""><li id="0d00" class="nk nl it kk b kl km ko kp kr nm kv nn kz no ld np nq nr ns bi translated">前端验证(用于更新functionality)☑️</li><li id="3366" class="nk nl it kk b kl nt ko nu kr nv kv nw kz nx ld np nq nr ns bi translated">后端验证(用于更新功能)</li><li id="8551" class="nk nl it kk b kl nt ko nu kr nv kv nw kz nx ld np nq nr ns bi translated">更新和删除功能(读取完成)</li></ul><p id="99cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi">—</p><ul class=""><li id="2df5" class="nk nl it kk b kl km ko kp kr nm kv nn kz no ld np nq nr ns bi translated">重构组合控制器</li></ul><p id="05a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi">—</p><ul class=""><li id="0683" class="nk nl it kk b kl km ko kp kr nm kv nn kz no ld np nq nr ns bi translated">带文本的图像(Portfolio.vue)</li><li id="7dd9" class="nk nl it kk b kl nt ko nu kr nv kv nw kz nx ld np nq nr ns bi translated">具有更大图像和描述的模型(Portfolio.vue)</li><li id="65d0" class="nk nl it kk b kl nt ko nu kr nv kv nw kz nx ld np nq nr ns bi translated">modal (Portfolio.vue)上的关闭按钮</li></ul></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="8417" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下一章，我们将致力于后端验证(更新功能)</p><div class="ny nz gp gr oa ob"><a rel="noopener  ugc nofollow" target="_blank" href="/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-ten-a669461c51ad"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第十章</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">更新功能的后端验证</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">itnext.io</p></div></div><div class="ok l"><div class="ol l om on oo ok op oq ob"/></div></div></a></div></div></div>    
</body>
</html>
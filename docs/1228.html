<html>
<head>
<title>How to logout after inactivity or idle — AngularJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在不活动或空闲后注销— AngularJS</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-logout-after-inactivity-or-idle-angularjs-4b97789ba1ac?source=collection_archive---------2-----------------------#2018-08-16">https://itnext.io/how-to-logout-after-inactivity-or-idle-angularjs-4b97789ba1ac?source=collection_archive---------2-----------------------#2018-08-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/550d34fe4b933e9d8e1b2548bef34e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5cg-SKkUONl3KzUAtLQ6_A.jpeg"/></div></figure><p id="be29" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你正在开发一个很棒的应用程序，你想注销在一定时间内没有任何活动的用户——是的，这是他们应得的(只是和:D开玩笑)</p><p id="931d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有一个包名<a class="ae ks" href="https://github.com/HackedByChinese/ng-idle" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ng-idle </strong> </a>你可以在这种情况下使用，如果你想尝试一下，他们也有Angular 2+的版本。然而，在这篇文章中，我将在AngularJS 1.x上做一个演示——是的，我现在正和那些过时的家伙一起工作。</p><p id="ae47" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你想看一眼最终产品，你可以在<a class="ae ks" href="https://next.plnkr.co/plunk/Evsfb22xoDP6UjRJ" rel="noopener ugc nofollow" target="_blank">广场</a>进行。</p><div class="kt ku gp gr kv kw"><a href="https://next.plnkr.co/plunk/Evsfb22xoDP6UjRJ" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab fo"><div class="ky ab kz cl cj la"><h2 class="bd ir gy z fp lb fr fs lc fu fw ip bi translated">AngularJS —自动注销</h2><div class="ld l"><h3 class="bd b gy z fp lb fr fs lc fu fw dk translated">因不活动而注销用户</h3></div><div class="le l"><p class="bd b dl z fp lb fr fs lc fu fw dk translated">next.plnkr.co</p></div></div></div></a></div><p id="e8ae" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">创建一个AngularJS项目</strong></p><p id="c476" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嗯，你只需要一个html和/或JavaScript文件来运行AngularJS项目</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="be22" class="lo lp iq lk b gy lq lr l ls lt">// index.html</span><span id="212d" class="lo lp iq lk b gy lu lr l ls lt">&lt;!doctype html&gt;<br/>&lt;html <strong class="lk ir">ng-app="myApp"</strong>&gt;<br/>&lt;head&gt;<br/>    <strong class="lk ir">&lt;script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular.js"&gt;&lt;/script&gt;</strong><br/>    &lt;script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular-animate.js"&gt;&lt;/script&gt;<br/>    &lt;script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular-sanitize.js"&gt;&lt;/script&gt;<br/>    &lt;script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-2.5.0.js"&gt;&lt;/script&gt;<br/>    <strong class="lk ir">&lt;script src="</strong><a class="ae ks" href="https://cdnjs.cloudflare.com/ajax/libs/ng-idle/1.3.2/angular-idle.min.js" rel="noopener ugc nofollow" target="_blank"><strong class="lk ir">https://cdnjs.cloudflare.com/ajax/libs/ng-idle/1.3.2/angular-idle.min.js</strong></a><strong class="lk ir">"&gt;&lt;/script&gt;</strong><br/>    <strong class="lk ir">&lt;script src="app.js"&gt;&lt;/script&gt;</strong><br/>    &lt;link href="//netdna.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;section <strong class="lk ir">ng-controller="DemoCtrl"</strong>&gt;<br/>        &lt;p&gt;<br/>            &lt;button type="button" class="btn btn-success" ng-hide="started" ng-click="start()"&gt;Start Demo&lt;/button&gt;<br/>            &lt;button type="button" class="btn btn-danger" ng-show="started" ng-click="stop()"&gt;Stop Demo&lt;/button&gt;<br/>        &lt;/p&gt;<br/>    &lt;/section&gt;<br/>&lt;/body&gt;</span><span id="0afd" class="lo lp iq lk b gy lu lr l ls lt">&lt;/html&gt;</span></pre><p id="b931" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我将<strong class="jw ir"> angularjs </strong>和<strong class="jw ir"> angular-idle </strong>嵌入到html文件的头部。其他的只是装饰。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="3003" class="lo lp iq lk b gy lq lr l ls lt">// app.js </span><span id="e9d6" class="lo lp iq lk b gy lu lr l ls lt">angular.module('myApp', ['ngAnimate', 'ngSanitize', 'ui.bootstrap', 'ngIdle']);</span><span id="4360" class="lo lp iq lk b gy lu lr l ls lt">angular.module('myApp').config(['KeepaliveProvider', 'IdleProvider', function(KeepaliveProvider, IdleProvider) {</span><span id="9d68" class="lo lp iq lk b gy lu lr l ls lt">    // configure Idle settings<br/>    IdleProvider.idle(5);<br/>    IdleProvider.timeout(5);<br/>    KeepaliveProvider.interval(10);</span><span id="b315" class="lo lp iq lk b gy lu lr l ls lt">    IdleProvider.interrupt('keydown wheel mousedown touchstart touchmove scroll');<br/>}]);</span><span id="ef64" class="lo lp iq lk b gy lu lr l ls lt">angular.module('myApp').controller('DemoCtrl', function ($scope, Idle, Keepalive, $uibModal) { </span><span id="ebc4" class="lo lp iq lk b gy lu lr l ls lt"> $scope.$on('IdleStart', function() {<br/>   <!-- -->// the user appears to have gone idle<br/> });</span><span id="54f1" class="lo lp iq lk b gy lu lr l ls lt"> $scope.$on('IdleTimeout', function() {<br/>   <!-- -->// the user has timed out, let log them out<br/> });</span><span id="dc9f" class="lo lp iq lk b gy lu lr l ls lt"> $scope.$on('IdleEnd', function() {<br/>  <!-- -->// the user has come back from AFK and is doing stuff<br/> });</span><span id="035e" class="lo lp iq lk b gy lu lr l ls lt">});</span><span id="52e0" class="lo lp iq lk b gy lu lr l ls lt">angular.module('myApp').config(function(IdleProvider, KeepaliveProvider) {<br/>    IdleProvider.idle(5);<br/>    IdleProvider.timeout(5);<br/>    KeepaliveProvider.interval(10);<br/>});</span></pre><p id="0d70" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">创建警告和超时模式</strong></p><p id="5a00" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">警告模式—这将在超时前显示</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="77fd" class="lo lp iq lk b gy lq lr l ls lt">// warning-dialog.html</span><span id="cdfe" class="lo lp iq lk b gy lu lr l ls lt">&lt;div class="modal-header"&gt;<br/>    &lt;h3 class="modal-title" id="modal-title"&gt;{{ pc.title }}&lt;/h3&gt;<br/>&lt;/div&gt;<br/>&lt;div idle-countdown="countdown" ng-init="countdown=5" class="modal-body" id="modal-body"&gt;<br/>        &lt;uib-progressbar max="5" value="5" animate="false" class="progress-striped active"&gt;You'll be logged out in {{countdown}} second(s).&lt;/uib-progressbar&gt;<br/>&lt;/div&gt;<br/>&lt;div class="modal-footer"&gt;<br/>    &lt;button class="btn btn-primary" type="button" ng-click="pc.ok()"&gt;OK&lt;/button&gt;<br/>    &lt;button class="btn btn-warning" type="button" ng-click="pc.cancel()"&gt;Cancel&lt;/button&gt;<br/>&lt;/div&gt;</span></pre><p id="d1c8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">超时模式—这将在警告模式之后显示，用户不做任何事情。在此阶段，用户已经注销。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="22a3" class="lo lp iq lk b gy lq lr l ls lt">// timeout-dialog.html</span><span id="d1f3" class="lo lp iq lk b gy lu lr l ls lt">&lt;div class="modal-header"&gt;<br/>    &lt;h3 id="modal-title"&gt;You've Timed Out!&lt;/h3&gt;<br/>&lt;/div&gt;<br/>&lt;div class="modal-body" id="modal-body"&gt;<br/>    &lt;p&gt;<br/>        You were idle too long...<br/>    &lt;/p&gt;<br/>&lt;/div&gt;</span></pre><p id="72e5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请检查<a class="ae ks" href="https://next.plnkr.co/plunk/Evsfb22xoDP6UjRJ" rel="noopener ugc nofollow" target="_blank">按钮</a>了解完整的工作项目。</p><p id="bc4d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">希望这有所帮助:)</p></div></div>    
</body>
</html>
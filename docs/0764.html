<html>
<head>
<title>How to use Drizzle (Truffle and React) to make the best front end for your Ethereum DApp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用毛毛雨(松露和反应)，使你的以太坊DApp最好的前端</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-use-drizzle-truffle-and-react-to-make-the-best-front-end-for-your-ethereum-dapp-ee09c8e94eae?source=collection_archive---------2-----------------------#2018-05-23">https://itnext.io/how-to-use-drizzle-truffle-and-react-to-make-the-best-front-end-for-your-ethereum-dapp-ee09c8e94eae?source=collection_archive---------2-----------------------#2018-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/e15cc42c2b83836503e114879fd3aa26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r_1OGTn-bLKQWleca2emcg.png"/></div></div></figure><div class=""/><p id="866d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我正在做一个DApp，刚刚开始开发前端。起初，我只是使用Web3和React，但试图连接到MetaMask并让一切都变得被动是一场噩梦。</p><p id="1ff4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是毛毛雨的由来。</p><p id="19ff" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">毛毛雨是一个负责处理用户提供者(MetaMask，Mist等)的库。)并让所有传入的数据都能很好地与React一起播放。唯一的问题是开始时有点混乱。我花了大约3个小时才弄明白毛毛雨在做什么，所以我想确保没有人会经历这些。</p><h1 id="6124" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">准备松露和毛毛雨</h1><p id="e970" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">第一步是设置松露和毛毛雨。Truffle附带了一组基本上只是模板的“盒子”。<a class="ae lz" href="http://truffleframework.com/boxes/drizzle" rel="noopener ugc nofollow" target="_blank">按照以下步骤</a>设置你的毛毛雨模板。</p><p id="eb51" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将建立一个简单的契约和一个基本的前端小集合松露。这个项目的主要文件是<code class="fe ma mb mc md b">Home</code>布局(<code class="fe ma mb mc md b">Home.js</code>)。这就是毛毛雨发挥作用的地方。</p><p id="ae5d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是令人困惑的地方。</p><h1 id="3e9d" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">Home.js，它是怎么获取数据的？</h1><p id="a236" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">首先，看一下HomeContainer.js。</p><figure class="me mf mg mh gt is"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="6deb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">mapStateToProps</code>将要告诉毛毛你想要得到哪些契约<strong class="ka jc">作为有状态道具</strong>。当您调用<code class="fe ma mb mc md b">drizzleConnect</code>时，这些契约状态将作为道具传递给您的组件。</p><p id="4d48" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">这些道具只是状态，包含您收到的某个合同的数据。你不能用这些东西打任何电话。</strong></p><p id="dc3f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您想要进行任何契约调用，您需要使用通过上下文赋予组件的<code class="fe ma mb mc md b">drizzle</code>变量(当我们创建自己的组件时，这将更有意义)。Home并不要求使用<code class="fe ma mb mc md b">drizzle</code>变量，所以它需要一些帮助来获取数据。</p><p id="3ab7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看看Home.js中的一行代码</p><figure class="me mf mg mh gt is"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="36d1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">契约<code class="fe ma mb mc md b">SimpleStorage</code>有一个名为<code class="fe ma mb mc md b">storedData</code>的方法，它简单地返回契约中存储的任何数据。</p><p id="c70e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ContractData是<code class="fe ma mb mc md b">drizzle-react-components</code>给我们的一个组件。</p><p id="4a6e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae lz" href="https://github.com/trufflesuite/drizzle-react-components/blob/master/src/ContractData.js" rel="noopener ugc nofollow" target="_blank">你可以在这里查看ContractData的源代码。</a></p><p id="da99" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ContractData是它自己的毛毛雨连接组件，它将调用合同并将数据显示为文本。这对测试来说很好，但是如果我们想用另一种方式呈现数据呢？</p><h1 id="86a8" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建我们自己的毛毛雨组件</h1><p id="f334" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">首先，让我们制作容器。我将把这个组件称为GetTokens，因为它将简单地从<code class="fe ma mb mc md b">TutorialToken</code>合同中获取当前用户的余额。</p><figure class="me mf mg mh gt is"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="befb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe ma mb mc md b">mapStateToProps</code>中，我告诉毛毛我想从<code class="fe ma mb mc md b">TutorialToken</code>合同中得到数据作为道具。然后我调用drizzleConnect来创建容器，使用GetTokens作为组件。</p><figure class="me mf mg mh gt is"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="751f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先看一下<strong class="ka jc">第31–33行</strong>。我确保我指定了这个组件应该在上下文中接收<code class="fe ma mb mc md b">drizzle</code>变量。这是保存我的合同的所有实际对象并允许我调用的东西。</p><p id="c122" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在看第9行和第10行。我从上下文中获取<code class="fe ma mb mc md b">drizzle</code>变量，然后进行<code class="fe ma mb mc md b">balanceOf</code> <strong class="ka jc"> cacheCall </strong>，它将<strong class="ka jc">返回数据</strong>的键，并且<strong class="ka jc">将结果</strong>缓存在TutorialToken属性中。</p><p id="e09e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在需要使用这个键来获取数据。</p><p id="6fdc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka jc">第21行</strong>中，我们现在看到合同道具是如何使用的。作为道具传递的<code class="fe ma mb mc md b">TutorialToken</code>对象对于每个方法都有一个对象。当对一个方法进行调用时，属性将被反应性地用结果更新。</p><p id="8058" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我们使用从<code class="fe ma mb mc md b">cacheCall</code>中获得的<code class="fe ma mb mc md b">dataKey</code>来获取值。</p><h1 id="d782" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="c531" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我知道我没有把它写好，但是希望这个从契约中接收数据的组件的简单例子会有所帮助！</p><p id="3d91" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总之，您需要获得一个契约的状态作为道具，而且还需要获得毛毛雨变量以便进行调用。</p><p id="05cf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果还有什么困惑，请在评论中告诉我，我很乐意帮忙！</p></div></div>    
</body>
</html>
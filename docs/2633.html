<html>
<head>
<title>How to create a custom Ubuntu live from scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从头开始创建自定义Ubuntu live</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-a-custom-ubuntu-live-from-scratch-dd3b3f213f81?source=collection_archive---------0-----------------------#2019-06-29">https://itnext.io/how-to-create-a-custom-ubuntu-live-from-scratch-dd3b3f213f81?source=collection_archive---------0-----------------------#2019-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/809a205464bf5c54dec381e40db63b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mv-phaoq4nPWKlLaJ5V-Og.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Ethan Robertson 在<a class="ae kc" href="https://unsplash.com/search/photos/circle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="af56" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这个过程展示了如何从头开始创建一个<strong class="km ir">可引导的</strong>和<strong class="km ir">可安装的</strong> Ubuntu Live(以及自动硬件检测和配置)。</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><div class="li lj lk ll gt lm"><a href="https://github.com/mvallim/live-custom-ubuntu-from-scratch" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">mvallim/live-custom-Ubuntu-从头开始</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">这个程序可以创建一个可引导和不可安装的Ubuntu Live(以及自动硬件检测…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">github.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma jw lm"/></div></div></a></div></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="ed61" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">先决条件(GNU/Linux Debian/Ubuntu)</h1><p id="c88f" class="pw-post-body-paragraph kk kl iq km b kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld nd lf lg lh ij bi translated">安装构建环境所需的应用程序。</p><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="e7e4" class="nj mc iq nf b gy nk nl l nm nn">sudo apt-get install \<br/>    binutils \<br/>    debootstrap \<br/>    squashfs-tools \<br/>    xorriso \<br/>    grub-pc-bin \<br/>    grub-efi-amd64-bin \<br/>    mtools<br/>    <br/>mkdir $HOME/live-ubuntu-from-scratch</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="901e" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">引导程序</h1><h2 id="b27b" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">结账引导程序</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="7467" class="nj mc iq nf b gy nk nl l nm nn">sudo debootstrap \<br/>   --arch=amd64 \<br/>   --variant=minbase \<br/>   focal \<br/>   $HOME/live-ubuntu-from-scratch/chroot \<br/>   <a class="ae kc" href="http://us.archive.ubuntu.com/ubuntu/" rel="noopener ugc nofollow" target="_blank">http://us.archive.ubuntu.com/ubuntu/</a></span></pre><blockquote class="nz oa ob"><p id="b60e" class="kk kl oc km b kn ko kp kq kr ks kt ku od kw kx ky oe la lb lc of le lf lg lh ij bi translated"><strong class="km ir"> debootstrap </strong>用于从零开始创建Debian基础系统，不需要<strong class="km ir"> dpkg </strong>或<strong class="km ir"> apt </strong>的可用性。它通过下载来做到这一点。deb文件，小心地将它们解压到一个目录中，这个目录最终可以被<strong class="km ir"> chrooted </strong>到。</p></blockquote><h2 id="2d11" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">配置外部挂载点</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="7ae9" class="nj mc iq nf b gy nk nl l nm nn">sudo mount --bind /dev $HOME/live-ubuntu-from-scratch/chroot/dev</span><span id="61f2" class="nj mc iq nf b gy og nl l nm nn">sudo mount --bind /run $HOME/live-ubuntu-from-scratch/chroot/run</span></pre><p id="df6b" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">由于我们将更新和安装软件包(其中有<strong class="km ir"> grub </strong>，这些挂载点在<strong class="km ir"> chroot </strong>环境中是必需的，因此我们能够无错误地完成安装。</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="fe4f" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">定义chroot环境</h1><blockquote class="oh"><p id="a0d8" class="oi oj iq bd ok ol om on oo op oq lh dk translated">在<a class="ae kc" href="https://en.wikipedia.org/wiki/Unix" rel="noopener ugc nofollow" target="_blank"> Unix </a> <a class="ae kc" href="https://en.wikipedia.org/wiki/Operating_system" rel="noopener ugc nofollow" target="_blank">操作系统</a>上的<strong class="ak"> chroot </strong>是为当前运行的进程及其<a class="ae kc" href="https://en.wikipedia.org/wiki/Child_process" rel="noopener ugc nofollow" target="_blank">子进程</a>改变表观<a class="ae kc" href="https://en.wikipedia.org/wiki/Root_directory" rel="noopener ugc nofollow" target="_blank">根目录</a>的操作。在这种修改的环境中运行的程序不能命名(因此通常不能访问)指定目录树之外的文件。术语“chroot”可以指chroot <a class="ae kc" href="https://en.wikipedia.org/wiki/System_call" rel="noopener ugc nofollow" target="_blank">系统调用</a>或chroot包装程序。修改后的环境被称为<strong class="ak"> chroot jail </strong>。</p></blockquote><blockquote class="nz oa ob"><p id="7a58" class="kk kl oc km b kn or kp kq kr os kt ku od ot kx ky oe ou lb lc of ov lf lg lh ij bi translated">参考:<a class="ae kc" href="https://en.wikipedia.org/wiki/Chroot" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Chroot</a></p></blockquote><h2 id="8b5b" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问chroot环境</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="5be6" class="nj mc iq nf b gy nk nl l nm nn">sudo chroot $HOME/live-ubuntu-from-scratch/chroot</span></pre><h2 id="2c37" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">配置挂载点、home和locale</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="1f07" class="nj mc iq nf b gy nk nl l nm nn">mount none -t proc /proc</span><span id="8d7a" class="nj mc iq nf b gy og nl l nm nn">mount none -t sysfs /sys</span><span id="910c" class="nj mc iq nf b gy og nl l nm nn">mount none -t devpts /dev/pts</span><span id="ef31" class="nj mc iq nf b gy og nl l nm nn">export HOME=/root</span><span id="249c" class="nj mc iq nf b gy og nl l nm nn">export LC_ALL=C</span></pre><p id="ac62" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这些挂载点在<strong class="km ir"> chroot </strong>环境中是必需的，因此我们能够无错误地完成安装。</p><h2 id="1618" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">设置自定义主机名</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="b25b" class="nj mc iq nf b gy nk nl l nm nn">echo "ubuntu-fs-live" &gt; /etc/hostname</span></pre><h2 id="3ecc" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">配置apt源。列表</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h2 id="a0f0" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">更新索引包</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="08a2" class="nj mc iq nf b gy nk nl l nm nn">apt-get update</span></pre><h2 id="c27d" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">安装系统d</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="3ec2" class="nj mc iq nf b gy nk nl l nm nn">apt-get install -y libterm-readline-gnu-perl systemd-sysv</span></pre><blockquote class="nz oa ob"><p id="70dd" class="kk kl oc km b kn ko kp kq kr ks kt ku od kw kx ky oe la lb lc of le lf lg lh ij bi translated">systemd 是Linux的系统和服务管理器。它提供了强大的并行化功能，使用套接字和D-Bus激活来启动服务，提供守护程序的按需启动，使用Linux控制组跟踪进程，维护装载和自动装载点，并实施复杂的基于事务依赖性的服务控制逻辑。</p></blockquote><h2 id="be6a" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">配置机器id和转移</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="ac75" class="nj mc iq nf b gy nk nl l nm nn">dbus-uuidgen &gt; /etc/machine-id</span><span id="6524" class="nj mc iq nf b gy og nl l nm nn">ln -fs /etc/machine-id /var/lib/dbus/machine-id</span></pre><blockquote class="nz oa ob"><p id="b965" class="kk kl oc km b kn ko kp kq kr ks kt ku od kw kx ky oe la lb lc of le lf lg lh ij bi translated"><code class="fe oy oz pa nf b">/etc/machine-id</code>文件包含安装或引导期间设置的本地系统的唯一机器ID。机器ID是一个以换行符结尾的十六进制32字符小写ID。从十六进制解码时，这相当于16字节/128位值。此ID可能不全是零。</p></blockquote><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="0935" class="nj mc iq nf b gy nk nl l nm nn">dpkg-divert --local --rename --add /sbin/initctl</span><span id="f5c0" class="nj mc iq nf b gy og nl l nm nn">ln -s /bin/true /sbin/initctl</span></pre><blockquote class="nz oa ob"><p id="8713" class="kk kl oc km b kn ko kp kq kr ks kt ku od kw kx ky oe la lb lc of le lf lg lh ij bi translated"><strong class="km ir"> dpkg-divert </strong>是用于设置和更新分流列表的实用程序。</p></blockquote><h2 id="34f3" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">安装实时系统所需的软件包</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="1783" class="nj mc iq nf b gy nk nl l nm nn">apt-get install -y \<br/>    sudo \<br/>    ubuntu-standard \<br/>    casper \<br/>    lupin-casper \<br/>    discover \<br/>    laptop-detect \<br/>    os-prober \<br/>    network-manager \<br/>    resolvconf \<br/>    net-tools \<br/>    wireless-tools \<br/>    wpagui \<br/>    locales \<br/>    grub-common \<br/>    grub-gfxpayload-lists \<br/>    grub-pc \<br/>    grub-pc-bin \<br/>    grub2-common</span><span id="8434" class="nj mc iq nf b gy og nl l nm nn">apt-get install -y --no-install-recommends linux-generic</span></pre><p id="b222" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">图形安装程序</p><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="79ec" class="nj mc iq nf b gy nk nl l nm nn">apt-get install -y \<br/>    ubiquity \<br/>    ubiquity-casper \<br/>    ubiquity-frontend-gtk \<br/>    ubiquity-slideshow-ubuntu \<br/>    ubiquity-ubuntu-artwork</span></pre><p id="3f07" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">下一个配置对话框将作为上一步将要安装的软件包的结果显示，这将在无需通知或执行任何事情的情况下发生。</p><ul class=""><li id="ab9a" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">配置键盘</li></ul><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/71d425e0db6c29e46d4aff890b340862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mlkn_s9h9vE5D-oKzfQ0bQ.png"/></div></div></figure><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/c6a8d3ea272e6f54e29b9474ec602924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PlmzKGhA_K15Za0uy6Widg.png"/></div></div></figure><ul class=""><li id="d671" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">控制台设置</li></ul><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/bd24c14d86b30d4df6458ebb0c82f87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cc2JDx-D9Q3rlbPnj4mAzg.png"/></div></div></figure><h2 id="e3ae" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">安装窗口管理器</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="933c" class="nj mc iq nf b gy nk nl l nm nn">apt-get install -y \<br/>    plymouth-theme-ubuntu-logo \<br/>    ubuntu-gnome-desktop \<br/>    ubuntu-gnome-wallpapers</span></pre><h2 id="4517" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">安装有用的应用程序</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="2b87" class="nj mc iq nf b gy nk nl l nm nn">apt-get install -y \<br/>    clamav-daemon \<br/>    terminator \<br/>    apt-transport-https \<br/>    curl \<br/>    vim \<br/>    nano \<br/>    less</span></pre><h2 id="815d" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated"><strong class="ak">安装Visual Studio代码(可选)</strong></h2><ul class=""><li id="5d8a" class="pb pc iq km b kn mz kr na kv pl kz pm ld pn lh pg ph pi pj bi translated">下载并安装密钥</li></ul><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="4fa7" class="nj mc iq nf b gy nk nl l nm nn">curl <a class="ae kc" href="https://packages.microsoft.com/keys/microsoft.asc" rel="noopener ugc nofollow" target="_blank">https://packages.microsoft.com/keys/microsoft.asc</a> | gpg --dearmor &gt; microsoft.gpg</span><span id="ab2e" class="nj mc iq nf b gy og nl l nm nn">install -o root -g root -m 644 microsoft.gpg /etc/apt/trusted.gpg.d/</span><span id="36b3" class="nj mc iq nf b gy og nl l nm nn">echo "deb [arch=amd64] <a class="ae kc" href="https://packages.microsoft.com/repos/vscode" rel="noopener ugc nofollow" target="_blank">https://packages.microsoft.com/repos/vscode</a> stable main" &gt; /etc/apt/sources.list.d/vscode.list</span><span id="746e" class="nj mc iq nf b gy og nl l nm nn">rm microsoft.gpg</span></pre><ul class=""><li id="ee59" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">然后更新包缓存并安装包</li></ul><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="e455" class="nj mc iq nf b gy nk nl l nm nn">apt-get update</span><span id="3e02" class="nj mc iq nf b gy og nl l nm nn">apt-get install -y code</span></pre><h2 id="e0d3" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated"><strong class="ak">安装谷歌浏览器(可选)</strong></h2><ul class=""><li id="845b" class="pb pc iq km b kn mz kr na kv pl kz pm ld pn lh pg ph pi pj bi translated">下载并安装密钥</li></ul><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="2b40" class="nj mc iq nf b gy nk nl l nm nn">wget -q -O - <a class="ae kc" href="https://dl-ssl.google.com/linux/linux_signing_key.pub" rel="noopener ugc nofollow" target="_blank">https://dl-ssl.google.com/linux/linux_signing_key.pub</a> | sudo apt-key add -</span><span id="2eb9" class="nj mc iq nf b gy og nl l nm nn">echo "deb <a class="ae kc" href="http://dl.google.com/linux/chrome/deb/" rel="noopener ugc nofollow" target="_blank">http://dl.google.com/linux/chrome/deb/</a> stable main" &gt; /etc/apt/sources.list.d/google-chrome.list</span></pre><ul class=""><li id="c5c3" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">然后更新包缓存并安装包</li></ul><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="ec3d" class="nj mc iq nf b gy nk nl l nm nn">apt-get update</span><span id="99b8" class="nj mc iq nf b gy og nl l nm nn">apt-get install google-chrome-stable</span></pre><h2 id="c2c2" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated"><strong class="ak">安装Java JDK 8(可选)</strong></h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="46ea" class="nj mc iq nf b gy nk nl l nm nn">apt-get update</span><span id="f364" class="nj mc iq nf b gy og nl l nm nn">apt-get install -y \<br/>     openjdk-8-jdk \<br/>     openjdk-8-jre</span></pre><h2 id="cb43" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">移除未使用的应用程序(可选)</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="79fa" class="nj mc iq nf b gy nk nl l nm nn">apt-get purge -y \<br/>     transmission-gtk \<br/>     transmission-common \<br/>     gnome-mahjongg \<br/>     gnome-mines \<br/>     gnome-sudoku \<br/>     aisleriot \<br/>     hitori</span></pre><h2 id="c215" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">移除未使用的包</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="532b" class="nj mc iq nf b gy nk nl l nm nn">apt-get autoremove -y</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="723a" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">重新配置包</h1><h2 id="18d7" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">生成语言环境</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="4b91" class="nj mc iq nf b gy nk nl l nm nn">dpkg-reconfigure locales</span></pre><ul class=""><li id="18a6" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">选择区域设置</li></ul><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/3638763608d20b6b3f3eb010465019c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pVjzG08yKV6PPzBVR5nEYg.png"/></div></div></figure><ul class=""><li id="64d0" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">选择默认区域设置</li></ul><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/e7ae53eca678825ebfb4689f9d037b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGpz_FktkVrKgfnYRtnMZQ.png"/></div></div></figure><h2 id="f7ce" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">重新配置resolvconf</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="1ff3" class="nj mc iq nf b gy nk nl l nm nn">dpkg-reconfigure resolvconf</span></pre><ul class=""><li id="3b63" class="pb pc iq km b kn ko kr ks kv pd kz pe ld pf lh pg ph pi pj bi translated">确认更改</li></ul><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/2b206a7118d91fd313e3e7acf834d0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAjWb5AwOG09hEOMG6TUkQ.png"/></div></div></figure><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/e52fefe4418a6aea7c3fadebf7903782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lS8Avi9qqB1f2CtCMELceQ.png"/></div></div></figure><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/8bbceb685e0aab848e9de3cf08d710ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uW7nTiyGP37zJE38UMDeHg.png"/></div></div></figure><h2 id="9e10" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">配置网络管理器</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h2 id="9e39" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">重新配置网络管理器</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="9e08" class="nj mc iq nf b gy nk nl l nm nn">dpkg-reconfigure network-manager</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="5f68" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">清理chroot环境</h1><h2 id="e3ad" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">如果您安装了软件，请确保运行</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="2404" class="nj mc iq nf b gy nk nl l nm nn">truncate -s 0 /etc/machine-id</span></pre><h2 id="bb64" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">移除分流</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="3754" class="nj mc iq nf b gy nk nl l nm nn">rm /sbin/initctl</span><span id="df47" class="nj mc iq nf b gy og nl l nm nn">dpkg-divert --rename --remove /sbin/initctl</span></pre><h2 id="1feb" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">清理</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="58e9" class="nj mc iq nf b gy nk nl l nm nn">apt-get clean</span><span id="30dc" class="nj mc iq nf b gy og nl l nm nn">rm -rf /tmp/* ~/.bash_history</span><span id="d4b2" class="nj mc iq nf b gy og nl l nm nn">umount /proc</span><span id="f885" class="nj mc iq nf b gy og nl l nm nn">umount /sys</span><span id="5be4" class="nj mc iq nf b gy og nl l nm nn">umount /dev/pts</span><span id="6700" class="nj mc iq nf b gy og nl l nm nn">export HISTSIZE=0</span><span id="73c5" class="nj mc iq nf b gy og nl l nm nn">exit</span></pre><h2 id="fd49" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">解除挂载点绑定</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="0bf8" class="nj mc iq nf b gy nk nl l nm nn">sudo umount $HOME/live-ubuntu-from-scratch/chroot/dev</span><span id="813f" class="nj mc iq nf b gy og nl l nm nn">sudo umount $HOME/live-ubuntu-from-scratch/chroot/run</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="0140" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated"><strong class="ak">创建光盘镜像目录并填充它</strong></h1><h2 id="8faa" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问构建目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="c701" class="nj mc iq nf b gy nk nl l nm nn">cd $HOME/live-ubuntu-from-scratch</span></pre><h2 id="75ff" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="1db9" class="nj mc iq nf b gy nk nl l nm nn">mkdir -p image/{casper,isolinux,install}</span></pre><h2 id="ecb5" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">复制内核映像</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="96c6" class="nj mc iq nf b gy nk nl l nm nn">sudo cp chroot/boot/vmlinuz-**-**-generic image/casper/vmlinuz</span><span id="4865" class="nj mc iq nf b gy og nl l nm nn">sudo cp chroot/boot/initrd.img-**-**-generic image/casper/initrd</span></pre><h2 id="bc54" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">复制memtest86+二进制(BIOS)</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="3e7c" class="nj mc iq nf b gy nk nl l nm nn">sudo cp chroot/boot/memtest86+.bin image/install/memtest86+</span></pre><h2 id="2265" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">下载并解压缩memtest86二进制文件(UEFI)</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="74e4" class="nj mc iq nf b gy nk nl l nm nn">wget --progress=dot <a class="ae kc" href="https://www.memtest86.com/downloads/memtest86-usb.zip" rel="noopener ugc nofollow" target="_blank">https://www.memtest86.com/downloads/memtest86-usb.zip</a> -O image/install/memtest86-usb.zip</span><span id="abee" class="nj mc iq nf b gy og nl l nm nn">unzip -p image/install/memtest86-usb.zip memtest86-usb.img &gt; image/install/memtest86</span><span id="4eb3" class="nj mc iq nf b gy og nl l nm nn">rm image/install/memtest86-usb.zip</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="8e05" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">Grub配置</h1><h2 id="f8c2" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问构建目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="a7a3" class="nj mc iq nf b gy nk nl l nm nn">cd $HOME/live-ubuntu-from-scratch</span></pre><h2 id="f737" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">为grub创建基点访问文件</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="0659" class="nj mc iq nf b gy nk nl l nm nn">touch image/ubuntu</span></pre><h2 id="a86c" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建image/isolinux/grub.cfg</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="ow ox l"/></div></figure></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="516f" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">创建清单</h1><p id="ee43" class="pw-post-body-paragraph kk kl iq km b kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld nd lf lg lh ij bi translated">在接下来的步骤中，清单的创建很重要，因为它告诉我们每个包的哪个版本被安装在活动版本中，哪些包将在将要安装的版本中被删除或保留(保存在硬盘中)。</p><h2 id="b817" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问构建目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="ffa1" class="nj mc iq nf b gy nk nl l nm nn">cd $HOME/live-ubuntu-from-scratch</span></pre><h2 id="cb78" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">生成清单</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="ow ox l"/></div></figure></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="44f5" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">压缩chroot</h1><p id="0cd8" class="pw-post-body-paragraph kk kl iq km b kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld nd lf lg lh ij bi translated">在<strong class="km ir"> chrooted </strong>环境中安装并预配置好所有东西之后，我们需要按照下面的步骤生成所有东西的映像。</p><h2 id="a6e3" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问构建目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="6d50" class="nj mc iq nf b gy nk nl l nm nn">cd $HOME/live-ubuntu-from-scratch</span></pre><h2 id="e4f9" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建方形</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="eddf" class="nj mc iq nf b gy nk nl l nm nn">sudo mksquashfs chroot image/casper/filesystem.squashfs</span></pre><blockquote class="nz oa ob"><p id="c461" class="kk kl oc km b kn ko kp kq kr ks kt ku od kw kx ky oe la lb lc of le lf lg lh ij bi translated">Squashfs 是一个用于Linux的高度压缩的只读文件系统。它使用zlib压缩来压缩文件、inodes和目录。系统中的索引节点非常小，所有块都被打包以最大限度地减少数据开销。最大支持64K的大于4K的块大小。<br/> <strong class="km ir"> Squashfs </strong>主要用于一般只读文件系统、存档(即在可能使用. tar.gz文件的情况下)，以及需要低开销的受限块设备/内存系统(如<strong class="km ir">嵌入式系统</strong>)。</p></blockquote><h2 id="1e70" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">写入filesystem.size</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="1ff0" class="nj mc iq nf b gy nk nl l nm nn">printf $(sudo du -sx --block-size=1 chroot | cut -f1) &gt; image/casper/filesystem.size</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="b109" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">创建磁盘定义</h1><p id="433c" class="pw-post-body-paragraph kk kl iq km b kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld nd lf lg lh ij bi translated"><strong class="km ir"> README </strong>文件通常可以在Linux LiveCD安装光盘上找到，比如Ubuntu Linux安装光盘；通常命名为"<strong class="km ir"> README.diskdefines </strong>"并可能在安装过程中被引用。</p><h2 id="d4df" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问构建目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="6335" class="nj mc iq nf b gy nk nl l nm nn">cd $HOME/live-ubuntu-from-scratch</span></pre><h2 id="f757" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建文件image/README.diskdefines</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="0149" class="nj mc iq nf b gy nk nl l nm nn">cat &lt;&lt;EOF &gt; image/README.diskdefines<br/>#define DISKNAME  Ubuntu from scratch<br/>#define TYPE  binary<br/>#define TYPEbinary  1<br/>#define ARCH  amd64<br/>#define ARCHamd64  1<br/>#define DISKNUM  1<br/>#define DISKNUM1  1<br/>#define TOTALNUM  0<br/>#define TOTALNUM0  1<br/>EOF</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="e58f" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">为LiveCD创建ISO映像(BIOS + UEFI)</h1><h2 id="d04c" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">访问图像目录</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="110b" class="nj mc iq nf b gy nk nl l nm nn">cd $HOME/live-ubuntu-from-scratch/image</span></pre><h2 id="cd87" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建grub UEFI映像</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="8a16" class="nj mc iq nf b gy nk nl l nm nn">grub-mkstandalone \<br/>   --format=x86_64-efi \<br/>   --output=isolinux/bootx64.efi \<br/>   --locales="" \<br/>   --fonts="" \<br/>   "boot/grub/grub.cfg=isolinux/grub.cfg"</span></pre><h2 id="89d1" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建包含EFI引导加载程序的FAT16 UEFI引导磁盘映像</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="11aa" class="nj mc iq nf b gy nk nl l nm nn">(<br/>   cd isolinux &amp;&amp; \<br/>   dd if=/dev/zero of=efiboot.img bs=1M count=10 &amp;&amp; \<br/>   sudo mkfs.vfat efiboot.img &amp;&amp; \<br/>   LC_CTYPE=C mmd -i efiboot.img efi efi/boot &amp;&amp; \<br/>   LC_CTYPE=C mcopy -i efiboot.img ./bootx64.efi ::efi/boot/<br/>)</span></pre><h2 id="f1d5" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建grub BIOS映像</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="767c" class="nj mc iq nf b gy nk nl l nm nn">grub-mkstandalone \<br/>   --format=i386-pc \<br/>   --output=isolinux/core.img \<br/>   --install-modules="linux16 linux normal iso9660 biosdisk memdisk search tar ls" \<br/>   --modules="linux16 linux normal iso9660 biosdisk search" \<br/>   --locales="" \<br/>   --fonts="" \<br/>   "boot/grub/grub.cfg=isolinux/grub.cfg"</span></pre><h2 id="cc77" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">组合可引导的grub cdboot.img</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="f145" class="nj mc iq nf b gy nk nl l nm nn">cat /usr/lib/grub/i386-pc/cdboot.img isolinux/core.img &gt; isolinux/bios.img</span></pre><h2 id="669d" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">生成md5sum.txt</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="01af" class="nj mc iq nf b gy nk nl l nm nn">sudo /bin/bash -c "(find . -type f -print0 | xargs -0 md5sum | grep -v "\./md5sum.txt" &gt; md5sum.txt)"</span></pre><h2 id="0df4" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">使用命令行从映像目录创建iso</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="2d26" class="nj mc iq nf b gy nk nl l nm nn">sudo xorriso \<br/>   -as mkisofs \<br/>   -iso-level 3 \<br/>   -full-iso9660-filenames \<br/>   -volid "Ubuntu from scratch" \<br/>   -output "../ubuntu-from-scratch.iso" \<br/>   -eltorito-boot boot/grub/bios.img \<br/>      -no-emul-boot \<br/>      -boot-load-size 4 \<br/>      -boot-info-table \<br/>      --eltorito-catalog boot/grub/boot.cat \<br/>      --grub2-boot-info \<br/>      --grub2-mbr /usr/lib/grub/i386-pc/boot_hybrid.img \<br/>   -eltorito-alt-boot \<br/>      -e EFI/efiboot.img \<br/>      -no-emul-boot \<br/>   -append_partition 2 0xef isolinux/efiboot.img \<br/>   -m "isolinux/efiboot.img" \<br/>   -m "isolinux/bios.img" \<br/>   -graft-points \<br/>      "/EFI/efiboot.img=isolinux/efiboot.img" \<br/>      "/boot/grub/bios.img=isolinux/bios.img" \<br/>      "."</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="e68f" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">另一种方法是，如果前一个失败，创建一个混合ISO</h1><h2 id="0845" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">创建一个ISOLINUX (syslinux)引导菜单</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="5dbd" class="nj mc iq nf b gy nk nl l nm nn">cat &lt;&lt;EOF&gt; isolinux/isolinux.cfg<br/>UI vesamenu.c32</span><span id="e4fc" class="nj mc iq nf b gy og nl l nm nn">MENU TITLE Boot Menu<br/>DEFAULT linux<br/>TIMEOUT 600<br/>MENU RESOLUTION 640 480<br/>MENU COLOR border       30;44   #40ffffff #a0000000 std<br/>MENU COLOR title        1;36;44 #9033ccff #a0000000 std<br/>MENU COLOR sel          7;37;40 #e0ffffff #20ffffff all<br/>MENU COLOR unsel        37;44   #50ffffff #a0000000 std<br/>MENU COLOR help         37;40   #c0ffffff #a0000000 std<br/>MENU COLOR timeout_msg  37;40   #80ffffff #00000000 std<br/>MENU COLOR timeout      1;37;40 #c0ffffff #00000000 std<br/>MENU COLOR msg07        37;40   #90ffffff #a0000000 std<br/>MENU COLOR tabmsg       31;40   #30ffffff #00000000 std</span><span id="0068" class="nj mc iq nf b gy og nl l nm nn">LABEL linux<br/> MENU LABEL Try Ubuntu FS<br/> MENU DEFAULT<br/> KERNEL /casper/vmlinuz<br/> APPEND initrd=/casper/initrd boot=casper</span><span id="e9d9" class="nj mc iq nf b gy og nl l nm nn">LABEL linux<br/> MENU LABEL Try Ubuntu FS (nomodeset)<br/> MENU DEFAULT<br/> KERNEL /casper/vmlinuz<br/> APPEND initrd=/casper/initrd boot=casper nomodeset<br/>EOF</span></pre><h2 id="8504" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">包括syslinux bios模块</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="1e8a" class="nj mc iq nf b gy nk nl l nm nn">apt install -y syslinux-common &amp;&amp; \<br/>cp /usr/lib/ISOLINUX/isolinux.bin isolinux/ &amp;&amp; \<br/>cp /usr/lib/syslinux/modules/bios/* isolinux/</span></pre><h2 id="b7c1" class="nj mc iq bd md no np dn mh nq nr dp ml kv ns nt mp kz nu nv mt ld nw nx mx ny bi translated">从图像目录创建iso</h2><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="50ad" class="nj mc iq nf b gy nk nl l nm nn">sudo xorriso \<br/>   -as mkisofs \<br/>   -iso-level 3 \<br/>   -full-iso9660-filenames \<br/>   -volid "Ubuntu from scratch" \<br/>   -output "../ubuntu-from-scratch.iso" \<br/> -isohybrid-mbr /usr/lib/ISOLINUX/isohdpfx.bin \<br/> -eltorito-boot \<br/>     isolinux/isolinux.bin \<br/>     -no-emul-boot \<br/>     -boot-load-size 4 \<br/>     -boot-info-table \<br/>     --eltorito-catalog isolinux/isolinux.cat \<br/> -eltorito-alt-boot \<br/>     -e /EFI/boot/efiboot.img \<br/>     -no-emul-boot \<br/>     -isohybrid-gpt-basdat \<br/> -append_partition 2 0xef EFI/boot/efiboot.img \<br/>   "$HOME/live-ubuntu-from-scratch/image"</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="062b" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">制作一个可引导的USB映像</h1><p id="31db" class="pw-post-body-paragraph kk kl iq km b kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld nd lf lg lh ij bi translated">简单易行，用“dd”</p><pre class="li lj lk ll gt ne nf ng nh aw ni bi"><span id="63ee" class="nj mc iq nf b gy nk nl l nm nn">sudo dd if=ubuntu-from-scratch.iso of=&lt;device&gt; status=progress oflag=sync</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="82d5" class="mb mc iq bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">摘要</h1><p id="e05c" class="pw-post-body-paragraph kk kl iq km b kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld nd lf lg lh ij bi translated">这就完成了从头开始创建一个活动的Ubuntu安装程序的过程。生成的ISO可以在虚拟机(如<code class="fe oy oz pa nf b">VirtualBox</code>)中进行测试，或者写入介质并从标准PC启动。</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="886a" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我希望你喜欢这篇文章，并学习如何从头开始创建你自己的定制Ubuntu映像。请随意查看我写的其他文章。</p><p id="7969" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">不要忘记在下面的评论中留下你的反馈。不断完善这篇文章中的内容非常重要。</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="ec92" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">回头见！！</p><p id="bc65" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">再见</p></div></div>    
</body>
</html>
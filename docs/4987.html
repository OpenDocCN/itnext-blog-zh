<html>
<head>
<title>Automatic Next.js sitemap using Contentful’s GraphQL API in a lambda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在lambda中使用Contentful的GraphQL API的自动Next.js站点地图</h1>
<blockquote>原文：<a href="https://itnext.io/automatic-next-js-sitemap-using-contentfuls-graphql-api-in-a-lambda-5e52ec6b96f6?source=collection_archive---------4-----------------------#2020-11-09">https://itnext.io/automatic-next-js-sitemap-using-contentfuls-graphql-api-in-a-lambda-5e52ec6b96f6?source=collection_archive---------4-----------------------#2020-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3f34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有很多解决方案<code class="fe kl km kn ko b">next-sitemap</code>等在构建时这样做，但我认为这种方法更酷，如果不是过分的话。</p><p id="e293" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只需要先做两件事:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="e855" class="kx ky iq ko b gy kz la l lb lc">&gt; npm i sitemap<br/>&gt; vercel secrets set HOSTNAME <a class="ae ld" href="http://www.domain.com" rel="noopener ugc nofollow" target="_blank">www.domain.com</a> production</span></pre><p id="bff8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">HOSTNAME</code> var是我们的FQDN，与我们在Google网站管理员工具、GA/GTM等中设置的主域相匹配。对于非生产，为了保持整洁，我们可以更改默认值w/ <code class="fe kl km kn ko b">VERCEL_URL</code></p><p id="6ad9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基本配置要求我们暴露<code class="fe kl km kn ko b">HOSTNAME</code>，添加从<code class="fe kl km kn ko b">/sitemap.xml</code>到<code class="fe kl km kn ko b">/api/sitemap.ts</code>的重写，并在<code class="fe kl km kn ko b">vercel.json</code>中设置一些头:</p><figure class="kp kq kr ks gt le"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="4588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后是函数本身:</p><figure class="kp kq kr ks gt le"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="dd24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还可以组合不同的内容类型，并为每种类型设置优先级，如下所示:</p><figure class="kp kq kr ks gt le"><div class="bz fp l di"><div class="lf lg l"/></div></figure></div></div>    
</body>
</html>
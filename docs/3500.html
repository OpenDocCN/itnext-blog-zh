<html>
<head>
<title>Tutorial: Newtonsoft JSON.NET for Structured Data &amp; SEO</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:面向结构化数据和SEO的Newtonsoft JSON.NET</h1>
<blockquote>原文：<a href="https://itnext.io/tutorial-newtonsoft-json-net-for-structured-data-seo-6ab2f2507733?source=collection_archive---------2-----------------------#2019-12-28">https://itnext.io/tutorial-newtonsoft-json-net-for-structured-data-seo-6ab2f2507733?source=collection_archive---------2-----------------------#2019-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/0a6e4d389c172ee54fe823119663d51b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2do9xNCAkF0WDqQ8_IkTgA.png"/></div></div></figure><div class=""/><p id="d4e6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用CMS构建C# MVC网站会使创建结构化数据变得困难；这反过来又刺激了谷歌上丰富的片段。</p><h2 id="f603" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">什么是丰富的片段？</h2><p id="81d4" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">丰富的片段是大多数搜索引擎的一个特征，这些搜索引擎使用结构化数据来提供比传统搜索结果更好的用户体验，并且可以<a class="ae lu" href="https://medium.com/@tristolliday/structured-data-unifying-the-web-for-the-better-2bcdd0df53ca?source=friends_link&amp;sk=fc6fa3ec1e1c652852fe4660368fa72a" rel="noopener">给你的网站更多的可见性</a>。</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/6aaf3388891893b3518e7159b8ceee9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/0*_CE3FXbF-f34hgbd.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">Google上丰富的片段，由结构化数据驱动。</figcaption></figure><h2 id="51eb" class="kw kx jb bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">如何向razor cshtml页面添加结构化数据</h2><p id="190c" class="pw-post-body-paragraph jy jz jb ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">结构化数据有三种形式，<code class="fe me mf mg mh b">json-ld</code>、<code class="fe me mf mg mh b">RDFa</code>和<code class="fe me mf mg mh b">microdata</code>。因为<code class="fe me mf mg mh b">RDFa</code>和<code class="fe me mf mg mh b">microdata</code>必须嵌入到html中，这很难追溯性地添加到模板中。为此，我们将重点放在<code class="fe me mf mg mh b">json-ld</code>上，它可以活在自己的<code class="fe me mf mg mh b">&lt;script&gt;</code>标签中。</p><p id="2a7b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本教程中，我们将在razor模板页面上添加<code class="fe me mf mg mh b">json-ld</code>。示例教程将构建在Umbraco 8上，但同样的方法应该适用于任何C# MVC解决方案。</p><p id="6c51" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们正在构建的例子是<a class="ae lu" href="https://developers.google.com/search/docs/data-types/qapage" rel="noopener ugc nofollow" target="_blank">问题&amp;答案丰富片段</a>，但是这个概念适用于所有丰富片段。</p><ol class=""><li id="a512" class="mi mj jb ka b kb kc kf kg kj mk kn ml kr mm kv mn mo mp mq bi translated">在您的文件中包含<a class="ae lu" href="https://www.newtonsoft.com/json" rel="noopener ugc nofollow" target="_blank">纽敦软件Json.NET</a>。<code class="fe me mf mg mh b">@using Newtonsoft.Json.Linq</code>。这是一个常用的库，可以在<a class="ae lu" href="https://www.nuget.org/packages/Newtonsoft.Json/" rel="noopener ugc nofollow" target="_blank"> NuGet </a>上找到。</li><li id="8f9e" class="mi mj jb ka b kb mr kf ms kj mt kn mu kr mv kv mn mo mp mq bi translated">从你的CMS/任何存储的地方提取你的数据。在这种情况下，我们使用<code class="fe me mf mg mh b">&lt;IEnumberable&lt;IPublishedElement&gt;&gt;</code>，但是任何可循环的数据源都应该工作。</li></ol><pre class="lw lx ly lz gt mw mh mx my aw mz bi"><span id="9ce7" class="kw kx jb mh b gy na nb l nc nd">@{ var questions = Model.Value&lt;IEnumerable&lt;IPublishedElement&gt;&gt;("questions"); }</span></pre><p id="6ad8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.接下来，我们需要用我们的Newtonsoft复制'<em class="ne">结构化数据'</em>'的<em class="ne">结构</em>。方便的是，Google在他们的文档中提供了每种类型的示例，或者查看schema.org的完整文档，了解如何使用JSON-LD构建结构化数据。</p><p id="dd27" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，这是我们试图复制的最后一个平面html示例:</p><pre class="lw lx ly lz gt mw mh mx my aw mz bi"><span id="da99" class="kw kx jb mh b gy na nb l nc nd">&lt;script type="application/ld+json"&gt;<br/>  {<br/>    "<a class="ae lu" href="http://twitter.com/context" rel="noopener ugc nofollow" target="_blank">@context</a>": "<a class="ae lu" href="https://schema.org" rel="noopener ugc nofollow" target="_blank">https://schema.org</a>",<br/>    "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "QAPage",<br/>    "mainEntity": {<br/>      "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Question",<br/>      "name": "How many ounces are there in a pound?",<br/>      "text": "I have taken up a new interest in baking and keep running across directions in ounces and pounds. I have to translate between them and was wondering how many ounces are in a pound?",<br/>      "answerCount": 3,<br/>      "upvoteCount": 26,<br/>      "dateCreated": "2016-07-23T21:11Z",<br/>      "author": {<br/>        "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Person",<br/>        "name": "New Baking User"<br/>      },<br/>      "acceptedAnswer": {<br/>        "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Answer",<br/>        "text": "1 pound (lb) is equal to 16 ounces (oz).",<br/>        "dateCreated": "2016-11-02T21:11Z",<br/>        "upvoteCount": 1337,<br/>        "url": "<a class="ae lu" href="https://example.com/question1#acceptedAnswer" rel="noopener ugc nofollow" target="_blank">https://example.com/question1#acceptedAnswer</a>",<br/>        "author": {<br/>          "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Person",<br/>          "name": "SomeUser"<br/>        }<br/>      },<br/>      "suggestedAnswer": [<br/>        {<br/>          "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Answer",<br/>          "text": "Are you looking for ounces or fluid ounces? If you are looking for fluid ounces there are 15.34 fluid ounces in a pound of water.",<br/>          "dateCreated": "2016-11-02T21:11Z",<br/>          "upvoteCount": 42,<br/>          "url": "<a class="ae lu" href="https://example.com/question1#suggestedAnswer1" rel="noopener ugc nofollow" target="_blank">https://example.com/question1#suggestedAnswer1</a>",<br/>          "author": {<br/>            "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Person",<br/>            "name": "AnotherUser"<br/>          }<br/>        }, {<br/>          "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Answer",<br/>          "text": " I can't remember exactly, but I think 18 ounces in a lb. You might want to double check that.",<br/>          "dateCreated": "2016-11-06T21:11Z",<br/>          "upvoteCount": 0,<br/>          "url": "<a class="ae lu" href="https://example.com/question1#suggestedAnswer2" rel="noopener ugc nofollow" target="_blank">https://example.com/question1#suggestedAnswer2</a>",<br/>          "author": {<br/>            "<a class="ae lu" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>": "Person",<br/>            "name": "ConfusedUser"<br/>          }<br/>        }<br/>      ]<br/>    }<br/>  }<br/>&lt;/script&gt;</span></pre><p id="0cd2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Schema.org对结构特别挑剔，所以我们需要逐字匹配。幸运的是，Newtonsoft很容易使用，有三种主要类型可以转换为json: <code class="fe me mf mg mh b">JObject</code>例如<code class="fe me mf mg mh b">{}</code>、<code class="fe me mf mg mh b">JArray</code>例如<code class="fe me mf mg mh b">[]</code>和<code class="fe me mf mg mh b">JProperty</code>例如<code class="fe me mf mg mh b">"”:””</code>。</p><p id="8963" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这意味着我们使用以下内容:</p><pre class="lw lx ly lz gt mw mh mx my aw mz bi"><span id="2943" class="kw kx jb mh b gy na nb l nc nd">&lt;script type="application/ld+json"&gt;</span><span id="d6ab" class="kw kx jb mh b gy nf nb l nc nd">@{</span><span id="8222" class="kw kx jb mh b gy nf nb l nc nd">var structuredData =</span><span id="bb86" class="kw kx jb mh b gy nf nb l nc nd">new JObject(</span><span id="0f61" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("@context", "https://schema.org"),</span><span id="648d" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("@type", "FAQPage"),</span><span id="ddd0" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("mainEntity",</span><span id="582f" class="kw kx jb mh b gy nf nb l nc nd">new JArray(</span><span id="79bc" class="kw kx jb mh b gy nf nb l nc nd">from item in questions</span><span id="ca74" class="kw kx jb mh b gy nf nb l nc nd">select new JObject(</span><span id="0b2f" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("@type", "Question"),</span><span id="98f4" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("name", (string)(item.GetProperty("question").Value().ToString())),</span><span id="344c" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("acceptedAnswer",</span><span id="2e34" class="kw kx jb mh b gy nf nb l nc nd">new JObject(</span><span id="36de" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("@type", "Answer"),</span><span id="35cb" class="kw kx jb mh b gy nf nb l nc nd">new JProperty("text", (string)(item.GetProperty("answer").Value().ToString()))</span><span id="7980" class="kw kx jb mh b gy nf nb l nc nd">)</span><span id="7567" class="kw kx jb mh b gy nf nb l nc nd">)</span><span id="c926" class="kw kx jb mh b gy nf nb l nc nd">)</span><span id="3611" class="kw kx jb mh b gy nf nb l nc nd">)</span><span id="afe4" class="kw kx jb mh b gy nf nb l nc nd">)</span><span id="4e0b" class="kw kx jb mh b gy nf nb l nc nd">);</span><span id="1504" class="kw kx jb mh b gy nf nb l nc nd">}</span><span id="3005" class="kw kx jb mh b gy nf nb l nc nd">@Html.Raw(structuredData.ToString())</span><span id="2f7a" class="kw kx jb mh b gy nf nb l nc nd">&lt;/script&gt;</span></pre><p id="d6fd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们通过声明一个<code class="fe me mf mg mh b">var</code>来生成匹配的代码，构建我们的JSON.NET对象，然后在<code class="fe me mf mg mh b">@Html.Raw</code>中将它呈现为一个<strong class="ka jc">字符串</strong>。</p><p id="0de1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Newtonsoft将让我们使用<code class="fe me mf mg mh b">from item in questions</code>遍历我们的可枚举对象(本例中是问题)。这个解决方案允许我们在每个模板的基础上灵活地使用动态数据源，这意味着我们可以将它放入一个可重用的部分中，并且只在需要的地方注入它。</p><p id="d59b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc"> <em class="ne">分解这个例子的核心概念将允许你产生任何结构化数据格式，并把它从razor转换成json。丰富的片段是当今SEO的一个重要组成部分，从很早开始就在你的webapp中包含结构化数据是很重要的，而旧网站仍然可以翻新以帮助你在搜索引擎上的排名。</em> </strong></p><p id="2530" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个例子的全部要点可以在找到<a class="ae lu" href="https://gist.github.com/tristolliday/220f5f33762bf2492a30a5f1557d4a72" rel="noopener ugc nofollow" target="_blank">。喜欢你读的吗？考虑给一些👏 👏 👏</a></p></div></div>    
</body>
</html>
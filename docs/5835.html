<html>
<head>
<title>Build your own Website Analytics with Cube.js in 10 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Cube.js在10分钟内构建您自己的网站分析</h1>
<blockquote>原文：<a href="https://itnext.io/build-your-own-website-analytics-with-cube-js-in-10-minutes-f195ed5d4d21?source=collection_archive---------1-----------------------#2021-06-06">https://itnext.io/build-your-own-website-analytics-with-cube-js-in-10-minutes-f195ed5d4d21?source=collection_archive---------1-----------------------#2021-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/80d7e63b1af46780cc64d73a2f145173.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6FXVShcCQG5-UEEK"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@marlon10?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马龙·科罗纳</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="52ef" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="1a01" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这篇文章的目的是展示<strong class="lg iu">用</strong> <a class="ae kf" href="https://cube.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> Cube.js </strong> </a>创建网站分析是多么容易。我已经在我的<a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/visualization-tools-for-big-data-c3361241a67e"> <strong class="lg iu">上一篇文章</strong> </a>中谈到了<a class="ae kf" href="https://cube.dev/" rel="noopener ugc nofollow" target="_blank"> Cube.js </a>，在这篇文章中，我将通过一个真实世界的例子来展示它的易用性。此外，我们将使用<a class="ae kf" href="https://cube.dev/" rel="noopener ugc nofollow" target="_blank"> Cube.js </a>附带的内置<a class="ae kf" href="https://github.com/cube-js/cubejs-playground-templates" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">模板</strong> </a>来创建一个初始的前端应用程序，以后您可以按照您想要的任何方式定制它，因为它是一个标准的<a class="ae kf" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> React </strong> </a>应用程序。</p><h1 id="a606" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">我们在建造什么？</h1><p id="399f" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">简而言之，我们正在构建一个非常简单的网站分析应用程序，它将<strong class="lg iu">跟踪页面浏览量和点击事件</strong>，并将它们存储到<strong class="lg iu">数据库</strong>。然后，我们将使用<a class="ae kf" href="https://cube.dev/docs/introduction" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">Cube.js</strong></a><strong class="lg iu"/>来访问数据，并使用cube . js模板构建React应用程序。这里 可以找到<strong class="lg iu">源代码</strong> <a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">。</strong></a></p><p id="cd8c" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们将把它分成3个项目:</p><ul class=""><li id="b5e8" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-frontend" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">分析-前端</strong> </a>:这个项目包含一个非常简单的静态网站，带有一个模拟的HTML页面和一个跟踪页面视图和事件的普通JavaScript文件。在现实世界中，这将是你的网站。</li><li id="d578" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/blob/main/analytics-backend/README.md" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">analytics-back end</strong></a>:这是一个REST端点，接收并持久保存前端发送的事件。</li><li id="47a8" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/blob/main/analytics-frontend/README.md" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> analytics-cubejs </strong> </a>:这是Cube.js项目，其中也包含仪表板React应用程序。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/7532f9e94946f8464f09287d56f9b989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*OSh7pHVB2_ho2smviKQBFg.png"/></div></figure><p id="b65c" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们将在<a class="ae kf" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> GoLang </strong> </a>中实现analytics-events，因此它可以轻松地扩展到大量请求。在本例中，我们使用<strong class="lg iu"> PostgreSQL </strong>来存储事件，但是您可以使用Cube.js支持的任何<a class="ae kf" href="https://cube.dev/docs/connecting-to-the-database" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">数据源</strong> </a></p><p id="7e4d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">最后，核心应用程序是<strong class="lg iu"> Cube.js API </strong>，它将为我们提供一个分析API，允许我们轻松构建前端应用程序。</p><p id="1862" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="na">我们先来复习一下Cube.js！</em></p><h2 id="59bf" class="nb kh it bd ki nc nd dn km ne nf dp kq lp ng nh ku lt ni nj ky lx nk nl lc nm bi translated">Cube.js</h2><p id="342e" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><a class="ae kf" href="https://cube.dev/docs/introduction" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> Cube.js </strong> </a>是一个<a class="ae kf" href="https://github.com/cube-js/cube.js" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">开源</strong> </a> <strong class="lg iu">分析API平台</strong>，使访问您的原始数据变得非常容易和高效；它不提供可视化，但它有许多<a class="ae kf" href="https://cube.dev/docs/frontend-introduction" rel="noopener ugc nofollow" target="_blank">模板</a>，模块和例子<a class="ae kf" href="https://cube.dev/docs/frontend-introduction" rel="noopener ugc nofollow" target="_blank">让你快速入门</a>。<strong class="lg iu">这是根据设计</strong>，因此您可以选择自己喜欢的库，并与任何前端框架或图表库集成。</p><p id="f7d2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你只需要遵循3个简单的步骤:</p><ul class=""><li id="fdc9" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><a class="ae kf" href="https://cube.dev/docs/getting-started" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">安装Cube </strong> </a> <strong class="lg iu"> .js. </strong>它可以在任何地方运行:Kubernetes、Serverless、on-prem等。</li><li id="08f0" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><a class="ae kf" href="https://cube.dev/docs/connecting-to-the-database" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">连接到数据源</strong> </a>。它支持许多不同类型的数据源，从无服务器云数据仓库到传统的RDBMs。您可以连接到许多信号源。</li><li id="68df" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">构建您的前端。 Cube.js可以生成一个<a class="ae kf" href="https://cube.dev/docs/dashboard-app" rel="noopener ugc nofollow" target="_blank">仪表盘App </a>供你入门，然后你可以随心所欲地定制它，并将其与你的产品/网站集成。</li></ul><p id="22d2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="na">就是这样！</em>，Cube.js处理剩下的。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/5acb7be14c3f7f2a2a3ec81614be868e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OcVl8mn8HFdRhrkk.png"/></div></div></figure><p id="d8d9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu"> Cube.js </strong>在你的数据之上添加了一个<strong class="lg iu">语义API层</strong>来加速你的可视化开发；Cube.js还管理访问控制、缓存和聚合数据。它可以与Google BigQuery和AWS Athena等<strong class="lg iu">无服务器</strong>数据仓库协同工作。因为Cube.js与可视化无关，所以您可以使用任何前端库来构建自己的定制UI。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/1efdc199823e9c060358c4d5ab22bf41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MRQ3rFJqvrF4bk7Y.png"/></div></div></figure><p id="2661" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Cube.js为任何严重依赖缓存和预聚合层的分析应用程序提供了必要的基础架构，以在几分钟内从原始数据中提供见解，并为多达万亿个数据点提供亚秒级响应时间的API。<strong class="lg iu">如果你必须自己实施，这将很难实现。</strong>查看主题<a class="ae kf" href="https://cube.dev/docs/examples" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">示例</strong> </a>感受一下Cube.js的功能和卓越特性。</p><p id="0f88" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">建筑</strong></p><p id="d34e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Cube.js客户端向REST API发送符合<a class="ae kf" href="https://cube.dev/docs/query-format" rel="noopener ugc nofollow" target="_blank">查询格式</a>的查询。服务器使用模式来生成SQL查询，该查询由您选择的数据库执行。服务器处理所有数据库连接，以及预聚合和缓存层。然后，结果被发送回客户端。客户端本身是可视化无关的，可以很好地与任何图表库一起工作。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/71e1103b200171cfded8280001a115a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C6X2BjQ-LnkfUp-5.png"/></div></div></figure><h1 id="0d77" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">动手！</h1><p id="934c" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们在10分钟内完成它。我假设你已经安装了<a class="ae kf" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> NPM </strong> </a>并且运行在Linux/Mac上，Windows用户可能需要做一些小的改动。</p><h2 id="351a" class="nb kh it bd ki nc nd dn km ne nf dp kq lp ng nh ku lt ni nj ky lx nk nl lc nm bi translated">分析-前端</h2><p id="8e2a" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">先说<a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-frontend" rel="noopener ugc nofollow" target="_blank">前端</a>。首先，您需要创建一个<strong class="lg iu"> JavaScript </strong>标签来跟踪页面视图和事件。你可以使用<a class="ae kf" href="https://developers.google.com/tag-manager/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> GTM </strong> </a>或者任何其他工具在每一页上插入这个脚本。我们还将跟踪元数据，如用户的国家，IP，浏览器等。您可以根据您的网站使用情况添加更多数据点，如用户名、用户id等。</p><p id="86f9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这是一个简单的标签，你可以用它作为你的起点，随意添加更多的元数据！</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="184f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们使用<a class="ae kf" href="https://ipapi.co" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> IPAPI </strong> </a>来获取用户元数据。当这个脚本被加载(在页面视图上)时，我们向后端发送一个POST HTTP请求，我们添加一个事件监听器来跟踪每次点击，我们跟踪带有<em class="na"> onclick </em>事件的链接、按钮或元素。这只是一个非常简单的例子，您应该针对实际的生产用途对其进行改进，但这是一个很好的起点。</p><p id="f930" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你需要在网站的每一页都包含这一点，例如:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="eeeb" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了让<strong class="lg iu"> IpAPI </strong>工作并且不被阻塞，你需要在服务器上运行示例页面。如果您使用的是我们的<a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-frontend" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">源代码</strong> </a>，只需运行:</p><ul class=""><li id="565e" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><code class="fe ns nt nu nv b">make init</code>:初始化服务器</li><li id="2fcb" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><code class="fe ns nt nu nv b">make run</code>:运行静态web服务器</li></ul><p id="7247" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">去<code class="fe ns nt nu nv b"><a class="ae kf" href="http://localhost:8001" rel="noopener ugc nofollow" target="_blank">http://localhost:8001</a></code></p><p id="ead9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后打开您的web developer工具，您应该会看到记录的数据和一个关于事件端点的错误，我们还没有实现这个错误。<em class="na">接下来就这么干吧！</em></p><h2 id="3a8c" class="nb kh it bd ki nc nd dn km ne nf dp kq lp ng nh ku lt ni nj ky lx nk nl lc nm bi translated">分析-后端</h2><p id="9b88" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们转移到<a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-backend" rel="noopener ugc nofollow" target="_blank">后端</a>。首先，让我们为我们的事件定义一个非常简单的模式:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b994" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">只有一个包含我们在前端捕获的所有数据的表。接下来，让我们创建一个简单的<strong class="lg iu"> GO </strong>服务来持久化事件:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="7fc6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这创建了一个<strong class="lg iu"> REST </strong>端点<em class="na"> /event </em>，它将接收页面视图和点击事件。它会将它们保存到我们的PostgreSQL数据库中。它使用一个<em class="na">。env </em>文件，您需要在其中输入您的数据库凭证。</p><p id="6d52" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了方便起见，我包含了一个<strong class="lg iu"> docker-compose </strong>文件和一个Makefile文件，以便于启动数据库和服务:</p><ul class=""><li id="7413" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><code class="fe ns nt nu nv b">made db</code>:使用已经创建的模式和表启动PostgreSQL实例。</li><li id="005a" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><code class="fe ns nt nu nv b">make run</code>:在<code class="fe ns nt nu nv b">localhost:8000</code>运行服务器</li></ul><p id="e5ea" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在，如果您再次启动<a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-frontend" rel="noopener ugc nofollow" target="_blank"> analytics-frontend </a>，您应该看到事件被持久化到PostgreSQL中，您可以使用<a class="ae kf" href="https://dbeaver.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> DBeaver </strong> </a>或任何其他工具来检查<em class="na"> analytics.events </em>表。</p><p id="7e32" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">此时，我们有一个跟踪用户的JavaScript标签和一个保存所有这些有价值数据的后端。现在是时候使用Cube.js的力量来查询它了。</p><h2 id="6a5d" class="nb kh it bd ki nc nd dn km ne nf dp kq lp ng nh ku lt ni nj ky lx nk nl lc nm bi translated">分析-cubejs</h2><p id="e7f1" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在让我们转到<a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-cubejs" rel="noopener ugc nofollow" target="_blank"> analytics-cubejs </a>项目。这是最关键的部分，但由于Cube.js，这将变得非常容易。</p><p id="68a1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">首先，创建运行该命令的项目，确保您已经安装了<strong class="lg iu"> NPM </strong>:</p><pre class="mw mx my mz gt nw nv nx ny aw nz bi"><span id="aff2" class="nb kh it nv b gy oa ob l oc od">npx cubejs-cli create <a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-cubejs" rel="noopener ugc nofollow" target="_blank">analytics-cubejs</a> -d postgres</span></pre><p id="de81" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在我们的例子中，我们使用<strong class="lg iu"> PostgreSQL </strong>，但是可以随意使用任何其他的<a class="ae kf" href="https://cube.dev/docs/connecting-to-the-database" rel="noopener ugc nofollow" target="_blank">数据存储</a>。<code class="fe ns nt nu nv b">create</code>命令将创建一个新的项目目录，其中包含新的Cube.js项目的搭建。这包括启动Cube.js后端所需的所有文件。</p><p id="5db8" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这个项目目录中的<code class="fe ns nt nu nv b">.env</code>文件包含相关数据库凭证的占位符。在那里输入您的数据库详细信息，例如:</p><pre class="mw mx my mz gt nw nv nx ny aw nz bi"><span id="69ab" class="nb kh it nv b gy oa ob l oc od">DB_HOST=localhost<br/>DB_PORT=5432<br/>DB_USER=postgres<br/>DB_PASSWORD=password<br/>DB_NAME=postgres</span></pre><p id="acf4" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来，我们需要定义<a class="ae kf" href="https://cube.dev/docs/getting-started-cubejs-schema" rel="noopener ugc nofollow" target="_blank">数据模式</a>，它充当数据库的ORM来生成和执行SQL。您可以使用<a class="ae kf" href="https://cube.dev/docs/dev-tools/dev-playground" rel="noopener ugc nofollow" target="_blank"> Developer Playground </a>生成模式文件。为此，您可以从项目目录启动dev服务器，如下所示:</p><pre class="mw mx my mz gt nw nv nx ny aw nz bi"><span id="e7f5" class="nb kh it nv b gy oa ob l oc od">$ npm run dev</span></pre><p id="ca93" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后转到<code class="fe ns nt nu nv b">http://localhost:4000</code>并使用Developer Playground在模式菜单中生成模式文件。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/680c8279f43ffbba6659763ac301302c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*RA2xHwgmmXmCKG841m6NSA.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">如何生成模式</figcaption></figure><p id="7d42" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果你正在跟随我们的s <a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-cubejs" rel="noopener ugc nofollow" target="_blank">源代码</a>，你可以运行<code class="fe ns nt nu nv b">make cube</code>。</p><p id="c634" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在我们的例子中，我们需要对模式进行一些修改，以根据事件类型创建两个多维数据集(单击vs视图)。转到<em class="na">模式</em>文件夹，编辑<em class="na"> Events.js </em>文件，并添加以下内容:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="ff57" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在你可以回到<strong class="lg iu">游乐场</strong>开始构建图表了。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/eb7bbf52872bc9ee32b880ef8a036f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A8AjdaMMNgEl4Ygt9054tQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">可以生成任何图表的Cube.js游乐场</figcaption></figure><p id="dcc6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">您可以使用playground了解更多关于Cube.js的功能，尝试不同的框架和图表库，查看正在生成的<strong class="lg iu"> SQL </strong>等等。</p><p id="9f36" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu"> Cube.js </strong>提供大规模查询数据所需的后端，生成预聚合，并使用<strong class="lg iu"> Redis </strong>作为缓存。查看他们的<a class="ae kf" href="https://cube.dev/docs/introduction" rel="noopener ugc nofollow" target="_blank">文档</a>以了解更多信息。</p><p id="a3b1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">最后一步是使用<strong class="lg iu"> Cube.js模板</strong>生成一个启动的<strong class="lg iu"> React </strong>应用程序，非常类似于Cube.js playground。在游乐场，进入<strong class="lg iu">仪表盘应用</strong>选择第一个选项。也可以尝试其他模板。完成后，单击<strong class="lg iu">启动Dashboard App </strong>按钮，启动在<em class="na"> dashboard-app </em>文件夹下的Cube.js项目中生成的应用程序。</p><p id="9852" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这是一个常规的React应用程序，您可以按照自己想要的方式进行定制。你可以将它与你现有的产品集成或构建一个新的产品，Cube.js的酷之处在于，与其他可视化工具相比，你没有任何限制，它支持许多数据库和任何UI框架的图表库，如<strong class="lg iu"> React、Vue或Angular </strong>。</p><p id="e598" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">一旦应用程序启动，请转到:<a class="ae kf" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"><em class="na">http://localhost:3000/</em></a></p><p id="81df" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你可以以任何你想要的方式定制应用程序，并添加认证、持久性等等。即使没有任何定制，您也可以创建漂亮的图表，并从您的网站中获得许多见解:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/26b43841547036cfc421a73f9d4a5e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DO7L6BfdcAl4X4MRU-IaOw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用生成的React应用程序创建的仪表板</figcaption></figure><p id="085e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果您正在遵循所附的<a class="ae kf" href="https://github.com/javiramos1/analytics_cubejs/tree/main/analytics-cubejs" rel="noopener ugc nofollow" target="_blank">源代码</a>，您可以运行以下代码:</p><ul class=""><li id="5655" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><code class="fe ns nt nu nv b">make cube: To run CubeJS</code></li><li id="b505" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><code class="fe ns nt nu nv b">make app: To run the React App</code></li></ul><h1 id="f788" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="fdf3" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们已经看到用<a class="ae kf" href="https://cube.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> Cube.js </strong> </a> <strong class="lg iu">创建<strong class="lg iu">有意义的分析</strong>是多么容易。最棒的是，由于强大的Cube.js后端，这可以大规模实现。</strong></p><p id="76f2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">您可以使用我的示例代码作为参考，并针对生产环境对其进行改进。虽然你可以使用<a class="ae kf" href="https://analytics.withgoogle.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">谷歌分析</strong> </a>和其他产品，拥有自己的分析产品为你<strong class="lg iu">提供更多的控制</strong>和定制选项，例如将分析添加到你自己的现有产品中。此外，许多公司无法将使用数据导出到第三方提供商，因此他们没有其他选择，只能在内部实施。得益于其强大的语义API和内置模板，Cube.js  使这变得非常容易。</p><p id="1b0a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果您有任何问题或需要任何建议，请随时进入 <a class="ae kf" href="https://twitter.com/JavierRamosRod" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">触摸</strong> </a>。</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><p id="9020" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><a class="ae kf" href="https://javier-ramos.medium.com/subscribe" rel="noopener"> <strong class="lg iu">订阅</strong> </a>获得<strong class="lg iu">通知</strong>当我发表一篇文章和<a class="ae kf" href="https://javier-ramos.medium.com/membership" rel="noopener"> <strong class="lg iu">加入Medium.com</strong></a>访问百万或文章！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Kubernetes Operator for Multi-clusters Usage Tracking, Analytics and Accounting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于多集群使用跟踪、分析和记账的Kubernetes运营商</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-operator-for-multi-clusters-usage-tracking-analytics-and-accounting-dd69c14bdd38?source=collection_archive---------0-----------------------#2022-12-09">https://itnext.io/kubernetes-operator-for-multi-clusters-usage-tracking-analytics-and-accounting-dd69c14bdd38?source=collection_archive---------0-----------------------#2022-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3713" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一种开源的资源使用跟踪方法</h2></div><p id="500e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">TL；近</strong>这个故事介绍了<a class="ae lb" href="https://github.com/2-alchemists/krossboard-kubernetes-operator" rel="noopener ugc nofollow" target="_blank">Krossboard Kubernetes Operator</a>，这是一个开源的Kubernetes Operator，可以快速设置和操作一个系统，用于多集群、交叉分布&amp;跨站点使用情况跟踪、分析和记账(GKE、AKS、EKS、OpenShift和其他分布；内部或云中)。</p><blockquote class="lc ld le"><p id="2d66" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated"><a class="ae lb" href="https://github.com/2-alchemists/krossboard-kubernetes-operator" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a></p></blockquote><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/857c0f00e930d1084ba86d26289798a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziqgab3Kcw02GuuaSkO5pw.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk translated">Krossboard —每个群集和每个资源类型(CPU/RAM)最近5分钟的整合使用情况</figcaption></figure><p id="15d1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本故事的其余部分讨论了多Kubernetes使用跟踪的优势和挑战、Krossboard Operator的建议、功能和截图，以及一个简短的入门程序。</p><h1 id="200e" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">多Kubernetes使用跟踪的优势和挑战</h1><p id="62fe" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">无需进一步证明相关的<em class="lf">使用情况跟踪是Kubernetes采用</em>的有效方法中的一项必需功能。如果您还不清楚这一点，让我们强调一下它的几个好处:<em class="lf">成本效益</em>通过跟踪您的Kubernetes集群在一段时间内的使用情况；<em class="lf">成本分摊</em> <strong class="kh ir"> </strong>通过核算您的不同应用、业务部门或合作伙伴如何使用您的Kubernetes资源；<em class="lf">通过分析每个Kubernetes集群资源随时间的消耗情况，跟踪资源的扩展/缩减</em>。</p><p id="9686" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一些工具，如<a class="ae lb" href="https://github.com/rchakode/kube-opex-analytics" rel="noopener ugc nofollow" target="_blank"> kube-opex-analytics </a>，可以跟踪单个Kubernetes集群上的资源使用情况。当我们有几个Kubernetes集群时，事情就变得复杂了。事实上，浏览不同的集群以获得洞察力是非常困难的；不用说解决跨集群报告的困难。</p><h1 id="afc0" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">Krossboard Kubernetes运营商简介</h1><p id="72a4" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated"><a class="ae lb" href="https://github.com/2-alchemists/krossboard-kubernetes-operator" rel="noopener ugc nofollow" target="_blank"> Krossboard Kubernetes操作员</a>是一名操作员，能够在不到15分钟的时间内设置一个系统(<em class="lf"> Krossboard) </em>来跟踪、整合和记录您的多个Kubernetes集群的使用情况。Krossboard在其管理的不同集群之上提供了一个跨分布和跨站点的分析和会计平台，具有以下优势:</p><ul class=""><li id="69cb" class="mw mx iq kh b ki kj kl km ko my ks mz kw na la nb nc nd ne bi translated"><strong class="kh ir"> <em class="lf">每个命名空间和每个集群的长期(12个月以上)分析和核算</em> </strong>，具有每小时整合趋势，以及自动每日和每月核算。</li><li id="0c5d" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated"><strong class="kh ir"> <em class="lf">每集群跨命名空间整合使用情况跟踪和核算</em> </strong>内置图表和数据导出功能(CSV)。</li><li id="e0c6" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated"><strong class="kh ir"> <em class="lf">跨集群整合使用情况跟踪和核算</em> </strong> <em class="lf"> </em>内置图表内置图表和数据导出功能(CSV)。</li><li id="aea1" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated"><strong class="kh ir"> <em class="lf">每个集群和资源类型</em> </strong>(例如CPU、RAM)的5分钟最近整合使用情况。</li><li id="5ddf" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated"><strong class="kh ir"> <em class="lf">跨分布和跨站点的Kubernetes实例</em> </strong>在本地和云中对GKE、AKS、EKS、OpenShift、Rancher和vanilla Kubernetes进行持续集成测试。</li></ul><h1 id="68f1" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">Krossboard —分析和会计图表</h1><p id="e559" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">Krossboard具有以下主要的分析和会计功能(请查看它们的描述和截图):</p><ul class=""><li id="412d" class="mw mx iq kh b ki kj kl km ko my ks mz kw na la nb nc nd ne bi translated">每集群5分钟的最近整合利用率</li><li id="c13f" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated">每集群跨命名空间使用趋势、分析和核算</li><li id="e0b5" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated">每节点5分钟最近占用</li><li id="b4de" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated">每个集群的整合利用率趋势</li></ul><h2 id="bc2b" class="nk ma iq bd mb nl nm dn mf nn no dp mj ko np nq ml ks nr ns mn kw nt nu mp nv bi translated">每集群5分钟的最近整合利用率</h2><p id="07e4" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated"><em class="lf">每个群集和资源类型(CPU、RAM)每5分钟更新一次</em>，这些分析跟踪最后五分钟的整合利用率、空闲和保留/ <em class="lf">不可分配的</em>容量。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/857c0f00e930d1084ba86d26289798a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziqgab3Kcw02GuuaSkO5pw.png"/></div></div></figure><h2 id="4acb" class="nk ma iq bd mb nl nm dn mf nn no dp mj ko np nq ml ks nr ns mn kw nt nu mp nv bi translated">每集群跨命名空间分析</h2><p id="6b6e" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated"><em class="lf">基于每小时的趋势以及每日和每月的统计</em>，这些在每个Kubernetes集群范围内跟踪的分析跟踪了不同名称空间的资源利用情况。分析数据和图表还突出显示了预留的/ <em class="lf">不可分配的</em>容量。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nw"><img src="../Images/6fbff2c56a8a962288a2ff67334ea8ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUWzhamfYcDVbLtSoeTKhg.png"/></div></div></figure><h2 id="7140" class="nk ma iq bd mb nl nm dn mf nn no dp mj ko np nq ml ks nr ns mn kw nt nu mp nv bi translated">每节点5分钟最近占用</h2><p id="922f" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">对于每个群集和资源类型(CPU和RAM)，这些分析跟踪每个节点的资源利用率，同时突出显示每个pod的资源消耗以及预留的/ <em class="lf">不可分配的</em>容量。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nx"><img src="../Images/aae5d2cf4a617085376eb1e4a581e0a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZzT9GG5NDnF7PdiJIH97Q.png"/></div></div></figure><h2 id="1df8" class="nk ma iq bd mb nl nm dn mf nn no dp mj ko np nq ml ks nr ns mn kw nt nu mp nv bi translated">一段时间内每个群集的整合利用率</h2><p id="0aae" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">对于每个群集和资源类型(例如CPU和RAM)，这些分析会跟踪一段时间(长达12个月的历史)的整合利用率、可用容量和保留容量。</p><p id="b295" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Krossboard用户界面允许设置数据选择时间范围(参见下面截图上的<em class="lf">开始日期</em>和<em class="lf">结束日期</em>)。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/6b192416ce94f9975f2441c7fb413a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-ciRWhsMAy4RIIZ7zVktg.png"/></div></div></figure><h1 id="23f8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">入门</strong></h1><p id="4983" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">开始使用很简单，只需进行以下三个步骤:</p><ul class=""><li id="dcc3" class="mw mx iq kh b ki kj kl km ko my ks mz kw na la nb nc nd ne bi translated">使用这一行命令部署操作员。</li></ul><pre class="lk ll lm ln gt ny nz oa bn ob oc bi"><span id="af0b" class="od ma iq nz b be oe of l og oh">kubectl apply -f https://raw.githubusercontent.com/2-alchemists/krossboard-kubernetes-operator/main/config/releases/latest/krossboard/krossboard-kubernetes-operator.yaml</span></pre><ul class=""><li id="bc91" class="mw mx iq kh b ki kj kl km ko my ks mz kw na la nb nc nd ne bi translated">创建一个包含KUBECONFIG的秘密，该秘密有权访问您的Kubernetes集群并<em class="lf">读取</em>原始指标(参见如何<a class="ae lb" href="https://github.com/2-alchemists/krossboard-kubernetes-operator/blob/main/docs/create-kubeconfig-with-minimal-permissions.md" rel="noopener ugc nofollow" target="_blank">为Krossboard </a>设置具有最小权限的KUBECONFIG)。</li></ul><pre class="lk ll lm ln gt ny nz oa bn ob oc bi"><span id="f66f" class="od ma iq nz b be oe of l og oh"># replace /path/to/kubeconfig with path towards your KUBECONFIG<br/>kubectl -n krossboard \<br/>    create secret --type=Opaque generic krossboard-secrets \<br/>    --from-file=kubeconfig=/path/to/kubeconfig</span></pre><ul class=""><li id="fdb9" class="mw mx iq kh b ki kj kl km ko my ks mz kw na la nb nc nd ne bi translated">创建一个Krossboard CR(自定义资源)实例</li></ul><pre class="lk ll lm ln gt ny nz oa bn ob oc bi"><span id="5175" class="od ma iq nz b be oe of l og oh">kubectl -n krossboard apply -f https://raw.githubusercontent.com/2-alchemists/krossboard-kubernetes-operator/main/config/releases/latest/krossboard/krossboard-deployment.yaml</span></pre><p id="e9cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更多详情，请查看我们在GitHub的官方文档:<a class="ae lb" href="https://github.com/2-alchemists/krossboard-kubernetes-operator" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/2-alchems/kross board-kubernetes-operator</a></p><h1 id="ca42" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="0c99" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">这个故事介绍了一个开源的Kubernetes运营商，它有助于解决多个Kubernetes集群之间的使用跟踪、分析和会计需求。Kubernetes集群可以是任何发行版(GKE、AKS、EKS、OpenShift、vanilla Kubernetes或其他)并且位于任何地方(内部或云中)；Krossboard在一个中央位置以透明的方式处理使用情况跟踪、分析和会计。</p><p id="9c49" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">试试看，不要犹豫，通过在GitHub打开一个拉请求来分享您的反馈或做出贡献:<a class="ae lb" href="https://github.com/2-alchemists/krossboard-kubernetes-operator" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/2-alchems/kross board-kubernetes-operator</a>。</p></div></div>    
</body>
</html>
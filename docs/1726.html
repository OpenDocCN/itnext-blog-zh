<html>
<head>
<title>Upgrading Bash on macOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在macOS上升级Bash</h1>
<blockquote>原文：<a href="https://itnext.io/upgrading-bash-on-macos-7138bd1066ba?source=collection_archive---------0-----------------------#2019-01-13">https://itnext.io/upgrading-bash-on-macos-7138bd1066ba?source=collection_archive---------0-----------------------#2019-01-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="44bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">许多macOS用户不知道的一点是，他们使用的是完全过时的Bash shell版本。然而，强烈建议在macOS上使用Bash的新版本，因为它使您能够使用有用的新特性。本文解释了如何做到这一点。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/6f75e1f81e0c019b923664bfef8734a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xjraSVbFOl1b5346bPGoIw.png"/></div></div></figure><h1 id="8492" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">macOS上的默认Bash版本</h1><p id="0638" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">要查看macOS中包含的Bash版本有多过时，请执行以下命令:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="9db8" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">bash --version</strong><br/>GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin18)<br/>Copyright (C) 2007 Free Software Foundation, Inc.</span></pre><p id="d2aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如你所见，这是<a class="ae mn" href="https://www.gnu.org/software/bash/" rel="noopener ugc nofollow" target="_blank"> GNU Bash </a>版本<strong class="js iu"> 3.2 </strong>，日期为<strong class="js iu"> 2007 </strong>！Bash的这个版本包含在macOS的所有版本中，甚至是最新的版本。</p><p id="7aab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">苹果在其操作系统中包含如此老版本的Bash的原因与<strong class="js iu">许可</strong>有关。从4.0版本(3.2的继承者)开始，Bash使用<a class="ae mn" href="https://www.gnu.org/licenses/gpl.html" rel="noopener ugc nofollow" target="_blank"> GNU通用公共许可证v3 (GPLv3) </a>，苹果不(想要)支持。你可以在这里和这里找到一些关于这个<a class="ae mn" href="https://www.reddit.com/r/apple/comments/7v97ls/why_doesnt_apple_use_any_gpl_v3_unix_packages_in/" rel="noopener ugc nofollow" target="_blank">的讨论。GNU Bash的3.2版本是GPLv2的最后一个版本，苹果接受了它，所以它坚持使用它。</a></p><p id="f67f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这意味着整个世界(例如Linux)都在使用Bash的新版本，而macOS用户还停留在十年前的旧版本。在本文撰写之时，GNU Bash的最新版本是5.0(见<a class="ae mn" href="https://tiswww.case.edu/php/chet/bash/bashtop.html#CurrentStatus" rel="noopener ugc nofollow" target="_blank">此处</a>)，已经在2019年1月发布。在本文中，我给出了将系统的默认shell升级到Bash最新版本的说明。</p><h1 id="5323" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">为什么要升级？</h1><p id="aa3c" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">但是，如果Bash 3.2运行良好，为什么还要费心去获取一个新版本呢？主要原因，对我个人来说，是<a class="ae mn" href="https://www.gnu.org/software/bash/manual/html_node/Programmable-Completion.html" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">可编程完成</strong> </a>。这是一个允许Bash中特定命令自动完成的特性。您可能使用自动补全来完成命令、文件名和变量，方法是开始键入，然后点击<em class="mo">选项卡</em>来自动补全当前单词(或者点击<em class="mo">选项卡</em>两次来获得所有可能补全的列表，如果有多个的话)。这是Bash的默认完成方式。</p><p id="4e36" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，可编程补全远远不止于此，因为它允许依赖于上下文的特定命令补全。例如，想象一下，输入<code class="fe mp mq mr me b">cmd -[tab][tab]</code>，然后看到适用于该命令的所有选项的列表。或者键入<code class="fe mp mq mr me b">cmd host rm [tab][tab]</code>，然后看到某个配置文件中指定的所有“主机”的列表。可编程完成允许这样做。</p><p id="5fa5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可编程完成逻辑(由命令的创建者)在完成规范中定义，通常以<strong class="js iu">完成脚本</strong>的形式。这些完成脚本必须来源于您的shell，以启用命令的完成功能。</p><p id="d3c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">问题是Bash的可编程补全特性从3.2版本开始已经得到了扩展，大多数补全脚本都使用这些新特性。这意味着这些完成脚本不能在Bash 3.2上工作，这意味着如果您继续使用默认的macOS shell，您将错过许多命令的完成功能。</p><p id="9664" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过升级到Bash的新版本，您可以使用这些完成脚本，这非常有用。我写了一整篇文章，名为macOS上Bash的<a class="ae mn" href="https://medium.com/@weibeld/programmable-completion-for-bash-on-macos-f81a0103080b" rel="noopener"> <strong class="js iu">可编程完成</strong> </a>，它解释了在升级到较新的Bash版本后充分利用macOS上的可编程完成所需要知道的一切。</p><h1 id="a9cc" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">怎么升级？</h1><p id="f461" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">要将macOS系统的默认shell升级到Bash的最新版本，您必须做三件事:</p><ol class=""><li id="ed16" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated"><strong class="js iu">安装最新版本的Bash </strong></li><li id="c00f" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn mx my mz na bi translated"><strong class="js iu">“白名单”新Bash作为登录外壳</strong></li><li id="094d" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn mx my mz na bi translated"><strong class="js iu">将新的Bash设置为默认shell </strong></li></ol><p id="3f26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每一步都非常简单，如下所述。</p><blockquote class="ng nh ni"><p id="0671" class="jq jr mo js b jt ju jv jw jx jy jz ka nj kc kd ke nk kg kh ki nl kk kl km kn im bi translated"><strong class="js iu">注意:</strong>下面的指令并没有改变Bash的旧版本，而是安装了一个新版本，并设置为默认。这两个版本将并存于你的系统中，但是你可以忽略旧版本。</p></blockquote><h2 id="8f88" class="mi lb it bd lc nm nn dn lg no np dp lk kb nq nr lo kf ns nt ls kj nu nv lw nw bi translated">安装</h2><p id="83f8" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">我推荐用<a class="ae mn" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制软件</a>安装最新版本的Bash:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="40b4" class="mi lb it me b gy mj mk l ml mm"><strong class="me iu">brew install bash</strong></span></pre><p id="b703" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">已经这样了！</p><p id="6275" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了验证安装，您可以检查您的系统上现在有两个Bash版本:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="9802" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">which -a bash</strong><br/>/usr/local/bin/bash<br/>/bin/bash</span></pre><p id="f53e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第一个是新版本，第二个是旧版本:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="20cf" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">/usr/local/bin/bash --version</strong><br/>GNU bash, version 5.0.0(1)-release (x86_64-apple-darwin18.2.0)<br/>Copyright (C) 2019 Free Software Foundation, Inc.<br/>License GPLv3+: GNU GPL version 3 or later &lt;<a class="ae mn" href="http://gnu.org/licenses/gpl.html" rel="noopener ugc nofollow" target="_blank">http://gnu.org/licenses/gpl.html</a>&gt;</span><span id="fb7d" class="mi lb it me b gy nx mk l ml mm">This is free software; you are free to change and redistribute it.<br/>There is NO WARRANTY, to the extent permitted by law.</span><span id="c27f" class="mi lb it me b gy nx mk l ml mm">$ <strong class="me iu">/bin/bash --version</strong><br/>GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin18)<br/>Copyright (C) 2007 Free Software Foundation, Inc.</span></pre><p id="3118" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于在<code class="fe mp mq mr me b">PATH</code>变量中，新版本的目录(<code class="fe mp mq mr me b">/usr/local/bin</code>)默认出现在旧版本的目录(<code class="fe mp mq mr me b">/bin</code>)之前，所以当你输入<code class="fe mp mq mr me b">bash</code>时使用的版本是新版本:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="3738" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">bash --version</strong><br/>GNU bash, version 5.0.0(1)-release (x86_64-apple-darwin18.2.0)<br/>...</span></pre><p id="1355" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，一切顺利。现在您已经将此版本设为默认版本。</p><h2 id="dd6a" class="mi lb it bd lc nm nn dn lg no np dp lk kb nq nr lo kf ns nt ls kj nu nv lw nw bi translated">白名单</h2><p id="3840" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">UNIX包括一个安全特性，将可用作<a class="ae mn" href="https://docstore.mik.ua/orelly/unix3/upt/ch03_04.htm" rel="noopener ugc nofollow" target="_blank">登录shell</a>的shell(即登录到系统后使用的shell)限制在“可信”shell列表中。这些外壳列在<code class="fe mp mq mr me b"><a class="ae mn" href="https://bash.cyberciti.biz/guide//etc/shells" rel="noopener ugc nofollow" target="_blank">/etc/shells</a></code>文件中。</p><p id="9137" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为您希望使用新安装的Bash shell作为默认shell，所以它必须能够充当登录shell。这意味着，您必须将它添加到<code class="fe mp mq mr me b">/etc/shells</code>文件中。您可以root用户身份编辑该文件:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="9ad7" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">sudo vim /etc/shells</strong></span></pre><p id="6969" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并将<code class="fe mp mq mr me b">/usr/local/bin/bash</code> shell添加到它的内容中，这样文件看起来就像这样:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="9338" class="mi lb it me b gy mj mk l ml mm">/bin/bash<br/>/bin/csh<br/>/bin/ksh<br/>/bin/sh<br/>/bin/tcsh<br/>/bin/zsh<br/>/usr/local/bin/bash</span></pre><p id="7417" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这一步就到此为止！</p><h2 id="5791" class="mi lb it bd lc nm nn dn lg no np dp lk kb nq nr lo kf ns nt ls kj nu nv lw nw bi translated">设置默认外壳</h2><p id="b0ab" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">此时，如果您打开一个新的终端窗口，您将仍然使用Bash 3.2。这是因为<code class="fe mp mq mr me b">/bin/bash</code>仍然被设置为默认shell。要将此更改为您的新shell，请执行以下命令:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="3721" class="mi lb it me b gy mj mk l ml mm">$ <a class="ae mn" href="https://en.wikipedia.org/wiki/Chsh" rel="noopener ugc nofollow" target="_blank"><strong class="me iu">chsh</strong></a><strong class="me iu"> -s /usr/local/bin/bash</strong></span></pre><p id="9791" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样！当前用户的默认shell现在设置为Bash的新版本。如果您关闭并重新打开终端窗口，您现在应该已经在使用新版本了。您可以按如下方式验证这一点:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="6856" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">echo $BASH_VERSION</strong><br/>5.0.0(1)-release</span></pre><p id="7923" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mp mq mr me b">chsh</code>命令只为执行该命令的用户更改默认外壳。如果您也想改变其他用户的默认外壳，您可以通过使用另一个用户的身份重复该命令(例如使用<code class="fe mp mq mr me b"><a class="ae mn" href="https://en.wikipedia.org/wiki/Su_(Unix)" rel="noopener ugc nofollow" target="_blank">su</a></code>)。最重要的是，您可能想要更改root用户的缺省shell，您可以这样做:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="5844" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">sudo chsh -s /usr/local/bin/bash</strong></span></pre><p id="c362" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样，如果你以root用户身份使用<code class="fe mp mq mr me b">sudo su</code>打开一个shell，它也会使用新的Bash版本。</p><h1 id="c083" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">重要注意事项</h1><h2 id="708c" class="mi lb it bd lc nm nn dn lg no np dp lk kb nq nr lo kf ns nt ls kj nu nv lw nw bi translated">脚本中的用法</h2><p id="adbd" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">如前所述，您没有更改Bash的默认版本，而是安装了一个新版本并将其设置为默认版本。Bash的两个版本并存于您的系统中:</p><ul class=""><li id="a4fc" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn ny my mz na bi translated"><code class="fe mp mq mr me b">/bin/bash</code>:旧版本</li><li id="787b" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn ny my mz na bi translated"><code class="fe mp mq mr me b">/usr/local/bin/bash</code>:新版本</li></ul><p id="348d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在shell脚本中，您通常会有一个类似于以下脚本的<a class="ae mn" href="https://en.wikipedia.org/wiki/Shebang_(Unix)" rel="noopener ugc nofollow" target="_blank"> shebang </a>行:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="f5c0" class="mi lb it me b gy mj mk l ml mm">#!/bin/bash<br/>echo $BASH_VERSION</span></pre><p id="3a6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">需要注意的是，这个shebang行<em class="mo">明确地</em>引用了Bash的<strong class="js iu">旧</strong>版本(因为它指定了<code class="fe mp mq mr me b">/bin/bash</code>)。这意味着如果你运行这个脚本，它将被旧版本的Bash解释(你可以在脚本的输出中看到，它将是类似于<code class="fe mp mq mr me b">3.2.57(1)-release</code>的东西)。</p><p id="0525" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于大多数情况，这可能不是问题。但是如果您想让Bash的新版本明确地解释您的脚本，您可以像这样修改shebang行:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="c2ed" class="mi lb it me b gy mj mk l ml mm">#!/usr/local/bin/bash<br/>echo $BASH_VERSION</span></pre><p id="1b64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，输出将类似于<code class="fe mp mq mr me b">5.0.0(1)-release</code>。但是，请注意，这个解决方案是<strong class="js iu">不可移植的</strong>，这意味着，它可能无法在其他系统上工作。这是因为，其他系统很可能没有位于<code class="fe mp mq mr me b">/usr/local/bin/bash</code>的shell(而<code class="fe mp mq mr me b">/bin/bash</code>几乎是一个标准)。</p><p id="b391" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要结合两者的优点，您可以使用下面的shebang代码:</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="a9b6" class="mi lb it me b gy mj mk l ml mm">#!/usr/bin/env bash<br/>echo $BASH_VERSION</span></pre><p id="0fda" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是为shebang线推荐的<a class="ae mn" href="https://www.cyberciti.biz/tips/finding-bash-perl-python-portably-using-env.html" rel="noopener ugc nofollow" target="_blank">格式。它通过检查<code class="fe mp mq mr me b">PATH</code>并使用第一个遇到的<code class="fe mp mq mr me b">bash</code>可执行文件作为脚本的解释器来工作。如果新版本的目录在<code class="fe mp mq mr me b">PATH</code>中位于旧版本的目录之前(这是默认的)，那么将使用新版本，脚本的输出将类似于<code class="fe mp mq mr me b">5.0.0(1)-release</code>。</a></p><h2 id="c684" class="mi lb it bd lc nm nn dn lg no np dp lk kb nq nr lo kf ns nt ls kj nu nv lw nw bi translated">为什么不使用符号链接?<strong class="ak">?</strong></h2><p id="6627" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">与其同时处理Bash的两个版本，难道不能删除旧版本，用新版本代替旧版本吗？例如，通过在<code class="fe mp mq mr me b">/bin/bash</code>中创建一个指向新版本的符号链接，如下所示？</p><pre class="kp kq kr ks gt md me mf mg aw mh bi"><span id="10b1" class="mi lb it me b gy mj mk l ml mm">$ <strong class="me iu">sudo rm /bin/bash</strong><br/>$ <strong class="me iu">sudo</strong> <strong class="me iu">ln -s /usr/local/bin/bash /bin/bash</strong></span></pre><p id="6a87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样，即使带有<code class="fe mp mq mr me b">#!/bin/bash</code>的脚本也可以被新版本的Bash解释，为什么不这样做呢？</p><p id="0b8c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以这么做，但是你要绕开一个macOS的安全特性，叫做<a class="ae mn" href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/System_Integrity_Protection_Guide/Introduction/Introduction.html" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">系统完整性保护(SIP) </strong> </a> <strong class="js iu"> </strong> ( <a class="ae mn" href="https://en.wikipedia.org/wiki/System_Integrity_Protection" rel="noopener ugc nofollow" target="_blank">维基</a>)。这个特性甚至禁止root用户对某些目录进行写访问(这就是为什么它也被称为“无根”)。这些目录在此<a class="ae mn" href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/System_Integrity_Protection_Guide/FileSystemProtections/FileSystemProtections.html" rel="noopener ugc nofollow" target="_blank">列出</a>并包括<code class="fe mp mq mr me b">/bin</code>。这意味着即使作为根用户，您也不能执行上述命令，因为您不允许在<code class="fe mp mq mr me b">/bin</code>中删除任何内容或创建任何文件。</p><p id="e773" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">解决方法是禁用SIP，在<code class="fe mp mq mr me b">/bin</code>中进行更改，然后再次启用SIP。启用和禁用SIP可以根据此处的说明<a class="ae mn" href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/System_Integrity_Protection_Guide/ConfiguringSystemIntegrityProtection/ConfiguringSystemIntegrityProtection.html" rel="noopener ugc nofollow" target="_blank">来完成。它要求你启动你的机器进入<strong class="js iu">恢复模式</strong>，然后使用<code class="fe mp mq mr me b">csrutil disable</code>和<code class="fe mp mq mr me b">csrutil enable</code>命令。如果您想彻底替换旧的Bash版本，或者满足于两个Bash版本并存，这取决于您。</a></p><h1 id="39c2" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">参考</h1><ul class=""><li id="a19f" class="ms mt it js b jt ly jx lz kb nz kf oa kj ob kn ny my mz na bi translated"><a class="ae mn" href="https://apple.stackexchange.com/a/292760" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">https://apple.stackexchange.com/a/292760</strong>T22】</a></li></ul></div></div>    
</body>
</html>
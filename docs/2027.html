<html>
<head>
<title>Migrating a Web-Based React Tic-Tac-Toe Game to React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将基于Web的React井字游戏迁移到React Native</h1>
<blockquote>原文：<a href="https://itnext.io/migrating-a-web-based-react-tic-tac-toe-game-to-react-native-ff7cac124f0?source=collection_archive---------4-----------------------#2019-03-18">https://itnext.io/migrating-a-web-based-react-tic-tac-toe-game-to-react-native-ff7cac124f0?source=collection_archive---------4-----------------------#2019-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/511d32df93ffa2973ddade71e924f0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_1mfbZGYTvRpZcKDJ9h7A.png"/></div></div></figure><p id="719e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">去年我用React和Material-UI (MUI)写了一个<a class="ae kw" href="https://medium.com/@vanister/learn-react-redux-by-making-a-tic-tac-toe-game-part-1-of-5-dc9111ca09ad" rel="noopener">井字游戏</a>游戏。现在，我想尽可能多地将该应用程序迁移到React Native，以便它可以在移动设备上运行。</p><p id="2933" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">游戏中最难移植的部分是样式，因为MUI组件库与React Native不兼容。另一方面，由于MUI使用JSS作为它的样式，这可能有助于用最少的改变带来大多数用于样式的类。</p><p id="c585" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">什么是<a class="ae kw" href="https://facebook.github.io/react-native/" rel="noopener ugc nofollow" target="_blank">反应土著</a> (RN)？文档称，这是一个用于构建真正的原生应用的框架，可以为Android或iOS原生编译，而不是像其他原生框架一样使用web-view包装器。在很大程度上，你所需要知道的就是<a class="ae kw" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>和JavaScript来构建一个移动应用。</p><p id="1142" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">React Native团队做了大量工作，提供了React中的许多常用组件，这些组件将编译到各自的操作系统组件中。有时候，你需要构建React Native中不存在的自定义<a class="ae kw" href="https://facebook.github.io/react-native/docs/native-modules-setup" rel="noopener ugc nofollow" target="_blank">本机组件</a>(桥)来获得你需要的功能，但对于这个应用程序，我们不需要这样做。</p><p id="5566" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于这次迁移，我将创建一个新的存储库，并使用GitHub Gists保存文件的旧版本，然后用React本机代码修改它。这样，您就可以查看要点并查看对其所做的更改，而不必在web Tic Tac Toe源代码库中创建新的分支。</p><h2 id="a4aa" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">设置</h2><p id="26a6" class="pw-post-body-paragraph jy jz iq ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated"><strong class="ka ir"> <em class="lv">注意01:我在使用VS代码的Mac上进行这次迁移，不确定它是否也适用于Windows环境。</em>T11】</strong></p><p id="eea6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="lv">注02:我还将展示文章大部分内容的iOS模拟器截图。然而，我将展示iOS模拟器和Android模拟器的最终截屏，以证明移植在两个平台上都有效。</em>T15】</strong></p><p id="5738" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">遵循React Native (RN) <a class="ae kw" href="https://facebook.github.io/react-native/docs/getting-started" rel="noopener ugc nofollow" target="_blank">入门</a>页面上的操作系统设置说明。确保遵循“<em class="lv"> React Native CLI快速入门</em>”选项卡。在我的情况下，我按照macOS/iOS/Android的设置步骤。</p><p id="1059" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您还没有从RN文档的“入门”一节开始这样做，请通过运行以下命令创建一个新项目:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="6433" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># As of this article, the latest version of <br/># React Native is v0.58 cd to your project directory <br/># and run:</strong></span><span id="9eb8" class="kx ky iq mb b gy mj mg l mh mi">$ react-native init RNTicTacToe</span><span id="5411" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># Alternatively, if you do not want to install the <br/># react-native cli globally, you can run:</strong></span><span id="6a04" class="kx ky iq mb b gy mj mg l mh mi">$ npx -p react-native-cli react-native init RNTicTacToe</span><span id="7c60" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># Once the project is created cd into it.</strong></span><span id="d0df" class="kx ky iq mb b gy mj mg l mh mi">$ cd RNTicTacToe</span></pre><p id="580c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在新创建的项目中，使用方便的脚本更新<code class="fe mk ml mm mb b">package.json</code>文件，以在iOS或Android中启动应用程序。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="0c1d" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># File: package.json</strong></span><span id="a626" class="kx ky iq mb b gy mj mg l mh mi">{<br/>  "name": "RNTicTacToe",<br/>  ...<br/>  ...<br/>  "scripts": {<br/>    "android": "react-native run-android",<br/>    "ios": "react-native run-ios",<br/>    "rn": "react-native"<br/>  }<br/>  ...<br/>  ...<br/>}</span></pre><p id="2ebf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们知道我们将需要Redux，一个导航框架和一个图标包，因为网页版的游戏使用Redux进行状态管理，一个导航条显示一个菜单，其中有一个“新游戏”按钮和组件中图标的材料图标。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="408e" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># Add Redux and React Navigation, which is the community <br/># supported navigation framework for React Native.</strong></span><span id="64f6" class="kx ky iq mb b gy mj mg l mh mi">$ npm install --save redux redux-thunk react-redux prop-types<br/>$ npm install --save react-navigation react-native-gesture-handler<br/>$ npm install --save react-native-vector-icons</span></pre><p id="ed19" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">包装:</p><ul class=""><li id="8ecf" class="mn mo iq ka b kb kc kf kg kj mp kn mq kr mr kv ms mt mu mv bi translated"><a class="ae kw" href="https://redux.js.org" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Redux </strong> </a> <strong class="ka ir">，</strong><a class="ae kw" href="https://www.npmjs.com/package/redux-thunk" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">Redux Thunk</strong></a><strong class="ka ir">，</strong><a class="ae kw" href="https://www.npmjs.com/package/react-redux" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">React-Redux</strong></a><strong class="ka ir">和</strong><a class="ae kw" href="https://www.npmjs.com/package/prop-types" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">prop types</strong></a>—用于管理状态，延迟调度和连接状态存储到React组件。</li><li id="ef71" class="mn mo iq ka b kb mw kf mx kj my kn mz kr na kv ms mt mu mv bi translated"><a class="ae kw" href="https://reactnavigation.org" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> React导航</strong> </a> <strong class="ka ir">和</strong> <a class="ae kw" href="https://reactnavigation.org/docs/en/getting-started.html#installation" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> React原生手势处理程序</strong></a><strong class="ka ir"/>——React原生app中处理导航的社区包。我们将用它来创建带有“新游戏”按钮的标题栏。</li><li id="7d72" class="mn mo iq ka b kb mw kf mx kj my kn mz kr na kv ms mt mu mv bi translated"><a class="ae kw" href="https://github.com/oblador/react-native-vector-icons" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> React原生矢量图标</strong></a>—React原生应用的图标集。这将用于为玩家选择图标。</li></ul><p id="66db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将React原生矢量图标(vector-icons)链接到iOS和Android项目。我们可以通过从之前用于初始化项目的<code class="fe mk ml mm mb b">react-native-cli</code>中运行<code class="fe mk ml mm mb b">link</code>命令来自动完成这项工作。你可以在这里查看安装步骤<a class="ae kw" href="https://github.com/oblador/react-native-vector-icons#installation" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="5c29" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># If you installed the react-native-cli globally, run:</strong></span><span id="a3b3" class="kx ky iq mb b gy mj mg l mh mi">$ react-native link react-native-vector-icons</span><span id="50c8" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># If you used `npx` to initialize the project, run:</strong></span><span id="f194" class="kx ky iq mb b gy mj mg l mh mi">$ npx -p react-native-cli react-native link react-native-vector-icons</span><span id="7efa" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># or if you added `rn` to the package.json scripts:</strong></span><span id="e6fb" class="kx ky iq mb b gy mj mg l mh mi">$ npm run rn -- link react-native-vector-icons</span><span id="f528" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># Do the same for React Native Gesture Handler:</strong></span><span id="67b2" class="kx ky iq mb b gy mj mg l mh mi">$ npm run rn -- link react-native-gesture-handler</span><span id="c73c" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># You should see 'successful' messages printed in the terminal</strong></span></pre><p id="dba0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，如果您运行这个项目，在iOS模拟器或Android模拟器中应该会出现样板启动屏幕。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/69726e2f4385b0184a988bad8d6677b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxUzbqf-v9aNduo729dT8w.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">iOS模拟器，样板开始屏幕。</figcaption></figure><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="be6d" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># Run on the iOS Simulator:</strong></span><span id="5789" class="kx ky iq mb b gy mj mg l mh mi">$ npm run ios</span><span id="dd33" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir"># or for Android:</strong></span><span id="2b4c" class="kx ky iq mb b gy mj mg l mh mi">$ npm run android</span></pre><p id="21e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们开始迁移之前，还有一件事情需要完成。我希望项目结构反映传统的JavaScript项目，其中源代码位于<code class="fe mk ml mm mb b">src</code>文件夹中，而不是项目的根目录。</p><p id="67fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们更新样板项目结构来反映这一点。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="da16" class="kx ky iq mb b gy mf mg l mh mi"># Add a folder to the project root called `src`.<br/># Add an `index.js` file to the `src` folder.<br/># Move the `app.json` file to the `src` folder.<br/># Move the `App.js` file at the root into the `src` folder.</span><span id="77cc" class="kx ky iq mb b gy mj mg l mh mi"># You can delete the `__tests__` folder. <br/># We will be migrating over our tests from the <br/># web project into the `src` folder.</span><span id="00b3" class="kx ky iq mb b gy mj mg l mh mi"># The project directory should look this this:</span></pre><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/59353b3a10f75e0287e0283dcf8860e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*QjE88WoUhWTCbl7oX5pwEQ.png"/></div></figure><p id="a23c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将需要用当前项目根目录中的代码更新新的<code class="fe mk ml mm mb b">src/index.js</code>文件，以使应用程序再次工作。</p><p id="ad2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将根文件<code class="fe mk ml mm mb b">index.js</code>的内容复制到<code class="fe mk ml mm mb b">./src/index.js</code>文件中。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="83ac" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># File: ./src/index.js</strong></span><span id="94ea" class="kx ky iq mb b gy mj mg l mh mi">// content originally in the ./index.js file<br/>import { AppRegistry } from 'react-native';<br/>import App from './App';<br/>import { name as appName } from './app.json';</span><span id="b479" class="kx ky iq mb b gy mj mg l mh mi">AppRegistry.registerComponent(appName, () =&gt; App);</span></pre><p id="1992" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更新根目录下的<code class="fe mk ml mm mb b">index.js</code>文件，导入<code class="fe mk ml mm mb b">src</code>文件夹下的<code class="fe mk ml mm mb b">index.js</code>文件。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="544b" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># File: ./index.js</strong></span><span id="f428" class="kx ky iq mb b gy mj mg l mh mi">import './src/index';</span></pre><p id="6038" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关闭/退出iOS模拟器，并确保运行Metro bundler的终端已停止。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/00289364b7a6bee86df55f6448586112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVC6T9xqtYNFzT0k_WhOzQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">麦德龙·邦德勒。</figcaption></figure><p id="4881" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再次运行<code class="fe mk ml mm mb b">npm run ios</code>以确保应用程序运行无误。</p><h2 id="b41e" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">移民</h2><p id="2207" class="pw-post-body-paragraph jy jz iq ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我们将从迁移Redux状态存储和ducks开始，然后是React容器组件，最后是表示组件。之后，我们将通过微调风格和定位来润色应用程序。</p><p id="9306" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从克隆现有的网络游戏<a class="ae kw" href="https://github.com/vanister/medium.com" rel="noopener ugc nofollow" target="_blank">井字游戏</a>开始，在一个单独的VS代码窗口中打开它。我发现最好将这两个项目放在一起，这样移动代码更容易。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="4825" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir"># Clone from GitHub</strong></span><span id="8d18" class="kx ky iq mb b gy mj mg l mh mi">$ git clone https://github.com/vanister/medium.com.git</span></pre><p id="e740" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">还原状态</strong></p><p id="255f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于RN本质上是React，除了一些组件与web版本不同之外，我们应该能够不加修改地迁移我们的Redux状态。</p><p id="439f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在web项目中，打开<code class="fe mk ml mm mb b">src/state/ducks/</code>文件夹并将<code class="fe mk ml mm mb b">game</code>文件夹复制到<code class="fe mk ml mm mb b">RNTicTacToe</code>项目的<code class="fe mk ml mm mb b">src/state/</code>文件夹中。</p><p id="4502" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，打开web的<code class="fe mk ml mm mb b">src/state/ducks/utils/game.js</code>文件，并将其内容复制到<code class="fe mk ml mm mb b">RNTicTacToe/src/state/game/selectors.js</code>文件中。</p><p id="bf22" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="lv">注03:我决定将</em> </strong> <code class="fe mk ml mm mb b"><strong class="ka ir"><em class="lv">utils/game.js</em></strong></code> <strong class="ka ir"> <em class="lv">文件移到游戏状态的</em> </strong> <code class="fe mk ml mm mb b"><strong class="ka ir"><em class="lv">selectors.js</em></strong></code> <strong class="ka ir"> <em class="lv">文件中，因为这就是它们的本来面目。</em> </strong></p><p id="c145" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后将网页的<code class="fe mk ml mm mb b">src/state/ducks/index.js</code>和<code class="fe mk ml mm mb b">src/state/store.js</code>复制到<code class="fe mk ml mm mb b">RNTicTacToe/src/state/</code>文件夹。</p><p id="5508" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，打开每个复制的文件，并确保相应地更新引用。它们很可能是<code class="fe mk ml mm mb b">selectors.js</code>、<code class="fe mk ml mm mb b">operations.js</code>和<code class="fe mk ml mm mb b">store.js</code>文件，因为它们引用了web项目结构中的<code class="fe mk ml mm mb b">utils</code>和<code class="fe mk ml mm mb b">ducks</code>文件夹。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/e803d951f2ff088787a85cd5c691390a.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*iY00qVMTQAQWLaF225oQIw.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe状态文件夹。</figcaption></figure><p id="5415" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了确认我们已经移动了所有的redux文件并正确地更新了引用，在<code class="fe mk ml mm mb b">RNTicTacToe</code>项目的终端中运行<code class="fe mk ml mm mb b">npm test</code>，所有的测试都应该通过了。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/399f1aaa4b24cacfb1dc6904dceafac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*VwEj2yRUzzTj7MXq7kT-TA.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">从“RNTicTacToe”终端输出“npm test”。</figcaption></figure><p id="9b3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Redux商店提供商</strong></p><p id="1fb5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然reducers和操作正在工作，那么让我们设置应用程序，为稍后在迁移中使用它们的组件提供Redux存储。</p><p id="e934" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开网站的<code class="fe mk ml mm mb b">src/index.js</code>文件，并将其内容复制到<code class="fe mk ml mm mb b">RNTicTacToe/src/index.js</code>文件中。接下来用下面的要点替换<code class="fe mk ml mm mb b">RNTicTacToe/src/index.js</code>文件的内容。</p><p id="e7a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="lv">注04:直接在gist.github.com上转到要点，选择</em> </strong> <code class="fe mk ml mm mb b"><strong class="ka ir"><em class="lv">revisions</em></strong></code> <strong class="ka ir"> <em class="lv">查看web代码和React原生代码变化之间的变化。</em> </strong></p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/index.js文件。</figcaption></figure><p id="3cc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再次运行应用程序，或者如果iOS模拟器和Metro Bundler仍在运行，请点击<code class="fe mk ml mm mb b">Command+R</code>刷新应用程序。</p><p id="54ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您也可以通过点击<code class="fe mk ml mm mb b">Command+D</code>然后选择“启用实时重装”来启用实时重装</p><p id="db66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">标题和导航</strong></p><p id="209a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们开始迁移组件之前，我们应该添加一个应用程序标题栏，类似于Material-UI为我们的web应用程序提供的标题栏。我们将使用React导航来实现这一点。</p><p id="d226" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们需要的话，使用React导航来创建我们的应用程序标题也将为我们提供导航或顶级模态展示的支持。</p><p id="8e13" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们首先为我们的“screens”创建一个文件夹，它也将在稍后的迁移中充当我们的容器组件。</p><p id="ae82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将以下文件添加到<code class="fe mk ml mm mb b">screens</code>文件夹:<code class="fe mk ml mm mb b">screens.js</code>、<code class="fe mk ml mm mb b">index.js</code>和<code class="fe mk ml mm mb b">GameScreen.js</code>。</p><p id="62d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mk ml mm mb b">screens.js</code>文件是我们在应用程序中保存屏幕常量的地方，因此我们不必直接依赖其他可能需要它的组件中的神奇字符串。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="da5f" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir">// File: src/screens/screens.js</strong></span><span id="c6ff" class="kx ky iq mb b gy mj mg l mh mi">const GAME = 'Game';</span><span id="00e3" class="kx ky iq mb b gy mj mg l mh mi">export default {<br/>  GAME<br/>};</span></pre><p id="7710" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mk ml mm mb b">index.js</code>文件是我们在<code class="fe mk ml mm mb b">screens</code>文件夹中保存屏幕注册码和公共模块集中导出的地方。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="b75d" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir">// File: src/screens/index.js</strong></span><span id="f4f4" class="kx ky iq mb b gy mj mg l mh mi">import { createStackNavigator } from 'react-navigation';<br/>import screens from './screens';<br/>import GameScreen from './GameScreen';</span><span id="a157" class="kx ky iq mb b gy mj mg l mh mi">const { GAME } = screens;</span><span id="a726" class="kx ky iq mb b gy mj mg l mh mi">const createAppNavigator = () =&gt; { <br/>  const appNavigator = createStackNavigator(<br/>    {<br/>      [GAME]: GameScreen<br/>    },<br/>    {<br/>      initialRouteName: GAME,<br/>      defaultNavigationOptions: {<br/>        headerTintColor: '#fff',<br/>        headerStyle: {<br/>          <strong class="mb ir"><em class="lv">// material blue theme color</em></strong><em class="lv"><br/>          </em>backgroundColor: '#3f51b5'<br/>        }<br/>      }<br/>    }<br/>  );</span><span id="4f3d" class="kx ky iq mb b gy mj mg l mh mi">  return appNavigator;<br/>};</span><span id="2051" class="kx ky iq mb b gy mj mg l mh mi">export {<br/>  createAppNavigator<br/>};</span><span id="8fba" class="kx ky iq mb b gy mj mg l mh mi"><strong class="mb ir">// we export screens here so we can use it in other<br/>// modules with just an import to `./screens` </strong><br/>export default screens;</span></pre><p id="3bb1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">目前，<code class="fe mk ml mm mb b">GameScreen.js</code>文件只是web项目中被迁移的<code class="fe mk ml mm mb b">Game.jsx</code>容器组件的一个存根。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="3626" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir">// File: src/screens/GameScreen.js</strong></span><span id="404c" class="kx ky iq mb b gy mj mg l mh mi">import React, { Component } from 'react';<br/>import { <br/>  StatusBar, <br/>  StyleSheet, <br/>  Text, <br/>  View <br/>} from 'react-native';</span><span id="28ec" class="kx ky iq mb b gy mj mg l mh mi">class GameScreen extends Component {<br/>  // part of react-navigation to style the header<br/>  static navigationOptions = {<br/>    title: 'Tic Tac Toe'<br/>  };</span><span id="53f8" class="kx ky iq mb b gy mj mg l mh mi">  render() {<br/>    return (<br/>      &lt;View style={styles.container}&gt;<br/>        &lt;StatusBar barStyle='light-content'&gt;&lt;/StatusBar&gt;<br/>        &lt;Text&gt;Game Screen!&lt;/Text&gt;<br/>      &lt;/View&gt;<br/>    );<br/>  }<br/>}</span><span id="4c65" class="kx ky iq mb b gy mj mg l mh mi">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1<br/>  }<br/>});</span><span id="e551" class="kx ky iq mb b gy mj mg l mh mi">export default GameScreen;</span></pre><p id="5876" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，打开<code class="fe mk ml mm mb b">App.js</code>文件，用我们刚刚从<code class="fe mk ml mm mb b">screens</code>文件夹中写的导航和标题代码更新它。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="6da8" class="kx ky iq mb b gy mf mg l mh mi"><strong class="mb ir">// File: src/App.js</strong></span><span id="5b71" class="kx ky iq mb b gy mj mg l mh mi">import React from 'react';<br/>import { createAppContainer } from 'react-navigation';</span><span id="8197" class="kx ky iq mb b gy mj mg l mh mi">import { createAppNavigator } from './screens';</span><span id="0c43" class="kx ky iq mb b gy mj mg l mh mi">const appNavigator = createAppNavigator();<br/>const AppContainer = createAppContainer(appNavigator);</span><span id="f686" class="kx ky iq mb b gy mj mg l mh mi">const App = () =&gt; {<br/>  return (<br/>    &lt;AppContainer&gt;&lt;/AppContainer&gt;<br/>  );<br/>};</span><span id="ad69" class="kx ky iq mb b gy mj mg l mh mi">export default App;</span></pre><p id="a0c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再次运行该应用程序，我们应该会看到一个带有蓝色标题栏、白色主体和文本“游戏屏幕”的屏幕</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/48d778f6c0daae7c46564c263be87fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*np9krKQgl4nkRcmy5YkK1Q.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">iOS模拟器，带有React导航标题和游戏屏幕。</figcaption></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="98f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你会看到很多改变使用了React Native内置的Flexbox进行布局和定位。你可以在这里阅读更多关于Flexbox的信息。</p><div class="nt nu gp gr nv nw"><a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">Flexbox | CSS-技巧完全指南</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">我们的CSS flexbox布局综合指南。这份完整的指南解释了flexbox的一切，重点是所有…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">css-tricks.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok jw nw"/></div></div></a></div></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="9e7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">表象/无状态成分</strong></p><p id="2b07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个<code class="fe mk ml mm mb b">src/components/</code>文件夹来保存我们所有的演示组件。</p><p id="e9aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为负责在网格中呈现<code class="fe mk ml mm mb b">X</code>或<code class="fe mk ml mm mb b">O</code>的组件添加一个名为<code class="fe mk ml mm mb b">Square.js</code>的文件，然后向其中添加以下代码。</p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/components/square . js—请记住，您可以在github上查看这个要点，并将旧的web jsx版本与这个版本进行比较。</figcaption></figure><p id="dbf8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mk ml mm mb b">PlayerInfo</code>组件显示哪个玩家是游戏中的当前玩家，如果游戏已经结束，则显示“Gameover”消息。将<code class="fe mk ml mm mb b">PlayerInfo.js</code>文件添加到<code class="fe mk ml mm mb b">src/components/</code>中，并用以下代码进行更新:</p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/components/player info . js</figcaption></figure><p id="8acd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mk ml mm mb b">GameoverDialog</code>组件显示游戏结束的时间，并告诉我们谁赢得了游戏，并可以选择直接从模式开始新的游戏。</p><p id="3ee2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将名为<code class="fe mk ml mm mb b">GameoverModal.js</code>的文件添加到<code class="fe mk ml mm mb b">src/components/</code>文件夹中，并用下面的代码更新它。</p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/components/gameovermodal . js—我们称之为模态，因为在RN中他们称之为模态。在Material-UI中，它被称为对话框。</figcaption></figure><p id="7961" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于我们没有为React原生应用程序实现菜单，我们需要用一个<code class="fe mk ml mm mb b">HeaderButton</code>组件替换<code class="fe mk ml mm mb b">Menu</code>组件，以从头部触发一个新游戏。</p><p id="b670" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将名为<code class="fe mk ml mm mb b">HeaderButton.js</code>的文件添加到<code class="fe mk ml mm mb b">src/components/</code>文件夹中，并用以下代码对其进行更新:</p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/components/header button . js</figcaption></figure><p id="651f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后一个要迁移的表示组件是<code class="fe mk ml mm mb b">Board</code>组件。这是游戏的核心，在这里<code class="fe mk ml mm mb b">X</code>和<code class="fe mk ml mm mb b">O</code>被渲染到屏幕上一个3x3的网格中。这个组件使用我们之前迁移的<code class="fe mk ml mm mb b">Square</code>组件来完成这个任务。</p><p id="0447" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将名为<code class="fe mk ml mm mb b">Board.js</code>的文件添加到<code class="fe mk ml mm mb b">src/components/</code>中，并更新为以下内容:</p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/components/board . js</figcaption></figure><p id="36fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">容器组件</strong></p><p id="2ad0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，剩下要做的唯一一件事就是将<code class="fe mk ml mm mb b">Game</code>组件迁移到我们的存根<code class="fe mk ml mm mb b">GameScreen</code>组件上，一切都应该完成了。</p><p id="3301" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开文件夹<code class="fe mk ml mm mb b">src/screens/</code>中的<code class="fe mk ml mm mb b">GameScreen.js</code>文件，并将其替换为以下代码:</p><figure class="lw lx ly lz gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">RNTicTacToe/src/screens/game screen . js</figcaption></figure><p id="7955" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">应该可以了。如果我们再次启动应用程序，我们应该会看到一个功能正常的TicTacToe游戏。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/a4ae1e3cf07c27e48de5e88b24041f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ovl6PHG1UneseMud7HM8RA.gif"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">来自iOS模拟器和Android模拟器的游戏。</figcaption></figure><h2 id="1843" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">结论</h2><p id="2931" class="pw-post-body-paragraph jy jz iq ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我可以说，游戏中的大部分逻辑都被原封不动地移植过来了。Material-UI在React Native中不作为包提供，因此必须使用视图、文本、TouchableOpacity(按钮)和Flexbox布局在React Native中重新创建这些组件。</p><p id="5867" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总的来说，大约30%的代码需要修改，其中大部分是样式化的，这样才能在移动设备上进行移植。</p><p id="2cf6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请记住，如果你在gist.github.com上直接进入网站，你可以看到网站的不同之处。只需单击要点框架底部的文件名:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/327b1417b329cf3f62170b1bb064f67e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*69pFCQ-OEnyMc70BocvW3A.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">点击文件名的“查看原始文件”,然后选择“修订”选项卡。</figcaption></figure><p id="f904" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的阅读！</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="e226" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文章来源:<a class="ae kw" href="https://github.com/vanister/RNTicTacToe" rel="noopener ugc nofollow" target="_blank">https://github.com/vanister/RNTicTacToe</a>。</p><p id="7360" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">web React井字游戏来源:<a class="ae kw" href="https://github.com/vanister/medium.com/tree/master/tic-tac-toe" rel="noopener ugc nofollow" target="_blank">https://github . com/vanister/medium . com/tree/master/Tic-Tac-Toe</a>。</p></div></div>    
</body>
</html>
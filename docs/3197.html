<html>
<head>
<title>Laravel and Vue: Creating a Portfolio website with a CRUD admin panel — Chapter Two</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第二章</h1>
<blockquote>原文：<a href="https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-92b4017df57e?source=collection_archive---------0-----------------------#2019-10-22">https://itnext.io/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-92b4017df57e?source=collection_archive---------0-----------------------#2019-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7d04" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">图像上传和显示</h2></div><p id="2b5d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">回顾:</strong>在第一章中，我们能够从数据库中获取一个名称，并将其显示在vue组件中。这意味着我们有一种方法来检索数据，然后将其呈现到vue组件中。vue组件显示为网页的一个元素。</p><p id="ecc2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">在</strong>之前，我们继续创建图像上传功能。我们需要在现有代码变得太混乱和难以查看之前清理它们。</p><h1 id="2cdd" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">让我们做一些清洁和整理工作</strong></h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lw"><img src="../Images/279c9b833e8d7608ce0c98b9ffa129f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4Mponox23rKFWZ1_"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">杰夫·谢尔登在<a class="ae mm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="1c73" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像Vue JS这样的框架的一个优点是，你可以在组件中拥有<strong class="kk iu">组件，</strong>举例来说，你可以拥有:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="c774" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;div&gt;<br/>        <strong class="mo iu">&lt;first-component&gt;&lt;/first-component&gt;<br/>        &lt;second-component&gt;&lt;/second-component&gt;</strong><br/>    &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="715e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在不同的vue文件中构建网站的不同部分，并将它们编译为最终的单页应用程序，因此让我们来构建子组件。</p><h2 id="74ab" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated"><strong class="ak">构建子组件</strong></h2><p id="913e" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">我们目前App.vue的模板标签是这样的:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="73ca" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;div&gt;<br/>        <strong class="mo iu">{{name}}</strong><br/>    &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="6280" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在完成的网站，我想有一个标题元素的名称。</p><p id="724f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要创建一个名为<strong class="kk iu"> masthead.vue </strong>的新vue组件</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="5b2f" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;header&gt;<br/>        <strong class="mo iu">&lt;h1&gt;{{name}}&lt;/h1&gt;</strong><br/>    &lt;/header&gt;<br/>&lt;/template&gt;</span></pre><p id="2894" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并更改App.vue的模板标签以反映:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="f382" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;div&gt;<br/>        <strong class="mo iu">&lt;masthead&gt;&lt;/masthead&gt;</strong><br/>    &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="fc62" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">报头组件<strong class="kk iu">将</strong>出现在Vue Devtools中，但<strong class="kk iu">不会</strong>出现在Inspect元素中，也不会呈现在页面上。</p><p id="15ad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将在浏览器控制台中看到以下消息:</p><blockquote class="nn"><p id="609e" class="no np it bd nq nr ns nt nu nv nw ld dk translated">属性或方法“name”不是在实例上定义的，而是在呈现过程中引用的。</p></blockquote><p id="153d" class="pw-post-body-paragraph ki kj it kk b kl nx ju kn ko ny jx kq kr nz kt ku kv oa kx ky kz ob lb lc ld im bi translated">这意味着模板标签试图呈现<strong class="kk iu"> {{name}} </strong>，但是这在脚本标签中是不可用的。</p><p id="5ee7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">{{name}}数据在主组件中，但这是一个<strong class="kk iu">子组件(组件中的组件)。</strong></p><p id="f9b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">子组件通过<strong class="kk iu"> props </strong>访问父组件的数据，所以让我们将props引入masthead.vue的脚本标签</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="9254" class="ms lf it mo b gy mt mu l mv mw">&lt;script&gt;<br/>    <em class="oc">export default </em>{<br/>        name: "masthead",<br/>        <strong class="mo iu">props: {<br/>            name: String<br/>        }</strong><br/>    }<br/>&lt;/script&gt;</span></pre><p id="4bef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Vue Devtools中，您会发现:</p><blockquote class="nn"><p id="ac96" class="no np it bd nq nr ns nt nu nv nw ld dk translated"><strong class="ak">名称:未定义</strong></p></blockquote><p id="00f6" class="pw-post-body-paragraph ki kj it kk b kl nx ju kn ko ny jx kq kr nz kt ku kv oa kx ky kz ob lb lc ld im bi translated">要解决此问题，请将App.vue更改为:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="422c" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;div&gt;<br/>        <strong class="mo iu">&lt;masthead <em class="oc">:name</em>="name"&gt;&lt;/masthead&gt;</strong><br/>    &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="1528" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码解释:</p><blockquote class="od oe of"><p id="3c7b" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated"><strong class="kk iu"> :name </strong>表示当报头组件请求<strong class="kk iu"> {{name}} </strong>时，提供双引号中的内容</p><p id="e7ed" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">双引号内有<strong class="kk iu"> <em class="it">名称</em> </strong>，是App.vue中<strong class="kk iu"> data() </strong>的数据</p></blockquote></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h1 id="1c18" class="le lf it bd lg lh oq lj lk ll or ln lo jz os ka lq kc ot kd ls kf ou kg lu lv bi translated">图像上传</h1><h2 id="f898" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated"><strong class="ak">准备好图像上传组件</strong></h2><p id="a20f" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">在App.vue中，在模板标签内添加<strong class="kk iu">&lt;&gt;&lt;/image-uploader&gt;</strong>。在脚本标签中，<strong class="kk iu">导入图像上传器</strong>，并在组件对象中注册<strong class="kk iu">图像上传器</strong>。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="b144" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;div&gt;<br/>        &lt;masthead <em class="oc">:name</em>="name"&gt;&lt;/masthead&gt;<br/>        <strong class="mo iu">&lt;image-uploader&gt;&lt;/image-uploader&gt;</strong><br/>    &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/><br/>&lt;script&gt;<br/>    <em class="oc">import </em>masthead <em class="oc">from </em>'./masthead';<br/>    <strong class="mo iu"><em class="oc">import </em>imageUploader <em class="oc">from </em>'./ImageUploader';</strong><br/>    <em class="oc">export default </em>{<br/>        name: "App",<br/>        components: {<br/>            masthead,<br/>            <strong class="mo iu">imageUploader</strong><br/>        },<br/>        data() {<br/>          <em class="oc">return </em>{<br/>              name: '',<br/>          }<br/>        },<br/>        mounted() {<br/>            <em class="oc">this</em>.getBasicInfo();<br/>        },<br/>        methods: {<br/>            getBasicInfo() {<br/>                axios.get('/api/basicinfo')<br/>                    .then(response =&gt; {<br/>                        console.log(response.data);<br/>                        <em class="oc">this</em>.name = response.data.name;<br/>                    })<br/>                    .catch(error =&gt; {<br/>                        console.log(error);<br/>                    });<br/>            },<br/>        },<br/>    }<br/>&lt;/script&gt;</span></pre><h2 id="05f7" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated">创建图像上传组件</h2><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="c0be" class="ms lf it mo b gy mt mu l mv mw">&lt;template&gt;<br/>    &lt;section&gt;<br/>        Upload Images Here:<br/>    &lt;/section&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>    <em class="oc">export default </em>{<br/>        name: "ImageUploader"<br/>    }<br/>&lt;/script&gt;</span></pre><p id="3e90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在浏览器中，您将找到您的姓名(来自报头组件)和文本<strong class="kk iu">上传图像到此处</strong>(来自图像上传组件)。</p><p id="6142" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在文本旁边，我们将构建一个表单。上传表单有一个<strong class="kk iu">文件选择字段</strong>(输入类型=文件)和一个按钮，让我们创建这样一个表单:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="cb96" class="ms lf it mo b gy mt mu l mv mw">&lt;section <em class="oc">id</em>="upload-image-component"&gt;<br/>    Upload Images Here:<br/>    <strong class="mo iu">&lt;form&gt;<br/>        &lt;input <em class="oc">type</em>="file"&gt;<br/>        &lt;button&gt;Upload!&lt;/button&gt;<br/>    &lt;/form&gt;</strong><br/>&lt;/section&gt;</span></pre><p id="abb7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这一点上，选择一个文件并点击上传按钮不会做任何事情，除了一个无意义的页面刷新。</p><p id="837c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们想要做的是<strong class="kk iu">上传一个选定的文件</strong>，所以让我们为此创建一个方法</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="8e70" class="ms lf it mo b gy mt mu l mv mw">uploadFile(<strong class="mo iu">event</strong>) {<br/>    <br/>},</span></pre><blockquote class="od oe of"><p id="ab29" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">让我们来理解一下<strong class="kk iu">事件的</strong>位</p></blockquote><p id="c15b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">事件</strong> —当你与一个页面交互时，那是一个<strong class="kk iu"> HTML事件</strong>。Javascript和Javascript框架(在这种情况下，Vue JS)可以用来<strong class="kk iu">处理</strong>在这些事件中发生的事情。在我们的例子中，当我们更改文件输入时，我们希望运行uploadFile方法。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="0c4c" class="ms lf it mo b gy mt mu l mv mw"><strong class="mo iu">&lt;</strong>input <em class="oc">type</em>="file"<strong class="mo iu"> @change="uploadFile"&gt;</strong></span></pre><p id="637c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们console.log事件，我们可以在浏览器控制台中看到一个json对象，标记为Event(chrome)或change(Firefox)。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="c073" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    console.log(event)<br/>},</span></pre><p id="2a9b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个事件的json中有一个名为<strong class="kk iu"> target的部分。</strong>看看那个</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="8dee" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    console.log(event.<strong class="mo iu">target</strong>)<br/>},</span></pre><p id="8ff1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将发现一个json，其中包含我们的输入文件字段的详细信息。在这个json中，您会发现另一个名为<strong class="kk iu">的文件</strong>。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="3cb8" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    console.log(event.target.<strong class="mo iu">files</strong>)<br/>},</span></pre><p id="b994" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在您可以在控制台中看到FileList。<strong class="kk iu">这就是我们需要上传的选定文件。</strong>然而，由于我们只需要第一个，我们需要添加<strong class="kk iu">【0】</strong></p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="6537" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    console.log(event.target.files<strong class="mo iu">[0]</strong>)<br/>},</span></pre><p id="f67f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在您将在json中看到关于该文件的信息。</p><h2 id="94ad" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated">我们如何发送文件？</h2><p id="84dc" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">我们将使用<strong class="kk iu"> FormData() </strong>发送文件。</p><blockquote class="od oe of"><p id="d847" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">在通常的形式中，有<strong class="kk iu">字段</strong>和<strong class="kk iu">值</strong>。例如，可以有一个输入文本字段(<strong class="kk iu">字段</strong>)询问您的姓名(<strong class="kk iu">值</strong>)。</p><p id="a548" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">在FormData()中，字段和值变成<strong class="kk iu">键和值</strong>。</p></blockquote><p id="4324" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用FormData()，您<strong class="kk iu">将一个键和值附加到</strong>上。我们的键是<strong class="kk iu"> userpic，</strong>，值是<strong class="kk iu"> file。</strong></p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="c278" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    <em class="oc">let </em><strong class="mo iu">file</strong> = event.target.files[0];<br/>    <em class="oc">let </em>fd = <em class="oc">new </em>FormData();<br/>    fd.<strong class="mo iu">append</strong>('<strong class="mo iu">userpic</strong>', <strong class="mo iu">file</strong>);<br/>},</span></pre><p id="b7ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查文件是否被附加:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="d54e" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    <em class="oc">let </em>file = event.target.files[0];<br/>    <em class="oc">let </em>fd = <em class="oc">new </em>FormData();<br/>    fd.append('userpic', file);<br/>    <strong class="mo iu"><em class="oc">for </em>(<em class="oc">const </em>value <em class="oc">of </em>fd.values()) {<br/>        console.log(value);<br/>    }</strong><br/>},</span></pre><p id="9f38" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将表单数据发布到路线:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="c500" class="ms lf it mo b gy mt mu l mv mw">uploadFile(event) {<br/>    <em class="oc">let </em>file = event.target.files[0];<br/>    <em class="oc">let </em>fd = <em class="oc">new </em>FormData();<br/>    fd.append('userpic', file);<br/>    <em class="oc">for </em>(<em class="oc">const </em>value <em class="oc">of </em>fd.values()) {<br/>        console.log(value);<br/>    }<br/>    <strong class="mo iu">axios.post('/api/uploadimage', fd);</strong><br/>},</span></pre><blockquote class="od oe of"><p id="5227" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">代码解释:</p><p id="0825" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">axios.post由<strong class="kk iu">发布到哪里、</strong>后跟<strong class="kk iu">发布什么</strong>组成</p><p id="abab" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">我们正在张贴到<strong class="kk iu"> /api/uploadimage </strong>路线，</p><p id="84c7" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">贴的是<strong class="kk iu"> fd ( </strong> userpic附后)</p><p id="837f" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">另一种看待这个问题的方式是:</p></blockquote><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="abe0" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">let </em>where = '/api/uploadimage';<br/><em class="oc">let </em>what = fd;<br/>axios.post(where, what);</span></pre><p id="227d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">增加以下<strong class="kk iu">岗位</strong>路线到api.php</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="49e6" class="ms lf it mo b gy mt mu l mv mw">Route::<strong class="mo iu"><em class="oc">post</em></strong>('/uploadimage', 'UploadController@UploadImage');</span></pre><p id="03aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在创建并打开控制器文件。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="5229" class="ms lf it mo b gy mt mu l mv mw">php artisan make:controller UploadController</span></pre><p id="3218" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们开始编写控制器函数之前，让我们了解一下当我们发布一些东西时会发生什么。</p><h2 id="3f35" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated"><strong class="ak">当你发布</strong>时会发生什么</h2><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ov"><img src="../Images/96de38a4e4071b5d75b6c43ca1992e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EREbdm_ZEHJ1eft3"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">照片由<a class="ae mm" href="https://unsplash.com/@siora18?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Siora摄影</a>在<a class="ae mm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="a4d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们在邮局寄东西时，我们是在把<strong class="kk iu">东西</strong>装在<strong class="kk iu">信封</strong>里寄给<strong class="kk iu">人</strong>。我们可能<strong class="kk iu">请求</strong>我们要发送的人做一些<strong class="kk iu">动作</strong>(读、写回信、付钱给我们等等。).</p><blockquote class="nn"><p id="2683" class="no np it bd nq nr ns nt nu nv nw ld dk translated">材料📩▶️PERSON ▶️ACTION</p></blockquote><p id="f06e" class="pw-post-body-paragraph ki kj it kk b kl nx ju kn ko ny jx kq kr nz kt ku kv oa kx ky kz ob lb lc ld im bi translated">当我们在网站上发布内容时，我们会将<strong class="kk iu">请求数据</strong>发送到<strong class="kk iu">服务器</strong>。我们希望服务器对请求数据做出反应。这种反应称为<strong class="kk iu">响应</strong>(例如，存储文件)。</p><blockquote class="nn"><p id="e608" class="no np it bd nq nr ns nt nu nv nw ld dk translated">请求数据📩服务器响应</p></blockquote><h2 id="db17" class="ms lf it bd lg mx ow dn lk mz ox dp lo kr oy nc lq kv oz ne ls kz pa ng lu nh bi translated">规划响应</h2><p id="3a97" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">我们正在UploadController中对响应进行编程。让<strong class="kk iu">将<strong class="kk iu">请求</strong>数据返回</strong>到前端(Vue JS)。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="5dcc" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>        <strong class="mo iu"><em class="oc">return</em></strong><em class="oc"> </em><strong class="mo iu">request()</strong>;<em class="oc"><br/>    </em>}</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi pb"><img src="../Images/b5136eacc4086e4135de5e84afc16728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B0dhhP__37VoX-6kv5pWZQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">数据在前端(VueJS)和后端(Laravel)之间来回传输</figcaption></figure><p id="b2a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，Laravel控制器将查看请求()。但是，您不会知道控制器在看什么，除非您修改ImageUploader组件的脚本标记，如下所示:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="1d4a" class="ms lf it mo b gy mt mu l mv mw">axios.post(where, what)<strong class="mo iu">.then(response =&gt; console.log(response));</strong></span></pre><blockquote class="od oe of"><p id="36c3" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">代码解释:</p><p id="b2a6" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">发布数据，<strong class="kk iu">然后</strong>获取<strong class="kk iu">响应</strong>数据并<strong class="kk iu">记录</strong>到浏览器<strong class="kk iu">控制台</strong></p></blockquote><p id="1e70" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看您的浏览器控制台，您可以看到Laravel看到的内容。</p><p id="014b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要查看它是否看到一个<strong class="kk iu">文件</strong>，将UploadImage函数改为:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="9fcc" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>        <em class="oc">return </em>request()<strong class="mo iu">-&gt;file()</strong>;<em class="oc"><br/>    </em>}</span></pre><p id="fe3e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们试图存储文件</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="8dd5" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>        <em class="oc">return </em>request()<strong class="mo iu">-&gt;file()</strong>-&gt;store('userpics');<em class="oc"><br/>    </em>}</span></pre><p id="e5c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它会给你这个错误:</p><blockquote class="nn"><p id="4490" class="no np it bd nq nr ns nt nu nv nw ld dk translated">对数组上的成员函数存储()的调用</p></blockquote><p id="e6aa" class="pw-post-body-paragraph ki kj it kk b kl nx ju kn ko ny jx kq kr nz kt ku kv oa kx ky kz ob lb lc ld im bi translated">我们需要使用括号()中文件的<strong class="kk iu">键</strong>。我们在vue组件中设置的键是<strong class="kk iu"> userpic </strong></p><p id="ec07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们把带有密钥userpic的文件存储在一个名为<strong class="kk iu"> userpics </strong>的文件夹中</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="6770" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>        <em class="oc">return </em>request()<strong class="mo iu">-&gt;</strong>file<strong class="mo iu">('userpic')</strong>-&gt;store('<strong class="mo iu">userpics</strong>');<em class="oc"><br/>    </em>}</span></pre><p id="a27e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将在<strong class="kk iu"> storage/app/userpics </strong>文件夹中找到您上传的图像，并随机命名。</p><blockquote class="od oe of"><p id="e3c3" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">重要事项:匹配您的钥匙</p></blockquote><p id="0a79" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您更改文件()中的键，您将得到以下错误</p><blockquote class="nn"><p id="6f3b" class="no np it bd nq nr ns nt nu nv nw ld dk translated">对空成员函数存储()的调用</p></blockquote><p id="3b20" class="pw-post-body-paragraph ki kj it kk b kl nx ju kn ko ny jx kq kr nz kt ku kv oa kx ky kz ob lb lc ld im bi translated">所以你<strong class="kk iu">必须使用正确的键</strong>，也就是附加在vue组件中的那个。</p><p id="a697" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">图像上传已完成，但未显示。让我们转到图像显示。</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h1 id="8e45" class="le lf it bd lg lh oq lj lk ll or ln lo jz os ka lq kc ot kd ls kf ou kg lu lv bi translated">图像显示</h1><p id="ab88" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">图像显示的方法与第一章“显示您的姓名”相似。然而，我们必须理解这些差异。</p><p id="bf94" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">的主要区别</strong>是我们将不会在数据库中存储数据本身，而是存储数据库中数据的路径。</p><blockquote class="od oe of"><p id="c0f8" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">本例中的数据是我们上传的图像。</p></blockquote><p id="c057" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我们的步骤是:</p><ol class=""><li id="07ab" class="pc pd it kk b kl km ko kp kr pe kv pf kz pg ld ph pi pj pk bi translated">将图像的路径存储在数据库表中</li><li id="ee31" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld ph pi pj pk bi translated">使路径数据在路线上可用</li><li id="93c1" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld ph pi pj pk bi translated">接收脚本标签中的路径</li><li id="1421" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld ph pi pj pk bi translated">使用路径在模板标签中显示图像</li></ol><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi pq"><img src="../Images/41d308973a0825652b7f83b87e8c2457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M4DKgJcVZSCpWsdFhyZMow.png"/></div></div></figure><h2 id="ebb6" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated">1.将图像的路径存储在数据库表中</h2><p id="55f7" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">在第一章中，当我们想要显示一个名字时，我们使用了一个<strong class="kk iu">迁移</strong>，一个<strong class="kk iu">模型</strong>和<strong class="kk iu">修补程序</strong>。</p><blockquote class="od oe of"><p id="b611" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">修补的使用是暂时的。</p></blockquote><p id="2e45" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一次我们可以做同样的事情，但这并不理想。我们需要使用适当的程序。理想的流程是<strong class="kk iu">迁移+模型+控制器</strong></p><p id="6bc4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">注意:我们将使用现有的控制器，不制作新的控制器</strong></p><blockquote class="od oe of"><p id="5e55" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated"><strong class="kk iu">新</strong>迁移+ <strong class="kk iu">新</strong>型号+ <strong class="kk iu">现有</strong>控制器</p></blockquote><p id="b903" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">迁移:——</p><p id="ff0d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">进行迁移。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="4f65" class="ms lf it mo b gy mt mu l mv mw">php artisan make:migration <strong class="mo iu">CreateImageTable</strong></span></pre><p id="db10" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">修改up函数以包含一个<strong class="kk iu">路径</strong>列。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="537f" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>up()<br/>{<br/>    Schema::create('image', <em class="oc">function </em>(Blueprint $table) {<br/>        $table-&gt;bigIncrements('id');<br/>        <strong class="mo iu">$table-&gt;string('path');</strong><br/>        $table-&gt;timestamps();<br/>    });<br/>}</span></pre><p id="bf12" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行迁移。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="df9b" class="ms lf it mo b gy mt mu l mv mw">php artisan migrate</span></pre><p id="6028" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看数据库；您有一个名为<strong class="kk iu">图像</strong>的表格，其中有一个名为<strong class="kk iu">路径</strong>的列。</p><p id="b924" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">型号:——</strong></p><p id="b199" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">制作模型。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="3ed1" class="ms lf it mo b gy mt mu l mv mw">php artisan make:model <strong class="mo iu">Image</strong></span></pre><p id="af8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在模型中有一个可填充的数组。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="bb2a" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">protected </em>$fillable = ['path'];</span></pre><p id="71bd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">控制器:——</strong></p><p id="e686" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">打开现有的控制器(<strong class="kk iu">UploadController.php)</strong>和<strong class="kk iu">使用</strong>镜像模式</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="c53a" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">namespace </em>App\Http\Controllers;<br/><br/><em class="oc">use </em>Illuminate\Http\Request;<br/><strong class="mo iu"><em class="oc">use </em>App\Image;</strong></span></pre><p id="8755" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">我们想要的</strong>:上传图像时，将路径存储在数据库中。</p><p id="53e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们必须使用与上传相同的函数来存储路径。</p><p id="1bfc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">让我们测试编辑上传图像功能</strong></p><p id="455a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们这里写的代码和tinker里面写的差不多。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="3ed7" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>    <strong class="mo iu">$image = <em class="oc">new </em>Image();<br/>    $image-&gt;path = 'foo';<br/>    $image-&gt;save();</strong><br/>    <em class="oc">return </em>request()-&gt;file('userpic')-&gt;store('userpics');<br/>}</span></pre><p id="c4e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将在数据库表中找到文本为<strong class="kk iu"> foo的列<strong class="kk iu"> path </strong>。</strong></p><p id="f16e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">让我们适当地编辑一下功能</strong></p><p id="74c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上传图像时，您正在使用存储功能。store函数本身包含一个hashName()函数。hashName()是创建随机文件名的函数。</p><p id="c742" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以直接在我们的文件上使用hashName()函数，并在浏览器<strong class="kk iu">控制台</strong>和<strong class="kk iu">网络</strong>选项卡<strong class="kk iu">检查元素</strong>中查看散列文件名。</p><p id="9f5e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">注意:当一条返回线结束时，功能停止运行。</strong></p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="0912" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>    <strong class="mo iu"><em class="oc">return </em>request()-&gt;file('userpic')-&gt;hashName();</strong><br/>    $image = <em class="oc">new </em>Image();<br/>    $image-&gt;path = 'foo';<br/>    $image-&gt;save();<br/>    <em class="oc">return </em>request()-&gt;file('userpic')-&gt;store('userpics');<br/>}</span></pre><p id="4779" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将在浏览器控制台和网络选项卡中找到随机文件名。</p><p id="a459" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们将随机文件名存储在path列中。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="a8e6" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>UploadImage() {<br/>    $image = <em class="oc">new </em>Image();<strong class="mo iu"><br/>    </strong>$image-&gt;path = <strong class="mo iu">request()-&gt;file('userpic')-&gt;hashName();<br/>    </strong>$image-&gt;save();<br/>    <em class="oc">return </em>request()-&gt;file('userpic')-&gt;store('userpics');<br/>}</span></pre><p id="1459" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查四个地方—</p><p id="fd28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> a.) </strong>控制台</p><p id="3880" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> b.) </strong>网络选项卡</p><p id="9a1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> c.) </strong>数据库</p><p id="16ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> d.) </strong>用户照片文件夹</p><p id="c720" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果可以在控制台、网络选项卡和数据库中看到文件名；并且您可以在userpics文件夹中看到文件本身，您已经成功地创建了UploadImage函数。👏 🎆</p><blockquote class="od oe of"><p id="f4f8" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated">T <!-- -->他<strong class="kk iu">迁移+模型+控制器</strong>的过程已经填充到数据库中</p></blockquote><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi pq"><img src="../Images/25f027c79e0ac3bc20da456849c406c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HW6wsWMpzy4fHE3InQc8eA.png"/></div></div></figure><h2 id="ccfa" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated">2.使路径数据在路线上可用</h2><p id="d619" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">向api.php文件添加一个<strong class="kk iu"> get </strong> route。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="a559" class="ms lf it mo b gy mt mu l mv mw">Route::<strong class="mo iu">get</strong>('/image', 'ImageController@getImage');</span></pre><p id="4b5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">制作控制器。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="d8c4" class="ms lf it mo b gy mt mu l mv mw">php artisan make:controller ImageController</span></pre><p id="4aa7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在控制器中编写相应的函数。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="53cb" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">public function </em>getImage() {<br/>    $image = Image::<em class="oc">all</em>()[0];<br/>    <em class="oc">return </em>$image;<br/>}</span></pre><p id="48fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当你在浏览器中访问<strong class="kk iu"> /api/image </strong>时，你会看到一个json对象。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi pr"><img src="../Images/2a45ebd6383d00c7061463ba6abbc5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OUhK9hVgiLdQ6fmxqws21g.png"/></div></div></figure><h2 id="7315" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated">3.接收脚本标签中的路径</h2><p id="152e" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">打开<strong class="kk iu"> App.vue </strong>并添加一个getImagePath方法到mounted()</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="ef64" class="ms lf it mo b gy mt mu l mv mw">mounted() {<br/>    <em class="oc">this</em>.getBasicInfo();<br/>    <strong class="mo iu"><em class="oc">this</em>.getImagePath();</strong><br/>},</span></pre><p id="435b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">编写一个<strong class="kk iu"> getImagePath </strong>方法来获取<strong class="kk iu">路径</strong>。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="dee6" class="ms lf it mo b gy mt mu l mv mw"><strong class="mo iu">getImagePath</strong>() {<br/>    axios.get('/api/image')<br/>        .then(response =&gt; {<br/>            <strong class="mo iu"><em class="oc">this</em>.imagepath</strong> = response.data.<strong class="mo iu">path</strong>;<br/>        })<br/>        .catch(error =&gt; {<br/>            console.log(error);<br/>        });<br/>},</span></pre><p id="0ffd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更改数据()以显示<strong class="kk iu">图像路径</strong></p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="cf53" class="ms lf it mo b gy mt mu l mv mw">data() {<br/>  <em class="oc">return </em>{<br/>      name: '',<br/>      <strong class="mo iu">imagepath: '',</strong><br/>  }<br/>},</span></pre><p id="f508" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Vue Devtools扩展中查找，点击App，在右手边，你会找到imagepath。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi pq"><img src="../Images/370d5e281656d487db550e1f8c67fe3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9o3VfPWHBGJYAUD95G6PXA.png"/></div></div></figure><h2 id="1895" class="ms lf it bd lg mx my dn lk mz na dp lo kr nb nc lq kv nd ne ls kz nf ng lu nh bi translated">4.使用路径在模板标签中显示图像</h2><p id="accd" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">App.vue应该更改为使用<strong class="kk iu"> {{ }} </strong>括号显示图像路径</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="79a8" class="ms lf it mo b gy mt mu l mv mw">&lt;masthead <em class="oc">:name</em>="name"&gt;&lt;/masthead&gt;<br/><strong class="mo iu">{{imagepath}}</strong><br/>&lt;image-uploader&gt;&lt;/image-uploader&gt;</span></pre><p id="23cc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上<strong class="kk iu"> / </strong>路线，看名字下面。您会发现页面上显示的图像路径。哒哒！</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="ps pt l"/></div></figure><p id="d7b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要担心。第四步还没完成。我们还有一点工作要做。</p><p id="a1af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第一章中，我们想要显示数据。这一次，我们不想显示数据。我们想要将<strong class="kk iu"> imagepath </strong>数据绑定到图像标签的src属性。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="7098" class="ms lf it mo b gy mt mu l mv mw">&lt;img <strong class="mo iu">v-bind:</strong>src="<strong class="mo iu">imagepath</strong>"/&gt;</span></pre><p id="d593" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有一个更简短的版本:</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="ad21" class="ms lf it mo b gy mt mu l mv mw">&lt;img <strong class="mo iu">:</strong>src="<strong class="mo iu">imagepath</strong>"/&gt;</span></pre><p id="cb80" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这两种情况下，当您在浏览器中加载页面时，这将获取在data()中找到的<strong class="kk iu"> imagepath </strong>并将其插入img标签中。</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="ee13" class="ms lf it mo b gy mt mu l mv mw">&lt;div&gt;<br/>    &lt;masthead <em class="oc">:name</em>="name"&gt;&lt;/masthead&gt;<br/>    <strong class="mo iu">&lt;img <em class="oc">:src</em>="imagepath"/&gt;</strong><br/>    {{imagepath}}<br/>    &lt;image-uploader&gt;&lt;/image-uploader&gt;<br/>&lt;/div&gt;</span></pre><p id="097d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">您还不会在浏览器中看到该图像</strong>，但是当您查看inspect元素时，您会发现一个img标签，其src属性填充在imagepath中。</p><p id="c845" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你看不到图片的原因是通常网络资产(这些是，CSS文件，图片等。)是从公共文件夹提供的，但图像正在上载到存储文件夹。</p><p id="7d57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们不需要将存储位置更改为公共位置。我们可以只做一个<strong class="kk iu">符号链接。前往您的终端并键入:</strong></p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="9fd7" class="ms lf it mo b gy mt mu l mv mw">php artisan <strong class="mo iu">storage:link</strong><strong class="mo iu"> </strong></span></pre><p id="7464" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在如果你打开公共文件夹，你会发现一个标签为<strong class="kk iu">存储的文件夹图标。</strong>这是一个<strong class="kk iu">文件夹链接</strong>而不是文件夹本身。链接到<strong class="kk iu">存储/app/public。</strong></p><p id="5eb2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<strong class="kk iu">存储/应用/公共</strong>中的任何东西都将是公开可用的，就像它在<strong class="kk iu">公共/存储</strong>中一样。</p><p id="d8c0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要更改控制器，以便上传的文件存储在<strong class="kk iu">存储/app/public/userpics </strong>中</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="96ba" class="ms lf it mo b gy mt mu l mv mw"><em class="oc">return </em>request()-&gt;file('userpic')-&gt;store('<strong class="mo iu">/public/userpics</strong>');</span></pre><p id="58ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你现在上传，你会在<strong class="kk iu">存储/app/public/userpics </strong>以及<strong class="kk iu">公共/存储</strong>中看到一个文件。它没有被上传到两个不同的位置。之所以会这样，是因为有了<strong class="kk iu">的符号链接</strong>。</p><p id="9162" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以删除原来的userpics文件夹(<strong class="kk iu"> storage/app/userpics </strong>)</p><p id="08f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们转到Vue组件并相应地更改img标签</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="185e" class="ms lf it mo b gy mt mu l mv mw">&lt;div&gt;<br/>    &lt;masthead <em class="oc">:name</em>="name"&gt;&lt;/masthead&gt;<br/>    &lt;img <em class="oc">v-bind:src</em>="<strong class="mo iu">'storage/userpics/' + imagepath</strong>"/&gt;<br/>    {{imagepath}}<br/>    &lt;image-uploader&gt;&lt;/image-uploader&gt;<br/>&lt;/div&gt;</span><span id="fd87" class="ms lf it mo b gy pu mu l mv mw"><strong class="mo iu">Code Explanation<br/>'storage/userpics' - </strong>The symbolic location of our file in the public folder</span><span id="f3f1" class="ms lf it mo b gy pu mu l mv mw"><strong class="mo iu">+ - </strong>This is required by VueJS if you want to concantenate. If you remove the plus sign, you will get an error in the compilation and nothing will be shown on the page in the browser.</span><span id="eaab" class="ms lf it mo b gy pu mu l mv mw"><strong class="mo iu">imagepath - </strong>The imagepath data taken from data()</span></pre><p id="4315" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在数据库程序中运行此查询</p><pre class="lx ly lz ma gt mn mo mp mq aw mr bi"><span id="cffb" class="ms lf it mo b gy mt mu l mv mw">TRUNCATE TABLE image;</span></pre><p id="dc5b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它将清空图像表。现在再次上传一张图片，并检查页面以查看图片。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="pv pt l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi pw"><img src="../Images/ba6d0367b729d355578f51ebc4aa7b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNI4SRwp0N-71KzgMGCbnQ.png"/></div></div></figure></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><blockquote class="od oe of"><p id="3daf" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated"><strong class="kk iu">在第一章中，我们已经创建了显示数据库中文本的功能。</strong></p><p id="d256" class="ki kj oc kk b kl km ju kn ko kp jx kq og ks kt ku oh kw kx ky oi la lb lc ld im bi translated"><strong class="kk iu">在第二章中，我们已经创建了上传和显示图像的能力。</strong></p></blockquote><p id="3a3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第三章中，我们将把这两种能力结合起来。</p><div class="px py gp gr pz qa"><a rel="noopener  ugc nofollow" target="_blank" href="/laravel-and-vue-creating-a-portfolio-website-with-a-crud-admin-panel-chapter-3-566cf0ddc83a"><div class="qb ab fo"><div class="qc ab qd cl cj qe"><h2 class="bd iu gy z fp qf fr fs qg fu fw is bi translated">Laravel和Vue:用CRUD管理面板创建作品集网站——第3章</h2><div class="qh l"><h3 class="bd b gy z fp qf fr fs qg fu fw dk translated">创建并阅读报头</h3></div><div class="qi l"><p class="bd b dl z fp qf fr fs qg fu fw dk translated">itnext.io</p></div></div><div class="qj l"><div class="qk l ql qm qn qj qo mg qa"/></div></div></a></div></div></div>    
</body>
</html>
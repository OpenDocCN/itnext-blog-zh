<html>
<head>
<title>Building a Functional Note taking Application with ObjectBox and Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用ObjectBox和Kotlin构建一个实用的笔记应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/building-a-functional-note-taking-application-with-objectbox-and-kotlin-d6cc491f3965?source=collection_archive---------6-----------------------#2019-04-18">https://itnext.io/building-a-functional-note-taking-application-with-objectbox-and-kotlin-d6cc491f3965?source=collection_archive---------6-----------------------#2019-04-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/af17e315da9d3e6328288309e1910e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jDV0yESWpwZNLv5V"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="f301" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">几乎任何你想要构建的应用都需要存储和检索数据，这甚至适用于你想要构建的最简单的应用。在Android上，存储数据的传统方式是使用SQLite数据库。由于Android jetpack的到来，包括架构组件和房间库，SQLite操作已经变得更好了。几周前，我在研究一个名为ObjectBox的新数据库，正如他们网站上所描述的，ObjectBox是一个用于物联网和移动设备的超高速数据库。它有Java、Kotlin、Go、Swift和c的绑定，我亲自操作过，理解和入门都很简单。</p><h2 id="cdb6" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">员额的目的</h2><p id="0d93" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">这篇文章的目的是让你知道如何使用这个叫做ObjectBox的很酷的数据库，以及如何使用它来构建一个全功能的应用程序。虽然这是一个简单的笔记应用程序，但是从中可以学到很多东西。说得够多了，下面是我们将构建的由两个屏幕组成的应用程序。</p><div class="mc md me mf gt ab cb"><figure class="mg ju mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/417ed06bfc4857ef478ac61f8653c77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*yCebYLv20eB__25dIMbUvg.jpeg"/></div></figure><figure class="mg ju mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/a48ae12ceadea2400b4b08a22f260c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*8Exl1zUqElklzCr8d1AFQQ.jpeg"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk mm di mn mo translated">笔记应用程序的屏幕</figcaption></figure></div><p id="ae95" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个便笺由标题、描述、标题和日期组成，默认为当前时间。</p><p id="42d3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先创建一个Android Studio应用程序并启用Kotlin支持。在build.gradle文件的dependencies部分添加object box、recyclerview和cardview依赖项</p><pre class="mc md me mf gt mp mq mr ms aw mt bi"><span id="78f1" class="le lf it mq b gy mu mv l mw mx">implementation <strong class="mq iu">'com.android.support:recyclerview-v7:28.0.0'<br/></strong>implementation <strong class="mq iu">"io.objectbox:objectbox-kotlin:2.3.4"<br/></strong>implementation <strong class="mq iu">'com.android.support:cardview-v7:28.0.0'</strong></span></pre><p id="8aa6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在文件的顶部，按以下顺序应用kotlin-kapt和io.objectbox</p><pre class="mc md me mf gt mp mq mr ms aw mt bi"><span id="097a" class="le lf it mq b gy mu mv l mw mx">apply <strong class="mq iu">plugin</strong>: <strong class="mq iu">'kotlin-kapt'<br/></strong>apply <strong class="mq iu">plugin</strong>: <strong class="mq iu">'io.objectbox'</strong></span></pre><p id="fe1f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们首先创建我们的实体类，在本例中称为Note，它是一个Kotlin数据类</p><pre class="mc md me mf gt mp mq mr ms aw mt bi"><span id="2023" class="le lf it mq b gy mu mv l mw mx"><strong class="mq iu">import </strong>io.objectbox.annotation.Entity<br/><strong class="mq iu">import </strong>io.objectbox.annotation.Id<br/><strong class="mq iu">import </strong>java.util.*<br/><br/>@Entity<br/><strong class="mq iu">data class </strong>Note(<br/>    @Id <strong class="mq iu">var id</strong>:Long = 0,<br/>    <strong class="mq iu">var title</strong>:String?,<br/>    <strong class="mq iu">var longDescription</strong>:String?,<br/>    <strong class="mq iu">var updatedAt</strong>:Date = Calendar.getInstance().<em class="my">time<br/></em>)</span></pre><p id="4cea" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意@Id注释，它是一个长的。其他Id类型也是可能的，但现在让我们保持简单。</p><p id="0790" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，您必须在Android Studio中点击Build&gt;Make Project来生成必要的文件。将在app/object box-models/default . JSON中生成一个文件</p><p id="47d3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们准备好了。</p><p id="4bd9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的构建基于我们的实体生成了一个MyObjectBox类，并帮助我们为项目设置BoxSore</p><p id="bc02" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，创建一个名为ObjectBox的kotlin Singleton</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="6cef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Boxstore是数据库的接口，因此管理盒子。盒子持久化并查询实体。</p><p id="a441" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，创建一个app类并初始化ObjectBox，不要忘记将android: name值作为App添加到您的清单文件中。</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="33c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好，我们继续添加一个新的活动，名为AddNoteActivity。相关的布局文件将由标题和描述两个文本字段组成。在这种情况下，我们使用通常由TextInputLayout包围TextInputField组成的材质文本字段。TextInputLayout有助于浮动提示文本。下面是xml代码。</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">add_note_layoute.xml</figcaption></figure><p id="7521" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个概念是，当用户完成添加笔记标题和描述时，他们点击顶部的菜单图标(双勾)。</p><p id="a71e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Android studio中添加一个新的矢量资产，然后搜索done。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/9d8d7b910d0ffde6612cfda73452992a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N9F-h_XZ5IAbd5NF2SfU3Q.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">完成图标</figcaption></figure><p id="99f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了创建一个新的注释，我们在AddnoteActivity.kt onCreate方法中初始化一个Note类型的盒子。接下来，我们创建一个addNote方法，它使用我们的noteBox向数据库添加一个新的注释。</p><pre class="mc md me mf gt mp mq mr ms aw mt bi"><span id="192c" class="le lf it mq b gy mu mv l mw mx"><strong class="mq iu">private lateinit var notesBox</strong>:Box&lt;Note&gt;<br/><strong class="mq iu">override fun </strong>onCreate(savedInstanceState: Bundle?) {<br/>    <strong class="mq iu">super</strong>.onCreate(savedInstanceState)<br/>    setContentView(R.layout.<em class="my">add_notes_layout</em>)<br/>    <strong class="mq iu">notesBox </strong>= ObjectBox.<strong class="mq iu">boxStore</strong>.boxFor(Note::<strong class="mq iu">class</strong>.<em class="my">java</em>)<br/>}</span></pre><p id="0321" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">addNote方法从title和description文本字段中获取文本，创建一个新的注释，并使用notesBox对象保存到db中。</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e606" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，box的put方法向数据库添加了一个新的注释。</p><p id="12c7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你的AddNoteActivity.kt最后应该是这样的。</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="5199" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">显示列表</h2><p id="a85f" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">我假设您应该能够创建一个recycle view适配器，并且能够在recycle view中显示项目。你可以查看我以前的帖子，点击监听器，它会告诉你如何使用一个recycle view。也就是说，我们的主活动有一个recyclerview来显示我们的笔记列表。</p><p id="69c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建一个在onCreate和onResume中调用的方法update notes，该方法从object box中检索所有注释，并在recyclerview中显示它们。</p><p id="a672" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但首先，这是我们的note_list_item.xml</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8452" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">列表项是一个Material CardView，包含一个相对布局，有三个TextViews，分别用于标题、描述和日期。</p><p id="345d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">和我们之前做的一样，我们在MainActivity中创建一个note类型的框，检索所有的notes并添加到我们的适配器中。</p><pre class="mc md me mf gt mp mq mr ms aw mt bi"><span id="ba56" class="le lf it mq b gy mu mv l mw mx"><strong class="mq iu">private lateinit var notesBox</strong>:Box&lt;Note&gt;<br/><strong class="mq iu">override fun </strong>onCreate(savedInstanceState: Bundle?) {<br/>    <strong class="mq iu">super</strong>.onCreate(savedInstanceState)<br/>    setContentView(R.layout.<em class="my">add_notes_layout</em>)<br/>    <strong class="mq iu">notesBox </strong>= ObjectBox.<strong class="mq iu">boxStore</strong>.boxFor(Note::<strong class="mq iu">class</strong>.<em class="my">java</em>)<br/>    updateNotes()</span><span id="65fc" class="le lf it mq b gy nc mv l mw mx"><strong class="mq iu">private fun </strong>updateNotes() {<br/>    <strong class="mq iu">val </strong>notes = <strong class="mq iu">notesBox</strong>.<em class="my">all<br/>    </em><strong class="mq iu">noteListAdapter</strong>?.updateItems(notes)<br/> <br/><br/>}</span></pre><p id="5d56" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就这样，我们完成了这里，我们有一个笔记应用程序。</p><h2 id="d406" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">摘要</h2><p id="3973" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">创建新项目，</p><pre class="mc md me mf gt mp mq mr ms aw mt bi"><span id="407b" class="le lf it mq b gy mu mv l mw mx">1. Create a box,<br/>2. Call box put method passing your model class</span></pre><p id="bd39" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">若要从数据库中检索所有对象，请调用box all方法</p><p id="67d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，这并不是您使用object box所能做的全部，因为它为您提供了像任何数据库一样的高级查询和表关系的机会。你可以查看他们的网站，你会了解更多。感谢您的阅读和快乐编码。</p></div></div>    
</body>
</html>
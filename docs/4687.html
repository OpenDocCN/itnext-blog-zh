<html>
<head>
<title>Firestore backend for Flutter. In-browser CodeLab. Part 2. Web App.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">firestore Flutter后端。浏览器内代码实验室。第二部分。Web应用程序。</h1>
<blockquote>原文：<a href="https://itnext.io/firestore-backend-for-flutter-in-browser-codelab-part-2-web-app-8f1ceb2c4e44?source=collection_archive---------5-----------------------#2020-08-23">https://itnext.io/firestore-backend-for-flutter-in-browser-codelab-part-2-web-app-8f1ceb2c4e44?source=collection_archive---------5-----------------------#2020-08-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f32c130c811caaca5bb1a0efa46dfd72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZ_HEHl2Mbp9UrhaEoTQxw.png"/></div></div></figure><h1 id="95c1" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">欢迎回来！</h1><p id="c0f1" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在之前的<a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/firestore-backend-for-flutter-in-browser-code-lab-part-1-1b94d7839b94">部分</a>中，我们看到了如何将Flutter Android App连接到Firestore。</p><p id="6753" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">开发了一个非常简单的应用程序来证明连接，并向Firebase后端发出一些简单的请求。</p><p id="2842" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在这一部分中，我们将考虑一个更高级的业务应用程序，以及对Firestore更现实的请求。</p><p id="792c" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">此外，我们将为另一个平台开发:Flutter <strong class="ky ir"> Web </strong> App。</p><p id="628c" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">与上一部分相同的是我们选择的IDE——<a class="ae lu" href="https://flutlab.io" rel="noopener ugc nofollow" target="_blank">flutlab . io</a>，免费订阅的在线Flutter IDE。</p><p id="0b46" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">我会试着把这篇文章作为一篇独立的文章来写。你不一定要先阅读第一部分。我将展示完整的场景，但是对Firebase配置做了一些简化。</p><h1 id="10ce" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">业务逻辑</h1><p id="20ea" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们将开发一个<a class="ae lu" href="https://en.wikipedia.org/wiki/Planning_poker" rel="noopener ugc nofollow" target="_blank"> Scrum Poker </a> Web应用程序。</p><p id="7435" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">Scrum Poker是一个非常重要的敏捷实践，所有团队成员都参与到开发任务的评估中。任务以故事点的形式进行评估，以类似斐波那契的格式指出工作的相对努力:1，2，3，5，8，13 …</p><p id="0168" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在评估会议期间，团队成员做出他们的评估。每个团队成员都不能有偏见，这一点很重要。因为如果我们得出非常不同的估计，那么很可能团队不理解这个任务或者它被描述得很糟糕。</p><p id="1e32" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这就是为什么有一个领导团队成员，他结束评估会议，所有团队成员的所有评估都变得可见。</p><p id="0be9" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在这里，我们将关注支持Scrum Poker的应用程序的最简单的实现。它应该呈现非常简单的用户界面，但是具有完全实现的业务逻辑。</p><h1 id="01a3" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">开始吧！</h1><p id="463d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这个CodeLab的唯一先决条件是在<a class="ae lu" href="https://flutlab.io." rel="noopener ugc nofollow" target="_blank"> https://flutlab.io </a>注册一个用户账号(免费)。</p><p id="78d1" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">打开您的仪表板。在这里你可以看到你目前的颤振项目。现在我们需要添加一个新项目。这个项目不是从头开始，而是从FlutLab的WidgetBay上已经实现的开源Scrum Poker派生出来的。单击左侧面板上的蓝色大按钮即可进入该页面:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/08b5d5830966cc2c14ddab30b58de5ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPx8zptilz0s6uPt4IL5yQ.png"/></div></div></figure><p id="b499" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在WidgetBay中，找到名为Scrum Poker的项目并单击它:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/19669832a4a9a72490d6f1ae3b40d0ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwHBd5uKgektdLoh-TGMEA.png"/></div></div></figure><p id="1132" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在这里你可以阅读一些关于项目的信息，预览它作为一个弹出的网络应用程序，或者，在我们的例子中，<strong class="ky ir"> <em class="mg">把它</em> </strong>放到你的项目空间中。单击另一个蓝色大按钮:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/a65706dbe6eb53713aa49e5677f8f89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6YLaVfeQoyvT9INm5Tv-zg.png"/></div></div></figure><p id="fb5c" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">因此，该项目将出现在您的仪表板中。单击以在FlutLab的代码编辑器中打开它。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/0a7516a8ead100233822fe6513c46fed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3Zk9jZmND0X9tj9rCtNHQ.png"/></div></div></figure><p id="9b83" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这个项目只是部分功能，因为它与Firestore没有真正的联系。这是有意为之，以便其他程序员可以将这个应用程序添加到他们自己的后端。我们开始吧。</p><p id="e8bb" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">转到Firebase控制台，创建一个新项目。你可以把它命名为“我的Scrum Poker”或者任何你想命名的名字:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/8c69fd26d6c06a87e6b9076499ad721f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qo2Yl0PTGqaSB-jZ6zPOtQ.png"/></div></div></figure><p id="aa6b" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">执行剩余的步骤(在第1部分中有详细描述)并创建项目:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/88481e0d140ef8b067fac2a13ba82b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7blarZ91dGkS4rjILklIQ.png"/></div></div></figure><p id="aed4" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在，我们要将Web App连接到Firebase，请单击此处的相应按钮:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/524dc2d0d1155e9d43c241795a554229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPih3HFlCBiN4xWEZzm6KA.png"/></div></div></figure><p id="7233" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">提供应用程序的昵称:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/4deb8b19c97b0e4b8fcd4bb3338d1855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2PbR1CjLF5CSues8JxiaTg.png"/></div></div></figure><p id="4981" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">并接收将您的应用程序连接到Firebase的配置片段:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/ade1be255def73f4b8ce3cdf38d3e89b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TfOtr3hbNcN5n9cNCM1X1g.png"/></div></div></figure><p id="0a99" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在我们要做一件简单的事情:从这个页面复制最后一个<em class="mg"> &lt;脚本&gt;…&lt;/脚本&gt; </em>片段，包含:</p><pre class="mb mc md me gt mn mo mp mq aw mr bi"><span id="4360" class="ms jz iq mo b gy mt mu l mv mw">&lt;script&gt;</span><span id="61df" class="ms jz iq mo b gy mx mu l mv mw">    // Your web app's Firebase configuration</span><span id="fed1" class="ms jz iq mo b gy mx mu l mv mw">    var firebaseConfig = {<br/>        ...<br/>    };</span><span id="bf92" class="ms jz iq mo b gy mx mu l mv mw">    ...</span><span id="8c23" class="ms jz iq mo b gy mx mu l mv mw">    firebase.analytics();</span><span id="3e42" class="ms jz iq mo b gy mx mu l mv mw">&lt;/script&gt;</span></pre><p id="de5b" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在，回到你的FlutLab项目，导航到它的<strong class="ky ir"> web </strong>文件夹，打开【index.html】的<strong class="ky ir"/>。你会发现类似的<em class="mg"> &lt;脚本&gt;…&lt;/脚本&gt; </em>片段填充了虚拟数据:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/0588a49342059df6f18b6adaf0e892d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1moSzHL5W0CQuJWh4UeJBg.png"/></div></div></figure><p id="2329" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">用之前复制的真实配置数据替换它！</p><p id="9253" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在下一步。让我们配置我们的云Firestore数据库。只需点击左侧菜单中的<strong class="ky ir">数据库</strong>项目。然后点击<strong class="ky ir">创建数据库</strong>按钮:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/2cc2d643bd4890ad5392bff1956634d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qx446vrlBGL3BAlfDzTllQ.png"/></div></div></figure><p id="ffea" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">您现在可以推迟安全配置，所以在下一个屏幕上选择“<strong class="ky ir">在测试模式下启动</strong>”选项:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/e1a6b2190db176ff6dc9c9d5214c00c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTKNDIv16EWlaeAHRqnkAg.png"/></div></div></figure><p id="84ec" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">创建数据库后，您可以选择创建新集合:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/15712e641cd76c9c423013544874898e.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*506KyNZuOgFy-ZD2nvioCA.png"/></div></figure><p id="930f" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">让我们将这个集合命名为“votes ”,并创建包含以下字段的第一个文档，这是非常自描述的:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/431203d5818daf4fa5194a4cc5152f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qM2ZKTBXXcXFUK4jSOX4sQ.png"/></div></div></figure><p id="e497" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">恭喜您，您刚刚完成了应用后端的配置！</p><p id="7524" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在FlutLab代码编辑器中返回到您的项目。为项目构建选择合适的平台。点击左侧菜单中的<strong class="ky ir">设置</strong>图标:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f48c4abf51f605472154cd163188c957.png" data-original-src="https://miro.medium.com/v2/resize:fit:96/format:webp/1*Exegl1o1ePQnVHbRsSHE1Q.png"/></div></figure><p id="2726" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">再次检查构建器目标是否设置为<strong class="ky ir">网</strong>并且<strong class="ky ir">预览</strong>是否打开<strong class="ky ir">:</strong></p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/52ceb09e505611b654fd837ae5f1bca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XM83xFKu7Ynbz8GuCbDQug.png"/></div></div></figure><p id="3239" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在是时候<strong class="ky ir">建</strong>这个项目了！点击顶部菜单:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/91b09162c56ec2ba85d930987b768a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/format:webp/1*Oe_vsF3vOlbIje0c2SZvcA.png"/></div></figure><p id="a84e" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">您将看到一分钟的构建动画:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/d3927ef86089c76375f071e0c649716b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DVUfr4jEfUMxCS57K6i_dQ.png"/></div></div></figure><p id="875e" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">最后，您的web应用程序将出现在弹出窗口中:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/050f29812031e2b6c2aecdf9d9565560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vd8GoB3EJwaxQplXEkNVSg.png"/></div></div></figure><p id="f30d" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">让我们试试这个应用程序是如何工作的！输入您的<strong class="ky ir">姓名</strong>并点击“<strong class="ky ir">会议主持人</strong>”复选框。然后点击<strong class="ky ir">加入会话</strong>按钮:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b3335d9da46c4eb6daca4148e6ec5cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*s1LfTAkgkUeIh3t2tNHgSg.png"/></div></figure><p id="3665" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在你可以投票了！但是等一下，让我们添加几个你的“团队成员”。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/222b4c97885c4cb0176ecb3af173f6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*46tc116nM29KOEZQ8mXanA.png"/></div></figure><p id="de6c" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">点击预览窗口左侧的<strong class="ky ir">获取链接</strong>图标:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5a9d458ba6f68d43e1d029e6d60c5ac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:76/format:webp/1*oYrdNwgEGLKpCsm8N5j9nQ.png"/></div></figure><p id="58f5" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">新标签将在您的浏览器中打开。以“john”的身份加入投票环节:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/368cfbd735cae8bd10364b1cb9a7cecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQ4qNQYm9IOFqjhb51rJLQ.png"/></div></div></figure><p id="1203" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">你可以再次分享这个链接，并以“bob”的身份加入。现在让我们模拟投票环节。以john和bob的身份在他们的浏览器选项卡中投票:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/ddcbf6976973723ebe00655fd9be0d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSKQuAn9R08riGqfaKIjJA.png"/></div></div></figure><p id="ddcc" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">如您所见，团队成员看不到他们的投票。直到会议主持人“亚历克斯”投票:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/69807c33dba439e58bf8d2d006b6d8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*RXZmLtvUxlM-zI0heOHi0w.png"/></div></figure><p id="95c4" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在此之后，您可以在每个浏览器选项卡中看到投票会话的结果:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/a65f9e28c9916ca8b0ee68cb46cac281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qHFBUxzUyP72kRy-w8TVUQ.png"/></div></div></figure><p id="b52e" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">所以我们可以证明应用程序的工作能力！</p><h1 id="4f6a" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">它是如何工作的</h1><p id="b87e" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">让我们看看引擎盖下面。</p><p id="3ab5" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">让我们从最开始的单个<strong class="ky ir"> <em class="mg"> main.dart </em> </strong>模块开始:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/f9bc9b8cd17fb5e53093bd6fb7b29bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NatVL-OyFVefGqXjIGkCWw.png"/></div></div></figure><p id="d8f0" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在这个模块的顶部，我们可以看到包含了<strong class="ky ir"> cloud_firestore.dart </strong>库。</p><p id="8632" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">同样，全局变量<strong class="ky ir"> fsi </strong>被创建并指向<strong class="ky ir"> Firestore.instance </strong>。这个变量将被用作执行对Firestore后端的各种请求的网关。</p><p id="d060" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">下面你可以找到非常简单的代码结构。在根级别，我们有<strong class="ky ir"> MyApp </strong> StatelessWidget，它在其<strong class="ky ir"> build </strong>方法中呈现<strong class="ky ir"> MaterialApp </strong>。反过来，它在<strong class="ky ir"> home </strong>部分有<strong class="ky ir">my home page</strong>——我们的两页应用程序的第一页。</p><p id="0703" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">我们可以跳过下一行非常标准的代码，直到下一个片段:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/22da11972a35b19dbc43e42b443a249c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ncCY7DccNHh9lMxppgpfxQ.png"/></div></div></figure><p id="79ea" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">其中，在提供了团队成员<strong class="ky ir">姓名</strong>和可选复选框后，我们可以看到绑定到“<strong class="ky ir">加入会话</strong>”按钮的方法<strong class="ky ir"> goAhead </strong>()。</p><p id="1a53" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这个方法很重要。让我们看看它的代码:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/a768f80e9d231165def8a1baea637d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZD14aA53uVNcxT9JK9-Fw.png"/></div></div></figure><p id="5914" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">它填充要存储到Firebase中的<strong class="ky ir"> userData </strong>对象。它从textEditingController和_checkboxValue获取其字段。“估计”字段被设置为等于-1的“未投票”状态。</p><p id="ae68" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">对Firestore的第一个请求假装已经在“投票”集合中创建了具有给定团队成员名称的对象:</p><pre class="mb mc md me gt mn mo mp mq aw mr bi"><span id="1fa6" class="ms jz iq mo b gy mt mu l mv mw">fsi.collection('votes').document(textEditingController.text).updateData(userData)</span></pre><p id="967d" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">有两种可能的情况:</p><ul class=""><li id="3d49" class="no np iq ky b kz lv ld lw lh nq ll nr lp ns lt nt nu nv nw bi translated">这样的一个文档确实被找到了，修改后我们去<strong class="ky ir"> navigate() </strong>方法调用。</li><li id="53f7" class="no np iq ky b kz nx ld ny lh nz ll oa lp ob lt nt nu nv nw bi translated">找不到文档，出现异常。所以我们试图发出另一个请求，用给定的名称创建一个新的<strong class="ky ir">文档:</strong></li></ul><pre class="mb mc md me gt mn mo mp mq aw mr bi"><span id="85b8" class="ms jz iq mo b gy mt mu l mv mw">fsi.collection('votes').document(textEditingController.text).setData(userData)</span></pre><p id="c099" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">如果成功，我们转到<strong class="ky ir"> navigate() </strong>方法调用。或者我们会显示Firestore连接失败的警告对话框。</p><p id="e390" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated"><strong class="ky ir"> navigate() </strong>方法导致切换到我们app的第二页:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/7c90a42453bb68411c37ab51a6ac3294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cXFmHdiHLYfZvJOoLMJY4Q.png"/></div></div></figure><p id="51a5" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">它还有一个基于StatefulWidget和Scaffold的非常标准的结构。</p><p id="ccf6" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">脚手架的主体是这样的:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/c2b680abb6f61d644d6e1b5ceacf9ba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XL8rXxtZotnSVIGBYWpQMQ.png"/></div></div></figure><p id="3689" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">它是一个<strong class="ky ir"> StreamBuilder </strong>小部件，连接到Firestore的“<strong class="ky ir"> votes </strong>”集合！</p><p id="0eef" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">它的主要工作是填充<strong class="ky ir"> _items </strong>集合，并将其提供给下游的ListView.builder()方法。</p><p id="115a" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这是来自Firestore的“阅读”部分。为了理解“编写”部分的概念，当投票被存储时，请看下一个代码片段:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/c16efaf3cceded04f977ef9d16a7fd2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wZSLhkOJcQSPtpW8IpfJgg.png"/></div></div></figure><p id="2d8f" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这就是Scrum Poker应用程序的主要逻辑！</p><p id="fe1a" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在你应该明白所有的部分是如何连接在一起的了。</p><p id="d627" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">你可以随意将这个应用扩展到许多有趣的方向:</p><ul class=""><li id="4c8e" class="no np iq ky b kz lv ld lw lh nq ll nr lp ns lt nt nu nv nw bi translated">创建永久团队，将他们的投票历史作为单独的集合</li><li id="88d4" class="no np iq ky b kz nx ld ny lh nz ll oa lp ob lt nt nu nv nw bi translated">用一些好的图形设计来扩展用户界面</li><li id="9442" class="no np iq ky b kz nx ld ny lh nz ll oa lp ob lt nt nu nv nw bi translated">你自己的想法</li></ul><h1 id="3879" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">请继续收听</h1><p id="ab06" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">让我们保持联系。关于Flutter/Firebase的一些非常有趣的部分将很快以在线代码实验室的形式发布！</p></div></div>    
</body>
</html>
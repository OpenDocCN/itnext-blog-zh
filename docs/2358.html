<html>
<head>
<title>Express server for an Angular application part 3: redirect routes to an external service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular应用程序的Express server第3部分:将路由重定向到外部服务</h1>
<blockquote>原文：<a href="https://itnext.io/express-server-for-an-angular-application-part-3-redirect-routes-to-an-external-service-d4658ed575cb?source=collection_archive---------3-----------------------#2019-05-10">https://itnext.io/express-server-for-an-angular-application-part-3-redirect-routes-to-an-external-service-d4658ed575cb?source=collection_archive---------3-----------------------#2019-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="98e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Express.js是为构建web应用程序而设计的Node.js的web应用程序框架，在这一系列文章中，我将一步一步地解释我是如何实现一个具有一些高级功能的Express服务器的，我将这些功能用于我用Angular 7制作的单页面应用程序。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/47a52539feb1d29dc5a9e3865f9905e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scvf8DNO9d8KWyYg24QFhg.png"/></div></div></figure><p id="a55e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将讨论我在不同文章中解决的7个主要问题:</p><ol class=""><li id="e1b7" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-1-getting-started-2cd27de691bd?fbclid=IwAR0FqPoqKeBps4QUM3E09aSGKDwjUNKcoZHxPKAB5iBt8dwUbuEol3b7IZ8" rel="noopener">入门</a></li><li id="bf53" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-2-serve-files-from-a-bucket-ae14d23e7cde" rel="noopener">从桶里取文件</a></li><li id="9f67" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-3-redirect-routes-to-an-external-service-d4658ed575cb" rel="noopener">将一些呼叫重定向到外部服务</a></li><li id="7546" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-4-redirect-http-to-https-requests-d4f6e7ed7e93" rel="noopener">将http重定向到https请求</a></li><li id="7343" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-5-redirect-non-www-to-www-requests-b81a7794a4d7" rel="noopener">将非www请求重定向到www请求</a></li><li id="8736" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-5-limit-connections-and-prevent-ddos-e27902cc702b" rel="noopener">限制连接并阻止DDoS </a></li><li id="f65a" class="kx ky iq jp b jq lh ju li jy lj kc lk kg ll kk lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@marcozuccaroli/express-server-for-an-angular-application-part-7-add-cache-f11e8060a2e3" rel="noopener">处理一些缓存</a></li></ol><p id="f864" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第三篇文章中，我将讨论如何处理一些特殊的路由，并将它们重定向到外部服务。</p><h1 id="1666" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">参考知识库</h1><p id="9595" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">该项目的一个工作示例可从以下网址获得:</p><p id="e300" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lg" href="https://github.com/mzuccaroli/express_server_for_angular_example" rel="noopener ugc nofollow" target="_blank">https://github . com/mzuccaroli/express _ server _ for _ angular _ example</a>主分支包含最终的完整项目，但每篇文章都有一个专门的分支，这一分支的参考是:</p><p id="f033" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lg" href="https://github.com/mzuccaroli/express_server_for_angular_example/tree/feature/redirect_special_urls" rel="noopener ugc nofollow" target="_blank">https://github . com/mzuccaroli/express _ server _ for _ angular _ example/tree/feature/redirect _ special _ URLs</a></p><h1 id="f0d8" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">这个例子</h1><p id="a1da" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">一个经典的例子，也是我在我的服务器上添加这个特性的原因，是<strong class="jp ir"> sitemap.xml文件</strong>。如果你的前端应用程序管理一些<strong class="jp ir"> CMS特性</strong>并从API中检索内容，假设站点地图是由后端生成是完全合理的。这个问题有很多解决方案，比如由Angular解析的专用api，但是最轻量级的解决方案是<strong class="jp ir">将对站点地图的请求代理到你的后端</strong>。</p><p id="6123" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们假设您的后端服务器在一个已知的路径上提供了站点地图，并将这个变量添加到您的代码中:</p><blockquote class="mp mq mr"><p id="546c" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">const _ API address = ' https://testapi/API/example/sitemap '；</p></blockquote><p id="6c4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要对代码稍加改进，您就可以服务于这个文件。</p><h1 id="982b" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">代理外部路由</h1><p id="124c" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">在声明“app”变量后，添加:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="f076" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个简单的代码片段<strong class="jp ir">处理对xml文件</strong>的所有请求，并通过管道传递外部调用的结果来服务它们。</p><p id="85d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个<strong class="jp ir">简单的实现</strong>，但是你可以为更复杂的行为改变你的正则表达式或者后端调用。</p><h1 id="c5c3" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">测试一下</h1><p id="517e" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">使用运行您的应用程序</p><blockquote class="mp mq mr"><p id="a8b1" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">$node server.js</p></blockquote><p id="47b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并转到<a class="ae lg" href="http://localhost:4100" rel="noopener ugc nofollow" target="_blank">http://localhost:4100</a>/sitemap . XML和express将服务外部服务的结果<a class="ae lg" href="https://testapi/api/example/sitemap." rel="noopener ugc nofollow" target="_blank">https://testapi/API/example/sitemap。</a></p><p id="7412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇文章中，我将讨论http和https请求以及如何管理它们。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Creating Forms Inside Modals with ng-bootstrap</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用ng-bootstrap在模态内部创建表单</h1>
<blockquote>原文：<a href="https://itnext.io/creating-forms-inside-modals-with-ng-bootstrap-221e4f1f5648?source=collection_archive---------0-----------------------#2018-03-22">https://itnext.io/creating-forms-inside-modals-with-ng-bootstrap-221e4f1f5648?source=collection_archive---------0-----------------------#2018-03-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ccd31e49a30e927e471e9181c3a148c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*9kP1dxKPMiz2Otb5zu7RRg.jpeg"/></div></figure><p id="ef3b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在模态内部创建表单有很多好处。将它们与有价值的内容一起使用可能会给你的项目带来很多吸引力。随着ngx-和ng-bootstrap的出现，我们可以轻松地将任何bootstrap组件集成到我们的应用程序中。</p><p id="2edf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">本文涵盖以下主题:</p><ul class=""><li id="7169" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">创建角度项目</li><li id="fa62" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">添加ng-bootstrap并创建一个简单的模式</li><li id="a2ba" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">将表单添加到我们的模态中</li><li id="7737" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">摘要</li></ul><p id="a538" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，让我们开始吧！</p><h2 id="e64d" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kj ls lt lu kn lv lw lx ly bi translated">创建项目</h2><p id="8771" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">启动新项目的最佳方式是使用Angular CLI。CLI负责初始应用程序的代码搭建、构建我们的应用程序、创建组件等等。要访问Angular CLI toolkit，您首先需要安装它。</p><p id="4c2f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用以下命令:</p><p id="c6cc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe me mf mg mh b">npm install @angular/cli -g</code></p><p id="2169" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后使用以下内容初始化新的角度项目:</p><p id="e7de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe me mf mg mh b">ng new ngModalForm</code></p><p id="96c4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦完成，访问目录并运行<code class="fe me mf mg mh b">ng serve</code>。这将在<code class="fe me mf mg mh b">localhost:4200</code>为我们的应用服务。当在URL中粘贴并输入这段代码时，您应该会看到一个基本页面。</p><h2 id="07c4" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kj ls lt lu kn lv lw lx ly bi translated">添加ng引导</h2><p id="334e" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">正如我前面提到的，我们将在项目中使用ng-bootstrap库。ng自举依赖于角度和自举。既然我们已经有了Angular sat up，我们只需要Bootstrap。</p><p id="8e17" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行以下命令:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b64b" class="lg lh iq mh b gy mq mr l ms mt">npm i bootstrap</span></pre><p id="0a60" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将安装软件包，但我们仍然需要设置它。在您的<code class="fe me mf mg mh b">angular-cli.json</code>文件中，在样式数组中添加以下几行:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7fdc" class="lg lh iq mh b gy mq mr l ms mt">"styles": [<br/>"styles.css",<br/>  "../node_modules/bootstrap/dist/css/bootstrap.min.css"<br/>],...</span></pre><p id="ebc1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mu">注意！我遇到了我使用的引导版本(4 . 0 . 0-beta 3)的问题。你需要降级到beta 2才能让它工作。只需更新</em> <code class="fe me mf mg mh b"><em class="mu">package.json</em></code> <em class="mu">内的依赖关系，运行</em> <code class="fe me mf mg mh b"><em class="mu">npm i</em></code> <em class="mu">。</em></p><p id="b60c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后使用以下命令安装ng-bootstrap:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6149" class="lg lh iq mh b gy mq mr l ms mt">npm i --save @ng-bootstrap/ng-bootstrap</span></pre><p id="bab7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装后，在app.module中导入模块:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="976a" class="lg lh iq mh b gy mq mr l ms mt">import { NgbModule } from '@ng-bootstrap/ng-bootstrap';<br/><br/>@NgModule({<br/>  declarations: [AppComponent, ...],<br/>  imports: [<br/>    NgbModule.forRoot(),<br/>    ...<br/>  ],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule {<br/>}</span></pre><p id="a5a6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这允许我们简单地将<code class="fe me mf mg mh b">NgbModule</code>导入到其他想要使用该库工具包的组件中。</p><h2 id="8d8a" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kj ls lt lu kn lv lw lx ly bi translated">添加模态</h2><p id="2636" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">让我们首先创建一个包含一些简单内容的模型。</p><p id="7930" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为组件创建一个新组件:<code class="fe me mf mg mh b">ng g c FormModal</code>。这将创建新组件，并将其添加到模块声明中。但是我们也需要将它添加到<code class="fe me mf mg mh b">entryComponents</code>声明中。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="21ad" class="lg lh iq mh b gy mq mr l ms mt">...<br/>bootstrap: [AppComponent],<br/>entryComponents: [<br/>  FormModalComponent<br/>]<br/>...</span></pre><p id="13dd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们需要做的下一件事是在我们刚刚创建的<code class="fe me mf mg mh b">FormModalComponent</code>中为<code class="fe me mf mg mh b">NgbActiveModal</code>注册一个服务提供者。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="067a" class="lg lh iq mh b gy mq mr l ms mt">import { N<!-- -->gbActiveModal<!-- --> } from '@ng-bootstrap/ng-bootstrap';</span></pre><p id="39ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们还需要在构造函数中创建对服务的引用:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6b71" class="lg lh iq mh b gy mq mr l ms mt">constructor(<br/>  public activeModal: NgbActiveModal<br/>) { }</span></pre><p id="d9ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和一个用于关闭模态的方法，并将一些数据传递回触发器方法。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ff07" class="lg lh iq mh b gy mq mr l ms mt">closeModal() {<br/>  this.activeModal.close('Modal Closed');<br/>}</span></pre><p id="a519" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们需要对组件做的最后一件事是在<code class="fe me mf mg mh b">form-modal.component.html</code>中添加内容。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d79d" class="lg lh iq mh b gy mq mr l ms mt">&lt;div class="modal-header"&gt;<br/>  &lt;h4 class="modal-title"&gt;Modal Title&lt;/h4&gt;<br/>  &lt;button type="button" class="close" aria-label="Close"<br/>   (click)="activeModal.dismiss('Cross click')"&gt;<br/>  &lt;/button&gt;<br/>&lt;/div&gt;<br/>&lt;div class="modal-body"&gt;<br/>  &lt;p&gt;My modal content&lt;/p&gt;<br/>&lt;/div&gt;<br/>&lt;div class="modal-footer"&gt;<br/>  &lt;button (click)="activeModal.dismiss('Close clicked')"&gt;<br/>    Close Clicked<br/>  &lt;/button&gt;<br/>&lt;/div&gt;</span></pre><p id="32cb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">那么，模态组件已经设置好了，但是我们如何初始化它呢？我们将通过<code class="fe me mf mg mh b">app.component.ts</code>文件来实现这一点。</p><p id="57bc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从导入<code class="fe me mf mg mh b">NgbModal</code>和<code class="fe me mf mg mh b">FormModalComponent</code>开始。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3c80" class="lg lh iq mh b gy mq mr l ms mt">import { NgbModal } from '@ng-bootstrap/ng-bootstrap';<br/>import { FormModalComponent } from './form-modal/form-modal.component';</span></pre><p id="941c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在构造函数中创建引用:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c355" class="lg lh iq mh b gy mq mr l ms mt">constructor(<br/>  private modalService: NgbModal<br/>) { }</span></pre><p id="722e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和一种用于初始化模型的方法。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4bf6" class="lg lh iq mh b gy mq mr l ms mt">openFormModal() {<br/>  const modalRef = this.modalService.open(FormModalComponent);<br/>  <br/>  modalRef.result.then((result) =&gt; {<br/>    console.log(result);<br/>  }).catch((error) =&gt; {<br/>    console.log(error);<br/>  });<br/>}</span></pre><p id="7820" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，添加一个附带click事件的按钮。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b0df" class="lg lh iq mh b gy mq mr l ms mt">&lt;button (click)="openFormModal()"&gt;Open Modal&lt;/button&gt;</span></pre><p id="43e9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">瞧啊！点击“打开模式”按钮将启动模式。</p><h2 id="761a" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kj ls lt lu kn lv lw lx ly bi translated">添加表单</h2><p id="6450" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">当在我们的模态中实现表单时，我们想要实现几件事情。</p><ul class=""><li id="9a59" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">向表单传递一个id(以防您想要检索一些可编辑的信息)。</li><li id="f952" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">将结果传递回触发模式的组件。</li></ul><p id="7a02" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从在<code class="fe me mf mg mh b">app.module</code>中添加这些声明开始。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1c91" class="lg lh iq mh b gy mq mr l ms mt">import { FormsModule, ReactiveFormsModule } from '@angular/forms';</span><span id="9d59" class="lg lh iq mh b gy mv mr l ms mt">...<br/>imports: [<br/>  BrowserModule,<br/>  NgbModule.forRoot(),<br/>  FormsModule,<br/>  ReactiveFormsModule<br/>],<br/>...</span></pre><p id="5b5a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可能希望向模态组件传递一个id。这是通过在<code class="fe me mf mg mh b">openFormModal</code>方法中添加下面一行来实现的。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d48a" class="lg lh iq mh b gy mq mr l ms mt">openFormModal() {<br/>  const modalRef = this.modalService.open(FormModalComponent);<br/>  modalRef.componentInstance.id = 10; // should be the id<br/>  <br/>  modalRef.result.then((result) =&gt; {<br/>    console.log(result);<br/>  }).catch((error) =&gt; {<br/>    console.log(error);<br/>  });<br/>}</span></pre><p id="ad3d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用<code class="fe me mf mg mh b">Input</code>捆绑，在<code class="fe me mf mg mh b">FormModalComponent</code>中取回。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8053" class="lg lh iq mh b gy mq mr l ms mt">import { Component, OnInit, Input } from '@angular/core';<br/>...<br/>@Input id: number;</span></pre><p id="873b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，您可以访问模态内部的id。</p><p id="b381" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以我们来添加表单。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c602" class="lg lh iq mh b gy mq mr l ms mt">&lt;div class="modal-header"&gt;<br/>  &lt;h4 class="modal-title"&gt;My Form&lt;/h4&gt;<br/>  &lt;button type="button" class="close" aria-label="Close"<br/>   (click)="activeModal.dismiss('Cross click')"&gt;<br/>  &lt;/button&gt;<br/>&lt;/div&gt;<br/>&lt;form [formGroup]="myForm" (ngSubmit)="submitForm()"&gt;<br/>  &lt;div class="modal-boy"&gt;<br/>    &lt;div class="container"&gt;<br/>      &lt;div class="form-group"&gt;<br/>        &lt;label for="username"&gt;Username&lt;/label&gt;<br/>        &lt;input type="text" <br/>          class="form-control"<br/>          formControlName="username" /&gt;<br/>      &lt;/div&gt;<br/>      &lt;div class="form-group"&gt;<br/>        &lt;label for="password"&gt;Password&lt;/label&gt;<br/>        &lt;input type="password" class="form-control"&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="modal-footer"&gt;<br/>    &lt;button class="btn btn-success"<br/>      [disabled]="!myForm.valid"&gt;<br/>      Submit Form<br/>    &lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/form&gt;</span></pre><p id="ee49" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和组件。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5938" class="lg lh iq mh b gy mq mr l ms mt">import { Component, Output, EventEmitter, Input } from '@angular/core';<br/>import { FormGroup, FormBuilder, FormControl, Validators } from '@angular/forms';<br/>import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';</span><span id="1b91" class="lg lh iq mh b gy mv mr l ms mt">@Component({<br/>  selector: 'app-form-modal',<br/>  templateUrl: './form-modal.component.html'<br/>})<br/>export class FormModalComponent {</span><span id="d1c4" class="lg lh iq mh b gy mv mr l ms mt">  @Input()id: number;<br/>  myForm: FormGroup;</span><span id="a856" class="lg lh iq mh b gy mv mr l ms mt">  constructor(<br/>   public activeModal: NgbActiveModal,<br/>   private formBuilder: FormBuilder<br/>  ) {<br/>    this.createForm();<br/>  }</span><span id="d53a" class="lg lh iq mh b gy mv mr l ms mt">  private createForm() {<br/>    this.myForm = this.formBuilder.group({<br/>      username: '',<br/>      password: ''<br/>    });<br/>  }</span><span id="87a7" class="lg lh iq mh b gy mv mr l ms mt">  private submitForm() {<br/>    this.activeModal.close(this.myForm.value);<br/>  }<br/>}</span></pre><p id="530e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将把表单值记录到控制台，但是你可以随心所欲。</p><h2 id="0fe2" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kj ls lt lu kn lv lw lx ly bi translated">摘要</h2><p id="7c6a" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">因此，我们已经实现了在ng-boostrap模型内部创建表单的目标。使用这种方法，您可以将id传递给表单组件，检索可编辑的信息。您还可以将值传递回初始化它的组件，更新一个表或给用户一个响应。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Form Field Validation with HTML (and a little Javascript)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用HTML(和一点Javascript)进行表单域验证</h1>
<blockquote>原文：<a href="https://itnext.io/https-medium-com-joshstudley-form-field-validation-with-html-and-a-little-javascript-1bda6a4a4c8c?source=collection_archive---------0-----------------------#2018-04-30">https://itnext.io/https-medium-com-joshstudley-form-field-validation-with-html-and-a-little-javascript-1bda6a4a4c8c?source=collection_archive---------0-----------------------#2018-04-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/813d994995ec81674970177fa551ca7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IiDLJmskRpaq-DRX."/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@christinhumephoto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯汀·休姆</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上发表的“咖啡馆里，一个女人的手放在笔记本电脑的键盘上”</figcaption></figure><blockquote class="kd"><p id="89ee" class="ke kf iq bd kg kh ki kj kk kl km kn dk translated">爱是伟大的，但不是密码。——<a class="ae kc" href="https://en.wikipedia.org/wiki/Matt_Mullenweg" rel="noopener ugc nofollow" target="_blank">马特·莫楞威格</a></p></blockquote><p id="c6b2" class="pw-post-body-paragraph ko kp iq kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk kn ij bi translated">防止不良形式信息是猫和猫的致命游戏。作为web开发人员，我们希望保护表单字段中填写的信息。糟糕的信息导致糟糕的用户交互、糟糕的分析和糟糕的销售。</p><p id="d1dc" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">以所有重要的“电子邮件”字段为例。电子邮件地址应该始终具有相同的结构:some text @ web domain . extension。一个真实世界的例子是:<a class="ae kc" href="mailto:%20legal@medium.com" rel="noopener" target="_blank">legal@medium.com</a>。电子邮件表单字段应该检查用户是否正确输入了电子邮件地址。电子邮件地址包含一些文本，后跟@符号，然后是域名、点(。)最后一个扩展。这需要做很多检查。</p><p id="048a" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">一个古老的问题是“我们在哪里检查有效输入:服务器端还是客户端？”服务器端检查需要用户将表单提交给服务器，比如ASP、C#或PHP，然后服务器代码进行检查，如果发现错误就返回错误。这是一次漫长而昂贵的旅行。客户端验证通常意味着:JavaScript在表单提交之前拦截表单以检查错误，可能使用regex。这省去了到服务器的旅程，但仍然使用了一点代码。虽然我们仍然应该使用服务器端验证，但我将讨论如何充分利用客户端验证来减少服务器请求的数量。</p><p id="cb72" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">HTML5给我们带来了“数字”、“日期”、“邮件”等几种<code class="fe lq lr ls lt b">&lt;input&gt;</code>类型。</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="24ea" class="mc md iq lt b gy me mf l mg mh">&lt;input <strong class="lt ir">type="email"</strong> id="emailField"&gt;</span></pre><p id="7ee1" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">默认情况下，电子邮件输入字段跟踪输入文本的状态，就像我们使用JavaScript和<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" rel="noopener ugc nofollow" target="_blank"> regex </a>来检查模式一样。如果您想写出同样的正则表达式，它应该是这样的:</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="db34" class="mc md iq lt b gy me mf l mg mh">/^[a-zA-Z0–9.!#$%&amp;’*+\/=?^_`{|}~-]+@[a-zA-Z0–9](?:[a-zA-Z0–9-]{0,61} [a-zA-Z0–9])?(?:\.[a-zA-Z0–9](?:[a-zA-Z0–9-]{0,61}[a-zA-Z0–9])?)*$/</span></pre><p id="bac8" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">来源:<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/email#Basic_validation" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTML/Element/input/email # Basic _ validation</a></p><p id="09c0" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">使用email类型，我们可以用一个名为… <code class="fe lq lr ls lt b">checkValidity()</code>的javascript函数来检查表单字段的有效性。该函数返回true|false值。<code class="fe lq lr ls lt b">checkValidity()</code>将查看输入类型，以及是否设置了<code class="fe lq lr ls lt b">required</code>属性和任何<code class="fe lq lr ls lt b">pattern=""</code>标签。</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="d923" class="mc md iq lt b gy me mf l mg mh">&lt;input <strong class="lt ir">type="email"</strong> id="emailField" <strong class="lt ir">required</strong>&gt;</span></pre><p id="06e8" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">对<code class="fe lq lr ls lt b">checkValidity()</code>的支持适用于所有浏览器，包括ie10和iOS。<a class="ae kc" href="https://caniuse.com/#feat=form-validation" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/#feat=form-validation</a></p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="4e9e" class="mc md iq lt b gy me mf l mg mh">const isValidEmail = emailField.<strong class="lt ir">checkValidity()</strong>;</span></pre><p id="0b8c" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">我们可以在提交表单之前检查表单值。</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="9a28" class="mc md iq lt b gy me mf l mg mh">if ( <strong class="lt ir">isValidEmail </strong>) {<br/>  <em class="mi">...submit the form</em><br/>} else {<br/>  <em class="mi">...notify user</em><br/>}</span></pre><p id="97dd" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">在用户输入时进行检查就是在输入字段中添加正确的事件监听器。当用户在输入字段中输入时，使用<code class="fe lq lr ls lt b">keyup</code>会立即给出反馈。</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="5449" class="mc md iq lt b gy me mf l mg mh">emailField.addEventListener('<strong class="lt ir">keyup</strong>', function (event) {<br/>  isValidEmail = emailField.checkValidity();<br/>});</span></pre><p id="71fb" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">我们还可以阻止用户提交表单，直到文本有效。将<code class="fe lq lr ls lt b">disabled</code>添加到<code class="fe lq lr ls lt b">&lt;button&gt;</code>将阻止提交，在检查有效性后，我们可以重新启用它。禁用状态让用户知道表单需要正确填写，并防止任何不需要的提交。</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="1699" class="mc md iq lt b gy me mf l mg mh">&lt;button id="okButton" <strong class="lt ir">disabled</strong>&gt;OK&lt;/button&gt;</span></pre><p id="db58" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">检查有效性我们可以用<code class="fe lq lr ls lt b">.disabled = true|false</code>改变按钮的状态:</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="86f5" class="mc md iq lt b gy me mf l mg mh">if ( isEmailValid ) {<br/>  okButton<strong class="lt ir">.disabled</strong> = false;<br/>} else {<br/>  okButton<strong class="lt ir">.disabled</strong> = true;<br/>}</span></pre><p id="6fde" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">将所有这些放在一起看起来可能是这样的:</p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="f870" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">我们不再需要冗长的正则表达式模式来验证表单字段。使用我们现有的html属性以及一些努力工作的内置JavaScript函数，我们可以进行简单的客户端表单验证。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="2ef3" class="ms md iq bd mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no bi translated"><strong class="ak">奖金验证—样式</strong></h1><p id="143f" class="pw-post-body-paragraph ko kp iq kq b kr np kt ku kv nq kx ky kz nr lb lc ld ns lf lg lh nt lj lk kn ij bi translated">输入字段有css伪类，可以给用户一个可视的提示，表明字段处于错误状态:<code class="fe lq lr ls lt b">:valid</code>和<code class="fe lq lr ls lt b">:invalid</code>。</p><pre class="lu lv lw lx gt ly lt lz ma aw mb bi"><span id="7ca7" class="mc md iq lt b gy me mf l mg mh">.email-field:valid {<br/>  border-color: black;<br/>}</span><span id="658b" class="mc md iq lt b gy nu mf l mg mh">.email-field:invalid {<br/>  border-color: red;<br/>}</span></pre><p id="87fe" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">另外，Chrome和Firefox会显示一个错误提示。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/71188f845ec256da16e050ce8d5d1002.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*uQuXTmO-qfxII3_Q6Omb9g.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Chrome的邮件工具提示</figcaption></figure><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/c528e982e9f64c25dfb5e9b8c4375d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*gx7rlhC1pocIDcseoj6J0A.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">火狐的电子邮件工具提示</figcaption></figure></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="168d" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">约书亚·斯图德利是凯利蓝皮书的高级用户界面工程师。他拥有超过15年的前端web开发经验，曾与多个领域的领先交互公司合作，从医疗软件到汽车媒体。Josh还在UCI编码训练营教授全栈web开发。乔希不建网站的时候，他就在建网站。说真的。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Go gRPC Cheap Ping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">去gRPC便宜乒</h1>
<blockquote>原文：<a href="https://itnext.io/go-grpc-cheap-ping-ed7a629f05de?source=collection_archive---------5-----------------------#2019-06-23">https://itnext.io/go-grpc-cheap-ping-ed7a629f05de?source=collection_archive---------5-----------------------#2019-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3e44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">简介</strong></p><p id="030b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将使用一个廉价的ping应用程序来探索gRPC，基本上我们将执行ping操作，并测量消息在报告给终端之前到达服务器并返回所需的时间。你可以在这里找到源代码<a class="ae kl" href="https://github.com/kainlite/grpc-ping" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="413f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Protobuf </strong></p><p id="452f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能已经知道gRPC使用<a class="ae kl" href="https://developers.google.com/protocol-buffers/" rel="noopener ugc nofollow" target="_blank">协议缓冲区</a>序列化数据，我们将创建一个<a class="ae kl" href="https://grpc.io/docs/guides/concepts/" rel="noopener ugc nofollow" target="_blank">一元RPC </a>，如下所示。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="69ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了这个文件，我们正在定义一个能够发送单个<code class="fe kt ku kv kw b">PingRequest</code>和获得单个<code class="fe kt ku kv kw b">PingResponse</code>的服务，我们有一个<code class="fe kt ku kv kw b">Data</code>字段，它可以来回移动，以便通过网络发送一些字节(即使我们并不真的关心这个，但它在性能测试中可能是重要或关键的)。</p><p id="f005" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">生成代码</strong></p><p id="af79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了能够使用protobuf，我们需要为我们正在编写的应用程序生成代码，在这种情况下，对于golang，命令应该是这样的:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="f645" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将为我们提供服务的定义以及携带我们定义为消息的数据所需的结构。</p><p id="8e2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">客户端</strong></p><p id="010c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">客户端在这里完成了大部分工作，正如你所看到的，你可以提供两个参数，一个指向另一个主机:port，另一个发送你喜欢的字符串，然后它测量发送和接收消息所花费的时间，并把它打印到屏幕上，与linux中实际的<code class="fe kt ku kv kw b">ping</code>命令类似。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="d7ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">服务器</strong></p><p id="6aca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该服务器仅仅是一个echo服务器，因为它会发送回你发送给它的任何东西，并记录到控制台，默认情况下，它会监听端口<code class="fe kt ku kv kw b">50000</code>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="867c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">测试它</strong></p><p id="5d8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">常规ping </strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="dd97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">客户端</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="0673" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们在测试终端时会看到的。正如你所看到的，初始连接花费了更多的时间，但之后的往返时间是非常一致的(当然，我们的廉价ping不包括错误，数据包丢失等)。</p><p id="60d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">服务器</strong></p><p id="a598" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">服务器只是回显并记录通过网络接收到的内容。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="b5c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">成交单据</strong></p><p id="ea11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你所看到的，gRPC非常快，并且简化了你需要做的一切，例如，为了有一个高效的消息系统或微服务之间的通信，它也很容易为你喜欢的任何语言生成样板文件，并且有一个每个人都必须同意的公共接口。</p><h1 id="bf80" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">正误表</h1><p id="74ed" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果您发现任何错误或有任何建议，请给我发消息，以便解决问题。</p><p id="6431" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，您可以在这里查看源代码和<a class="ae kl" href="https://github.com/kainlite/kainlite.github.io" rel="noopener ugc nofollow" target="_blank">生成代码</a>和<a class="ae kl" href="https://github.com/kainlite/blog" rel="noopener ugc nofollow" target="_blank">源代码</a>的变化</p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><p id="190b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">原载于</em><a class="ae kl" href="https://techsquad.rocks/blog/go_grpc_cheap_ping/" rel="noopener ugc nofollow" target="_blank"><em class="mh">https://tech squad . rocks</em></a><em class="mh">。</em></p></div></div>    
</body>
</html>
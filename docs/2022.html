<html>
<head>
<title>.NET Core: Windows Compatibility Pack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">。NET Core: Windows兼容包</h1>
<blockquote>原文：<a href="https://itnext.io/net-core-windows-compatibility-pack-1c8924c2434?source=collection_archive---------8-----------------------#2019-03-17">https://itnext.io/net-core-windows-compatibility-pack-1c8924c2434?source=collection_archive---------8-----------------------#2019-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6e74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Windows兼容包</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f1157a16bc9d550aec1db62888ea13c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xaZo9mj0NisRqBehfeDG0Q.png"/></div></div></figure><p id="7248" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一年多以前，微软发布了Windows兼容包。NET Core 填补了。NET核心API，如果你的应用不需要跨平台运行的话。虽然兼容性包中包含的一些API是在支持。NET标准2发布了，比如System。SQL客户端。有些API永远不会进入。NET标准，因为它们是仅用于Windows的构造，如注册表访问。</p><p id="04e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于兼容性包已经发布了很长时间，我想这篇文章会是一个很好的提醒。在这篇文章中，我们将创建一个新的。NET核心应用程序并使用Windows兼容包来访问注册表。</p><h1 id="93cf" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">应用程序创建</h1><p id="7576" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">在命令提示符下使用以下命令创建新的。NET核心控制台应用程序。</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="7b52" class="mg kz iq mc b gy mh mi l mj mk">dotnet new console</span></pre><p id="3b34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用以下命令添加对兼容性包NuGet包的引用。</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="1077" class="mg kz iq mc b gy mh mi l mj mk">dotnet add package Microsoft.Windows.Compatibility</span></pre><h1 id="cc53" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用注册表</h1><p id="45a2" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">以下是该应用程序的完整代码。这段代码可能不是最佳实践，但是它演示了注册表的用法。</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="14de" class="mg kz iq mc b gy mh mi l mj mk">class Program { static void Main(string[] args) { var thing = "World"; if (RuntimeInformation.IsOSPlatform(OSPlatform.Windows)) { using (var regKey = Registry .CurrentUser .CreateSubKey(@"Software\Testing\Test")) { thing = regKey.GetValue("ThingText")?.ToString() ?? thing; regKey.SetValue("ThingText", "Registry"); } } Console.WriteLine($"Hello {thing}!"); } }</span></pre><p id="8fb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请特别注意与注册表访问相关的if语句，因为它允许您检查您在什么平台上运行并改变您的实现，如果您的应用程序实际上是跨平台运行的，这将非常有帮助，但是当您在特定的操作系统上运行时，您需要一些细微的差异。</p><p id="4d07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序应该输出“Hellow World！”第一次运行和“你好注册表！”第二轮。</p><h1 id="e4e3" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">包扎</h1><p id="32cc" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">如果您正在创建一个新的应用程序，最好尽可能远离特定于平台的API，坚持使用。净标准。如果你试图转换一个现有的应用程序，我可以看到兼容性包加速你的转换，而不必重写应用程序的一部分，发生在我们基于Windows的API上。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="199a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ms">原载于2019年3月17日</em><a class="ae kx" href="https://elanderson.net/2019/03/net-core-windows-compatibility-pack/" rel="noopener ugc nofollow" target="_blank"><em class="ms">【elanderson.net</em></a><em class="ms">。</em></p></div></div>    
</body>
</html>
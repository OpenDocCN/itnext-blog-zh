<html>
<head>
<title>Multi-module Navigation in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android中的多模块导航</h1>
<blockquote>原文：<a href="https://itnext.io/multi-module-navigation-in-android-63cb9924ffbd?source=collection_archive---------2-----------------------#2021-06-20">https://itnext.io/multi-module-navigation-in-android-63cb9924ffbd?source=collection_archive---------2-----------------------#2021-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c84adfd54d16faebf8d5137f53076538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jU4eBZefAg4Hutafu5a51A.png"/></div></div></figure><p id="d2fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">将你的应用程序移植到一个基于特性的多模块架构中，并且想知道导航依赖是否会导致循环依赖？<br/>让我们看看如何缓解所有问题，并提出一个干净的实施方案！</p><p id="ee51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们已经掌握了以下基本知识</p><ul class=""><li id="2180" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv lk ll lm ln bi translated"><strong class="ka ir">安卓导航组件</strong></li><li id="b6ba" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated"><strong class="ka ir">使用句柄进行依赖注入</strong></li></ul><p id="347c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好，我们开始吧！</p><h1 id="713d" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">项目结构</h1><p id="8eb2" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">我们的项目结构如下所示:</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/e4bc1f82c5b7c15af312c5d56b66ba76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CutH7eC9IQkfKUIU9mLj3Q.png"/></div></div></figure><p id="14e2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的应用程序将包括几个模块，即</p><ul class=""><li id="e146" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv lk ll lm ln bi translated">应用</li><li id="9bb6" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">核心</li><li id="4b49" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">特性A(读作特性A)</li><li id="76f5" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">特性B(读作特性B)</li></ul><p id="4769" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">应用模块</strong>是所有与应用基本功能相关的东西，如<code class="fe nb nc nd ne b">MainActivity</code>和<code class="fe nb nc nd ne b">HomeFragment</code>所在的地方。</p><p id="985d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">核心模块</strong>是一个公共模块，它包含所有可以在不同模块间共享的东西，比如不同的<code class="fe nb nc nd ne b">utility</code>类。</p><p id="a011" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">特征A模块</strong>是与我们的特征A相关的所有东西所在的地方。</p><p id="18cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> FeatureB模块</strong>是与我们的FeatureB相关的所有东西驻留的地方。</p><p id="87eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们对应用程序中的模块及其内容有了相当多的了解。</p><p id="3a2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的导航堆栈中，它看起来像这样:</p><p id="0e83" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> app →featureA →featureB </strong></p><p id="7e85" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和</p><p id="6c7a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> app →featureB →featureA </strong></p><p id="f589" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，在这里我们可以看到，我们可以从功能a到功能b，反之亦然，而不会遇到任何循环依赖错误。它看起来像这样:</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><ul class=""><li id="09a7" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv lk ll lm ln bi translated">我们首先降落在HomeFragment上，我们可以选择前往FeatureA或FeatureB。</li><li id="457f" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">如果我们单击功能a，我们可以选择转到功能b。</li><li id="4c77" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">如果我们单击功能b，我们可以选择转到功能a。</li><li id="45a8" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">点击后退按钮，我们会回到上一个片段。</li></ul><p id="a571" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了实现这一点，我们将使用导航到特定功能的方法来定义接口，这些方法的实现将在每个功能模块中，并使用Hilt为依赖注入提供。</p><p id="43d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以让我们来实现它:</p><h2 id="0c7b" class="nh lu iq bd lv ni nj dn lz nk nl dp md kj nm nn mh kn no np ml kr nq nr mp ns bi translated"><strong class="ak">第一步:</strong></h2><p id="3946" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">在核心模块中，我们为每个功能模块定义了一个接口，即</p><ul class=""><li id="9653" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv lk ll lm ln bi translated">FeatureScreenARouteContract</li><li id="4c5c" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">FeatureScreenBRouteContract</li></ul><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/712f06e56ae7df7081cb7100d361ea1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZyJwrF5o-fNXMEnlOCrUVg.png"/></div></div></figure><p id="1f60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">FeatureScreenARouteContract看起来像</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="23bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我们创建了一个名为<code class="fe nb nc nd ne b">show</code>的方法，它接受作为参数之一传递的数据和一个能够放大新屏幕的<code class="fe nb nc nd ne b">NavController</code>。</p><p id="ec07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">类似地，FeatureScreenBRouteContract看起来会像</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><h2 id="2de4" class="nh lu iq bd lv ni nj dn lz nk nl dp md kj nm nn mh kn no np ml kr nq nr mp ns bi translated"><strong class="ak">第二步:</strong></h2><p id="16f5" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">在特性A模块中，我们将通过获取<code class="fe nb nc nd ne b">dataToPass</code>并在膨胀适当的屏幕时传递它来提供<code class="fe nb nc nd ne b">FeatureScreenARouteContract</code>的实现</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="1e61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能想知道<code class="fe nb nc nd ne b">nav_graph_a</code>长什么样</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="e21a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们需要使用hilt提供我们的<code class="fe nb nc nd ne b">FeatureARouteContractImpl</code>,这样我们就可以在应用程序的任何地方使用它。以下是如何做到这一点:</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="3fa1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，通过在应用程序的任何地方调用我们的<code class="fe nb nc nd ne b">FeatureScreenARouteContract</code>，Feaute A就可以在应用程序的任何地方使用了。</p><h2 id="6cfd" class="nh lu iq bd lv ni nj dn lz nk nl dp md kj nm nn mh kn no np ml kr nq nr mp ns bi translated">类似地，对于featureB模块，实现如下:</h2><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="2181" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在featureB也准备好在任何地方注射了！</p><h2 id="cf8e" class="nh lu iq bd lv ni nj dn lz nk nl dp md kj nm nn mh kn no np ml kr nq nr mp ns bi translated">最后一步:</h2><p id="d018" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">要从app模块中的<code class="fe nb nc nd ne b">homeFragment</code>调用我们的任何模块，我们可以简单地注入我们的路由契约并为它们调用<code class="fe nb nc nd ne b">show</code>方法</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="ef6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要从featureA打开featureB，我们可以</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure><p id="6a8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要从featureB打开featureA，我们可以</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nu ng l"/></div></figure></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="70dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">瞧啊。现在我们可以从任何其他模块导航到任何模块，而不会遇到循环依赖！</p><p id="66bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">对于这个项目的完整实现，</strong>您可以在</p><div class="oc od gp gr oe of"><a href="https://github.com/abhriyaroy/Modular-Navigation-Theming" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">abhriyaroy/模块化导航主题</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">在GitHub上创建一个帐户，为abhriyaroy/模块化导航主题开发做出贡献。</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot jw of"/></div></div></a></div></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="6f07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">要检查一个更广泛的用例</strong>在使用共享元素转换时实现这一点，请检查<a class="ae ou" href="https://github.com/abhriyaroy/StockR" rel="noopener ugc nofollow" target="_blank"> StockR </a></p><div class="oc od gp gr oe of"><a href="https://github.com/abhriyaroy/StockR" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">abhriyaroy/StockR</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">一个股票推荐应用程序，帮助你的钱增值💸StockR旨在帮助您管理您的财务，把你的…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="ov l oq or os oo ot jw of"/></div></div></a></div><p id="611a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你在做这件事的时候，请在github<a class="ae ou" href="https://github.com/abhriyaroy/StockR" rel="noopener ugc nofollow" target="_blank">上留下⭐️来表达你的爱。</a></p><p id="305a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我能够向您提供一些有用的信息，请不要忘记点击👏按钮。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Kubernetes State Backup to Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes状态备份到Git</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-state-backup-to-git-4f6ed096b7bb?source=collection_archive---------2-----------------------#2018-11-30">https://itnext.io/kubernetes-state-backup-to-git-4f6ed096b7bb?source=collection_archive---------2-----------------------#2018-11-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6049" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果k8s集群的某些组件被意外删除，会很难恢复吗？</p><p id="38fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现拥有变更历史和所有资源的备份很有用。这已经节省了我一些时间，但是安全感更重要。</p><p id="52d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做了<strong class="jp ir">kube-backup</strong>(<a class="ae kl" href="https://github.com/kuberhost/kube-backup" rel="noopener ugc nofollow" target="_blank">https://github.com/kuberhost/kube-backup</a>)。它执行几个简单的步骤:</p><ul class=""><li id="7bc9" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">使用CronJob定期运行</li><li id="c1f3" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">对每种资源类型执行<code class="fe la lb lc ld b">kubectl get ...</code></li><li id="22e9" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">删除不必要的字段</li><li id="3d37" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">将每个对象保存为文件，例如<code class="fe la lb lc ld b">kube-system/Deployment/metrics-server.yaml</code></li><li id="4c71" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">做<code class="fe la lb lc ld b">git commit</code></li><li id="4a52" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">将更改推送到存储库</li></ul><p id="be24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有自动恢复的功能，但是我们可以克隆存储库，并对我们想要恢复的对象执行<code class="fe la lb lc ld b">kubectl apply …</code></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/5a7571f2ca2b1dbfb631729625ecbc37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4dO8XOj_EVzJ9rqOlZZuA.png"/></div></div></figure><p id="13b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">提交消息在某种程度上是有意义的，并且提供了很好的变更历史。</p><p id="b485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很想听听你对此的想法</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><p id="ddda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lx">这是我围绕</em><a class="ae kl" href="https://kuber.host/" rel="noopener ugc nofollow" target="_blank"><em class="lx">kuber . host</em></a><em class="lx">构建的工具之一——kubernetes cloud with free plan(仍是beta版)</em></p></div></div>    
</body>
</html>
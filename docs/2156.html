<html>
<head>
<title>Best Practices of Configuring Django Settings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">配置Django设置的最佳实践</h1>
<blockquote>原文：<a href="https://itnext.io/best-practices-of-configuring-django-settings-85e5e770f54b?source=collection_archive---------4-----------------------#2019-04-08">https://itnext.io/best-practices-of-configuring-django-settings-85e5e770f54b?source=collection_archive---------4-----------------------#2019-04-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7f55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">在这里，我想分享一篇让我参加2019年哥本哈根DjangoConEurope的文章。这些信息成为我闪电演讲的基础(查看下面的链接观看视频)，除了感谢</em> <a class="ae km" href="https://djangostars.com/company/team/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=django%20stars%20team" rel="noopener ugc nofollow" target="_blank"> <em class="kl"> Django Stars团队</em> </a> <em class="kl">对准备工作的帮助和DjangoCon的邀请，我想表达的是希望你会觉得有用。</em></p><blockquote class="kn ko kp"><p id="cca2" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><a class="ae km" href="https://2019.djangocon.eu/talks/lightning-talks-day-2/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="iq">https://2019.djangocon.eu/talks/lightning-talks-day-2/</em></strong></a></p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/063c3ea1604a0bb48b1ab67f26f7eb83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*DBOF0QTRR78Cmbf_ZP2eHA.jpeg"/></div></figure><h2 id="8dc4" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">好了，现在我们来配置Django设置。</h2><p id="6395" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">本文面向使用Django框架的工程师。它深入分析了配置Django项目设置，以及不同方法的优缺点。在本文中，您还可以找到关于工具、最佳实践和架构解决方案的建议，所有这些都经过了成功项目的时间考验和证明。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lz"><img src="../Images/f42e7b82118cef0d24dd893c10784ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DM_-9CXVXbejUato.png"/></div></div></figure><h1 id="0b4c" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">管理Django设置:问题</h1><p id="c131" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated"><strong class="jp ir">不同的环境。通常，你有几个环境:本地、开发、ci、qa、试运行、生产等。每个环境都可以有自己的特定设置(例如:<code class="fe mv mw mx my b">DEBUG = True</code>、更详细的日志记录、附加应用程序、一些模拟数据等)。您需要一种允许您保留所有这些Django设置配置的方法。</strong></p><p id="4b13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">敏感数据。</strong>每个Django项目中都有<code class="fe mv mw mx my b">SECRET_KEY</code>。在此之上，可以有用于第三方API(如Amazon或Twitter)的DB密码和令牌。这些数据不能存储在VCS。</p><p id="fc44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">团队成员之间的共享设置。</strong>你需要一个通用的方法来消除使用设置时的人为错误。例如，开发人员可能添加了第三方应用程序或一些API集成，但未能添加特定设置。在大型(甚至中型)项目中，这可能会导致真正的问题。</p><p id="937c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Django设置是一个Python代码。这是一个诅咒，同时也是一个祝福。它为您提供了很大的灵活性，但也是一个问题——settings . py可能有一个非常复杂的逻辑，而不是键值对。</strong></p><h1 id="ed40" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">设置配置:不同的方法</h1><p id="26a0" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">如果不进行硬编码，就没有内置的通用方法来配置Django设置。但是书籍、开源和工作项目提供了很多关于如何做到最好的建议和方法。让我们简单看一下最受欢迎的几个来考察它们的优缺点。</p><h1 id="4773" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">设置_local.py</h1><p id="d177" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这是最古老的方法。我第一次在生产服务器上配置Django项目时使用了它。以前我看到很多人用它，现在我仍然看到它。</p><p id="0666" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法的基本思想是扩展<code class="fe mv mw mx my b">settings_local.py</code>文件中所有特定于环境的设置，VCS忽略了这一点。这里有一个例子:</p><p id="15ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mv mw mx my b">settings.py</code>文件:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="2900" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mv mw mx my b">settings_local.py</code>文件:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="c74e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">优点:</strong></p><ul class=""><li id="6402" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated">不在VCS的秘密。</li></ul><p id="adfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">缺点:</strong></p><ul class=""><li id="9c2d" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated"><code class="fe mv mw mx my b">settings_local.py</code>不在VCS，因此您可能会丢失一些Django环境设置。</li><li id="b8d3" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">Django设置文件是一个Python代码，所以<code class="fe mv mw mx my b">settings_local.py</code>可以有一些不明显的逻辑。</li><li id="7755" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">你需要有<code class="fe mv mw mx my b">settings_local.example</code>(在VCS)为开发者分享默认配置。</li></ul><h1 id="061a" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">每个环境都有单独的设置文件</h1><p id="d4a8" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这是以前方法的扩展。它允许你在VCS保存所有的配置，并在开发者之间共享默认设置。</p><p id="227d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，您用下面的文件结构制作一个<code class="fe mv mw mx my b">settings</code>包:</p><pre class="ku kv kw kx gt np my nq nr aw ns bi"><span id="f2df" class="lb lc iq my b gy nt nu l nv nw">settings/<br/>   ├── __init__.py<br/>   ├── base.py<br/>   ├── ci.py<br/>   ├── local.py<br/>   ├── staging.py<br/>   ├── production.py<br/>   └── qa.py</span></pre><p id="1455" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置/local.py:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e1c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要运行具有特定配置的项目，您需要设置一个附加参数:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8e51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">优点:</strong></p><ul class=""><li id="ee65" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated">所有的环境都在VCS。</li><li id="9d3f" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">开发者之间很容易共享设置。</li></ul><p id="99d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">缺点:</strong></p><ul class=""><li id="f662" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated">您需要找到一种方法来处理秘密密码和令牌。</li><li id="d825" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">设置的“继承”可能很难跟踪和维护。</li></ul><h1 id="6c0c" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">环境变量</h1><p id="1f37" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">要解决敏感数据的问题，可以使用环境变量。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="073e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是使用Python <code class="fe mv mw mx my b">os.environ</code>的最简单的例子，它有几个问题:</p><ol class=""><li id="bba3" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk nx nh ni nj bi translated">你需要处理<code class="fe mv mw mx my b">KeyError</code>异常。</li><li id="e7b2" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">您需要手动转换类型(参见<code class="fe mv mw mx my b">DATABASE_PORT</code>用法)。</li></ol><p id="7fc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要修复<code class="fe mv mw mx my b">KeyError</code>，您可以编写自己的定制包装器。例如:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a6ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，您可以为此包装设置默认值并添加类型转换。但实际上，没有必要编写这个包装器，因为你可以使用第三方库(我们将在稍后讨论这个<a class="ae km" href="https://djangostars.com/blog/configuring-django-settings-best-practices/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=later#7" rel="noopener ugc nofollow" target="_blank"/>)。</p><p id="e153" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">优点:</strong></p><ul class=""><li id="aa5a" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated">配置与代码是分离的。</li><li id="11cd" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">环境奇偶校验—所有环境都有相同的代码。</li><li id="6b43" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">设置中没有继承，代码更干净更一致。</li><li id="8f9a" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">使用环境变量有一个理论基础——<a class="ae km" href="https://djangostars.com/blog/configuring-django-settings-best-practices/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=12%20factors#6" rel="noopener ugc nofollow" target="_blank">12个因素</a>。</li></ul><p id="5aca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">缺点:</strong></p><ul class=""><li id="c1ed" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated">您需要处理开发人员之间共享默认配置的问题。</li></ul><h1 id="ee50" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">12个因素</h1><p id="b67b" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">《12个因素》收集了关于如何构建易于在云中部署和扩展的分布式web应用的建议。它是由知名云托管提供商<a class="ae km" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>创建的。</p><p id="9ac4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，该系列由十二部分组成:</p><ol class=""><li id="1923" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk nx nh ni nj bi translated">代码库</li><li id="8b3b" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">属国</li><li id="e470" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">配置</li><li id="f491" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">后勤服务</li><li id="ae23" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">构建、发布、运行</li><li id="ef0a" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">处理</li><li id="4299" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">端口绑定</li><li id="0dbf" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">并发</li><li id="078a" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">一次性</li><li id="577b" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">开发/生产平价</li><li id="311e" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">日志</li><li id="7c52" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk nx nh ni nj bi translated">管理流程</li></ol><p id="5dd1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每一点都描述了实现项目特定方面的推荐方法。Django、Python、pip等工具涵盖了其中的一些内容。有些被设计模式或基础设施设置所覆盖。在本文的上下文中，我们感兴趣的是一个部分:配置<a class="ae km" href="https://12factor.net/config" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="f41d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它的主要规则是<strong class="jp ir">在环境</strong>中存储配置。遵循这个建议将会给我们带来配置与代码的严格分离。</p><p id="7d92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以阅读更多关于12factor.net的文章。</p><h2 id="2e16" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">您可能还喜欢:</h2><div class="ny nz gp gr oa ob"><a href="https://djangostars.com/blog/the-python-celery-cookbook-small-tool-big-possibilities/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=you%20may%20also%20like" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">Python芹菜食谱:小工具，大可能性</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">Python社区中的每个人都至少听说过一次芹菜，甚至可能已经使用过它了…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">djangostars.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kz ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://djangostars.com/blog/what-is-docker-and-how-to-use-it-with-python/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=you%20may%20also%20like" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">什么是Docker以及如何在Python中使用它(教程)</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">这是一个介绍Docker容器的教程。到本文结束时，你将知道如何在…上使用Docker</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">djangostars.com</p></div></div><div class="ok l"><div class="oq l om on oo ok op kz ob"/></div></div></a></div><h1 id="532c" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">姜戈郊区</h1><p id="8e9a" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">基于以上所述，我们看到<strong class="jp ir">环境变量是存储设置</strong>的最佳位置。</p><p id="6d8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是时候谈谈工具箱了。</p><p id="1d9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe mv mw mx my b">os.environ</code>编写代码有时会很棘手，需要额外的努力来处理错误。最好用<a class="ae km" href="https://django-environ.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">django-environ</strong></a>代替。</p><p id="5ac1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从技术上讲，它是以下内容的合并:</p><ul class=""><li id="f073" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated"><a class="ae km" href="https://github.com/rconradharris/envparse" rel="noopener ugc nofollow" target="_blank"> envparse </a></li><li id="802f" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://github.com/nickstenning/honcho" rel="noopener ugc nofollow" target="_blank">第一把手</a></li><li id="531d" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://github.com/kennethreitz/dj-database-url" rel="noopener ugc nofollow" target="_blank">DJ-数据库-网址</a></li><li id="ca8f" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://github.com/dstufft/dj-search-url" rel="noopener ugc nofollow" target="_blank"> dj搜索网址</a></li><li id="ef27" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://github.com/julianwachholz/dj-config-url" rel="noopener ugc nofollow" target="_blank"> dj-config-url </a></li><li id="2fcd" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://github.com/ghickman/django-cache-url" rel="noopener ugc nofollow" target="_blank"> django-cache-url </a></li></ul><p id="2f0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个应用程序提供了一个功能良好的API，用于从环境变量或文本文件中读取值，少量的类型转换等。让我们看一些例子。</p><p id="b424" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mv mw mx my b">settings.py</code>文件之前:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="34ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mv mw mx my b">settings.py</code>文件后:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="3270" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mv mw mx my b">.env</code>文件:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="7f95" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">设置结构</h1><p id="a83d" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">你可以按照来源来划分设置，而不是按照环境来划分:Django，第三方应用(Celery，DRF，等等。)，以及您的自定义设置。</p><p id="260d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">文件结构:</p><pre class="ku kv kw kx gt np my nq nr aw ns bi"><span id="4bc3" class="lb lc iq my b gy nt nu l nv nw">project/<br/>├── apps/<br/>├── settings/<br/>│   ├── __init__.py<br/>│   ├── djano.py<br/>│   ├── project.py<br/>│   └── third_party.py<br/>└── manage.py</span></pre><p id="718d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mv mw mx my b">__init__.py</code>文件:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="4352" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个模块可以作为一个包来完成，并且您可以更精细地对其进行拆分:</p><pre class="ku kv kw kx gt np my nq nr aw ns bi"><span id="fa23" class="lb lc iq my b gy nt nu l nv nw">project/<br/>├── apps/<br/>├── settings/<br/>│   ├── project<br/>│   │   ├── __init__.py<br/>│   │   ├── custom_module_foo.py<br/>│   │   ├── custom_module_bar.py<br/>│   │   └── custom_module_xyz.py<br/>│   ├── third_party<br/>│   │   ├── __init__.py<br/>│   │   ├── celery.py<br/>│   │   ├── email.py<br/>│   │   └── rest_framework.py<br/>│   ├── __init__.py<br/>│   └── djano.py<br/>└── manage.py</span></pre><h1 id="da75" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">命名规格</h1><p id="42d4" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">变量的命名是开发中最复杂的部分之一。设置的命名也是如此。我们不能暗示Django或第三方应用程序，但我们可以遵循这些简单的规则进行自定义(项目)设置:</p><ul class=""><li id="e31b" class="nb nc iq jp b jq jr ju jv jy nd kc ne kg nf kk ng nh ni nj bi translated">为您的设置取一个有意义的名称。</li><li id="0be5" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">对于您的自定义(项目)设置，请始终使用项目名称前缀。</li><li id="3989" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">在评论中为您的设置写下描述。</li></ul><p id="35d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">不好的例子:</strong></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="daf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">好例子:</strong></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="88e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">把<code class="fe mv mw mx my b">MYAWESOMEPROJECT</code>改成你真实的项目名。</p><h1 id="592a" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">Django环境:最佳实践</h1><ul class=""><li id="3d01" class="nb nc iq jp b jq lu ju lv jy or kc os kg ot kk ng nh ni nj bi translated">保留环境变量中的设置。</li><li id="ba35" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">写入生产配置的默认值(不包括密钥和令牌)。</li><li id="b273" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">不要硬编码敏感设置，也不要把它们放在VCS。</li><li id="11cb" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">将设置分组:Django、第三方、项目。</li><li id="9943" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated">遵循自定义(项目)设置的命名约定。</li></ul><h1 id="96ef" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">结论</h1><p id="ccef" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">设置文件是任何Django项目的一个小但非常重要的部分。如果你做错了，你会在开发的各个阶段遇到很多问题。但是如果你做得对，这将是你的项目的一个很好的基础，允许它在未来成长和扩展。</p><p id="2081" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用环境变量方法，您可以轻松地从整体架构切换到微服务架构，将您的项目包装在Docker容器中，并将其部署在任何VPS或云托管平台上，如Amazon、Google Cloud或您自己的Kubernetes集群。</p><h1 id="e678" class="me lc iq bd ld mf mg mh lg mi mj mk lj ml mm mn lm mo mp mq lp mr ms mt ls mu bi translated">来源:</h1><ul class=""><li id="c881" class="nb nc iq jp b jq lu ju lv jy or kc os kg ot kk ng nh ni nj bi translated"><a class="ae km" href="https://12factor.net/" rel="noopener ugc nofollow" target="_blank">https://12factor.net/</a></li><li id="96ca" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://django-environ.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://django-environ.readthedocs.io/en/latest/</a></li><li id="2df5" class="nb nc iq jp b jq nk ju nl jy nm kc nn kg no kk ng nh ni nj bi translated"><a class="ae km" href="https://www.twoscoopspress.com/collections/everything/products/two-scoops-of-django-1-11" rel="noopener ugc nofollow" target="_blank">Django的两个范围</a></li></ul><blockquote class="kn ko kp"><p id="2225" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">这篇关于</em> <a class="ae km" href="https://djangostars.com/blog/configuring-django-settings-best-practices/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=originally%20posted" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="iq">配置Django设置</em> </strong> </a> <em class="iq">的文章最初发布于</em> <a class="ae km" href="https://djangostars.com/blog/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=Django%20Stars%20blog" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="iq"> Django Stars博客</em> </strong> </a> <em class="iq">。</em></p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><a href="https://djangostars.com/services/python-django-development/?utm_source=itnext.io&amp;utm_medium=medium&amp;utm_campaign=django%20settings&amp;utm_content=banner_end"><div class="gh gi ou"><img src="../Images/6d17f1f498aa416fd7fa01921bc012f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_uHZvyUk2wIql_cXIsZcw.png"/></div></a></figure></div></div>    
</body>
</html>
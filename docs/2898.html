<html>
<head>
<title>PWA splash screen and icon generator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PWA闪屏和图标生成器</h1>
<blockquote>原文：<a href="https://itnext.io/pwa-splash-screen-and-icon-generator-a74ebb8a130?source=collection_archive---------0-----------------------#2019-08-25">https://itnext.io/pwa-splash-screen-and-icon-generator-a74ebb8a130?source=collection_archive---------0-----------------------#2019-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1101f23242d5a7519b1c251272f5e728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vtsdgQQdt3WrUN9sUJNOzg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">演示由<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="bd kd">PWA-asset-generator</strong></a>生成的在iOS上带有闪屏和图标的PWA</figcaption></figure><p id="1946" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">长话短说；在为我的下一次演讲试验关于Puppeteer的想法时，我发现自己正在构建一个开源的CLI工具—<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir">【pwa—资产—生成器</strong> </a> <strong class="kg ir">！:)</strong></p><p id="fb08" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">它会自动为您的渐进式Web应用程序生成闪屏和图标图像，以便在多个平台上提供类似本机的用户体验。它还更新您的<code class="fe lc ld le lf b">index.html</code>和<code class="fe lc ld le lf b">manifest.json</code>文件，向您的PWA声明生成的资产。</p><p id="39d7" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在本文中，我将详细介绍我构建这样一个库的动机，以及一些高级的使用示例。</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/f5fbf9778851453525748f53d138d87f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*O_lKXAOU_Iw7e1NEUX3ecQ.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="bd kd">pwa-asset-generator</strong></a>的基本使用演示</figcaption></figure><div class="ll lm gp gr ln lo"><a href="https://www.npmjs.com/package/pwa-asset-generator" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd ir gy z fp lt fr fs lu fu fw ip bi translated">资产生成器</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">基于木偶师的PWA资产生成器。根据Web应用程序清单自动生成图标和闪屏…</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">www.npmjs.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc jw lo"/></div></div></a></div><p id="acf4" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在接下来的章节中，我将解释为什么需要这样一个库，以及它与为您的PWA生成资产的其他现有选项相比如何。</p><blockquote class="md"><p id="4aaa" class="me mf iq bd mg mh mi mj mk ml mm lb dk translated">请随意跳到文章的最后一章⏬查看该库的功能和高级用法示例。</p></blockquote></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="1d8c" class="mu mv iq bd kd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bi translated">我们为什么需要这样一个图书馆？</h1><p id="097b" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">当您构建PWA的目标是在多个平台和商店上提供类似本机的用户体验时，您需要用您的PWA资产来满足那些平台和商店的标准；<strong class="kg ir">图标</strong>和<strong class="kg ir">闪屏</strong>。这些标准是:</p><ul class=""><li id="9d7b" class="nw nx iq kg b kh ki kl km kp ny kt nz kx oa lb ob oc od oe bi translated"><strong class="kg ir">谷歌的Android </strong>平台尊重Web应用清单API规范，它希望你在清单文件中至少提供<strong class="kg ir">两种图标大小</strong>—<a class="ae kc" href="https://developers.google.com/web/fundamentals/web-app-manifest/#icons" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/Web/fundamentals/we b-App-Manifest/# icons</a></li><li id="e337" class="nw nx iq kg b kh of kl og kp oh kt oi kx oj lb ob oc od oe bi translated">正如Microsoft docs中所指出的，您的PWA必须满足Web应用程序清单中声明的特定图像标准，才能自动打包用于<strong class="kg ir">Microsoft Store</strong>—<a class="ae kc" href="https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps/get-started#web-app-manifest" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/Microsoft-edge/progressive-we B- apps/get-started # we B- App-Manifest</a></li></ul><blockquote class="md"><p id="014f" class="me mf iq bd mg mh ok ol om on oo lb dk translated">一旦您使用所需大小的图标作为Web应用程序清单API的一部分，您就不需要为上述平台提供额外的闪屏图像。它们是自动为您生成的。</p></blockquote><h2 id="0818" class="op mv iq bd kd oq or dn mz os ot dp nd kp ou ov nh kt ow ox nl kx oy oz np pa bi translated">监督办的标准</h2><p id="f653" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">复杂。目前，iOS不支持Web App Manifest API规范，尽管该规范正在开发中——点击此处跟踪进展<a class="ae kc" href="https://webkit.org/status/#specification-web-app-manifest" rel="noopener ugc nofollow" target="_blank">。目前还不清楚苹果是否会在标准实施期间改变显示闪屏的方式，因为<em class="pb">闪屏不是Web应用清单规范</em>的一部分。到目前为止，在iOS上为你的PWA设置图标和闪屏的唯一方法是，添加特殊的HTML标签。</a></p><p id="a89a" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">当PWA被添加到用户的主屏幕时，需要一个带有rel <code class="fe lc ld le lf b">apple-touch-icon</code>的特殊HTML链接标签来为它提供图标。在<a class="ae kc" href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/app-icon/" rel="noopener ugc nofollow" target="_blank">苹果图标指南</a>和<a class="ae kc" href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html" rel="noopener ugc nofollow" target="_blank"> Safari网络内容指南</a>上阅读更多相关内容。</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pc"><img src="../Images/4633b31851639ff7c1483b2391ab9210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NhU6DAgHb9v7APv-ih2Hpw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来自<a class="ae kc" href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/app-icon/" rel="noopener ugc nofollow" target="_blank">苹果图标指南</a>的图标规格示例</figcaption></figure><p id="1d5c" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果您还想为PWA提供闪屏，则需要另一个带有rel <code class="fe lc ld le lf b">apple-touch-startup-image</code>的特殊HTML链接标签。当你的PWA在后台打开时，iOS会显示这些屏幕。到目前为止一切顺利！</p><p id="bbca" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">但是，这里有一个陷阱:你需要为<a class="ae kc" href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/launch-screen/#static-launch-screen-images-not-recommended" rel="noopener ugc nofollow" target="_blank">苹果的启动屏幕指南</a>上的<strong class="kg ir">每个分辨率</strong>创建一个闪屏图像，并为每个设备分辨率和方向添加一个带有媒体属性的HTML标签🙀！不幸的是，这一要求在Safari Web内容指南中没有得到充分的记录。</p><p id="6c1b" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="kg ir">仅一个</strong>分辨率&amp;方位对的链接标签示例；</p><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="4e4d" class="op mv iq lf b gy ph pi l pj pk">&lt;link rel="apple-touch-startup-image" href="temp/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"&gt;</span></pre><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pl"><img src="../Images/438194b0424104d663992143bde73548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EYX4J2SInAL_0aEa_HbYUg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">苹果发布屏幕指南中的闪屏规格示例</figcaption></figure><blockquote class="md"><p id="b079" class="me mf iq bd mg mh ok ol om on oo lb dk translated">💡为所有平台创建图标和闪屏图像，维护所有平台的大小和质量，并为每个图像添加HTML标签，这些工作可能会让人不知所措。那么，为什么不自动化呢？🤖</p></blockquote></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="27a4" class="mu mv iq bd kd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bi translated">现有解决方案的缺点</h1><p id="c392" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">当我决定构建这样一个CLI库时，已经有几个选项可以为pwa和与它们相关联的元生成资产。它们可能很适合你的需要，但是我认为在决定使用什么的时候了解它们的缺点是明智的。</p><p id="a9e6" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我在使用时注意到的<em class="pb">的一些缺点是<em class="pb">；</em></em></p><h2 id="9db9" class="op mv iq bd kd oq pm dn mz os pn dp nd kp po ov nh kt pp ox nl kx pq oz np pa bi translated">运行时依赖性</h2><p id="f626" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">生成和使用PWA资产的一个选项是使用<a class="ae kc" href="https://github.com/GoogleChromeLabs/pwacompat" rel="noopener ugc nofollow" target="_blank"> PWACompat </a>。我认为跨平台保持标准的闪屏外观是一个不错的选择。但是，它使用一种方法在运行时(iOS)生成PWA图像，并将它们存储在浏览器的会话存储中。请记住，这种方法不仅会影响PWA的初始化性能，还会接管您的<em class="pb"> manifest.json </em>文件和资产的所有权。</p><h2 id="f438" class="op mv iq bd kd oq pm dn mz os pn dp nd kp po ov nh kt pp ox nl kx pq oz np pa bi translated">带来维护成本</h2><p id="7d3f" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">生成和使用PWA资产的一些其他选项是在线工具，如<a class="ae kc" href="https://appsco.pe/developer/splash-screens" rel="noopener ugc nofollow" target="_blank"> AppScope闪屏生成器</a>或<a class="ae kc" href="https://www.pwabuilder.com/generate" rel="noopener ugc nofollow" target="_blank"> PWABuilder </a>。这些工具分别生成图标<em class="pb">或</em>闪屏，没有任何在线工具可以生成这两种资产类型。它们还伴随着维护成本，例如:</p><ul class=""><li id="90ed" class="nw nx iq kg b kh ki kl km kp ny kt nz kx oa lb ob oc od oe bi translated">解压缩内容并重新定位资产</li><li id="7e20" class="nw nx iq kg b kh of kl og kp oh kt oi kx oj lb ob oc od oe bi translated">手动更新<em class="pb"> manifest.json </em>或<em class="pb">index.html</em>文件</li><li id="2928" class="nw nx iq kg b kh of kl og kp oh kt oi kx oj lb ob oc od oe bi translated">关注标准和指南，确保您的PWA兼容所有设备类型和平台</li></ul><p id="7634" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">并且，一遍又一遍的做这种手工。</p><h2 id="325c" class="op mv iq bd kd oq pm dn mz os pn dp nd kp po ov nh kt pp ox nl kx pq oz np pa bi translated"><strong class="ak">难以自动化</strong></h2><p id="55a9" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">使用在线工具的另一个缺点是它们很难自动化。让您的PWA资产保持最新并以自动化方式兼容所有平台的理想场景是将<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir">PWA-asset-generator</strong></a>集成到您最喜欢的CI的构建步骤中。它可以生成所有的资产，并根据最新的平台规范更新您的<em class="pb">index.html</em>和<em class="pb"> manifest.json </em>文件以及相关的元数据。</p><h2 id="cb0e" class="op mv iq bd kd oq pm dn mz os pn dp nd kp po ov nh kt pp ox nl kx pq oz np pa bi translated">缺乏对内容的灵活性和所有权</h2><p id="2104" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">你无法控制你的资产是如何产生的。现有的解决方案都不能完全控制资产是如何生成的。PWACompat根本不提供任何控件，它自动生成所有闪屏都是同一种形式。此外，当您生成资产时，在线工具提供有限的定制选项。<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir">pwa-asset-generator</strong></a>通过HTML输入让你完全控制你的资产。我将在下一章详细描述这一点。</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="ca30" class="mu mv iq bd kd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bi translated">库的功能和用法</h1><p id="a7b2" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">PWA资产生成器以创造性的方式自动生成图像。以<a class="ae kc" href="https://pptr.dev" rel="noopener ugc nofollow" target="_blank">木偶师</a>为核心可以实现很多可能性。</p><p id="e0a8" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—生成带有可选<code class="fe lc ld le lf b">--icon-only</code> <code class="fe lc ld le lf b">--splash-only</code> <code class="fe lc ld le lf b">--landscape-only</code>和<code class="fe lc ld le lf b">--portrait-only</code>标志✨的图标和闪屏</p><p id="3eec" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—自动更新您的<em class="pb"> manifest.json </em>和<em class="pb">index.html</em>文件，用于声明生成的图像资产🙌</p><p id="eba1" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—通过木偶师从苹果人机界面指南网站抓取最新规格，使您的PWA为所有/最新的iOS设备做好准备🤖</p><ul class=""><li id="f7b7" class="nw nx iq kg b kh ki kl km kp ny kt nz kx oa lb ob oc od oe bi translated">支持离线模式，并在抓取出错时使用静态规范数据📴</li><li id="e0a7" class="nw nx iq kg b kh of kl og kp oh kt oi kx oj lb ob oc od oe bi translated">每次发布前自动更新静态规格数据，并且<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator/actions?query=workflow%3A%22Sanity+Check%22" rel="noopener ugc nofollow" target="_blank">每天监控规格变化</a>🔄</li></ul><p id="c791" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—使用Chrome浏览器，因为它是您最喜欢的图像编辑器的画布。它使用一个shell HTML文件作为画板，并在通过Puppeteer为每个分辨率截图之前将您的徽标居中🤖</p><p id="0923" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—您可以以多种格式提供您的源；本地图像文件、本地HTML文件、远程图像或HTML文件🙌</p><ul class=""><li id="91b5" class="nw nx iq kg b kh ki kl km kp ny kt nz kx oa lb ob oc od oe bi translated">当它是一个图像源时，它位于您提供的背景选项的中心🌅</li><li id="2055" class="nw nx iq kg b kh of kl og kp oh kt oi kx oj lb ob oc od oe bi translated">当它是一个HTML源代码时，你可以随心所欲地发挥创造力；定位你的标志，使用SVG过滤器，使用可变字体，使用渐变背景，使用排版等。你的HTML文件在Chrome上呈现，然后对每个分辨率进行截图🎨</li></ul><p id="79ad" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—它使用<a class="ae kc" href="https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#puppeteer-vs-puppeteer-core" rel="noopener ugc nofollow" target="_blank">木偶核心</a>而不是木偶，并且只在系统上不存在Chromium时才安装它。为每个用户节省大约110-150 MB的磁盘空间和许多秒钟🌎️️⚡️</p><p id="d3f6" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">—支持iOS上的黑暗模式闪屏！所以，你可以提供两种光🌕和黑暗🌚基于用户偏好区分应用外观的闪屏图像🌙</p><h2 id="6696" class="op mv iq bd kd oq pm dn mz os pn dp nd kp po ov nh kt pp ox nl kx pq oz np pa bi translated">例子</h2><ol class=""><li id="b489" class="nw nx iq kg b kh nr kl ns kp pr kt ps kx pt lb pu oc od oe bi translated">本地PNG输入的基本用法，跳过抓取规格，生成闪屏和图标；</li></ol><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="cc2e" class="op mv iq lf b gy ph pi l pj pk">npx pwa-asset-generator ./img/logo.png --background "#ababab" --scrape false</span></pre><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pv"><img src="../Images/733fbfd512f5c3ade5b733acaaaa8885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99KCkdFFR2fYtlBQ9pvJvQ.png"/></div></div></figure><p id="5764" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">2.远程SVG输入的高级用法，使用自定义渐变背景🏳️‍🌈，只生成图标；</p><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="67fc" class="op mv iq lf b gy ph pi l pj pk">npx pwa-asset-generator <a class="ae kc" href="https://animejs.com/documentation/assets/img/icons/icon-github.svg" rel="noopener ugc nofollow" target="_blank">https://animejs.com/documentation/assets/img/icons/icon-github.svg</a> ./temp -b "linear-gradient(180deg, #f00000, #f00000 16.67%, #ff8000 16.67%, #ff8000 33.33%, #ffff00 33.33%, #ffff00 50%, #007940 50%, #007940 66.67%, #4040ff 66.67%, #4040ff 83.33%, #a000c0 83.33%, #a000c0) fixed" --icon-only</span></pre><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pw"><img src="../Images/acddb3a1210b379d97d117884a1781ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7j-AxW_ggNiwxnErY9dWJQ.png"/></div></div></figure><blockquote class="md"><p id="fd05" class="me mf iq bd mg mh ok ol om on oo lb dk translated">💡人们可以在CI上引入构建步骤，以在特殊场合自动区分PWA的品牌。岂不是很牛逼？</p></blockquote><p id="88a6" class="pw-post-body-paragraph ke kf iq kg b kh px kj kk kl py kn ko kp pz kr ks kt qa kv kw kx qb kz la lb ij bi translated">3.先进的使用自定义HTML输入，使用背景瓷砖和自定义可变网络字体，只产生闪屏，输出70%质量的JPEG文件类型，代码输出保存到您的PWA的index.html文件；</p><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="32cc" class="op mv iq lf b gy ph pi l pj pk"># The local nyan.html can be a remote url as well<br/># npx pwa-asset-generator <a class="ae kc" href="https://ny.an/nyan.html" rel="noopener ugc nofollow" target="_blank">https://ny.an/nyan.html</a></span><span id="6f67" class="op mv iq lf b gy qc pi l pj pk">npx pwa-asset-generator nyan.html ./src/app/temp --splash-only --type=jpeg --quality=70 --index ./src/app/index.html</span></pre><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qd"><img src="../Images/d7f5b9800a1bcf404fe28da59f79f20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mREjLUvDb8s79DxnOF7Gjw.png"/></div></div></figure><p id="b7ad" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果你好奇这样一个HTML是如何构建的，<a class="ae kc" href="https://gist.github.com/onderceylan/67f4d33f3317138905e1c7234cb70731" rel="noopener ugc nofollow" target="_blank">这里是要点</a>。</p><blockquote class="md"><p id="0a04" class="me mf iq bd mg mh mi mj mk ml mm lb dk translated">💡当使用HTML输入时，您可以完全控制您的资产👩‍💻您可以使用任何类型的web技术来呈现您的资产内容。有些可能包括但不限于SVG过滤器、css媒体查询、可变字体、css图像过滤器、渐变背景和图像拼贴👩‍🎨</p></blockquote><p id="77a9" class="pw-post-body-paragraph ke kf iq kg b kh px kj kk kl py kn ko kp pz kr ks kt qa kv kw kx qb kz la lb ij bi translated">4.生成iOS的亮暗模式闪屏，输出80%质量的JPEG文件类型，代码输出保存到你的PWA的index.html文件；</p><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="8fd8" class="op mv iq lf b gy ph pi l pj pk">npx pwa-asset-generator light-logo.svg ./assets --dark-mode --background dimgrey --splash-only --type jpeg --quality 80<!-- --> --index ./src/app/index.html</span><span id="b431" class="op mv iq lf b gy qc pi l pj pk">npx pwa-asset-generator dark-logo.svg ./assets --background <!-- -->lightgray<!-- --> --splash-only --type jpeg --quality 80 <!-- -->--index ./src/app/index.html</span></pre><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="qe qf l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">iOS上黑暗模式闪屏的视频演示</figcaption></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="7be4" class="mu mv iq bd kd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bi translated">额外收获:引擎盖下</h1><p id="5b81" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">对于读到这里的好奇的读者，我想分享一个简单而强大的概念，这个概念是图书馆在幕后使用的。</p><p id="c923" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">正如我前面提到的，在引擎盖下使用木偶师打开了一扇可能性之门。<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir">pwa-asset-generator</strong></a>使用的木偶师的一个关键特性，就是它的<a class="ae kc" href="https://pptr.dev/#?product=Puppeteer&amp;version=v1.19.0&amp;show=api-pagescreenshotoptions" rel="noopener ugc nofollow" target="_blank">截图API </a>。</p><p id="80f9" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">木偶戏允许保存截图在PNG和JPEG文件类型与可选的JPEG图像压缩的可能性。</p><p id="c46e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">每次你用<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir">pwa-asset-generator</strong></a>执行一个命令，库就会从2个来源抓取最新的iOS规范。然后，它打开新的选项卡，根据提供的CLI参数呈现<em class="pb"> shell HTML </em>的内容。下面是<em class="pb"> shell HTML </em>内容；</p><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="8069" class="op mv iq lf b gy ph pi l pj pk">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>  &lt;style&gt;<br/>    body {<br/>      margin: 0;<br/>      background: --background;<br/>      height: 100vh;<br/>      padding: --padding;<br/>      box-sizing: border-box;<br/>    }<br/>    img {<br/>      width: 100%;<br/>      height: 100%;<br/>      margin: 0 auto;<br/>      object-fit: contain;    <br/>    }<br/>  &lt;/style&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;img src="--image-input"&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="7f0e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">它打开一个新的浏览器选项卡，通过Puppeteer为每个图标和闪屏尺寸呈现<em class="pb"> shell HTML </em>文件内容，最后保存每个图标和闪屏尺寸的截图。</p><pre class="lh li lj lk gt pd lf pe pf aw pg bi"><span id="3a8b" class="op mv iq lf b gy ph pi l pj pk">// You can see the complete source here: <a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator/blob/master/src/helpers/puppets.ts" rel="noopener ugc nofollow" target="_blank">https://github.com/onderceylan/pwa-asset-generator/blob/master/src/helpers/puppets.ts</a></span><span id="d9c0" class="op mv iq lf b gy qc pi l pj pk">const saveImages = async (<br/>  imageList: Image[],<br/>  source: string,<br/>  output: string,<br/>  options: Options,<br/>  browser: Browser,<br/>): Promise&lt;SavedImage[]&gt; =&gt; {<br/>  let address: string;<br/>  let shellHtml: string;<br/><br/>  const logger = preLogger(saveImages.name, options);<br/>  logger.log('Initialising puppeteer to take screenshots', '🤖');<br/><br/>  if (canNavigateTo(source)) {<br/>    address = await url.getAddress(source, options);<br/>  } else {<br/>    shellHtml = await url.getShellHtml(source, options);<br/>  }<br/><br/>  return Promise.all(<br/>    imageList.map(async ({ name, width, height, scaleFactor, orientation }) =&gt; {<br/>      const { type, quality } = options;<br/>      const path = file.getImageSavePath(name, output, type);<br/><br/>      try {<br/>        const page = await browser.newPage();<br/>        await page.setViewport({ width, height });<br/><br/>        if (address) {<br/>          await page.goto(address);<br/>        } else {<br/>          await page.setContent(shellHtml);<br/>        }<br/><br/>        await page.screenshot({<br/>          path,<br/>          omitBackground: !options.opaque,<br/>          type: options.type,<br/>          ...(type !== 'png' ? { quality } : {}),<br/>        });<br/><br/>        await page.close();<br/><br/>        logger.success(`Saved image ${name}`);<br/><br/>        return { name, width, height, scaleFactor, path, orientation };<br/>      } catch (e) {<br/>        logger.error(e.message);<br/>        throw Error(`Failed to save image ${name}`);<br/>      }<br/>    }),<br/>  );<br/>};</span></pre><p id="8b30" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我的灵感来自这篇博文<a class="ae kc" href="https://dev.to/dominikfiala/hassle-free-pwa-icons-and-splash-screen-generation-3c24" rel="noopener ugc nofollow" target="_blank"/>最初是为了保存调整后的响应式网页的截图，感谢张秀坤的启发！</p><blockquote class="md"><p id="c149" class="me mf iq bd mg mh mi mj mk ml mm lb dk translated">⚡️与木偶师不同，pwa-asset-generator使用<em class="qi">系统浏览器优先</em>方法，使用<a class="ae kc" href="https://github.com/GoogleChrome/chrome-launcher" rel="noopener ugc nofollow" target="_blank"> chrome-launcher </a>和<a class="ae kc" href="https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#puppeteer-vs-puppeteer-core" rel="noopener ugc nofollow" target="_blank">木偶师核心</a>，并且它只在chrome没有安装在执行环境中时才安装chrome。</p></blockquote><p id="2507" class="pw-post-body-paragraph ke kf iq kg b kh px kj kk kl py kn ko kp pz kr ks kt qa kv kw kx qb kz la lb ij bi translated">由于库在无头模式下使用木偶师，你看不到幕后发生了什么。为了使它可见，这里有一个过程的演示，通过禁用<a class="ae kc" href="https://pptr.dev/#?product=Puppeteer&amp;version=v1.19.0&amp;show=api-puppeteerlaunchoptions" rel="noopener ugc nofollow" target="_blank">操纵木偶者启动选项</a>中的<code class="fe lc ld le lf b">headless</code>模式；</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="qe qf l"/></div></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h1 id="174c" class="mu mv iq bd kd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bi translated">支持</h1><p id="a457" class="pw-post-body-paragraph ke kf iq kg b kh nr kj kk kl ns kn ko kp nt kr ks kt nu kv kw kx nv kz la lb ij bi translated">如果你喜欢图书馆，我很欣赏你在<a class="ae kc" href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的星，以及你在<a class="ae kc" href="https://twitter.com/onderceylan/status/1162138795787071490?s=20" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上的赞/转发和反馈。如果你也是一个博客写手，那么在你的博客上看到一个关于艾滋病人的参考会很棒。</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="qe qf l"/></div></figure><div class="ll lm gp gr ln lo"><a href="https://github.com/onderceylan/pwa-asset-generator" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd ir gy z fp lt fr fs lu fu fw ip bi translated">onderceylan/pwa-资产-生成器</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">基于木偶师的PWA资产生成器。根据Web应用程序清单自动生成图标和闪屏…</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">github.com</p></div></div><div class="lx l"><div class="qj l lz ma mb lx mc jw lo"/></div></div></a></div><p id="0ee2" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果你喜欢我的文章，请在Medium和<a class="ae kc" href="https://twitter.com/onderceylan" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，订阅我未来的帖子和项目！干杯！</p></div></div>    
</body>
</html>
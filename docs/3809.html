<html>
<head>
<title>Add React to Phoenix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将React添加到凤凰城</h1>
<blockquote>原文：<a href="https://itnext.io/add-react-to-phoenix-92c590fbbc7f?source=collection_archive---------1-----------------------#2020-03-02">https://itnext.io/add-react-to-phoenix-92c590fbbc7f?source=collection_archive---------1-----------------------#2020-03-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0e0e1965603bbbc94eb252a968b95a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2J97dAkIX6c4lMrkBjWSQ.png"/></div></div></figure><p id="d8b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于如何添加React的教程。JS到你的仙丹凤凰app。</p><p id="b29e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将在这里展示如何添加React。JS转换为phoenix应用程序中的特定模板。就像<code class="fe kw kx ky kz b">react-rails</code>的工作原理一样。</p><p id="8898" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你有一个模板，你可以在里面渲染一个react组件，还可以传递一些道具！本教程不需要任何webpack配置！</p><p id="a093" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了保持同步，我使用了以下版本:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="a919" class="li lj iq kz b gy lk ll l lm ln">elixir "~&gt; 1.5"<br/>phoenix "~&gt; 1.4.6"</span></pre><p id="16b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从头开始创建一个phoenix项目:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="510d" class="li lj iq kz b gy lk ll l lm ln">$ mix phx.new yourproject<br/>$ cd yourproject<br/>$ mix deps.get<br/>$ mix ecto.setup<br/>$ mix phx.server</span></pre><p id="0d27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这些，访问<code class="fe kw kx ky kz b">localhost:4000</code>然后我们就有了一个运行的凤凰app。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lo"><img src="../Images/84d4e822e228fde9263e0956851732c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGrVNNRbWvWPe7w4dvSuJA.png"/></div></div></figure><h1 id="4ec8" class="lp lj iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">添加React</h1><p id="0eff" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">添加React的方法有很多种。JS但是正如我前面所说，这种方法是为了将react组件添加到phoenix应用程序的特定模板中。我们将使用一个名为<a class="ae mr" href="https://github.com/rstacruz/remount" rel="noopener ugc nofollow" target="_blank"> remount.js </a>的不可思议的javascript库来安装模板中的组件。</p><h2 id="6261" class="li lj iq bd lq ms mt dn lu mu mv dp ly kj mw mx mc kn my mz mg kr na nb mk nc bi translated">1.安装React</h2><p id="fed2" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">进入assets文件夹，手动安装react.js:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="90db" class="li lj iq kz b gy lk ll l lm ln">$ cd assets<br/>$ yarn add react react-dom <a class="ae mr" href="http://twitter.com/babel/preset-react" rel="noopener ugc nofollow" target="_blank">@babel/preset-react</a></span></pre><p id="9b2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们先将<code class="fe kw kx ky kz b">@babel/preset-react</code>添加到我们的<code class="fe kw kx ky kz b">.babelrc</code>配置中:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="b60d" class="li lj iq kz b gy lk ll l lm ln"># edit /assets.babelrc<br/># change it to this</span><span id="f6c7" class="li lj iq kz b gy nd ll l lm ln">{<br/>  "presets": [<br/>    "@babel/preset-env",<br/>    "@babel/preset-react"    &lt;------- ADD HERE<br/>  ]<br/>}</span></pre><p id="3b5d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，在assets的js目录中创建一个测试组件。这个只是一个呈现消息的哑组件。</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="371a" class="li lj iq kz b gy lk ll l lm ln">$ mkdir js/react/src/components/Test.js</span><span id="a93a" class="li lj iq kz b gy nd ll l lm ln"># edit assets/js/react/src/components/Test.js</span><span id="3bb3" class="li lj iq kz b gy nd ll l lm ln">import React from 'react'</span><span id="259f" class="li lj iq kz b gy nd ll l lm ln">const Test = () =&gt; (<br/> &lt;h1&gt; Hello World &lt;/h1&gt;<br/>)</span><span id="4067" class="li lj iq kz b gy nd ll l lm ln">export default Test</span></pre><h2 id="ab77" class="li lj iq bd lq ms mt dn lu mu mv dp ly kj mw mx mc kn my mz mg kr na nb mk nc bi translated">2.添加重新装载</h2><p id="44b0" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">Remount可以将HTML中的任何react组件挂载为自定义元素。让我们首先安装remount:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="058b" class="li lj iq kz b gy lk ll l lm ln">yarn add remount</span></pre><p id="1c5d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在assets的js目录中为react创建一个条目文件</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="e14f" class="li lj iq kz b gy lk ll l lm ln"># Create an entry file for your react<br/>$ mkdir js/react/src/app.js</span><span id="68b5" class="li lj iq kz b gy nd ll l lm ln"># This is the important part, where<br/># Remount will mount your component as a custom html element<br/># And you wil simply use this custom element in your template html</span><span id="a3db" class="li lj iq kz b gy nd ll l lm ln">import { define } from 'remount'<br/>import Test from './components/Test'</span><span id="682c" class="li lj iq kz b gy nd ll l lm ln">define({ 'x-anynameyouwant': Test })</span></pre><p id="97a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们不要忘记，我们需要将这个react条目文件导入到Phoenix主js文件中。在底部添加:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="d788" class="li lj iq kz b gy lk ll l lm ln"># edit /assets/js/app.js</span><span id="1bd4" class="li lj iq kz b gy nd ll l lm ln">// We need to import the CSS so that webpack will load it.<br/>// The MiniCssExtractPlugin is used to separate it out into<br/>// its own CSS file.<br/>import css from "../css/app.css"</span><span id="f578" class="li lj iq kz b gy nd ll l lm ln">// webpack automatically bundles all modules in your<br/>// entry points. Those entry points can be configured<br/>// in "webpack.config.js".<br/>//<br/>// Import dependencies<br/>//<br/>import "phoenix_html"</span><span id="6650" class="li lj iq kz b gy nd ll l lm ln">import "./react/src/app.js"</span><span id="e81a" class="li lj iq kz b gy nd ll l lm ln">// Import local files<br/>//<br/>// Local files can be imported directly using relative paths, for example:<br/>// import socket from "./socket"</span><span id="ea75" class="li lj iq kz b gy nd ll l lm ln">import "./react/src/app.js" &lt;---------------------- ADD HERE</span></pre><h2 id="e3e2" class="li lj iq bd lq ms mt dn lu mu mv dp ly kj mw mx mc kn my mz mg kr na nb mk nc bi translated">是时候渲染我们的react组件了</h2><p id="8e98" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">打开任何模板<code class="fe kw kx ky kz b">html.eex</code>文件。对于本教程，我将编辑<code class="fe kw kx ky kz b">templates/page/index.html.eex</code>:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="eca1" class="li lj iq kz b gy lk ll l lm ln"># Inside /templates/page/index.html.eex<br/># Replace the whole content with your react element that was defined via remount</span><span id="1a91" class="li lj iq kz b gy nd ll l lm ln">&lt;x-anynameyouwant&gt;&lt;/x-anynameyouwant&gt;</span></pre><p id="646c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查您的phoenix应用程序，应该会使用我们添加的react组件进行更新:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/8bdcd654a61624153642be8adf2bfb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y97d8kv5TYydZCZ0WQGYfA.png"/></div></div></figure><h2 id="8f29" class="li lj iq bd lq ms mt dn lu mu mv dp ly kj mw mx mc kn my mz mg kr na nb mk nc bi translated">奖金:</h2><p id="dba8" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">您还可以将道具传递给自定义元素:</p><pre class="la lb lc ld gt le kz lf lg aw lh bi"><span id="ca6a" class="li lj iq kz b gy lk ll l lm ln">&lt;x-anynameyouwant props-json={{"name": "John"}} &gt;&lt;/x-anynameyouwant&gt;</span></pre><p id="c6ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里阅读更多重装上阵的特色:<a class="ae mr" href="https://github.com/rstacruz/remount" rel="noopener ugc nofollow" target="_blank">https://github.com/rstacruz/remount</a></p><p id="ed0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就这么简单！现在，您可以在控制器中进行查询，将其传递给模板，然后作为道具传递给自定义元素，以便react组件可以接收它！</p><blockquote class="nf ng nh"><p id="f846" class="jy jz ni ka b kb kc kd ke kf kg kh ki nj kk kl km nk ko kp kq nl ks kt ku kv ij bi translated">谢谢！如果有帮助，请鼓掌。对乐意帮忙的问题进行评论</p></blockquote></div></div>    
</body>
</html>
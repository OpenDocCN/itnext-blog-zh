<html>
<head>
<title>Migration from ASP.NET Core 2.1 to 2.2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从ASP.NET核心2.1迁移到2.2</h1>
<blockquote>原文：<a href="https://itnext.io/migration-from-asp-net-core-2-1-to-2-2-9f16c6995064?source=collection_archive---------2-----------------------#2018-12-16">https://itnext.io/migration-from-asp-net-core-2-1-to-2-2-9f16c6995064?source=collection_archive---------2-----------------------#2018-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="62d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">12月4日<a class="ae kl" href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-2-2/" rel="noopener ugc nofollow" target="_blank">。网络核心2.2 </a>包括【ASP.NET】T2核心2.2 和<a class="ae kl" href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-entity-framework-core-2-2/" rel="noopener ugc nofollow" target="_blank">实体框架2.2 </a>。在这篇文章中，我将采用ASP.NET基础系列中使用的一个项目，并将其从ASP.NET 2.1 . x转换到新的2.2版本的ASP.NET核心。这都将基于<a class="ae kl" href="https://docs.microsoft.com/en-us/aspnet/core/migration/21-to-22?view=aspnetcore-2.2&amp;tabs=visual-studio" rel="noopener ugc nofollow" target="_blank">官方2.2迁移指南</a>。</p><p id="b854" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之前的代码任何改动都可以在<a class="ae kl" href="https://github.com/elanderson/ASP.NET-Core-Basics/tree/55f63d28df6e278efe3b714b4b5bdc3dc89b57b4" rel="noopener ugc nofollow" target="_blank">这里</a>找到。在示例解决方案中，本指南将仅适用于联系人项目。</p><h2 id="a501" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">装置</h2><p id="abd6" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">前往<a class="ae kl" href="https://dotnet.microsoft.com/download" rel="noopener ugc nofollow" target="_blank">。NET下载页面</a>并下载。NET Core SDK for版，可用于Window、Linux和Mac。</p><p id="4730" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装完成后，如果您想验证SDK是否已安装，请运行以下命令。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="1576" class="km kn iq lp b gy lt lu l lv lw">dotnet --list-sdks</span></pre><p id="4e3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该会看到列出的<strong class="jp ir"> 2.2.100 </strong>。如果你像我一样，你也可能会看到一些预览版本，这将是很好的卸载。</p><p id="c992" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您使用的是Visual Studio，请确保您的版本至少为15.9。如果没有，可以从<a class="ae kl" href="https://docs.microsoft.com/en-us/visualstudio/releasenotes/vs2017-relnotes" rel="noopener ugc nofollow" target="_blank">这里</a>下载更新。</p><h2 id="e6da" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">项目文件更改</h2><p id="0874" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">右键点击项目并选择<strong class="jp ir">编辑项目名称. csproj </strong>。</p><figure class="lk ll lm ln gt ly gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/f27cde037341ab285755dc39f0ab71fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/0*OAcDSzGdr_w0hzZp.png"/></div></figure><p id="76f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<strong class="jp ir"> TargetFramework </strong>改为<strong class="jp ir"> netcoreapp2.2 </strong>。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="8fae" class="km kn iq lp b gy lt lu l lv lw">Before:<br/>&lt;TargetFramework&gt;netcoreapp2.1&lt;/TargetFramework&gt;<br/>After:<br/>&lt;TargetFramework&gt;netcoreapp2.2&lt;/TargetFramework&gt;</span></pre><p id="6134" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将任何微软软件包的版本更新到<strong class="jp ir"> 2.2.x </strong>以下是一个例子。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="f878" class="km kn iq lp b gy lt lu l lv lw">Before:<br/>&lt;PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.1.1" PrivateAssets="All" /&gt;<br/><br/>After:<br/>&lt;PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.2.0" PrivateAssets="All" /&gt;</span></pre><p id="aeac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想使用新的IIS进程内宿主模型，您还需要将下面一行添加到属性组中。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="a1a2" class="km kn iq lp b gy lt lu l lv lw">&lt;AspNetCoreHostingModel&gt;InProcess&lt;/AspNetCoreHostingModel&gt;</span></pre><p id="b88b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是我的csproj全文，供参考。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="04e4" class="km kn iq lp b gy lt lu l lv lw">&lt;Project Sdk="Microsoft.NET.Sdk.Web"&gt;<br/><br/>  &lt;PropertyGroup&gt;<br/>    &lt;TargetFramework&gt;netcoreapp2.2&lt;/TargetFramework&gt;<br/>    &lt;AspNetCoreHostingModel&gt;InProcess&lt;/AspNetCoreHostingModel&gt;<br/>    &lt;UserSecretsId&gt;aspnet-Contacts-cd2c7b27-e79c-43c7-b3ef-1ecb04374b70&lt;/UserSecretsId&gt;<br/>  &lt;/PropertyGroup&gt;<br/><br/>  &lt;ItemGroup&gt;<br/>    &lt;PackageReference Include="Microsoft.AspNetCore.App" /&gt;<br/>    &lt;PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.2.0" PrivateAssets="All" /&gt;<br/>    &lt;PackageReference Include="Swashbuckle.AspNetCore" Version="4.0.1" /&gt;<br/>  &lt;/ItemGroup&gt;<br/><br/>&lt;/Project&gt;</span></pre><h2 id="5601" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">启动更改</h2><p id="0de2" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">在<strong class="jp ir"> Startup.cs </strong>中，更新兼容版本以启用新的2.2功能。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="ab42" class="km kn iq lp b gy lt lu l lv lw">Before:<br/>services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);<br/><br/>After:<br/>services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span></pre><p id="a8a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">包扎</p><p id="cc3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与迁移到2.1一样，迁移到2.2也非常容易。请务必查看官方迁移指南,了解本项目未涉及的更多细节。</p><p id="21bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终状态的代码可以在<a class="ae kl" href="https://github.com/elanderson/ASP.NET-Core-Basics/tree/f8cb4b7f24feed9120e68bcd7d60b0ca25734ed3" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="c6d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mi">原载于</em><a class="ae kl" href="https://elanderson.net/2018/12/migration-from-asp-net-core-2-1-to-2-2/" rel="noopener ugc nofollow" target="_blank"><em class="mi"/></a><em class="mi">。</em></p></div></div>    
</body>
</html>
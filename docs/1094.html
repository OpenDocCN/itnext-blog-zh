<html>
<head>
<title>Create mocks of your GraphQL schema with few lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用几行代码创建GraphQL模式的模型</h1>
<blockquote>原文：<a href="https://itnext.io/create-mocks-of-your-graphql-schema-with-few-lines-of-code-d368b0a2a359?source=collection_archive---------3-----------------------#2018-07-20">https://itnext.io/create-mocks-of-your-graphql-schema-with-few-lines-of-code-d368b0a2a359?source=collection_archive---------3-----------------------#2018-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/a9beed70463316b5bbe5bcb4b8ab43d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*9VyBulcxDuGbfz9FfcZMbg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/EasyGraphQL" rel="noopener ugc nofollow" target="_blank">https://github.com/EasyGraphQL</a></figcaption></figure><p id="37d8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在您可以使用<code class="fe kx ky kz la b"><a class="ae jy" href="https://www.npmjs.com/package/easygraphql-mock" rel="noopener ugc nofollow" target="_blank">easygraphql-mock</a></code>包创建GraphQL模式的模拟。要做到这一点，您只需要几行代码，让<code class="fe kx ky kz la b"><a class="ae jy" href="https://www.npmjs.com/package/easygraphql-mock" rel="noopener ugc nofollow" target="_blank">easygraphql-mock</a></code>来完成剩下的工作。它将模仿你所有的字段，以及<strong class="kb ir">嵌套</strong>类型。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="de33" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">怎么做！</h1><ul class=""><li id="ac8f" class="mg mh iq kb b kc mi kg mj kk mk ko ml ks mm kw mn mo mp mq bi translated">导入库<code class="fe kx ky kz la b">const mocker = require('easygraphql-mock')</code></li><li id="c33f" class="mg mh iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">将<code class="fe kx ky kz la b">GraphQL</code>模式读作<code class="fe kx ky kz la b">schemaCode</code></li><li id="16d6" class="mg mh iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">将<code class="fe kx ky kz la b">schemaCode</code>传递给上下文中的解析器。</li><li id="11c8" class="mg mh iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">将<code class="fe kx ky kz la b">schemaCode</code>传递给模仿器<code class="fe kx ky kz la b">const mock = mocker(schemaCode)</code>或<code class="fe kx ky kz la b">const mock = mocker(schemaCode, { typeName: { typeField: value } }</code> <strong class="kb ir"> TypeName </strong>将是模式上设置的类型，而<strong class="kb ir"> TypeField </strong>是类型上的字段。</li><li id="9fe7" class="mg mh iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">在解析器回路上<code class="fe kx ky kz la b">mock.typeName</code></li></ul></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="65ad" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">示例:</h1><h2 id="f627" class="mw lj iq bd lk mx my dn lo mz na dp ls kk nb nc lw ko nd ne ma ks nf ng me nh bi translated">GraphQL模式:</h2><pre class="ni nj nk nl gt nm la nn no aw np bi"><span id="5ef8" class="mw lj iq la b gy nq nr l ns nt">type User {  <br/>  email: String!  <br/>  username: String!  <br/>  fullName: String!<br/>}</span><span id="79bf" class="mw lj iq la b gy nu nr l ns nt">type Query {<br/>  getUserByUsername(username: String!): User<br/>} </span></pre><h2 id="db52" class="mw lj iq bd lk mx my dn lo mz na dp ls kk nb nc lw ko nd ne ma ks nf ng me nh bi translated">App.js</h2><pre class="ni nj nk nl gt nm la nn no aw np bi"><span id="cd37" class="mw lj iq la b gy nq nr l ns nt">'use strict' </span><span id="74e4" class="mw lj iq la b gy nu nr l ns nt">const express = require('express')<br/>const { buildSchema } = require('graphql')<br/>const graphqlHTTP = require('express-graphql')<br/>const bodyParser = require('body-parser')<br/>const fs = require('fs')<br/>const path = require('path')<br/>const root = require('./schema/resolvers') </span><span id="13e6" class="mw lj iq la b gy nu nr l ns nt">const app = express() </span><span id="61e7" class="mw lj iq la b gy nu nr l ns nt">app.set('port', 7000)<br/>app.use(bodyParser.json({limit:'10mb'}))<br/>app.use(bodyParser.urlencoded({ extended: true })) </span><span id="c1ad" class="mw lj iq la b gy nu nr l ns nt">const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')</span><span id="234f" class="mw lj iq la b gy nu nr l ns nt">const schema = buildSchema(schemaCode) <br/>app.use('/graphql', (req, res) =&gt; {  <br/>  graphqlHTTP({    <br/>    schema,    <br/>    rootValue: root,    <br/>    graphiql: true,    <br/>    context: { schemaCode }  <br/>  })(req, res)<br/>}) </span><span id="ccd2" class="mw lj iq la b gy nu nr l ns nt">const server = app.listen(app.get('port'), () =&gt; {     <br/>  console.log(`Server running -&gt; PORT ${server.address().port}`)<br/>}) </span><span id="017c" class="mw lj iq la b gy nu nr l ns nt">module.exports = app</span></pre><h2 id="99f9" class="mw lj iq bd lk mx my dn lo mz na dp ls kk nb nc lw ko nd ne ma ks nf ng me nh bi translated">分解器</h2><pre class="ni nj nk nl gt nm la nn no aw np bi"><span id="85a3" class="mw lj iq la b gy nq nr l ns nt">'use strict' </span><span id="0662" class="mw lj iq la b gy nu nr l ns nt">const mocker = require('easygraphql-mock') </span><span id="e241" class="mw lj iq la b gy nu nr l ns nt">const resolver = {  <br/>  getUserByUsername: async (args, { schemaCode }) =&gt; {    <br/>    const mock = mocker(schemaCode, {      <br/>      User: {        <br/>        username: args.username      <br/>      }    <br/>    })     <br/>   <br/>    return mock.User  <br/>  }<br/>} </span><span id="5a98" class="mw lj iq la b gy nu nr l ns nt">module.exports = resolver</span></pre><p id="afce" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在这种情况下，我们希望将用户名值设置为与参数中的值相同。</p><ul class=""><li id="9bfd" class="mg mh iq kb b kc kd kg kh kk nv ko nw ks nx kw mn mo mp mq bi translated"><strong class="kb ir"> TypeName = </strong>用户</li><li id="bf17" class="mg mh iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">类型字段 =用户名</li></ul><h2 id="faf0" class="mw lj iq bd lk mx my dn lo mz na dp ls kk nb nc lw ko nd ne ma ks nf ng me nh bi translated">结果</h2><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi ny"><img src="../Images/4ea266a506b5d0a7e988203c1c7a1089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zeR7BECImSRpKJjkpix_Ow.png"/></div></div></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="12cc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">完整演示:</strong>T24】https://github.com/EasyGraphQL/easygraphql-mock-demo</p><p id="27d6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> Npm包:</strong><a class="ae jy" href="https://www.npmjs.com/package/easygraphql-mock" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/easygraphql-mock</a></p></div></div>    
</body>
</html>
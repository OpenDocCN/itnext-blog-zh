<html>
<head>
<title>Flutter save data to local storage with Hive NoSQL database package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤振保存数据到本地存储与蜂房NoSQL数据库包</h1>
<blockquote>原文：<a href="https://itnext.io/flutter-save-data-to-local-storage-with-hive-nosql-database-package-8a0de834f313?source=collection_archive---------2-----------------------#2021-09-26">https://itnext.io/flutter-save-data-to-local-storage-with-hive-nosql-database-package-8a0de834f313?source=collection_archive---------2-----------------------#2021-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/8120a81aa3a081ec9637ea679a595505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6pmGJjWu4ItzaCGVAWCzQ.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="0dfa" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">Hive是一个用纯Dart编写的轻量级、速度极快的键值数据库。</h2></div><h1 id="183a" class="kt ku je bd kv kw kx ky kz la lb lc ld kk le kl lf kn lg ko lh kq li kr lj lk bi translated">动机</h1><figure class="lm ln lo lp gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ll"><img src="../Images/41662fa813a5e18d75bca57e896c4bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddCxCUU6u0YlOWFkNBDjcg.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">(越低越好)</figcaption></figure><h2 id="6760" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">什么是Hive？</h2><p id="2fef" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">Hive是一个先进的NoSQL本地数据库。</p><h2 id="69d0" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">盒子是什么？</h2><p id="f79e" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">存储在Hive中的所有数据都组织在盒子中。一个盒子可以比作SQL中的一个表，但是它没有结构，可以包含任何东西。</p><p id="0b0e" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">盒子也可以加密以存储敏感数据。</p><p id="3d68" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">Hive可以存储原始数据和对象。</p><h2 id="daaf" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">本文由两部分组成</h2><ol class=""><li id="8f86" class="nh ni je ml b mm mn mp mq lz nj mc nk mf nl nb nm nn no np bi translated">使用原语的基本CRUD操作</li><li id="2960" class="nh ni je ml b mm nq mp nr lz ns mc nt mf nu nb nm nn no np bi translated">如何使用对象</li></ol><figure class="lm ln lo lp gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c5f49004d345cfd0351c55cf16cf0f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sEY4h5Gp1Ha_00Sn0kFBHA.jpeg"/></div></div></figure><h2 id="cfc7" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">如何使用Hive？</h2><p id="9d56" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">向您的pubspec.yaml添加依赖项</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="c1d2" class="lu ku je nw b gy oa ob l oc od">dependencies:<br/>  hive: ^2.0.4<br/>  hive_flutter: ^1.1.0<br/><br/>dev_dependencies:<br/>  hive_generator: ^1.1.0<br/>  build_runner: ^2.1.2</span></pre><p id="ef5e" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">在main.dart中的<code class="fe oe of og nw b">runApp()</code>之前初始化配置单元</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="b8c8" class="lu ku je nw b gy oa ob l oc od"><strong class="nw jf">import 'package:hive_flutter/hive_flutter.dart';</strong></span><span id="b12f" class="lu ku je nw b gy oh ob l oc od">void main() <strong class="nw jf">async</strong> {<br/>  <strong class="nw jf">await</strong> <strong class="nw jf">Hive.initFlutter();</strong><br/>  runApp(MyApp());<br/>}</span></pre><h1 id="f009" class="kt ku je bd kv kw kx ky kz la lb lc ld kk le kl lf kn lg ko lh kq li kr lj lk bi translated">第1部分:使用原语的基本CRUD操作</h1><p id="1b98" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">首先，你需要打开你的盒子</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="9174" class="lu ku je nw b gy oa ob l oc od">await Hive.openBox('boxName');</span></pre><p id="2c8c" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">现在你可以做CRUD操作了</p><h2 id="c691" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">创造</h2><p id="0bfe" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">您可以使用键值对保存数据。</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="368c" class="lu ku je nw b gy oa ob l oc od"><strong class="nw jf">final box = Hive.box('boxName');</strong></span><span id="d019" class="lu ku je nw b gy oh ob l oc od">// key, value<br/>box.<strong class="nw jf">put</strong>('name', 'ehe');<br/>box.<strong class="nw jf">put</strong>('age', 25);<br/>box.<strong class="nw jf">put</strong>('friends', ['a','b','c']);<br/>box.<strong class="nw jf">put</strong>(123, 'evet');</span><span id="87c7" class="lu ku je nw b gy oh ob l oc od">// index, value<br/>box.<strong class="nw jf">putAt</strong>(35, 'value')</span><span id="7582" class="lu ku je nw b gy oh ob l oc od">box.<strong class="nw jf">putAll</strong>({'name': 'ehe', 'mail': 'ehe@ehe.com'});</span></pre><p id="8c15" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">您也可以不创建实例而直接获取</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="bfa0" class="lu ku je nw b gy oa ob l oc od">Hive.box('boxName').<strong class="nw jf">put</strong>(<!-- -->'name', 'ehe'<!-- -->);</span></pre><h2 id="896a" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">阅读</h2><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="8d99" class="lu ku je nw b gy oa ob l oc od">// if key does not exists return null<br/>String name = box.<strong class="nw jf">get</strong>('name');</span><span id="b573" class="lu ku je nw b gy oh ob l oc od">// if key does not exists return defaultValue<br/>double height = box.<strong class="nw jf">get</strong>('height', defaultValue: 35);</span><span id="223d" class="lu ku je nw b gy oh ob l oc od">// get from <strong class="nw jf">index</strong><br/>box.<strong class="nw jf">get</strong>(35);</span></pre><h2 id="8702" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">更新</h2><p id="cefb" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">只需再次覆盖键上的值</p><h2 id="e0f6" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">删除</h2><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="f722" class="lu ku je nw b gy oa ob l oc od">// delete key<br/>box.<strong class="nw jf">delete</strong>('key');</span><span id="883b" class="lu ku je nw b gy oh ob l oc od">// delete keys<br/>box.<strong class="nw jf">deleteAll</strong>(['key1','key2']);</span><span id="cfbc" class="lu ku je nw b gy oh ob l oc od">// delete index<br/>box.<strong class="nw jf">deleteAt</strong>(35);</span><span id="bd34" class="lu ku je nw b gy oh ob l oc od">// delete whole box<br/>box.<strong class="nw jf">deleteFromDisk</strong>();</span></pre><h1 id="0936" class="kt ku je bd kv kw kx ky kz la lb lc ld kk le kl lf kn lg ko lh kq li kr lj lk bi translated">一些有用的方法</h1><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="af5e" class="lu ku je nw b gy oa ob l oc od">// if the box contains the key return true, else false<br/>final containsKey = box.<strong class="nw jf">containsKey</strong>('key');</span><span id="3842" class="lu ku je nw b gy oh ob l oc od">// get all keys in box<br/>final keys = box.<strong class="nw jf">keys</strong>;</span><span id="d547" class="lu ku je nw b gy oh ob l oc od">// get all values in box<br/>final values = box.<strong class="nw jf">values</strong>;</span><span id="6ec6" class="lu ku je nw b gy oh ob l oc od">// clear box<br/>box.<strong class="nw jf">clear</strong>();</span></pre><p id="8137" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">还可以轻松的在Hive中存储对象！！</p><h1 id="296b" class="kt ku je bd kv kw kx ky kz la lb lc ld kk le kl lf kn lg ko lh kq li kr lj lk bi translated">第2部分:如何使用对象</h1><h2 id="0016" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">步骤1:创建你的对象</h2><figure class="lm ln lo lp gt iv"><div class="bz fp l di"><div class="oi oj l"/></div></figure><h2 id="ad06" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">步骤2:生成适配器</h2><p id="773b" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">在您的项目中运行此命令</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="dcd8" class="lu ku je nw b gy oa ob l oc od">flutter packages pub run build_runner build</span></pre><h2 id="e696" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">步骤3:注册适配器并打开一个盒子</h2><p id="c863" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">您需要注册所有想要使用的枚举和对象适配器</p><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="c870" class="lu ku je nw b gy oa ob l oc od">void main() <strong class="nw jf">async</strong> {<br/>  <strong class="nw jf">await Hive.initFlutter();</strong></span><span id="d78b" class="lu ku je nw b gy oh ob l oc od">  ...</span><span id="aaf0" class="lu ku je nw b gy oh ob l oc od"><strong class="nw jf">  Hive.registerAdapter(PersonAdapter());<br/>  Hive.registerAdapter(HairColorAdapter());<br/>  Hive.registerAdapter(PetAdapter());</strong></span><span id="bb11" class="lu ku je nw b gy oh ob l oc od"><strong class="nw jf">  await Hive.openBox&lt;Person&gt;('personList');</strong></span><span id="5535" class="lu ku je nw b gy oh ob l oc od">  runApp(MyApp());<br/>}</span></pre><h2 id="087e" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">步骤4:进行CRUD操作</h2><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="6013" class="lu ku je nw b gy oa ob l oc od"><strong class="nw jf">final box = Hive.box&lt;Person&gt;('personList');</strong></span><span id="334d" class="lu ku je nw b gy oh ob l oc od">// You can also use auto-increment keys if you like. This is very useful for storing and accessing multiple objects. You can use a Box like a list.</span><span id="5f8b" class="lu ku je nw b gy oh ob l oc od">do// <strong class="nw jf">Create</strong><br/>box.<strong class="nw jf">add</strong>(person);</span><span id="e012" class="lu ku je nw b gy oh ob l oc od">// <strong class="nw jf">Read</strong><br/>final person = box.<strong class="nw jf">getAt</strong>(0);</span><span id="2ffb" class="lu ku je nw b gy oh ob l oc od">// <strong class="nw jf">Update</strong><br/>person.name = 'newName';<br/>person.<strong class="nw jf">save</strong>();</span><span id="6ba7" class="lu ku je nw b gy oh ob l oc od">// <strong class="nw jf">Delete</strong><br/>box.<strong class="nw jf">deleteAt</strong>(0);</span></pre><h2 id="4c9d" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">您还可以收听更改和即时更新</h2><pre class="lm ln lo lp gt nv nw nx ny aw nz bi"><span id="8c66" class="lu ku je nw b gy oa ob l oc od"><strong class="nw jf">// ValueListenable<br/>ValueListenableBuilder</strong>(<br/>  valueListenable: <strong class="nw jf">box.listenable(),</strong><br/>    builder: (context, Box&lt;Person&gt; box, _) {<br/>      return ListView.builder(itemBuilder: (_, index) {<br/>        return Text(box.getAt(index)!.name);<br/>      }<br/>    );<br/>  },<br/>),</span><span id="ede5" class="lu ku je nw b gy oh ob l oc od">// <strong class="nw jf">Stream</strong><br/>box.<strong class="nw jf">watch</strong>().<strong class="nw jf">listen</strong>((event) =&gt; print(event));</span></pre></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h2 id="306b" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">如果您想看一些代码示例</h2><p id="edbc" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">我试着在一次中使用它，所以它看起来有点复杂，但是不要担心你能做到！</p><div class="is it gp gr iu or"><a href="https://github.com/iisprey/hive_example" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd jf gy z fp ow fr fs ox fu fw jd bi translated">GitHub - iisprey/hive_example</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">一个新的颤振项目。这个项目是颤振应用的起点。一些帮助您入门的资源…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">github.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ja or"/></div></div></a></div><h2 id="5a4a" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">此外，Hive还有很多我没有提到的特性</h2><p id="6761" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">如果您感兴趣，请查看文档以获取更多信息</p><div class="is it gp gr iu or"><a href="https://docs.hivedb.dev/" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd jf gy z fp ow fr fs ox fu fw jd bi translated">Hive文档</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">描述</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">docs.hivedb.dev</p></div></div></div></a></div></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h2 id="264d" class="lu ku je bd kv lv lw dn kz lx ly dp ld lz ma mb lf mc md me lh mf mg mh lj mi bi translated">感谢您的阅读！</h2><p id="47b7" class="pw-post-body-paragraph mj mk je ml b mm mn kf mo mp mq ki mr lz ms mt mu mc mv mw mx mf my mz na nb im bi translated">我试图尽可能简单地解释它，我希望你喜欢它。</p><p id="1df6" class="pw-post-body-paragraph mj mk je ml b mm nc kf mo mp nd ki mr lz ne mt mu mc nf mw mx mf ng mz na nb im bi translated">如果你喜欢这篇文章，请点击👏按钮(你知道你可以升到50吗？)</p></div></div>    
</body>
</html>
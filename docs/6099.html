<html>
<head>
<title>Getting started with Drayman</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Drayman入门</h1>
<blockquote>原文：<a href="https://itnext.io/getting-started-with-drayman-ce355ecfe22a?source=collection_archive---------1-----------------------#2021-08-18">https://itnext.io/getting-started-with-drayman-ce355ecfe22a?source=collection_archive---------1-----------------------#2021-08-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dd943fef53da7b1ae46301b4a98cc9ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*klb0_C9cOQRnOk3dfwiK-g.png"/></div></div></figure><p id="392a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="http://www.drayman.io/" rel="noopener ugc nofollow" target="_blank"> Drayman </a>是一个服务器端组件框架，允许你在一个脚本中使用任何可用的HTML元素、web组件或自定义Drayman第三方组件以及服务器端代码。</p><p id="57ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Drayman，浏览器只呈现用户应该看到的内容——所有的逻辑和计算都发生在服务器端，UI使用JSX语法编写。</p><p id="174f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">展示Drayman能力的最好方式是用它创造一些东西。所以让我们开始吧。</p><h1 id="3304" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">文件查看器组件</h1><p id="0fd2" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">让我们构建一个允许用户从文件系统中选择一个文件并查看其内容的组件。</p><p id="88d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，你需要安装Drayman。这可以通过运行以下命令来完成:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="9d98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该网站将在<a class="ae kw" href="http://localhost:3033/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3033 </a>上提供。</p><p id="973b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你不想安装任何东西，你可以通过访问<a class="ae kw" href="http://new.drayman.io/" rel="noopener ugc nofollow" target="_blank"> new.drayman.io </a>来尝试CodeSandbox中的Drayman。</p><h2 id="be8b" class="mg ky iq bd kz mh mi dn ld mj mk dp lh kj ml mm ll kn mn mo lp kr mp mq lt mr bi translated">初始组件模板</h2><p id="1e70" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">转到<code class="fe ms mt mu mv b">src/components/home.tsx</code>并用以下代码替换其内容:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="1675" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您将看到我们组件的初始框架。此外,<code class="fe ms mt mu mv b">&lt;select&gt;</code>将用于显示可用文件,<code class="fe ms mt mu mv b">&lt;pre&gt;</code>将显示所选文件的内容。</p><h2 id="f9e3" class="mg ky iq bd kz mh mi dn ld mj mk dp lh kj ml mm ll kn mn mo lp kr mp mq lt mr bi translated">用选项填充选择</h2><p id="8edb" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">因为Drayman运行的是组件服务器端，所以我们可以使用任何Node.js库。在我们的例子中，我们将使用<code class="fe ms mt mu mv b">fs</code>模块。</p><p id="596b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从项目根目录读取文件名，并用它们填充<code class="fe ms mt mu mv b">&lt;select&gt;</code>选项:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="8137" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们的组件只显示一些没有任何交互性的元素。我们下一步将添加它。</p><h2 id="1e51" class="mg ky iq bd kz mh mi dn ld mj mk dp lh kj ml mm ll kn mn mo lp kr mp mq lt mr bi translated">对用户操作做出反应</h2><p id="efe3" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们需要记住用户选择了哪个文件来显示其内容。这可以通过使用<code class="fe ms mt mu mv b">onchange</code>事件属性并附加一个将在服务器端执行的<a class="ae kw" href="http://www.drayman.io/docs/components-in-depth/handling-events" rel="noopener ugc nofollow" target="_blank">函数来完成。我们还需要给每个<code class="fe ms mt mu mv b">option</code>添加<code class="fe ms mt mu mv b">value</code>属性，这样<code class="fe ms mt mu mv b">select</code>就会知道选择了哪个选项。</a></p><p id="fb5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们在<code class="fe ms mt mu mv b">&lt;pre&gt;</code>标签中添加<code class="fe ms mt mu mv b">fs.readFile</code>函数，这样Drayman将在重新渲染时读取文件内容。我们不会显示<code class="fe ms mt mu mv b">pre</code>直到一个文件被实际选中:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="2b9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您从下拉列表中进行选择，您将会看到页面上什么也没有发生——文件内容不会出现。这是因为使用Drayman时，您必须严格告知组件何时需要重新渲染。可以通过使用特殊的<a class="ae kw" href="http://www.drayman.io/docs/components-in-depth/helpers/introduction" rel="noopener ugc nofollow" target="_blank">辅助函数</a> <code class="fe ms mt mu mv b">forceUpdate</code>来完成。</p><p id="8bb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存所选文件后，导入并添加到<code class="fe ms mt mu mv b">onchange</code>事件中:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="ef71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们的组件完成了，文件内容显示在select:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/bea0da930a8f4ebd918c56b21179e0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*-eujpP1gvvJpR3LAopNXMA.gif"/></div></figure><h1 id="4e40" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="a5a8" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们构建了一个组件，它在一个脚本中结合了服务器端逻辑和客户端视图。</p><p id="5d60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您对此感兴趣，请访问<a class="ae kw" href="http://www.drayman.io/" rel="noopener ugc nofollow" target="_blank">官方文档</a>深入了解Drayman框架！</p></div></div>    
</body>
</html>
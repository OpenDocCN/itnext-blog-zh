# Solidity 中的单向支付渠道

> 原文：<https://itnext.io/uni-directional-payment-channels-in-solidity-1aab8cc7eda9?source=collection_archive---------2----------------------->

![](img/a0a6cd1739177d777d516ad50adbe7fc.png)

源 Unsplash | [链接](https://unsplash.com/photos/pKeF6Tt3c08)

# 介绍

在某些业务、市场或行业中，存在支付不能双向发送的场景，这意味着支付只能从账户 ***A*** 到 ***B*** 发送，而不能从账户*到***【A】***发送，这就是所谓的 ***单向支付通道。****

# *可靠性实现*

## *创建合同*

*在这一步中，我们将创建一个简单的智能契约，添加一些依赖项来安全地签署交易。这是为了防止 [**重放攻击**](https://en.wikipedia.org/wiki/Replay_attack) 和 [**重入攻击。**](https://hackernoon.com/hack-solidity-reentrancy-attack)*

*这些依赖来自于 [OpenZeppelin contracts](https://github.com/OpenZeppelin/openzeppelin-contracts) ，这是一个用于安全智能合约开发的便利库。*

## *签署付款*

*现在，我们将创建一些从发送方签署付款的功能。*

*我们已经创建了 4 个不同的函数，用于散列和将散列转换成 *EthSignedMessageHash。*请注意，我们使用私有函数调用来重复利用代码，这样可以减少气体的使用。*

## *验证哈希*

*为了从接收方验证散列，我们需要创建一个反函数来“取消”事务。在这种情况下，当我们恢复符号时，我们应该获得发件人地址作为结果，这样我们就可以验证金额已经从发件人地址发出。*

## *交易*

*一旦我们声明了这些函数，以便从一方到另一方签署和恢复信息，我们就可以安全地进行交易。*

## *完整代码*

*这是完整合同的样子*

# *结论*

*从开发者的角度来看，区块链技术是真正具有挑战性和有趣的东西。就我而言，因为这让我觉得我在构建经济体系的一小部分。*

*如果你在这里，我不得不说谢谢，因为你有足够的耐心阅读代码和这篇小文章，我希望你发现它很有见地，或者至少很有用。*

*让我们继续努力建设下一个经济体😉。*
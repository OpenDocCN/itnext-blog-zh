# Android 12 闪屏 API 综合指南

> 原文：<https://itnext.io/a-comprehensive-guide-to-android-12s-splash-screen-api-644609c811fa?source=collection_archive---------0----------------------->

![](img/f0bfd07e683c18a19243246ce20ca54f.png)

Gmail 动画启动画面

几年来，Android 开发者总是求助于使用窗口背景、活动或片段作为他们的闪屏。在你的主题中使用 android:windowBackground 属性是 android 中闪屏的基本形式，你可以在应用程序的窗口背景上放置一个图标，在应用程序加载后，它会被内容覆盖。但是这缺乏动画启动画面的灵活性，而且很难确保你的可绘制性在所有的 API 级别上都能适当缩放。

对此的自然解决方案是使用一个活动或片段来显示您的动画屏幕，然后在完成后导航离开。这给了你所有你需要的灵活性，但它仍然会显示闪屏，即使当应用程序[热启动](https://developer.android.com/topic/performance/vitals/launch-time#hot)。这意味着即使之前已经创建了内容活动，它仍然会显示闪屏，这可能会让用户感到厌烦。

## API 级来了

Android 12 出现了，增加了新的闪屏 API。默认情况下，Android 12 上的所有应用程序都会显示一个闪屏，应用程序图标位于中央。听起来很棒，直到你意识到，如果你使用一个活动或片段来显示闪屏，那么你会首先显示默认的 Android 12 闪屏，然后是你的自定义闪屏。现在你有两个看起来完全不同的闪屏。设计中更多的不一致性和对用户更多的干扰。现在你需要添加对 Android 12 闪屏的支持，这样它会有一个更一致的外观，对你的用户来说更少打扰。

该 API 通过 AnimatedVectorDrawable 或 AnimationDrawable 支持动画图标，并向后兼容旧的 API 级别。拿起一杯咖啡，跟着做，最后你会看到一个闪屏，跟随设备主题和动画。

![](img/dec456ac89682b83175838ee41e331e5.png)

# 设置

在使用这个 API 之前，你需要在你的应用中为新的 API 设置一些东西。我们将利用这个 API 的向后兼容性，甚至为旧的 Android 版本提供闪屏。

1.  将应用程序模块 build.gradle 内的 compileSdk 更改为 31，并添加闪屏 API 依赖项。为了向后兼容，我们将使用 compat 版本。

2.创建两个名为 splash_theme.xml 的文件，一个在 values 目录中，另一个在 values-night 中。我们为 values 和 values-night 创建了两个文件，因此我们可以定制主题，以匹配用户设备的黑暗模式或光明模式主题。我们还为这两个文件提供了相同的名称，这样我们可以方便地组织它们以备将来更改。

> 提示:当您右键单击 values 目录并选择创建一个新的 values 资源文件时，您将使用默认的 Values 目录保存第一个文件，对于下一个文件，只需在目录名字段中键入 values-night，即可将另一个文件保存到 values-night 目录。这只有在你的项目视图设置为 Android 时才会显示。

![](img/aa5b5fcd145052d70a29ea78a813582d.png)![](img/eb91aadd5e18c755627d2275080a11f5.png)

创建 splash_theme.xml 文件

3.现在我们在两个文件中为黑暗和光明模式场景创建闪屏主题。这个主题将被命名为*主题。SplashThemeName* ，它将继承自 *Theme.SplashScreen.* 你的文件现在应该是这样的:

内容分类:

*   windowSplashScreenBackground —这是整个闪屏的背景颜色。它类似于窗口背景
*   窗口闪屏动画图标—这是闪屏图标所在的位置。它是居中的，边界是圆形的(是的，有边界来阻止你设置半个屏幕的图标)。我已经设置了这个来获取圆形启动器图标，应该可以在旧的 API 级别上工作。避免使用大于 108dp 的图标，否则会被剪掉。
*   windowsplashscreenemationduration—这是动画图标的持续时间。它实际上不会影响图标的动画，因为它可以由 AnimatedVectorDrawable 设置，但它对于定制图标的退出动画很有用。稍后会有更多相关内容
*   postplasshscreentheme—这用于定义闪屏结束后您想要使用的实际应用程序主题。你应该在这里设置你的默认应用程序主题。
*   状态栏和导航栏属性是为了确保在启动应用程序时应用一致的主题，因为您的实际主题尚未使用，保留默认值可能会导致 API 级别 30 及以下的状态栏和导航栏上出现默认的黑条。我们希望导航条和状态栏与 windowSplashScreenBackground 相匹配，以获得一致的外观。

确保为闪屏主题的暗模式和亮模式设置了所需的值。

4.打开您的清单文件，将您的应用程序标记的 android:theme 属性设置为您刚才创建的闪屏主题。那就:@style: *主题。SplashThemeName*

> 注意:如果你的包含启动器意图的活动标签(你从启动器进入的活动)已经设置了 android:theme 属性，那么请删除它。会导致应用崩溃。默认的 Android Studio 模板总是将这个属性添加到条目活动中，所以请注意这一点，这可能会让您免于发现自己做错了什么。

5.现在，在您的入口活动(从启动器进入的活动)中，您需要在 *super.onCreate()* 的正下方和 *setContentView()* 之前，在 *onCreate* 方法中调用 *installSplashScreen()* 。查看该文件:

[](https://github.com/racka98/Splash-Screen-API-Demo/blob/main/app/src/main/java/work/example/splishsplash/ui/main/MainActivity.kt) [## 主机架上的闪屏 API Demo/main activity . kt a98/闪屏 API Demo

### 闪屏 API 的演示。在 GitHub 上创建一个帐户，为 rack 98/闪屏 API-Demo 开发做贡献。

github.com](https://github.com/racka98/Splash-Screen-API-Demo/blob/main/app/src/main/java/work/example/splishsplash/ui/main/MainActivity.kt) 

你暂时完成了。您已经成功地为 Android 12 和旧版本的 Android 添加了 Splash。

这个图标不应该超过 108dp，否则会被剪掉。图标可以是 png，jpg，webp 或 drawable。在目前的状态下，我们不能在 windowSplashScreenBackground 上添加 AnimatedVectorDrawable 或 AnimationDrawable，因为它只能在 Android 12 上工作，对于其他所有较低的 API 级别都无效。只有 Android 12+可以利用动画图标。如果您为所有 API 级别设置它，它将在较低的 API 级别显示为空白。我们不想这样。现在，我们将进入本指南的下一部分，我们将为 Android 12 创建动画图标，并进行适当的检查，以保持对旧版本 Android 的支持。

# 动画启动画面图标

现在我们来看这本指南有趣的部分。我将详细介绍制作用于动画图标的 AnimatedVectorDrawables 的过程。我们将制作两个动画启动画面。一个只是使用简单的图标缩放，就像 Google Duo 和一些更新的 Google 应用程序中使用的那样。

![](img/dcdef1ae8eabe13c6ed954402c03345f.png)![](img/928ab0f10cbfcac846e6bed75bcaf3b3.png)

动画启动画面

## 先决条件

*   Android 12+测试设备或仿真器
*   对 ObjectAnimator 的基本理解
*   能够使用矢量图形软件，如 Figma

## 所以它开始了…

上一节中的 splash 主题使用了一个普通的静态图标，一旦应用程序的内容被加载，这个图标就会消失。这是基本的，并没有给我们视觉上的触动，使你的应用程序更令人愉快。你想给你的闪屏增加一点个性。 [AnimatedVectorDrawables](https://developer.android.com/reference/android/graphics/drawable/AnimatedVectorDrawable) 利用 ObjectAnimator API 来操纵可绘制对象，实现你想要的效果。我们也可以使用 [AnimationDrawable](https://developer.android.com/reference/android/graphics/drawable/AnimationDrawable) ，但是在我看来这不够灵活，并且需要大量的工作来制作一个复杂的动画。

手动编写 AnimatedVectorDrawables 也是非常乏味的，这就是为什么我们将使用一个叫做[的工具，它是由才华横溢的](https://shapeshifter.design/)[亚历克斯·洛克伍德](https://medium.com/u/f61fb1c467cd?source=post_page-----644609c811fa--------------------------------)制作的。它将使我们能够在易于访问的图形用户界面的帮助下制作动画。我们开始吧！

## 1.准备好你的资产

这可以由你团队中的设计师或者你自己来完成。我们将在本指南中使用 Figma 来操作我们的资产。

假设你已经有了你想要的动画图标。您需要让它遵守一些规则，这样它才能按预期工作。没有文件详细说明这些(甚至在材料设计网站上)，但我已经手动测试了这些，以获得完美的理想图标设置；

*   您的图标的宽度和高度不得超过 108dp。请调整图标大小以符合此限制。如果你的图标超过了这个尺寸，如果你没有在 xml 中正确地调整它的大小，它很可能会被剪掉。因为我们将使用 XML drawables，如果您不能在 108dp 内缩小，绝对最大值应该是 200dp。如你所知，大于 200dp 的 drawables 会影响用户设备上的渲染速度。本指南中使用的图标可在此处找到[。](https://drive.google.com/file/d/1buYLJtryXckjvaLzxEZ9ylN7Y_NcVKWa/view?usp=sharing)

![](img/6512264bc97a269938d239e51d3e89ec.png)

我们的图标是完美的尺寸

*   尽可能避免使用 png、webp 或 jpeg 作为动画图标。在您的矢量图形软件或用户设备中调整大小时，这些图像会失去质量。你应该使用 SVG 或 XML 格式的图标，它们可以在不影响质量的情况下调整大小。Figma 不支持现成的 XML，所以我们将使用 SVG。
*   如果您想要制作动画的图标不是圆形或方形，如下所示。你需要用一个透明的背景层包围它，这样它仍然可以保持居中。如果不这样做，图标将被裁剪，因为它将被缩放以填充该 API 使用的动画图标点的圆形区域。

![](img/c5629939c2b95b914f0da056c9c77f52.png)![](img/a8c50ad83784a96c74debfbaca2b9ea5.png)

左(不)—右(做)

*   如果你想要一个背景，让你的图标填充到一些更新的谷歌应用程序中，那么你现在就需要提供它作为你图标的背景。试图添加它自己的内部变形将是一个挑战，因为路径数据将与你的图标不匹配。我提供的图标已经有这个背景层了。请参见下面动画图标的背景。

![](img/697c9a6121f5baead990aba70713ff10.png)

浅灰色背景的动画图标

## 2.将您的资产导入变形人

现在你已经准备好了所有的资产，让我们把它们导入[变形人](https://shapeshifter.design/)。

*   打开变形人网站，选择导入，然后选择 SVG 来选择提供的[图标](https://drive.google.com/file/d/1buYLJtryXckjvaLzxEZ9ylN7Y_NcVKWa/view?usp=sharing)或你自己的图标。

![](img/28102c80518cca8f124b883f0662f331.png)

*   你会立即注意到，我们的梯度现在丢失了，我们有一个黑色的路径，梯度曾经是。只需在左窗格的图层视图中选择此路径。现在看看右边窗格的填充颜色，现在把它改成 *#000* ，我们稍后会解决这个问题。这背后的原因是，ShapeShifter 目前不支持 SVG 或矢量绘图的梯度。

![](img/75ad6c7e84e76da92ca5051250fc9d43.png)![](img/4472c5df6f26fa129110149381404f99.png)![](img/d44fe7e9509a4b3df989dec62ec2e631.png)

首先解决渐变问题

*   现在我们必须将我们的层分组到它们各自的部分。群组有一些动画对路径不可用。例如，您不能缩放单独的路径，您必须将它们分组。下面是两张图片，分别显示了您可以为组和路径制作动画的所有属性(左为组，右为路径)。

![](img/98836be98476f2c4e74805f9b9706ea2.png)![](img/1124cabb7e954c81fb5df276562550a2.png)

组与路径动画

*   要创建一个组，点击左侧窗格顶部的*“添加层”*按钮。对于我们的图标，我们将有两个组。一个用于前景内容，一个用于背景内容。在背景中，我们将有浅灰色的背景，而在前景组中，我们将有实际的图标。见下图的分组排列。

![](img/cf0c6046dcecc1b1e7bbe94b6e89c246.png)

## 3.为你的图标制作动画

正如我所说，我们将使用缩放动画的图标，所以我们使用组。我们将修改 scaleX 和 scaleY 属性。

*   点击时间轴顶部的*动画:300 毫秒*，然后将动画时长设置为 500 毫秒。

![](img/fed425ab5cff4c1349214b286925e539.png)

*   点击背景组，然后在右窗格设置 scaleX 和 scaleY 为零，因为我们不希望这一层在开始时可见。现在对另一个前景组做同样的操作。

![](img/c749a9061379f60f77d70b7c823b6b88.png)

*   单击背景组，选择右窗格左上角的计时器图标，然后选择 scaleX。这将打开一个动画页面，您可以在其中设置动画属性。在这里，您可以设置开始时间，结束时间，动画插值，从值和到值。把这个背景层的 scaleY 设置成完全相同的值。

![](img/bb34604a2507075001b38d5265369b6e.png)

*   现在点击前景层，做和上面完全一样的事情，但是这次改变开始时间和结束时间，这样当背景动画即将结束时动画开始播放。这将给我们前景填充到背景层的效果。

![](img/bb34604a2507075001b38d5265369b6e.png)

你的时间线现在应该是这样的。当一个组被展开时，你可以点击动画来改变属性，你甚至可以拖动它们来改变开始和结束时间。您必须展开群组，才能在时间轴上看到动画元素。

![](img/23f6334161443c041e129efe0ad93a2f.png)

动画时间线

现在点击播放按钮，观看您的动画！你现在在想，“为什么这个动画从左上角而不是中心缩放？”矢量绘图工具在袖子下藏了一个小“陷阱”。矢量绘图中没有*重力*属性，所以默认以(0，0)坐标为原点。

![](img/e0966069aa372891c252a93c62f465a7.png)

这不是我们所期望的

那么，我们如何解决这个问题？有一个 pivot 属性可以帮助你指定绘图的原点。我们需要将它设置在画布的中间，这样我们的动画就可以从中心开始。

*   为了得到我们的中心轴值，我们需要点击左窗格中的整个向量，然后查看整个向量的宽度和高度。除以二，你就有了分别对应于宽度和高度的中心数据透视和数据透视。对于我们的 108dp 可拉伸性，它将是 54。
*   单击背景组和前景组，并在各自的字段中设置 pivotX 和 pivotY 值。

![](img/149fc4748272340ccc3685c768590815.png)![](img/4cc0ad95fcdfddc937afac3e27727a93.png)

> 注意:为每个组设置轴值，而不是为每个组的动画设置轴值

成功！我们现在有了一个可以正常缩放的动画。然后，我们可以点击导出，并选择动画矢量绘图有我们的动画文件。

![](img/5bdfc7ae31877e3c74fd4863a390916d.png)

动画完成

## 4.将图标添加到您的应用程序

我们的动画图标完成了。现在，让我们将它添加到我们的应用程序中，并使其正常工作。

*   将动画文件拖放到应用程序项目的 res/drawable 文件夹中。
*   还记得我们说过，我们失去了梯度，以后会这样。现在让我们修理它。要添加渐变，您需要一个带有渐变的图标的 xml 文件。不幸的是，Figma 不支持 Android Vector Drawables，为其添加支持的[插件](https://www.figma.com/community/file/810787081536104695/Android-Vector-Drawable)也不支持渐变。所以你必须使用类似 Adobe XD 或 Illustrator 的编辑器。但是我们有我们图标的 xml 版本，因为它是默认的 Android 应用程序图标。只需用图标 drawable xml 中的相应数据替换 path_2 数据。

*   现在转到你的 *values/splash_theme.xml* 。添加该行；

```
<item name="android:windowSplashScreenBrandingImage"></item>
```

*   然后点击品牌图片项目，点击 Android Studio 工具提示，选择*覆盖 values-31* 中的资源，这将给你一个添加了该属性的新文件。现在，您可以从常规的 *values/splash_theme.xml* 中删除品牌图像项目。对*值做同样的事情-night/splash_theme.xml*

![](img/5862818cf35fe5625518ff419a5b47c8.png)

单击此处的覆盖选项

*   现在，您可以将默认的可绘制文件更改为新的动画矢量可绘制文件的路径。你的两个新的 splash_theme 现在应该是这样的；

现在你有一个全功能的动画启动画面了！

如果你想将一个形状变形为另一个形状，你可以使用 pathData 值并根据它制作动画。使用这种方法的动画可以在[这里](https://drive.google.com/file/d/1656xEUzU7mFUEAAkrBlnJBmtAXYv5dJm/view?usp=sharing)找到。

*“我在本文开头看到一些关于品牌形象的东西，那是什么？”*

请允许我给你解释一下…

# 品牌形象

![](img/f2f1dbcb110010dd1c031a00d12a67d8.png)![](img/fa4b44b397383021f40489e1ff529fb3.png)

底部的品牌形象

您可以选择在初始屏幕的底部添加品牌图像。不幸的是，这仅支持 Android 12+,不支持旧的 API 级别。该图像需要具有以下属性…

*   宽度在 200dp 以内，高度在 80dp 以内。
*   避免使用 png、jpeg 或 webp。使用 SVG 或 Drawable XML。使用 png 可能会导致缩放图像时质量下降。
*   它应该是矩形纵横比。正方形和圆形很可能被切掉。

现在，您只需为您的品牌形象创建一个 SVG 或 Drawable XML，就可以开始了。

对于本指南，我为你提供了一个简单的“品牌”字样的图纸

![](img/748afae3c84d1179f6af6e9b6742b2eb.png)

```
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="180dp"
    android:height="64dp"
    android:viewportWidth="180"
    android:viewportHeight="64">
    <path
        android:fillColor="#21223A"
        android:pathData="M29.68 21.52h3.93v6.45l-0.24 2.1h0.24c0.36-0.62 0.92-1.15 1.68-1.59c0.76-0.44 1.7-0.66 2.82-0.66c0.94 0 1.83 0.2 2.67 0.6c0.86 0.38 1.61 0.92 2.25 1.62c0.66 0.68 1.18 1.5 1.56 2.46c0.38 0.96 0.57 2.01 0.57 3.15c0 1.14-0.19 2.19-0.57 3.15c-0.38 0.96-0.9 1.79-1.56 2.49c-0.64 0.68-1.39 1.22-2.25 1.62c-0.84 0.38-1.73 0.57-2.67 0.57c-1.12 0-2.06-0.22-2.82-0.66c-0.76-0.44-1.32-0.97-1.68-1.59h-0.24V43h-3.69V21.52zm7.62 18.33c0.52 0 1.01-0.1 1.47-0.3c0.48-0.2 0.9-0.48 1.26-0.84s0.65-0.8 0.87-1.32c0.22-0.52 0.33-1.1 0.33-1.74c0-0.64-0.11-1.22-0.33-1.74c-0.22-0.52-0.51-0.96-0.87-1.32c-0.36-0.36-0.78-0.64-1.26-0.84c-0.46-0.2-0.95-0.3-1.47-0.3s-1.02 0.1-1.5 0.3c-0.46 0.18-0.87 0.45-1.23 0.81c-0.36 0.36-0.65 0.8-0.87 1.32c-0.22 0.52-0.33 1.11-0.33 1.77c0 0.66 0.11 1.25 0.33 1.77c0.22 0.52 0.51 0.96 0.87 1.32c0.36 0.36 0.77 0.64 1.23 0.84c0.48 0.18 0.98 0.27 1.5 0.27zM47.38 28.3h3.69v2.04h0.24c0.18-0.36 0.42-0.69 0.72-0.99c0.3-0.3 0.63-0.56 0.99-0.78c0.38-0.22 0.78-0.39 1.2-0.51c0.44-0.12 0.87-0.18 1.29-0.18c0.52 0 0.96 0.05 1.32 0.15c0.38 0.1 0.7 0.23 0.96 0.39l-1.05 3.57c-0.24-0.12-0.51-0.21-0.81-0.27c-0.28-0.08-0.63-0.12-1.05-0.12c-0.54 0-1.03 0.11-1.47 0.33c-0.44 0.2-0.82 0.49-1.14 0.87c-0.3 0.38-0.54 0.83-0.72 1.35c-0.16 0.5-0.24 1.05-0.24 1.65V43h-3.93V28.3zm20.69 13.14h-0.24c-0.46 0.56-1.02 1.04-1.68 1.44c-0.64 0.4-1.47 0.6-2.5 0.6c-0.75 0-1.47-0.13-2.15-0.39c-0.66-0.24-1.24-0.58-1.74-1.02c-0.5-0.44-0.9-0.97-1.17-1.59c-0.28-0.62-0.42-1.3-0.42-2.04c0-0.76 0.15-1.44 0.45-2.04c0.3-0.62 0.72-1.15 1.26-1.59c0.54-0.44 1.17-0.77 1.89-0.99c0.74-0.24 1.54-0.36 2.4-0.36c0.96 0 1.75 0.08 2.37 0.24c0.62 0.14 1.13 0.29 1.53 0.45V33.7c0-0.78-0.31-1.42-0.93-1.92c-0.62-0.52-1.4-0.78-2.31-0.78c-1.36 0-2.51 0.57-3.45 1.71l-2.85-1.95c1.56-1.96 3.69-2.94 6.39-2.94c2.28 0 4.02 0.54 5.22 1.62c1.2 1.06 1.8 2.64 1.8 4.74V43h-3.87v-1.56zm0-4.41c-0.46-0.22-0.94-0.39-1.44-0.51c-0.48-0.14-1.01-0.21-1.6-0.21c-0.93 0-1.66 0.21-2.18 0.63c-0.5 0.4-0.75 0.9-0.75 1.5s0.24 1.08 0.72 1.44c0.5 0.36 1.07 0.54 1.7 0.54c0.53 0 1-0.09 1.45-0.27c0.44-0.2 0.8-0.45 1.1-0.75c0.33-0.32 0.57-0.68 0.73-1.08c0.18-0.42 0.27-0.85 0.27-1.29zm10.68-6.81H79c0.46-0.74 1.08-1.32 1.86-1.74c0.78-0.44 1.67-0.66 2.67-0.66c0.92 0 1.73 0.15 2.43 0.45c0.7 0.3 1.27 0.73 1.71 1.29c0.46 0.54 0.8 1.2 1.02 1.98c0.24 0.76 0.36 1.61 0.36 2.55V43h-3.93v-8.43c0-1.06-0.24-1.84-0.72-2.34c-0.46-0.52-1.14-0.78-2.04-0.78c-0.54 0-1.02 0.12-1.44 0.36c-0.4 0.22-0.75 0.53-1.05 0.93c-0.28 0.38-0.5 0.84-0.66 1.38c-0.14 0.52-0.2 1.08-0.2 1.68V43h-3.94V28.3h3.7v1.92zm24.49 11.01H103c-0.36 0.62-0.92 1.15-1.68 1.59c-0.76 0.44-1.7 0.66-2.82 0.66c-0.94 0-1.84-0.19-2.7-0.57c-0.84-0.4-1.6-0.94-2.25-1.62c-0.64-0.7-1.15-1.53-1.53-2.49c-0.38-0.96-0.57-2.01-0.57-3.15c0-1.14 0.19-2.19 0.57-3.15c0.38-0.96 0.89-1.78 1.53-2.46c0.66-0.7 1.4-1.24 2.25-1.62c0.86-0.4 1.76-0.6 2.7-0.6c1.12 0 2.06 0.22 2.82 0.66c0.76 0.44 1.32 0.97 1.68 1.59h0.24l-0.24-2.1v-6.45h3.93V43h-3.7v-1.77zm-3.93-1.38c0.52 0 1-0.09 1.47-0.27c0.48-0.2 0.9-0.48 1.26-0.84s0.65-0.8 0.87-1.32c0.22-0.52 0.33-1.11 0.33-1.77c0-0.66-0.11-1.25-0.33-1.77c-0.22-0.52-0.51-0.96-0.87-1.32c-0.36-0.36-0.78-0.63-1.26-0.81c-0.46-0.2-0.95-0.3-1.47-0.3s-1.02 0.1-1.5 0.3c-0.46 0.2-0.87 0.48-1.23 0.84s-0.65 0.8-0.87 1.32c-0.22 0.52-0.33 1.1-0.33 1.74c0 0.64 0.1 1.22 0.33 1.74c0.22 0.52 0.5 0.96 0.87 1.32c0.36 0.36 0.77 0.64 1.23 0.84c0.48 0.2 0.98 0.3 1.5 0.3zm13.16-13.68c-0.34 0-0.67-0.06-1-0.18c-0.3-0.14-0.56-0.32-0.8-0.54c-0.22-0.24-0.4-0.51-0.54-0.81c-0.12-0.3-0.18-0.63-0.18-0.99s0.06-0.69 0.18-0.99c0.14-0.3 0.32-0.56 0.54-0.78c0.24-0.24 0.5-0.42 0.8-0.54c0.33-0.14 0.66-0.21 1-0.21c0.7 0 1.3 0.25 1.8 0.75c0.5 0.48 0.75 1.07 0.75 1.77s-0.25 1.3-0.75 1.8c-0.5 0.48-1.1 0.72-1.8 0.72zM110.52 43V28.3h3.93V43h-3.93zm11.2-12.78h0.25c0.46-0.74 1.08-1.32 1.86-1.74c0.78-0.44 1.67-0.66 2.67-0.66c0.92 0 1.73 0.15 2.43 0.45c0.7 0.3 1.27 0.73 1.7 1.29c0.47 0.54 0.8 1.2 1.03 1.98c0.24 0.76 0.36 1.61 0.36 2.55V43h-3.93v-8.43c0-1.06-0.24-1.84-0.72-2.34c-0.46-0.52-1.14-0.78-2.04-0.78c-0.54 0-1.02 0.12-1.44 0.36c-0.4 0.22-0.75 0.53-1.05 0.93c-0.28 0.38-0.5 0.84-0.66 1.38c-0.14 0.52-0.21 1.08-0.21 1.68V43h-3.93V28.3h3.69v1.92zm20.18 19.74c-1.04 0-1.97-0.14-2.8-0.42c-0.8-0.26-1.5-0.61-2.1-1.05c-0.6-0.42-1.1-0.89-1.5-1.41c-0.4-0.52-0.68-1.04-0.86-1.56l3.75-1.5c0.28 0.78 0.74 1.38 1.38 1.8c0.64 0.44 1.35 0.66 2.13 0.66c1.24 0 2.22-0.39 2.94-1.17c0.72-0.76 1.08-1.83 1.08-3.21v-1.02h-0.24c-0.46 0.64-1.07 1.15-1.83 1.53c-0.74 0.36-1.62 0.54-2.64 0.54c-0.88 0-1.74-0.18-2.58-0.54c-0.82-0.36-1.55-0.87-2.2-1.53c-0.63-0.68-1.15-1.49-1.55-2.43c-0.4-0.94-0.6-1.99-0.6-3.15s0.2-2.21 0.6-3.15c0.4-0.96 0.92-1.77 1.56-2.43c0.64-0.68 1.37-1.2 2.19-1.56c0.84-0.36 1.7-0.54 2.58-0.54c1.02 0 1.9 0.19 2.64 0.57c0.76 0.36 1.37 0.86 1.83 1.5h0.24V28.3h3.75v13.65c0 1.24-0.2 2.35-0.57 3.33c-0.38 1-0.91 1.84-1.6 2.52c-0.67 0.7-1.5 1.23-2.45 1.59c-0.94 0.38-2 0.57-3.15 0.57zm0.15-10.35c0.48 0 0.95-0.09 1.4-0.27c0.49-0.18 0.9-0.44 1.27-0.78c0.36-0.36 0.65-0.79 0.87-1.29c0.22-0.52 0.33-1.11 0.33-1.77c0-0.66-0.11-1.25-0.33-1.77c-0.22-0.52-0.51-0.95-0.87-1.29c-0.36-0.36-0.78-0.63-1.26-0.81c-0.46-0.18-0.93-0.27-1.41-0.27c-0.48 0-0.95 0.09-1.41 0.27c-0.46 0.18-0.87 0.45-1.23 0.81c-0.36 0.36-0.65 0.8-0.87 1.32c-0.22 0.5-0.33 1.08-0.33 1.74c0 0.66 0.1 1.25 0.33 1.77c0.22 0.5 0.5 0.93 0.87 1.29c0.36 0.34 0.77 0.6 1.23 0.78c0.46 0.18 0.93 0.27 1.4 0.27z"/>
</vector>
```

这很酷，但是如果我们直接把这个图片添加到我们的闪屏主题中，它会变得可怕，看起来很糟糕。罪魁祸首再次是 VectorDrawable 中缺少 *gravity* 属性。但是这次我们使用 *<图层列表/ >* 来修复它，而不是使用*枢轴*来修复原点。

在 drawable 文件夹中创建一个新的 drawable 资源文件。我们现在可以使用*图层列表*将我们的 *branding_image_drawable* 放置在它的中心，因为*图层列表*有一个*重力*属性。这将解决我们的问题。

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:gravity="center"
        android:drawable="@drawable/branding_image_drawable"/>
</layer-list>
```

品牌推广的设置比我们以前做的要简单得多。只需将*branding _ image _ layer _ list*路径添加到我们添加到 splash_theme.xml 的 v31-values 中的 windowSplashScreen 属性

```
<item name="android:windowSplashScreenBrandingImage">@drawable/branding_image_layer_list</item>
```

瞧啊。您现在在底部有一个品牌形象。

# 我们能更进一步吗？

是的，我们可以！

*   我们可以让闪屏停留更长时间，直到我们的应用程序的内容被绘制出来
*   一旦我们的内容被加载，我们还可以定制闪屏的退出动画

但是文章已经很长了，我就不讨论这个话题了。你可以在这里阅读如何实现这个。

# 有一个陷阱！！

没有什么是完美的，这个 API 肯定有一些缺点，可能会让一些人感到讨厌。我将解释我遇到的三个主要问题。

1.  这个 API 允许您配置退出动画(在上一节提供的链接中有详细描述),但是当动画离开时，这可能会给用户带来明显的闪烁。我在 Pixel 4 上进行了测试，所以性能不是问题

2.另一个与退出动画相关的问题是它会破坏你的一些主题。如果你像文档中建议的那样使用*splash screen view . remove()*，那么你的状态栏图标将保持白色，即使应用程序的背景也是白色的，这使得很难看到它们。如果你在意细节，那么这会让你烦恼。请参见下图，顶部是手动移除视图时的样子，底部是不手动移除视图时的样子。

![](img/b46a36b2340d0401bdc22111eebb09c8.png)![](img/6eedd9840cfaef064d5d2be9914f0563.png)

3.这个 API 的向后兼容性非常有限，甚至不能动画图标，甚至不能添加品牌图像。对一些人来说，这可能是一个交易破坏者。所以很自然，你会想禁用闪屏，显示你自己的。但是现在这是不可能的。

目前唯一的解决方法是将以下属性设置为 transparent。这并不完美，但它至少禁用了 Android 12 中使用的默认图标，并允许您使用自己的活动或片段，因为它只会显示几毫秒。

```
<item name="windowSplashScreenBackground">@android:color/transparent</item>
<item name="windowSplashScreenAnimatedIcon">@android:color/transparent</item>
<item name="android:windowSplashScreenBrandingImage">@android:color/transparent<
```

结果:

![](img/b7115c046976102c31ce7d2395dfae19.png)

第 1 & 2 期可能只是一些 bug，因为这个库还在测试阶段。

如果你坚持到最后，那么恭喜你！目前就这些。

演示项目:[https://github.com/racka98/Splash-Screen-API-Demo](https://github.com/racka98/Splash-Screen-API-Demo)

thinkarchive App:【https://github.com/racka98/ThinkRchive 

请随意评论任何遗漏的细节或问题。你也可以在[推特](http://twitter.com/rackadev)上找到我。
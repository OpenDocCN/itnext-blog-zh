<html>
<head>
<title>Handling Kubernetes Custom Resources in Java using Fabric8 Kubernetes Client (Part 2 — Typed approach)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fabric8 Kubernetes客户端在Java中处理Kubernetes定制资源(第2部分—类型化方法)</h1>
<blockquote>原文：<a href="https://itnext.io/handling-kubernetes-custom-resources-in-java-using-fabric8-kubernetes-client-part-2-typed-cc0560d9af0d?source=collection_archive---------0-----------------------#2019-12-28">https://itnext.io/handling-kubernetes-custom-resources-in-java-using-fabric8-kubernetes-client-part-2-typed-cc0560d9af0d?source=collection_archive---------0-----------------------#2019-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6f8fc6c970d4c4727c35fbb5b811bc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*-58gIpXpeckgKtH8jJPUfA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/fabric8io/kubernetes-client" rel="noopener ugc nofollow" target="_blank"> Fabric8 Kubernetes Java客户端</a></figcaption></figure><p id="afe1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这篇博客是我之前关于使用<a class="ae jy" href="https://github.com/fabric8io/kubernetes-client" rel="noopener ugc nofollow" target="_blank"> Fabric8 Kubernetes客户端API </a>在Java中处理<a class="ae jy" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" rel="noopener ugc nofollow" target="_blank"> CustomResources </a>的博客的延续。你可以在这里找到这篇博客第一部分的链接。</p><p id="cbe7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在我之前的博客中，我谈到了以无类型的方式处理<a class="ae jy" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" rel="noopener ugc nofollow" target="_blank"> CustomResources </a>。但是有些人可能不喜欢它，他们希望有自己的模型来序列化/反序列化他们的<a class="ae jy" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" rel="noopener ugc nofollow" target="_blank"> CustomResources </a>。Fabric8 Kubernetes客户端也允许您这样做。</p><p id="70d8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">举个例子，对于这个博客，我将使用Kubernetes docs网站上提到的一个自定义资源:<a class="ae jy" href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#create-a-customresourcedefinition" rel="noopener ugc nofollow" target="_blank"> CronTab </a>。它的CustomResourceDefinition看起来是这样的:</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">克朗塔布·CRD清单</figcaption></figure><p id="3164" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">用此CRD构造的CustomResource如下所示:</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="71ad" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">为了使用类型化API，我们需要为这些定制资源提供POJOs。当然，对于真实世界的场景，这些POJO可能会变得更加复杂。但是为了这个博客，这些主要是:</p><ul class=""><li id="d6e0" class="ld le iq kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">CronTab.java</li></ul><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/crd/CronTab.java" rel="noopener ugc nofollow" target="_blank">CronTab.java</a></figcaption></figure><ul class=""><li id="6c59" class="ld le iq kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">CronTabSpec.java</li></ul><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/crd/CronTabSpec.java" rel="noopener ugc nofollow" target="_blank">CronTabSpec.java</a></figcaption></figure><ul class=""><li id="c1fe" class="ld le iq kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">CronTabStatus.java</li></ul><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://github.com/rohanKanojia/kubernetes-client-demo/blob/master/src/main/java/io/fabric8/crd/CronTabStatus.java" rel="noopener ugc nofollow" target="_blank">CronTabStatus.java</a></figcaption></figure><p id="2c79" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在我们有了所有的POJOs集，我们需要从当前的KubernetesClient实例中启动一个特殊的KubernetesClient对象实例。您不能使用提供的客户端实例来处理CustomResources，因为它不知道您拥有的CustomResource模型。您可以为特定的CustomResource构建一个特定的客户端对象。在这种情况下，我们会这样做:</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">正在初始化CronTab客户端</figcaption></figure><p id="5dd6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">创建、更新、删除自定义资源:</strong></p><p id="2eed" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">一旦我们有了一个特定于CronTab的客户端实例，我们就可以用它来完成KubernetesClient支持的所有操作，就好像它是一些Kubernetes资源一样。你可以看看下面的片段来获得更清晰的想法:</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">使用CronTab进行CRUD操作</figcaption></figure><p id="ea7f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">观看定制资源:</strong></p><p id="62ba" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">观察CustomResource也类似于现有的操作，只需要将自定义种类注册到KubernetesDeserializer，这样它就可以在反序列化观察事件时使用它。</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">用CronTab观察</figcaption></figure><p id="8693" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">当您运行它时，您将能够看到类似这样的事件:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lm"><img src="../Images/7ec97772ff336dd3a55edfb4eae9c73f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Alqr1X4vwwXMdIiiu88MRA.gif"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">Kubernetes腕表在行动</figcaption></figure><p id="b7cb" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这篇博客到此结束。希望您觉得这有用，如果您对我们的<a class="ae jy" href="https://gitter.im/fabric8io/kubernetes-client" rel="noopener ugc nofollow" target="_blank"> Gitter </a>频道有疑问，请随时联系我们。</p><p id="201f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">谢了。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Write better JavaScript, function composition with pipe and compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">写更好的JavaScript，用管道和compose函数复合</h1>
<blockquote>原文：<a href="https://itnext.io/write-better-javascript-function-composition-with-pipe-and-compose-93cc39ab16ee?source=collection_archive---------0-----------------------#2021-10-11">https://itnext.io/write-better-javascript-function-composition-with-pipe-and-compose-93cc39ab16ee?source=collection_archive---------0-----------------------#2021-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d2f628ba41accaf22dbe4fc570ac0671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W66_Q6y4ue281dOKPumn_A.jpeg"/></div></div></figure><p id="36c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我开始进入<em class="kw">函数式编程</em>的旅程时，我发现自己认为它既令人兴奋<strong class="ka ir"> </strong>又令人困惑。我发现在我的日常工作中有用的核心概念之一是<strong class="ka ir">函数组合</strong>，由于其直观的本质，即使在一个完善的代码库中引入它也并不困难。</p><h1 id="8792" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">作曲</strong></h1><p id="8f28" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">当谈到函数组合时，我们可以将其视为<strong class="ka ir">一种将多个函数链接在一起以创建一个新函数的方式</strong>，换句话说，我们正在解决一个问题，将它简化为更小的解决方案，这些解决方案本身<strong class="ka ir">不会完成太多，但一起可以解决复杂的任务</strong>。</p><p id="1885" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们来看一个例子，假设我们要计算一个价格的20%折扣，我们可以这样创建三个函数:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="85ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面的代码非常简单，现在我们需要找到一种方法来组合它们，更传统的方法是<strong class="ka ir">将函数作为下一个函数</strong>的参数:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/4c589796fa92f0af36fdeebc0fa1c218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gq3yQWvcjNEpoNzsek3ILg.jpeg"/></div></figure><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="9fb9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这样<strong class="ka ir">内部函数的结果被外部函数作为参数</strong>使用，直到链结束:</p><p id="f97d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在已经设法将我们的函数链接在一起，我们可以通过编写一个<strong class="ka ir"> compose函数</strong>提高可读性来实现相同的结果:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/e688ce457ec98c7c0cd3680c2df73def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPi8K4S8noqPhm-t1IyWHQ.jpeg"/></div></div></figure><p id="473f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我们的代码变成了:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="2684" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的compose函数使代码更易读、更整洁，但我们可以使用<strong class="ka ir">高阶</strong> <em class="kw"> reduceRight </em>函数将它改进为<strong class="ka ir">接受三个以上的函数</strong>:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="fe2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们正在做的是使用<em class="kw"> spread </em>操作符将参数(我们的函数)转换成一个数组，并返回一个新函数，该函数接受一个参数“X ”,该参数将用作reduceRight函数的累加器的初始值。我们基本上是用前一个函数的结果从右到左执行作为参数传递的每个函数。</p><p id="ba47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果我们现在想要添加一个新的函数来为我们的折扣添加一个前缀“$ ”,我们可以简单地将它添加到组合参数列表中</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><h1 id="08a2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">管道</strong></h1><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/5ac89b31ca511d64b983b38ed7ea7598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BePSiFnsUetUm7KN6YQ1Hg.jpeg"/></div></figure><p id="91b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">管道</em>的工作方式与Compose完全相同，唯一的区别是<strong class="ka ir">不是从右到左执行参数，而是从左到右执行参数</strong>，我们可以像这样实现一个<em class="kw">管道</em>函数:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="852a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">唯一不同的是<em class="kw">减右</em>变成了<em class="kw">减右</em>。就我个人而言，我更喜欢用<em class="kw">作曲</em>而不是<em class="kw">管</em>，即使乍一看这似乎违反直觉。</p><p id="1246" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的最终代码是:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><h1 id="40f1" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">拉姆达</strong></h1><p id="5636" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">你不必每次写一段代码就写自己版本的<em class="kw"> Pipe </em>或<em class="kw"> Compose </em>，你可以使用<a class="ae mh" href="https://ramdajs.com/docs/#compose" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Ramda </strong> </a>等库，专注于你代码的实现。</p><h1 id="c6f7" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">结论</strong></h1><p id="5cbf" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">希望这篇文章能让你深入了解函数组合的好处，以及如何在日常工作中引入它，<strong class="ka ir">如果你有任何问题，请留下评论！</strong></p></div></div>    
</body>
</html>
<html>
<head>
<title>Type Query: jQuery Style Type Manipulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">类型查询:jQuery样式类型操作</h1>
<blockquote>原文：<a href="https://itnext.io/type-query-jquery-style-type-manipulation-497ce26d93f?source=collection_archive---------0-----------------------#2021-10-30">https://itnext.io/type-query-jquery-style-type-manipulation-497ce26d93f?source=collection_archive---------0-----------------------#2021-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d58fe712c49328f733da3a50ceb2fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJDLc0qoBNnD3z1_vkYEdQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">将元组转换为对象</figcaption></figure><p id="6458" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本文中，我们介绍了一种创建在TypeScript中使用的类型的新方法，它允许我们使用JavaScript <strong class="ke ir"> inline </strong>轻松生成复杂类型。</p><p id="9ba5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们使用的语言是<a class="ae la" href="https://github.com/mistlog/typetype" rel="noopener ugc nofollow" target="_blank"> TypeType </a> ( <a class="ae la" rel="noopener ugc nofollow" target="_blank" href="/the-art-of-type-programming-cfd933bdfff7">类型编程的艺术</a>)。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="c0bf" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">介绍</h1><p id="ce26" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">在TypeType v0.0.30中，我们有了一个新的类型:ContextType，例如:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/77583060a93bc8c487536f3fa8f2bd7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UE6_80llLhyv3x7iJLEtWg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">类型中的和</figcaption></figure><p id="ab45" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里我们使用语法“` ` …` `”来插入JavaScript代码，并以这种方式实现globalContext.sum:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/83a1f7555fdb1464c65ff5a61f8dcf6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9gXT-CEKs-HYhs0frjYPg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">类型上下文</figcaption></figure><p id="7a48" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">“sum”接收TypeType中的值并返回AST，结果是:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0e05887ff6d23b1562acf404d58f8dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xWAo0F8jFIS_G4NGuqmcQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ts中的总和</figcaption></figure><p id="66b5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个例子可以在<a class="ae la" href="https://github.com/mistlog/typetype-template/blob/main/src/type-context.ts" rel="noopener ugc nofollow" target="_blank">https://github . com/mistlog/type type-template/blob/main/src/type-context . ts</a>中找到。</p><h1 id="6eee" class="li lj iq bd lk ll mp ln lo lp mq lr ls lt mr lv lw lx ms lz ma mb mt md me mf bi translated">类型查询</h1><p id="dd1d" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">一旦我们可以执行外部JavaScript代码，我们就可以实现libs来制作类似魔术的东西。</p><p id="30ef" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如我们所知，很难<a class="ae la" href="https://stackoverflow.com/questions/55127004/how-to-transform-union-type-to-tuple-type" rel="noopener ugc nofollow" target="_blank">将union类型转换为tuple类型</a>，但是，在ContextType中这是微不足道的:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/41e3b148ad320d914fb55fd639d15e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AuyHqJmJYZKYXC-2vGSXLw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">typetype中元组的联合</figcaption></figure><p id="f5c4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里我们用“$。使用"访问类型变量" input "的AST，并在JavaScript中将其转换为TupleType:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/96a516893d539e47aeb21e16d40b3938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2r0URLLKqmKgHO3pPTB_wQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">类型查询扩展</figcaption></figure><p id="3f24" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们使用“query.install”将这个扩展添加到TypeQuery对象，这是受jQuery的启发。</p><p id="75e2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出是:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e195379af2380b690b729da10257edf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bePnkg1WQ9T0cAqll6eZtg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ts中元组的联合</figcaption></figure><p id="74bf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">顺序保持不变，实际上，你可以随意重新排序。</p><p id="94ca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">TypeQuery伸缩性很好，您可以这样做:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d58fe712c49328f733da3a50ceb2fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJDLc0qoBNnD3z1_vkYEdQ.png"/></div></div></figure><p id="0798" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">并得到结果:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f2a898a8e6162e3d5a62cb85a9ce01fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXhCQ8tD9PlSn-H0QPRRtg.png"/></div></div></figure><p id="4bea" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以上示例可见于:</p><ul class=""><li id="7086" class="mu mv iq ke b kf kg kj kk kn mw kr mx kv my kz mz na nb nc bi translated"><a class="ae la" href="https://github.com/mistlog/typetype-template/blob/main/src/type-query-extension.ts" rel="noopener ugc nofollow" target="_blank">https://github . com/mistlog/type type-template/blob/main/src/type-query-extension . ts</a></li><li id="7bdf" class="mu mv iq ke b kf nd kj ne kn nf kr ng kv nh kz mz na nb nc bi translated"><a class="ae la" href="https://github.com/mistlog/typetype-template/blob/main/src/type-query-basic.ts" rel="noopener ugc nofollow" target="_blank">https://github . com/mistlog/type type-template/blob/main/src/type-query-basic . ts</a></li></ul><h1 id="1abc" class="li lj iq bd lk ll mp ln lo lp mq lr ls lt mr lv lw lx ms lz ma mb mt md me mf bi translated">类型测试</h1><p id="a7b5" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们可以从类型运行时获得AST和Type-in-string，因此我们可以使用简单的jest来测试类型:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0c8116ed71a32132421869980b7e9da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q269q9U4Ez0HVG1ouCw54w.png"/></div></div></figure><p id="f4be" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ref:<a class="ae la" href="https://github.com/mistlog/typetype-template/blob/main/test/type-runtime.test.ts" rel="noopener ugc nofollow" target="_blank">https://github . com/mistlog/type type-template/blob/main/test/type-runtime . test . ts</a></p><h1 id="4d94" class="li lj iq bd lk ll mp ln lo lp mq lr ls lt mr lv lw lx ms lz ma mb mt md me mf bi translated">履行</h1><p id="d327" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">代码可以在这里找到:<a class="ae la" href="https://github.com/mistlog/type-query" rel="noopener ugc nofollow" target="_blank">https://github.com/mistlog/type-query</a></p><p id="62ae" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">快速启动:<a class="ae la" href="https://github.com/mistlog/typetype-template" rel="noopener ugc nofollow" target="_blank">https://github.com/mistlog/typetype-template</a></p></div></div>    
</body>
</html>
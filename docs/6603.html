<html>
<head>
<title>A minimalist guide to Riverpod</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Riverpod简约指南</h1>
<blockquote>原文：<a href="https://itnext.io/a-minimalist-guide-to-riverpod-4eb24b3386a1?source=collection_archive---------0-----------------------#2022-01-02">https://itnext.io/a-minimalist-guide-to-riverpod-4eb24b3386a1?source=collection_archive---------0-----------------------#2022-01-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3d9b203f3210513f4fab7fc5c253d405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8ZLrPyh1u_d0ITGAknJ-Q.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="9203" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">颤振中最好的状态管理和依赖注入解决方案之一</h2></div><p id="1fea" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这次我试图简化整个Riverpod包。希望你喜欢它！</p><p id="b805" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">首先</p><h1 id="f673" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">Riverpod是什么？</h1><blockquote class="mh"><p id="e579" class="mi mj je bd mk ml mm mn mo mp mq lo dk translated">一个反应式状态管理和依赖注入框架——Remi rousse let</p></blockquote><p id="95fc" class="pw-post-body-paragraph kt ku je kv b kw mr kf ky kz ms ki lb lc mt le lf lg mu li lj lk mv lm ln lo im bi translated">简而言之，<code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/packages/riverpod" rel="noopener ugc nofollow" target="_blank">Riverpod</a></code>是<code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/packages/provider" rel="noopener ugc nofollow" target="_blank">Provider</a></code>的加强版</p><h1 id="3d51" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">为什么<code class="fe mw mx my mz b">Provider</code>很烂？又为什么需要<code class="fe mw mx my mz b">Riverpod</code>？</h1><p id="cd80" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated"><code class="fe mw mx my mz b">Provider</code>依赖于Flutter/BuildContext，没有内置的DI/服务定位器解决方案等。</p><h2 id="a7f3" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">还有，Riverpod给了我们</h2><ul class=""><li id="b558" class="ns nt je kv b kw nb kz nc lc nu lg nv lk nw lo nx ny nz oa bi translated">在编译时而不是运行时捕获编程错误</li><li id="0f36" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">移除监听/组合对象的嵌套</li><li id="e03d" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">提高应用程序的可测试性。</li><li id="7bdd" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">自动处置支持</li><li id="97ae" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">比较以前和新的状态</li><li id="72b4" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">实现撤销-重做机制</li><li id="b3a0" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">调试应用程序状态</li><li id="659b" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">启用性能优化。</li><li id="6194" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">轻松集成高级功能，如日志记录或拉式刷新。</li></ul></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="f0dc" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果我们准备好了，那就开始吧！</p><h2 id="e848" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">Riverpod的类型</h2><ul class=""><li id="eb11" class="ns nt je kv b kw nb kz nc lc nu lg nv lk nw lo nx ny nz oa bi translated"><code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/packages/riverpod" rel="noopener ugc nofollow" target="_blank">riverpod</a></code>-&gt;-<code class="fe mw mx my mz b">riverpod</code>用于所有dart项目</li><li id="0302" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated"><code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/packages/flutter_riverpod" rel="noopener ugc nofollow" target="_blank">flutter_riverpod</a></code>-&gt;-<code class="fe mw mx my mz b">riverpod</code>为指定用于颤振</li><li id="8f68" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated"><code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/packages/hooks_riverpod" rel="noopener ugc nofollow" target="_blank">hooks_riverpod</a></code>-&gt;-<code class="fe mw mx my mz b">flutter_riverpod</code>结合<code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/packages/flutter_hooks" rel="noopener ugc nofollow" target="_blank">flutter_hooks</a></code></li></ul><figure class="oo op oq or gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/1eb0d25db3db8c6815a17050536e3fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*2CvVFIMRI-ybk0WyH19ykw.png"/></div><figcaption class="os ot gj gh gi ou ov bd b be z dk translated">-塔达斯·佩特拉</figcaption></figure><blockquote class="ow ox oy"><p id="b966" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated">注:如果你对<code class="fe mw mx my mz b"><em class="je">flutter_hooks</em></code>感兴趣，你可以先看看我写的一篇文章！</p></blockquote><div class="is it gp gr iu pd"><a href="https://iisprey.medium.com/get-rid-of-all-kind-of-boilerplate-code-with-flutter-hooks-2e17eea06ca0" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jf gy z fp pi fr fs pj fu fw jd bi translated">用抖动钩子去掉所有类型的样板代码</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">难道你不认为，是时候杀死StatefulWidget并使用flutter钩子去掉样板代码了吗</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">iisprey.medium.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr ja pd"/></div></div></a></div><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ps"><img src="../Images/2ec7145ba3142c44d71e450028b1e287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ynbQmqvnKN8akpxOqKfJ1A.png"/></div></div><figcaption class="os ot gj gh gi ou ov bd b be z dk translated">-塔达斯·佩特拉</figcaption></figure><h1 id="93c5" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">提供者</h1><p id="6fd3" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">提供者给我们一个依赖注入的解决方案。先说说他们的类型。</p><h2 id="58ab" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">供应者</h2><p id="0686" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">这是最基本的版本。</p><p id="c361" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">当我们在任何地方获取不可变数据时，我们使用它。</p><p id="24b2" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">它适用于类似的服务等。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pt"><img src="../Images/5c6758d206ace7d4027caf59097d5d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8E-b9-wHwkB1YIKzIAxgdA.png"/></div></div></figure><h2 id="80bd" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">未来供应商</h2><p id="243f" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">它只是结合了未来建造者和提供者。为用户处理错误或加载状态，并在获取数据时重建用户界面</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pu"><img src="../Images/51d8181b462a7427caf5e4bebca1d00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H15FzNJTi5IECm-l-G_cPg.png"/></div></div></figure><h2 id="b282" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">流提供者</h2><p id="4b63" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">就像FutureProvider一样，但是用于流</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pv"><img src="../Images/0c994eb27ed965e4033e8654134e1e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CWj1LTlqMT43gmBzg5as_w.png"/></div></div></figure><h2 id="7250" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">州提供者</h2><p id="4db1" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">当我们需要一个基本的全局状态解决方案时。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pw"><img src="../Images/be16bd4551606e8cf6cf246dc6e25be3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sbGSs4FCgMy330mVpZQMwQ.png"/></div></div></figure><h2 id="cb54" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">变更通知程序</h2><p id="2c7f" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">我们将其用作复杂的状态管理解决方案。</p><p id="071b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">每当调用<code class="fe mw mx my mz b">notifyListeners()</code>时，监听更改和重建。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi px"><img src="../Images/5442a2d8fcd84890ee79766e908e91b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAjPdT3t84YZSZ4Gu1YJpA.png"/></div></div></figure><h2 id="599c" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">StateNotifier</h2><p id="3298" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">这就像是<code class="fe mw mx my mz b">ChangeNotifier</code>的不变和被动版本</p><p id="f26f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">你不需要打电话给<code class="fe mw mx my mz b">notifyListeners();</code></p><p id="2322" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这个可能看起来更像样板文件，但是它更安全，也更容易编写测试</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi py"><img src="../Images/32901b484dd5df9ff1a5dd6eb9110673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O3jf8GtZJHQpxwC9wZ7i4g.png"/></div></div></figure><h1 id="e92b" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">提供商修饰符</h1><p id="00f5" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">我们还可以给提供者一些超能力！！</p><ul class=""><li id="5c00" class="ns nt je kv b kw kx kz la lc pz lg qa lk qb lo nx ny nz oa bi translated"><code class="fe mw mx my mz b"><a class="ae na" href="https://riverpod.dev/docs/concepts/modifiers/auto_dispose" rel="noopener ugc nofollow" target="_blank">.autoDispose</a></code>，这将使提供者在它不再被监听时自动销毁它的状态。</li></ul><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qc"><img src="../Images/e1725a74559da634a9ff7740e4b92ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gRlYAPWfxWyhu8iuncQocA.png"/></div></div></figure><ul class=""><li id="ed4c" class="ns nt je kv b kw kx kz la lc pz lg qa lk qb lo nx ny nz oa bi translated"><code class="fe mw mx my mz b"><a class="ae na" href="https://riverpod.dev/docs/concepts/modifiers/family" rel="noopener ugc nofollow" target="_blank">.family</a></code>，允许从外部参数创建提供者。</li></ul><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qd"><img src="../Images/ee0b91c9c6d68a153d5e30e625f4cce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eVbfp-lsoC40VQjndU_pXw.png"/></div></div></figure><p id="24c8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">此外，您可以同时使用它们。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qe"><img src="../Images/9476c27fbe47eec5ce75652f362cb014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wQSYCbLtGoHHQKLulUoC4A.png"/></div></div></figure></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h1 id="ae31" class="lp lq je bd lr ls qf lu lv lw qg ly lz kk qh kl mb kn qi ko md kq qj kr mf mg bi translated">消费者</h1><p id="0629" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">我们使用消费者来监控变化。只是为了读取数据</p><p id="3364" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">创建消费者有5种方式</p><h2 id="0e39" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">1.消费者获取</h2><p id="f480" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">无状态小部件+消费者</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qk"><img src="../Images/e7e0b9311bcfcfb3dad5590fe88a0704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Mi_purOnqIGg9HgYOk5yQ.jpeg"/></div></div></figure><h2 id="f82f" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">2.HookConsumerWidget</h2><p id="ab52" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">StatelessWidget +消费者+扑钩</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qk"><img src="../Images/81aec56f6563cd1797f641c556bbbb07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6bEa4MNYy4oqakXyzObLAQ.jpeg"/></div></div></figure><h2 id="7fd1" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">3.消费者作为一个部件</h2><p id="6df6" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">无状态小部件和小部件</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ql"><img src="../Images/86543c54d9a87d2f507f6910a1dd60eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8qNr5R7K9uZSmFrQ2KUIg.jpeg"/></div></div></figure><h2 id="dc00" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">4.消费者状态小部件</h2><p id="5160" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">StatefulWidget +消费者</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi px"><img src="../Images/85e4814552a790f6e12225514a91feff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wCmyuJYlDAFJ2FSJeRi81A.jpeg"/></div></div></figure><h2 id="82eb" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">5.StatefulHookConsumerWidget</h2><p id="15db" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">StatefulWidget +消费者+扑钩</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi px"><img src="../Images/c69a69b63192ac07f999e4a35d10f4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kzhZwSH77njUQ077PvFiHw.jpeg"/></div></div></figure></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h1 id="554b" class="lp lq je bd lr ls qf lu lv lw qg ly lz kk qh kl mb kn qi ko md kq qj kr mf mg bi translated">裁判能做什么？</h1><p id="6d3a" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">你得到了模式，但是等待<code class="fe mw mx my mz b">ref</code>是什么，它能做什么？</p><h2 id="b594" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated"><a class="ae na" href="https://pub.dev/documentation/riverpod/latest/riverpod/Ref/watch.html" rel="noopener ugc nofollow" target="_blank">看</a> —它是你最好的朋友，永远信任它。</h2><p id="15fa" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">倾听变化并做出反应</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qm"><img src="../Images/af223a88bb91e874ee5da4ce95c52a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUmwtQaO6W4l6B3AEGH5IA.png"/></div></div></figure><h2 id="b03e" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">听着，我是你的僚机</h2><p id="9ba6" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">监听一个提供者，并在它的值改变时调用<code class="fe mw mx my mz b">listener</code>。</p><p id="85f6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这对于显示模态或其他命令式逻辑很有用。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qn"><img src="../Images/65cabfac794ee75d5d34a0565843bd41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fr0LrXValTl_w0_6j69yag.png"/></div></div></figure><blockquote class="ow ox oy"><p id="7bdb" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated"><strong class="kv jf">作者注</strong></p><p id="b3a7" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated"><code class="fe mw mx my mz b"><em class="je">watch</em></code>和<code class="fe mw mx my mz b"><em class="je">listen</em></code>方法不应该被异步调用，比如在<code class="fe mw mx my mz b"><em class="je">onPressed</em></code>或<a class="ae na" href="https://api.flutter.dev/flutter/material/ElevatedButton-class.html" rel="noopener ugc nofollow" target="_blank">提升按钮</a>内部。也不应该在<code class="fe mw mx my mz b"><em class="je">initState</em></code>和其他<a class="ae na" href="https://api.flutter.dev/flutter/widgets/State-class.html" rel="noopener ugc nofollow" target="_blank">状态</a>生命周期内使用。</p><p id="e8c3" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated">在这些情况下，考虑使用<code class="fe mw mx my mz b"><em class="je">ref.read</em></code>来代替。</p></blockquote><h2 id="3712" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated"><a class="ae na" href="https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/WidgetRef/read.html" rel="noopener ugc nofollow" target="_blank">读</a> —知道但不要用那个</h2><p id="5073" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">只读取提供者一次，不听更改。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qo"><img src="../Images/50b2d8c079e6eae08ca0ff4b727335ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zl2W2_u5ogUR-V4aModg6Q.png"/></div></div></figure><blockquote class="ow ox oy"><p id="cccc" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated"><strong class="kv jf">作者推荐</strong></p><p id="7f83" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated">这些本身没有被窃听，但是它们是反模式的。它们会在将来导致错误。那是因为作者建议他们</p></blockquote><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qp"><img src="../Images/a60a28c2c4ebe1c8e03019e7dc5ed7f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ExWmOVgrFspJoP1CLBlOHA.jpeg"/></div></div></figure><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qq"><img src="../Images/79129cd8d495783d93382cda1f56a5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4S0NnNW4Zs6iB99S62K1w.jpeg"/></div></div></figure><h2 id="795c" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">最后一件事</h2><p id="8604" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">我教过你<code class="fe mw mx my mz b">read</code>的方法但是…</p><blockquote class="ow ox oy"><p id="5c74" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated">应尽可能避免使用<code class="fe mw mx my mz b">ref.read</code>。</p><p id="1262" class="kt ku oz kv b kw kx kf ky kz la ki lb pa ld le lf pb lh li lj pc ll lm ln lo im bi translated">它的存在是为了解决使用<code class="fe mw mx my mz b">watch</code>或<code class="fe mw mx my mz b">listen</code>太不方便的情况。<br/>如果可以的话，用<code class="fe mw mx my mz b">watch</code> / <code class="fe mw mx my mz b">listen</code>几乎总是更好，尤其是<code class="fe mw mx my mz b">watch</code>。</p></blockquote><h2 id="0451" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">但是为什么呢？</h2><p id="c4dc" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">以下链接完美地解释了这种情况。如果你不相信我，就看看解释</p><div class="is it gp gr iu pd"><a href="https://riverpod.dev/docs/concepts/reading#dont-use-refread-inside-the-build-method" rel="noopener  ugc nofollow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jf gy z fp pi fr fs pj fu fw jd bi translated">阅读提供者| Riverpod</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">在阅读本指南之前，请务必先阅读关于提供商的内容。在本指南中，我们将了解如何消费…</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">riverpod.dev</p></div></div><div class="pm l"><div class="qr l po pp pq pm pr ja pd"/></div></div></a></div><p id="0626" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果你已经被说服了，我们可以继续</p><h2 id="77de" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated"><a class="ae na" href="https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/WidgetRef/refresh.html" rel="noopener ugc nofollow" target="_blank">刷新</a></h2><p id="d2ca" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">强制提供程序重新评估其状态，并返回创建的值。</p><p id="674b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">此方法对于“拉至刷新”或“出错时重试”等功能非常有用，可用于重新启动特定的提供程序。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qs"><img src="../Images/06100b72a822fe8ca04e23274cd61440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHFFKEGyP-y4c6DEDZjlAQ.png"/></div></div></figure><h2 id="5303" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated"><a class="ae na" href="https://pub.dev/documentation/riverpod/latest/riverpod/Ref/onDispose.html" rel="noopener ugc nofollow" target="_blank"> onDispose </a></h2><p id="e663" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">正好在提供程序被销毁之前运行。</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qt"><img src="../Images/28f4b106cda576a349b3d72d3ab744a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3bk54CL1mLcPYjhES2_IA.png"/></div></div></figure><h1 id="e783" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">过滤提供商</h1><p id="fca2" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">使用<code class="fe mw mx my mz b">select</code>方法可以只听对象的特定部分，而不是听整个对象。例如，除非用户名更改。文本小部件不会重建。所以作者强烈推荐使用<code class="fe mw mx my mz b">watch</code>而不是read I</p><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qu"><img src="../Images/a0dc6d7d2f52ca9dd9f6b5290952d5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DUto2e9Es7kA2UazkRUiMg.png"/></div></div></figure><h1 id="97a6" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">ProviderObserver</h1><p id="efdf" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">你也可以毫不费力地观察整个过程</p><ul class=""><li id="ab16" class="ns nt je kv b kw kx kz la lc pz lg qa lk qb lo nx ny nz oa bi translated"><code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/documentation/riverpod/latest/riverpod/ProviderObserver/didAddProvider.html" rel="noopener ugc nofollow" target="_blank">didAddProvider</a></code>每次初始化提供者时调用，公开的值是value。</li><li id="a4f2" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">每次释放提供者时都会调用<code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/documentation/riverpod/latest/riverpod/ProviderObserver/didDisposeProvider.html" rel="noopener ugc nofollow" target="_blank">didDisposeProvider</a></code></li><li id="8700" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">每次我的提供者发出通知时都会被调用。</li><li id="bfb4" class="ns nt je kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">每当provider发出一个错误时，<code class="fe mw mx my mz b"><a class="ae na" href="https://pub.dev/documentation/riverpod/latest/riverpod/ProviderObserver/providerDidFail.html" rel="noopener ugc nofollow" target="_blank">providerDidFail</a></code>就会被调用，无论是在初始化期间抛出还是让一个<a class="ae na" href="https://api.dart.dev/stable/2.15.1/dart-async/Future-class.html" rel="noopener ugc nofollow" target="_blank">未来</a> / <a class="ae na" href="https://api.dart.dev/stable/2.15.1/dart-async/Stream-class.html" rel="noopener ugc nofollow" target="_blank">流</a>发出一个错误</li></ul><figure class="oo op oq or gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qv"><img src="../Images/be5784e961158a4fa207c265e58f397c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SazlWMaXOXATs20Qg4rOEw.png"/></div></div></figure></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="a88c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如您所见，我们为消费者和提供商提供了许多解决方案。可以随心所欲的组合！</p><p id="eb39" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">作为一个有经验的开发人员，我建议作为最终的解决方案</p><h2 id="a048" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">Riverpod + StateNotifier + <a class="ae na" href="https://iisprey.medium.com/get-rid-of-all-kind-of-boilerplate-code-with-flutter-hooks-2e17eea06ca0" rel="noopener">钩子</a> + <a class="ae na" href="https://iisprey.medium.com/how-to-handle-complex-json-in-flutter-4982015b4fdf" rel="noopener">冻结</a></h2><p id="c0b0" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">你想进一步了解这个组合吗？</p><p id="d474" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">就等下周吧！我将用一个真实世界的例子来深刻地谈论它</p><h2 id="bc7f" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">更新——这是我承诺的下一篇文章</h2><div class="is it gp gr iu pd"><a rel="noopener  ugc nofollow" target="_blank" href="/flutter-state-management-with-riverpod-ef8d4ef77392"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jf gy z fp pi fr fs pj fu fw jd bi translated">用Riverpod进行颤振状态管理</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">一个有点复杂的真实世界riverpod例子</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">itnext.io</p></div></div><div class="pm l"><div class="qw l po pp pq pm pr ja pd"/></div></div></a></div><div class="is it gp gr iu pd"><a rel="noopener  ugc nofollow" target="_blank" href="/undo-redo-mechanism-with-riverpod-in-flutter-6fc15ef87b1a"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jf gy z fp pi fr fs pj fu fw jd bi translated">Riverpod在颤动时的撤销/重做机制</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">实现撤销-重做机制是多么容易的故事</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">itnext.io</p></div></div><div class="pm l"><div class="qx l po pp pq pm pr ja pd"/></div></div></a></div><h1 id="943a" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">参考资料和建议的资源</h1><div class="is it gp gr iu pd"><a href="https://riverpod.dev" rel="noopener  ugc nofollow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jf gy z fp pi fr fs pj fu fw jd bi translated">Riverpod</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">共享状态的无样板文件的安全方式</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">riverpod.dev</p></div></div><div class="pm l"><div class="qy l po pp pq pm pr ja pd"/></div></div></a></div><figure class="oo op oq or gt iv"><div class="bz fp l di"><div class="qz ra l"/></div></figure></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><figure class="oo op oq or gt iv"><div class="bz fp l di"><div class="qz ra l"/></div></figure><figure class="oo op oq or gt iv"><div class="bz fp l di"><div class="qz ra l"/></div></figure><figure class="oo op oq or gt iv"><div class="bz fp l di"><div class="qz ra l"/></div></figure><figure class="oo op oq or gt iv"><div class="bz fp l di"><div class="qz ra l"/></div></figure></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h2 id="9435" class="ng lq je bd lr nh ni dn lv nj nk dp lz lc nl nm mb lg nn no md lk np nq mf nr bi translated">感谢您的阅读！</h2><p id="3787" class="pw-post-body-paragraph kt ku je kv b kw nb kf ky kz nc ki lb lc nd le lf lg ne li lj lk nf lm ln lo im bi translated">那是一篇很长的文章，而你大老远跑来这里！你太棒了！请不要忘记鼓掌(也可能你不知道鼓掌可以达到50次，只是在你走的时候点击)</p></div></div>    
</body>
</html>
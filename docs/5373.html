<html>
<head>
<title>Amazon Web Services (AWS) — Serverless Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊网络服务(AWS) —无服务器架构</h1>
<blockquote>原文：<a href="https://itnext.io/amazon-web-services-aws-serverless-architecture-2c14369aa66b?source=collection_archive---------5-----------------------#2021-02-19">https://itnext.io/amazon-web-services-aws-serverless-architecture-2c14369aa66b?source=collection_archive---------5-----------------------#2021-02-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="00b2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">初学者设置全栈应用程序的完整教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d8f83e344a16b3efc1bcd83157041f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yY6Hzn_FV8JFIdGK1w7_yQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/server?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@scienceinhd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">科学高清</a>拍摄的照片</figcaption></figure><p id="ba7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我第一次开始学习AWS时，我认为它是黑暗魔法。每当我触及这个话题时，有太多的东西需要学习，以至于我立即停下来，不知道如何继续。</p><p id="3f93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为什么我创建了这个使用AWS创建全栈应用程序的分步教程。在本教程之后，我们将有一个前端，一个与数据库对话的后端，以及一个API。</p><p id="647d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几种与AWS通信的方式，在本教程中，我们将使用服务web控制台。<strong class="lb iu">网络控制台是用户友好的网络应用</strong>，让用户管理和设置AWS服务。对我来说，学习AWS感觉有点势不可挡，因为许多教程都使用AWS CLI。AWS CLI是一个命令行工具，与web控制台做同样的事情。如果你打算花很多时间使用AWS，我建议你使用AWS CLI，但是web控制台提供了一个更容易的学习曲线。</p><h2 id="b837" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">什么是AWS和无服务器？</h2><p id="36b0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">AWS是亚马逊运营的云基础设施即服务(Cloud IaaS)平台。这个云提供服务来帮助开发者在云中执行计算。这意味着，作为用户，你可以设置一项服务，例如网页。然后网页由云运行，也由云管理。</p><p id="6d2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以当你读到无服务器，并不意味着没有服务器。对于用户来说，不涉及任何服务器。用户(开发人员)不需要服务器来运行和执行他们的代码，这一切都由云中的服务器来完成。</p><p id="db6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">把它想象成租车</strong>，你付钱使用别人的服务器，他们处理服务。</p><p id="1ff2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据<a class="ae ky" href="https://aws.amazon.com/getting-started/deep-dive-serverless/?e=gs2020&amp;p=build-a-web-app-five" rel="noopener ugc nofollow" target="_blank"> AWS </a>使用无服务器方法的原因如下。</p><ul class=""><li id="3e87" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated"><strong class="lb iu">无服务器管理</strong> —无维护，无管理</li><li id="713e" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">扩展</strong> —当应用需要更多内存或吞吐量时，会自动扩展应用。</li><li id="46fd" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">为价值付费</strong> —只为您使用的东西付费。</li><li id="2532" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">自动化高可用性</strong> —应用程序在提供高容错能力的环境中运行。</li></ul><h2 id="6f1a" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">AWS —入门</h2><p id="3469" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">首先要做的是<a class="ae ky" href="https://portal.aws.amazon.com/billing/signup?nc2=h_ct&amp;src=header_signup&amp;redirect_url=https%3A%2F%2Faws.amazon.com%2Fregistration-confirmation#/account" rel="noopener ugc nofollow" target="_blank">注册</a>一个AWS账户。您将需要提供一个信用卡账单，<strong class="lb iu">有一个免费层的费用为0美元，</strong>所以不要担心。</p><p id="cfaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS提供许多不同的服务，每个服务都有其独特的功能。我们将逐步介绍一些基本服务。</p><h2 id="a824" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">AWS Amplify —建立一个静态网站</h2><p id="14ef" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们将从使用<a class="ae ky" href="https://aws.amazon.com/amplify/hosting/" rel="noopener ugc nofollow" target="_blank"> AWS Amplify </a>服务开始。这是一种用于托管静态网站的服务。它的酷之处在于，我们可以将它连接到一个Git存储库，这意味着它将托管该存储库上的任何静态网站。</p><p id="f969" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您访问AWS控制台时，您需要以root用户身份登录，并提供您作为root用户使用的电子邮件。这个选项存在的原因是，一个组织中可能有许多人需要访问同一个云服务。在本教程中，我们不会过多介绍IAM，但它是一个用户访问服务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/9e7916b70746c63a66483f107a0ec806.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*2VpPhVVLPVYjxH2qGo6VmQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">为AWS控制台设置root用户。</figcaption></figure><p id="99f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">重要注意事项在继续之前，请始终更改我们将使用的每个服务的地区。</strong>如果您在俄勒冈地区创建了一项服务，那么只有在您更改为俄勒冈的情况下，您才能看到您的服务。我看到很多关于这个的问题，“我所有的工作都没了”。很多时候，他们在错误的地区工作。可以在每个服务的右上角更改区域。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/443f1926ec7be908902a25351213bb76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MR2WBNgi6PpcBTAkeYjtdw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS区域—一个常见的错误是忘记切换服务中使用的区域。</figcaption></figure><p id="f3fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要从建立一个新的存储库开始，登录<a class="ae ky" href="http://www.github.com" rel="noopener ugc nofollow" target="_blank"> GitHub </a>并创建一个新的存储库。<br/>在开发机器上创建一个名为aws-programming-with-percy的新目录，并创建一个名为index.html的新HTML文件。index.html的名字很重要。我们还将初始化目录中的GitHub存储库。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="c55f" class="lv lw it nk b gy no np l nq nr">mkdir aws-programming-with-percy<br/>touch index.html<br/>git init <br/>git remote add origin <a class="ae ky" href="https://github.com/percybolmer/aws-programming-with-percy.git" rel="noopener ugc nofollow" target="_blank">https://github.com/percybolmer/aws-programming-with-percy.git</a></span></pre><p id="9c3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开index.html，把下面的要点抄进去。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">index.html一个超级简单的静态网站欢迎我们。</figcaption></figure><p id="40be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存您的index.html并将其推送到存储库。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="835d" class="lv lw it nk b gy no np l nq nr">git add .<br/>git commit -m "Added index.html"<br/>git push origin master</span></pre><p id="4dca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更新后，访问AWS上的<a class="ae ky" href="https://us-west-2.console.aws.amazon.com/amplify/home?region=us-west-2#/" rel="noopener ugc nofollow" target="_blank">放大控制台</a>。你应该会受到一个温暖人心的闪屏的欢迎。按下<strong class="lb iu">开始</strong>按钮，或向下滚动进入开始部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/a181cf7e62cf2adac0b6e65ba9843487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-mf_1ErS6OkXQ1QTthvkA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS在开始时放大问候</figcaption></figure><p id="45ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将有两个报价开始，我们想使用交付选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e6ea1b9ee6a1a295f693cb9a4a0d74d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*s_aHl0HqAbnvrxYRLZo58Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">交付——在AWS Amplify上托管git存储库的选项</figcaption></figure><p id="f753" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一个询问您如何提供代码的屏幕中选择GitHub。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/23e3751ac53565e9510002bfde7b7350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oxNH9O2hr3GpLh4u9B6pHQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS中可用的代码提供程序。我们将使用GitHub。</figcaption></figure><p id="950f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS Amplify将需要访问您的GitHub，如果您在同一个浏览器上登录，您应该会看到OAuth屏幕。我们会信任AWS，接受他们。按下绿色的“授权aws-amplify-console”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/925412c54a424277ba0842b4319cd42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*WCoLzEqgB6pTjFiG-EzvZA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">OAuth是必需的，AWS将需要访问存储库。</figcaption></figure><p id="2934" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该回到AWS Amplify，在这里我们可以设置使用什么存储库。<strong class="lb iu">确保您选择了我们刚刚创建的包含index.html</strong>的存储库，还选择了正确的分支。如果你按照我的例子，它应该是主，如果你没有指定主，那么它也可以是主要的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/f5ca54eb21fa0fa724a4a57583d53ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JfLmB6q4Bevk09ptW1P2cw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS放大器选择一个储存库和分支到主机。</figcaption></figure><p id="1b6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们可以设置构建设置。在这个简单的用例中，我们还没有任何构建设置，所以现在就让它这样吧。但是在这里你可以设置如何构建项目，定制docker图像和环境变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/c5988af4def76162e7eaa5f19962e135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSdS9kVH_02y8HtBCKTE_g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Amplify中的构件设置—设置构件和docker设置等。</figcaption></figure><p id="57c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按下一步，您将看到一个摘要屏幕。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/76553d83b87841c6ae5110549066c888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QUfuEHLWfu_CKwjNCXJrPQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">部署前的AWS放大摘要屏幕</figcaption></figure><p id="688a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按“保存并部署”。AWS Amplify将开始加载，它现在正在构建您的应用程序。</p><p id="f02e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，您将被重定向到一个管理仪表板，我们可以在那里配置网站。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/fc39d9baa76e0f91235795a104863469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTk2n6EVhGgwBnJHQD03OA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Amplify dashboard用于我们刚刚部署的网站。</figcaption></figure><p id="8335" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在底部有一个链接，你可以点击查看网站，我们现在有一个活的网站。注意，它使用的是AWS生成的子域。您可以将其更改为您的自定义域。我们现在不会这样做，我没有自定义域，我们仍在学习诀窍。</p><p id="72d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击链接，确保一切正常。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/4cdd760e99455a097a58703de7bf73ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*OztO6mjRM2ZDzaZ8ZLEfkA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用Percy网站编程——由AWS Amplify托管，从GitHub存储库中提取网站</figcaption></figure><p id="8691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了，那很简单，对吧？我们现在知道如何用AWS Amplify托管一个网站。确保在Amplify控制台中导航，看看它有哪些不同的工具和可能性。</p><p id="df30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Amplify的一些好特性是</p><ul class=""><li id="3b19" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">监控—这允许您监控站点流量、访问日志和设置警报。</li><li id="8f94" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">自定义标头—这允许您向所有请求添加HTTP标头。</li><li id="541a" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">域名管理——这允许你绑定一个自定义域名到网站，也为你解决了HTTPS问题。</li><li id="cb8d" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">admin UI——构建应用后端的可视化界面，完全公开，我还没用过这个。</li></ul><p id="4e29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个简单的网站并不能让我们走得很远？我们继续吧。</p><h2 id="3cbf" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">AWS Lambda —您的AWS后端和代码执行器</h2><p id="2a90" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来将实现一个<a class="ae ky" href="https://aws.amazon.com/lambda/?nc2=h_ql_prod_fs_lbd" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>。另一个服务，让我们基于某些触发器运行代码。我不得不说，在我敢于尝试之前，我已经听了很久关于AWS Lambda的讨论。只是发生了太多的黑魔法让我害怕。如果我能开发出像这样一半好的软件，我会非常高兴。</p><p id="f1fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS Lambda是一个无服务器解决方案，允许您基于特定事件执行代码。对于作为客户的你来说，Amazon提供服务器并以一种供应和管理的方式运行你的代码。</p><blockquote class="od oe of"><p id="64c6" class="kz la og lb b lc ld ju le lf lg jx lh oh lj lk ll oi ln lo lp oj lr ls lt lu im bi translated">AWS Lambda是一种无服务器计算服务，允许您运行代码，而无需配置或管理服务器、创建工作负载感知集群扩展逻辑、维护事件集成或管理运行时。有了Lambda，您几乎可以为任何类型的应用程序或后端服务运行代码——所有这些都无需管理— <a class="ae ky" href="https://aws.amazon.com/lambda/?e=gs2020&amp;p=build-a-web-app-two" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a></p></blockquote><p id="0e91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先打开<a class="ae ky" href="https://us-east-2.console.aws.amazon.com/lambda/home?region=us-east-2#/functions" rel="noopener ugc nofollow" target="_blank"> AWS Lambda控制台。</a>点击右上角，更改您正在使用的区域。我住在瑞典，所以我把我的时间定在了斯德哥尔摩。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/703f8c153a069ba4c8fa5a84b04fb192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0BcqgxYn0V2vgUh0VznvKg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda控制台开始屏幕—更改区域以匹配您的位置。</figcaption></figure><p id="fcc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们目前没有任何函数，所以让我们从创建一个函数开始。按下“创建功能按钮”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/40256beeaa5969bfe643178faff35054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*97zNEabg0qG4zYn28Rgd4w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda控制台—目前没有功能。</figcaption></figure><p id="28e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有四种选择。您可以从头开始构建代码，使用预先构建的蓝图，上传docker映像，或者浏览<a class="ae ky" href="https://aws.amazon.com/serverless/serverlessrepo/" rel="noopener ugc nofollow" target="_blank"> AWS无服务器应用程序库</a>。</p><p id="6b5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要上传docker图像，它必须是<a class="ae ky" href="https://aws.amazon.com/ecr/" rel="noopener ugc nofollow" target="_blank">亚马逊ECR </a>的一部分。ECR是他们的Docker存储库。</p><p id="8f29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将继续从头开始创建一段代码，这将是一个名为Greeter的函数，它向用户打印Hello。我将使用Golang作为我的编程语言。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/1452eda7bd087160e5ba394b353775c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkzlCXMaPlrUH_2AtoKf4Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用Golang从头开始创建AWS Lambda</figcaption></figure><p id="a864" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">遗憾的是，AWS Lambda不支持Go浏览器中的代码编辑器。如果你使用的是支持的语言，在函数代码部分会有一个代码编辑器。如果使用Go，我们必须上传一个包含我们想要的代码的. zip文件。我们将构建一个向用户问好的简单函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/1b4f409418b819cbac77e61fcd2587c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J_Flxs935Tp-s4SoaxZAvQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda函数视图—我们使用函数代码操作来上传包含代码的. zip文件。</figcaption></figure><p id="8a85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将创建一个新的Golang项目，并创建一个简单的main.go文件。main.go文件将包含一个名为GreetVisitor的函数，该函数将获取访问者的姓名并问候他们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda——一个超级基本的Lambda函数示例。</figcaption></figure><p id="33d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要初始化一个go模块，并从中构建一个二进制文件，我们还需要压缩这个二进制文件，这样我们就可以在AWS Lambda中执行它。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="a627" class="lv lw it nk b gy no np l nq nr">go mod init Greeter<br/>go get github.com/aws/aws-lambda-go/lambda<br/>GOOS=linux go build -o Greeter main.go<br/>zip Greeter.zip Greeter</span></pre><p id="6e9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些命令将下载所需的aws-lambda-go包，并将我的程序编译成一个名为Greeter的二进制文件。然后，我将欢迎压缩成一个zip文件。获得zip文件后，返回AWS Lambda控制台。再次找到<strong class="lb iu">功能代码</strong>部分，选择操作并上传zip。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/d41e26805594cbd6b4ff35795601425d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FeU2rN-KzgODLCQwXaEtPQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda —我将Greeter.zip上传到我的欢迎函数中</figcaption></figure><p id="3fa8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，找到<strong class="lb iu">运行时设置，</strong>我们需要编辑函数应该运行的二进制文件。将处理程序名设置为我们编译的二进制文件的名称，在我的例子中是Greeter。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/48a9baf41f69d9dcfec03c892ca73906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nvj2IsHpyXYCOkBKP6Pmxg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda —配置为运行欢迎二进制文件的功能。</figcaption></figure><p id="ef0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们试试代码是否能如预期的那样工作。我们知道，如果该函数接收到一个用户，它将打印用户的姓名。滚动到AWS Lambda控制台中欢迎功能仪表板的顶部，找到一个下拉菜单，上面写着“选择一个测试事件”。我们将配置一个测试事件，以确保该功能正常工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/73d8a0803572607ff02078d681819f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6wtqGt1O3MJLhCeFUu0dA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda——为函数设置测试用例很容易</figcaption></figure><p id="91f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们会发现一个对话框，允许我们创建测试输入，并将其传递给我们编写的函数。在我的例子中，我将使用hello-world模板并修改JSON输入以匹配我们的用户结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/d8a14c62063bb56344787a64e5bed6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wuPSM5AKs_WFy_C9M2nFg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda——测试欢迎界面中的用户输入</figcaption></figure><p id="0c68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后按Create，然后在选择新创建的测试后单击右上角的“测试”按钮。</p><p id="61a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的图片中，你可以看到输出，因为它是迎接我。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/ce384cdd0b8bc936577c8803953e348d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2YICuvhga7Qz1Op-lgIbCw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda —我已经选择了我的欢迎测试，并按下测试按钮来执行它。输出似乎正确</figcaption></figure><p id="7104" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了，我们可以执行自定义代码。然而，这并不能帮助我们的网站。他们之间没有联系。</p><h2 id="e16a" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">AWS API网关Lambda和Amplify之间的RESTful API</h2><p id="c0f4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">Amazon API Gateway是一种服务，它提供了一种在我们的其他应用程序前面插入API的方法。你可以在AWS网站上阅读关于<a class="ae ky" href="https://aws.amazon.com/api-gateway/" rel="noopener ugc nofollow" target="_blank"> API网关</a>的内容。可以把它看作是我们的Amplify和Lambda服务之间的通信器。</p><blockquote class="od oe of"><p id="473b" class="kz la og lb b lc ld ju le lf lg jx lh oh lj lk ll oi ln lo lp oj lr ls lt lu im bi translated">Amazon API Gateway是一个完全托管的服务，使开发人员可以轻松地创建、发布、维护、监控和保护任何规模的API。API充当应用程序从后端服务访问数据、业务逻辑或功能的“前门”。</p></blockquote><p id="a909" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从访问<a class="ae ky" href="https://console.aws.amazon.com/apigateway/main/apis?region=us-east-1" rel="noopener ugc nofollow" target="_blank"> API网关控制台</a>开始。不要忘记像我们在其他服务中所做的那样切换区域。</p><p id="45d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您想要创建的网关，网关将为您提供一些选项。我们将继续使用REST API。选择在未标记为私有的REST API上构建。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/acd182349b5fcf7b2a74f538d68c4e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R1yXWen-dAnkA6pnJIqekQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—创建多种API的选项</figcaption></figure><p id="d3f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建API后，他们将为我们生成一个示例API。快速阅读这个API可以很好地了解可以做什么。</p><p id="7246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择“新API”并为该API设置一个API名称。我们还将选择端点类型。根据AWS指南，对于拥有广泛地理分布客户的网站，建议使用Edge Optimized。设置配置后，按下蓝色的<strong class="lb iu">创建API </strong>按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/0ac71f43921e0f5ee6ec37e0cde498cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g_wrvwUQQOL_dq1eyx15VA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—生成一个名为GreeterAPI的新REST API。</figcaption></figure><p id="14f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将看到一个视图，显示API当前拥有的所有方法。我们还没有任何方法，所以它将是空的。我们将从创建一个新方法开始，选择<strong class="lb iu">动作</strong>下拉菜单和<strong class="lb iu">创建方法。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/9ba9bd270a8ea3ca6a6b45746ad3d467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfIeKNcQ2DAHG0DJP9bFyg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—为API创建新方法。</figcaption></figure><p id="aced" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将生成一个新的下拉列表，我们可以在其中选择要使用的HTTP方法。我们希望我们的端点监听帖子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/0e63a807c563c7b20901958306beb96d.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*sQPrd78se3sSn_HuaEOxbw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">选择HTTP Post作为要使用的端点方法</figcaption></figure><p id="2745" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将看到一个新的屏幕，允许我们配置当POST到达端点时会发生什么。我们将希望执行我们之前创建的lambda函数，因此选择<strong class="lb iu"> Lambda函数作为集成类型。</strong> <br/>我们还需要输入Lambda函数的名称，在我的例子中，我将其命名为Greeter。不要忘记点击蓝色闪亮的保存按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/5d997c0e7bb15f2a5bb71e58cf4d6e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i3gHK9SyzpwGFFc9JqJDkA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—设置在HTTP端点上执行的Lambda函数。</figcaption></figure><p id="b45d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它会提示您是否允许调用lambda函数。取消是没有意义的，我们希望这是允许的，所以接受吧。</p><p id="b8eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将看到API端点的可视化。它在左侧向我们展示了客户端，以及请求是如何被传输到我们的Lambda Greeter上，然后作为响应返回的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/2891cab5e2eae282a40b5eed6735dcff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngOC5LljqT3ZWkghYLYm-A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关API的可视化</figcaption></figure><p id="c6e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们单击客户机上的TEST按钮，并发出一个测试请求，以确保它正在工作。我们可以很容易地添加一个JSON请求，并在浏览器中测试它。我已经测试过了，看起来我得到了正确的问候。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/9cccb613a2088c49c8d166c339d4682f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2Mo4kRY--VKZfkwm_o4mw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—简化端点测试。</figcaption></figure><p id="7f7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一件事要做，就是启用CORS。如果你不知道CORS是什么，我建议你读一下<a class="ae ky" href="https://medium.com/@baphemot/understanding-cors-18ad6b478e2b" rel="noopener">CORS是什么？</a>巴尔托什·什切青斯基<a class="pa pb ep" href="https://medium.com/u/a5f578f5b81a?source=post_page-----2c14369aa66b--------------------------------" rel="noopener" target="_blank">的一篇漂亮文章</a>。在这种情况下，它允许来自任何地区的请求通过网关，这是我们想要的。</p><p id="5a48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择发布端点并转到<strong class="lb iu">动作</strong>下拉菜单。有一个选项叫做<strong class="lb iu">启用CORS。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/de7d02bb6854990251022d668e389ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*MH0IUoU93J63oYYdMnp4lQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—启用CORS轻而易举。</figcaption></figure><p id="d583" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择它将打开一个带有几个选项的表单。对于本教程，只是让它保持原样，并按下蓝色的“启用CORS和替换现有的CORS标题”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/94a12d59b683a082d57f699e06dec754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLaiIhQ2ATmqScI5UI595w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关— CORS可通过自定义标题进行高度定制。</figcaption></figure><p id="84ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将提示您将要应用的更改摘要，接受它们。</p><p id="ab76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是部署API。再次进入<strong class="lb iu">动作</strong>下拉菜单。并找到部署API选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/ae017a0398d54d8f93977d32d9c0699c.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*wXL8HGAcVLIcVcM1xsnQtw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—通过简单的按键部署API</figcaption></figure><p id="f956" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按下Deploy API将显示一个表单，要求我们命名API。我已经命名了我的发展。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/a83bed5bb1b7eeab02e9454874aea2ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*z6mQqI9CrAWks2e5ufiP2g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—命名API</figcaption></figure><p id="7064" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您将从“资源”选项卡移至“阶段”选项卡。开发阶段有大量的设置，我们不会在本指南中涉及它们。</p><p id="b2dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我建议保存调用URL，这是我们将找到API的URL。它位于开发阶段编辑器的顶部。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/eba7853746947c327d412f0d533d90bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*93V8mthI3ESQPVpJerRW1Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS网关—为我们生成了调用API端点的URL。</figcaption></figure><p id="2219" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们现在有了一个运行Amplify的前端，一个运行Lambda的后端和一个API。但我们还没有一起使用它们，我们将改变它，以便网站可以接受名字和姓氏，并问候任何填写表格的人。我们还将创建一个用于lambda的数据库。</p><h2 id="7767" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">自动气象站dynamo db——NoSQL数据库</h2><p id="642a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们将使用的下一个服务是<a class="ae ky" href="https://aws.amazon.com/dynamodb/?trk=ps_a134p000006pavYAAQ&amp;trkCampaign=acq_paid_search_brand&amp;sc_channel=PS&amp;sc_campaign=acquisition_ND&amp;sc_publisher=Google&amp;sc_category=Database&amp;sc_country=ND&amp;sc_geo=EMEA&amp;sc_outcome=acq&amp;sc_detail=amazon%20dynamodb&amp;sc_content=DynamoDB_e&amp;sc_matchtype=e&amp;sc_segment=495122367971&amp;sc_medium=ACQ-P|PS-GO|Brand|Desktop|SU|Database|DynamoDB|ND|EN|Text|xx|EU&amp;s_kwcid=AL!4422!3!495122367971!e!!g!!amazon%20dynamodb&amp;ef_id=Cj0KCQiApY6BBhCsARIsAOI_Gjay2uhSZfAVgAP3_ZXXZgg3BFi7wjPyoUmOcBi99AT9dMrc2zHSU-4aAnHrEALw_wcB:G:s&amp;s_kwcid=AL!4422!3!495122367971!e!!g!!amazon%20dynamodb" rel="noopener ugc nofollow" target="_blank"> Amazon DynamoDB。</a>这是一个键值数据库，可以在我们的AWS基础设施内部使用。</p><blockquote class="od oe of"><p id="3add" class="kz la og lb b lc ld ju le lf lg jx lh oh lj lk ll oi ln lo lp oj lr ls lt lu im bi translated">Amazon DynamoDB是一个键值和文档数据库，在任何规模下都能提供一位数的毫秒级性能。— <a class="ae ky" href="https://aws.amazon.com/dynamodb/?trk=ps_a134p000006pavYAAQ&amp;trkCampaign=acq_paid_search_brand&amp;sc_channel=PS&amp;sc_campaign=acquisition_ND&amp;sc_publisher=Google&amp;sc_category=Database&amp;sc_country=ND&amp;sc_geo=EMEA&amp;sc_outcome=acq&amp;sc_detail=amazon%20dynamodb&amp;sc_content=DynamoDB_e&amp;sc_matchtype=e&amp;sc_segment=495122367971&amp;sc_medium=ACQ-P|PS-GO|Brand|Desktop|SU|Database|DynamoDB|ND|EN|Text|xx|EU&amp;s_kwcid=AL!4422!3!495122367971!e!!g!!amazon%20dynamodb&amp;ef_id=Cj0KCQiApY6BBhCsARIsAOI_Gjay2uhSZfAVgAP3_ZXXZgg3BFi7wjPyoUmOcBi99AT9dMrc2zHSU-4aAnHrEALw_wcB:G:s&amp;s_kwcid=AL!4422!3!495122367971!e!!g!!amazon%20dynamodb" rel="noopener ugc nofollow" target="_blank"> AWS DynamoDB </a></p></blockquote><p id="bac6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用数据库来存储用户。首先访问<a class="ae ky" href="https://eu-north-1.console.aws.amazon.com/dynamodb/home?region=eu-north-1#gettingStarted:" rel="noopener ugc nofollow" target="_blank"> DynamoDB控制台</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/71eb9c006c42b405fddc16ceff9272a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHcCl8yD-09483DtbRBu1A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS — DynamoDB一个易于实现的数据库</figcaption></figure><p id="ef98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择Create table并在表单中填写所需的配置。我们需要命名该表并设置一个主键。我将它命名为Users，并将使用一个ID作为主键。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/009707c2618d285178ea2fea079a1bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gw2syClvBdr09vTr-ubHUA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS DynamoDB —创建一个表并对其进行配置。</figcaption></figure><p id="4db4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦创建了表，您将看到一个新视图，您可以在其中进一步配置和修改表。让我们保持简单，复制<strong class="lb iu">亚马逊资源名称</strong> (ARN)。它位于底部<strong class="lb iu">的<strong class="lb iu">工作台细节</strong>内。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/babf1101b73c8c05a6f5b0083803f59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I9L6EIqLBbehKrV1fhvGrw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS DynamoDB —以后需要使用ARN</figcaption></figure><p id="3b47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据库启动了，但是我们不能连接到它，除非我们允许Lambda函数访问。再次打开<a class="ae ky" href="https://eu-north-1.console.aws.amazon.com/lambda/home?region=eu-north-1" rel="noopener ugc nofollow" target="_blank"> AWS Lambda控制台</a>，进入欢迎功能。导航到欢迎界面中的<strong class="lb iu">权限</strong>选项卡。然后我们将<strong class="lb iu">单击执行角色</strong>字段中的链接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/fba29848bfcb5a2fb842ef463f5610ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpvGZWQUemflx63YRFwXqQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Lambda —执行角色，一个我们可以编辑访问的地方</figcaption></figure><p id="b845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将获得一项名为<strong class="lb iu">身份和访问管理(IAM) </strong>的新服务。我不会涵盖它的所有细节，我会留给好奇的人，你可以在这里阅读。我们将向欢迎者角色添加一个新的内嵌策略。这可以通过点击<strong class="lb iu">添加内联策略</strong>来完成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/bb5ef8b6366c59fa3b6b92894e00a37c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1iLJGcpWttR-DuM5CpZrA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS IAM —向欢迎者角色添加新的内嵌策略</figcaption></figure><p id="ea34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出现新屏幕时，按下<strong class="lb iu">JSON字段继续。你可以使用可视化编辑器，但我觉得它不可靠。JSON简单快捷。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/d84860d7b049fbc82ed5eee45cb2c67e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgYVUh5MiIysjfj2y4A5vg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS IAM —允许服务通过IAM相互联系。</figcaption></figure><p id="1ca5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制下面的要点并将其插入到JSON字段中，但是记住<strong class="lb iu">用DynamoDB表中显示的ARN </strong>替换整个资源字段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">JSON IAM中提供的配置，不要忘记替换资源字段。</figcaption></figure><p id="3e01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">插入JSON后，按下“<strong class="lb iu">审查政策</strong>按钮。系统将提示您一个字段，要求您为策略命名。输入一个易于记忆和理解的名称。完成后按下<strong class="lb iu">创建策略</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/931e5a71e0d446c03ff6bab3b2e8461d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_ZP26nTJ4ozCw7fXpv9Iw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS IAM —命名策略</figcaption></figure><p id="9b6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦完成，我们就允许Lambda访问数据库。我们仍然需要更新lambda代码，以便它可以对数据库做任何事情。</p><p id="fe26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在将更新欢迎应用程序中的main.go代码，如下所示。我们将使用的代码非常简单，只会将任何用户推入数据库，没有重复检查或任何东西。让我们专注于学习AWS中的诀窍，而不是学习坚实的软件工程。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">main.go lambda已更新，可在数据库中存储问候的用户。</figcaption></figure><p id="f74c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要忘记重新构建二进制文件并将其压缩。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="17a7" class="lv lw it nk b gy no np l nq nr">GOOS=linux go build -o Greeter main.go<br/>zip Greeter.zip Greeter</span></pre><p id="5000" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在给你一个小小的阅读喘息的机会，由你来重复我们之前上传Lambda 的步骤。这可能是一次有用的训练。进入AWS Lambda控制台，选择欢迎功能并上传新的ZIP文件。重新运行欢迎测试。</p><p id="ba25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切顺利，你应该会成功迎接。然后，您可以返回DynamoDB控制台，查看插入的数据。按下<strong class="lb iu">开始搜索后，可在项目选项卡内查看数据。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/b32bf495404dba059b7ae3e4a6f1c7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*Qule63nFsFLDrAk6DCZyow.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS DynamoDB —运行测试后，数据库应该注册了一个项目。</figcaption></figure><p id="6542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了，现在我们有一个数据库也在运行。剩下的就是对web应用程序进行一个小的更新来调用API网关。</p><h2 id="7a28" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">AWS Amplify —调用API</h2><p id="17b4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在我们开始修改代码之前，有一个小生活帮如果你打算坚持使用网络控制台，现在就在你的浏览器中创建一个书签文件夹。您会注意到AWS中有许多不同的服务。</p><p id="8d7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要更新HTML来包含一个小的javascript片段。javascript将向API网关发送一个请求。API托管在我告诉您保存的调用URL上。如果您不记得了，您可以在<a class="ae ky" href="https://console.aws.amazon.com/apigateway/main/" rel="noopener ugc nofollow" target="_blank"> AWS API网关中找到它。</a>调用URL可以在我们之前创建的开发阶段中找到。</p><p id="6692" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在更新后的代码中，我们将使用常规的javascript <a class="ae ky" href="https://javascript.info/fetch" rel="noopener ugc nofollow" target="_blank">获取</a>。它将向我们的网关API发出HTTP请求，我们将把响应打印到显示问候的文本区域。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">index.html展示了我们如何从网站上调用API</figcaption></figure><p id="25a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们更新存储库时，可能需要几秒钟或几分钟才能更新网站。由于我们启用了持续部署，Amplify将自动检测存储库中的变化。您可以在Amplify web控制台内部看到它是否已部署，在屏幕截图中，您可以看到它在检测到更新的存储库后正在重建我的网站。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/c4794ae01dd49215dce503fc68c65b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XI_8IsoPjip7NKY_T4WelA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS Amplify —只要我们推送至存储库，网站就会自动更新。</figcaption></figure><p id="9283" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">验证为绿色后，您可以访问该网站的网址，您应该能够输入用户名和姓氏，文本区将添加问候。如果您访问DynamoDB，您还应该看到该表用输入进行了更新。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/562dd691e91d4976ece633256ec27b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6oPu3wVPuBdPbGiR-Rqcw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">全栈网站完成-向输入姓名的用户显示问候</figcaption></figure><h2 id="1c57" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">简短回顾</h2><p id="a33a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们使用AWS Amplify来托管静态网站。<br/>该网站有一个POST表单，可以向AWS Gateway发送请求。<br/>网关API确保请求看起来正确，并将其转发到AWS Lambda。<br/> Lambda是我们可以运行定制代码的地方。Lambda连接到数据库DynamoDB。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7ec493799384901ac05747e4b9033210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLFGflqiUs41EyLwkuRkJQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@rayhennessy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">雷·轩尼诗</a>在<a class="ae ky" href="https://unsplash.com/s/photos/fireworks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d417" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！现在，您已经有了一个包含前端、后端、API和数据库的web应用程序，并且正在运行。</p><p id="9427" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇教程对你有用。记住，如果你想了解更多，AWS网站<a class="ae ky" href="https://aws.amazon.com/getting-started/?nc2=h_ql_le_gs_rc" rel="noopener ugc nofollow" target="_blank">上还有更多教程。</a></p><p id="128a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，如果您想在向您的服务器收取任何费用之前<strong class="lb iu">关闭您的AWS帐户，请确保在</strong> <a class="ae ky" href="https://console.aws.amazon.com/billing/home?#/account" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">账单</strong> </a> <strong class="lb iu">底部关闭您的帐户。或者禁用任何手动运行的服务。</strong></p><p id="4cf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">现在，走出去，AWS！</strong></p></div></div>    
</body>
</html>
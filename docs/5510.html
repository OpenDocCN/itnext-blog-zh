<html>
<head>
<title>Stop installing DB locally use Docker for local development for MongoDB or PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止本地安装DB使用Docker进行MongoDB或PostgreSQL的本地开发</h1>
<blockquote>原文：<a href="https://itnext.io/stop-installing-db-locally-use-docker-for-local-development-for-mongodb-or-postgresql-ff560893f38e?source=collection_archive---------2-----------------------#2021-03-20">https://itnext.io/stop-installing-db-locally-use-docker-for-local-development-for-mongodb-or-postgresql-ff560893f38e?source=collection_archive---------2-----------------------#2021-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/79c1998b37956ff035e434b36cb6b6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DImJzpowiqIY-xY_wAKFJg.png"/></div></div></figure><figure class="kb kc kd ke gt ju"><div class="bz fp l di"><div class="kf kg l"/></div></figure><p id="46e0" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">如果您正在阅读这篇文章，那么您可能在本地开发环境中的笔记本电脑上安装数据库时遇到了问题。</p><p id="9270" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">对我来说也一样，我在持续运行它们、清理它们或者让不同的项目使用同一个数据库时遇到了问题。有时配置东西来支持不同的版本是一场噩梦。</p><p id="22de" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">但幸运的是，我将告诉您如何避免所有这些，并保持您的开发环境干净和可预测。</p><p id="3ffc" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这很简单，但你必须使用码头集装箱。也就是说，举例来说，要在本地使用MongoDB，你必须运行MongoDB docker容器，猜猜这比在本地运行MongoDB要容易得多！</p><p id="18b4" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">虽然有一些学习曲线，但是保持环境的整洁会给你带来巨大的好处，当它不能工作的时候，不用用巨大的依赖包和配置地狱来破坏它。有了Docker container，您可以在完成项目后随时删除MongoDB container，而不必担心任何系统遗留问题。</p><p id="0b01" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">让我们在这里看一个基本的例子，以清楚地说明如何为您现有的项目使用PostgreSQL docker容器。一天前，我们已经在这个频道上完成了这个TypeScript TypeORM初学者工具包。如果你还没去看，请一定要看！</p><p id="d41a" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这个项目有一个带有连接设置的PostgreSQL依赖项，这意味着如果你在本地编码，那么你必须有一个数据库来运行这个项目。所以要运行postgres的Docker容器，我们首先要在Dockerhub上查找，那里有很好的文档<a class="ae lf" href="https://hub.docker.com/_/postgres" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/_/postgres</a></p><p id="1a0a" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">深入研究之后，您将得到一个类似这样的命令来运行您的本地数据库。</p><pre class="kb kc kd ke gt lg lh li lj aw lk bi"><span id="ed6a" class="ll lm it lh b gy ln lo l lp lq">docker run --name postgre-db -e POSTGRES_PASSWORD=password -e POSTGRES_DB=node_starter -d postgres</span></pre><p id="18fe" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">通过用<code class="fe lr ls lt lh b">docker ps</code>检查docker运行的服务，您将看到我们没有映射到主机的postgresql端口<code class="fe lr ls lt lh b">5432</code>，这意味着您的Node.js应用程序将无法访问它。</p><pre class="kb kc kd ke gt lg lh li lj aw lk bi"><span id="50fc" class="ll lm it lh b gy ln lo l lp lq">~ docker ps<br/>CONTAINER ID   IMAGE      COMMAND                  CREATED          STATUS          PORTS      NAMES<br/>fc9fd9feb427   postgres   "docker-entrypoint.s…"   30 seconds ago   Up 28 seconds   5432/tcp   postgre-db</span></pre><p id="d12d" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这意味着当我们启动一个服务时，我们必须映射一个端口，并保持它可以从主机访问。否则，它将只是一个运行在您机器上的虚拟docker容器。但是要记得移走之前做好的集装箱，否则码头工人会抱怨集装箱的命名。</p><pre class="kb kc kd ke gt lg lh li lj aw lk bi"><span id="cde1" class="ll lm it lh b gy ln lo l lp lq">~ docker kill postgre-db &amp;&amp; docker rm postgre-db<br/>~ docker run --name postgre-db -p 5432:5432 -e POSTGRES_PASSWORD=password -e POSTGRES_DB=node_starter -d postgres</span></pre><p id="feb3" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">现在，如果您运行<code class="fe lr ls lt lh b">docker ps</code>，您将看到一个很好的输出，其中包含我们的postgres端口被映射到主机的信息，并且我们现在能够从本地Node.js服务使用postgres连接。</p><pre class="kb kc kd ke gt lg lh li lj aw lk bi"><span id="e6f7" class="ll lm it lh b gy ln lo l lp lq">~ docker ps<br/>CONTAINER ID   IMAGE      COMMAND                  CREATED         STATUS         PORTS                    NAMES<br/>fb74c76f8415   postgres   "docker-entrypoint.s…"   5 seconds ago   Up 4 seconds   0.0.0.0:5432-&gt;5432/tcp   postgre-db</span></pre><p id="6b96" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">我们只需配置Node.js服务，使用与容器启动时提供的相同的PostgreSQL密码和db名称。</p><p id="c900" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">对于MongoDB或MySQL或任何其他正式作为Docker容器存在的数据库来说，这是完全相同的，因此您可以查找它们并运行命令。另一个例子是MongoDB这样使用</p><pre class="kb kc kd ke gt lg lh li lj aw lk bi"><span id="59b0" class="ll lm it lh b gy ln lo l lp lq">docker run --name mongodb -p 27017:27017 mongo</span></pre><p id="af99" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这里要简单得多，因为Mongo不要求您预先创建数据库名称，您可以使用连接字符串来创建数据库名称，模式是自动的，因此您在这里需要的配置要少得多，但是与PostgreSQL一样，您不需要在本地安装它，它只是一个Docker容器，您可以随时删除它，或者为不同的应用程序保持不同的版本，或者只更改绑定端口，甚至不需要更改数据库配置。</p><p id="b7c4" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">是啊！它给你带来了很多方便，但是要注意，每当你移除容器时，它可能会清理你的数据，你必须定义单独的Docker容器卷来保持你的数据的持久性。例如，使用MongoDB，只需将一个特定的路径挂载到一个本地目录，就可以保持数据的持久性。</p><pre class="kb kc kd ke gt lg lh li lj aw lk bi"><span id="c7ae" class="ll lm it lh b gy ln lo l lp lq">docker run --name mongodb -p 27017:27017 -v /my/own/datadir:/data/db mongo</span></pre><p id="dc28" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">现在，您的容器将把来自MongoDB数据和模式文件的所有内容放在您的<code class="fe lr ls lt lh b">/my/own/datadir</code>文件夹中，这意味着如果您移除了容器，您仍然会拥有您的数据，如果这是您对本地开发感兴趣的东西的话。</p><p id="1350" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">通常我只是不移除数据库容器，有时我只是停止它们，或者如果我重启我的机器，只要我在本地开发中需要它们，我就通过运行<code class="fe lr ls lt lh b">docker start mongodb</code>来启动它们。</p><p id="cca2" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">这可能就是这个简短但有力的提示，它帮助我保持我的系统比以前干净得多。实际上，我几乎在每个开发环境应用程序中都使用Docker，但这是一个完全不同的故事…</p><p id="1f59" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi">— —</p><p id="9e30" class="pw-post-body-paragraph kh ki it kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le im bi translated">来源<a class="ae lf" href="https://tigran.tech/running-postgresql-mongodb-and-other-databases-locally-with-docker/" rel="noopener ugc nofollow" target="_blank">https://tigran . tech/running-PostgreSQL-MongoDB-and-other-databases-locally-with-docker/</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Angular 7|6 Tutorial: Building and Submitting a Form</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular 7|6教程:构建和提交表单</h1>
<blockquote>原文：<a href="https://itnext.io/angular-7-6-tutorial-building-and-submitting-a-form-b17461c5568b?source=collection_archive---------1-----------------------#2019-01-28">https://itnext.io/angular-7-6-tutorial-building-and-submitting-a-form-b17461c5568b?source=collection_archive---------1-----------------------#2019-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f999" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，我们将学习在Angular 7中使用模板驱动的方法来处理表单。我们将学习<code class="fe kl km kn ko b">NgForm</code>、<code class="fe kl km kn ko b">ngModel</code>和<code class="fe kl km kn ko b">ngSubmit</code>指令，它们是基于模板的表单中的基本概念，以及如何用Node和Express.js创建一个认证系统</p><blockquote class="kp kq kr"><p id="d4ad" class="jn jo ks jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">注</em> </strong> <em class="iq">:本教程配合Angular 6使用。</em></p></blockquote><p id="5a5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表单和身份验证是每个Angular应用程序或任何web应用程序的常见功能。表单用于收集信息并提交给web服务器，这些信息通常保存在数据库中，而身份验证用于在允许用户访问服务器上受保护的资源之前验证用户的身份。</p><p id="2a69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，您将创建一个带有两个表单的Angular 7应用程序，这两个表单将用户信息发送到RESTful服务器并保存在数据库中(注册)，然后允许用户验证自己的身份。您将创建一个登录和注册组件，用两个表单来注册和登录用户。</p><p id="3b60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于Angular只用于前端，我们还需要一个后端服务器。我们将使用Node和Express.js快速创建一个服务器，它公开了两个端点，用于注册和验证用户。</p><h1 id="03f7" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">先决条件</h1><p id="3e6c" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">对于本教程，您需要满足一些要求:</p><ul class=""><li id="4fb4" class="lz ma iq jp b jq jr ju jv jy mb kc mc kg md kk me mf mg mh bi translated">Node.js和NPM。去他们的官方网站<a class="ae mi" href="https://www.nodejs.org/" rel="noopener ugc nofollow" target="_blank">下载你系统的二进制文件。</a></li><li id="be48" class="lz ma iq jp b jq mj ju mk jy ml kc mm kg mn kk me mf mg mh bi translated">安装最新版本的Angular CLI V7(<code class="fe kl km kn ko b">npm install -g @angular/cli</code>)。</li></ul><h1 id="f3fc" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建和设置节点和Express.js身份验证服务器</h1><p id="7cf6" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">让我们开始我们的第一步。打开终端，为前端和后端应用程序创建一个文件夹:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="0e34" class="mw kx iq ko b gy mx my l mz na">$ mkdir angular-auth-forms-demo</span></pre><p id="b365" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在其中导航并创建一个后端文件夹:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="37c4" class="mw kx iq ko b gy mx my l mz na">$ cd angular-auth-forms-demo <br/>$ mkdir backend <br/>$ cd backend</span></pre><p id="1d00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，通过运行以下命令创建Node.js模块:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="f50d" class="mw kx iq ko b gy mx my l mz na">$ npm init -y</span></pre><p id="c2a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将创建一个带有默认值的<code class="fe kl km kn ko b">package.json</code>文件，如果你愿意，你可以在以后修改它。现在，运行以下命令来安装依赖项:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="1283" class="mw kx iq ko b gy mx my l mz na">$ npm install --save express body-parser sqlite3 bcryptjs jsonwebtoken cors</span></pre><p id="51bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将安装express.js和一系列其他模块，例如用于SQLite数据库的<code class="fe kl km kn ko b">sqlite3</code>和用于JSON web令牌或jwt的<code class="fe kl km kn ko b">jsonwebtoken</code>。</p><blockquote class="kp kq kr"><p id="6297" class="jn jo ks jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">注意</em> </strong> <em class="iq">:在撰写本文时，将安装以下页面和版本:cors v2.8.5、body-parser v1.18.3、sqlite3 v4.0.6、bcryptjs v2.4.3 express v4.16.4和jsonwebtoken v8.4.0 </em></p></blockquote><p id="3465" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，创建一个<code class="fe kl km kn ko b">index.js</code>文件并添加:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="7ec9" class="mw kx iq ko b gy mx my l mz na">"use strict";<br/>const  express  =  require('express');<br/>const  bodyParser  =  require('body-parser');<br/>const cors = require('cors')<br/><br/>const  sqlite3  =  require('sqlite3').verbose();<br/>const  jwt  =  require('jsonwebtoken');<br/>const  bcrypt  =  require('bcryptjs');<br/><br/>const SECRET_KEY = "secretkey23456";<br/><br/>const  app  =  express();<br/>const  router  =  express.Router();<br/>app.use(cors())<br/>router.use(bodyParser.urlencoded({ extended:  false }));<br/>router.use(bodyParser.json());<br/>const database = new sqlite3.Database("./my.db");<br/><br/>const  createUsersTable  = () =&gt; {<br/>    const  sqlQuery  =  `<br/>        CREATE TABLE IF NOT EXISTS users (<br/>        id integer PRIMARY KEY,<br/>        name text,<br/>        email text UNIQUE,<br/>        password text)`;<br/><br/>    return  database.run(sqlQuery);<br/>}<br/><br/>const  findUserByEmail  = (email, cb) =&gt; {<br/>    return  database.get(`SELECT * FROM users WHERE email = ?`,[email], (err, row) =&gt; {<br/>            cb(err, row)<br/>    });<br/>}<br/><br/>const  createUser  = (user, cb) =&gt; {<br/>    return  database.run('INSERT INTO users (name, email, password) VALUES (?,?,?)',user, (err) =&gt; {<br/>        cb(err)<br/>    });<br/>}<br/><br/>createUsersTable();<br/><br/>router.get('/', (req, res) =&gt; {<br/>    res.status(200).send('This is an authentication server');<br/>});<br/><br/>router.post('/register', (req, res) =&gt; {<br/><br/>    const  name  =  req.body.name;<br/>    const  email  =  req.body.email;<br/>    console.log(req.body);<br/>    const  password  =  bcrypt.hashSync(req.body.password);<br/><br/>    createUser([name, email, password], (err)=&gt;{<br/>        if(err) return  res.status(500).send("Server error!");<br/>        findUserByEmail(email, (err, user)=&gt;{<br/>            if (err) return  res.status(500).send('Server error!');  <br/>            const  expiresIn  =  24  *  60  *  60;<br/>            const  accessToken  =  jwt.sign({ id:  user.id }, SECRET_KEY, {<br/>                expiresIn:  expiresIn<br/>            });<br/>            res.status(200).send({ "user":  user, "access_token":  accessToken, "expires_in":  expiresIn          <br/>            });<br/>        });<br/>    });<br/>});<br/><br/><br/>router.post('/login', (req, res) =&gt; {<br/>    const  email  =  req.body.email;<br/>    const  password  =  req.body.password;<br/>    findUserByEmail(email, (err, user)=&gt;{<br/>        if (err) return  res.status(500).send('Server error!');<br/>        if (!user) return  res.status(404).send('User not found!');<br/>        const  result  =  bcrypt.compareSync(password, user.password);<br/>        if(!result) return  res.status(401).send('Password not valid!');<br/><br/>        const  expiresIn  =  24  *  60  *  60;<br/>        const  accessToken  =  jwt.sign({ id:  user.id }, SECRET_KEY, {<br/>            expiresIn:  expiresIn<br/>        });<br/>        res.status(200).send({ "user":  user, "access_token":  accessToken, "expires_in":  expiresIn});<br/>    });<br/>});<br/><br/>app.use(router);<br/>const  port  =  process.env.PORT  ||  3000;<br/>const  server  =  app.listen(port, () =&gt; {<br/>    console.log('Server listening at <a class="ae mi" href="http://localhost/" rel="noopener ugc nofollow" target="_blank">http://localhost</a>:'  +  port);<br/>});</span></pre><p id="b364" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们不打算在这里解释这段代码，因为它在之前的教程中已经详细介绍过了。如果想了解上面的代码是如何工作的，可以先阅读<a class="ae mi" href="https://www.techiediaries.com/node-express-jwt-authentication/" rel="noopener ugc nofollow" target="_blank"> Node Express JWT认证— jsonwebtoken和bcryptjs </a>。</p><p id="dad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在<code class="fe kl km kn ko b">package.json</code>中添加一个<code class="fe kl km kn ko b">start</code>脚本:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="ec7e" class="mw kx iq ko b gy mx my l mz na">"scripts": { "start": "node index.js" },</span></pre><p id="6538" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该脚本将允许您使用以下命令从终端运行Express.js服务器:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="a34f" class="mw kx iq ko b gy mx my l mz na">$ npm start</span></pre><p id="26b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你的服务器将由<code class="fe kl km kn ko b">http://localhost:3000</code>提供服务。因为我们的服务器公开了一个GET route，你可以用你的web浏览器访问它。您应该会看到一个空白页，显示<strong class="jp ir">这是一个认证服务器</strong>消息。这意味着您的认证服务器正在工作！</p><p id="7eae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们创建Angular 7 UI之前，您还可以使用Postman或cURL之类的REST API客户端向在SQLite数据库中创建的<code class="fe kl km kn ko b">/register</code>和<code class="fe kl km kn ko b">/login</code>端点发送POST请求，并对用户进行身份验证。</p><p id="1076" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，这是使用cURL发送POST请求的方式:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="1bba" class="mw kx iq ko b gy mx my l mz na">curl -H "Content-Type: application/json" -d '{"email":"user@email.com","name":"user", "password":"password"}' <a class="ae mi" href="http://localhost:3000/register" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/register</a></span></pre><p id="3611" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，您可以发送另一个POST请求来验证您刚刚创建的用户:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="1f82" class="mw kx iq ko b gy mx my l mz na">curl -H "Content-Type: application/json" -d '{"email":"user@email.com", "password":"password"}' <a class="ae mi" href="http://localhost:3000/login" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/login</a></span></pre><p id="d0e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果POST请求成功，您应该得到一个JSON对象，其中包含您的用户信息、访问令牌和到期日期，否则您将得到一个带有状态代码的错误。</p><p id="7d80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">服务器部分到此为止！您应该让这个终端打开，让您的服务器运行，让我们开始创建Angular 7应用程序。</p><h1 id="68e6" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建Angular 7应用程序</h1><p id="8a28" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">打开一个新的终端，导航到您的项目文件夹，然后运行以下命令，使用Angular CLI 7生成前端项目:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="2ff5" class="mw kx iq ko b gy mx my l mz na">$ ng new frontend</span></pre><p id="d6b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果<strong class="jp ir">您想要添加角度路由，系统会提示您？</strong>输入<strong class="jp ir"> y </strong>。您希望使用哪种样式表格式？选择<strong class="jp ir"> CSS </strong>。</p><p id="ca78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用以下命令启动开发服务器:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="e22c" class="mw kx iq ko b gy mx my l mz na">$ ng serve</span></pre><p id="4bac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在首选的网络浏览器中通过<code class="fe kl km kn ko b">http://localhost:4200</code>访问您的应用程序。</p><h1 id="92fd" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建角度为7°的模块</h1><p id="3a39" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">我们将把本教程的代码添加到它自己的封装认证的Angular模块中。回到您的终端，运行以下命令:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="add9" class="mw kx iq ko b gy mx my l mz na">$ ng generate module auth --routing</span></pre><p id="cc97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将创建一个带路由的模块<code class="fe kl km kn ko b">auth</code>(多亏了<code class="fe kl km kn ko b">--routing</code>开关)。将创建两个<code class="fe kl km kn ko b">src/app/auth/auth-routing.module.ts</code>(<code class="fe kl km kn ko b">auth</code>模块的路由模块)和<code class="fe kl km kn ko b">src/app/auth/auth.module.ts</code>文件。</p><h1 id="8b9a" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">生成角度7分量</h1><p id="7fc3" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">接下来，我们将在<code class="fe kl km kn ko b">auth</code>模块中为登录和注册生成两个组件。在您的终端中，运行以下命令:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="54cf" class="mw kx iq ko b gy mx my l mz na">$ ng generate component auth/register <br/>$ ng generate component auth/login</span></pre><p id="af47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以看到，我们在组件名称前添加了路径<code class="fe kl km kn ko b">auth/</code>，这告诉CLI在<code class="fe kl km kn ko b">auth</code>模块中生成它们。</p><p id="3269" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">组件将自动导入并在<code class="fe kl km kn ko b">auth</code>模块中声明。这是<code class="fe kl km kn ko b">src/app/auth/auth.module.ts</code>文件的内容:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="fa33" class="mw kx iq ko b gy mx my l mz na">import { NgModule } from '@angular/core';<br/>import { CommonModule } from '@angular/common';<br/><br/>import { AuthRoutingModule } from './auth-routing.module';<br/>import { RegisterComponent } from './register/register.component';<br/>import { LoginComponent } from './login/login.component';<br/><br/>@NgModule({<br/>  declarations: [RegisterComponent, LoginComponent],<br/>  imports: [<br/>    CommonModule,<br/>    AuthRoutingModule<br/>  ]<br/>})<br/>export class AuthModule { }</span></pre><h1 id="4af0" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">添加角度布线</h1><p id="95bf" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">下一步是在应用程序的不同组件之间添加路由。打开<code class="fe kl km kn ko b">src/app/auth/auth-routing.module.ts</code>文件，更新如下:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="b71a" class="mw kx iq ko b gy mx my l mz na">import { NgModule } from '@angular/core';<br/>import { Routes, RouterModule } from '@angular/router';<br/><br/>import { RegisterComponent } from './register/register.component';<br/>import { LoginComponent } from './login/login.component';<br/><br/>const routes: Routes = [<br/>  {path: 'register', component: RegisterComponent},<br/>  {path: 'login', component: LoginComponent},<br/><br/>];<br/><br/>@NgModule({<br/>  imports: [RouterModule.forChild(routes)],<br/>  exports: [RouterModule]<br/>})<br/>export class AuthRoutingModule { }</span></pre><p id="df58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们首先从相应的路径中导入<code class="fe kl km kn ko b">RegisterComponent</code>和<code class="fe kl km kn ko b">LoginComponent</code>组件，并在<code class="fe kl km kn ko b">routes</code>数组中添加两条路由，该数组通过<code class="fe kl km kn ko b">forChild()</code>方法传递给Router。</p><p id="d110" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于这是一个子模块，我们还需要在应用程序的根路由模块中添加一个路由，因此打开<code class="fe kl km kn ko b">src/app/app-routing.module.ts</code>文件，将下面的路由添加到传递给<code class="fe kl km kn ko b">forRoot()</code>方法的<code class="fe kl km kn ko b">routes</code>数组中:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="4301" class="mw kx iq ko b gy mx my l mz na">const  routes:  Routes  = [<br/>    {path:  'auth', loadChildren:  './auth/auth.module#AuthModule'}<br/>];</span></pre><p id="f963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用route的<code class="fe kl km kn ko b">loadChildren</code>属性，该属性采用<code class="fe kl km kn ko b">auth</code>模块的路径。</p><p id="0617" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们使用了<code class="fe kl km kn ko b">auth</code>路径，所以<code class="fe kl km kn ko b">auth</code>模块的所有组件将在<code class="fe kl km kn ko b">/auth</code>路径下可用，即<code class="fe kl km kn ko b">/auth/register</code>和<code class="fe kl km kn ko b">/auth/login</code>路径。</p><h1 id="b026" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">设计用户界面</h1><p id="470b" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">为了设计用户界面，我们将从这个<a class="ae mi" href="https://codepen.io/tezjnr/pen/wWvVVB" rel="noopener ugc nofollow" target="_blank">代码笔</a>中获得灵感。</p><p id="6945" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经添加了路由，让我们构建应用程序的UI。让我们从路由器出口所在的主要应用程序组件开始，即应用程序的外壳。打开<code class="fe kl km kn ko b">src/app/app.component.html</code>，移除除路由器出口之外的所有东西:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="16ee" class="mw kx iq ko b gy mx my l mz na">&lt;router-outlet&gt;&lt;/router-outlet&gt;</span></pre><p id="aaa9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe kl km kn ko b">src/styles.css</code>文件，添加:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="b96f" class="mw kx iq ko b gy mx my l mz na">@import url('<a class="ae mi" href="https://netdna.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.css" rel="noopener ugc nofollow" target="_blank">https://netdna.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.css</a>');<br/>@import url(<a class="ae mi" href="https://fonts.googleapis.com/css?family=Lato:400,300,700" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/css?family=Lato:400,300,700</a>);<br/><br/>html {<br/>   height: 100%;<br/>}<br/><br/>body {<br/>    display: flex;<br/>    justify-content: center;<br/>    align-items: center;<br/>    min-height: 100%;<br/>    font-family: 'lato', sans-serif;<br/>    color: #fff;<br/>    background: rgb(10, 113, 182); <br/>}</span></pre><h1 id="1589" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">设置角度形式</h1><p id="7437" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">Angular提供了两种处理表单的方式，基于模板的表单和反应式表单。在这个例子中，我们将使用基于模板的表单，包括<code class="fe kl km kn ko b">FormsModule</code>并使用类似<code class="fe kl km kn ko b">ngModel</code>的指令进行数据绑定。</p><p id="3aba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe kl km kn ko b">src/app/auth/auth.module.ts</code>文件，导入<code class="fe kl km kn ko b">FormsModule</code>，然后添加到模块的<code class="fe kl km kn ko b">imports</code>数组中；</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="f1f5" class="mw kx iq ko b gy mx my l mz na">import { NgModule } from '@angular/core';<br/>import { CommonModule } from '@angular/common';<br/>import { FormsModule } from '@angular/forms';<br/><br/>import { AuthRoutingModule } from './auth-routing.module';<br/>import { RegisterComponent } from './register/register.component';<br/>import { LoginComponent } from './login/login.component';<br/><br/>@NgModule({<br/>  declarations: [RegisterComponent, LoginComponent],<br/>  imports: [<br/>    CommonModule,<br/>    FormsModule,<br/>    AuthRoutingModule<br/>  ]<br/>})<br/>export class AuthModule { }</span></pre><h1 id="ae7c" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建注册表单:使用带有<code class="fe kl km kn ko b">ngModel</code>、<code class="fe kl km kn ko b">ngForm</code>和<code class="fe kl km kn ko b">ngSubmit</code>指令的基于模板的表单</h1><p id="0339" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">在本节中，我们将使用诸如<code class="fe kl km kn ko b">ngModel</code>、<code class="fe kl km kn ko b">ngForm</code>和<code class="fe kl km kn ko b">ngSubmit</code>之类的角度指令来创建一个基于模板的表单，用于注册用户。</p><p id="5c1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe kl km kn ko b">src/app/auth/register/register.component.html</code>文件，添加一个HTML表单，用于提交用户的姓名、电子邮件和密码:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="9a5d" class="mw kx iq ko b gy mx my l mz na">&lt;div class="container"&gt;<br/>    &lt;div class="logo"&gt;Create a new account!&lt;/div&gt;<br/>    &lt;div class="register-item"&gt;<br/>      &lt;form #myform="ngForm" (ngSubmit)="register(myform)" class="form form-register"&gt;<br/><br/>        &lt;div class="form-field"&gt;<br/>              &lt;label class="user" for="register-username"&gt;&lt;span class="hidden"&gt;Name&lt;/span&gt;&lt;/label&gt;<br/>              &lt;input name="name" id="register-username" type="email" class="form-input" placeholder="Name" ngModel required&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="form-field"&gt;<br/>          &lt;label class="user" for="register-email"&gt;&lt;span class="hidden"&gt;Email&lt;/span&gt;&lt;/label&gt;<br/>          &lt;input name="email" id="register-email" type="email" class="form-input" placeholder="Email" ngModel required&gt;<br/>        &lt;/div&gt;<br/><br/>        &lt;div class="form-field"&gt;<br/>          &lt;label class="lock" for="register-password"&gt;&lt;span class="hidden"&gt;Password&lt;/span&gt;&lt;/label&gt;<br/>          &lt;input name="password" id="register-password" type="password" class="form-input" placeholder="Password" ngModel required&gt;<br/>        &lt;/div&gt;<br/><br/>        &lt;div class="form-field"&gt;<br/>          &lt;input type="submit" value="Register"&gt;<br/>        &lt;/div&gt;<br/>      &lt;/form&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><ul class=""><li id="9c9a" class="lz ma iq jp b jq jr ju jv jy mb kc mc kg md kk me mf mg mh bi translated">对于每个<code class="fe kl km kn ko b">input</code>控件，我们单独使用<code class="fe kl km kn ko b">ngModel</code>指令将控件注册为表单的子控件。</li><li id="9d27" class="lz ma iq jp b jq mj ju mk jy ml kc mm kg mn kk me mf mg mh bi translated">对于每个输入，我们向<code class="fe kl km kn ko b">input</code>控件添加一个<code class="fe kl km kn ko b">name</code>属性。当使用基于模板的表单和<code class="fe kl km kn ko b">ngModel</code>指令时，这是必需的。</li><li id="073e" class="lz ma iq jp b jq mj ju mk jy ml kc mm kg mn kk me mf mg mh bi translated">我们使用<code class="fe kl km kn ko b">#myform="ngForm"</code>语法为表单声明一个模板变量。变量<code class="fe kl km kn ko b">myform</code>成为包含表单所有控件的<code class="fe kl km kn ko b">NgForm</code>实例的引用。</li></ul><p id="0d44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Angular docs是这样描述<a class="ae mi" href="https://angular.io/api/forms/NgModel" rel="noopener ugc nofollow" target="_blank"> NgModel </a>的:</p><blockquote class="kp kq kr"><p id="20d4" class="jn jo ks jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated"><em class="iq">它从一个域模型中创建一个</em> <code class="fe kl km kn ko b"><em class="iq">[FormControl](https://angular.io/api/forms/FormControl)</em></code> <em class="iq">实例，并将其绑定到一个表单控件元素。</em> <code class="fe kl km kn ko b"><em class="iq">FormControl</em></code> <em class="iq">实例跟踪控件的值、用户交互和验证状态，并保持视图与模型同步。如果在父窗体中使用，该指令还会将自身注册到窗体中作为子控件。这个指令可以单独使用，也可以作为一个更大的表单的一部分。使用</em> <code class="fe kl km kn ko b"><em class="iq">[ngModel](https://angular.io/api/forms/NgModel)</em></code> <em class="iq">选择器将其激活。</em></p></blockquote><p id="e639" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<a class="ae mi" href="https://angular.io/api/forms/NgForm" rel="noopener ugc nofollow" target="_blank">n表格</a>指令:</p><blockquote class="kp kq kr"><p id="201d" class="jn jo ks jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated"><em class="iq">它创建一个顶级</em> <code class="fe kl km kn ko b"><em class="iq">[FormGroup](https://angular.io/api/forms/FormGroup)</em></code> <em class="iq">实例，并将其绑定到一个表单，以跟踪聚合表单值和验证状态。</em></p><p id="64ba" class="jn jo ks jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated"><em class="iq">一旦导入</em> <code class="fe kl km kn ko b"><em class="iq">[FormsModule](https://angular.io/api/forms/FormsModule)</em></code> <em class="iq">，该指令在所有</em> <code class="fe kl km kn ko b"><em class="iq">&lt;form&gt;</em></code> <em class="iq">标签上默认变为活动状态。不需要添加特殊的选择器。</em></p><p id="7c1d" class="jn jo ks jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated"><em class="iq">您可以选择使用</em> <code class="fe kl km kn ko b"><em class="iq">[ngForm](https://angular.io/api/forms/NgForm)</em></code> <em class="iq">作为关键字(例如:</em> <code class="fe kl km kn ko b"><em class="iq">#myForm="[ngForm](https://angular.io/api/forms/NgForm)"</em></code> <em class="iq">)将指令导出到一个本地模板变量中。</em></p></blockquote><p id="cd38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，您需要定义传递给表单的<code class="fe kl km kn ko b">ngSubmit</code>事件的<code class="fe kl km kn ko b">register(myform)</code>方法。打开<code class="fe kl km kn ko b">src/app/auth/register/register.component.ts</code>文件并添加:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="ff23" class="mw kx iq ko b gy mx my l mz na">register(form) { console.log(form.value); }</span></pre><p id="2273" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们监听表单<code class="fe kl km kn ko b">ngSubmit</code>事件，所以当用户提交表单时，我们执行<code class="fe kl km kn ko b">register(form)</code>方法，该方法引用提交的<code class="fe kl km kn ko b">NgForm</code>实例。</p><p id="a988" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用<code class="fe kl km kn ko b">NgForm</code>的<code class="fe kl km kn ko b">value</code>属性来读取表单的值。</p><p id="ae69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您填写表单并单击register按钮，您应该看到表单的值作为JSON对象打印在浏览器控制台上。</p><p id="1ed3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看我们如何在本教程中使用<code class="fe kl km kn ko b">HttpClient</code> POST请求向Express.js认证服务器提交表单内容:<a class="ae mi" href="https://www.techiediaries.com/angular-tutorial-httpclient-post/" rel="noopener ugc nofollow" target="_blank">使用Angular HttpClient和节点&amp; Express.js -示例POST请求</a>。</p><p id="8616" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe kl km kn ko b">src/app/auth/register/register.component.css</code>文件，添加以下样式:</p><figure class="mo mp mq mr gt nb"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="d29b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们注册页面的截图:</p><figure class="mo mp mq mr gt nb gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/d742aa8eba7f6665f983b43602565952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/0*Cn1sMOrveTIcGhqk.jpg"/></div></figure><h1 id="d457" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建登录表单:使用带有<code class="fe kl km kn ko b">ngModel</code>、<code class="fe kl km kn ko b">ngForm</code>和<code class="fe kl km kn ko b">ngSubmit</code>指令的基于模板的表单</h1><p id="f457" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">与我们创建注册表单的方式相同，我们使用<code class="fe kl km kn ko b">ngModel</code>、<code class="fe kl km kn ko b">ngForm</code>和<code class="fe kl km kn ko b">ngSubmit</code>指令来创建登录表单。</p><p id="39df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，打开<code class="fe kl km kn ko b">src/app/auth/login/login.component.html</code>文件，添加一个HTML表单，用于提交用户的电子邮件和密码:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="76e6" class="mw kx iq ko b gy mx my l mz na">&lt;div class="container"&gt;<br/>    &lt;div class="logo"&gt;Create a new account!&lt;/div&gt;<br/>    &lt;div class="register-item"&gt;<br/>      &lt;form #myform="ngForm" (ngSubmit)="register(myform)" class="form form-register"&gt;<br/><br/>        &lt;div class="form-field"&gt;<br/>              &lt;label class="user" for="register-username"&gt;&lt;span class="hidden"&gt;Name&lt;/span&gt;&lt;/label&gt;<br/>              &lt;input name="name" id="register-username" type="email" class="form-input" placeholder="Name" ngModel required&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="form-field"&gt;<br/>          &lt;label class="user" for="register-email"&gt;&lt;span class="hidden"&gt;Email&lt;/span&gt;&lt;/label&gt;<br/>          &lt;input name="email" id="register-email" type="email" class="form-input" placeholder="Email" ngModel required&gt;<br/>        &lt;/div&gt;<br/><br/>        &lt;div class="form-field"&gt;<br/>          &lt;label class="lock" for="register-password"&gt;&lt;span class="hidden"&gt;Password&lt;/span&gt;&lt;/label&gt;<br/>          &lt;input name="password" id="register-password" type="password" class="form-input" placeholder="Password" ngModel required&gt;<br/>        &lt;/div&gt;<br/><br/>        &lt;div class="form-field"&gt;<br/>          &lt;input type="submit" value="Register"&gt;<br/>        &lt;/div&gt;<br/>      &lt;/form&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="dafb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们解释一下我们做了什么:</p><ul class=""><li id="28f2" class="lz ma iq jp b jq jr ju jv jy mb kc mc kg md kk me mf mg mh bi translated">当我们导入<code class="fe kl km kn ko b">FormsModule</code>时，会自动为我们的表单创建一个<code class="fe kl km kn ko b">NgForm</code>实例。我们使用<code class="fe kl km kn ko b">#myform="ngForm"</code>创建一个对实例的<code class="fe kl km kn ko b">myform</code>引用，我们可以用它来处理表单。例如，在表单提交后获取表单的值。</li><li id="0874" class="lz ma iq jp b jq mj ju mk jy ml kc mm kg mn kk me mf mg mh bi translated">我们向<code class="fe kl km kn ko b">&lt;input&gt;</code>标签添加一个<code class="fe kl km kn ko b">ngModel</code>指令，将它们添加到与我们的登录表单相对应的<code class="fe kl km kn ko b">NgForm</code>实例中。标签应该有一个<code class="fe kl km kn ko b">name</code>属性才能正常工作。</li><li id="8ee6" class="lz ma iq jp b jq mj ju mk jy ml kc mm kg mn kk me mf mg mh bi translated">我们使用<code class="fe kl km kn ko b">ngSubmit</code>事件将<code class="fe kl km kn ko b">login(myform)</code>方法绑定到表单的提交事件。<code class="fe kl km kn ko b">login()</code>方法引用表单的<code class="fe kl km kn ko b">NgForm</code>实例。</li></ul><p id="076e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，打开<code class="fe kl km kn ko b">src/app/auth/login/login.component.ts</code>文件并添加<code class="fe kl km kn ko b">login()</code>方法:</p><pre class="mo mp mq mr gt ms ko mt mu aw mv bi"><span id="8552" class="mw kx iq ko b gy mx my l mz na">login(form){ console.log(form.value); }</span></pre><p id="17f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个方法中，我们简单地使用传递的<code class="fe kl km kn ko b">NgForm</code>的value属性在控制台中打印我们的登录表单的值。</p><p id="756a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看本教程，了解如何将带有<code class="fe kl km kn ko b">HttpClient</code>的POST请求发送到使用Node和Express.js创建的认证服务器:使用带有Node &amp; Express.js的Angular http client——POST请求示例。</p><p id="ba86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们来添加一些CSS样式。打开<code class="fe kl km kn ko b">src/app/login/login.component.css</code>文件并添加:</p><figure class="mo mp mq mr gt nb"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="31e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是登录页面的屏幕截图:</p><figure class="mo mp mq mr gt nb gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b580f09d88b02361333352fa798c18d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/0*UvBBu73xN2OBddBi.jpg"/></div></figure><p id="8ac1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您填写登录表单并单击login按钮，您应该会看到控制台上显示的表单值。</p><h1 id="6220" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="ed62" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">在本教程中，我们创建了两个login和register表单，用于向Node和Express.js认证服务器发送认证细节。</p><p id="6469" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经看到了如何在Angular 7中使用模板驱动的方法来处理表单。我们已经看到，当您在项目中导入<code class="fe kl km kn ko b">FormsModule</code>时，如何获得对Angular自动创建的表单的<code class="fe kl km kn ko b">NgForm</code>实例的引用。以及如何使用<code class="fe kl km kn ko b">ngModel</code>向HTML表单的<code class="fe kl km kn ko b">NgForm</code>实例注册单个表单标签，最后我们如何使用<code class="fe kl km kn ko b">ngSubmit</code>事件提交表单，以及如何访问绑定方法中的表单值。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="a582" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ks">原载于</em><a class="ae mi" href="https://www.techiediaries.com/angular-tutorial-forms-authentication-expressjs/" rel="noopener ugc nofollow" target="_blank"><em class="ks">www.techiediaries.com</em></a><em class="ks">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Starting local Kubernetes using kind and Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用kind和Docker启动本地Kubernetes</h1>
<blockquote>原文：<a href="https://itnext.io/starting-local-kubernetes-using-kind-and-docker-c6089acfc1c0?source=collection_archive---------2-----------------------#2019-04-13">https://itnext.io/starting-local-kubernetes-using-kind-and-docker-c6089acfc1c0?source=collection_archive---------2-----------------------#2019-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3cec602f1290412ee4cce4db06c60334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MRmVkKLbV1iNDSkxjcbsiA.jpeg"/></div></div></figure><h1 id="f148" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="ec37" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">你一整天都在尝试Kubernetes的教程吗？多亏了最新的工具，你不必这样做。</p><p id="68d4" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">在本文中，我将展示使用kind在单个Docker容器中运行集群的步骤。</p><h1 id="5955" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">什么是善良？</h1><blockquote class="lz ma mb"><p id="51ba" class="kw kx mc ky b kz lu lb lc ld lv lf lg md lw lj lk me lx ln lo mf ly lr ls lt ij bi translated">kind是一个使用Docker容器“节点”运行本地Kubernetes集群的工具。<br/><a class="ae mg" href="https://kind.sigs.k8s.io/" rel="noopener ugc nofollow" target="_blank">https://kind.sigs.k8s.io/</a></p></blockquote><p id="dda3" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">似乎没有描述，但它显然来自“码头库贝内特斯”。它的优点是跨平台友好性，即使使用Docker for Windows。当然，如你所见，缺点是糟糕的可搜索性。</p><h1 id="fdc0" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">安装类型</h1><p id="d016" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">因为kind是在<code class="fe mh mi mj mk b">go</code>中实现的，所以要确保安装了最新的<code class="fe mh mi mj mk b">golang</code>。根据<a class="ae mg" href="https://kind.sigs.k8s.io/docs/contributing/getting-started/" rel="noopener ugc nofollow" target="_blank">投稿人文档</a>，<code class="fe mh mi mj mk b">go1.11.5</code>以上优先。<br/>要安装kind，运行以下命令(需要一段时间)</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2241" class="mt jz iq mk b gy mu mv l mw mx">go get -u sigs.k8s.io/kind<br/>kind create cluster</span></pre><p id="8ea9" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">然后确认“种类”群集可用。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="36f0" class="mt jz iq mk b gy mu mv l mw mx">kind get clusters</span></pre><h1 id="1259" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">设置kubectl</h1><p id="21a3" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">此外，使用<a class="ae mg" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制</a>或<a class="ae mg" href="https://chocolatey.org/" rel="noopener ugc nofollow" target="_blank">巧克力</a>安装最新的<code class="fe mh mi mj mk b">kubernetes-cli</code>。<br/>最新的Docker有Kubernetes的功能，但它可能会有旧的<code class="fe mh mi mj mk b">kubectl</code>。通过运行以下命令检查其版本。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="5acd" class="mt jz iq mk b gy mu mv l mw mx">kubectl version</span></pre><p id="d579" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">确保它显示<code class="fe mh mi mj mk b">GitVersion: "v1.14.1"</code>或以上。<br/>如果你发现你正从Docker运行<code class="fe mh mi mj mk b">kubectl</code>，尝试<code class="fe mh mi mj mk b">brew link</code>或重新排序path环境变量。</p><p id="5277" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">一旦<code class="fe mh mi mj mk b">kubectl</code>和kind准备就绪，打开bash控制台并运行这些命令。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="de57" class="mt jz iq mk b gy mu mv l mw mx">export KUBECONFIG=”$(kind get kubeconfig-path)”<br/>kubectl cluster-info</span></pre><p id="7d7f" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">如果种类设置正确，将会显示一些信息。现在你已经准备好继续了。耶！</p><h1 id="fe87" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">部署第一个应用程序</h1><p id="db21" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们应该在集群上部署什么？一个不错的选择是Wordpress，因为它由MySQL和PHP应用程序组成。幸运的是，有一个官方教程描述得很好。我们可以使用我们刚刚创建的类集群来尝试它的大多数步骤。</p><p id="431a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><a class="ae mg" href="https://kubernetes.io/docs/tutorials/stateful-application/mysql-wordpress-persistent-volume/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/tutorials/stateful-application/MySQL-WordPress-persistent-volume/</a></p><p id="5a41" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">首先从页面下载<code class="fe mh mi mj mk b">mysql-deployment.yaml</code>和<code class="fe mh mi mj mk b">wordpress-deployment.yaml</code>。</p><p id="7e6c" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">并通过运行两个<code class="fe mh mi mj mk b">cat</code>命令来创建<code class="fe mh mi mj mk b">kustomization.yaml</code>。<br/>一旦那些<code class="fe mh mi mj mk b">yaml</code>文件准备好了，按如下布局，</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="ee2d" class="mt jz iq mk b gy mu mv l mw mx">k8s-wp/<br/>  kustomization.yaml<br/>  mysql-deployment.yaml<br/>  wordpress-deployment.yaml</span></pre><p id="6ce8" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">然后将它们应用到集群中。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="d864" class="mt jz iq mk b gy mu mv l mw mx">cd k8s-wp<br/>kubectl apply -k ./</span></pre><p id="29ce" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">如果命令成功，您将看到如下输出。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="cc36" class="mt jz iq mk b gy mu mv l mw mx">secret/mysql-pass-7tt4f27774 created<br/>service/wordpress-mysql created<br/>service/wordpress created<br/>deployment.apps/wordpress-mysql created<br/>deployment.apps/wordpress created<br/>persistentvolumeclaim/mysql-pv-claim created<br/>persistentvolumeclaim/wp-pv-claim created</span></pre><p id="78d0" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">让我们通过键入以下命令来检查群集的状态:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a4f1" class="mt jz iq mk b gy mu mv l mw mx">kubectl get secrets<br/>kubectl get pvc<br/>kubectl get pods<br/>kubectl get services wordpress</span></pre><p id="af19" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">等到所有的豆荚都变成<code class="fe mh mi mj mk b">Running</code>状态。<br/>然后，运行这个命令来访问服务。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="1590" class="mt jz iq mk b gy mu mv l mw mx">kubectl port-forward svc/wordpress 8080:80</span></pre><p id="e81f" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">并打开<a class="ae mg" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080/ </a></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/74dc8a459be2c7e6d520e61247aed601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GWTSYRjc1f4grFmxasNAIA.png"/></div></div></figure><p id="741b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">瞧啊。<br/>如果您想要检查数据库，请检查您的pod，运行这样的命令并打开您的客户端应用程序。</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="cafd" class="mt jz iq mk b gy mu mv l mw mx">kubectl port-forward wordpress-mysql-bc9864c58-ffh4c 3306:3306</span></pre><h1 id="dbc7" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="ba12" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">kind是minikube的一个很好的替代品，因为它只使用Docker的单个容器。通过结合Kubernetes 1.14中集成的Kustomze，在您的本地机器上尝试它是非常简单的。</p></div></div>    
</body>
</html>
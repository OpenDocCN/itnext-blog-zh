<html>
<head>
<title>The ins and outs of Angular — [ngClass]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular的来龙去脉— [ngClass]</h1>
<blockquote>原文：<a href="https://itnext.io/the-ins-and-outs-of-angular-ngclass-6eeaa01a2013?source=collection_archive---------3-----------------------#2021-02-17">https://itnext.io/the-ins-and-outs-of-angular-ngclass-6eeaa01a2013?source=collection_archive---------3-----------------------#2021-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5506" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我将深入研究另一个常用的角度指令，叫做NgClass，和其他指令一样(ngIf，ngFor，和ngStyle)，我们使用它们的时候不会去想在引擎盖下有什么黑魔法。我们去看看。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/a798f748b9f379dc7b346d2678a5edcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCMS_Ujlcx-utjgsg4d8KA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">传递给ngClass指令的所有有效选项</figcaption></figure><p id="d939" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似于<a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/the-in-and-outs-of-angular-ngif-2bc3ca7bc0fe?source=your_stories_page-------------------------------------"> ngIf </a>和<a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/the-ins-and-outs-of-angular-ngfor-88fece4b319c"> ngFor </a>的ngClass实际上是一个setter，它接受给它的数据，并在ElementRef(对我们当前所在的HTML元素的引用)和Renderer2(用于DOM操作的浏览器API函数的包装器)的帮助下，开始为它所在的元素构建类列表。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/47d7d3e2335d9e98aa5f0fb9b364ca2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OB2AGyURkHpmUMFNQCnQfw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">NgClass设置器</figcaption></figure><p id="ff69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ngClass函数的第一步是删除任何现有的类，这些类可能是从指令的前一次数据迭代中设置的，并分配Class属性下的“初始”类。当使用<em class="ld"> ngClass时，Class属性不再是我们从普通JS中知道的属性，而是一个输入，是ngClass指令的一部分。<br/> </em>我们可以在代码中看到术语“klass”的用法。它是对原始类属性的引用，原始类属性可以有一个作为类的字符串列表</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/8eb817895e6178a96ffb9a1965df39a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ha2OdRDTrq_hjkNXec20-g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">删除和添加类</figcaption></figure><p id="e7fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">移除和添加类本质上是相同的逻辑，它遍历字符串或对象的数组，从HTML元素中添加或移除适当的类。(很多冗余代码，在我看来，构建一个praser来统一字符串到对象的原理图会使它更整洁)。<br/>注意，Angular尽最大努力通过类型检查来保证我们的UI安全，例如，检查isArray或者是Set的实例。Angular不会让任何事情碰运气。<strong class="jp ir"> <em class="ld">即使多余也是显而易见的。</em>T11】</strong></p><p id="b45c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">函数_toggleClass非常简单，它接收类字符串和一个布尔值，该值指示它应该打开还是关闭(即通过另一个Angular black magic类Renderer2删除或添加类)。</p><p id="1232" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在删除和添加更新的类之后，我们的指令还做了一件事，在相应的变量中添加一个侦听器，以查看是否发生了变化。或者更准确地说，发生了什么变化(添加/删除/更新)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/7db1c3d8effe528e4f5803eb35b01ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mo7Mh_2MAd1xswikbzO8xA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">_rawClass =我们作为参数传递给[ngClass]的类</figcaption></figure><p id="7a20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成所有设置后，该指令使用一个名为ngDoCheck(实现DoCheck)的指令生命周期函数。每当我们的Angular应用程序运行其变化检测机制时，ngDoCheck就会运行。当ngDoCheck运行时，它验证它自己的内部变化。如果与前一次迭代相比有变化，ngClass会用新的类列表或给定的对象正确地更新元素的类。</p><p id="889e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们所看到的，该指令做了许多“棘手”的事情来保护我们的代码，但同时也为我们提供了不改变我们编写代码方式的能力。事实上，当ngClass出现时，Class属性不再是一个属性，而是一个角度输入，非常智能和直观。</p><p id="2d96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个流程图，用简单的术语展示了在ngClass指令中发生了什么。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/61ca55491e8e512cf31de40f8f5e0d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E5aUuBHCzagAsfDm8F51aw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">ngClass流程图</figcaption></figure><p id="db39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个——角度路由器。如果你想让我在Angular上看一些其他的主题，请联系我。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Help, I’ve imported environment from environment.prod!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">救命，我已经从environment.prod导入了环境！</h1>
<blockquote>原文：<a href="https://itnext.io/help-ive-imported-environment-from-environment-prod-e60aefab71ee?source=collection_archive---------6-----------------------#2019-06-10">https://itnext.io/help-ive-imported-environment-from-environment-prod-e60aefab71ee?source=collection_archive---------6-----------------------#2019-06-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="84cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即在构建时被替换的角度环境文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/11fc55fff2ddf3276734e4267e2f65d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YN5ZOFuixpYzH4wW6jgQGA.png"/></div></div></figure><p id="4e8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当人们错误地导入环境时，如何自动执行“不再从环境导入环境”和保持警惕和愤怒？因为VS代码和现代Typescript使得犯这个错误变得非常简单。只需将<code class="fe kx ky kz la b">Ctrl + .</code>和<code class="fe kx ky kz la b">Enter</code>放在带下划线的<code class="fe kx ky kz la b">environment</code>上面，我们就能得到环境。通常，我们会得到</p><p id="e539" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kx ky kz la b">import{environment} from ‘../environments/environment’;</code></p><p id="1e26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是有时候我们会</p><p id="5b67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kx ky kz la b">import{environment} from ‘../environments/environment.prod’;</code></p><p id="be2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会问,<strong class="jp ir">和</strong>有什么不同？在<strong class="jp ir">第二种情况</strong>中，我们希望使用<strong class="jp ir">环境</strong>来做出逻辑决策的模块/组件，我们总是选择<code class="fe kx ky kz la b">prod</code>——无论是在生产、暂存还是开发/质量保证阶段。更糟糕的是，到了<code class="fe kx ky kz la b">from ‘../environments/environment.qa’</code>的时候，这个问题只会在生产中表现出来！不酷！</p><p id="a5ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，所以答案是——进口时要小心——是吗？嗯，这可能在99%的情况下有效。而当有人忘记、遗漏了那1%的时候，就会带来悲伤和愤怒。</p><p id="1db3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么——我们如何实现自动化呢？</p><p id="d70e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">答案是<code class="fe kx ky kz la b"><a class="ae lb" href="https://palantir.github.io/tslint/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">tslint</strong></a></code> <strong class="jp ir">。如果你还没有使用它，这可能是开始的时候了。它对您的代码进行静态分析，并可以帮助自动化各种检查。包括<a class="ae lb" href="https://palantir.github.io/tslint/rules/import-blacklist/" rel="noopener ugc nofollow" target="_blank">黑名单进口</a>。</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="25e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"/><p id="6339" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Then we can do  【T11】  and we’ll get an error:</p><pre class="km kn ko kp gt le la lf lg aw lh bi"><span id="8411" class="li lj iq la b gy lk ll l lm ln">ERROR: c:/Users/myUser/test/src/app/core/core.module.ts:1:30 - This import is blacklisted by /\/.*environment\.(prod|staging|demo|local)/</span></pre><p id="f39a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">If we do this as part of our CI, then no more code with this import will be allowed in production. And the best part is — it’s automated and we won’t rely on everyone being <strong class="jp ir">进口时小心</strong>。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="d0e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于旧的<code class="fe kx ky kz la b">tslint</code>版本，升级不是一个选项，可以根据导入的深度列出许多导入的排列:</p><pre class="km kn ko kp gt le la lf lg aw lh bi"><span id="a56c" class="li lj iq la b gy lk ll l lm ln">"../environment/environment.prod",<br/>"../../environment/environment.prod",<br/>"../../../environment/environment.prod",<br/>"../../../../environment/environment.prod",<br/>and so on</span></pre></div></div>    
</body>
</html>
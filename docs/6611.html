<html>
<head>
<title>How to check network connection on SmartTV (WebOS and Tizen)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SmartTV (WebOS和Tizen)上检查网络连接</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-check-network-connection-on-smarttv-webos-and-tizen-75256c67584b?source=collection_archive---------5-----------------------#2022-01-04">https://itnext.io/how-to-check-network-connection-on-smarttv-webos-and-tizen-75256c67584b?source=collection_archive---------5-----------------------#2022-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/529c79a6c6ade88f6f03c8fd75b965f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oscYvlfmyKNQvX2gIbBEXQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kc" href="https://unsplash.com/@jenskreuter?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">延斯·克罗伊特</a>拍摄</figcaption></figure><p id="1a60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天我想告诉你如何在webOS和Tizen平台的SmartTV上实现无连接功能。这听起来很容易，你可以问我，你能告诉我们新的，但相信我，我可以:)</p><p id="51bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章是关于如何检测网络连接。</p><p id="d1aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">目前，我知道3种检查网络连接的方法，每种方法各有利弊，让我们逐一介绍。</p><h2 id="a055" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">1)在浏览器中检查网络状态</h2><p id="47df" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">浏览器具有用于订阅网络状态变化的监听器。我从这个实现开始。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="a9af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当你在PC/laptop浏览器中测试这个特性时，它工作得很好，但是过了一段时间后，我得到通知，它不工作了。为什么？</p><p id="0833" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在电视上，这种实现只有在您从电视上拔下电缆时才有效，但在现实生活中，我们在另一种情况下会出现网络连接错误。测试案例是从路由器上拔下LAN电缆，浏览器绝对检测不到这种情况，它说浏览器在线。</p><p id="5e22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">转到下一个实现，我们可以检测到这种情况。</p><h2 id="a92e" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">2)使用原生SmartTV SDK检查网络状态</h2><p id="3db0" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">WebOS和Tizen支持使用原生SDK检查网络连接。</p><p id="8c37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于WebOS，您可以使用<a class="ae kc" href="https://webostv.developer.lge.com/api/webos-service-api/connection-manager/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">连接管理器</strong> </a> <strong class="kf ir"> </strong>并使用一次性检查或订阅更改。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="8a9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于Tizen，您可以使用<a class="ae kc" href="https://developer.samsung.com/smarttv/develop/api-references/samsung-product-api-references/network-api.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">网络API </strong> </a>，也可以使用一次性检查或订阅更改。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="4ee1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用SDK的预期结果是smartTV应该了解网络连接何时存在或不存在。</p><p id="994b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现实看起来是另一回事。</p><h2 id="21af" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated"><strong class="ak">蒂泽:</strong></h2><p id="b3c7" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">当您从电视上拔下LAN电缆时，它会立即触发网络状态变化，作为浏览器检查。</p><p id="ee32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当您从路由器上拔下LAN电缆时，30-40秒内没有任何反应，只有在这段时间之后，Tizen才会检测到没有网络。这不仅仅是没有，我们可以利用这一点。</p><h2 id="3b01" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated"><strong class="ak">网络操作系统:</strong></h2><p id="104e" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">从电视上拔下LAN电缆会立即触发网络状态变化。</p><p id="fa62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从路由器上拔下LAN电缆不会在30秒、1分钟和1小时后触发网络状态变化。对我来说是个惊喜。</p><p id="087a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在那一刻，我开始思考如何在所有平台上实现这个功能，并且有一点延迟。</p><h2 id="9651" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">3)通过定期轮询BE或第三方端点来检查网络状态</h2><p id="2a98" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我只看到了一个如何达到目标的解决方案，那就是定期轮询。对于这个ping，我们可以在后端使用一些健康检查端点或第三方端点(例如Google)。</p><p id="7f11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一个[200，300]之间的响应状态，我们可以说我们有一个连接。</p><p id="f832" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一些错误，我们可以说是出了问题，没有网络。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="0e85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种实现在WebOS和Tizen上在所有情况下都能正确工作，延迟为2秒。</p><p id="9539" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以添加一个计时器来检测是否有问题，并在一段时间后手动中止请求。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="e5b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里不能用<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController" rel="noopener ugc nofollow" target="_blank"> AbortController </a>和fetch，因为Tizen 4上的Chromium不知道这样的接口，这就是我用XMLHttpRequest的原因。</p><p id="360b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，当请求发送在500毫秒内没有任何响应时，我在10-40分钟后有假阳性结果，电视处理请求的速度比PC低，你应该理解这一点。</p><p id="7ecf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，当服务器当前不可用或负载较高时，您可能会得到一个误报结果，并且您会显示一个无连接屏幕，但在重试后它是可用的。不太人性化。这个问题的一个可能的解决方案是实现一个解决方案框，您可以在其中检查大多数肯定的结果，但是它增加了丢失连接和显示屏幕之间的延迟时间。</p><h2 id="3654" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">结论</h2><p id="47ea" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">简单的功能并不总是如此简单，尤其是在使用SmartTV时。使用两种方法，SDK和定期轮询可以覆盖所有情况，并且在丢失连接和it检测之间具有低延迟。</p></div></div>    
</body>
</html>
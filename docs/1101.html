<html>
<head>
<title>Remote debugging Spring Boot on Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Kubernetes上远程调试Spring Boot</h1>
<blockquote>原文：<a href="https://itnext.io/remote-debugging-spring-boot-on-kubernetes-a5f96a40e5c0?source=collection_archive---------3-----------------------#2018-07-22">https://itnext.io/remote-debugging-spring-boot-on-kubernetes-a5f96a40e5c0?source=collection_archive---------3-----------------------#2018-07-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0c60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您在本地开发您的Spring Boot应用程序，然后将其容器化。甚至你把它部署在Docker主机或者Kubernetes上。但是，如何在本地IntelliJ环境中远程调试生产部署呢？🤔以下是解决方案…🤓</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="9e8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我之前的文章中，我解释了如何在Google Kubernetes上部署Spring Boot应用程序。我假设您已经有了一个工作负载和一个公开的应用程序IP地址。</p><p id="7b86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kubernetes将应用程序部署为工作负载。每个工作负载都通过负载平衡器在真实的IP地址和端口配置上暴露给互联网。这是必须的，除非你的应用服务于你的其他内部应用。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="f870" class="lc ld iq ky b gy le lf l lg lh">FROM openjdk:8-jdk-alpine<br/>VOLUME /tmp<br/>ARG JAR_FILE<br/>ADD $JAR_FILE target/app.jar<br/>ENTRYPOINT ["java","-<strong class="ky ir">agentlib:jdwp=transport=dt_socket,address=5005,server=y,suspend=n","-Djava.security.egd=file:/dev/./urandom","-Xms2g","-Xmx8g","-jar","target/app.jar"]</strong></span></pre><p id="41ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的<strong class="jp ir">粗体</strong>行是我的Dockerfile文件中的一个配置示例，它位于我的项目的根目录下。正如我在之前的文章中解释的<a class="ae ks" href="https://medium.com/@ealparslan/ship-your-spring-boot-application-on-kubernetes-in-10-minutes-6873fddc388b" rel="noopener">，这个Docker文件是Spotify的Docker-Maven插件使用的。这个插件将jar文件打包并构建一个docker映像。在该配置中，请注意该容器将在本地端口5005上运行JAVA调试器。这意味着无论您在哪里运行基于这个映像的容器，Spring都会在端口5005上提供一个可附加的调试器。</a></p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi li"><img src="../Images/74c0dd6faf7aa13e9fe1e56f4bfcf950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x6yyN7fzCxZXcveD"/></div></div></figure><p id="d798" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，对于运行在GKE上的工作负载，我们如何到达端口5005呢？</p><p id="ccf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们需要在GKE负载平衡器上再公开一个端口，用于远程调试应用程序。</p><p id="9ef2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在GKE控制台的Services选项卡上，找到公开端口80的服务(或者您的实际应用程序的任何端口),并为5005添加另一个映射，以便您可以从本地机器访问远程调试器。</p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lq"><img src="../Images/f454d8c968853b984255120b08511577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Arkd6sJkFPXg7L1M8NwPzg.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">在GKE服务选项卡上显示端口5005</figcaption></figure><p id="511c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这也可以通过编辑服务的YAML文件来实现</p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/3d93944380209ec4eda54d9dd9123216.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*crqoNpyqxQegNP7MB9TbgA.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">请注意，调试端口被添加到服务的YAML文件中</figcaption></figure><p id="4f5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样。远程调试器可以访问您的端口5005调试器。在IntelliJ Idea上添加一个新的运行/调试配置，并简单地定义GKE服务IP和端口5005。</p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lw"><img src="../Images/86c5ab0eb3d79a965f6451489dd1ce21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABH4IR1xySyWmC9idi_ZCA.png"/></div></div></figure></div></div>    
</body>
</html>
<html>
<head>
<title>Nx + Nest + Firebase = The dream</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Nx + Nest + Firebase =梦想</h1>
<blockquote>原文：<a href="https://itnext.io/nx-nest-firebase-the-dream-616e8ee71920?source=collection_archive---------1-----------------------#2020-10-25">https://itnext.io/nx-nest-firebase-the-dream-616e8ee71920?source=collection_archive---------1-----------------------#2020-10-25</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><figure class="iq ir gq gs is it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj ip"><img src="../Images/fd4382400c590c88146589ec49c4c844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sjdgKdK9V9Q36pW3FNtHxw.png"/></div></div></figure><div class=""/><p id="5f81" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">我使用Nrwl.io  Nx进行Angular开发已经超过3年了，我喜欢在一个Monorepo中拥有多个应用程序和库的开发者体验。</p><p id="7dd2" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在我最近的开发中，我开始使用Firebase，并对使用主工作区下的子目录设置Firebase函数的方式越来越失望。这与Nx应用程序和libs开发不一致，因为Firebase函数位于一个单独的文件夹下，有自己的<em class="kz"> package.json </em>和<em class="kz"> node_modules </em>安装。</p><p id="7c37" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这给在前端应用程序和firebase后端之间共享代码带来了很多困难。我在Firebase Functions文件夹中使用手工制作的<em class="kz"> tsconfig.json </em>文件来提供引用Nx工作区中的公共代码的能力。这并没有提供很好的开发者体验。我想我被Nx的功能宠坏了。</p><p id="df5f" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在通读了Jeff Delaney等人的无数文章和各种Github问题之后，我终于能够将我的开发人员体验问题缝合在一起，并在这个过程中简化我的开发。</p><p id="b3be" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">虽然这可能不是最优雅的解决方案，但我认为它会对社区有用。可以写一个原理图来自动化这个手动过程。</p><h1 id="3b5c" class="la lb jc bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">初始化Nx工作空间</h1><p id="850f" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">让我们从使用Nx workspace创建一个新的coffee应用程序开始，命令如下:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="4941" class="mm lb jc mi b gz mn mo l mp mq">&gt; npx create-nx-workspace@latest</span></pre><p id="b4f6" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在为我的Angular指定各种配置选项后，Nx将使用<strong class="kb jd">应用</strong>和<strong class="kb jd">库</strong>搭建一个工作空间。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj mr"><img src="../Images/f0fd10518df86c103c37c3f9424a9688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ii9zed5sscht49aB5mAyxQ.png"/></div></div></figure><p id="d00f" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">使用您喜欢的IDE打开新生成的工作区。在<strong class="kb jd"> apps </strong>文件夹下，您应该会看到两个应用程序，<strong class="kb jd"> coffee </strong>应用程序和<strong class="kb jd"> coffee-e2e </strong>用于端到端测试。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div class="gi gj ms"><img src="../Images/b653efab79571abcde6a0d7b224e4f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*yKY6iFgGiNoHd3lyoMEeIQ.png"/></div></figure><blockquote class="mt mu mv"><p id="53b8" class="jz ka kz kb b kc kd ke kf kg kh ki kj mw kl km kn mx kp kq kr my kt ku kv kw ik bi translated">以下所有命令都将从工作区的根目录运行。</p></blockquote></div><div class="ab cl mz na hv nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ik il im in io"><h1 id="d263" class="la lb jc bd lc ld ng lf lg lh nh lj lk ll ni ln lo lp nj lr ls lt nk lv lw lx bi translated">嵌套应用</h1><h2 id="6802" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">安装嵌套插件</h2><p id="7c60" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">将嵌套插件安装到工作区可以通过以下方式完成:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="ca78" class="mm lb jc mi b gz mn mo l mp mq">&gt; npm install -D @nrwl/nest</span></pre><h2 id="7dd1" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">生成嵌套应用程序</h2><p id="ffbb" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">生成新的嵌套应用程序可以通过以下方式完成:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="4383" class="mm lb jc mi b gz mn mo l mp mq">&gt; nx generate <a class="ae nw" href="http://twitter.com/nrwl/nest" rel="noopener ugc nofollow" target="_blank">@nrwl/nest</a>:application &lt;nest-app&gt;</span></pre><p id="bc71" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">示例:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="4f57" class="mm lb jc mi b gz mn mo l mp mq">&gt; nx generate <a class="ae nw" href="http://twitter.com/nrwl/nest" rel="noopener ugc nofollow" target="_blank">@nrwl/nest</a>:application coffee-api</span></pre><h2 id="274a" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">服务嵌套应用程序</h2><p id="d064" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">您的嵌套应用程序可以使用以下命令:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="d6b5" class="mm lb jc mi b gz mn mo l mp mq">&gt; nx serve coffee-api</span></pre><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj nx"><img src="../Images/92fccb2547e63a3e4d3a18f918b7f4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5r8vYbdf5KfmT4WsBJUFA.png"/></div></div><figcaption class="ny nz gk gi gj oa ob bd b be z dk translated">nx服务咖啡-api</figcaption></figure><p id="bc81" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">Nx将构建API并提供给指定的端口。对API的任何更改都将再次触发构建过程。</p><p id="cb02" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">生成的嵌套应用程序文件结构应该如下所示:</p><figure class="md me mf mg gu it gi gj paragraph-image"><div class="gi gj oc"><img src="../Images/08cf8ab366f9c61e27f59f1ac8c52d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*U-hiWLPNHGzBL9xCBNl43g.png"/></div></figure></div><div class="ab cl mz na hv nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ik il im in io"><h1 id="21ef" class="la lb jc bd lc ld ng lf lg lh nh lj lk ll ni ln lo lp nj lr ls lt nk lv lw lx bi translated">重火力点</h1><p id="a9a6" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">下一步是将firebase初始化到工作区中，如果您知道自己在做什么，请跳过这一部分。</p><h2 id="9e4d" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">Firebase初始化</h2><p id="e00d" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">使用以下命令确保Firebase工具已在全球范围内安装:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="4260" class="mm lb jc mi b gz mn mo l mp mq">&gt; npm install -g firebase-tools@latest</span></pre><p id="4851" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">下一步是将firebase初始化到当前工作区。</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="4acd" class="mm lb jc mi b gz mn mo l mp mq">&gt; firebase init</span></pre><p id="fbe7" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">选择Firebase部署所需的各种选项，需要为API设置<strong class="kb jd">功能</strong>。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj od"><img src="../Images/18f0a8b593cdb1aac12b62543f265e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XG6rp6R9u6Y9tDfaZH2pgg.png"/></div></div><figcaption class="ny nz gk gi gj oa ob bd b be z dk translated">安装选件—功能是必需的</figcaption></figure><p id="d4c9" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">选择一个现有的Firebase项目或创建一个新项目。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div class="gi gj oe"><img src="../Images/d4d0e3575c8a81c2c80cc0724a2641ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ELh5jGh8iOpDaJwdxfoR_g.png"/></div></figure><p id="d379" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">接受所有Firebase默认值或根据需要进行修改。确保选择Typescript作为云函数的语言，并且不要<strong class="kb jd">而不是</strong>安装依赖项。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj of"><img src="../Images/088732801031f8d0a54b1905ee74f056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCFyG9GZAKu5bOvPsWA2WA.png"/></div></div></figure><p id="7fbc" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">指定要设置的每个仿真器，确保选择了<strong class="kb jd">功能仿真器</strong>。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj og"><img src="../Images/e7584cb2da1e80664c2f7ba3ca6f9721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcpQ5nUbsgzunIxJRtUt_w.png"/></div></div></figure><p id="f2aa" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">接受各种端口的所有Firebase仿真器默认值。请注意，如果需要，可以在以后进行更改。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj oh"><img src="../Images/4627790eb10a2c9672f04879668ae674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVImNDATG9eVlxJUPURWKg.png"/></div></div></figure><p id="6720" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">Firebase现在安装在名为<strong class="kb jd"> functions的子目录中。</strong></p><figure class="md me mf mg gu it gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/9a3b3df3f8c0d75d87249eff0b4a3055.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*mgFgKlWRht_9ni35kydVWQ.png"/></div></figure></div><div class="ab cl mz na hv nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ik il im in io"><h1 id="a915" class="la lb jc bd lc ld ng lf lg lh nh lj lk ll ni ln lo lp nj lr ls lt nk lv lw lx bi translated">将巢穴改造成燃烧基地</h1><p id="c450" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">要将当前的Nest应用程序转换成Firebase ready，需要一点人工干预。</p><p id="4575" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">所以让我们开始吧…</p><p id="64bd" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">将各种Firebase依赖项安装到根工作区中。</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="d91f" class="mm lb jc mi b gz mn mo l mp mq">&gt; npm install firebase-admin firebase-functions</span></pre><p id="41cc" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">将开发依赖项安装到工作空间中。</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="7bf4" class="mm lb jc mi b gz mn mo l mp mq">&gt; npm install -D firebase-functions-test</span></pre><p id="acfa" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在嵌套应用程序的根源文件夹中创建一个<strong class="kb jd"> package.json </strong>。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj oj"><img src="../Images/e5819ab21d9af118ec18a5ffb133c816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q4Sdl2BJmorXg45B510lmg.png"/></div></div><figcaption class="ny nz gk gi gj oa ob bd b be z dk translated">Nest App — package.json</figcaption></figure><p id="22b5" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">接下来是修改工作区根文件夹中的<strong class="kb jd"> angular.json </strong>。搜索您的应用程序的名称，在本例中我使用了<strong class="kb jd"> coffee-api </strong>。</p><p id="308e" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">配置应该如下所示:</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj ok"><img src="../Images/5c8285555c64d2a3b7c1b2b8a075092c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhpEqOge_2GyyB0GRiNleQ.png"/></div></div></figure><p id="6ceb" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">我们需要修改<strong class="kb jd"> nx serve </strong>命令的当前行为，因为它将构建和启动嵌套应用程序并监听传入的请求。Firebase模拟器需要为我们启动开发服务器。</p><h2 id="f089" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">我们开始吧</h2><p id="4860" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">将<strong class="kb jd"> build </strong>重命名为<strong class="kb jd"> build-node </strong>，并在architect下添加另一个名为<strong class="kb jd"> build </strong>的条目，该条目将使用<strong class="kb jd"> nx run </strong>命令。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj ol"><img src="../Images/9f97f355ce2c4363dfff0bcbb76dd393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n2UrLtvL3vgJkzhRFRDJOA.png"/></div></div></figure><p id="8a4b" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">新的<strong class="kb jd">构建</strong>命令只是执行<strong class="kb jd">构建节点。</strong>这个更新改变了<strong class="kb jd"> serve </strong>命令的行为，只是构建并观察变化。</p><p id="df6d" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">记住<strong class="kb jd"> package.json </strong>文件，它需要进入构建输出。将条目添加到<strong class="kb jd">资产</strong>文件夹，如下所示:</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj om"><img src="../Images/6ffe63416b49f237c7049a34bcafd661.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AySaifYmSnpPv8N_-HcvOA.png"/></div></div></figure><p id="fedd" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">删除工作区根目录中的Firebase <strong class="kb jd"> functions </strong>文件夹，因为不再需要它。</p><p id="c525" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">更新嵌套应用程序引导以将express server连接到Firebase函数。</p><figure class="md me mf mg gu it"><div class="bz fq l di"><div class="on oo l"/></div></figure><p id="1a4c" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">最后更新<strong class="kb jd"> firebase.json </strong> functions部分，删除<strong class="kb jd">预部署</strong>，因为lint和build都是通过deploy命令完成的，添加<strong class="kb jd"> source </strong>让firebase知道编译输出的位置，添加<strong class="kb jd">忽略</strong>部分，这样firebase就不会打包这些内容进行部署。稍后将详细介绍部署。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj op"><img src="../Images/733d0a7e75f3a5d1fc0f3642331ba9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zO1NOeO5CAavVJIAnyMadA.png"/></div></div></figure><h2 id="7b01" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">点燃它</h2><p id="3556" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">启动Nest应用程序来观察变化。使用以下命令打开命令提示符:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="54c3" class="mm lb jc mi b gz mn mo l mp mq">&gt; nx serve coffee-api</span></pre><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj oq"><img src="../Images/86542fa6358cdc0be534da963fbc19b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Mh6zTjmuJXtRQIXq1-9eg.png"/></div></div></figure><p id="565c" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">启动后，在另一个命令窗口中启动Firebase模拟器:</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="b927" class="mm lb jc mi b gz mn mo l mp mq">&gt; firebase emulators:start --only functions --inspect-functions</span></pre><blockquote class="mt mu mv"><p id="1fbe" class="jz ka kz kb b kc kd ke kf kg kh ki kj mw kl km kn mx kp kq kr my kt ku kv kw ik bi translated">这可以作为一个<strong class="kb jd"> npm </strong>脚本添加</p></blockquote><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj or"><img src="../Images/bd1fc311b2cc546a5ea049c39063aa4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7KNNxtF0zefCF38aHLSCg.png"/></div></div></figure><p id="5960" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">启动Firebase模拟器后，您将在输出中看到用于进行Http调用的API端点，以及可用于检查日志的模拟器状态端点。</p><h2 id="64c5" class="mm lb jc bd lc nl nm dn lg nn no dp lk kk np nq lo ko nr ns ls ks nt nu lw nv bi translated">安装调试</h2><p id="a25b" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">为正在运行的Nest应用程序配置调试器:</p><ol class=""><li id="1621" class="os ot jc kb b kc kd kg kh kk ou ko ov ks ow kw ox oy oz pa bi translated">点击菜单中的<strong class="kb jd">运行</strong></li><li id="3472" class="os ot jc kb b kc pb kg pc kk pd ko pe ks pf kw ox oy oz pa bi translated">点击<strong class="kb jd">创建一个launch.json文件</strong></li><li id="ff1d" class="os ot jc kb b kc pb kg pc kk pd ko pe ks pf kw ox oy oz pa bi translated">从下拉列表中选择<strong class="kb jd"> Node.js </strong>。</li></ol><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj pg"><img src="../Images/c5f452c158a62727ee746ebf2bf9d703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMTdhuTDwqRquN24iwVgDw.png"/></div></div></figure><p id="8d24" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">按照以下方式修改配置。</p><figure class="md me mf mg gu it"><div class="bz fq l di"><div class="on oo l"/></div></figure><p id="23f8" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这个启动配置将使用默认端口9229连接到正在运行的Firebase模拟器。需要确保<strong class="kb jd"> outFiles </strong>指向嵌套应用程序的构建输出。添加<strong class="kb jd"> skipFiles </strong>很重要，因为这会加速调试断点的连接。</p><h1 id="ad07" class="la lb jc bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">部署到火力基地</h1><p id="5a45" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">如果您希望简化Firebase函数的构建和部署，您可以向<strong class="kb jd"> angular.json </strong>文件添加额外的命令。</p><p id="def6" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated"><strong class="kb jd"> deploy </strong>命令将首先调用API的build，然后调用firebase deploy，只将功能部署到firebase。</p><figure class="md me mf mg gu it gi gj paragraph-image"><div class="gi gj ph"><img src="../Images/0af0aafecadd3a8a20bc086357eae54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*7bJ97Bet6GrDpxxDs0yiOg.png"/></div><figcaption class="ny nz gk gi gj oa ob bd b be z dk translated">Nx部署命令</figcaption></figure><p id="3096" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">让我们测试一下部署。</p><pre class="md me mf mg gu mh mi mj mk aw ml bi"><span id="0a48" class="mm lb jc mi b gz mn mo l mp mq">&gt; nx deploy coffee-api</span></pre><figure class="md me mf mg gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj pi"><img src="../Images/76215c939f8d0d6ec61f37e6bccdb210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBmE_WbmPq_ZLoEC1gninw.png"/></div></div><figcaption class="ny nz gk gi gj oa ob bd b be z dk translated">部署到Firebase功能</figcaption></figure></div><div class="ab cl mz na hv nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ik il im in io"><h1 id="5d9e" class="la lb jc bd lc ld ng lf lg lh nh lj lk ll ni ln lo lp nj lr ls lt nk lv lw lx bi translated">摘要</h1><p id="b214" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">我使用Nx-Nest-Firebase的这个设置已经快2个月了，我喜欢这种开发者体验。</p><p id="daa1" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">我希望这能对社区有所帮助。</p><p id="21cb" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这里使用的完整源代码可以在这里找到:</p><div class="iq ir gq gs is pj"><a href="https://github.com/codethatstack/nest-firebase" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jd gz z fq po fs ft pp fv fx jb bi translated">codethatstack/nest-firebase</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">这个项目是用Nx生成的。🔎Nx是一套用于Monorepos的可扩展开发工具。Nx文档10分钟…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">github.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px iy pj"/></div></div></a></div></div><div class="ab cl mz na hv nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ik il im in io"><h1 id="993e" class="la lb jc bd lc ld ng lf lg lh nh lj lk ll ni ln lo lp nj lr ls lt nk lv lw lx bi translated">参考</h1><p id="27aa" class="pw-post-body-paragraph jz ka jc kb b kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw ik bi translated">启发了这篇文章的各种参考点。</p><div class="iq ir gq gs is pj"><a href="https://fireship.io/snippets/setup-nestjs-on-cloud-functions/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jd gz z fq po fs ft pp fv fx jb bi translated">在云函数上设置嵌套</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">在Firebase云函数上运行NestJS的步骤。创建时间最后更新时间下面的代码片段演示了两个…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">火船. io</p></div></div><div class="ps l"><div class="py l pu pv pw ps px iy pj"/></div></div></a></div><div class="iq ir gq gs is pj"><a href="https://github.com/nrwl/nx/issues/836" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jd gz z fq po fs ft pp fv fx jb bi translated">允许开发Firebase云函数问题#836 nrwl/nx</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">云功能是开发基于微服务的后端的好方法。就像节点后端一样，这很常见…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">github.com</p></div></div><div class="ps l"><div class="pz l pu pv pw ps px iy pj"/></div></div></a></div><div class="iq ir gq gs is pj"><a href="https://github.com/nrwl/nx/issues/1175" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jd gz z fq po fs ft pp fv fx jb bi translated">如何使用vscode配置和调试NestJS？问题#1175 nrwl/nx</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">我正在努力使用vscode进行调试(使用断点和检查应用程序流)。有人能分享我如何…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">github.com</p></div></div><div class="ps l"><div class="qa l pu pv pw ps px iy pj"/></div></div></a></div><div class="iq ir gq gs is pj"><a href="https://stackoverflow.com/questions/61671958/how-do-you-add-firebase-firestore-to-an-existing-nestjs-app-inside-of-a-nrwl-mon" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jd gz z fq po fs ft pp fv fx jb bi translated">如何将Firebase/Firestore添加到NRWL monorepo中现有的NestJS应用程序中？</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">步骤1 -创建Nest App NX generate @ nrwl/Nest:App myapp步骤2 -添加函数(不在apps文件夹内)。npm…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">stackoverflow.com</p></div></div><div class="ps l"><div class="qb l pu pv pw ps px iy pj"/></div></div></a></div><div class="iq ir gq gs is pj"><a href="https://medium.com/mean-fire/nx-nrwl-firebase-functions-98f96f514055" rel="noopener follow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jd gz z fq po fs ft pp fv fx jb bi translated">Nx Nrwl Firebase函数</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">自从Nrwl发布了对节点应用程序的支持后，我一直在期待Firebase函数。我甚至创造了…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">medium.com</p></div></div></div></a></div></div></div>    
</body>
</html>
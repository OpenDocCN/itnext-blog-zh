<html>
<head>
<title>Combining several api functions into one</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将几个api函数组合成一个</h1>
<blockquote>原文：<a href="https://itnext.io/combining-several-api-functions-into-one-a5177d17eae9?source=collection_archive---------7-----------------------#2018-02-26">https://itnext.io/combining-several-api-functions-into-one-a5177d17eae9?source=collection_archive---------7-----------------------#2018-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/12753c2991fd0b6554d588c90ac03db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZmL4xqRBXphlGXYHVCDng.jpeg"/></div></div></figure><p id="681d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fcombining-several-api-functions-into-one-a5177d17eae9" rel="noopener ugc nofollow" target="_blank"> <em class="kx">点击这里在LinkedIn上分享这篇文章</em> </a></p><p id="5c9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">情况是这样的:</p><ol class=""><li id="1aff" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">你有一个特殊的文件，它只导出一堆函数。</li><li id="0d5a" class="ky kz iq ka b kb lh kf li kj lj kn lk kr ll kv ld le lf lg bi translated">这些函数都是api调用，它们接受一些参数并给出一个承诺。</li></ol><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="312e" class="lv lw iq lr b gy lx ly l lz ma">import axios from 'axios';</span><span id="8dab" class="lv lw iq lr b gy mb ly l lz ma">export default {<br/>    getSomeStuff: (url, param1, param2) =&gt; axios.post(url, {param1, param2}), <br/>    putSomeStuff: (url, info1, info2) =&gt; axios.post(url, {info1, info2}),<br/>    ...<br/>}</span></pre><p id="de51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码中经常发生的事情，特别是当你使用许多第三方库来处理应用程序的不同部分时，是每个部分分别处理所有事情。这听起来不错，因为这才是重点。</p><p id="ac96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是在上面这种情况下，完全解耦的api.js模块要求您在添加或更改内容(比如添加新的端点)时更新它。虽然应用程序中用户点击按钮的部分和数据实际到达服务器并返回的部分相隔几步，但这并不意味着每一步都需要在其中存储特定活动的规范。</p><p id="fb34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用上面的例子来解释:api.js包含getSomeStuff的规范(需要url和两个名为param1和param2的参数)。它还保存了它导出的所有其他函数的规范。但是所有这些函数都有一个共同点:只是来回传递数据。</p><p id="c704" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们更改这个模块，这样无论何时发生变化，我们都不需要更新它:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="9f9c" class="lv lw iq lr b gy lx ly l lz ma">import axios from 'axios';<br/>import config from '../config.js';</span><span id="aafd" class="lv lw iq lr b gy mb ly l lz ma">export default {<br/>    makeRequest: params =&gt; axios.post(config.baseUrl, params),<br/>    ...<br/>}</span></pre><p id="6fb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看看我们做了什么:我们现在只为这个服务器导出一个函数，它的url在某个配置文件中。<code class="fe mc md me lr b">params</code>是一个对象(与您将从容器组件中分派的对象相同)。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="74b6" class="lv lw iq lr b gy lx ly l lz ma">params === {type: actions.SOME_TYPE, param1, param2}</span></pre><p id="089c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果服务器获得的对象与您从容器中分派的对象完全相同，这意味着您可以在服务器上使用相同的actions.js来识别动作并做出相应的反应。这样，容器需要按照服务器期望的方式命名分派的参数，但是当您重新构建时，感觉服务器只是前端的一部分，因为它对相同的动作做出反应。</p><p id="4fae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里的一个额外好处是，您可以使用同一个api模块来处理几个不同的API(服务器通信),而不会有混乱的东西和导出。</p><p id="b461" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这个:D·:D·:D，别忘了鼓掌</p></div></div>    
</body>
</html>
<html>
<head>
<title>Control your home with HomeKit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用HomeKit控制你的家</h1>
<blockquote>原文：<a href="https://itnext.io/control-your-home-with-homekit-20e8791a2fd3?source=collection_archive---------5-----------------------#2020-01-27">https://itnext.io/control-your-home-with-homekit-20e8791a2fd3?source=collection_archive---------5-----------------------#2020-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/53ecdac324459755120044f55d943f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NUFmjX7nxaaD2Fwa45x_mw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">托马斯·科尔诺斯基在<a class="ae kc" href="https://unsplash.com/s/photos/smart-home?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="1c82" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://developer.apple.com/homekit/" rel="noopener ugc nofollow" target="_blank"> HomeKit </a>现在已经有一段时间了。我每天都用它来控制我的灯或远程关闭我的前门。唯一的缺点是它的功能集非常有限。对于我的应用Sensory，我正试图设计一个纯粹基于苹果新SwiftUI中的Hue运动传感器的警报系统。</p><p id="4338" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在一次编码会议后，我发现可以从我的应用程序中访问/控制这些附件。有了Homebridge可以给你的扩展，我就可以再次控制我的nest恒温器了！</p><p id="1f34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">*想知道如何在SwiftUI中创建温度表盘吗？更多了解</em> <a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/temperature-dial-in-swiftui-d2d113449a46"> <em class="lb">这里</em> </a> <em class="lb">。</em></p><p id="2e27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我将解释如何与HomeKit中的配件进行交互，并在SwiftUI中显示它们。主要的重点是让我的运动传感器在没有Hue API的情况下再次工作。</p><p id="161b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在开始之前，确保您已经向项目添加了正确的功能，并在<strong class="kf ir"> Info.plist </strong>中添加了有效的条目。(隐私— HomeKit使用说明)。</p><p id="d975" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建一个可以利用SDK查询附件的类。</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lg lh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">上面的视图模型让我们查询设备变得容易多了！</figcaption></figure><p id="6144" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">gist利用了我在“SwiftUI中的联网”中使用的<strong class="kf ir">资源</strong> enum如果你以前没有读过，我建议你在这里读一读<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/networking-in-swiftui-aa57ff0021"/>。</p><p id="7418" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，我们初始化ViewModel，设置委托，然后等待HomeKit通知我们已经加载了附件。我们根据型号标识符<em class="lb"> * </em>装载附件。当我们获得一种资源时，我们把它转化成我们所期望的。</p><p id="0674" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">*获取正确的标识符可能需要一些调试工作</em></p><p id="325b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有模型，上面的代码什么都不做；我们仍然需要一种方法来查询附件的属性，让我们继续努力。引入名为<strong class="kf ir"> HomeKitAccessory </strong>的协议</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lg lh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">这个协议帮助我们快速地读/写值。</figcaption></figure><p id="8bb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们有了一个“标准化”的方法来查询我们的配件信息。我们仍然缺少一个模型，一个保存我们的运动传感器数据的模型。</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lg lh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">除了这里列出的标识符之外，还有很多其他的标识符。</figcaption></figure><p id="a43a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个模型仍然是最基本的，因为我仍然在努力获取我的项目所需的所有值。这个模式有点特别；我们正在为自己设置附件委托。</p><p id="61e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个委托有一个方法，当一个值改变时触发，并且每当一个值改变时自动更新模型，因为我们符合<strong class="kf ir"> ObservableObject </strong>。只要确保我们的<strong class="kf ir">视图</strong>中的变量有注释“<em class="lb"> @ObservedObject </em>”</p><p id="9832" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们准备在SwiftUI视图中显示它。您可以使用基本的<strong class="kf ir"> ForEach </strong>或<strong class="kf ir"> List </strong>来显示所有传感器，而不是使用<strong class="kf ir"> GridStack </strong>。下面的列表显示了一个带有多个传感器视图的网格视图，假设您有多个传感器视图。</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lg lh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">资源枚举使得基于视图的当前状态来显示视图变得很愉快！</figcaption></figure><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lg lh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">AssetColor是一个安全获取命名颜色的扩展。</figcaption></figure><p id="e14a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">奖励:我已经附加了</em><a class="ae kc" href="https://gist.github.com/Plnda/68e221c2d025dfb62ab5623bc211b413" rel="noopener ugc nofollow" target="_blank"><em class="lb"/></a><em class="lb">视图修改器</em><strong class="kf ir"><em class="lb">EitherBackground</em></strong><em class="lb">这样你就可以基于一个条件在一个视图上附加两种不同的背景(例如:颜色和渐变)。</em></p><p id="d90b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个总结；像往常一样，我将把基本设置作为实现留给读者。我很高兴这次我可以继续基于HomeKit SDK开发我的警报系统。</p><p id="9b48" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一篇文章再见。</p><p id="0bba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">在这里的</em> <a class="ae kc" href="https://pinch.nl/en" rel="noopener ugc nofollow" target="_blank"> <em class="lb">捏</em> </a> <em class="lb">，我们继续试验SwiftUI，让我们的应用变得更好。你有任何问题或评论吗？请在评论中告诉我们。</em></p></div></div>    
</body>
</html>
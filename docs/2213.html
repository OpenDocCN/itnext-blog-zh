<html>
<head>
<title>What’s a slug</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是鼻涕虫</h1>
<blockquote>原文：<a href="https://itnext.io/whats-a-slug-f7e74b6c23e0?source=collection_archive---------1-----------------------#2019-04-17">https://itnext.io/whats-a-slug-f7e74b6c23e0?source=collection_archive---------1-----------------------#2019-04-17</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><figure class="iq ir gq gs is it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj ip"><img src="../Images/90eb28ae8159dfe30192238394e25679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wi5COEKcfMjvmJAybki-9A.png"/></div></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk translated">图片来源于<a class="ae je" href="https://www.flickr.com/photos/nordique/43507387102" rel="noopener ugc nofollow" target="_blank">Peter Stevens的原始照片</a>并根据其许可条款进行了改编。</figcaption></figure><div class=""/><div class=""><h2 id="c82c" class="pw-subtitle-paragraph ke jg jh bd b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dk translated">我为什么要用它？</h2></div><p id="2c62" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe ls lt lu lv b">slug</code>是人类可读的唯一标识符，用于标识资源，而不是像<code class="fe ls lt lu lv b">id</code>这样不太可读的标识符。当你想引用一个项目，同时保留一眼就能看到这个项目是什么的能力时，你可以使用<code class="fe ls lt lu lv b">slug</code>。</p><p id="a43e" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">典型地，slugs是在制作搜索引擎优化的url时使用的，所以例如这篇文章的URL是<a class="ae je" href="https://medium.com/@davesag/whats-a-slug-f7e74b6c23e0" rel="noopener">https://medium.com/@davesag/whats-a-slug-f7e74b6c23e0</a>。在那个url中实际上有两个slug，我的<code class="fe ls lt lu lv b">username</code>，<code class="fe ls lt lu lv b"><a class="ae je" href="http://twitter.com/davesag" rel="noopener ugc nofollow" target="_blank">@davesag</a> </code>和这个特定帖子的slug，<code class="fe ls lt lu lv b"> whats-a-slug-f7e74b6c23e0</code>。其中的<code class="fe ls lt lu lv b">whats-a-slug</code>部分来自标题，出于只有Medium的人知道的原因，他们在它的结尾加了一个简短的<code class="fe ls lt lu lv b">uuid</code>。我想到这样做的唯一原因是如果用户能够用同一个标题写两个故事，所以我想这是可能发生的。</p><h1 id="fb72" class="lw lx jh bd ly lz ma mb mc md me mf mg kn mh ko mi kq mj kr mk kt ml ku mm mn bi translated">一个例子</h1><p id="4b1e" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated">一个更有趣的例子是，当您的系统存储一组产品时，每个产品都有一个类别。</p><p id="13c9" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在伪代码中，这里有一组你会在数据库中看到的相当典型的模型。</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="40c3" class="nb lx jh lv b gz nc nd l ne nf">Product {<br/>  id: integer (auto-incremented, unique),<br/>  name: string,<br/>  slug: string (derivedFrom(name), unique),<br/>  category: belongsTo(Category, id)<br/>}</span><span id="f776" class="nb lx jh lv b gz ng nd l ne nf">Category {<br/>  id: integer (auto-incremented, unique),<br/>  name: string,<br/>  slug: string (derivedFrom(name), unique),<br/>  products: hasMany(Products, id)<br/>}</span></pre><p id="ca70" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">现在，假设您想要提供一个列出给定类别的产品的API。</p><p id="7557" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">您可以按如下方式定义路线:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="4590" class="nb lx jh lv b gz nc nd l ne nf">GET /category/:id/products</span></pre><p id="cc0a" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">但这会给你一个相当难看的URL。</p><p id="548a" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">所以最好把路线定义为:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="fa06" class="nb lx jh lv b gz nc nd l ne nf">GET /category/:slug/products</span></pre><p id="a881" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">所以如果你有一个<code class="fe ls lt lu lv b">category</code>‘books’那么有人调用你的API就会调用:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="223f" class="nb lx jh lv b gz nc nd l ne nf">GET /category/books/products</span></pre><h1 id="d05c" class="lw lx jh bd ly lz ma mb mc md me mf mg kn mh ko mi kq mj kr mk kt ml ku mm mn bi translated">精益API设计</h1><h2 id="aece" class="nb lx jh bd ly nh ni dn mc nj nk dp mg lf nl nm mi lj nn no mk ln np nq mm nr bi translated">总则</h2><p id="36c0" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated">原料药应当:</p><ul class=""><li id="c4e8" class="ns nt jh ky b kz la lc ld lf nu lj nv ln nw lr nx ny nz oa bi translated">不返回数据库内使用的内部<code class="fe ls lt lu lv b">id</code>，而是返回一个<code class="fe ls lt lu lv b">slug</code>，</li><li id="5c4c" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated">返回最少量的有用数据，并且</li><li id="e558" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated">返回足够的数据以减少重复请求的需要</li></ul><h2 id="ae72" class="nb lx jh bd ly nh ni dn mc nj nk dp mg lf nl nm mi lj nn no mk ln np nq mm nr bi translated">基于上述模型的示例数据</h2><p id="5696" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated"><code class="fe ls lt lu lv b">Category</code></p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="5cf8" class="nb lx jh lv b gz nc nd l ne nf">{<br/>  id: 1,<br/>  name: "Books",<br/>  slug: "books"<br/>}</span></pre><p id="dd4b" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe ls lt lu lv b">Products</code></p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="8a71" class="nb lx jh lv b gz nc nd l ne nf">[<br/>  {<br/>    id: 1,<br/>    name: "Old Man's War",<br/>    slug: "old-mans-war",<br/>    category: 1<br/>  },<br/>  {<br/>    id: 2,<br/>    name: "All Systems Red",<br/>    slug: "all-systems-red",<br/>    category: 1<br/>  }<br/>]</span></pre><p id="9d65" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">对<code class="fe ls lt lu lv b"> GET /category/books</code>的调用将返回:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="3c78" class="nb lx jh lv b gz nc nd l ne nf">{<br/>  name: "Books",<br/>  slug: "books",<br/>  products: [<br/>    {<br/>      name: "Old Man's War",<br/>      slug: "old-mans-war"<br/>    },<br/>    {<br/>      name: "All Systems Red",<br/>      slug: "all-systems-red"<br/>    }<br/>  ]<br/>}</span></pre><p id="ab61" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">不需要返回每个<code class="fe ls lt lu lv b">product</code>的<code class="fe ls lt lu lv b">category</code>信息，因为请求者已经知道了<code class="fe ls lt lu lv b">category</code>，然而，按照相同的逻辑，也不应该需要返回<code class="fe ls lt lu lv b">category</code>的<code class="fe ls lt lu lv b">slug</code>。</p><p id="cbe4" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">为了保持一致性，返回一个条目的<code class="fe ls lt lu lv b">slug</code>总是一个好的做法，即使这个信息是多余的。如果返回了<code class="fe ls lt lu lv b">slug</code>，API的消费者通常可以节省一些复杂性。</p><h2 id="8565" class="nb lx jh bd ly nh ni dn mc nj nk dp mg lf nl nm mi lj nn no mk ln np nq mm nr bi translated">一个更有趣的例子</h2><p id="be23" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated">本地化通常通过使用以下形式的数据结构来处理:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="456b" class="nb lx jh lv b gz nc nd l ne nf">{<br/>  [locale]: string<br/>}</span></pre><p id="1a00" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在伪代码中，它在数据库中的结构如下:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="0088" class="nb lx jh lv b gz nc nd l ne nf">Product {<br/>  id: integer (auto-incremented, unique),<br/>  name: hstore({<br/>    [locale]: string<br/>  }),<br/>  slug: string (derivedFrom(name), unique),<br/>  category: belongsTo(Category, id)<br/>}</span><span id="efc5" class="nb lx jh lv b gz ng nd l ne nf">Category {<br/>  id: integer (auto-incremented, unique),<br/>  name: hstore({<br/>    [locale]: string<br/>  }),<br/>  slug: string (derivedFrom(name), unique),<br/>  products: hasMany(Products, id)<br/>}</span></pre><p id="6376" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">每个模型都需要一个实例函数，如下所示:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="45de" class="nb lx jh lv b gz nc nd l ne nf">function getLocalised(field, locale) {<br/>  return this[field][locale]<br/>}</span></pre><p id="9306" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">API需要知道返回哪个<code class="fe ls lt lu lv b">locale</code>的方法。这通常是通过向<code class="fe ls lt lu lv b">request</code>添加一个<code class="fe ls lt lu lv b">locale</code>参数，或者在<code class="fe ls lt lu lv b">request</code>的<code class="fe ls lt lu lv b">Accept-Language</code>头中添加一个<code class="fe ls lt lu lv b">locale</code>参数来实现的，或者如果<code class="fe ls lt lu lv b">request</code>已经过验证，那么您可以将所需的<code class="fe ls lt lu lv b">locale</code>与一个<code class="fe ls lt lu lv b">user</code>记录相关联。</p><h2 id="73ab" class="nb lx jh bd ly nh ni dn mc nj nk dp mg lf nl nm mi lj nn no mk ln np nq mm nr bi translated">基于上述模型的示例数据</h2><p id="e6a7" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated"><code class="fe ls lt lu lv b">Category</code></p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="9e2c" class="nb lx jh lv b gz nc nd l ne nf">{<br/>  id: 1,<br/>  name: {<br/>    en: "Books",<br/>    vn: "Sách"<br/>  },<br/>  slug: "books"<br/>}</span></pre><p id="40e8" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe ls lt lu lv b">Products</code></p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="77ee" class="nb lx jh lv b gz nc nd l ne nf">[<br/>  {<br/>    id: 1,<br/>    name: {<br/>      en: "Old Man's War",<br/>      vn: "Chiến tranh của lão già"<br/>    },<br/>    slug: "old-mans-war",<br/>    category: 1<br/>  },<br/>  {<br/>    id: 2,<br/>    name: {<br/>      en: "All Systems Red",<br/>      vn: "Tất cả các hệ thống đều đỏ"<br/>    },<br/>    slug: "all-systems-red",<br/>    category: 1<br/>  }<br/>]</span></pre><p id="cf12" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">对<code class="fe ls lt lu lv b">GET /product/all-systems-red?locale=vn</code>的请求将返回:</p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="8ee5" class="nb lx jh lv b gz nc nd l ne nf">{<br/>  name: "Tất cả các hệ thống đều đỏ",<br/>  slug: "all-systems-red",<br/>  category: {<br/>    name: "Sách",<br/>    slug: "books"<br/>  }<br/>}</span></pre><h1 id="3532" class="lw lx jh bd ly lz ma mb mc md me mf mg kn mh ko mi kq mj kr mk kt ml ku mm mn bi translated">播种您的数据库</h1><p id="4e07" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated">设置系统时，您希望避免在种子数据中指定对象<code class="fe ls lt lu lv b">ids</code>。种子数据通常在<code class="fe ls lt lu lv b">yml</code>文件中定义。使用上面定义的数据库模型，我们可以编写如下种子文件:</p><p id="e9dd" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe ls lt lu lv b">seed-data.yml</code></p><pre class="mt mu mv mw gu mx lv my mz aw na bi"><span id="231d" class="nb lx jh lv b gz nc nd l ne nf">- slug: books<br/>  name:<br/>    en: Books<br/>    vn: Sách<br/>  products:<br/>    - slug: old-mans-war<br/>      name:<br/>        en: Old Man's War<br/>        vn: Chiến tranh của lão già<br/>    - slug: all-systems-red<br/>      name:<br/>        en: All Systems Red<br/>        vn: Tất cả các hệ thống đều đỏ</span></pre><p id="35fa" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">像这样的数据很容易导入。</p><h1 id="7fd0" class="lw lx jh bd ly lz ma mb mc md me mf mg kn mh ko mi kq mj kr mk kt ml ku mm mn bi translated">记录</h1><p id="b53d" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated">当将信息写到日志中时，这些日志被人和机器使用是很正常的。</p><p id="621d" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">将<code class="fe ls lt lu lv b">ids</code>写到日志中通常不是一个好主意。另一方面，写出<code class="fe ls lt lu lv b">slugs</code>让人们更容易阅读日志，因为<code class="fe ls lt lu lv b">slugs</code>也有<code class="fe ls lt lu lv b">ids</code>的功能，它们对机器仍然有用。</p><h1 id="4594" class="lw lx jh bd ly lz ma mb mc md me mf mg kn mh ko mi kq mj kr mk kt ml ku mm mn bi translated">如何制作鼻涕虫</h1><p id="c5b7" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated">一个好的slug是简短的，描述性的，小写的，没有重音符号，或者含糊不清或者难以一眼读懂的字符，并且是独一无二的。</p><h1 id="e8a7" class="lw lx jh bd ly lz ma mb mc md me mf mg kn mh ko mi kq mj kr mk kt ml ku mm mn bi translated">链接</h1><p id="f0ec" class="pw-post-body-paragraph kw kx jh ky b kz mo ki lb lc mp kl le lf mq lh li lj mr ll lm ln ms lp lq lr ik bi translated"><code class="fe ls lt lu lv b">Slugify</code>不同语言</p><ul class=""><li id="4c02" class="ns nt jh ky b kz la lc ld lf nu lj nv ln nw lr nx ny nz oa bi translated"><code class="fe ls lt lu lv b">Javascript</code><a class="ae je" href="https://github.com/simov/slugify" rel="noopener ugc nofollow" target="_blank">https://github.com/simov/slugify</a></li><li id="e629" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ls lt lu lv b">Rust</code><a class="ae je" href="https://github.com/mattgathu/slugify" rel="noopener ugc nofollow" target="_blank">https://github.com/mattgathu/slugify</a></li><li id="fee6" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ls lt lu lv b">Java</code><a class="ae je" href="https://github.com/slugify/slugify" rel="noopener ugc nofollow" target="_blank">https://github.com/slugify/slugify</a></li><li id="daa5" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><a class="ae je" href="https://github.com/Slicertje/Slugify" rel="noopener ugc nofollow" target="_blank">https://github.com/Slicertje/Slugify</a></li><li id="c61c" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ls lt lu lv b">Python</code><a class="ae je" href="https://github.com/un33k/python-slugify" rel="noopener ugc nofollow" target="_blank">https://github.com/un33k/python-slugify</a></li><li id="0310" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated">【https://github.com/nodes-vapor/slugify】T14<code class="fe ls lt lu lv b">Swift</code>T15】</li><li id="1c8c" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ls lt lu lv b">Go</code><a class="ae je" href="https://github.com/mozillazg/go-slugify" rel="noopener ugc nofollow" target="_blank">https://github.com/mozillazg/go-slugify</a></li></ul><h2 id="3e31" class="nb lx jh bd ly nh ni dn mc nj nk dp mg lf nl nm mi lj nn no mk ln np nq mm nr bi translated">书</h2><ul class=""><li id="c92c" class="ns nt jh ky b kz mo lc mp lf og lj oh ln oi lr nx ny nz oa bi translated"><a class="ae je" href="https://www.goodreads.com/book/show/36510196-old-man-s-war" rel="noopener ugc nofollow" target="_blank">老人的战争</a></li><li id="6c49" class="ns nt jh ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><a class="ae je" href="https://www.goodreads.com/book/show/32758901-all-systems-red" rel="noopener ugc nofollow" target="_blank">所有系统红色</a></li></ul><p id="0cc5" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi">—</p><p id="f5f2" class="pw-post-body-paragraph kw kx jh ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">像这样但不是订户？你可以通过<a class="ae je" href="https://davesag.medium.com/membership" rel="noopener">davesag.medium.com</a>加入来支持作者。</p></div></div>    
</body>
</html>
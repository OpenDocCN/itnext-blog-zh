<html>
<head>
<title>Improve Team DevOps — ensure consistent monitoring for your team /w Grafana dashboards via FluxCD IaC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">改进团队开发—确保通过FluxCD IaC对您的团队/w Grafana仪表盘进行一致的监控</h1>
<blockquote>原文：<a href="https://itnext.io/improve-team-devops-ensure-consistent-monitoring-for-your-team-w-grafana-dashboards-via-fluxcd-106dc51f9b48?source=collection_archive---------6-----------------------#2020-07-20">https://itnext.io/improve-team-devops-ensure-consistent-monitoring-for-your-team-w-grafana-dashboards-via-fluxcd-106dc51f9b48?source=collection_archive---------6-----------------------#2020-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="33ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何使用过像Prometheus和Grafana这样的OSS监控工具的人都可以证明，这些工具是部署在<strong class="jp ir">Kubernetes</strong><strong class="jp ir">containered</strong><strong class="jp ir">环境</strong>中的<strong class="jp ir"> #1 </strong>最佳选择。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d0b502ee57ea08d2c62566abb35f2e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UJzgmqFIHVtaeVQN.png"/></div></div></figure><p id="702a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在配置监控堆栈以从其提供的所有功能中受益时，有一长串管理开销需要考虑，例如调整、定制和简单工作。</p><p id="01ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这需要时间，考虑到您在容器集群中获得的必备洞察力，监控的价值是毋庸置疑的。我就让它这样吧。事实。</p><p id="5799" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">普罗米修斯监控堆栈至少由几个组件组成，例如:<br/> - <strong class="jp ir"> Prometheus </strong>(核心)用于指标收集和保留，警报触发<br/>-<strong class="jp ir">alert manager</strong>-用于向Slack和Pagerduty等其他服务发出警报的附加集成<br/>-<strong class="jp ir">Grafana</strong>-用于所有应用程序监控仪表板的简单便捷的一站式可视化UI工具。这是我们旨在简化和民主化的一点</p><p id="a53f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从<a class="ae kx" href="https://grafana.com/docs/grafana/latest/administration/provisioning/" rel="noopener ugc nofollow" target="_blank"> Grafana第5版开始，对支持预配仪表板进行了改进</a>。此外，这些仪表板可以来自配置图，由grafana自动加载，无需进一步启动部署，即可在Kubernetes中重新读取配置图。</p><p id="d679" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的Prometheus堆栈可以通过方便的<a class="ae kx" href="https://github.com/helm/charts/tree/master/stable/prometheus-operator" rel="noopener ugc nofollow" target="_blank"> Prometheus-Operator </a>进行部署，后者可以从一开始就配置Grafana仪表板UI。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/8cea84e1942c363c3a0080f1fe4c834a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PPzXZv5iXUW4rRKK.png"/></div></div></figure><p id="c849" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">演示应用仪表板，具有istio衍生的标题指标</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="aa47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一方面，<a class="ae kx" href="https://github.com/fluxcd/flux" rel="noopener ugc nofollow" target="_blank"> FluxCD </a>是针对Kubernetes集装箱化环境的<strong class="jp ir">连续交付(CD) </strong>应用。<br/>我的同事<a class="ae kx" href="https://medium.com/u/4b4dc30319a3?source=post_page-----a39eb650576f----------------------" rel="noopener">西恩·里格比</a>在这里对GitOps环境下的<a class="ae kx" href="https://medium.com/contino-engineering/integrating-gitops-deployments-in-kubernetes-using-weave-flux-9a617ea17684" rel="noopener"> Flux特性集进行了详细分析。这个<strong class="jp ir"> fluxCD </strong>工具不断地轮询指定的GitHub存储库的变更，并有效地在清单上提取变更集<code class="fe lg lh li lj b">kubectl apply -f &lt;all&gt;</code>。这为任何数量的用例带来了非常简单和优雅的连续交付流程，从GitOps CICD发布管道下的完整应用程序堆栈到部分Kubernetes YAML清单交付，以及我们在配置图中的Grafana仪表板。</a></p><p id="5ae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kx" href="https://www.duedil.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Duedil </strong> </a>热衷于通过自动化交付的DevOps实践，我们正在使用<strong class="jp ir"> FluxCD </strong>部署监控仪表板，以实现团队范围的DevOps价值:</p><ul class=""><li id="1948" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated"><strong class="jp ir">开发团队</strong>负责所有的监控仪表板和度量评估。团队<strong class="jp ir">被授权</strong>创建一个仪表板，自动检查并部署到所有需要的环境中。</li><li id="721d" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">仪表板有完整的审计跟踪，相关性可以随着时间的推移进行评估，从而改善<strong class="jp ir">仪表板所有权</strong> —“谁创建了该仪表板”和相关性—“该仪表板向我展示了什么”。</li><li id="8a24" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated"><strong class="jp ir">无</strong>多<strong class="jp ir">失</strong> <strong class="jp ir">仪表盘</strong>。它们都存储在GitHub存储库中。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/259cf34b07745d68c234340f0a5541c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/0*qHRLra0o9HX0RATu.png"/></div></figure><p id="59cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">My-Dashboard示例:Kubernetes ConfigMap包装器中的Grafana Dashboard JSON</p><ul class=""><li id="e37d" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated"><strong class="jp ir">一致性</strong> —给定各个Kubernetes集群环境中的<strong class="jp ir">普罗米修斯堆栈</strong>版本奇偶校验。FluxCD将轮询变更，将相同的仪表板拉入并部署到所有指定的环境中。</li><li id="700d" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated"><strong class="jp ir"> Reduced Toil </strong> —一旦合并到<code class="fe lg lh li lj b">master</code>分支中，所有仪表板自动释放。<br/>在一个环境中创建原型，并自动部署到其他环境中。不再从本地机器手动导入仪表板。这种自动FluxCD发布模式还可以根据需要扩展到其他环境。</li><li id="3a89" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated"><strong class="jp ir">基础设施</strong>团队减少的开销。监控仪表板没有专门的单一支持或管理人员。整个团队都有这个责任。特定于应用程序的仪表板归开发团队所有。每个人都参与质量监控解决方案、仪表板甚至应用程序警报配置的开发。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lz"><img src="../Images/209d1407077c5a3f27935a4ce2152e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pgIpmM26zvjLEfVd.png"/></div></div></figure></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="4203" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kx" href="https://www.linkedin.com/in/mike-morley-011a7a79/?originalSubdomain=uk" rel="noopener ugc nofollow" target="_blank">迪迪尔</a>的工程经理迈克·莫利说</p><blockquote class="ma mb mc"><p id="8803" class="jn jo md jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated"><em class="iq">由于大量的迁移工作，我们有许多不再适用的旧工具，将flux作为一个流程来实施非常简单，这使我们能够以标准的集中方式将其与我们的构建流程结合起来，GitOps模型允许我们定义资产的状态，它还在应用程序和配置级别构建BC/DR流程，这为团队成员部署和配置测试环境节省了时间。</em></p><p id="5b74" class="jn jo md jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">它还提供了一个“已知状态”,在没有版本控制的完整审计跟踪的情况下，防止任何小的变化和调整随着时间的推移而累积。</p></blockquote><p id="3792" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是了。</p><p id="32d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通往完全敏捷发布过程的道路，不管CI/CD过程，对每个组织来说都是独立的。监控仪表板的持续交付是如何实现无缝、敏捷交付的一个很好的例子。</p><p id="817f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">紧挨着它的是剩余的监控堆栈组件，例如<a class="ae kx" href="https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/" rel="noopener ugc nofollow" target="_blank">Prometheus</a><code class="fe lg lh li lj b">PrometheusRules</code>——也称为Alerts，也属于应用程序团队，在应用程序发布生命周期中发布。</p><p id="247b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论您决定为您的组织选择哪种模型，考虑使用<a class="ae kx" href="https://fluxcd.io/" rel="noopener ugc nofollow" target="_blank"> FluxCD </a>来从您的Kubernetes环境中的自动化发布过程中获益。</p><p id="5a8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望这篇文章能在你的敏捷交付之旅中启发你，实现DevOps实践。</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><h1 id="5e71" class="mh mi iq bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">接下来，</h1><p id="d897" class="pw-post-body-paragraph jn jo iq jp b jq nf js jt ju ng jw jx jy nh ka kb kc ni ke kf kg nj ki kj kk ij bi translated">如果你是FluxCD的实际操作者，而Kubernetes的操作让你感到厌倦，考虑探索一下如何让<strong class="jp ir"> #GitOps CI/CD </strong>发布管道更适合你。</p><p id="7a26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自然，在这种技术兴奋的同时，它也带来了自己的一系列挑战。这里还有另一篇有趣的文章— <a class="ae kx" href="https://medium.com/contino-engineering/building-cloud-native-gitops-on-google-cloud-platform-21e022904e94" rel="noopener"> <strong class="jp ir">使用云构建和Kubernetes引擎在Google云平台上构建云原生# GitOps</strong></a></p><p id="528f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，如果您希望亲自参与这些不同范围的项目，请加入我们！我们一直在寻找这个领域聪明的头脑和伟大的专业人士。我们正在招聘，<a class="ae kx" href="https://www.linkedin.com/in/johas/" rel="noopener ugc nofollow" target="_blank">请联系</a>！</p></div></div>    
</body>
</html>
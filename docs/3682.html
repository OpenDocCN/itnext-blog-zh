<html>
<head>
<title>Starting with Fable (F#)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从寓言开始(F#)</h1>
<blockquote>原文：<a href="https://itnext.io/starting-with-fable-f-83846ab790ad?source=collection_archive---------2-----------------------#2020-02-01">https://itnext.io/starting-with-fable-f-83846ab790ad?source=collection_archive---------2-----------------------#2020-02-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/07b237660aed929ac2a6122d295c4b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vW83rTffmwUy1zmp"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">丹尼尔·罗在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><blockquote class="kd ke kf"><p id="4eb6" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="iq">https://github.com/semuserable/fable-basic-interop:</em><a class="ae kc" href="https://github.com/semuserable/fable-basic-interop" rel="noopener ugc nofollow" target="_blank"><em class="iq"/></a></p></blockquote><h1 id="4304" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">前言</h1><p id="00b4" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">喜欢<code class="fe ml mm mn mo b">F#</code>，有点不喜欢香草<code class="fe ml mm mn mo b">JavaScript</code>。当我发现你可以用<code class="fe ml mm mn mo b">F#</code>写前端时，我很困惑。我就是这样遇到<a class="ae kc" href="https://fable.io/" rel="noopener ugc nofollow" target="_blank">寓言</a>的——一个通过<a class="ae kc" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank">巴别塔</a>把<code class="fe ml mm mn mo b">F#</code>翻译成<code class="fe ml mm mn mo b">JavaScript</code>的编译器。已经有太多不同的语言可以转换成T5。那么，为什么具体选择<code class="fe ml mm mn mo b">F#</code>？</p><p id="2fa2" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">这不是一个关于<code class="fe ml mm mn mo b">F#</code>的教程，所以我想建议看看很棒的<a class="ae kc" href="https://fsharpforfunandprofit.com/" rel="noopener ugc nofollow" target="_blank">fsharpforunandprofit</a>，你可以自己决定。但对我个人来说，<code class="fe ml mm mn mo b">F#</code>是一种非常强大、实用的函数式语言，它允许编写简洁、静态类型(防弹！)没有任何语义噪音的代码。</p><p id="fcdf" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">我想用静态类型语言写前端。今天，如果你想写“带类型的JavaScript”，那么<code class="fe ml mm mn mo b">TypeScript</code>是事实上的标准。但是，你必须明白<code class="fe ml mm mn mo b">TypeScript</code>到底带来了什么。你必须做好心理准备。如果你太习惯于无类型(动态)代码，迁移到<code class="fe ml mm mn mo b">TypeScript</code>会很痛苦。你必须接受这些类型并学会如何使用它们，否则你将会写同样的老一套。</p><p id="320c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">对我来说，<code class="fe ml mm mn mo b">Fable</code>是一个艰难的开始。这是一项新技术，由于<code class="fe ml mm mn mo b">F#</code>在野外并不普遍(与<code class="fe ml mm mn mo b">JavaScript</code>、<code class="fe ml mm mn mo b">TypeScript</code>相比)，关于<code class="fe ml mm mn mo b">Fable</code>的信息也很少。当你只想从简单开始时，官方的示例项目并不容易理解。他们通常涉及一些修修补补。</p><p id="42a8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">所以，我决定创建一个简单易懂的教程，告诉你如何从今天开始使用<code class="fe ml mm mn mo b">Fable</code>。我想具体地宣传一下<code class="fe ml mm mn mo b">F#</code>和<code class="fe ml mm mn mo b">Fable</code>，这样更多的人可以尝试使用它。</p><p id="f7eb" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">我希望你会喜欢它。尽情享受吧！</p><h1 id="c70a" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">工具</h1><p id="4e04" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">在开始之前，确保你已经安装了所有的东西。</p><ul class=""><li id="32e3" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated"><a class="ae kc" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>与<a class="ae kc" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a></li><li id="fb3d" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://dotnet.microsoft.com/download" rel="noopener ugc nofollow" target="_blank">点网核心SDK </a></li><li id="8b17" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">IDE</code> -我个人使用<a class="ae kc" href="https://www.jetbrains.com/rider/" rel="noopener ugc nofollow" target="_blank"> JetBrains Rider </a>，但是你可以选择<a class="ae kc" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio Code </a>带<a class="ae kc" href="http://ionide.io/" rel="noopener ugc nofollow" target="_blank"> ionide plugin </a>或者<a class="ae kc" href="https://visualstudio.microsoft.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio </a></li></ul><h1 id="bc5b" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">拔靴带</h1><p id="0461" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">我们先来了解一个简单的<code class="fe ml mm mn mo b">Fable</code> app的基本文件夹结构。我更喜欢从简单开始，并在此基础上进行构建。</p><p id="5ef9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">为了启动一个项目，你可以使用官方指南，但就我个人而言，我不怎么使用这种方法。你会被重定向到<code class="fe ml mm mn mo b">fable2-sample</code> <a class="ae kc" href="https://github.com/fable-compiler/fable2-samples" rel="noopener ugc nofollow" target="_blank">仓库</a>，但是在里面导航就没那么方便了(至于我的口味)。有许多不同设置的项目，很难找到一个真正“空”的项目。即使是“最小的”也不是“最小的”，并且包含<code class="fe ml mm mn mo b">Fable.React</code>、<code class="fe ml mm mn mo b">Fable.Elmish.React</code>依赖项。对于一个刚开始工作的人来说，这可能会让人不知所措。</p><blockquote class="kd ke kf"><p id="c024" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="iq">我仍然强烈推荐检查</em> <code class="fe ml mm mn mo b"><em class="iq">fable2-sample</em></code> <em class="iq">，因为它包含了大量不同的方法，你可以在</em> <code class="fe ml mm mn mo b"><em class="iq">Fable</em></code> <em class="iq">中使用。</em></p><p id="db69" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="iq">最新</em> <code class="fe ml mm mn mo b"><em class="iq">Fable</em></code> <em class="iq">版本是</em> <code class="fe ml mm mn mo b"><em class="iq">3</em></code> <em class="iq">，所以你可以认为</em> <code class="fe ml mm mn mo b"><em class="iq">fable2-sample</em></code> <em class="iq">包含了过时的项目，这是不正确的。所有项目都是最新版本。</em></p></blockquote><p id="5915" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">在<code class="fe ml mm mn mo b">dotnet</code>世界中，我们使用<code class="fe ml mm mn mo b">dotnet new</code>命令开始新项目。我想用<code class="fe ml mm mn mo b">Fable</code>做同样的事情，但是没有官方的模板。这就是为什么我创建了<a class="ae kc" href="https://github.com/semuserable/Semuserable.Fable.Templates" rel="noopener ugc nofollow" target="_blank">模板</a>项目，你只需输入<code class="fe ml mm mn mo b">dotnet new fable-empty</code>就可以创建一个没有多余依赖的空项目。</p><p id="a1cd" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">是时候创建一个新的空项目了。</p><ul class=""><li id="611b" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated">安装模板</li></ul><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="8f2c" class="nl lg iq mo b gy nm nn l no np">dotnet new -i Semuserable.Fable.Templates::*</span></pre><ul class=""><li id="634b" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated">创建一个文件夹并移入其中</li><li id="f7b9" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated">奔跑</li></ul><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="8d17" class="nl lg iq mo b gy nm nn l no np">dotnet new fable-empty</span></pre><blockquote class="kd ke kf"><p id="ad43" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="iq">如果要卸载模板，运行</em> <code class="fe ml mm mn mo b"><em class="iq">dotnet new -u Semuserable.Fable.Templates</em></code></p></blockquote><p id="2b8b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">创建一个最小的<code class="fe ml mm mn mo b">Fable</code>项目。</p><p id="bcd7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">让我们确保一切正常</p><ul class=""><li id="01c0" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated">执行<code class="fe ml mm mn mo b">npm install</code></li><li id="9656" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated">执行<code class="fe ml mm mn mo b">npm start</code></li><li id="1cdb" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated">打开<code class="fe ml mm mn mo b"><a class="ae kc" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank">http://localhost:8080</a></code></li><li id="575e" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated">按下<code class="fe ml mm mn mo b">F12</code>并打开<code class="fe ml mm mn mo b">Console</code>标签</li></ul><p id="96a9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">这里我们可以看到<code class="fe ml mm mn mo b">Hello from Fable!</code></p><h1 id="8978" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">项目结构</h1><p id="a748" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">每个寓言项目可以分为两个方面</p><ul class=""><li id="cf05" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">JavaScript</code>端- <code class="fe ml mm mn mo b">webpack</code>、<code class="fe ml mm mn mo b">npm</code>、静态内容(<code class="fe ml mm mn mo b">.html</code>、<code class="fe ml mm mn mo b">.css</code>等)</li><li id="cf2a" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">Fable</code>侧- <code class="fe ml mm mn mo b">F#</code>项目</li></ul><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="6252" class="nl lg iq mo b gy nm nn l no np">- public <br/>    | index.html <br/>- src <br/>    | App.fs <br/>    | App.fsproj <br/>| package.json <br/>| package-lock.json <br/>| webpack.config.js</span></pre><ul class=""><li id="704c" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">public</code> -静态内容</li><li id="c2a5" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">src</code> - <code class="fe ml mm mn mo b">F#</code>项目(<code class="fe ml mm mn mo b">Fable</code>)本身</li><li id="dff8" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">package.json</code>、<code class="fe ml mm mn mo b">package-lock.json</code> - <code class="fe ml mm mn mo b">npm</code>依赖关系</li><li id="2222" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><code class="fe ml mm mn mo b">webpack.config.js</code> -网络包配置</li></ul><p id="5e5c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">在本教程中，我将使用<code class="fe ml mm mn mo b">Fable.Core</code>库，没有任何额外的依赖。</p><h1 id="4570" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">JavaScript端</h1><p id="014f" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">为了让<code class="fe ml mm mn mo b">Fable</code>与<code class="fe ml mm mn mo b">JavaScript</code>生态系统互操作，我们必须确保所有需要的库都安装了<code class="fe ml mm mn mo b">npm</code>。对于这样一个简单的例子，我们不会使用很多依赖项，只使用核心依赖项来启动开发服务器并运行<code class="fe ml mm mn mo b">Fable</code>编译器。</p><p id="c428" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">让我们快速回顾两个重要文件— <code class="fe ml mm mn mo b">package.json</code>和<code class="fe ml mm mn mo b">webpack-config.js</code></p><ul class=""><li id="b80b" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated">打开<code class="fe ml mm mn mo b">package.json</code></li></ul><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="dfcd" class="nl lg iq mo b gy nm nn l no np">{<br/>  "name": "App",<br/>  "private": false,<br/>  "scripts": {<br/>    "start": "webpack-dev-server"<br/>  },<br/>  "dependencies": {<br/>    "@babel/core": "^7.7.7",<br/>    "fable-compiler": "^2.4.12",<br/>    "fable-loader": "^2.1.8",<br/>    "webpack": "^4.41.5",<br/>    "webpack-cli": "^3.3.10",<br/>    "webpack-dev-server": "^3.10.1"<br/>  }<br/>}</span></pre><p id="60ec" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">这里我们看到启动服务器所需的最小依赖。有<code class="fe ml mm mn mo b">Fable</code>具体的有:<code class="fe ml mm mn mo b">fable-compiler</code>和<code class="fe ml mm mn mo b">fable-loader</code>。</p><ul class=""><li id="e14a" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated">打开<code class="fe ml mm mn mo b">webpack.config.js</code></li></ul><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="4d73" class="nl lg iq mo b gy nm nn l no np">// Note this only includes basic configuration for development mode.<br/>// For a more comprehensive configuration check:<br/>// https://github.com/fable-compiler/webpack-config-template<br/><br/>var path = require("path");<br/><br/>var contentFolder = "./public";<br/><br/>module.exports = {<br/>    mode: "development",<br/>    entry: "./src/App.fsproj",<br/>    output: {<br/>        path: path.join(__dirname, contentFolder),<br/>        filename: "bundle.js",<br/>    },<br/>    devServer: {<br/>        contentBase: contentFolder,<br/>        port: 8080,<br/>    },<br/>    module: {<br/>        rules: [{<br/>            test: /\.fs(x|proj)?$/,<br/>            use: "fable-loader"<br/>        }]<br/>    }<br/>}</span></pre><p id="b79b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">非常基本的<code class="fe ml mm mn mo b">webpack</code>配置。我们现在需要知道的是，内容将从<code class="fe ml mm mn mo b">./public</code>文件夹提供(必须在那里创建<code class="fe ml mm mn mo b">index.html</code>)，服务器将监听端口<code class="fe ml mm mn mo b">8080</code>并且<code class="fe ml mm mn mo b">bundle.js</code>(一个应用程序)将在<code class="fe ml mm mn mo b">./public</code>文件夹中生成。</p><h1 id="d305" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">寓言一面</h1><p id="ab0d" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">这里我们有一个非常基本的<code class="fe ml mm mn mo b">.fsproj</code>项目设置。<code class="fe ml mm mn mo b">App.fsproj</code>是一个<a class="ae kc" href="https://docs.microsoft.com/en-us/dotnet/standard/net-standard" rel="noopener ugc nofollow" target="_blank">网络标准</a>应用程序，而<code class="fe ml mm mn mo b">App.fs</code>包含实际的<code class="fe ml mm mn mo b">Fable</code>应用程序。</p><p id="6687" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">在您选择的IDE中加载<code class="fe ml mm mn mo b">src/App.fsproj</code>项目并打开<code class="fe ml mm mn mo b">App.fs</code>文件。</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="9d4d" class="nl lg iq mo b gy nm nn l no np">module App<br/><br/>// import Fable core types<br/>open Fable.Core <br/><br/>// JavaScrpt interop call<br/>JS.console.log "Hello from Fable!"</span></pre><p id="6b1a" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">默认情况下，我们只是将一些信息写入<code class="fe ml mm mn mo b">JavaScript</code>控制台。在<code class="fe ml mm mn mo b">log</code>中输入一些新东西，刷新页面-<a class="ae kc" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank">http://localhost:8080</a>。</p><p id="0588" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">那是由<code class="fe ml mm mn mo b">Fable.Core</code>库提供的一些非常基本的互操作。</p><h1 id="84a6" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">基本互操作</h1><p id="ee23" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">为了充分利用<code class="fe ml mm mn mo b">Fable</code>和<code class="fe ml mm mn mo b">F#</code>的能力，我们需要编写一些互操作代码来将<code class="fe ml mm mn mo b">F#</code>和<code class="fe ml mm mn mo b">JavaScript</code>粘合在一起。我们最起码的工作是理解如何将<code class="fe ml mm mn mo b">JavaScript</code>类型映射到<code class="fe ml mm mn mo b">F#</code>类型。我们还可以使用一些助手形式的<code class="fe ml mm mn mo b">TypeScript</code> <a class="ae kc" href="https://github.com/DefinitelyTyped/DefinitelyTyped" rel="noopener ugc nofollow" target="_blank">类型定义文件</a>，稍后会详细说明。</p><p id="06b3" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">有一个官方的<a class="ae kc" href="https://fable.io/docs/communicate/js-from-fable.html" rel="noopener ugc nofollow" target="_blank">寓言互操作文档</a>，你可以自己尝试。有了互操作知识，我们就可以开始自己实现它了。</p><p id="f4bf" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">在本教程中，我们将实现<code class="fe ml mm mn mo b">window.alert()</code>(在<code class="fe ml mm mn mo b">Fable.Core</code>中没有)；<code class="fe ml mm mn mo b">Math.random()</code>(在<code class="fe ml mm mn mo b">Fable.Core</code>中存在，但我们仍然会实现它，我还会展示如何找到默认情况下实现了什么，没有实现什么)，一点点<code class="fe ml mm mn mo b">DOM</code> API和<code class="fe ml mm mn mo b">p5.js</code> lib。</p><h1 id="eb8e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">window.alert()</h1><p id="96de" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">先说<code class="fe ml mm mn mo b">window.alert()</code>。首先，我们需要理解我们试图在这里实现什么。这是一个<code class="fe ml mm mn mo b">JavaScript</code>库，一个<code class="fe ml mm mn mo b">React</code>组件(在真实的<code class="fe ml mm mn mo b">Fable</code>应用中大量使用，但我们不会在这里触及它)还是什么东西<code class="fe ml mm mn mo b">global</code>？</p><p id="7b96" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><code class="fe ml mm mn mo b">window</code>是<code class="fe ml mm mn mo b">JavaScript</code>中的全局对象。接下来的事情，<code class="fe ml mm mn mo b">alert()</code> call实际上是做什么的？它接受参数吗？这些问题通常由<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/alert" rel="noopener ugc nofollow" target="_blank">综合文档</a>来回答。让我们打开它，看看它能有什么帮助。从文档中，我们看到<code class="fe ml mm mn mo b">alert</code>函数接受一个类型为<code class="fe ml mm mn mo b">string</code>的可选参数。</p><figure class="nd ne nf ng gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/e8d2b2cedcea0d85cd3af464267ec13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JQXlDvQZKo5ci0afiZq3Vw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">windows . alert</figcaption></figure><p id="74c7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">现在我们有了实施<code class="fe ml mm mn mo b">F#</code>所需的所有信息。我们试试吧！</p><p id="09b3" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">打开<code class="fe ml mm mn mo b">App.fs</code>写</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="4acf" class="nl lg iq mo b gy nm nn l no np">// interface<br/>type Window =<br/>    // function description<br/>    abstract alert: ?message: string -&gt; unit<br/><br/>// wiring-up JavaScript and F# with [&lt;Global&gt;] and jsNative<br/>let [&lt;Global&gt;] window: Window = jsNative<br/><br/>// client calls<br/>window.alert ("Global Fable window.alert")<br/>window.alert "Global Fable window.alert without parentheses"</span></pre><p id="0a5b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">这里我使用了一种<code class="fe ml mm mn mo b">F# interface</code>方法，它通过一些<code class="fe ml mm mn mo b">interface</code>魔法描述了<code class="fe ml mm mn mo b">JavaScript</code>和<code class="fe ml mm mn mo b">F#</code>之间的映射。</p><p id="c49f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">如果您在之前的<code class="fe ml mm mn mo b">npm start</code>之后仍有流程在运行，只需保存并重新加载页面。您应该会看到两个连续的警告弹出窗口！</p><figure class="nd ne nf ng gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3750247b96f0003885d1f3973f121fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/1*BP35yyy8LTSqqW_VAclHtA.gif"/></div></figure><p id="4369" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">让我们尝试另一种方法。</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="ee1e" class="nl lg iq mo b gy nm nn l no np">// Special attribute for mapping, $0 == message parameter<br/>[&lt;Emit("window.alert($0)")&gt;]<br/>let alert (message: string): unit = jsNative<br/><br/>alert ("Emit from Fable window.alert")<br/>alert "Emit from Fable window.alert without parentheses"<br/>"Emit from Fable window.alert with F# style" |&gt; alert</span></pre><p id="3e3b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">您可以选择您想要的任何方法，这主要取决于您的风格或您试图合并的库。</p><blockquote class="kd ke kf"><p id="656e" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">你注意到这两个电话之间的细微差别了吗？前一个调用有一个可选参数，而后一个是必需的。</p></blockquote><h1 id="fd08" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Math.random()</h1><p id="cb06" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">下一个是<code class="fe ml mm mn mo b">Math.random()</code>。利用我们已经获得的知识，我们知道<code class="fe ml mm mn mo b">math</code>在<code class="fe ml mm mn mo b">JavaScript</code>中也是一个全局对象。如果你不确定，你可以随时查看官方文件。</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="bb87" class="nl lg iq mo b gy nm nn l no np">// interface<br/>type Math =<br/>    abstract random: unit -&gt; float<br/><br/>let [&lt;Global&gt;] Math: Math = jsNative<br/><br/>// client call<br/>JS.console.log (Math.random())</span></pre><p id="886f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">很简单，但是我想指出一件重要的事情。你有没有注意到我们在使用<code class="fe ml mm mn mo b">jsNative</code>的地方写的是<code class="fe ml mm mn mo b">Math</code>而不是<code class="fe ml mm mn mo b">math</code>？这是因为通过这样导入，你必须确保<code class="fe ml mm mn mo b">F#</code>名与<code class="fe ml mm mn mo b">JavaScript</code>名完全相同。<code class="fe ml mm mn mo b">JavaScript</code> API是<code class="fe ml mm mn mo b">Math.random()</code>，不是<code class="fe ml mm mn mo b">math.random()</code>。</p><p id="1687" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">另一个</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="efa0" class="nl lg iq mo b gy nm nn l no np">[&lt;Emit("Math.random()")&gt;]<br/>let random(): float = jsNative<br/><br/>JS.console.log (random())</span></pre><p id="a987" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><code class="fe ml mm mn mo b">Math.random()</code>在<a class="ae kc" href="https://github.com/fable-compiler/Fable/blob/972505785486fe003ab70764544c2cf498e32fcd/src/Fable.Core/Fable.Core.JS.fs#L84" rel="noopener ugc nofollow" target="_blank">寓言中实现。核心</a>，不需要重新创建。你可以通过查看官方的<code class="fe ml mm mn mo b">Fable</code>包来发现哪些实现了，哪些没有实现。</p><p id="03f0" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">重新加载页面并检查控制台(<code class="fe ml mm mn mo b">F12</code>-&gt;-<code class="fe ml mm mn mo b">Console</code>)</p><figure class="nd ne nf ng gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/fb428ee151eeab9ebc80b4ea08bbf1ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xP8W4Vga0ll_VLAoiwPN_g.png"/></div></div></figure><h1 id="788c" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">数字正射影像图</h1><p id="1b94" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">现在，我们将和<code class="fe ml mm mn mo b">DOM</code>一起工作！我们将创建一个包含文本的<code class="fe ml mm mn mo b">div</code>元素，并将它附加到某个<code class="fe ml mm mn mo b">div</code>上。</p><p id="301c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">下面是我们将从<code class="fe ml mm mn mo b">JavaScript</code>开始实现的内容</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="75d9" class="nl lg iq mo b gy nm nn l no np">// https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement#JavaScript<br/><br/>var newDiv = document.createElement("div"); <br/>var newContent = document.createTextNode("Hi from F# Fable!"); <br/>newDiv.appendChild(newContent);  <br/><br/>var currentDiv = document.getElementById("app"); <br/>document.body.insertBefore(newDiv, currentDiv);</span></pre><p id="aaca" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">好的，我们需要明白我们想要一个新的<code class="fe ml mm mn mo b">div</code>连接在哪里。你还记得<code class="fe ml mm mn mo b">index.html</code>文件吗？是时候打开了——<code class="fe ml mm mn mo b">project_folder/public/index.html</code>。</p><p id="9172" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">打开<code class="fe ml mm mn mo b">index.html</code>并在<code class="fe ml mm mn mo b">script</code>上方添加<code class="fe ml mm mn mo b">&lt;div id="app"&gt;&lt;/div&gt;</code></p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="eea1" class="nl lg iq mo b gy nm nn l no np">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>    &lt;body&gt;<br/>        &lt;div id="app"&gt;&lt;/div&gt;<br/>        &lt;script src="bundle.js"&gt;&lt;/script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5269" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">我们会在<code class="fe ml mm mn mo b">app</code> div之前加入新的东西。</p><p id="491a" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">我们应该从哪里开始呢？同样，文档。我们需要理解我们将要使用的函数。</p><ul class=""><li id="1bc3" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated"><a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement#Syntax" rel="noopener ugc nofollow" target="_blank">document . createelement()</a>—返回作为<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node" rel="noopener ugc nofollow" target="_blank">节点</a>的<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Element" rel="noopener ugc nofollow" target="_blank">元素</a></li><li id="cca1" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/createTextNode#Syntax" rel="noopener ugc nofollow" target="_blank">document . create Text Node()</a>—返回<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Text" rel="noopener ugc nofollow" target="_blank">文本</a>，它是<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node" rel="noopener ugc nofollow" target="_blank">节点</a></li><li id="482c" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild" rel="noopener ugc nofollow" target="_blank"> Node.appendChild() </a> —返回<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node" rel="noopener ugc nofollow" target="_blank">节点</a></li><li id="e635" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById#Syntax" rel="noopener ugc nofollow" target="_blank">document . getelementbyid()</a>—返回作为<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node" rel="noopener ugc nofollow" target="_blank">节点</a>的<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Element" rel="noopener ugc nofollow" target="_blank">元素</a></li><li id="fe6f" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore#Syntax" rel="noopener ugc nofollow" target="_blank"> Node.insertBefore() </a> —返回<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Node" rel="noopener ugc nofollow" target="_blank">节点</a></li></ul><p id="4de4" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">通过使用文档中的信息，创建下面的<code class="fe ml mm mn mo b">F#</code>结构</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="8eaf" class="nl lg iq mo b gy nm nn l no np">// interfaces<br/>type Node =<br/>    abstract appendChild: child: Node -&gt; Node<br/>    abstract insertBefore: node: Node * ?child: Node -&gt; Node<br/><br/>type Document =<br/>    abstract createElement: tagName: string -&gt; Node<br/>    abstract createTextNode: data: string -&gt; Node<br/>    abstract getElementById: elementId: string -&gt; Node<br/>    abstract body: Node with get, set<br/><br/>let [&lt;Global&gt;] document: Document = jsNative<br/><br/>// client code<br/>let newDiv = document.createElement("div")<br/><br/>"Good news everyone! Generated dynamically by Fable!"<br/>|&gt; document.createTextNode<br/>|&gt; newDiv.appendChild<br/>|&gt; ignore<br/><br/>let currentDiv = document.getElementById("app")<br/>document.body.insertBefore (newDiv, currentDiv) |&gt; ignore</span></pre><blockquote class="kd ke kf"><p id="5d3c" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="iq">注意，我实现了</em> <code class="fe ml mm mn mo b"><em class="iq">document.createElement</em></code> <em class="iq">，但没有在文档中可选的</em> <code class="fe ml mm mn mo b"><em class="iq">options</em></code> <em class="iq">参数。那完全没问题。</em></p></blockquote><ul class=""><li id="a358" class="mp mq iq kj b kk kl ko kp mf mr mh ms mj mt le mu mv mw mx bi translated">按下<code class="fe ml mm mn mo b">Ctrl-Z</code>关闭<code class="fe ml mm mn mo b">npm</code>过程。<code class="fe ml mm mn mo b">public</code>文件夹中的<code class="fe ml mm mn mo b">index.html</code>不能自动重装。</li><li id="fdf8" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated">运行<code class="fe ml mm mn mo b">npm start</code></li></ul><p id="7738" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">在浏览器中打开<code class="fe ml mm mn mo b">http://localhost:8080/</code>看看吧！</p><figure class="nd ne nf ng gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/d90dd90fdfdec2bb8edc97778b0af9e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SlpNyUZOKvD4f64iLIa7Sg.png"/></div></div></figure><p id="adc8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">如果你想使用<code class="fe ml mm mn mo b">DOM</code>你不需要从头开始重新创建所有的绑定，有一个官方的库！叫做<a class="ae kc" href="https://github.com/fable-compiler/fable-browser/tree/master/src/Dom" rel="noopener ugc nofollow" target="_blank">寓言。Browser.Dom </a>。此外，在这个<a class="ae kc" href="https://github.com/fable-compiler/fable-browser" rel="noopener ugc nofollow" target="_blank">官方库</a>中实现了所有其他种类的默认内容。</p><p id="17d0" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">现在你知道如何通过<code class="fe ml mm mn mo b">Fable</code>与<code class="fe ml mm mn mo b">DOM</code>一起工作了。</p><h1 id="3dd8" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">p5.js</h1><p id="4bea" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">是时候实现第三方库的某些部分了。我选择了<a class="ae kc" href="https://p5js.org/" rel="noopener ugc nofollow" target="_blank"> p5js </a>因为它是一个绘制图形和动画的库！</p><p id="1514" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">停止当前的<code class="fe ml mm mn mo b">npm</code>进程(<code class="fe ml mm mn mo b">Ctrl+Z</code>，移动到项目的根目录并运行</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="cb74" class="nl lg iq mo b gy nm nn l no np">npm install p5 --save</span></pre><p id="ef23" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><code class="fe ml mm mn mo b">p5.js</code>安装在本地，随时可以使用。是时候写点绑定了！</p><p id="f457" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">这里我们可以采取几种方法。我们可以打开<code class="fe ml mm mn mo b">node_modules/p5/lib/p5.js</code>尝试破译函数和类型，但我个人不建议在有机会接触源代码的情况下这么做(除非你别无选择)。因为<code class="fe ml mm mn mo b">node_modules</code>中存储的内容可能是压缩/删节/缩小版的库。</p><p id="2ea8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">第一种方法是检查项目的源代码。像<a class="ae kc" href="https://github.com/processing/p5.js/blob/master/src/core/main.js#L35-L36" rel="noopener ugc nofollow" target="_blank"> p5构造器</a>和<a class="ae kc" href="https://github.com/processing/p5.js/blob/master/src/core/rendering.js#L51" rel="noopener ugc nofollow" target="_blank"> createCanvas </a>。</p><p id="ce34" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">下一个方法是通过<a class="ae kc" href="https://github.com/DefinitelyTyped/DefinitelyTyped" rel="noopener ugc nofollow" target="_blank">确定类型</a>来检查<code class="fe ml mm mn mo b">TypeScript</code>类型定义文件。我强烈建议你也去看看其他的图书馆。以<code class="fe ml mm mn mo b">p5.js</code>为例，我们有<a class="ae kc" href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/p5/index.d.ts#L88" rel="noopener ugc nofollow" target="_blank"> p5构造器类型定义</a>和<a class="ae kc" href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/p5/src/core/rendering.d.ts#L27" rel="noopener ugc nofollow" target="_blank"> createCanvas类型定义</a>。这个方法很酷的一点是，我们已经有了可以直接(不总是但仍然)转换成<code class="fe ml mm mn mo b">F#</code>类型的类型，但是我们应该手动完成。</p><p id="f600" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">最后的方法是使用<a class="ae kc" href="https://fable.io/ts2fable/" rel="noopener ugc nofollow" target="_blank">ts2寓言</a>工具将<code class="fe ml mm mn mo b">TypeScript</code>定义文件转换成<code class="fe ml mm mn mo b">F#</code>本身！它类似于第二种方法，但是是自动的。你只要提供<code class="fe ml mm mn mo b">*.ts</code>文件，它就输出<code class="fe ml mm mn mo b">F#</code>类型！多酷啊。但是请注意，这个输出并不总是您想要包含在最终绑定中的。你需要检查它是否是你真正需要的。<code class="fe ml mm mn mo b">TypeScript</code>和<code class="fe ml mm mn mo b">F#</code>型系统有些不同，必须手动检查。</p><p id="2594" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">有了这些知识，我们终于可以编写一些<code class="fe ml mm mn mo b">p5.js</code>与<code class="fe ml mm mn mo b">Fable</code>的绑定了。</p><pre class="nd ne nf ng gt nh mo ni nj aw nk bi"><span id="53e0" class="nl lg iq mo b gy nm nn l no np">open Fable.Core<br/><br/>// p5.js interface<br/>[&lt;StringEnum&gt;]<br/>type Renderer =<br/>    | [&lt;CompiledName("p2d")&gt;] P2D<br/>    | [&lt;CompiledName("webgl")&gt;] WebGL<br/><br/>type [&lt;Import("*", "p5/lib/p5.js")&gt;] p5(?sketch: p5 -&gt; unit, ?id: string) =    <br/>    member __.setup with set(v: unit -&gt; unit): unit = jsNative<br/>    member __.draw with set(v: unit -&gt; unit): unit = jsNative<br/>    member __.createCanvas(w: float, h: float, ?renderer: Renderer): unit = jsNative<br/>    member __.background(value: int): unit = jsNative<br/>    member __.millis(): float = jsNative<br/>    member __.rotateX(angle: float): unit = jsNative<br/>    member __.box(): unit = jsNative<br/><br/>// client code<br/>let sketch (it: p5) =<br/>    it.setup &lt;- fun () -&gt; it.createCanvas(300., 300., WebGL)<br/>    it.draw &lt;- fun () -&gt;<br/>        it.background(255)<br/>        it.rotateX(it.millis() / 1000.)<br/>        it.box()<br/><br/>// draw    <br/>p5(sketch) |&gt; ignore</span></pre><p id="30e9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">瞧啊！</p><figure class="nd ne nf ng gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/590af7fa6ea277e75b20d699e61f151f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/1*EW5uqXixluu1Kv89xJwPWg.gif"/></div></figure><p id="9b8b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">本教程到此为止。最终项目可以在<a class="ae kc" href="https://github.com/semuserable/fable-basic-interop" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="bc62" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">感谢阅读，我希望它是有帮助的！</p><h1 id="2cfe" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">额外资源</h1><ul class=""><li id="68ee" class="mp mq iq kj b kk md ko me mf nv mh nw mj nx le mu mv mw mx bi translated"><a class="ae kc" href="https://fable.io/" rel="noopener ugc nofollow" target="_blank">寓言io </a> —官方网站</li><li id="9161" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://fable.io/repl/" rel="noopener ugc nofollow" target="_blank">寓言REPL</a>——准备用REPL风格的项目</li><li id="b110" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://fable.io/community/" rel="noopener ugc nofollow" target="_blank">寓言社区</a> —库、项目、模板</li><li id="df29" class="mp mq iq kj b kk my ko mz mf na mh nb mj nc le mu mv mw mx bi translated"><a class="ae kc" href="https://github.com/kunjee17/awesome-fable" rel="noopener ugc nofollow" target="_blank">令人敬畏的寓言</a>——有用的<code class="fe ml mm mn mo b">Fable</code>善良的精选清单，灵感来自<a class="ae kc" href="https://github.com/sindresorhus/awesome" rel="noopener ugc nofollow" target="_blank">令人敬畏的</a></li></ul></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="0bf8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><em class="ki">原载于2020年2月1日</em><a class="ae kc" href="https://dev.to/semuserable/starting-with-fable-f-kbi" rel="noopener ugc nofollow" target="_blank"><em class="ki">https://dev . to</em></a><em class="ki">。</em></p></div></div>    
</body>
</html>
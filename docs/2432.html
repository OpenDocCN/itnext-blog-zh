<html>
<head>
<title>How to use environment variables in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中使用环境变量</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-use-environment-variables-in-node-js-cb2ef0e9574a?source=collection_archive---------0-----------------------#2019-05-23">https://itnext.io/how-to-use-environment-variables-in-node-js-cb2ef0e9574a?source=collection_archive---------0-----------------------#2019-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/2649506b389b7738201d2eca1ca54efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Nq1fQSPq9aeoWxn4WFbhg.png"/></div></div></figure><div class=""/><div class=""><h2 id="4caf" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">什么是环境变量，为什么它们有用？</h2></div><p id="8945" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">环境变量在软件开发中很有帮助。许多程序和应用程序设置或获取环境变量。让我快速解释一下为什么您可能需要环境变量。</p><h2 id="c7d5" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">为什么我们需要环境变量？</h2><ul class=""><li id="e948" class="mi mj je kv b kw mk kz ml lc mm lg mn lk mo lo mp mq mr ms bi translated"><strong class="kv jf">安全性</strong>:像API密匙这样的东西不应该放在代码中的纯文本中，从而直接可见。</li><li id="36eb" class="mi mj je kv b kw mt kz mu lc mv lg mw lk mx lo mp mq mr ms bi translated"><strong class="kv jf">灵活性</strong>:您可以将条件语句简化为“<em class="my">如果生产服务器，则执行X else，如果测试服务器，则执行Y else，如果本地主机，则执行Z … </em>”。</li><li id="39ed" class="mi mj je kv b kw mt kz mu lc mv lg mw lk mx lo mp mq mr ms bi translated"><strong class="kv jf">采用</strong>:git lab或Heroku等流行服务支持环境变量的使用。</li></ul><p id="67e7" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">除了默认的环境变量，您还可以设置自己的环境变量。如果你想使用自定义的环境变量，你需要创建一个<code class="fe mz na nb nc b"><em class="my">.env</em></code> <em class="my"> </em>文件。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="f263" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">. env文件看起来像什么？</h2><p id="0e70" class="pw-post-body-paragraph kt ku je kv b kw mk kf ky kz ml ki lb lc nk le lf lg nl li lj lk nm lm ln lo im bi translated"><strong class="kv jf">一个. env文件</strong>或多或少是一个纯文本文档。它应该放在项目的根目录中。您可以指定键值对，并且可以使用#编写单行注释。以下是一个. env文件的示例:</p><pre class="nn no np nq gt nr nc ns nt aw nu bi"><span id="8445" class="lp lq je nc b gy nv nw l nx ny"># API<br/>API_TOKEN=myUniqueApiToken</span><span id="e7c8" class="lp lq je nc b gy nz nw l nx ny"># Database<br/>DATABASE_NAME=myDatabaseName</span></pre></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="9a5e" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">如何在Node.js中获取和设置环境变量</h2><pre class="nn no np nq gt nr nc ns nt aw nu bi"><span id="4b99" class="lp lq je nc b gy nv nw l nx ny">// get an environment variable<br/>export const token = process.env['<!-- -->API_TOKEN<!-- -->'];</span><span id="7bc8" class="lp lq je nc b gy nz nw l nx ny">// set an environment variable at runtime<br/>process.env['RANDOM_ID'] = Math.random();</span></pre><p id="c3ca" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如您所见，环境变量需要是一个字符串。如果您想要存储的不仅仅是一个简单的字符串(例如一个对象)，您可以将内容字符串化，并在需要检索时解析它:</p><pre class="nn no np nq gt nr nc ns nt aw nu bi"><span id="ab97" class="lp lq je nc b gy nv nw l nx ny">// set an environment variable at runtime which holds a user object<br/>process.env['USER'] = JSON.stringify({<br/>		user: {email: 'someEmail@gmail.com'}<br/>});</span><span id="6138" class="lp lq je nc b gy nz nw l nx ny">// get an environment variable which holds a user object<br/>const testUser = JSON.parse(process.env['USER'])</span></pre><p id="0d63" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但是，不要过度:不要使用环境变量来代替数据库。我使用这种方法来存储一些测试数据，这些数据在所有测试的运行过程中都应该是可用的。</p><p id="0bda" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">让我们看看如何在Node中使用自定义环境变量。我可以推荐<code class="fe mz na nb nc b"><a class="ae oa" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank">dotenv</a></code>模块，它使得从<code class="fe mz na nb nc b">.env</code>文件加载环境变量变得容易。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="a640" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">如何在节点中使用自定义环境变量</h2><ol class=""><li id="2624" class="mi mj je kv b kw mk kz ml lc mm lg mn lk mo lo ob mq mr ms bi translated"><strong class="kv jf">创建an。环境文件</strong>。该文件应该放在项目的根目录下</li><li id="18ce" class="mi mj je kv b kw mt kz mu lc mv lg mw lk mx lo ob mq mr ms bi translated"><strong class="kv jf">安装<em class="my"> dotenv </em>库</strong> : <code class="fe mz na nb nc b">npm install dotenv</code>。</li><li id="6bc7" class="mi mj je kv b kw mt kz mu lc mv lg mw lk mx lo ob mq mr ms bi translated"><strong class="kv jf">尽早要求<em class="my">dotenv</em></strong>(例如在<em class="my">app . js</em>)<code class="fe mz na nb nc b">require('dotenv').config({path: __dirname + '/.env'})</code>。</li><li id="7278" class="mi mj je kv b kw mt kz mu lc mv lg mw lk mx lo ob mq mr ms bi translated">只要你需要使用环境变量(例如在<a class="ae oa" href="https://docs.gitlab.com/ee/ci/variables/" rel="noopener ugc nofollow" target="_blank"> GitLab </a>，在<a class="ae oa" href="https://wiki.jenkins.io/display/JENKINS/Building+a+software+project#Buildingasoftwareproject-belowJenkinsSetEnvironmentVariables" rel="noopener ugc nofollow" target="_blank"> Jenkins </a>，在<a class="ae oa" href="https://devcenter.heroku.com/articles/config-vars" rel="noopener ugc nofollow" target="_blank"> Heroku </a>，…)你就需要<strong class="kv jf">添加你的环境变量</strong>。方式取决于平台，但通常很容易做到。</li><li id="d3cf" class="mi mj je kv b kw mt kz mu lc mv lg mw lk mx lo ob mq mr ms bi translated">可选:创建一个在服务器启动时运行的函数。它应该<strong class="kv jf">检查是否设置了所有需要的环境变量，否则抛出一个错误</strong>。</li></ol><figure class="nn no np nq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oc"><img src="../Images/0287cdb84bb852ee9222813d7a0ffcef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kfs79aFQeqGCBfDCSPLdLA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">您的应用程序和工作流要使用的环境变量的定义(例如:GitLab)</figcaption></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="8576" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">结论</h2><p id="f040" class="pw-post-body-paragraph kt ku je kv b kw mk kf ky kz ml ki lb lc nk le lf lg nl li lj lk nm lm ln lo im bi translated">感谢阅读这篇文章。如您所见，在Node.js中使用环境变量很容易。您是如何使用环境变量的呢？请在评论中告诉我。</p></div></div>    
</body>
</html>
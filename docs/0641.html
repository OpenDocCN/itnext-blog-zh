<html>
<head>
<title>Integrating Storyblok into existing Vue project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Storyblok集成到现有的Vue项目中</h1>
<blockquote>原文：<a href="https://itnext.io/integrating-storyblok-into-existing-vue-project-a5ad4b320cc1?source=collection_archive---------2-----------------------#2018-04-25">https://itnext.io/integrating-storyblok-into-existing-vue-project-a5ad4b320cc1?source=collection_archive---------2-----------------------#2018-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a47638386542b942405a45b6332036e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9wAV1SMyEQb0BGiag2vyw.png"/></div></div></figure><p id="a349" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个关于我们如何将Storyblok CMS集成到我们现有的VueVixens网站的故事(这是一个非常简单的VueJS单页应用程序)。</p><blockquote class="kw kx ky"><p id="1f06" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><a class="ae ld" href="https://medium.com/@jenlooper/introducing-vue-vixens-82a36455438a" rel="noopener"> Vue Vixens </a>是一个创建和主持研讨会的倡议，以一种酷而有趣的方式向代表不足的人教授Vue.js。这种形式包括以小组研讨会形式完成的自我驱动的代码实验室，由会议参与者和自愿提供帮助的演讲者进行指导。</p><p id="5fb1" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">Storyblok是一个无头的基于API的CMS。</p></blockquote><p id="9836" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">起初，我们的网站只是一个静态数据的SPA，但我们希望为其动态部分(主要是事件)添加某种内容管理，而我们并不希望从头开始重新创建整个项目。因此，我们一直在寻找一种解决方案，允许我们获取CMS数据并将其呈现到现有的组件中，我们已经找到了Storyblok。</p><p id="fc69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想用Storyblok从头开始一个新项目，我可以推荐这本非常好的指南。我的文章将只涉及将它集成到现有的VueJS网站。</p><h1 id="10c4" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">创建一个空间</h1><p id="7d08" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">我们首先需要的实际上是保存与我们项目相关的所有内容的地方。在童话世界里，这叫做<em class="kz">一个空间。</em>我已经注册、登录并点击了“创建新空间”按钮(并为其提供了一个有意义的名称，如您所见)</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/58ebf4c5bfc98f38c64bafbc5480da3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U9bwgJk6Ew7ftem9jDzPGw.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">在Storyblok管理面板中创建空间</figcaption></figure><p id="3922" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个空间后，已经有一个名为“家”的<em class="kz">故事</em>,点击后会出现一个集成代码。这里最重要的是一个访问令牌(它也可以在“Dashboard”选项卡中找到)。</p><div class="mi mj mk ml gt ab cb"><figure class="mq jr mr ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/f3519b8821a4379c09da492db45ad8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*aa4myAle3SrO9GGrO6Pduw.png"/></div></figure><figure class="mq jr mw ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/bde7af3372f23bc523d51526b90e0cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*Hpg2o-e_J58vVGcW7bijOA.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk mx di my mz translated">默认主页故事和集成令牌</figcaption></figure></div><p id="7f45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这些数据，我开始将Storyblok集成到我们的应用程序中。首先，将JS桥脚本包含到<code class="fe na nb nc nd b">index.html:</code>中</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="2249" class="ni lf iq nd b gy nj nk l nl nm">&lt;script type="text/javascript" src="//app.storyblok.com/f/storyblok-latest.js"&gt;&lt;/script&gt;</span></pre><p id="ea71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并且安装了<code class="fe na nb nc nd b">storyblok-vue</code>插件:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="bee4" class="ni lf iq nd b gy nj nk l nl nm">npm install --save storyblok-vue</span></pre><p id="4df1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe na nb nc nd b">main.js</code>文件里面导入并使用了Storyblok-Vue:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="487e" class="ni lf iq nd b gy nj nk l nl nm">import StoryblokVue from 'storyblok-vue'<br/>Vue.use(StoryblokVue);</span></pre><p id="6e59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要使用Storyblok，我们必须用提供的访问令牌初始化它。我已经在我的根组件中完成了— <code class="fe na nb nc nd b">App.vue</code></p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="1ebe" class="ni lf iq nd b gy nj nk l nl nm">created() {<br/>  this.$storyblok.init({<br/>    accessToken: '&lt;your-access-token-goes-here&gt;'<br/>  });<br/>}</span></pre><p id="7c87" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">太好了！现在，我们已经可以从Vue应用程序访问我们的空间了。我们可以运行它，并将其地址(在大多数情况下，它将是<code class="fe na nb nc nd b">localhost:8080</code>)添加到集成页面或“设置”的“域”部分。有必要让您直接从应用程序视图中编辑CMS组件。</p><div class="mi mj mk ml gt ab cb"><figure class="mq jr nn ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/dfc2f6fec8ae0ec3a64a4d80d4fbff14.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*T6DnQnYgL3SYIxyUEsvD1Q.png"/></div></figure><figure class="mq jr no ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/4b8b58364761ae482d0c22388bd74bb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*LBFYTE1y-arlk35NvW-MAA.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk np di nq mz translated">添加本地服务器地址</figcaption></figure></div><p id="88f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，当导航到“主页”故事时，我们可以看到我们的主页(尽管此时它相当静态)</p><h1 id="7c1e" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">写一个mixin</h1><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/c8aa6fac2eba38437e60e197362da09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*VY_i5-eRzXoLeEg_ghqY_Q.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">主页的Slug参数</figcaption></figure><p id="804b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要将任何故事加载到您的应用程序中，您需要它的<em class="kz"> slug — </em>它可以在故事的左侧工具栏中找到。所以我们可以考虑像我们的应用程序页面这样的单个故事。</p><p id="1b9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在这个<a class="ae ld" href="https://jsfiddle.net/delooks/fmjmecf7/13/" rel="noopener ugc nofollow" target="_blank"> Storyblok JSFiddle片段</a>中查看如何加载某个故事。我用这段代码创建了一个可重用的mixin，它可以简单地包含在组件中，只需提供组件数据中的slug名称。</p><p id="d087" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Mixin代码如下:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="7ac6" class="ni lf iq nd b gy nj nk l nl nm">export default {<br/>  data() {<br/>    return {<br/>      <em class="kz">story</em>: {},<br/>      <em class="kz">loading</em>: false,<br/>    }<br/>  },<br/>  created: function () {<br/>    this.<em class="kz">$storyblok</em>.on('change', () =&gt; {<br/>      this.loadStory('draft')<br/>    });<br/>    this.<em class="kz">$storyblok</em>.on('published', () =&gt; {<br/>      this.loadStory('draft')<br/>    });<br/><br/>    this.<em class="kz">$storyblok</em>.pingEditor(() =&gt; {<br/>      this.loadStory(this.<em class="kz">$storyblok</em>.inEditor ? 'draft' : 'published')<br/>    })<br/>  },<br/>  <em class="kz">methods</em>: {<br/>    loadStory(<em class="kz">version</em>) {<br/>      this.<em class="kz">loading </em>= true;<br/>      this.<em class="kz">$storyblok</em>.get({<br/>        <em class="kz">slug</em>: this.<em class="kz">slug</em>,<br/>        <em class="kz">version</em>: <em class="kz">version<br/>      </em>}, (<em class="kz">data</em>) =&gt; {<br/>        this.<em class="kz">story </em>= {<br/>          <em class="kz">content</em>: {}<br/>        };<br/>        this.$nextTick(() =&gt; {<br/>          this.<em class="kz">story </em>= <em class="kz">data</em>.<em class="kz">story</em>;<br/>          this.<em class="kz">loading </em>= false;<br/>        });<br/>      }, (<em class="kz">error</em>) =&gt; {<br/>        this.<em class="kz">loading </em>= false;<br/>      });<br/>    }<br/>  }<br/>}</span></pre><h1 id="146b" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">向CMS添加内容</h1><p id="b936" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">所以，现在我们准备添加一些CMS内容到我们的主页。我希望我们的主页事件列表可以从CMS管理面板编辑</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/086df95c89914432ca6bbe00c65059ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_r13GNudyV_CB5gH3KAJBg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">VueVixens主页上的事件列表</figcaption></figure><p id="17ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我打开了“家”故事，选择了<code class="fe na nb nc nd b">Form only</code>编辑模式。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/480f8faa484253086b985a28d07a1ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gg7fv4TdF4FuInemAy2cRg.png"/></div></div></figure><p id="861b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">页面主体中有两个元素，<code class="fe na nb nc nd b">Teaser</code>和<code class="fe na nb nc nd b">Grid</code>——我真的不需要这个预告，所以我已经把它删除了。</p><p id="f5d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我也删除了所有的<code class="fe na nb nc nd b">Feature</code>，因为我想用名为<code class="fe na nb nc nd b">Announce</code>的新区块来替换它们。每个公告都应该有一个名称(显示在主页的事件网格上)和一个指向事件页面的链接。因此，在删除特征后，我点击了<code class="fe na nb nc nd b">Add block</code>按钮，创建了一个新块。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/58e97c66fd1901c7b0c3db8e1262e00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-VHm-TQTiJwmeo6OtNVyg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">正在创建公告块</figcaption></figure><p id="9ccc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它有一个可嵌套的类型(意味着它不是一个根块，可以放在一个可嵌套的区域中)，并且包含两个字段:<code class="fe na nb nc nd b">name</code>(文本字段)和<code class="fe na nb nc nd b">url</code>(链接类型)</p><div class="mi mj mk ml gt ab cb"><figure class="mq jr nv ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/3b1ed7eaa0df0bdff44370b5cb02e6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*d-1SSPMboAHuZ0JM9AOG6g.png"/></div></figure><figure class="mq jr nw ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/f1e884eedcad6e91ffcb5c96e6b43f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*zEZ5tJCNnJX4yHx0zjpIag.png"/></div></figure><figure class="mq jr nx ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/d86c581507593e0d5df502d8c69e1efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*A8LPm1zcdN9FgGFnBNqcUQ.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk ny di nz mz translated">正在创建公告架构</figcaption></figure></div><blockquote class="kw kx ky"><p id="3fd8" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">不要忘记保存您的模式！</p></blockquote><p id="da52" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存后，有一个表单编辑我们的第一个公告。起初，我只在名字中填入了<code class="fe na nb nc nd b">May 31, ProgressNext</code>文本。我还在<code class="fe na nb nc nd b">Grid</code>中增加了两个即将到来的事件公告</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/8dd8015f8fb7a267dd863864ca3733d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_Uqtl_XasHdKIqsIUehRg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">有三个公告的网格</figcaption></figure><h1 id="e73d" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在应用程序主页上显示CMS数据</h1><p id="47a2" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">为了将我们新创建的故事获取到<code class="fe na nb nc nd b">Home</code>组件中，我们必须包含Storyblok mixin并指定slug(在故事中定义)</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="ed90" class="ni lf iq nd b gy nj nk l nl nm">import storyblok from '../mixins/storyblok'<br/>export default {<br/>  <em class="kz">mixins</em>: [storyblok],<br/>  data() {<br/>    return {<br/>      <em class="kz">slug</em>: 'home',<br/>    }<br/>  },<br/>}</span></pre><p id="a41f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以访问<code class="fe na nb nc nd b">story</code>对象了。它在mixin中被查询并保存到<code class="fe na nb nc nd b">story</code>属性中。这个对象的结构可以通过Chrome DevTools的网络选项卡轻松检查:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/193a812ea83eb0803a9b34a948181112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lsKbNA7KP2v5fIJjbLfPNg.png"/></div></div></figure><p id="5060" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们必须获取<code class="fe na nb nc nd b">story.content.body[0].columns</code>内容以在组件模板中显示我们的公告(一些非标准的HTML标签来自<code class="fe na nb nc nd b">bootstrap-vue</code></p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="b56f" class="ni lf iq nd b gy nj nk l nl nm">&lt;<strong class="nd ir">b-row </strong>v-if=<strong class="nd ir">"</strong>!!<em class="kz">story</em>.<em class="kz">content</em> &amp;&amp; !!<em class="kz">story</em>.<em class="kz">content</em>.<em class="kz">body</em><strong class="nd ir">"</strong>&gt;<br/>  &lt;<strong class="nd ir">b-col </strong>v-for=<strong class="nd ir">"</strong><em class="kz">item</em> in <em class="kz">story</em>.<em class="kz">content</em>.<em class="kz">body</em>[0].<em class="kz">columns</em><strong class="nd ir">" </strong>:key=<strong class="nd ir">"</strong><em class="kz">item</em>.<em class="kz">name</em><strong class="nd ir">"</strong>&gt;<br/>    &lt;<strong class="nd ir">b-button </strong>variant=<strong class="nd ir">"link lg"<br/>              </strong>v-editable=<strong class="nd ir">"</strong><em class="kz">item</em><strong class="nd ir">"</strong>&gt;<strong class="nd ir">{{</strong><em class="kz">item</em><strong class="nd ir">.</strong><em class="kz">name</em><strong class="nd ir">}}</strong>&lt;/<strong class="nd ir">b-button</strong>&gt;<br/>  &lt;/<strong class="nd ir">b-col</strong>&gt;<br/>&lt;/<strong class="nd ir">b-row</strong>&gt;</span></pre><p id="53f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe na nb nc nd b">v-editable</code>指令允许我们在Storyblok管理面板“可视”模式下编辑块。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/85db8c333351746747eb2af5498bc909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4ZAzdJx3utnOZu3IXzSBg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">Storyblok可视编辑模式</figcaption></figure><p id="8b2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能会在我们的公告周围看到这些虚线；点击它们将打开某个公告的编辑表单。</p><p id="94a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">耶，我们已经将第一个CMS数据集成到我们的应用程序中了！</p><h1 id="345a" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">用文件夹处理动态路线</h1><p id="3b90" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">在整合CMS之前，我们已经为每个事件页面建立了一个独立的静态路由。我想改变它的方式，当一个新的事件被创建时，它立即在一个匹配事件slug的路线上可用。</p><p id="fe2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我在路由器中添加了一条包含动态部分的新路由:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="16aa" class="ni lf iq nd b gy nj nk l nl nm">{<br/>  <em class="kz">path</em>: '/events/:event',<br/>  <em class="kz">component</em>: Event,<br/>},</span></pre><p id="e7b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Storyblok管理面板的“内容”选项卡中，我创建了一个名为<code class="fe na nb nc nd b">Events</code>的文件夹，并为它添加了一个新的默认类型，名为<code class="fe na nb nc nd b">event</code></p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/88ec1b1d0c95f28fd6b37026ebe4eb5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODkdDdQ4xvZdK5Twk21YVA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">创建事件文件夹</figcaption></figure><p id="607c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，在“组件”选项卡中，我选择了<code class="fe na nb nc nd b">event</code>，勾选了<code class="fe na nb nc nd b">Act as content type (eg. blog-post)</code>，并添加了一些不同类型的字段。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/4c79124842645e07b24ff69920c13c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvOftfjGDzw7VCg6parH2Q.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">事件类型字段</figcaption></figure><p id="d4b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里使用的所有字段类型(<code class="fe na nb nc nd b">Image</code>、<code class="fe na nb nc nd b">Date/Time</code>、<code class="fe na nb nc nd b">Link</code>等)都非常直观，并且用Storyblok覆盖得非常好。请随意尝试不同的类型！</p><p id="38e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我回到“内容”= &gt;“事件”并添加了一个名为<code class="fe na nb nc nd b">ProgressNext2018</code>的新故事，故事的段落完全相同。然后，我打开了这个新故事，并填写了所有字段</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/ad319de9aa3080a066f33ccf3ad06370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T26M1iLGxm7Fg5JL0CexnA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">进展下一个事件数据</figcaption></figure><p id="40b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我切换到我的<code class="fe na nb nc nd b">Event</code>组件代码。我再次添加了一个Storyblok mixin，并使用当前路径创建了一个计算属性，而不是从组件数据提供静态slug:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="1b06" class="ni lf iq nd b gy nj nk l nl nm">import storyblok from '../mixins/storyblok'<br/>export default {<br/>  <em class="kz">mixins</em>: [storyblok],<br/>  <em class="kz">computed</em>: {<br/>    slug() {<br/>      return `events/${this.$route.params.event}`;<br/>    }<br/>  },<br/>}</span></pre><p id="4727" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，当我们在<code class="fe na nb nc nd b">events/ProgressNext2018</code>路线上时，我们将获取<code class="fe na nb nc nd b">events/ProgressNext2018</code>故事。当然，我们需要一个后备方案，以防没有故事与我们当前的路线相匹配。所以我又创建了一个计算属性:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="0da9" class="ni lf iq nd b gy nj nk l nl nm"><em class="kz">computed</em>: {<br/>  currentEvent() {<br/>    return this.<em class="kz">story</em>.<em class="kz">content<br/>  </em>},<br/>  slug() {<br/>    return `events/${this.$route.params.event}`;<br/>  }<br/>},</span></pre><p id="a457" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并在组件包装器中添加了<code class="fe na nb nc nd b">v-if=<strong class="ka ir">”</strong>!!currentEvent<strong class="ka ir">”</strong></code> <strong class="ka ir"> </strong>(以及带有简单通用404组件的<code class="fe na nb nc nd b">v-else</code>案例)。</p><p id="2dbb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我需要提供一个到我们主页事件列表的新组件的链接。因此，我转到“内容”= &gt;“主页”= &gt;“网格”，点击第一条公告，勾选<code class="fe na nb nc nd b">Internal link</code>选项，然后选择要链接的正确故事。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/b7882b9b5af8731c6382ef8d9bcfeaf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzLjmfb1Rtfq8zGua7_OEw.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">设置内部链接</figcaption></figure><p id="536d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe na nb nc nd b">Home</code>组件代码中，我已经向link元素添加了<code class="fe na nb nc nd b">:to</code>指令(它设置了到某个路由的路由器链接):</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="84d6" class="ni lf iq nd b gy nj nk l nl nm">&lt;<strong class="nd ir">b-button </strong>variant=<strong class="nd ir">"link lg"<br/>          </strong>v-editable=<strong class="nd ir">"</strong><em class="kz">item</em><strong class="nd ir">"<br/>          </strong>:to=<strong class="nd ir">"</strong><em class="kz">item</em>.<em class="kz">url</em>.cached_url<strong class="nd ir">"</strong>&gt;<strong class="nd ir">{{</strong><em class="kz">item</em><strong class="nd ir">.</strong><em class="kz">name</em><strong class="nd ir">}}</strong>&lt;/<strong class="nd ir">b-button</strong>&gt;</span></pre><p id="99e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe na nb nc nd b">cached_url</code>在Storyblok中用于路由器链接。</p><p id="9519" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，点击“下一步进展”链接，我们将进入相应的活动页面(带有<code class="fe na nb nc nd b">ProgressNext2018</code>路线),并获取<code class="fe na nb nc nd b">ProgressNext2018</code>故事。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/18feb800d939ca9caa40d752d2a090d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMGXkQQhl_ysW2Jxr2_YUg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">ProgressNext2018响应结构</figcaption></figure><p id="ce11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在将它的块解析成组件模板后，我们将得到类似这样的内容:</p><pre class="mi mj mk ml gt ne nd nf ng aw nh bi"><span id="1a4d" class="ni lf iq nd b gy nj nk l nl nm">&lt;<strong class="nd ir">div </strong>class=<strong class="nd ir">"card" </strong>v-editable=<strong class="nd ir">"</strong>currentEvent<strong class="nd ir">"</strong>&gt;<br/>  &lt;<strong class="nd ir">img </strong>:src=<strong class="nd ir">"</strong>currentEvent.image<strong class="nd ir">"<br/>       </strong>class=<strong class="nd ir">"card-img-top"</strong>/&gt;<br/>  &lt;<strong class="nd ir">div </strong>class=<strong class="nd ir">"card-body"</strong>&gt;<br/>    &lt;<strong class="nd ir">h4 </strong>class=<strong class="nd ir">"title"</strong>&gt;&lt;<strong class="nd ir">p </strong>align=<strong class="nd ir">"center"</strong>&gt;<strong class="nd ir">{{currentEvent.</strong><em class="kz">title</em><strong class="nd ir">}}</strong>&lt;/<strong class="nd ir">p</strong>&gt;&lt;/<strong class="nd ir">h4</strong>&gt;<br/>    &lt;<strong class="nd ir">div </strong>class=<strong class="nd ir">"card-meta"</strong>&gt;<br/>      &lt;<strong class="nd ir">p </strong>v-if=<strong class="nd ir">"</strong>currentEvent.conference<strong class="nd ir">"</strong>&gt;<br/>        &lt;<strong class="nd ir">i </strong>class=<strong class="nd ir">"fas fa-link"</strong>&gt;&lt;/<strong class="nd ir">i</strong>&gt;<br/>        &lt;<strong class="nd ir">a </strong>:href=<strong class="nd ir">"</strong>currentEvent.conference.<em class="kz">url</em><strong class="nd ir">"</strong>&gt;<strong class="nd ir">{{currentEvent.conference.</strong><em class="kz">url</em><strong class="nd ir">}}</strong>&lt;/<strong class="nd ir">a</strong>&gt;<br/>      &lt;/<strong class="nd ir">p</strong>&gt;<br/>      &lt;<strong class="nd ir">p </strong>v-if=<strong class="nd ir">"</strong>currentEvent.<em class="kz">date</em><strong class="nd ir">"</strong>&gt;<br/>        &lt;<strong class="nd ir">i </strong>class=<strong class="nd ir">"far fa-calendar-alt"</strong>&gt;&lt;/<strong class="nd ir">i</strong>&gt;<br/>        <strong class="nd ir">{{currentEvent.</strong><em class="kz">date</em><strong class="nd ir">| moment('MMM Do, YYYY')}}<br/>      </strong>&lt;/<strong class="nd ir">p</strong>&gt;<br/>      &lt;<strong class="nd ir">p </strong>v-if=<strong class="nd ir">"</strong>currentEvent.<em class="kz">location</em><strong class="nd ir">"</strong>&gt;<br/>        &lt;<strong class="nd ir">i </strong>class=<strong class="nd ir">"fas fa-map-marker-alt"</strong>&gt;&lt;/<strong class="nd ir">i</strong>&gt;<br/>        <strong class="nd ir">{{currentEvent.</strong><em class="kz">location</em><strong class="nd ir">}}<br/>      </strong>&lt;/<strong class="nd ir">p</strong>&gt;<br/>    &lt;/<strong class="nd ir">div</strong>&gt;<br/>    &lt;<strong class="nd ir">p</strong>&gt;<br/>      <strong class="nd ir">{{currentEvent.</strong><em class="kz">description</em><strong class="nd ir">}}<br/>    </strong>&lt;/<strong class="nd ir">p</strong>&gt;<br/>    &lt;<strong class="nd ir">p </strong>align=<strong class="nd ir">"center"</strong>&gt;<br/>      &lt;<strong class="nd ir">template </strong>v-for=<strong class="nd ir">"</strong><em class="kz">action</em> in currentEvent.<em class="kz">actions</em><strong class="nd ir">"</strong>&gt;<br/>        &lt;<strong class="nd ir">b-button </strong>size=<strong class="nd ir">"lg" </strong>variant=<strong class="nd ir">"success"<br/>                  </strong>:key=<strong class="nd ir">"</strong><em class="kz">action</em>.<em class="kz">text</em><strong class="nd ir">"<br/>                  </strong>:href=<strong class="nd ir">"</strong><em class="kz">action</em>.<em class="kz">url</em>.<em class="kz">url</em><strong class="nd ir">"</strong>&gt;<br/>          <strong class="nd ir">{{</strong><em class="kz">action</em><strong class="nd ir">.</strong><em class="kz">text</em><strong class="nd ir">}}<br/>        </strong>&lt;/<strong class="nd ir">b-button</strong>&gt;<br/>      &lt;/<strong class="nd ir">template</strong>&gt;<br/>    &lt;/<strong class="nd ir">p</strong>&gt;<br/>  &lt;/<strong class="nd ir">div</strong>&gt;<br/>&lt;/<strong class="nd ir">div</strong>&gt;</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/b095fbb7e269c321ac6b3bbb58db8f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cL8Qnpj2rQcKj2LCVSMKig.png"/></div></div></figure><p id="d2d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以对于每个新事件，我只需要在<code class="fe na nb nc nd b">Events</code>文件夹中创建一个新的<code class="fe na nb nc nd b">event</code>故事；在主页上创建新的<code class="fe na nb nc nd b">Announce</code>，并设置相应事件故事的发布链接。非常简单，不需要任何代码。</p><h1 id="1563" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="af1a" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">我真的想保持简短(这里没有成功:)，所以我不会深入到事件结构或<code class="fe na nb nc nd b">Partners</code>页面。主要思想是展示如何从Storyblok获取故事数据，检查响应JSON，并简单地在您的应用程序中使用它。我希望这篇文章能帮助任何想使用CMS并且已经有一个工作项目的人。</p></div></div>    
</body>
</html>
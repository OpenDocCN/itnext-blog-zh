<html>
<head>
<title>How to run parallel tests on Travis CI with build matrix feature</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用构建矩阵特性在Travis CI上运行并行测试</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-run-parallel-tests-on-travis-ci-with-build-matrix-feature-4771a9e1af63?source=collection_archive---------3-----------------------#2018-12-15">https://itnext.io/how-to-run-parallel-tests-on-travis-ci-with-build-matrix-feature-4771a9e1af63?source=collection_archive---------3-----------------------#2018-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6ee4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Travis CI允许您在同一个CI构建中运行多个作业。它们甚至允许多达200个开源项目的并行作业(私有存储库也是如此)。您可以利用Travis build matrix特性，通过将测试分成许多较小的作业来运行您的测试套件的子集，从而更快地运行您的项目。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/1563d9ae199e58c65ab997288ab8601c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VpRj_saPAG2vmcwE.jpg"/></div></div></figure><h1 id="24cb" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">构建矩阵功能如何工作？</h1><p id="f89b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae ma" href="https://docs.travis-ci.com/user/build-matrix/" rel="noopener ugc nofollow" target="_blank">构建矩阵功能</a>允许自动创建语言和环境相关配置选项集的所有可能组合的矩阵。例如，当您想要在两种不同的编程语言版本和两种不同的浏览器上测试您的项目时，Travis会为每种编程语言和浏览器生成4个并行作业来运行您的测试。</p><h1 id="6198" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">跨并行作业拆分测试</h1><p id="4445" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们可以通过向您的项目<a class="ae ma" href="https://knapsackpro.com/?utm_source=medium&amp;utm_medium=blog_post&amp;utm_campaign=how-to-run-travis-ci-parallel-jobs-with-build-matrix-feature-fast" rel="noopener ugc nofollow" target="_blank">背包Pro </a>中添加构建矩阵特性来拆分测试，这将在并行作业之间自动拆分您的<strong class="jp ir"> Ruby </strong>或<strong class="jp ir"> Javascript </strong>测试，所有并行作业将运行测试套件的子集并在相似的时间内完成工作，因此您将尽可能快地获得测试套件通过或不通过的结果，而无需等待最慢的作业。</p><p id="2cb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何使用<a class="ae ma" href="https://github.com/KnapsackPro/knapsack_pro-ruby" rel="noopener ugc nofollow" target="_blank">backpack _ pro</a>Ruby gem在并行作业上运行Ruby测试:</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="a467" class="mg ky iq mc b gy mh mi l mj mk"><em class="ml"># .travis.yml</em><br/>script:<br/>  <em class="ml"># Step for RSpec</em><br/>  - "bundle exec rake knapsack_pro:rspec"<br/><br/>  <em class="ml"># Step for Cucumber</em><br/>  - "bundle exec rake knapsack_pro:cucumber"<br/><br/>  <em class="ml"># Step for Minitest</em><br/>  - "bundle exec rake knapsack_pro:minitest"<br/><br/>  <em class="ml"># Step for test-unit</em><br/>  - "bundle exec rake knapsack_pro:test_unit"<br/><br/>  <em class="ml"># Step for Spinach</em><br/>  - "bundle exec rake knapsack_pro:spinach"<br/><br/>env:<br/>  global:<br/>    <em class="ml"># tokens should be set in travis settings in web interface to avoid expose tokens in build logs</em><br/>    - KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=rspec-token<br/>    - KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=cucumber-token<br/>    - KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST=minitest-token<br/>    - KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT=test-unit-token<br/>    - KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH=spinach-token<br/><br/>    - KNAPSACK_PRO_CI_NODE_TOTAL=2<br/>  matrix:<br/>    - KNAPSACK_PRO_CI_NODE_INDEX=0<br/>    - KNAPSACK_PRO_CI_NODE_INDEX=1</span></pre><p id="d377" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何用JavaScript在并行作业上用<a class="ae ma" href="https://github.com/KnapsackPro/knapsack-pro-cypress" rel="noopener ugc nofollow" target="_blank">@ backpackage-pro/Cypress</a>运行Cypress测试:</p><pre class="km kn ko kp gt mb mc md me aw mf bi"><span id="fe9a" class="mg ky iq mc b gy mh mi l mj mk"><em class="ml"># .travis.yml</em><br/>script:<br/>  - "$(npm bin)/knapsack-pro-cypress"<br/><br/>env:<br/>  global:<br/>    - KNAPSACK_PRO_CI_NODE_TOTAL=2<br/>    <em class="ml"># allows to be able to retry failed tests on one of parallel job (CI node)</em><br/>    - KNAPSACK_PRO_FIXED_QUEUE_SPLIT=true<br/><br/>  matrix:<br/>    - KNAPSACK_PRO_CI_NODE_INDEX=0<br/>    - KNAPSACK_PRO_CI_NODE_INDEX=1</span></pre><p id="0643" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过跨Travis并行作业以动态的方式进行测试套件分割，我们节省了更多的时间，并保持了CI构建的快速性。我也将并行作业称为CI节点，因为它们是单个CI构建的一部分。在这个视频中，我描述了几个可以通过动态测试套件分割解决的问题。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h1 id="9119" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Travis CI构建行动矩阵</h1><p id="3cde" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果你想看看<a class="ae ma" href="https://knapsackpro.com/?utm_source=medium&amp;utm_medium=blog_post&amp;utm_campaign=how-to-run-travis-ci-parallel-jobs-with-build-matrix-feature-fast" rel="noopener ugc nofollow" target="_blank">backpack Pro如何帮助在并行任务中分割测试</a>你可以查看开源项目Consul——开放政府和电子参与网络软件。有一个<a class="ae ma" href="https://travis-ci.org/consul/consul" rel="noopener ugc nofollow" target="_blank">配置项构建列表供咨询</a>使用。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mo mn l"/></div></figure><p id="2c79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想了解更多关于使用<a class="ae ma" href="https://knapsackpro.com/?utm_source=medium&amp;utm_medium=blog_post&amp;utm_campaign=how-to-run-travis-ci-parallel-jobs-with-build-matrix-feature-fast" rel="noopener ugc nofollow" target="_blank">背包Pro </a>进行测试的信息，你可以查看我们<a class="ae ma" href="https://docs.knapsackpro.com/" rel="noopener ugc nofollow" target="_blank">博客</a>上的其他文章，比如<a class="ae ma" href="https://docs.knapsackpro.com/2018/run-javascript-e2e-tests-faster-with-cypress-on-parallel-ci-nodes" rel="noopener ugc nofollow" target="_blank">使用Cypress test runner </a>进行测试。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="bf9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ml">原载于</em><a class="ae ma" href="https://docs.knapsackpro.com/2018/how-to-run-travis-ci-parallel-jobs-with-build-matrix-feature-fast" rel="noopener ugc nofollow" target="_blank"><em class="ml">docs.knapsackpro.com</em></a><em class="ml">。</em></p></div></div>    
</body>
</html>
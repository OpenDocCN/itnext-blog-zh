<html>
<head>
<title>Why I Chose to Write my Own Android UI Testing Tool</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我选择编写自己的Android UI测试工具</h1>
<blockquote>原文：<a href="https://itnext.io/why-i-chose-to-write-my-own-android-ui-testing-tool-c6ac2570b06a?source=collection_archive---------2-----------------------#2020-09-16">https://itnext.io/why-i-chose-to-write-my-own-android-ui-testing-tool-c6ac2570b06a?source=collection_archive---------2-----------------------#2020-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9e49a890d4ce5ce7d54fa021c9fd221d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jh5U3bZpy-QnpsHo.png"/></div></div></figure><p id="293c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在2018年底，我再次与破碎的浓缩咖啡测试做斗争。挫败感占据了我，我意识到我与测试、测试自动化和测试框架的关系一直不好。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="0c12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，两年过去了，我几乎全职处理最不喜欢的软件开发话题。为什么？因为我决定自己写一个Android测试工具。</p><h1 id="5000" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">我不喜欢传统测试自动化的地方</h1><p id="1772" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">不要误解我，我不想提出“你做错了”的论点。<a class="ae mf" href="http://appium.io/" rel="noopener ugc nofollow" target="_blank">工具</a> <a class="ae mf" href="http://robolectric.org/" rel="noopener ugc nofollow" target="_blank"> out </a> <a class="ae mf" href="https://site.mockito.org/" rel="noopener ugc nofollow" target="_blank"> there </a>是我们目前拥有的最好的工具，它们对我们很多人来说都非常好用。但是我并不是唯一一个对测试自动化现状感到沮丧的人。在我为许多机构和创业公司做Android自由职业者的8年里，我发现一个<strong class="ka ir">“移动测试自动化没有回报”的态度是相当标准的</strong>。</p><h2 id="eb29" class="mg ld iq bd le mh mi dn li mj mk dp lm kj ml mm lq kn mn mo lu kr mp mq ly mr bi translated">Android测试困难的10个原因:</h2><ol class=""><li id="3a2a" class="ms mt iq ka b kb ma kf mb kj mu kn mv kr mw kv mx my mz na bi translated"><strong class="ka ir">测试自动化的设置并不简单。</strong>对于一个非常基础的应用程序来说，可能是这样。但通常情况并非如此(<a class="ae mf" href="https://www.repeato.app/espresso-wait-for-netowork-call/" rel="noopener ugc nofollow" target="_blank">空闲资源</a>、<a class="ae mf" href="https://android.jlelse.eu/instrumentation-testing-with-dagger2-retrofit2-mockwebserver-android-4cca7cb7373c" rel="noopener ugc nofollow" target="_blank"> Dagger2、Retrofit2、RxJava2和MockWebServer </a> ←这篇文章写得非常好，它的长度告诉了你很多关于设置的复杂性)</li><li id="a668" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">如果不马上修复，修复测试是很难的。我经常发现一个失败的测试为时已晚→费力寻找问题。因此，需要一个过程来确保测试的定期执行</li><li id="5dca" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">通常对以上观点的回答是:“<strong class="ka ir">持续集成</strong>”。如果你试图在你自己的服务器上设置CI、模拟器、测试自动化、通知和报告，你就会知道:这并不容易。这是一项巨大的投资</li><li id="7935" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">测试很容易出错，而且经常出错。随着更短的发布周期和不断的设计调整，软件产品一直在变化→持续的努力来维护测试。对于每隔一周就进行一次转型的早期创业公司来说，这一点尤其正确</li><li id="0bb1" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated"><strong class="ka ir">id是唯一的对吗？</strong> Turn's out他们往往不是→破测试</li><li id="2617" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">尽管<strong class="ka ir">id不应该改变</strong>，但它们经常会改变→失败的测试</li><li id="af90" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">编写测试时查找id可能<strong class="ka ir">非常耗时</strong>。<br/>特别是当你没有开发自己的应用程序，你不知道你的应用程序的布局文件</li><li id="6043" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">当测试中断时，找出问题所在通常非常耗时。通常你得到的只是一堆东西</li><li id="f95a" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated"><strong class="ka ir">有些东西几乎不可能测试</strong>:导航或小部件以不同的方式呈现<br/>(c++内容、3D内容、Webview、动画、地图等等)</li><li id="0998" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">第三次重写一个测试是非常乏味的</li></ol><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="ng lb l"/></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">“测试自动化过敏”——对软件开发人员来说，这是迄今为止最危险的过敏</figcaption></figure><h2 id="8eee" class="mg ld iq bd le mh mi dn li mj mk dp lm kj ml mm lq kn mn mo lu kr mp mq ly mr bi translated">测试自动化框架是愚蠢的</h2><p id="ddd6" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">大胆的声明对不对？我知道在Appium 的<a class="ae mf" href="https://github.com/appium/appium" rel="noopener ugc nofollow" target="_blank"> 7200次提交中体现了很多脑力。然而:需要进行大量的开发来提供一个基本的测试基础(比如与测试主体进行交流的方法以及不同平台的</a><a class="ae mf" href="https://github.com/appium/appium-espresso-driver/blob/master/lib/commands/idling-resources.js" rel="noopener ugc nofollow" target="_blank">细节</a>)。<br/>所以我想说的是:框架的实现可能很复杂，但本质上大多数测试框架的原则仍然是这样的:</p><ol class=""><li id="0299" class="ms mt iq ka b kb kc kf kg kj nl kn nm kr nn kv mx my mz na bi translated">通过单个“不变属性”(如ID)查找元素</li><li id="3e3f" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">与元素互动</li><li id="f3aa" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">查找其他元素</li><li id="3781" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">检查该元素的属性x是否如您所期望的那样</li></ol><p id="5c16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们开发人员仍有许多智能工作要做。比如:</p><ul class=""><li id="5ee5" class="ms mt iq ka b kb kc kf kg kj nl kn nm kr nn kv no my mz na bi translated">模仿对象(这需要智能布局的软件架构)</li><li id="90ea" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv no my mz na bi translated">同步进程，如后台任务或网络请求</li><li id="f2c4" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv no my mz na bi translated">将测试执行集成到CI中，<a class="ae mf" href="https://plugins.jenkins.io/slack/" rel="noopener ugc nofollow" target="_blank">通过API</a>等报告测试结果</li><li id="e948" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv no my mz na bi translated">修复ID查找等(见上文)</li></ul><h1 id="1384" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">现状</h1><p id="6b25" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">在我看来，软件测试的<strong class="ka ir">现状是:</strong></p><ol class=""><li id="1ede" class="ms mt iq ka b kb kc kf kg kj nl kn nm kr nn kv mx my mz na bi translated">测试创建是复杂的(需要高技能的人)💰</li><li id="a051" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">测试维护非常耗时💰</li><li id="c83c" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">设置测试自动化过程既耗时又复杂💰</li></ol><p id="1ea3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">结果是，许多<strong class="ka ir">机构</strong>(尤其是那些构建较小应用的机构)和<strong class="ka ir">初创公司</strong>(尤其是那些仍在大量转向的公司)<strong class="ka ir">倾向于手动测试。</strong></p><h1 id="9615" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">为什么手工软件测试仍然是一个好的选择</h1><ol class=""><li id="2586" class="ms mt iq ka b kb ma kf mb kj mu kn mv kr mw kv mx my mz na bi translated">一个<strong class="ka ir">流程</strong>很容易建立，并且有一个人负责执行该流程👍</li><li id="37a5" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">负责人可以使用<strong class="ka ir">基本工具</strong>如电子表格👍</li><li id="043a" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">这个人甚至不需要有IT知识👍</li><li id="5bd6" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated"><strong class="ka ir">测试结果可信度高</strong>:无嘲讽、无剥落、无测试环境。所见即所得👍</li></ol><p id="24cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">那么手工测试是正确的方式吗？</strong>当然不是。我已经见过很多次了:功能每天都在增加，测试成为软件开发工作流程的瓶颈只是时间问题。</p><h1 id="2cd7" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">单元测试呢？</h1><p id="226b" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">我上面写的大部分都和<strong class="ka ir"> Android UI测试</strong>有关。但是很多也适用于单元测试。它很复杂(架构，需要训练有素的人员)，测试更容易出错，测试结果的可信度比UI测试低。我不反对单元测试。这是必要的，你可能知道它不能代替UI测试。<br/>为了完整起见，我想加入这条推文:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="np lb l"/></div></figure><h1 id="f3be" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">我们能够构建更智能的ANDROID UI测试工具吗？</h1><p id="81cb" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">早在2018年，我就在想:如果一个随机的学生甚至可以在<em class="nq">不知道</em><a class="ae mf" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"><em class="nq">kotlin</em></a><em class="nq">，</em>一个单词的情况下测试我们的应用程序，为什么没有这样的软件呢？我的意思是，我们即将拥有自动驾驶汽车和无人驾驶飞机，对吗？</p><p id="6cdf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我坐下来，试着想象一个软件测试人员的认知工作:</p><ol class=""><li id="0ba4" class="ms mt iq ka b kb kc kf kg kj nl kn nm kr nn kv mx my mz na bi translated">对智能手机用户界面(屏幕、过渡、列表、历史回顾)有一些基本的了解</li><li id="d7af" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">对他们正在测试的应用类型有一些基本的了解</li><li id="4126" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">对要检查的东西有一些说明(用例)</li><li id="3b17" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">了解应用程序应该如何理想地工作</li><li id="1c3e" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">如果应用程序没有显示预期的行为，知道如何制作截图和报告</li></ol><p id="2a2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">听起来很简单，对吧？至少我当时是这么想的。我甚至没有检查现有的AI测试框架(如果你感兴趣，这里有<a class="ae mf" href="https://medium.com/@foohm71/the-case-for-ai-in-software-testing-5aba64e62d0f" rel="noopener">一篇关于AI测试的好文章</a>)。</p><p id="0332" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我想如果没有我的天真，我不会开始这个项目。不过，还有一个激励因素:在我写第一行代码之前，我在维也纳安排了10次与不同移动应用代理和初创公司的会议。我问他们关于测试自动化的体验，以及他们是否感受到同样的痛苦。我从那些采访中得到的结果非常有说服力。</p><p id="3680" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以现在我已经花了大约18个月的时间来开发Android UI测试工具，它叫做<a class="ae mf" href="https://www.repeato.app/" rel="noopener ugc nofollow" target="_blank"> Repeato </a>。</p><p id="5dd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Repeato试图像人类一样操作:它看着你的设备屏幕，试图识别视觉元素，在执行下一步之前等待过渡动画完成，就像普通用户<br/>会做的一样。而且它不关心你的IDs或者正在使用的框架。</p><p id="bfc6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该软件的许多人工智能部分仍在开发中，但Repeato已经被快乐的客户🥳卓有成效地使用</p><p id="ac17" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我计划写另一篇文章，给那些对实现的技术方面感兴趣的人。</p><p id="cbb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢阅读！</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><p id="fdd1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nq">原载于2020年9月16日</em><a class="ae mf" href="https://www.repeato.app/write-android-ui-testing-tool/" rel="noopener ugc nofollow" target="_blank"><em class="nq">https://www . repeato . app</em></a><em class="nq">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Apache Druid: overview, running in Kubernetes and monitoring with Prometheus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache德鲁伊:概述，在Kubernetes中运行并使用Prometheus进行监控</h1>
<blockquote>原文：<a href="https://itnext.io/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus-4c8d29f6c8b9?source=collection_archive---------5-----------------------#2022-09-18">https://itnext.io/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus-4c8d29f6c8b9?source=collection_archive---------5-----------------------#2022-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7cdd712e9350106e317ba97c3fe800d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQbLmsckLyogownDyeb-tg.png"/></div></div></figure><p id="6d0f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Apache Druid是一个<a class="ae kw" href="https://highload.today/kolonochnye-bazy-dannykh/" rel="noopener ugc nofollow" target="_blank">列数据库</a>，专注于处理大量数据，结合了时间序列数据库、数据仓库和搜索引擎的特性和优点。</p><p id="c797" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一般的任务是在Kubernetes中设置对Druid集群的监控，所以首先，我们将了解它一般是什么以及它是如何工作的，然后我们启动Druid来配置它的监控。</p><p id="587e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了在Kubernetes中运行德鲁伊本身，我们使用<a class="ae kw" href="https://github.com/druid-io/druid-operator" rel="noopener ugc nofollow" target="_blank">德鲁伊-操作员</a>，收集指标— <a class="ae kw" href="https://github.com/opstree/druid-exporter" rel="noopener ugc nofollow" target="_blank">德鲁伊-导出器</a>，监控— Kubernetes普罗米修斯堆栈，我们将在Minikube中运行所有这些。</p><ul class=""><li id="a269" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Apache_Druid_overview" rel="noopener ugc nofollow" target="_blank">阿帕奇德鲁伊概述</a></li><li id="24a3" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Druid_Architecture_and_Components" rel="noopener ugc nofollow" target="_blank">德鲁伊架构和组件</a></li><li id="69d6" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Three-server_configuration_-_Master_Query_Data" rel="noopener ugc nofollow" target="_blank">三服务器配置—主服务器、查询服务器、数据服务器</a></li><li id="726c" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Druid_data_flow" rel="noopener ugc nofollow" target="_blank">德鲁伊数据流</a></li><li id="1a93" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Data_ingest" rel="noopener ugc nofollow" target="_blank">数据摄取</a></li><li id="5428" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Data_query" rel="noopener ugc nofollow" target="_blank">数据查询</a></li><li id="00a0" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Running_Druid_in_Kubernetes" rel="noopener ugc nofollow" target="_blank">在Kubernetes中运行德鲁伊</a></li><li id="9a63" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Druid_Operator_install" rel="noopener ugc nofollow" target="_blank">德鲁伊操作员安装</a></li><li id="c109" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Spin_Up_Druid_Cluster" rel="noopener ugc nofollow" target="_blank">旋转德鲁伊集群</a></li><li id="c69a" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Installing_Kube_Prometheus_Stack" rel="noopener ugc nofollow" target="_blank">安装Kube Prometheus Stack </a></li><li id="79ad" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Grafana_dashboard" rel="noopener ugc nofollow" target="_blank">格拉夫纳仪表盘</a></li><li id="8607" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Running_Druid_Exporter" rel="noopener ugc nofollow" target="_blank">经营德鲁伊出口</a></li><li id="4f3e" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Prometheus_ServiceMonitor" rel="noopener ugc nofollow" target="_blank">普罗米修斯服务监视器</a></li><li id="1849" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Apache_Druid_Monitoring" rel="noopener ugc nofollow" target="_blank">阿帕奇德鲁伊监控</a></li><li id="8043" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Druid_Metrics_Emitters" rel="noopener ugc nofollow" target="_blank">德鲁伊指标发射器</a></li><li id="faf0" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Druid_Monitors" rel="noopener ugc nofollow" target="_blank">德鲁伊监视器</a></li><li id="329d" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/#Related_links" rel="noopener ugc nofollow" target="_blank">相关链接</a></li></ul><h1 id="7f42" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">阿帕奇德鲁伊概述</h1><p id="100a" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">对我个人来说，Druid的主要特点是，该系统最初是为在AWS和Kubernetes等云中使用而开发的，因此它具有出色的伸缩性、数据存储和在某个服务崩溃时的恢复能力。</p><p id="d8a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有，阿帕奇德鲁伊是:</p><ul class=""><li id="d400" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><strong class="ka ir">柱状数据存储格式</strong>:只加载必要的表进行处理，显著提高了查询处理的速度。此外，为了快速扫描和数据聚合，Druid根据其数据类型优化列存储。</li><li id="eb3a" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">可扩展的分布式系统</strong> : Druid集群可以位于数十甚至数百个单独的服务器上</li><li id="757b" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">数据并行处理:德鲁伊可以在独立的实例上并行处理每个请求</li><li id="2cda" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">自我修复和自我平衡</strong>:您可以随时向集群添加或删除新节点，而集群本身会执行平衡请求并在它们之间进行切换，而不会出现任何停机。此外，Druid允许您在不停机的情况下执行版本升级。</li><li id="2b79" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">实际上，<strong class="ka ir">云原生和容错架构</strong> : Druid最初被设计用于分布式系统。在收到新数据后，他会立即将它们复制到他的深层存储中，这可以是亚马逊S3、HDFS等数据存储服务，也可以是网络文件系统，即使所有德鲁伊服务器都崩溃了，也可以让你恢复数据。在只有一部分德鲁伊服务器崩溃的情况下——内置的数据复制将允许您继续执行查询(我已经很想杀死他的节点并观察德鲁伊的反应了——但不是这次)</li><li id="8fac" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">用于快速搜索的索引</strong>:德鲁伊使用压缩位图索引，允许你快速搜索多列</li><li id="3d02" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">基于时间的划分</strong>:默认情况下，德鲁伊按时间划分数据，允许跨其他字段创建额外的段。因此，当执行有时间间隔的查询时，将只使用必要的数据段</li></ul><h2 id="7ff4" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">Druid架构和组件</h2><p id="e268" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">总体架构:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/7ed84899c89de8712575e2b61ab9dc4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bMz6dG-DKUWDpFR0.png"/></div></div></figure><p id="ec66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者像这样:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/9062829db293b0d82ad60684a36fe855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yuxgd1LHTTyjT-zP.jpg"/></div></div></figure><p id="1778" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">参见<a class="ae kw" href="https://druid.apache.org/docs/latest/design/processes.html" rel="noopener ugc nofollow" target="_blank">流程和服务器</a>。</p><h2 id="ca55" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">三服务器配置—主服务器、查询服务器、数据服务器</h2><p id="5b4e" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">Druid有几个用于处理数据的内部服务，这些服务可以分为三种类型的服务器— <em class="ng">主服务器、查询服务器和数据服务器</em>，参见<a class="ae kw" href="https://druid.apache.org/docs/0.23.0/design/processes.html#pros-and-cons-of-colocation" rel="noopener ugc nofollow" target="_blank">主机托管的利弊</a>。</p><p id="ede3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://druid.apache.org/docs/0.23.0/design/processes.html#master-server" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">主服务器</strong> </a> —管理新数据的添加和可用性(摄取/索引)—负责启动新任务以添加新数据并协调数据可用性:</p><ul class=""><li id="8e47" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><strong class="ka ir">协调器</strong>:负责将数据段放置在有历史进程的特定节点上</li><li id="8420" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">霸王</strong>:负责向中层管理人员下达添加传入数据的任务，并负责协调已创建的细分市场向深层存储的转移</li></ul><p id="a6e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://druid.apache.org/docs/0.23.0/design/processes.html#query-server" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">查询服务器</strong> </a> —客户请求管理</p><ul class=""><li id="367c" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><strong class="ka ir">代理</strong>:接收来自客户端的请求，确定哪个历史或中间管理器进程/节点包含必要的段，并根据初始客户端请求，形成子查询(sub-query)并将其发送给这些进程中的每一个，之后，它接收来自它们的响应，形成来自它们的带有客户端数据的一般响应，并将其发送给他。<br/>与此同时，Historicals响应引用已经存储在深层存储中的数据段的子查询，而中层管理器响应引用最近接收的仍在内存中且未发送到深层存储的数据的查询</li><li id="0053" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">路由器</strong>:一个可选的服务，它提供了一个通用的API来与代理、领主和协调者一起工作，尽管你可以直接使用它们。此外，Router提供了Druid控制台——WebUI来处理集群，我们稍后会看到</li></ul><p id="7728" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://druid.apache.org/docs/0.23.0/design/processes.html#data-server" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">数据服务器</strong> </a> —管理向集群添加新数据，并为客户端存储数据:</p><ul class=""><li id="ea3a" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><strong class="ka ir">Historical</strong>:Druid的“主要工作人员”，他们负责存储和查询“历史”数据，即那些已经在深层存储中的数据，从那里将数据段下载到运行历史进程的主机的本地磁盘，并基于这些数据为客户端生成响应</li><li id="64f2" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">中层管理人员</strong>:负责向集群添加新数据——他们从外部源读取数据，并从中创建新的数据段，然后将这些数据段加载到深层存储中</li><li id="b7fd" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/0.23.0/design/peons.html" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"/></a>:多个任务可以负责向一个集群添加数据。为了记录和隔离资源，中层管理人员创建Peons，Peons是独立的JVM进程，负责执行中层管理人员的特定任务。始终在产生Peon进程的中间管理器进程运行的主机上运行。</li><li id="3323" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka ir">索引器</strong>:中间管理器和Peon的替代方案——索引器不是为来自中间管理器的每个任务创建单独的JVM，而是在其JVM的单独线程中执行它们。<br/>作为中层管理人员和员工的简单替代方案开发，目前是<a class="ae kw" href="https://druid.apache.org/docs/0.23.0/development/experimental.html" rel="noopener ugc nofollow" target="_blank">试验功能</a>，但将来会取代中层管理人员和员工</li></ul><p id="8e5f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">除了内部流程，德鲁伊还使用外部服务来工作——深度存储<strong class="ka ir">、<strong class="ka ir">元数据存储</strong>和<strong class="ka ir">动物园管理员</strong>:</strong></p><ul class=""><li id="762b" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/dependencies/deep-storage.html" rel="noopener ugc nofollow" target="_blank">深度存储</a>:用于存储所有添加到系统中的数据，是一个分布式存储，可供每个Druid服务器使用。可以是<a class="ae kw" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank">亚马逊S3 </a>、<a class="ae kw" href="https://hadoop.apache.org/docs/r1.2.1/hdfs_design.html" rel="noopener ugc nofollow" target="_blank"> HDFS </a>，也可以是<a class="ae kw" href="https://en.wikipedia.org/wiki/Network_File_System" rel="noopener ugc nofollow" target="_blank"> NFS </a></li><li id="9a9c" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/dependencies/metadata-storage.html" rel="noopener ugc nofollow" target="_blank">元数据存储</a>:用于存储段使用信息、当前任务等内部元数据。这种存储的角色可以是经典的SUDB，如PostgreSQL或MySQL</li><li id="f668" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/dependencies/zookeeper.html" rel="noopener ugc nofollow" target="_blank"> ZooKeeper </a>:用于服务发现和服务协调(在Kubernetes中，您可以使用<code class="fe nh ni nj nk b"><a class="ae kw" href="https://druid.apache.org/docs/latest/development/extensions-core/kubernetes.html" rel="noopener ugc nofollow" target="_blank">druid-kubernetes-extensions</a></code>来代替，我们也将尝试它，但另一个时间)</li></ul><h2 id="5591" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">德鲁伊数据流</h2><p id="9897" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">让我们看看如何添加数据(数据摄取)和回答客户端(数据查询，查询回答)。</p><h2 id="d866" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">数据接收</h2><p id="b99b" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">添加数据可以分为两个阶段:首先，中间管理器实例运行索引任务，这些任务创建数据段并将它们发送到深层存储。</p><p id="dbbb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第二种情况下，历史实例从深层存储中下载数据段，以便在对客户查询进行回复时使用。</p><p id="04ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一阶段是从外部来源获取数据，索引和创建数据段，并将它们上传到深层存储:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/e5e8d2736bc8012522fb1d42d1c516a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rDaHChn_oygEzTNy.png"/></div></div></figure><p id="d0e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同时，在创建数据段的过程中，已经可以对它们执行查询。</p><p id="2843" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第二阶段，协调器轮询元数据存储以搜索新的数据段。一旦协调器进程找到它们，它就选择历史实例，该实例必须从深层存储中下载该段，以便它可用于处理请求:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/b6f82f461b6bf597883f13c6b46a7585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E0rNdfIio_FaQsUJ.png"/></div></div></figure><p id="e1a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">协调器轮询元数据存储中的新数据段。一旦找到它们，协调器就选择历史实例，该实例应该从深层存储中下载片段。当段被加载时——历史记录准备使用它来处理请求</p><h2 id="7304" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">数据查询</h2><p id="2183" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">客户端直接或通过路由器向代理发送请求。</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/43aadbbd7d0debec037d9e3d8b0d95b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*elif6-EzLqqdYhy6.png"/></div></div></figure><p id="0b2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当收到这样的请求时，代理确定哪些进程正在为所需的数据段提供服务。</p><p id="12f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果数据既需要来自深层存储(一些旧的)的数据段，也需要来自中间管理器(我们现在从流中获得)的数据段，那么代理形成并向历史管理器和中间管理器发送单独的子请求，其中每个管理器将执行自己的部分，并将数据返回给代理。代理将它们聚合起来，并向客户端返回最终结果。</p><p id="8466" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，让我们尝试部署这整个东西并用小树枝戳它，然后从上面添加监控。</p><h1 id="35c2" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">在Kubernetes经营德鲁伊</h1><p id="e59f" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">运行<a class="ae kw" href="https://rtfm.co.ua/kubernetes-zapusk-minikube-na-arch-linux/" rel="noopener ugc nofollow" target="_blank"> Minikube </a>，添加内存和CPU安静地运行所有pod，这里我们分配24个RAM和8个内核——Java在那里，让它吃:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="c394" class="mo lm iq nk b gy np nq l nr ns">$ minikube start — memory 12000 — cpus 8<br/>😄 minikube v1.26.1 on Arch “rolling”<br/>✨ Automatically selected the virtualbox driver<br/>👍 Starting control plane node minikube in cluster minikube<br/>🔥 Creating virtualbox VM (CPUs=8, Memory=12000MB, Disk=20000MB) …<br/>🐳 Preparing Kubernetes v1.24.3 on Docker 20.10.17 …<br/>▪ Generating certificates and keys …<br/>▪ Booting up control plane …<br/>▪ Configuring RBAC rules …<br/>🔎 Verifying Kubernetes components…<br/>▪ Using image gcr.io/k8s-minikube/storage-provisioner:v5<br/>🌟 Enabled addons: storage-provisioner, default-storageclass<br/>🏄 Done! kubectl is now configured to use “minikube” cluster and “default” namespace by default</span></pre><p id="bd21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="7ebd" class="mo lm iq nk b gy np nq l nr ns">$ minikube status<br/>minikube<br/>type: Control Plane<br/>host: Running<br/>kubelet: Running<br/>apiserver: Running<br/>kubeconfig: Configured</span></pre><p id="3813" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和节点:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="00e8" class="mo lm iq nk b gy np nq l nr ns">$ kubectl get node<br/>NAME STATUS ROLES AGE VERSION<br/>minikube Ready control-plane 41s v1.24.3</span></pre><p id="7b9b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们继续安装Apache Druid操作符。</p><h2 id="5ce6" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">德鲁伊操作员安装</h2><p id="2b5c" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">为操作符创建一个名称空间:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="a84b" class="mo lm iq nk b gy np nq l nr ns">$ kubectl create namespace druid-operator<br/>namespace/druid-operator created</span></pre><p id="943f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将运算符设置为此命名空间:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="5b9f" class="mo lm iq nk b gy np nq l nr ns">$ git clone <a class="ae kw" href="https://github.com/druid-io/druid-operator.git" rel="noopener ugc nofollow" target="_blank">https://github.com/druid-io/druid-operator.git</a><br/>$ cd druid-operator/<br/>$ helm -n druid-operator install cluster-druid-operator ./chart</span></pre><p id="a1df" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查盒:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="9084" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n druid-operator get pod<br/>NAME READY STATUS RESTARTS AGE<br/>cluster-druid-operator-9c8c44f78–8svhc 1/1 Running 0 49s</span></pre><p id="77ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">继续创建集群。</p><h2 id="859e" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">旋转德鲁伊集群</h2><p id="90ca" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">创建名称空间:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="8a14" class="mo lm iq nk b gy np nq l nr ns">$ kubectl create ns druid<br/>namespace/druid created</span></pre><p id="6c78" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装Zookeeper:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="3767" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n druid apply -f examples/tiny-cluster-zk.yaml<br/>service/tiny-cluster-zk created<br/>statefulset.apps/tiny-cluster-zk created</span></pre><p id="a525" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要创建一个测试集群，使用示例中的配置— <code class="fe nh ni nj nk b"><a class="ae kw" href="https://github.com/druid-io/druid-operator/blob/master/examples/tiny-cluster.yaml" rel="noopener ugc nofollow" target="_blank">examples/tiny-cluster.yaml</a></code>。</p><p id="1044" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建集群:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="e748" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n druid apply -f examples/tiny-cluster.yaml<br/>druid.druid.apache.org/tiny-cluster created</span></pre><p id="641a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查资源:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="df5d" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n druid get all</span><span id="d05b" class="mo lm iq nk b gy nt nq l nr ns">NAME READY STATUS RESTARTS AGE<br/>pod/druid-tiny-cluster-brokers-0 0/1 ContainerCreating 0 21s<br/>pod/druid-tiny-cluster-coordinators-0 0/1 ContainerCreating 0 21s<br/>pod/druid-tiny-cluster-historicals-0 0/1 ContainerCreating 0 21s<br/>pod/druid-tiny-cluster-routers-0 0/1 ContainerCreating 0 21s<br/>pod/tiny-cluster-zk-0 1/1 Running 0 40s</span><span id="fc3f" class="mo lm iq nk b gy nt nq l nr ns">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE<br/>service/druid-tiny-cluster-brokers ClusterIP None &lt;none&gt; 8088/TCP 21s<br/>service/druid-tiny-cluster-coordinators ClusterIP None &lt;none&gt; 8088/TCP 21s<br/>service/druid-tiny-cluster-historicals ClusterIP None &lt;none&gt; 8088/TCP 21s<br/>service/druid-tiny-cluster-routers ClusterIP None &lt;none&gt; 8088/TCP 21s<br/>service/tiny-cluster-zk ClusterIP None &lt;none&gt; 2181/TCP,2888/TCP,3888/TCP 40s</span><span id="7825" class="mo lm iq nk b gy nt nq l nr ns">NAME READY AGE<br/>statefulset.apps/druid-tiny-cluster-brokers 0/1 21s<br/>statefulset.apps/druid-tiny-cluster-coordinators 0/1 21s<br/>statefulset.apps/druid-tiny-cluster-historicals 0/1 21s<br/>statefulset.apps/druid-tiny-cluster-routers 0/1 21s<br/>statefulset.apps/tiny-cluster-zk 1/1 40s</span></pre><p id="899a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">等待pod切换到运行状态(大约需要5分钟)，并将端口转发到Druid路由器:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="853f" class="mo lm iq nk b gy np nq l nr ns">$ kubectl port-forward svc/druid-tiny-cluster-routers 8888:8088 -n druid<br/>Forwarding from 127.0.0.1:8888 -&gt; 8088<br/>Forwarding from [::1]:8888 -&gt; 8088</span></pre><p id="fa5b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开德鲁伊控制台—<a class="ae kw" href="http://localhost:8888:" rel="noopener ugc nofollow" target="_blank"><em class="ng">http://localhost:8888</em>:</a></p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/cc333ace1c66f69175ac132b47916079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FPzTI9Hzx5aklazF.png"/></div></div></figure><p id="007e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以看看德鲁伊的服务——我们会看到与我们在Kubernetes pods中看到的相同的服务:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/c8b6dc3b74103d5f6125036b1f79bafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H4z-TSjlogSEGRJb.png"/></div></div></figure><p id="ab2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.youtube.com/watch?v=bPtT08_R1bU" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">这里</strong> </a>是一个很好的短视频，有加载测试数据的例子——为了兴趣，可以走一走。</p><p id="3692" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们继续安装普罗米修斯。</p><h1 id="5bd2" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">安装Kube Prometheus堆栈</h1><p id="db49" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">创建名称空间:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="07a1" class="mo lm iq nk b gy np nq l nr ns">$ kubectl create ns monitoring<br/>namespace/monitoring created</span></pre><p id="118f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装KPS:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="0f72" class="mo lm iq nk b gy np nq l nr ns">$ helm -n monitoring install kube-prometheus-stack prometheus-community/kube-prometheus-stack<br/>NAME: kube-prometheus-stack<br/>LAST DEPLOYED: Tue Sep 13 15:24:22 2022<br/>NAMESPACE: monitoring<br/>STATUS: deployed<br/>…</span></pre><p id="8b0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查舱:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="de7c" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring get po<br/>NAME READY STATUS RESTARTS AGE<br/>alertmanager-kube-prometheus-stack-alertmanager-0 0/2 ContainerCreating 0 22s<br/>kube-prometheus-stack-grafana-595f8cff67-zrvxv 3/3 Running 0 42s<br/>kube-prometheus-stack-kube-state-metrics-66dd655687-nkxpb 1/1 Running 0 42s<br/>kube-prometheus-stack-operator-7bc9959dd6-d52gh 1/1 Running 0 42s<br/>kube-prometheus-stack-prometheus-node-exporter-rvgxw 1/1 Running 0 42s<br/>prometheus-kube-prometheus-stack-prometheus-0 0/2 Init:0/1 0 22s</span></pre><p id="9360" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">等待几分钟，直到每个人都开始运行，并打开普罗米修斯:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="a020" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring port-forward svc/kube-prometheus-stack-prometheus 9090:9090<br/>Forwarding from 127.0.0.1:9090 -&gt; 9090<br/>Forwarding from [::1]:9090 -&gt; 9090</span></pre><p id="51b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开放Grafana的访问:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="1a04" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring port-forward svc/kube-prometheus-stack-grafana 8080:80<br/>Forwarding from 127.0.0.1:8080 -&gt; 3000<br/>Forwarding from [::1]:8080 -&gt; 3000</span></pre><h2 id="d42f" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">Grafana仪表板</h2><p id="9a3a" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">要从Grafana获取密码，请找到它的秘密:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="8d70" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring get secret | grep graf<br/>kube-prometheus-stack-grafana Opaque 3 102s</span></pre><p id="2918" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">获取其值:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="d125" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring get secret kube-prometheus-stack-grafana -o jsonpath=”{.data.admin-password}” | base64 — decode ; echo<br/>prom-operator</span></pre><p id="8c14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于Grafana，有一个现成的<a class="ae kw" href="https://grafana.com/grafana/dashboards/12155-druid-druid-overview/" rel="noopener ugc nofollow" target="_blank">社区дашборда </a>，我们现在可以添加它，但以后我们会创建自己的社区。</p><p id="5551" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在浏览器中打开localhost:8080，登录并进入<em class="ng">仪表盘&gt;导入</em>:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/6b1cb504b048494112ee6df658baf6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/0*RbDYgGXpYzKMYirQ.png"/></div></figure><p id="8731" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">设置ID <em class="ng"> 12155 </em>，装载:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/3e9bda68e85fa6b6080b390da914488a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*Y179a628dye_0QlE.png"/></div></figure><p id="aaef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择<em class="ng">普罗米修斯</em>作为数据源:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/65189c6288b042a3883cabbf271f45e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mPNZQ5XFvlMBM4ue.png"/></div></div></figure><p id="d88b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们得到了这样一个板，但是至今没有任何数据:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/e8cb3440d8d2d34cbb2a07b425b85dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BI98Xjcz-0P_rgeI.png"/></div></div></figure><h2 id="7e51" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">运行德鲁伊导出器</h2><p id="0440" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">克隆存储库:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="d7a8" class="mo lm iq nk b gy np nq l nr ns">$ cd ../<br/>$ git clone <a class="ae kw" href="https://github.com/opstree/druid-exporter.git" rel="noopener ugc nofollow" target="_blank">https://github.com/opstree/druid-exporter.git</a><br/>$ cd druid-exporter/</span></pre><p id="a9d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查Druid路由器的Kubernetes服务—我们需要它的全名来配置导出器:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="3f25" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n druid get svc<br/>NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE<br/>…<br/>druid-tiny-cluster-routers ClusterIP None &lt;none&gt; 8088/TCP 4m3s<br/>…</span></pre><p id="0697" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在名称空间<em class="ng"> monitoring </em>中安装导出器，在<code class="fe nh ni nj nk b">druidURL</code>参数中，我们指定我们刚才看到的Druid集群的路由器服务的URL、它的端口，然后我们启用Kubernetes ServiceMonitor的创建以及Prometheus ( <em class="ng"> monitoring </em>)为我们工作的名称空间:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="d473" class="mo lm iq nk b gy np nq l nr ns">$ helm -n monitoring install druid-exporter ./helm/ --set druidURL="http://druid-tiny-cluster-routers.druid.svc.cluster.local:8088" --set druidExporterPort="8080" --set logLevel="debug" --set logFormat=”text” --set serviceMonitor.enabled=true -set serviceMonitor.namespace="monitoring"<br/>NAME: druid-exporter<br/>LAST DEPLOYED: Tue Sep 13 15:28:25 2022<br/>NAMESPACE: monitoring<br/>STATUS: deployed<br/>…</span></pre><p id="4499" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开放对出口商服务的访问:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="e902" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring port-forward svc/druid-exporter-prometheus-druid-exporter 8989:8080<br/>Forwarding from 127.0.0.1:8989 -&gt; 8080<br/>Forwarding from [::1]:8989 -&gt; 8080</span></pre><p id="d0ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查指标:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="462f" class="mo lm iq nk b gy np nq l nr ns">$ curl -s localhost:8989/metrics | grep -v ‘#’ | grep druid_<br/>druid_completed_tasks 0<br/>druid_health_status{druid=”health”} 1<br/>druid_pending_tasks 0<br/>druid_running_tasks 0<br/>druid_waiting_tasks 0</span></pre><p id="3b93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好的——已经有了，尽管还不够。让我们将数据收集添加到Prometheus中，然后我们将添加更多的指标。</p><h2 id="36cb" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">普罗米修斯服务监视器</h2><p id="6878" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">检查Prometheus服务发现—我们所有的服务监视器都应该在这里:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/80fe890a4fbfeadf202c05f26926e713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6qud09FcI-RpABhE.png"/></div></div></figure><p id="048a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查是否在Kubernetes中创建了Druid ServiceMonitor:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="5c7c" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring get servicemonitors<br/>NAME AGE<br/>druid-exporter-prometheus-druid-exporter 87s<br/>…</span></pre><p id="4f8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查普罗米修斯资源—它的<code class="fe nh ni nj nk b">serviceMonitorSelector</code>:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="4934" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring get prometheus -o yaml | yq .items[].spec.serviceMonitorSelector.matchLabels<br/>{<br/>“release”: “kube-prometheus-stack”<br/>}</span></pre><p id="9e68" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">编辑Druid服务监视器:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="8b6e" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n monitoring edit servicemonitor druid-exporter-prometheus-druid-exporter</span></pre><p id="23b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加标签<code class="fe nh ni nj nk b">release: kube-prometheus-stack</code>，以便Prometheus开始从此ServiceMonitor收集指标:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/77bd076cec36427c3c481a99c5daf308.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/0*jP4t6la-jcrzdM2N.png"/></div></figure><p id="0d80" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">稍等一两分钟，再次检查监视器:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/ed0c408807d0807f2a0289c062c0ef7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r6VZ-C3gVvJKvarE.png"/></div></div></figure><p id="8575" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查指标:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/b1dbbef153b753ed08a3a1fded70e23c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NK2c-XIBdZNwXO8W.png"/></div></div></figure><p id="d5ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好的，现在我们有了德鲁伊集群，我们有了收集指标的普罗米修斯，它仍然需要配置这些相同的指标。</p><h1 id="03d8" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">阿帕奇德鲁伊监控</h1><p id="be95" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">德鲁伊的监视设置包括<em class="ng">发射器</em>和<em class="ng">监视器</em>:发射器从德鲁伊“推出”指标，监视器决定哪些指标可用。同时，对于某些指标，需要包括额外的扩展。</p><p id="77f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">См:</p><ul class=""><li id="91cc" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/operations/metrics.html" rel="noopener ugc nofollow" target="_blank">指标</a></li><li id="ebcc" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/configuration/index.html#metrics-emitters" rel="noopener ugc nofollow" target="_blank">指标发射器</a></li><li id="cba3" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/configuration/index.html#metrics-monitors" rel="noopener ugc nofollow" target="_blank">指标监视器</a></li><li id="b90a" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://druid.apache.org/docs/latest/development/extensions.html#core-extensions" rel="noopener ugc nofollow" target="_blank">扩展</a></li></ul><p id="efab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所有服务都有共同的指标，例如<code class="fe nh ni nj nk b">query/time</code>，而您自己的，例如，有一个名为<code class="fe nh ni nj nk b">sqlQuery/time</code>的代理指标，这些额外的指标可以通过其<code class="fe nh ni nj nk b">runtime.properties</code>为特定服务启用。</p><h2 id="ce93" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">德鲁伊度量发射器</h2><p id="8150" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">要启用指标发射—编辑<code class="fe nh ni nj nk b">examples/tiny-cluster.yaml</code>，并向<code class="fe nh ni nj nk b">common.runtime.properties</code>添加以下内容:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="4324" class="mo lm iq nk b gy np nq l nr ns">druid.emitter=http<br/>druid.emitter.logging.logLevel=debug<br/>druid.emitter.http.recipientBaseUrl=http://druid-exporter-prometheus-druid-exporter.monitoring.svc.cluster.local:8080/druid</span></pre><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/9dbf2b3a89de78d26aa1123aa47b0253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OkqvZZ5v3Ftb4hG1.png"/></div></div></figure><p id="2d33" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存，更新集群:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="8eb1" class="mo lm iq nk b gy np nq l nr ns">$ kubectl -n druid apply -f examples/tiny-cluster.yaml<br/>druid.druid.apache.org/tiny-cluster configured</span></pre><p id="53e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">等待一两分钟，让pod重新启动并开始收集指标，在导出器中检查指标:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="dd34" class="mo lm iq nk b gy np nq l nr ns">$ curl -s localhost:8989/metrics | grep -v ‘#’ | grep druid_ | head<br/>druid_completed_tasks 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-brokers-0:8088",metric_name=”avatica-remote-JsonHandler-Handler/Serialization”,service=”druid-broker”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-brokers-0:8088",metric_name=”avatica-remote-ProtobufHandler-Handler/Serialization”,service=”druid-broker”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-brokers-0:8088",metric_name=”avatica-server-AvaticaJsonHandler-Handler/RequestTimings”,service=”druid-broker”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-brokers-0:8088",metric_name=”avatica-server-AvaticaProtobufHandler-Handler/RequestTimings”,service=”druid-broker”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-brokers-0:8088",metric_name=”jetty-numOpenConnections”,service=”druid-broker”} 1<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-coordinators-0:8088",metric_name=”compact-task-count”,service=”druid-coordinator”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-coordinators-0:8088",metric_name=”compactTask-availableSlot-count”,service=”druid-coordinator”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-coordinators-0:8088",metric_name=”compactTask-maxSlot-count”,service=”druid-coordinator”} 0<br/>druid_emitted_metrics{datasource=””,host=”druid-tiny-cluster-coordinators-0:8088",metric_name=”coordinator-global-time”,service=”druid-coordinator”} 2</span></pre><p id="f5ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">得到了新的<code class="fe nh ni nj nk b">druid_emitted_metrics</code>——不错。</p><p id="cd21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在标签<code class="fe nh ni nj nk b">exported_service</code>中，我们可以看到一个德鲁伊的服务，在<code class="fe nh ni nj nk b">metric_name</code>中，我们可以看到确切的指标。</p><p id="bf5c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与普罗米修斯一起切克:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/faf32a21337d3477312ccc8fccd0b6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-xADUUb1q9R4em80.png"/></div></div></figure><p id="1ddd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完美！</p><p id="931d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是我想要更多的度量——“<em class="ng">需要更多的度量，大人！</em>”</p><h2 id="2fba" class="mo lm iq bd ln mp mq dn lr mr ms dp lv kj mt mu lz kn mv mw md kr mx my mh mz bi translated">德鲁伊监视器</h2><p id="7be1" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">例如，我想知道每个进程/服务的CPU消耗。</p><p id="cb35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了能够看到所有系统指标(没有Prometheus节点导出器)，包括<code class="fe nh ni nj nk b"><a class="ae kw" href="https://druid.apache.org/docs/latest/operations/metrics.html#sys" rel="noopener ugc nofollow" target="_blank">org.apache.druid.java.util.metrics.SysMonitor</a></code>，对于来自JVM的数据，添加<code class="fe nh ni nj nk b"><a class="ae kw" href="https://druid.apache.org/docs/latest/operations/metrics.html#jvm" rel="noopener ugc nofollow" target="_blank">org.apache.druid.java.util.metrics.JvmMonitor</a></code>。</p><p id="581d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在同一<code class="fe nh ni nj nk b">examples/tiny-cluster.yaml</code>模块<code class="fe nh ni nj nk b">common.runtime.properties</code>中添加以下内容:</p><pre class="nb nc nd ne gt nl nk nm nn aw no bi"><span id="b85c" class="mo lm iq nk b gy np nq l nr ns">...<br/>druid.monitoring.monitors=["org.apache.druid.java.util.metrics.SysMonitor", "org.apache.druid.java.util.metrics.JvmMonitor"]<br/>...</span></pre><p id="8bee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存、更新集群，等待pod重新启动，几分钟后检查指标:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/94a94554a3c9bcd6c216ea52c6e2c269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AqPOWzulzguer42D.png"/></div></div></figure><p id="eca0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">格拉法纳的仪表板:</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/2c7e11866d6527ca6e7c1f69d89726a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*afISpkUc8YBVQE7q.png"/></div></div></figure><p id="e513" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好吧，我们做到了。</p><p id="1bf5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在运行/失败的任务中，我们仍然没有数据，因为我们没有运行任何东西。如果您从已经提到的<a class="ae kw" href="https://www.youtube.com/watch?v=bPtT08_R1bU" rel="noopener ugc nofollow" target="_blank">视频</a>中加载测试数据，那么这些指标将会出现。</p><p id="b37a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实际上还剩下很多:</p><ul class=""><li id="e2b7" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">将PostgreSQL添加为元数据存储</li><li id="1bac" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">配置从中收集的指标</li><li id="6e05" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">没有管理员的测试工作(<code class="fe nh ni nj nk b"><a class="ae kw" href="https://druid.apache.org/docs/latest/development/extensions-core/kubernetes.html" rel="noopener ugc nofollow" target="_blank">druid-kubernetes-extensions</a></code>)</li><li id="1405" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">测试<a class="ae kw" href="https://druid.apache.org/docs/latest/development/extensions-contrib/prometheus.html" rel="noopener ugc nofollow" target="_blank">普罗米修斯发射器</a></li><li id="004d" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">尝试索引器而不是中间管理器</li><li id="5fae" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">配置日志集合(在哪里？还没想出来，但最有可能是Promtail &amp;&amp; Loki)</li><li id="65ef" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">嗯，实际上——为格拉夫纳组装一个普通的仪表板</li></ul><p id="1389" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">已经有了监控，就有可能进行一些负载测试和集群性能调优，但这都在接下来的部分中。</p><h1 id="575c" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">相关链接</h1><ul class=""><li id="7e13" class="kx ky iq ka b kb mj kf mk kj oi kn oj kr ok kv lc ld le lf bi translated"><a class="ae kw" href="https://netflixtechblog.com/how-netflix-uses-druid-for-real-time-insights-to-ensure-a-high-quality-experience-19e1e8568d06" rel="noopener ugc nofollow" target="_blank">网飞如何利用德鲁伊的实时洞察力来确保高质量的体验</a></li><li id="f0c9" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://anskarl.github.io/post/2019/druid-part-1/" rel="noopener ugc nofollow" target="_blank"> Apache Druid(第1部分):一个可伸缩的时间序列OLAP数据库系统</a></li><li id="1b82" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://blog.knoldus.com/data-ingestion-in-druid-overview/#indexing-and-handoff" rel="noopener ugc nofollow" target="_blank">德鲁伊的数据摄取—概述</a></li><li id="1a6c" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://dev.to/rusrushal13/learning-about-the-druid-architecture-184c" rel="noopener ugc nofollow" target="_blank">了解德鲁伊建筑</a></li><li id="3cd6" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://imply.io/druid-architecture-concepts/" rel="noopener ugc nofollow" target="_blank">德鲁伊建筑&amp;概念</a></li><li id="2947" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://www.baeldung.com/apache-druid-event-driven-data" rel="noopener ugc nofollow" target="_blank">使用Apache Druid的事件驱动数据</a></li><li id="ac40" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://medium.com/@aeli/apache-druid-setup-monitoring-and-auto-scaling-on-kubernetes-91739e350fac" rel="noopener"> Apache Druid:在Kubernetes上设置、监控和自动缩放</a></li><li id="02d8" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://www.lohika.com/apache-druid-interactive-analytics-at-scale" rel="noopener ugc nofollow" target="_blank">阿帕奇德鲁伊:大规模互动分析</a></li><li id="8d04" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://apache.googlesource.com/druid/+/refs/heads/0.14.0-incubating/docs/content/configuration/index.md#common-configurations" rel="noopener ugc nofollow" target="_blank">阿帕奇德鲁伊(孵化)配置参考</a></li><li id="7146" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://chenriang.me/running-apache-druid-in-kubernetes.html" rel="noopener ugc nofollow" target="_blank">在Kubernetes中运行Apache德鲁伊</a></li><li id="6e31" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://www.rilldata.com/blog/setting-up-apache-druid-on-kubernetes-part-one" rel="noopener ugc nofollow" target="_blank">在30分钟之内在Kubernetes上建立阿帕奇德鲁伊</a></li><li id="e21a" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://chenriang.me/running-apache-druid-in-kubernetes.html" rel="noopener ugc nofollow" target="_blank">在Kubernetes中运行Apache德鲁伊</a></li></ul></div><div class="ab cl ol om hu on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="ij ik il im in"><p id="e761" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ng">最初发布于</em> <a class="ae kw" href="https://rtfm.co.ua/en/apache-druid-overview-running-in-kubernetes-and-monitoring-with-prometheus/" rel="noopener ugc nofollow" target="_blank"> <em class="ng"> RTFM: Linux，DevOps，和系统管理</em> </a> <em class="ng">。</em></p></div></div>    
</body>
</html>
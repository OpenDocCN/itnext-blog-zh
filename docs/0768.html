<html>
<head>
<title>Using logstash with Kafka</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对卡夫卡使用logstash</h1>
<blockquote>原文：<a href="https://itnext.io/using-logstash-with-kafka-c1e2f32af2eb?source=collection_archive---------1-----------------------#2018-05-24">https://itnext.io/using-logstash-with-kafka-c1e2f32af2eb?source=collection_archive---------1-----------------------#2018-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6760d8a296aa060820762afe56cf4111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CY4TKP9EmgnizKleByqiEg.png"/></div></div></figure><p id="3a3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我通常使用kafka connect向kafka发送/获取数据。</p><p id="3869" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是我最近为Logstash找到了两个新的输入插件和输出插件，用来连接logstash和kafka。和许多过滤插件一样，它也很有用。</p><p id="3f56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以这意味着，对于某些事情，你需要更多的模块化或更多的过滤，你可以使用logstash而不是kafka-connect。</p><p id="b361" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果您有一个编写syslog文件应用程序，您希望解析它并以json格式发送。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="f187" class="lf lg iq lb b gy lh li l lj lk">input { stdin { } }<br/><br/>filter {<br/>  grok {<br/>    match =&gt; { "message" =&gt; "%{COMBINEDAPACHELOG}" }<br/>  }<br/>  date {<br/>    match =&gt; [ "timestamp" , "dd/MMM/yyyy:HH:mm:ss Z" ]<br/>  }<br/>}<br/><br/>output {<br/>  <!-- -->kafka { <br/>    bootstrap_servers =&gt; "kafka"<br/>    codec =&gt; json{}<br/>    topic_id =&gt;  "my-topic"<br/>  }<br/>}</span></pre><p id="926e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个例子中:我使用stdin(这更容易测试)，但是你可以使用一个文件或者logstash的插件允许你使用的任何东西。</p><p id="f678" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果在输入中我有:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="b8ef" class="lf lg iq lb b gy lh li l lj lk">127.0.0.1 - - [11/Dec/2013:00:01:45 -0800] "GET /xampp/status.php HTTP/1.1" 200 3891 "http://cadenza/xampp/navi.php" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:25.0) Gecko/20100101 Firefox/25.0"</span></pre><p id="6fe4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">kafka中的输出将是json中的对象:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="e9c0" class="lf lg iq lb b gy lh li l lj lk">{<br/>        "message" : "127.0.0.1 - - [11/Dec/2013:00:01:45 -0800] \"GET /xampp/status.php HTTP/1.1\" 200 3891 \"http://cadenza/xampp/navi.php\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:25.0) Gecko/20100101 Firefox/25.0\"",<br/>     "@timestamp" : "2013-12-11T08:01:45.000Z",<br/>       "@version" : "1",<br/>           "host" : "cadenza",<br/>       "clientip" : "127.0.0.1",<br/>          "ident" : "-",<br/>           "auth" : "-",<br/>      "timestamp" : "11/Dec/2013:00:01:45 -0800",<br/>           "verb" : "GET",<br/>        "request" : "/xampp/status.php",<br/>    "httpversion" : "1.1",<br/>       "response" : "200",<br/>          "bytes" : "3891",<br/>       "referrer" : "\"http://cadenza/xampp/navi.php\"",<br/>          "agent" : "\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:25.0) Gecko/20100101 Firefox/25.0\""<br/>}</span></pre><h2 id="e729" class="lf lg iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">链接:</h2><div class="mc md gp gr me mf"><a href="https://www.elastic.co/guide/en/logstash/current/plugins-inputs-kafka.html" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">Kafka输入插件| Logstash参考[6.2] |弹性</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">默认情况下，Logstash实例形成一个逻辑组来订阅Kafka主题，每个Logstash Kafka消费者都可以…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">www.elastic.co</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jw mf"/></div></div></a></div><div class="mc md gp gr me mf"><a href="https://www.elastic.co/guide/en/logstash/current/plugins-outputs-kafka.html" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">Kafka输出插件| Logstash参考[6.2] |弹性</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">Logstash Reference [6.2]“输出插件”Kafka输出插件</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">www.elastic.co</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt jw mf"/></div></div></a></div><div class="mc md gp gr me mf"><a href="https://www.elastic.co/guide/en/logstash/current/config-examples.html" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">Logstash配置示例| Logstash参考[6.2] |弹性</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">以下示例说明了如何配置Logstash来过滤事件、处理Apache日志和syslog…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">www.elastic.co</p></div></div><div class="mo l"><div class="mv l mq mr ms mo mt jw mf"/></div></div></a></div></div></div>    
</body>
</html>
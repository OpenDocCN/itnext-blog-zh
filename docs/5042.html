<html>
<head>
<title>Deploying Jakarta EE 9 applications to Glassfish v6 using Cargo maven plugin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cargo maven插件将Jakarta EE 9应用程序部署到Glassfish v6</h1>
<blockquote>原文：<a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-glassfish-v6-using-cargo-maven-plugin-9edce431cadd?source=collection_archive---------3-----------------------#2020-11-23">https://itnext.io/deploying-jakarta-ee-9-applications-to-glassfish-v6-using-cargo-maven-plugin-9edce431cadd?source=collection_archive---------3-----------------------#2020-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4c97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从雅加达EE邮件订阅来看，我认为雅加达EE 9已经为公众准备好了，官方声明将在几天内发布。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/bbe525b66addc9069a161aebd3e74370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZgar-TMaqJ9r-ovXsLz_A.png"/></div></div></figure><p id="feba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在之前的<a class="ae kx" href="https://github.com/hantsy/jakartaee8-starter" rel="noopener ugc nofollow" target="_blank"> Jakarta EE 8 starter样板文件</a>中，我已经描述了<a class="ae kx" href="https://github.com/hantsy/jakartaee8-starter/blob/master/docs/03run-glassfish-mvn.md" rel="noopener ugc nofollow" target="_blank">如何在Glassfish v5 </a>上部署Jakarta EE 8应用程序，在这篇文章中，我将更新它并尝试将Jakarta EE 9示例应用程序部署到Glassfish v6应用服务器上。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="81d6" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">先决条件</h1><p id="b6ba" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">确保您已经安装了以下软件。</p><ul class=""><li id="dae0" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">Java 8，没错，Glassfish v6还是只支持Java 8，下一个6.1会重点支持Java 11。建议使用Oracle JDK 8或AdoptOpenJDK 8。</li><li id="57b0" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">下载并安装<a class="ae kx" href="https://github.com/eclipse-ee4j/glassfish/releases" rel="noopener ugc nofollow" target="_blank"> Glassfish v6 </a>，当您通过<strong class="jp ir">现有</strong>和远程<strong class="jp ir">运行时</strong>配置部署应用程序时，这是必需的。</li><li id="86d0" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">下载并安装<a class="ae kx" href="http://maven.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Maven </a>。</li><li id="3960" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">了解<a class="ae kx" href="https://codehaus-cargo.github.io/" rel="noopener ugc nofollow" target="_blank"> Cargo maven插件</a>的基础。</li></ul><blockquote class="mw mx my"><p id="b7cf" class="jn jo mz jp b jq jr js jt ju jv jw jx na jz ka kb nb kd ke kf nc kh ki kj kk ij bi translated"><em class="iq">在本文中，我们仍然使用货物</em> <code class="fe nd ne nf ng b"><em class="iq">glassfish5x</em></code> <em class="iq">集装箱来执行部署。在Glassfish v6的1.8.3版本中，Cargo将包含一个新的</em> <code class="fe nd ne nf ng b"><em class="iq">glassfish6x</em></code> <em class="iq">容器。</em></p></blockquote></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="b1d7" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">部署应用程序</h1><p id="acb0" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">将<a class="ae kx" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank"> Jakarta EE9 starter样板文件</a>库克隆到您的本地磁盘中。</p><p id="5c60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开一个终端并切换到项目根文件夹，执行以下命令来构建Jakarta EE 9应用程序并将其部署到Glassfish v6。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="346a" class="nl lg iq ng b gy nm nn l no np">mvn clean verify org.codehaus.cargo:cargo-maven2-plugin:1.8.2:run <br/>-Dcargo.maven.containerId=glassfish5x   <br/>-Dcargo.maven.containerUrl=https://download.eclipse.org/ee4j/glassfish/glassfish-6.0.0-RC2.zip  <br/>-Dcargo.servlet.port=8080</span></pre><p id="8c7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该命令将使用Maven构建项目，然后调用cargo maven插件从指定的URL下载Glassfish v6的副本，然后尝试为应用程序部署准备新的域配置，然后启动新创建的域，最后部署可部署文件(<code class="fe nd ne nf ng b">target\jakartaee9-starter-boilerplate.war</code>)。</p><p id="0945" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当部署成功时，您将看到类似如下的信息。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="44f3" class="nl lg iq ng b gy nm nn l no np">[INFO] --- cargo-maven2-plugin:1.8.2:run (default-cli) @ jakartaee9-starter-boilerplate ---<br/>[INFO] [en2.ContainerRunMojo] Resolved container artifact org.codehaus.cargo:cargo-core-container-glassfish:jar:1.8.2 for container glassfish5x<br/>[INFO] [talledLocalContainer] Parsed GlassFish version = [6.0.0.RC2]<br/>[INFO] [talledLocalContainer] GlassFish 6.0.0.RC2 starting...<br/>[INFO] [talledLocalContainer] Using port 4848 for Admin.<br/>[INFO] [talledLocalContainer] Using port 8080 for HTTP Instance.<br/>[INFO] [talledLocalContainer] Using port 7676 for JMS.<br/>[INFO] [talledLocalContainer] Using port 3700 for IIOP.<br/>[INFO] [talledLocalContainer] Using port 8181 for HTTP_SSL.<br/>[INFO] [talledLocalContainer] Using port 3820 for IIOP_SSL.<br/>[INFO] [talledLocalContainer] Using port 3920 for IIOP_MUTUALAUTH.<br/>[INFO] [talledLocalContainer] Using port 8686 for JMX_ADMIN.<br/>[INFO] [talledLocalContainer] Using port 6666 for OSGI_SHELL.<br/>[INFO] [talledLocalContainer] Using port 9009 for JAVA_DEBUGGER.<br/>[INFO] [talledLocalContainer] Distinguished Name of the self-signed X.509 Server Certificate is:<br/>[INFO] [talledLocalContainer] [CN=hantsy-t540p,OU=GlassFish,O=Eclipse.org Foundation Inc,L=Ottawa,ST=Ontario,C=CA]<br/>[INFO] [talledLocalContainer] Distinguished Name of the self-signed X.509 Server Certificate is:<br/>[INFO] [talledLocalContainer] [CN=hantsy-t540p-instance,OU=GlassFish,O=Eclipse.org Foundation Inc,L=Ottawa,ST=Ontario,C=CA]<br/>[INFO] [talledLocalContainer] Domain cargo-domain created.<br/>[INFO] [talledLocalContainer] Domain cargo-domain admin port is 4848.<br/>[INFO] [talledLocalContainer] Domain cargo-domain admin user is "admin".<br/>[INFO] [talledLocalContainer] Command create-domain executed successfully.<br/>[INFO] [talledLocalContainer] Attempting to start cargo-domain.... Please look at the server log for more details.....<br/>[INFO] [talledLocalContainer] remote failure: The jdbc resource [ jdbc/__default ] cannot be deleted as it is required to be configured in the system.<br/>[INFO] [talledLocalContainer] Command delete-jdbc-resource failed.<br/>[INFO] [talledLocalContainer] JDBC Connection pool DerbyPool deleted successfully<br/>[INFO] [talledLocalContainer] Command delete-jdbc-connection-pool executed successfully.<br/>[INFO] [talledLocalContainer] Application deployed with name jakartaee9-starter-boilerplate.<br/>[INFO] [talledLocalContainer] Command deploy executed successfully.<br/>[INFO] [talledLocalContainer] Application deployed with name cargocpc.<br/>[INFO] [talledLocalContainer] Command deploy executed successfully.<br/>[INFO] [talledLocalContainer] GlassFish 6.0.0.RC2 started on port [8080]<br/>[INFO] Press Ctrl-C to stop the container...</span></pre><p id="9d39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述命令相当于项目<em class="mz"> pom.xml </em>文件中的以下配置。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="55a9" class="nl lg iq ng b gy nm nn l no np">&lt;properties&gt;<br/>	&lt;cargo.servlet.port&gt;8080&lt;/cargo.servlet.port&gt;<br/>	&lt;cargo.zipUrlInstaller.downloadDir&gt;${project.build.directory}/../installs<br/>	&lt;/cargo.zipUrlInstaller.downloadDir&gt;<br/>&lt;/properties&gt;</span><span id="46f5" class="nl lg iq ng b gy nq nn l no np">&lt;build&gt;<br/>	&lt;plugins&gt;<br/>		&lt;plugin&gt;<br/>			&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>			&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>			&lt;configuration&gt;<br/>				&lt;container&gt;<br/>					&lt;containerId&gt;glassfish5x&lt;/containerId&gt;<br/>					&lt;zipUrlInstaller&gt;<br/>						&lt;url&gt;https://download.eclipse.org/ee4j/glassfish/glassfish-6.0.0-RC2.zip&lt;/url&gt;<br/>						&lt;downloadDir&gt;${cargo.zipUrlInstaller.downloadDir}&lt;/downloadDir&gt;<br/>					&lt;/zipUrlInstaller&gt;<br/>				&lt;/container&gt;<br/>				&lt;configuration&gt;<br/>					&lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt;<br/>					&lt;properties&gt;<br/>						&lt;cargo.servlet.port&gt;${cargo.servlet.port}&lt;/cargo.servlet.port&gt;<br/>					&lt;/properties&gt;<br/>				&lt;/configuration&gt;<br/>			&lt;/configuration&gt;<br/>		&lt;/plugin&gt;<br/>	&lt;/plugins&gt;<br/>&lt;/build&gt;</span></pre><p id="37cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用上述配置运行以下命令。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="9c48" class="nl lg iq ng b gy nm nn l no np">mvn clean verify cargo:run</span></pre><p id="0c93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们使用<code class="fe nd ne nf ng b">run</code>目标，它将保持应用服务器运行，直到我们发送一个<code class="fe nd ne nf ng b">CTRL+C</code>命令来停止它。</p><p id="df21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您已经准备了Glassfish v6的副本，您可以重用现有的<strong class="jp ir">Glassfish和域配置。</strong></p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="55af" class="nl lg iq ng b gy nm nn l no np">&lt;properties&gt;<br/>	&lt;glassfish.home&gt;[ The existing glassfish6 dir]&lt;/glassfish.home&gt;<br/>	&lt;glassfish.domainDir&gt;${glassfish.home}/glassfish/domains&lt;/glassfish.domainDir&gt;<br/>	&lt;glassfish.domainName&gt;domain1&lt;/glassfish.domainName&gt;<br/>&lt;/properties&gt;<br/>&lt;build&gt;<br/>	&lt;plugins&gt;<br/>		&lt;plugin&gt;<br/>			&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>			&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>			&lt;configuration&gt;<br/>				&lt;container&gt;<br/>					&lt;containerId&gt;glassfish5x&lt;/containerId&gt;<br/>					&lt;type&gt;installed&lt;/type&gt;<br/>					&lt;home&gt;${glassfish.home}&lt;/home&gt;<br/>				&lt;/container&gt;<br/>				&lt;configuration&gt;<br/>					&lt;type&gt;existing&lt;/type&gt;<br/>					&lt;home&gt;${glassfish.domainDir}&lt;/home&gt;<br/>					&lt;properties&gt;<br/>						&lt;cargo.glassfish.domain.name&gt;${glassfish.domainName}&lt;/cargo.glassfish.domain.name&gt;<br/>						&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br/>					&lt;/properties&gt;<br/>				&lt;/configuration&gt;<br/>			&lt;/configuration&gt;<br/>		&lt;/plugin&gt;<br/>	&lt;/plugins&gt;<br/>&lt;/build&gt;</span></pre><p id="168f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中，将配置类型设置为<strong class="jp ir">现有的</strong>，并将域名指定为默认的<code class="fe nd ne nf ng b">domain1</code>，当运行下面的命令时，它将重用现有的<code class="fe nd ne nf ng b">domain1</code>来部署应用程序。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="a0c5" class="nl lg iq ng b gy nm nn l no np">mvn clean verify cargo:run</span></pre><p id="43d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想将应用程序部署到正在运行的Glassfish v6服务器(esp。它运行在不同的机器上)，尝试配置一个<strong class="jp ir">运行时</strong>配置，并使用一个<strong class="jp ir">远程</strong>部署器来执行部署。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="f1cf" class="nl lg iq ng b gy nm nn l no np">&lt;plugin&gt;<br/>	&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br/>	&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br/>	&lt;configuration&gt;<br/>		&lt;container&gt;<br/>			&lt;containerId&gt;glassfish5x&lt;/containerId&gt;<br/>			&lt;type&gt;remote&lt;/type&gt;<br/>		&lt;/container&gt;<br/>		&lt;configuration&gt;<br/>			&lt;type&gt;runtime&lt;/type&gt;<br/>			&lt;properties&gt;<br/>				&lt;cargo.remote.username&gt;admin&lt;/cargo.remote.username&gt;<br/>				&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br/>				&lt;cargo.glassfish.admin.port&gt;4848&lt;/cargo.glassfish.admin.port&gt;<br/>				&lt;cargo.hostname&gt;localhost&lt;/cargo.hostname&gt;<br/>			&lt;/properties&gt;<br/>		&lt;/configuration&gt;<br/>	&lt;/configuration&gt;<br/>	&lt;!-- provides JSR88 client API to deploy on Glassfish/Payara Server --&gt;<br/>	&lt;!-- WARNING: deployment client is not available in Glassfish v6.0 --&gt;<br/>	&lt;dependencies&gt;<br/>		&lt;dependency&gt;<br/>			&lt;groupId&gt;org.glassfish.main.deployment&lt;/groupId&gt;<br/>			&lt;artifactId&gt;deployment-client&lt;/artifactId&gt;<br/>			&lt;version&gt;5.1.0&lt;/version&gt;<br/>			&lt;!--&lt;version&gt;${glassfish.version}&lt;/version&gt;--&gt;<br/>		&lt;/dependency&gt;<br/>	&lt;/dependencies&gt;<br/>&lt;/plugin&gt;</span></pre><p id="a009" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上述配置中:</p><ul class=""><li id="d47a" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated"><code class="fe nd ne nf ng b">cargo.hostname</code>是您要部署到的目标服务器</li><li id="0f8a" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated"><code class="fe nd ne nf ng b">cargo.remote.username</code>和<code class="fe nd ne nf ng b">cargo.remote.password</code>是用于部署的管理员账户</li><li id="eb82" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">远程部署者依赖于一个<code class="fe nd ne nf ng b">deployment-client</code>原型，这里我们使用版本<code class="fe nd ne nf ng b">5.1.0</code>，Glassfish v6没有新版本，Jakarta EE 9中删除了JSR 88规范。</li></ul><p id="1361" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于远程容器，您不能像以前的配置那样控制生命周期的开始和停止，而是使用<code class="fe nd ne nf ng b">deploy</code>和<code class="fe nd ne nf ng b">undeploy</code>目标来执行部署和取消部署任务。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="7ace" class="nl lg iq ng b gy nm nn l no np"># deploy applications<br/>mvn clean verify cargo:deploy</span><span id="1bea" class="nl lg iq ng b gy nq nn l no np"># undeploy<br/>mvn cargo:undeploy</span></pre><p id="4aa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当应用程序部署成功时，使用<code class="fe nd ne nf ng b">curl</code>验证部署的应用程序是否正在运行。</p><pre class="km kn ko kp gt nh ng ni nj aw nk bi"><span id="302b" class="nl lg iq ng b gy nm nn l no np">curl <a class="ae kx" href="http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy</a><br/>{"message":"Say Hello to Hantsy at 2020-11-14T15:56:10.099"}</span></pre><p id="d098" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经在<em class="mz"> pom.xml </em>中添加了上述不同Maven配置文件的配置。查看<a class="ae kx" href="https://github.com/hantsy/jakartaee9-starter-boilerplate/" rel="noopener ugc nofollow" target="_blank">源代码</a>并探索自己。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Android Receiving Data from another app in 2 steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android分两步从另一个应用程序接收数据</h1>
<blockquote>原文：<a href="https://itnext.io/android-receiving-data-in-2-steps-21c49920172d?source=collection_archive---------0-----------------------#2020-05-10">https://itnext.io/android-receiving-data-in-2-steps-21c49920172d?source=collection_archive---------0-----------------------#2020-05-10</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/f645f8a7a4aa4d22802605005db3dbf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGm8tMvAkCcxZNExKOOpng.png"/></div></div><figcaption class="kc kd gk gi gj ke kf bd b be z dk translated">共享流程图</figcaption></figure><p id="8ca7" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">n droid应用程序可以轻松地在应用程序之间共享数据。它们包括<strong class="ki iv">文本</strong>、<strong class="ki iv">图像</strong>、<strong class="ki iv">视频</strong>和<strong class="ki iv">音频</strong>文件等。例如，你可以将谷歌照片应用程序中的图片分享到脸书应用程序或Instagram应用程序，以创建帖子或故事。如今，这是安卓社交应用的一个常见功能。</span></p><figure class="lo lp lq lr gu jv gi gj paragraph-image"><div class="gi gj ln"><img src="../Images/a1b9235092e4140dde27cf56db1ea4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*mAwqCdZ3bkNZzQBEivi-ug.png"/></div><figcaption class="kc kd gk gi gj ke kf bd b be z dk translated">不同社交应用之间的分享</figcaption></figure><p id="2d59" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">要从另一个应用程序接收数据，需要在AndroidManifest.xml上正确配置您的<code class="fe ls lt lu lv b">Activity</code>，并处理包含系统发送的<code class="fe ls lt lu lv b">action</code>和<code class="fe ls lt lu lv b">data</code>的<code class="fe ls lt lu lv b">Intent</code>。</p><p id="400b" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">实现这个共享功能只需要2个步骤，花费大约10分钟。我相信你会发现这很有趣而且有用！开始吧！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="cb07" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">循序渐进的程序</h1><h2 id="9d5a" class="nb me iu bd mf nc nd dn mj ne nf dp mn kr ng nh mr kv ni nj mv kz nk nl mz nm bi translated">步骤1)在AndroidManifest中添加<intent-filter/></h2><figure class="lo lp lq lr gu jv"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="c236" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">我们必须向处理AndroidManifest.xml中的传入数据的<code class="fe ls lt lu lv b">Activity</code>添加4个标记。</p><ol class=""><li id="b4a5" class="np nq iu ki b kj kk kn ko kr nr kv ns kz nt ld nu nv nw nx bi translated"><strong class="ki iv">&lt;intent-filter&gt;</strong><code class="fe ls lt lu lv b"><br/></code>声明此<code class="fe ls lt lu lv b">Activity</code>适用于分别在<code class="fe ls lt lu lv b">&lt;action&gt;</code>和<code class="fe ls lt lu lv b">&lt;data&gt;</code>标签定义了<code class="fe ls lt lu lv b">action</code>和<code class="fe ls lt lu lv b">data</code>的处理系统<code class="fe ls lt lu lv b">Intent</code>。</li><li id="75ce" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="ki iv"> &lt;动作&gt; <br/> </strong>定义了这个<code class="fe ls lt lu lv b">Activity</code>可以处理的<code class="fe ls lt lu lv b">IntentAction</code>，即<code class="fe ls lt lu lv b">android.intent.action.SEND</code>接收一个<strong class="ki iv">单个数据</strong>，<code class="fe ls lt lu lv b">android.intent.action.SEND_MULTIPLE</code>接收<strong class="ki iv">一个数据列表</strong>。系统使用动作字段过滤出可用于处理所请求的<code class="fe ls lt lu lv b">Intent</code>的应用。</li><li id="268f" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="ki iv"> &lt;类别&gt; <br/> </strong> <code class="fe ls lt lu lv b"><a class="ae od" href="https://developer.android.com/guide/topics/manifest/category-element" rel="noopener ugc nofollow" target="_blank">android.intent.category.DEFAULT</a></code>必须在<code class="fe ls lt lu lv b">&lt;category&gt;</code>处定义，否则<code class="fe ls lt lu lv b">Activity</code>不能接收任何隐式<code class="fe ls lt lu lv b">Intent</code>，因此不能显示在共享底层表单对话框中！</li><li id="1de5" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="ki iv"> &lt;数据&gt; <br/> </strong>声明该<code class="fe ls lt lu lv b">Activity</code>可以处理的<a class="ae od" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types" rel="noopener ugc nofollow" target="_blank"> MIME(多用途互联网邮件扩展)</a>的类型。有<a class="ae od" href="https://developer.android.com/training/sharing/receive#supporting-mime-types" rel="noopener ugc nofollow" target="_blank">几种常见的类型</a> : <br/> 1。<code class="fe ls lt lu lv b">text/*</code>其中包括<code class="fe ls lt lu lv b">text/plain</code>、<code class="fe ls lt lu lv b">text/rtf</code>、<code class="fe ls lt lu lv b">text/html</code>、<code class="fe ls lt lu lv b">text/json<br/></code> 2个。<code class="fe ls lt lu lv b">image/*</code>其中包括<code class="fe ls lt lu lv b">image/jpg</code>、<code class="fe ls lt lu lv b">image/png</code>、<code class="fe ls lt lu lv b">image/gif<br/></code>三种。<code class="fe ls lt lu lv b">video/*</code>其中包括<code class="fe ls lt lu lv b">video/mp4</code>、<code class="fe ls lt lu lv b">video/3gp<br/></code> 4个。<code class="fe ls lt lu lv b">audio/*</code>其中包括<code class="fe ls lt lu lv b">audio/wav<br/></code> 5。<code class="fe ls lt lu lv b">application/pdf</code>其中包括pdf文件</li></ol><figure class="lo lp lq lr gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oe"><img src="../Images/02470966c1d8ab272a2a3fa263bb7300.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PrZw7i439LneEFOVkNTU1g.png"/></div></div></figure><p id="24be" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">此时，您应该能够看到您的应用程序图标出现在共享对话框中。粗体标题是应用程序名称，常规副标题是在AndroidManifest.xml中声明的<code class="fe ls lt lu lv b">Activity</code>名称。见下文:</p><figure class="lo lp lq lr gu jv"><div class="bz fq l di"><div class="nn no l"/></div></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="58eb" class="nb me iu bd mf nc nd dn mj ne nf dp mn kr ng nh mr kv ni nj mv kz nk nl mz nm bi translated">步骤2)在活动中处理数据</h2><figure class="lo lp lq lr gu jv"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="7ed5" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">用户点击共享底部表单对话框中的您的应用图标后，您指定的<code class="fe ls lt lu lv b">Activity</code>将被启动并创建。发送的数据(如文本、图像、视频和音频URI等)可以在<code class="fe ls lt lu lv b">onCreate()</code>回调时从传入的<code class="fe ls lt lu lv b">Intent</code>中用不同的<code class="fe ls lt lu lv b">key</code>值检索。</p><p id="ce45" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">在所有启动之前，有必要(第7-8行)确认意图来自<code class="fe ls lt lu lv b">ACTION_SEND</code>或<code class="fe ls lt lu lv b">ACTION_SEND_MULTIPLE</code>而不是其他<code class="fe ls lt lu lv b">Intent</code>，如<code class="fe ls lt lu lv b">startActivity(intent: Intent)</code>功能中使用的隐式<code class="fe ls lt lu lv b">Intent</code>。</p><p id="3126" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">还应该检查数据mime类型，以确保稍后使用正确的<code class="fe ls lt lu lv b">key</code>和<code class="fe ls lt lu lv b">function</code>来检索发送的数据。</p><figure class="lo lp lq lr gu jv gi gj paragraph-image"><div class="gi gj of"><img src="../Images/c1c34e4292e91067b1d66a51cdb09f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*-AO3vY7vuYDBMU1f.gif"/></div></figure><p id="7e8b" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">在14–15，可以从键<code class="fe ls lt lu lv b">Intent.EXTRA_TEXT</code>检索发送的文本。</p><figure class="lo lp lq lr gu jv"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="lo lp lq lr gu jv gi gj paragraph-image"><div class="gi gj of"><img src="../Images/c270413b00c5cbca16a93dd6e56379c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*7Wz73EFr1QJ5N9M5rwm8EA.gif"/></div></figure><p id="7743" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">在20–21，可以从键<code class="fe ls lt lu lv b">Intent.EXTRA_STREAM</code>中检索发送的图像<code class="fe ls lt lu lv b">URI</code>。</p><figure class="lo lp lq lr gu jv"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="lo lp lq lr gu jv gi gj paragraph-image"><div class="gi gj of"><img src="../Images/ec91b9bc293b0199b546da051de7f27e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*mQ5rtG7UHvXVIZw4.gif"/></div></figure><p id="515f" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">在20–21，发送的多幅图像的<code class="fe ls lt lu lv b">URI</code>可从键<code class="fe ls lt lu lv b">Intent.EXTRA_STREAM</code>中检索，但使用另一个函数<code class="fe ls lt lu lv b">getParcelableArrayListExtra(key: String)</code>。</p><figure class="lo lp lq lr gu jv"><div class="bz fq l di"><div class="nn no l"/></div></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="7b02" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">摘要</h1><ol class=""><li id="fadd" class="np nq iu ki b kj og kn oh kr oi kv oj kz ok ld nu nv nw nx bi translated"><code class="fe ls lt lu lv b">Activity</code>必须用<code class="fe ls lt lu lv b">&lt;intent-filter&gt;</code>声明，告诉系统这个<code class="fe ls lt lu lv b">Activity</code>可以处理在<code class="fe ls lt lu lv b">&lt;action&gt;</code>和<code class="fe ls lt lu lv b">&lt;data&gt;</code>标签声明的特定<code class="fe ls lt lu lv b">action</code>和<code class="fe ls lt lu lv b">data</code>的某个系统<code class="fe ls lt lu lv b">Intent</code>。</li><li id="e394" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><code class="fe ls lt lu lv b">android.intent.action.SEND</code>或<code class="fe ls lt lu lv b">android.intent.action.SEND_MULTIPLE</code>应在<code class="fe ls lt lu lv b">&lt;action&gt;</code>标签处声明，以从另一个应用程序接收数据。</li><li id="09e4" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><code class="fe ls lt lu lv b"><a class="ae od" href="https://developer.android.com/guide/topics/manifest/category-element" rel="noopener ugc nofollow" target="_blank">android.intent.category.DEFAULT</a></code>必须在<code class="fe ls lt lu lv b">&lt;category&gt;</code>标签中定义，以便在共享底部表单对话框中显示应用程序。</li><li id="db62" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated">MIME类型在<code class="fe ls lt lu lv b">&lt;data&gt;</code>标签中声明，告诉系统这个<code class="fe ls lt lu lv b">Activity</code>可以处理哪种数据。例如<code class="fe ls lt lu lv b">text/*</code>、<code class="fe ls lt lu lv b">image/*</code>、<code class="fe ls lt lu lv b">audio/*</code>、<code class="fe ls lt lu lv b">video/*</code>和<code class="fe ls lt lu lv b">application/pdf</code>。</li><li id="b948" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated">应用程序图标显示有应用程序标签和在AndroidManifest.xml中定义的<code class="fe ls lt lu lv b">Activity</code>标签。</li><li id="12af" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated">必须在指定的<code class="fe ls lt lu lv b">Activity</code>的<code class="fe ls lt lu lv b">onCreate()</code>回调时检查<code class="fe ls lt lu lv b">IntentAction</code>和数据类型。<code class="fe ls lt lu lv b">Intent.EXTRA_TEXT</code>用于检索发送的文本，<code class="fe ls lt lu lv b">Intent.EXTRA_STREAM</code>用于检索发送的图像。</li></ol></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="e7a9" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">参考资料和进一步阅读:</h1><ol class=""><li id="97d3" class="np nq iu ki b kj og kn oh kr oi kv oj kz ok ld nu nv nw nx bi translated">什么是IntentFilter？</li><li id="3242" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><a class="ae od" href="https://developer.android.com/reference/android/content/Intent#CATEGORY_DEFAULT" rel="noopener ugc nofollow" target="_blank">Android . intent . category . default的定义</a></li><li id="0247" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><a class="ae od" href="https://developer.android.com/reference/android/content/Intent#ACTION_SEND" rel="noopener ugc nofollow" target="_blank">意向处理措施_发送</a></li><li id="03c1" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><a class="ae od" href="https://developer.android.com/reference/android/content/Intent#ACTION_SEND_MULTIPLE" rel="noopener ugc nofollow" target="_blank">意向行动_发送_多重</a></li><li id="6b15" class="np nq iu ki b kj ny kn nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><a class="ae od" href="https://developer.android.com/guide/topics/manifest/category-element" rel="noopener ugc nofollow" target="_blank"> &lt;类别&gt;标签中&lt;意图-过滤器&gt; </a></li></ol></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="2d2c" class="md me iu bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">你可能会喜欢我的另一篇相关文章:</h1><div class="ol om gq gs on oo"><a rel="noopener  ugc nofollow" target="_blank" href="/android-dial-phone-programmatically-5ea3714d801d"><div class="op ab fp"><div class="oq ab or cl cj os"><h2 class="bd iv gz z fq ot fs ft ou fv fx it bi translated">Android电话拨号程序</h2><div class="ov l"><h3 class="bd b gz z fq ot fs ft ou fv fx dk translated">你想象过你的应用程序可以直接为你打电话吗？是的，Android手机可以很容易地帮你做到这一点…</h3></div><div class="ow l"><p class="bd b dl z fq ot fs ft ou fv fx dk translated">itnext.io</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ka oo"/></div></div></a></div></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="b168" class="pw-post-body-paragraph kg kh iu ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld in bi translated">欢迎您关注我的<a class="ae od" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ my rik _ chow</a>了解更多信息。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
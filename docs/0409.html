<html>
<head>
<title>A memo on how to implement Azure AD authentication using React and .NET Core</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于如何使用React和实现Azure AD身份验证的备忘录。网络核心</h1>
<blockquote>原文：<a href="https://itnext.io/a-memo-on-how-to-implement-azure-ad-authentication-using-react-and-net-core-2-0-3fe9bfdf9f36?source=collection_archive---------1-----------------------#2018-03-06">https://itnext.io/a-memo-on-how-to-implement-azure-ad-authentication-using-react-and-net-core-2-0-3fe9bfdf9f36?source=collection_archive---------1-----------------------#2018-03-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/60e303f5e5614981982a78b5327021bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*zBRB2ndXYp9xTlCNsT7pag.png"/></div></figure><p id="7f98" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fa-memo-on-how-to-implement-azure-ad-authentication-using-react-and-net-core-2–0–3fe9bfdf9f36" rel="noopener ugc nofollow" target="_blank"> <em class="kt">点击这里在LinkedIn上分享这篇文章</em> </a></p><p id="676c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我发现了许多使用React和. NET Core 2.x后端实现Azure AD认证的方法。在本文中，我将演示如何实现这种类型的身份验证。</p><h1 id="99e4" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">注册您的应用程序</h1><p id="6af1" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">第一步是注册你的Azure广告。一旦你做到了这一点，你就可以使用Azure生成的密钥在你的应用中实现身份验证。</p><p id="9583" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，我们将配置前端以获取Azure AD访问令牌，然后在后端使用该令牌。<br/>如果你想查看详细的代码，请查看下面的库:<a class="ae ks" href="https://github.com/Odonno/azuread-react-dotnet-core-example" rel="noopener ugc nofollow" target="_blank">https://github.com/Odonno/azuread-react-dotnet-core-example</a></p><div class="lx ly gp gr lz ma"><a href="https://github.com/Odonno/azuread-react-dotnet-core-example" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab fo"><div class="mc ab md cl cj me"><h2 class="bd ir gy z fp mf fr fs mg fu fw ip bi translated">odono/azuread-react-dot net-core-example</h2><div class="mh l"><h3 class="bd b gy z fp mf fr fs mg fu fw dk translated">关于如何使用React和实现Azure AD身份验证的备忘录。NET Core-odon no/azuread-react-dot NET-Core-example</h3></div><div class="mi l"><p class="bd b dl z fp mf fr fs mg fu fw dk translated">github.com</p></div></div></div></a></div><h1 id="e44d" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">前端</h1><p id="6e7e" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">前端有很多实现，使用最多的当然是<code class="fe mj mk ml mm b">angular-adal</code>库，在我们的例子中并不是最好的选择。我们可以使用简单的<code class="fe mj mk ml mm b">adal.js</code>，但是为什么每次都要重新发明轮子呢？</p><p id="389f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">幸运的是，我在GitHub 上找到了一个名为<code class="fe mj mk ml mm b">react-adal</code>的<a class="ae ks" href="https://github.com/salvoravida/react-adal" rel="noopener ugc nofollow" target="_blank">库，它似乎做得相当不错。所以，我们先从它开始，看看有多简单。</a></p><pre class="mn mo mp mq gt mr mm ms mt aw mu bi"><span id="2713" class="mv kv iq mm b gy mw mx l my mz">npm install react-adal</span></pre><p id="943e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦你到了那里，你需要写两件事:</p><ul class=""><li id="103a" class="na nb iq jw b jx jy kb kc kf nc kj nd kn ne kr nf ng nh ni bi translated">一个包含您在上一步中从Azure获得的密钥的配置文件</li><li id="aed3" class="na nb iq jw b jx nj kb nk kf nl kj nm kn nn kr nf ng nh ni bi translated">调用身份验证方法</li></ul><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="04e5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成配置文件后，在<code class="fe mj mk ml mm b">index.jsx</code>文件中执行该功能:</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="6e1b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你已经准备好了。现在，每次用户进入这个功能，将显示一个新的页面，以便他可以设置他的凭证和连接。作为奖励，我给你一个<code class="fe mj mk ml mm b">getToken()</code>方法，让你轻松获得我们需要的认证令牌，以确保用户能够访问我们的后端。</p><p id="3dfe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请记住，使用Azure AD身份验证令牌按原样设置您的头，以进行HTTP调用。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="4cc7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">需要注意的一点是，从回调url生成的第一个令牌有1小时的生存期。因此，当该令牌接近到期时，库将检索刷新令牌。默认情况下，<code class="fe mj mk ml mm b">react-adal</code>库将在当前令牌到期日期前至少5分钟尝试刷新令牌。</p><h1 id="6383" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">后端</h1><p id="1259" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">现在，每次用户向您的后端发送请求时，您都需要确保令牌是有效的。这个令牌也将帮助您检测谁是用户。</p><h2 id="bfe0" class="mv kv iq bd kw nq nr dn la ns nt dp le kf nu nv li kj nw nx lm kn ny nz lq oa bi translated">配置文件</h2><p id="59c2" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">您必须根据您的按键在<code class="fe mj mk ml mm b">appsettings.json</code>中设置此信息。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><h2 id="df32" class="mv kv iq bd kw nq nr dn la ns nt dp le kf nu nv li kj nw nx lm kn ny nz lq oa bi translated">配置服务</h2><p id="08c0" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">开始在<code class="fe mj mk ml mm b">ConfigureServices()</code>方法中添加几行代码。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="8d4e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并且确保在你的<code class="fe mj mk ml mm b">Configure()</code>方法中有这行代码。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="c5ec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">哦，如果您使用Swagger生成器，下面是在Swagger中添加授权令牌表单的代码。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><h2 id="5070" class="mv kv iq bd kw nq nr dn la ns nt dp le kf nu nv li kj nw nx lm kn ny nz lq oa bi translated">检测用户配置文件</h2><p id="9e41" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">现在，你的后台是安全的，但是我们怎么知道谁登录了呢？<br/>以下是您可以在应用中使用的一些基本方法:</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><h1 id="fb32" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="b783" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">瞧，你可以走了。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Tweet From GitHub Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">来自GitHub Actions的推文</h1>
<blockquote>原文：<a href="https://itnext.io/tweet-from-github-actions-e289de58988a?source=collection_archive---------2-----------------------#2021-03-05">https://itnext.io/tweet-from-github-actions-e289de58988a?source=collection_archive---------2-----------------------#2021-03-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a8f5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开发一个在GitHub操作中运行的Twitter机器人</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/786a8c1a56ff90a0eb6ebf2c6e2f882c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGBgZEgWp8_bR5S2fVhybg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Ravi Sharma 在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="159c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近推出了<a class="ae ky" href="https://discoverweekly.dev/" rel="noopener ugc nofollow" target="_blank"> DiscoverWeekly.dev </a>网站，每周三分享开发者制作的新音乐播放列表。</p><p id="64cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了传播信息并让人们订阅，除了RSS订阅，我还开了一个Twitter账户，并开发了一个机器人，每周发一次关于新闻播放列表的微博。</p><p id="b77c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是如何创建一个Twitter Bot，它在GitHub Actions中定期运行。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b328" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Twitter API</h1><p id="f511" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">推文是在Twitter API的帮助下发布的。要访问这样的功能，您需要创建一个开发人员帐户并请求访问。您可以在这里启动您的应用<a class="ae ky" href="https://developer.twitter.com/en/apply-for-access" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="1295" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个过程需要几个步骤，但总的来说，可以在几分钟内解决。</p><p id="4838" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦您访问了您的<a class="ae ky" href="https://developer.twitter.com/en/portal/dashboard" rel="noopener ugc nofollow" target="_blank">仪表板</a>，创建一个新项目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/2b23041b387724b4da1e8b5d7d60cfa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7T5ulDZCk5AbJD5Qrwz-A.png"/></div></div></figure><p id="64b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的“应用程序权限”中，请求“读写”权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/a78c588bbb68fba1e0f0f873beb06936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NWATz8Zlxx3CgNZMmBvRVQ.png"/></div></div></figure><p id="b05e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在“密钥和令牌”下，生成所有“访问令牌和密码”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/2572f1129e042112066a2260d5f97ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axwweoz1kGPPaZW-I5h6Lg.png"/></div></div></figure><p id="6acd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，如果您在请求“读取和写入”权限之前已经生成了您的机密，您必须重新生成您的机密。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ee25" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">图书馆</h1><p id="3265" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">尽管使用Twitter API看起来不像火箭科学，但是使用已经制作好的Node.js库可以简化这个过程。此外，Twitter目前正在开发一个新的API (v2)，但是我们希望使用的这个API<a class="ae ky" href="https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update" rel="noopener ugc nofollow" target="_blank">status/update</a>还没有被迁移(v1)。因此，在这种情况下，使用库作为额外的布局可能有助于我们将来不必重写所有内容。</p><p id="e2fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为什么我们要将<a class="ae ky" href="https://github.com/FeedHive/twitter-api-client" rel="noopener ugc nofollow" target="_blank"> twitter-api-client </a>库添加到项目中。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="48e8" class="nf md it nb b gy ng nh l ni nj">npm i twitter-api-client --save-dev</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ee13" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">推特机器人</h1><p id="1d1f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了开发Twitter Bot，我们在项目的根目录下创建了一个新文件<code class="fe nk nl nm nb b">twitter.js</code>。它包含一个使用<code class="fe nk nl nm nb b">twitter-api-client</code>处理<code class="fe nk nl nm nb b">tweet</code>本身的函数，以及一个顶层<code class="fe nk nl nm nb b">async</code>块，当脚本运行时触发它。</p><p id="ffc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了不公开我们之前创建的令牌，我们通过环境变量来访问它们(见下一章)。</p><p id="cc92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在下面的例子中，tweet是一个常量消息。任何推文，应该最长280个字符，可以标记用户名和指向网址。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="29fe" class="nf md it nb b gy ng nh l ni nj">const {TwitterClient} = require('twitter-api-client');<br/><br/>const tweet = async (status) =&gt; {<br/>  const twitterClient = new TwitterClient({<br/>    apiKey: process.env.TWITTER_API_KEY,<br/>    apiSecret: process.env.TWITTER_API_SECRET,<br/>    accessToken: process.env.TWITTER_API_ACCESS_TOKEN,<br/>    accessTokenSecret: process.env.TWITTER_ACCESS_TOKEN_SECRET,<br/>  });<br/><br/>  await twitterClient.tweets.statusesUpdate({status});<br/>};<br/><br/>(async () =&gt; {<br/>  try {<br/>    const myTweet = <br/>          `Checkout @discoverweekly_ https://discoverweekly.dev`;<br/><br/>    await tweet(myTweet);<br/>  } catch (err) {<br/>    console.error(err);<br/>  }<br/>})();</span></pre><p id="453e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了运行这个机器人，我们在我们的<code class="fe nk nl nm nb b">package.json</code>中添加了一个相关的<code class="fe nk nl nm nb b">scripts</code>目标。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="b469" class="nf md it nb b gy ng nh l ni nj">"scripts": {<br/>  "twitter": "node ./twitter.js"<br/>},</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="892f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">环境变量</h1><p id="5431" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了使我们的令牌和秘密，我们通过环境变量进行处理，可用于我们的GitHub操作，转到您的<code class="fe nk nl nm nb b">GitHub repo &gt; Settings &gt; Secrets</code>并添加它们各自的值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/c38a898b1ba635f354b536d8db495342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_SW7X4ifZ0tiONf0PsEDA.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3adf" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">GitHub操作</h1><p id="0fe6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后，将GitHub动作如<code class="fe nk nl nm nb b">.github/workflows/twitter.yml</code>添加到您的项目中，它会定期运行我们之前创建的Node.js脚本。</p><p id="5f95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就我而言，由于我每周发布一次新的播放列表，并且只在推特上发布一次，所以工作流程被安排在特定的UTC时间运行。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="58ff" class="nf md it nb b gy ng nh l ni nj">name: Twitter bot<br/><br/>on:<br/>  schedule:<br/>    - cron: "0 15 * * 3"<br/><br/>jobs:<br/>  build:<br/>    name: Tweet about the new playlists<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - name: Checkout Repo<br/>        uses: actions/checkout@master<br/>      - name: Use Node.js<br/>        uses: actions/setup-node@v1<br/>        with:<br/>          node-version: '14.x'<br/>      - name: Install Dependencies<br/>        run: npm ci<br/>      - name: Run Twitter bot<br/>        run: npm run twitter<br/>        env:<br/>          TWITTER_API_KEY: ${{ secrets.TWITTER_API_KEY }}<br/>          TWITTER_API_SECRET: ${{ secrets.TWITTER_API_SECRET }}<br/>          TWITTER_API_ACCESS_TOKEN: ${{ secrets.TWITTER_API_ACCESS_TOKEN }}<br/>          TWITTER_ACCESS_TOKEN_SECRET: ${{ secrets.TWITTER_ACCESS_TOKEN_SECRET }}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f865" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d0c17739f412346eab2de37ccd3e4d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*N4H7Sfn1DEt9XJWQ3PnnEA.gif"/></div></figure><p id="f1ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我很惊讶地注意到开发这样一个Twitter机器人是多么的简单，而且实际上很有趣。希望这篇文章也能帮到你。</p><p id="aa4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到无限和更远的地方！</p><p id="209b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大卫</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="63d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过<a class="ae ky" href="https://twitter.com/daviddalbusco" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或我的<a class="ae ky" href="https://daviddalbusco.com/" rel="noopener ugc nofollow" target="_blank">网站</a>联系我。</p><p id="656f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尝试使用<a class="ae ky" href="https://deckdeckgo.com/" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>制作您的下一张幻灯片🤟。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://deckdeckgo.com"><div class="gh gi np"><img src="../Images/084fe1923331f770afe6ef5fbc827f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JI9dP2MWtU8RJEVjT8BOlQ.png"/></div></a></figure></div></div>    
</body>
</html>
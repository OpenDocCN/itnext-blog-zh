<html>
<head>
<title>Unit testing with MobX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用MobX进行单元测试</h1>
<blockquote>原文：<a href="https://itnext.io/unit-testing-with-mobx-d4d550689086?source=collection_archive---------3-----------------------#2020-01-07">https://itnext.io/unit-testing-with-mobx-d4d550689086?source=collection_archive---------3-----------------------#2020-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/06af50abe3ff3f4c212591732324ee59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cT9EyJJvhhdDyy1y.jpeg"/></div></div></figure><p id="5d3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">什么是单元测试？</p><p id="eaa5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">单元测试是建立在系统的输入或输出声明(控制数据、使用程序和操作程序)上的每一个测试。它是代码中较小的可测试部分。</p><p id="1fbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">什么事？</strong></p><p id="5351" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">单元测试的重要性在于确保你的代码的所有输入和输出都如你所愿地工作。这让您有信心，这些孤立的小代码片段在使用过程中不会中断。为了确保完全的安全性，编写集成测试非常重要，集成测试负责测试所有代码的功能。</p><p id="b8d8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">为Mobx编写测试。</strong></p><p id="0802" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">MobX基于商店、动作和反应，使用透明功能反应编程(TFRP ),因为它是功能性的，所有动作都是功能，它们的数据是可观察的反应值。所以测试你的商店非常简单。</p><p id="5a3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">先说计数器。</strong></p><p id="7284" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，那个老柜台。</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="7e75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将测试增量是否如我们预期的那样发生。</p><p id="65f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，声明测试。</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="c173" class="li lj iq le b gy lk ll l lm ln">test(<br/>‘When increment counter at 0 ‘<br/>‘should return 1’, () {</span><span id="322b" class="li lj iq le b gy lo ll l lm ln">});</span></pre><p id="6f92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后我们会申报专柜店。</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="0fa3" class="li lj iq le b gy lk ll l lm ln">final counter = Counter();</span></pre><p id="98cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们期望计数器从0开始计数。</p><p id="6b6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，使用“expect”函数，该函数接收要测试的变量和您期望作为参数的值。</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="42ce" class="li lj iq le b gy lk ll l lm ln">expect(counter.value, 0);</span></pre><p id="a8ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，执行增量并验证值是否增加了。</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="d2aa" class="li lj iq le b gy lk ll l lm ln">expect(counter.value, 1);</span></pre><p id="81de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要运行测试，请在控制台中运行:</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="559c" class="li lj iq le b gy lk ll l lm ln">flutter test</span></pre><p id="a760" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者使用IDE的“运行所有测试”选项。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/24fd8093bbd2931ec62d2cbcc138ba63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/0*RyENWR8AgrtCgXA4"/></div></figure><p id="5d7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">成功！</em></p><p id="8c49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们来举一个更复杂的例子，<em class="kw">但不要太复杂。</em></p><p id="e933" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">测试市场推车。</strong></p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="785b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">市场购物车由一个表示商品的类和一个具有添加和删除功能的商品列表的商店组成。</p><p id="4dcd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们测试一个项目添加。</p><p id="d549" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">声明将要添加的购物车和商品，然后执行添加功能，预计我们的列表长度将增加到1，并且包含我们的商品。</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="85fc" class="li lj iq le b gy lk ll l lm ln">test(<br/>‘When add a item’<br/>‘should contains that item, () {<br/>  final cart = Cart();<br/>  final item = CartItem(‘test’);</span><span id="bd00" class="li lj iq le b gy lo ll l lm ln">  cart.addItem(item);</span><span id="878b" class="li lj iq le b gy lo ll l lm ln">  expect(todoList.items.length, 1);</span><span id="af9c" class="li lj iq le b gy lo ll l lm ln">  expect(todoList.items.contains(item), true);<br/>});</span></pre><p id="505f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，测试移除。</p><p id="4343" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与上面添加的方式相同，我们将删除列表，期望列表长度为0，并且不再包含我们的项目。</p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="67a3" class="li lj iq le b gy lk ll l lm ln">test(<br/>‘When remove a item’<br/>‘should not contains that item, () {<br/>  final cart = Cart();<br/>  final item = CartItem(‘teste’);</span><span id="dd86" class="li lj iq le b gy lo ll l lm ln">  cart.addItem(item);<br/>  expect(cart.items.length, 1);<br/>  expect(cart.items.contains(item), true);</span><span id="6e32" class="li lj iq le b gy lo ll l lm ln">  cart.removeItem(item);<br/>  expect(cart.items.length, 0);<br/>  expect(cart.items.contains(item), false);<br/>});</span></pre><p id="7bd9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所有购物车测试:</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="c627" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">运行测试。</strong></p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/3d8e5634a37ba92c927f642eec7e820a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Fh563SQb8v-uTKr"/></div></div></figure><p id="4cbf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，您已经准备好使用MobX探索测试世界了。</p><p id="8caa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">重要建议:</strong></p><p id="d529" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">建议您使用测试驱动开发的TDD。</p></div></div>    
</body>
</html>
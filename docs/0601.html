<html>
<head>
<title>WTF is deadcode elimination?? How to do it by yourself</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WTF是死码消除？？自己怎么做</h1>
<blockquote>原文：<a href="https://itnext.io/wtf-is-deadcode-elimination-how-to-do-it-by-yourself-d1e1e26b0ed0?source=collection_archive---------1-----------------------#2018-04-09">https://itnext.io/wtf-is-deadcode-elimination-how-to-do-it-by-yourself-d1e1e26b0ed0?source=collection_archive---------1-----------------------#2018-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="c6e0" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">方案</h1><p id="eeec" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">根据<a class="ae lj" href="https://en.wikipedia.org/wiki/Dead_code_elimination" rel="noopener ugc nofollow" target="_blank">维基</a></p><blockquote class="lk ll lm"><p id="f692" class="kl km ln kn b ko lo kq kr ks lp ku kv lq lr ky kz ls lt lc ld lu lv lg lh li ij bi translated"><em class="iq">死码消除是一种编译器优化，用于删除不影响程序结果的代码。</em></p></blockquote><ul class=""><li id="f101" class="lw lx iq kn b ko lo ks lp kw ly la lz le ma li mb mc md me bi translated"><strong class="kn ir"> <em class="ln">前世的我</em> </strong>:🤩消除死代码是编译器的工作，而我们，开发者，不需要关心任何事情。</li><li id="7d35" class="lw lx iq kn b ko mf ks mg kw mh la mi le mj li mb mc md me bi translated"><strong class="kn ir"> <em class="ln"> Me </em> </strong>:🙅🏼作为开发者，我们也有责任清理自己的问题💩。</li></ul><p id="3392" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">那么我们该怎么做呢？</p><ul class=""><li id="5d29" class="lw lx iq kn b ko lo ks lp kw ly la lz le ma li mb mc md me bi translated"><strong class="kn ir"> <em class="ln">过去的我</em> </strong>:不，我知道哪些部分用了，哪些没用，我们有良好的代码审查流程，因此，一切都在我们的控制之下。</li><li id="53ff" class="lw lx iq kn b ko mf ks mg kw mh la mi le mj li mb mc md me bi translated"><strong class="kn ir"> <em class="ln">我</em> </strong>:闭上你的鸟嘴<strong class="kn ir"> <em class="ln">过去的我</em> </strong>，你怎么能记住那些部分，而仅仅几个月后，你甚至不能认出它们是你自己写的🤦。</li></ul><p id="2587" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">假设你还记得，当你的团队变大时，这个问题仍然会发生。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/3bca653dcba26f9f539ab0b79b3812db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JV0ZgTPn-EovEXLomZkNzg.jpeg"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">照片由<a class="ae lj" href="https://unsplash.com/photos/UTT39aMPxwg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Max Lakutin </a>在<a class="ae lj" href="https://unsplash.com/search/photos/garbage?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6cd9" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">同样，我们如何检测死代码，这篇文章是我自动消除和报告死代码的方法，这样我就可以花更多的时间来喝酒🍺。</p><p id="ce35" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">最近，我的主要焦点是javascript，所以我将解释如何用javascript做，但我认为在高层次上，你可以做一些类似的事情(不要相信我👅).</p><h1 id="c283" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">自动移除死代码</h1><p id="482b" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">为了自动删除死码，解决方案是:</p><ul class=""><li id="0d25" class="lw lx iq kn b ko lo ks lp kw ly la lz le ma li mb mc md me bi translated">你的代码编辑器。</li><li id="5237" class="lw lx iq kn b ko mf ks mg kw mh la mi le mj li mb mc md me bi translated">提交代码后运行的工具，合并程序…</li></ul><h2 id="3560" class="na jo iq bd jp nb nc dn jt nd ne dp jx kw nf ng kb la nh ni kf le nj nk kj nl bi translated">代码编辑器</h2><p id="c1a1" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我的代码编辑器现在是<a class="ae lj" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio Code </a>，它有很多扩展，帮助我们实现我们需要的东西。下面的列表是我正在使用的:</p><ul class=""><li id="33a5" class="lw lx iq kn b ko lo ks lp kw ly la lz le ma li mb mc md me bi translated">https://marketplace.visualstudio.com/items?itemName=eg2.tslint (或<a class="ae lj" href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint" rel="noopener ugc nofollow" target="_blank"> eslint </a> ) <strong class="kn ir">启用autoFixOnSave。</strong></li><li id="9b84" class="lw lx iq kn b ko mf ks mg kw mh la mi le mj li mb mc md me bi translated">打字稿英雄:<a class="ae lj" href="https://marketplace.visualstudio.com/items?itemName=rbbit.typescript-hero" rel="noopener ugc nofollow" target="_blank">https://marketplace.visualstudio.com/items?itemName = Rb bit . typescript-hero</a>。</li></ul><p id="d5be" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">✍🏻之前用vim，决定用Visual Studio代码来编码javascript。Vim是最具生产力的编辑器之一，因此，为了结合两个世界的优点，我在<a class="ae lj" href="https://marketplace.visualstudio.com/items?itemName=vscodevim.vim" rel="noopener ugc nofollow" target="_blank"> vim模式</a>下使用Visual Studio代码。</p><h2 id="d331" class="na jo iq bd jp nb nc dn jt nd ne dp jx kw nf ng kb la nh ni kf le nj nk kj nl bi translated">CI工具</h2><p id="3276" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我还没有尝试过很多工具，我唯一使用的脚本是在提交代码之前，运行得更漂亮。您可以点击查看更多<a class="ae lj" href="https://prettier.io/docs/en/precommit.html" rel="noopener ugc nofollow" target="_blank">详情。</a></p><h1 id="7001" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">报告死亡代码</h1><p id="ddf3" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">✍🏻您仍然可以使用代码编辑器和我上面提到的扩展来警告您未使用的变量、未使用的函数/方法(<a class="ae lj" href="https://marketplace.visualstudio.com/items?itemName=eg2.tslint" rel="noopener ugc nofollow" target="_blank"> tslint </a>、<a class="ae lj" href="https://marketplace.visualstudio.com/items?itemName=shinnn.stylelint" rel="noopener ugc nofollow" target="_blank"> stylelint </a> …)。另一方面，我们可以利用模块捆绑器来报告死代码。</p><p id="b22e" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">在过去的几年里，有很多模块捆绑器帮助我们将代码库分割成小部分，然后再进行捆绑(例如webpack、rollup、brunch……)。我使用webpack作为我的模块捆绑器，webpack没有正式支持我们检测死代码的方法，但提供了基于此的信息，我们可以检查我们的代码是否死了。下一节我将描述如何使用这些信息来实现我们所需要的(如果你只是想使用<a class="ae lj" href="https://github.com/MQuy/webpack-deadcode-plugin" rel="noopener ugc nofollow" target="_blank">死代码插件</a>，我创建了这个插件)🙋).</p><p id="b777" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">在我看来，有两种类型的死代码，对于每种类型的死代码，我将演示如何在webpack中进行检测:</p><ul class=""><li id="466b" class="lw lx iq kn b ko lo ks lp kw ly la lz le ma li mb mc md me bi translated">未使用的文件。</li><li id="2700" class="lw lx iq kn b ko mf ks mg kw mh la mi le mj li mb mc md me bi translated">已用文件中未使用的导出。</li></ul><p id="86bd" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated"><strong class="kn ir">未使用的文件</strong></p><p id="c6ea" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">Webpack有一个很棒的教程，它向我们介绍了如何编写插件。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nm"><img src="../Images/a1342e7547faa9b896880e756ef7274c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HjEO4SJ0MNS3ECKW.png"/></div></div></figure><p id="c3c2" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">下图是使用webpack的死简单项目🐤。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nn"><img src="../Images/a596c1ee1d5f751d9c52980ae876a3a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9WQSxhRrWCQqT-78.png"/></div></div></figure><p id="f546" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">下图是它将通过<a class="ae lj" href="https://github.com/MQuy/webpack-deadcode-plugin" rel="noopener ugc nofollow" target="_blank"> webpack deadcode插件</a>输出到控制台的内容。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi no"><img src="../Images/3084046c87cab1f307b0b9ccd8395436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zbSo1jgGuyCLBtf1.png"/></div></div></figure><p id="78b5" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated"><strong class="kn ir">已用文件中未使用的导出</strong></p><p id="8deb" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">起初，我不知道如何解决这个问题😳当你不知道的时候就问。webpack核心团队真的很了不起，他们指导我怎么做。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi np"><img src="../Images/5b39ecfdbae3665f852246a5d13fb8bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*j7LuGSlvr7V93m1T.png"/></div></div></figure><p id="4249" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">同样，使用<code class="fe nq nr ns nt b">import</code>、<code class="fe nq nr ns nt b">export</code>非常简单🐣。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nu"><img src="../Images/a7da714b9ac2085d9b5013a6d64eff22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nvDOboV6ot7xDJuu.png"/></div></div></figure><p id="0525" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">下图是它将通过<a class="ae lj" href="https://github.com/MQuy/webpack-deadcode-plugin" rel="noopener ugc nofollow" target="_blank"> webpack deadcode插件</a>输出到控制台的内容。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nv"><img src="../Images/17ca9e350279070e8f8290880c48469b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZfnjntSuY9Ul0Hkl.png"/></div></div></figure><h1 id="98f5" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结论</h1><p id="0d7c" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这就是我目前所知道的靠我们自己清理我们的代码库。如果你知道其他方法，请分享🙇所以尽可能少我们自己的💩。</p><p id="f9ff" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lr ky kz la lt lc ld le lv lg lh li ij bi translated">感谢阅读！！🙏</p></div></div>    
</body>
</html>
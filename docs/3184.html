<html>
<head>
<title>Creating chiptunes with Python, MIDI and LSDJ</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python、MIDI和LSDJ创作chiptunes</h1>
<blockquote>原文：<a href="https://itnext.io/creating-chiptunes-with-python-midi-and-lsdj-3db936ddd469?source=collection_archive---------2-----------------------#2019-10-19">https://itnext.io/creating-chiptunes-with-python-midi-and-lsdj-3db936ddd469?source=collection_archive---------2-----------------------#2019-10-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d4bd91f3976aa9301827de9bbecfff30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YB2TFlqAv2g7wcCp-IYYUg.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">游戏机上的技术死亡金属？为什么不呢！</figcaption></figure><p id="ace0" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">像任何人一样，我热爱音乐。像所有书呆子一样，我喜欢在旧游戏机上制作的音乐。</p><p id="efbb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了在我的老游戏机任天堂Gameboy上制作音乐，我使用了一款名为“小声音DJ (LSDJ)”的软件。</p><p id="65d6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">简单地说，LSDJ允许你将音符编程为乐句(本质上是音乐的小节)，然后创建乐句链，这些乐句链就变成了一首歌。</p><h1 id="c0cd" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">使用限制</h1><p id="43ad" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">Gameboy只支持四个通道(还有第五个，但很难使用)，两个脉冲通道，一个波形和一个噪声通道，虽然它可以同时播放所有四个通道，但各个通道本身都是单声道的。</p><p id="035a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这些限制实际上是吸引我到chiptune音乐的原因，你必须创建自己的方法来实现简单的音乐结构，如和弦或非常见时间的拍号。</p><p id="b434" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">LSDJ提供工具来弥补这种功能的缺乏，例如，9/8拍的拍号可以通过两个16个音符的乐句来实现，第二个乐句在第二个音符之后结束(所以是18/16)，和弦可以通过快速弹奏和弦中的音符来实现。</p><p id="6ee9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">Chiptune艺术家不仅受到他们可用的音乐工具的限制，还受到硬件资源的限制。</p><p id="5d30" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">LDSJ可以支持多达254个16音乐句和254个16音乐句链，这实际上足以满足大多数需求，但对于上面的9/8示例，由于需要两个乐句，它突然减半为127个乐句，如果我们假设所有四个通道都将被使用，则每个乐器只有31个乐句，即558个乐句。</p><p id="de15" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">LSDJ再次提供了一些工具来解决这一限制，当添加一个短语到一个链中时，可以选择移调音符，这样你就可以最大限度地重复使用短语，比如改变音调。</p><h1 id="2b59" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">加强我的游戏</h1><p id="4979" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">我在LSDJ创作/编程的大部分歌曲都比较直接，要么是在普通时间，要么有简单的歌曲结构。</p><p id="9d56" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然而，我最近决定给自己一个挑战，尝试一首Necrophagist的《烹饪过敏》，这首歌我已经用吉他学了一年多了。</p><p id="90da" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我在今年年初的最初尝试并没有取得很大进展，因为我无法在一个会话中编程这首歌，并且在有时间将它选回来后失去了我的位置。</p><p id="cac3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我正在学习吉他部分，并从MIDI文件转录Gameboy部分，因此决定尝试通过我拥有的<a class="ae mg" href="https://thursdaycustoms.bigcartel.com/product/usb-boy" rel="noopener ugc nofollow" target="_blank"> USB-Boy接口</a>将MIDI数据从Logic中继到LDSJ，但我永远无法让它正常工作(尽管这是一个逻辑问题，而不是接口问题)。</p><p id="b290" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><a class="ae mg" href="https://medium.com/@colinwren/visualising-midi-files-with-python-b221feacd762" rel="noopener">我以前处理过MIDI数据</a>，并决定重新审视我以前的项目，但我没有将MIDI数据可视化，而是将其转换成音符、短语和链，以便将歌曲转录到LSDJ。</p><h1 id="c47a" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">我画出了所有正确的音符，只是顺序不一定正确</h1><p id="8885" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">MIDI数据只是一系列事件，是通过将MIDI滴答声解析为音符值(如半八分音符(第16个音符))来确定音乐结构的唯一方法。</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">创建一个dict，将tick值作为键，将该tick处的音符作为值</figcaption></figure><p id="2306" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然而，音乐并不是被写成一系列流动的音符，而是由包含一系列音符的小节组成，这些音符被分解成一定的小节。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6dea83ec6b1eeff8ad3513a68dcd6a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9wQ4DhqSACYtENg9QVVBMQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">这可能会成为我最喜欢的数学</figcaption></figure><p id="167d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">幸运的是，MIDI存储了拍号事件以及它们发生的节拍，因此为了展示歌曲的蓝图，只需将音符映射到它们所属的乐句/小节，并将这些乐句/小节映射到链。</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">基于拍号将音符映射到乐句</figcaption></figure><p id="ad7b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">创建了音符到小节的映射后，我删除了重复的短语，以减少需要输入和存储在链中的短语数量。</p><p id="cedb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我是这样做的:创建一个base64字符串的短语中的音符，然后使用一个<code class="fe mn mo mp mq b">dict</code>来创建一个集合，同时在一个数组中保留短语的顺序。</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">删除重复的短语并创建链式映射</figcaption></figure><h1 id="74a4" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">打印东西</h1><p id="4d61" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">当然，在对象中有歌曲结构是没有用的，它们需要被转换成一种方式，使输入到LSDJ变得简单。</p><p id="f822" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">LSDJ乐句屏幕显示三/四列(鼓有两个音符)；注释、仪器和命令以及16行，尽管这些行是十六进制的，所以0-F。</p><p id="0270" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">显示鼓需要更多的努力，因为MIDI文件会返回音高，但LSDJ对不同的鼓使用短代码，例如<code class="fe mn mo mp mq b">bd</code>代表低音鼓，<code class="fe mn mo mp mq b">chh</code>代表近踩镲。</p><p id="e972" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了显示正确的鼓，我创建了一个不同音高和它们相关的鼓的地图，此外，LSDJ的鼓可以同时播放两种声音，所以我扩展了短语视图以显示两种音符。</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">打印鼓乐句</figcaption></figure><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/e043929272cffe4b41ffafaa747211ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*kBKLFyEdzBm9u_be6kgOiw.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">强烈的节奏</figcaption></figure><p id="9229" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了更容易找到我的位置(有很多短语)，我决定以一种非常基本的方式复制列和行结构，这非常有效，因为你可以清楚地看到什么是要去哪里，我在哪个短语中。</p><p id="1e85" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果这个短语不得不提前结束(由于6/8等等)，那么我必须确保最后一行在命令行中包含一个<code class="fe mn mo mp mq b">H00</code>(这告诉LSDJ跳到下一个短语)。</p><p id="f567" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">对于链，我做了类似的显示，但只有行号和短语。</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">印刷链条</figcaption></figure><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/4ca962e503be535fa688e48fc076544c.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*OBSYYDda4X51ar_o-hCCGQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">包含爆破节拍短语的链</figcaption></figure><h1 id="2994" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">把所有的放在一起</h1><p id="693a" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">在解决了剧本中的大部分问题后，我决定咬紧牙关，看看我编写的每一个程序是否真的会产生类似这首歌的效果……的确如此！</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="mt mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">鼓声的一个例子</figcaption></figure><p id="1e20" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">除了我不知道哪些乐句包含哪些音符(因为这是由计算机处理的)这一事实之外，我花了两个多小时为封面编写鼓和两个脉冲通道乐器的程序，当我第一次按下播放时，它完美地工作了。</p><p id="1ff9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了在添加多个通道时更容易抵消短语和链，我最终构建了一些命令行参数来处理这一点，但由于LSDJ数字是十六进制的，我必须在输入数字之前进行一些转换。</p><p id="c933" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果我完全诚实，我绝对惊讶它第一次工作，我已经预料到它会失败，但我的手指很高兴我不需要再花2个小时在笔记中编程！</p><p id="39e1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后，我开始录制单独的低音音轨和独奏音轨，并用我的半速游戏机录制鼓和吉他音轨，将它们混合在一起。</p><p id="f8fb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这一过程的最终结果如下:</p><figure class="mh mi mj mk gt ju"><div class="bz fp l di"><div class="mu mm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">最后一首歌！</figcaption></figure><h1 id="f39a" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">后续步骤</h1><p id="5b06" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">这个剧本一点也不完美，我列出了一些我想做的改进:</p><ul class=""><li id="aed1" class="mv mw it kh b ki kj km kn kq mx ku my ky mz lc na nb nc nd bi translated">某些歌曲利用了这些(尤其是在独唱中)，我想自动化这个，因为它需要以双倍的速度运行命令</li><li id="8640" class="mv mw it kh b ki ne km nf kq ng ku nh ky ni lc na nb nc nd bi translated"><strong class="kh iu">和弦</strong>——以特定节拍播放所有音符，并自动创建一个播放和弦音符的表格，这将非常棒</li><li id="b678" class="mv mw it kh b ki ne km nf kq ng ku nh ky ni lc na nb nc nd bi translated"><strong class="kh iu">多声道导入</strong>——不是一次处理一个文件，而是处理一个多声道MIDI文件或单独的文件，而是通过一个YAML文件或其他东西，这样会更容易使用</li><li id="996b" class="mv mw it kh b ki ne km nf kq ng ku nh ky ni lc na nb nc nd bi translated">JSON/HTML显示 —我想把这个脚本变成一个web服务，输出是JSON，然后可以输入React显示。我的目标是，任何人都可以上传一个MIDI文件，并获得他们需要的LSDJ命令，把它放在他们的游戏机上</li><li id="e0a1" class="mv mw it kh b ki ne km nf kq ng ku nh ky ni lc na nb nc nd bi translated"><strong class="kh iu"> LSDJ保存文件生成</strong>——我可以使用LSDJ保存文件的Python库，最终节省更多的时间，因为我只需要将它添加到我的盒式磁带中，然后按下play</li><li id="a60a" class="mv mw it kh b ki ne km nf kq ng ku nh ky ni lc na nb nc nd bi translated"><strong class="kh iu">发布</strong> —这样别人就可以用了！</li></ul></div></div>    
</body>
</html>
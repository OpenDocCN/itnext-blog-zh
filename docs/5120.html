<html>
<head>
<title>Logic Classes in Swift &amp; Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift &amp; Kotlin中的逻辑类</h1>
<blockquote>原文：<a href="https://itnext.io/logic-classes-in-swift-kotlin-f7ac1f295839?source=collection_archive---------1-----------------------#2020-12-16">https://itnext.io/logic-classes-in-swift-kotlin-f7ac1f295839?source=collection_archive---------1-----------------------#2020-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d01e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">探索支持设计良好的视图模型的类的生态系统</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/1fc399ba2e7ad504e0b3a706400c5efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UJGR-tSpLsbjxcNijkHtNg.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">森林不仅仅是树，视图模型也不仅仅是视图和模型！(由<a class="ae lb" href="https://unsplash.com/@szmigieldesign?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Lukasz Szmigiel </a>在<a class="ae lb" href="https://unsplash.com/s/photos/forest?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄)</figcaption></figure><p id="446a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开发人员经常错误地认为，在<a class="ae lb" href="https://medium.com/upday-devs/android-architecture-patterns-part-3-model-view-viewmodel-e7eeee76b73b" rel="noopener"> MVVM架构</a>中，模型类都存在于<a class="ae lb" href="https://medium.com/swlh/viewmodels-in-swift-kotlin-721bbc6f8c07" rel="noopener">视图模型层</a>之下，或者可能是模型+ API类。</p><p id="4f15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的<a class="ae lb" href="https://medium.com/swlh/kotlin-in-xcode-swift-in-android-studio-26a4ace6fc72" rel="noopener">干净的MVVM架构</a>中，我们看到事实上有一个更大的类生态系统，它们都支持ViewModel完成它的工作。这些启用类中第一个也是最容易被忽略的被称为逻辑类。</p><blockquote class="lc ld le"><p id="5113" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated">逻辑类是无状态的包装类，它根据从存储库中检索的数据应用条件逻辑。</p></blockquote><p id="cd22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑类用红色<strong class="jp ir">表示</strong>🔴清洁建筑中的部分图表。ViewModel根据这些决定更新其状态或发出事件。逻辑类不知道关于视图或视图模型的任何事情。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/817ad6a640964c987a4464eab932360d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*Il71y1tgm-SAIcvNON_mDA.png"/></div></figure><p id="53d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，逻辑类可以基于简档的完成或简档的订阅状态来决定是否请求匹配堆栈。</p><h1 id="3e03" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">在以下情况下使用逻辑类:</h1><ul class=""><li id="400b" class="mi mj iq jp b jq mk ju ml jy mm kc mn kg mo kk mp mq mr ms bi translated">从两个或更多存储库中检索数据，和/或</li><li id="c8de" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">条件逻辑正在被执行，它创建了不同的测试用例，而不是存储库中正在被测试的内容。</li></ul><h1 id="e48d" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">逻辑类可以:</h1><ul class=""><li id="af5f" class="mi mj iq jp b jq mk ju ml jy mm kc mn kg mo kk mp mq mr ms bi translated">使用多个存储库来访问全局状态或本地状态上的业务逻辑的方法参数</li><li id="e72c" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">将多个逻辑类组合在一起(例如，您可以将逻辑类相互注入)</li><li id="9f5e" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">组合来自多个存储库的反应流，以简化父视图模型类的使用</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi my"><img src="../Images/372a3002dba05b60006dff54497462fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*5G9NdG0zmYG7YZwvoc1jlw.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">逻辑是包装器；发髻是储存库；肉是数据模型；番茄酱就是API？</figcaption></figure><h1 id="b42e" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">逻辑类并不总是需要的</h1><p id="1fe9" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">如果您发现一个逻辑类仅仅作为一个存储库类的通道，那么它可能是不必要的，我们可以简单地让视图模型直接与存储库对应。</p><h1 id="02d4" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">示例:匹配</h1><p id="6367" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">在这个例子中，我们正在为一个约会应用程序建模一个基于刷卡的匹配功能。您可以看到我们的MatchLogic类不仅依赖于MatchRepository，还依赖于AccountRepository(关于当前登录配置文件的信息)、LocationRepository(关于用户的纬度和经度的信息)和FeatureRepository(用于控制实验)。</p><p id="7f01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个实现中，我们的MatchLogic类在第一次运行时在匹配堆栈的顶部插入指令卡；如果两个配置文件匹配，MatchLogic也会发出一个相互匹配事件。MatchLogic通过从AccountRepository读取当前登录的配置文件来公开它。</p><h1 id="1fc8" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">为什么你需要反应流</h1><p id="d743" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">注意方法<code class="fe nc nd ne nf b">restartMatch</code>——它结合了AccountRepository中的两个observables，并且每当其中一个发生变化时，都会发出一个事件，最终由ViewModel使用，以重置回初始状态(并可能获取一个新的匹配堆栈)。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="424c" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">接下来</h1><p id="da0f" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">在下一篇文章中，我们将探索一个干净的MVVM架构的中心，在那里我们可以找到存储库和领域模型。</p><h1 id="023f" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">本系列的更多内容</h1><ul class=""><li id="b41e" class="mi mj iq jp b jq mk ju ml jy mm kc mn kg mo kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/p/26a4ace6fc72" rel="noopener">简介</a></li><li id="2991" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/p/721bbc6f8c07" rel="noopener">Swift中的视图模型&amp;科特林</a></li><li id="08d8" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated">Swift &amp; Kotlin的逻辑课← <em class="lf">你在这里</em></li><li id="b847" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/perry-street-software-engineering/repositories-and-models-in-swift-kotlin-df9ae2c84cb7" rel="noopener">Swift中的存储库和域模型&amp; Kotlin </a></li><li id="0040" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/perry-street-software-engineering/api-classes-in-swift-kotlin-a2cb90d3906d" rel="noopener">Swift中的API类&amp; Kotlin </a></li><li id="ba65" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/p/f5416dec42ea" rel="noopener">Swift中的视图&amp; Kotlin </a></li><li id="c264" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/p/ccb55e462760" rel="noopener">在Swift中测试MVVM&amp;科特林</a></li><li id="e8aa" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/testing-asynchronicity-in-swift-kotlin-4926936eae28">测试Swift中的异步性&amp; Kotlin </a></li><li id="84d2" class="mi mj iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><a class="ae lb" href="https://medium.com/perry-street-software-engineering/summary-clean-mvvm-in-swift-kotlin-7057230600aa" rel="noopener">清洁MVVM总结</a></li></ul><h1 id="bd70" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">你可能喜欢的其他系列</h1><p id="ed5f" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated"><a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/a-visual-history-of-web-api-architecture-c36044df2ac7"> <strong class="jp ir">清理API架构(2021) </strong> </a> <strong class="jp ir"> <br/> </strong>构建现代API端点时的类、执行模式和抽象。</p><p id="dbfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://proandroiddev.com/android-activity-lifecycle-considered-harmful-98a5b00d287" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Android活动生命周期被认为有害</strong></a><strong class="jp ir">(2021)<br/></strong>Android进程死亡，不可解释的NullPointerExceptions，以及你现在就需要的MVVM生命周期</p><h1 id="f4d3" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">关于作者</h1><p id="7dc3" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated"><em class="lf">埃里克·西尔弗伯格(Eric Silverberg)是</em> <a class="ae lb" href="https://www.perrystreet.com/" rel="noopener ugc nofollow" target="_blank"> <em class="lf">佩里街软件</em> </a> <em class="lf">的首席执行官和创始人，是iOS和Android上两个全球最大的LGBTQ+约会应用的发行商。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to use plain Three.js in your React apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React应用中使用普通的Three.js</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-use-plain-three-js-in-your-react-apps-417a79d926e0?source=collection_archive---------2-----------------------#2018-03-10">https://itnext.io/how-to-use-plain-three-js-in-your-react-apps-417a79d926e0?source=collection_archive---------2-----------------------#2018-03-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/ac27d3370169b56cd60fc412f26de9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9Km1-0t0os8054SYQI_sg.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="5e11" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">在React应用程序中集成Three.js代码，而不使用React绑定</h2></div><p id="581d" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><a class="ae lm" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fhow-to-use-plain-three-js-in-your-react-apps-417a79d926e0" rel="noopener ugc nofollow" target="_blank"> <em class="ln">点击这里在LinkedIn </em>上分享这篇文章</a></p><p id="67c1" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在这篇文章中，我将展示plain Three.js和React.js之间集成的一个简单示例。我不会对Three.js使用React绑定，它们很好，但我认为plain Three.js允许更大的灵活性，并且更容易使用。</p><p id="acc6" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">我将按照<em class="ln">实体/组件模式</em>构建Three.js代码，这里的<a class="ae lm" href="https://medium.com/@soffritti.pierfrancesco/how-to-organize-the-structure-of-a-three-js-project-77649f58fa3f" rel="noopener">是</a>，但是你不需要知道它是如何工作的才能理解这篇文章。</p><p id="13c3" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">React应用程序中Three.js代码的工作示例在<a class="ae lm" href="https://github.com/PierfrancescoSoffritti/pierfrancescosoffritti.com/tree/master/src/components/home/header" rel="noopener ugc nofollow" target="_blank">本报告</a>中提供。</p><div class="ip iq gp gr ir lo"><a href="https://github.com/PierfrancescoSoffritti/pierfrancescosoffritti.com/tree/master/src/components/home/header" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd jc gy z fp lt fr fs lu fu fw ja bi translated">PierfrancescoSoffritti/PierfrancescoSoffritti . com</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">React应用程序中Three.js的示例。</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">github.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc ix lo"/></div></div></a></div><p id="8510" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">您可以<a class="ae lm" href="https://www.npmjs.com/package/three" rel="noopener ugc nofollow" target="_blank">从npm </a>下载Three.js，并使用<em class="ln"> npm安装三个</em>或<em class="ln"> yarn添加三个</em>(如果您使用yarn而不是npm) <em class="ln">将其添加到您的应用程序中。</em></p><h2 id="947b" class="md me jb bd mf mg mh dn mi mj mk dp ml kz mm mn mo ld mp mq mr lh ms mt mu mv bi translated">反应组分</h2><p id="5403" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">首先，我们需要创建React组件来托管画布和Three.js应用程序。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="d091" class="md me jb ng b gy nk nl l nm nn">import React, { Component } from 'react';<br/>import threeEntryPoint from './threejs/threeEntryPoint';</span><span id="dcb3" class="md me jb ng b gy no nl l nm nn">export default class ThreeContainer extends Component {</span><span id="d7ce" class="md me jb ng b gy no nl l nm nn">  componentDidMount() {<br/>    threeEntryPoint(this.threeRootElement);<br/>  }</span><span id="dacc" class="md me jb ng b gy no nl l nm nn">  render () {<br/>      return (<br/>        &lt;div ref={element =&gt; this.threeRootElement = element} /&gt;<br/>      );<br/>  }<br/>}</span></pre><p id="fce6" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><em class="ln"> div </em>元素将是<em class="ln">画布</em>的容器(我更喜欢用Javascript创建<em class="ln">画布</em>，这样更灵活。但是您可以在这里轻松地创建它，而不是创建<em class="ln"> div </em>元素)。<br/>我使用<a class="ae lm" href="https://www.reactenlightenment.com/basic-react-components/6.9.html" rel="noopener ugc nofollow" target="_blank"> <em class="ln"> ref </em>属性</a>来获取对<em class="ln"> div </em>元素的引用。</p><p id="2e92" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">我正在将<em class="ln"> this.threeRootElement </em>(对<em class="ln"> div </em>的引用)传递给函数<em class="ln"> threeEntryPoint() </em>。当组件被挂载时，React自动调用函数<em class="ln"> componentDidMount() </em>时，调用该函数。</p><p id="e5b4" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">现在让我们看看三个入口点到底是什么。</p><h2 id="ed1c" class="md me jb bd mf mg mh dn mi mj mk dp ml kz mm mn mo ld mp mq mr lh ms mt mu mv bi translated">离开反应世界</h2><p id="c86d" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated"><em class="ln"> threeEntryPoint </em>是<em class="ln"> </em>活在React之外，不关心它的函数。据它所知，可以从任何web应用程序调用它，可以用任何框架构建，也可以根本不用框架。</p><p id="9610" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><em class="ln"> threeEntryPoint </em>是一个以dom元素为参数的函数，这个元素将是<em class="ln">画布</em>的容器。</p><p id="217c" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">功能<em class="ln">三个入口点</em>负责:</p><ol class=""><li id="7b8e" class="np nq jb ks b kt ku kw kx kz nr ld ns lh nt ll nu nv nw nx bi translated">创建画布</li><li id="a3c9" class="np nq jb ks b kt ny kw nz kz oa ld ob lh oc ll nu nv nw nx bi translated">绑定事件</li><li id="87b6" class="np nq jb ks b kt ny kw nz kz oa ld ob lh oc ll nu nv nw nx bi translated">创建Three.js对象</li><li id="a827" class="np nq jb ks b kt ny kw nz kz oa ld ob lh oc ll nu nv nw nx bi translated">开始渲染循环</li></ol><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="927b" class="md me jb ng b gy nk nl l nm nn">import SceneManager from './SceneManager';</span><span id="3fd6" class="md me jb ng b gy no nl l nm nn">export default containerElement =&gt; {<br/>  const canvas = createCanvas(document, containerElement);<br/>  const sceneManager = new SceneManager(canvas);<br/><br/>  bindEventListeners();<br/>  render();</span><span id="7c9c" class="md me jb ng b gy no nl l nm nn">  function createCanvas(document, containerElement) {<br/>    const canvas = document.createElement(‘canvas’);<br/>    containerElement.appendChild(canvas);<br/>    return canvas;<br/>  }</span><span id="e504" class="md me jb ng b gy no nl l nm nn">  function bindEventListeners() {<br/>    window.onresize = resizeCanvas;<br/>    resizeCanvas();<br/>  }</span><span id="9522" class="md me jb ng b gy no nl l nm nn">  function resizeCanvas() {<br/>    canvas.style.width = ‘100%’;<br/>    canvas.style.height= ‘100%’;</span><span id="1aee" class="md me jb ng b gy no nl l nm nn">    canvas.width = canvas.offsetWidth;<br/>    canvas.height = canvas.offsetHeight;</span><span id="07c2" class="md me jb ng b gy no nl l nm nn">    sceneManager.onWindowResize();<br/>  }</span><span id="3397" class="md me jb ng b gy no nl l nm nn">  function render(time) {<br/>    requestAnimationFrame(render);<br/>    sceneManager.update();<br/>  }<br/>}</span></pre><p id="4bab" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><em class="ln"> SceneManager </em>是负责Three.js逻辑的对象。是app的Three.js部分的入口(可以在我的<a class="ae lm" href="https://medium.com/@soffritti.pierfrancesco/how-to-organize-the-structure-of-a-three-js-project-77649f58fa3f" rel="noopener"> <em class="ln">实体/组件帖子</em> </a> <em class="ln">中了解更多关于<em class="ln"> SceneManager </em>)。</em></p><p id="c070" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">你可以在<em class="ln"> resizeCanvas() </em>中看到<em class="ln">画布</em>有100%的宽度和高度。这样做的话<em class="ln">画布</em>将填充它的容器元素。使用CSS可以很容易地调整容器的大小，就像您通常在处理任何元素时所做的那样。</p><h2 id="0db9" class="md me jb bd mf mg mh dn mi mj mk dp ml kz mm mn mo ld mp mq mr lh ms mt mu mv bi translated">三. js</h2><p id="3233" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated"><em class="ln"> SceneManager </em>是一个包含实际Three.js代码的函数。</p><p id="8ad9" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">正如您在下面的代码片段中看到的，该函数(在本例中，该函数没有名称，但它是一个场景管理器)接收一个<em class="ln">画布</em>并返回一个对象。该对象公开了必须在外部可见的函数，即公共函数。</p><p id="8ac8" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">(我没有复制粘贴所有的Three.js代码，因为它相当基础，通过阅读它的名称很容易理解每个函数是做什么的。如果你对细节感兴趣，你可以在我的<a class="ae lm" href="https://medium.com/@soffritti.pierfrancesco/how-to-organize-the-structure-of-a-three-js-project-77649f58fa3f" rel="noopener"> <em class="ln">实体/组件帖子</em> </a> <em class="ln">中找到完整的实现和解释。)</em></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e3d3" class="md me jb ng b gy nk nl l nm nn">import * as THREE from 'three';</span><span id="bdd8" class="md me jb ng b gy no nl l nm nn">export default canvas =&gt; {<br/>  const scene = buildScene(); <br/>  const renderer = buildRender(screenDimensions);<br/>  const camera = buildCamera(screenDimensions); <br/>  const sceneSubjects = createSceneSubjects(scene);</span><span id="a10e" class="md me jb ng b gy no nl l nm nn">  function buildScene() { //... }</span><span id="f67d" class="md me jb ng b gy no nl l nm nn">  function buildRender({ width, height }) { //... }</span><span id="648a" class="md me jb ng b gy no nl l nm nn">  function buildCamera({ width, height }) { //... }</span><span id="4076" class="md me jb ng b gy no nl l nm nn">  function createSceneSubjects(scene) { //... }</span><span id="3fff" class="md me jb ng b gy no nl l nm nn">  function update() { //... }</span><span id="d946" class="md me jb ng b gy no nl l nm nn">  function onWindowResize() { //... }</span><span id="c614" class="md me jb ng b gy no nl l nm nn">  return {<br/>    update,<br/>    onWindowResize<br/>  }<br/>}</span></pre><p id="ee74" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这种公私职能的模式只是个人的选择。也许看下面的片段会更容易理解:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="4a27" class="md me jb ng b gy nk nl l nm nn">export default params =&gt; {</span><span id="e328" class="md me jb ng b gy no nl l nm nn">  function publicMethod() { //... }</span><span id="6432" class="md me jb ng b gy no nl l nm nn">  function privateMethod() { //... }</span><span id="4a45" class="md me jb ng b gy no nl l nm nn">return {<br/>    publicMethod<br/>  }<br/>}</span></pre><p id="f137" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">如果你愿意，你可以使用<a class="ae lm" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes" rel="noopener ugc nofollow" target="_blank">类</a>(或者任何你个人喜欢的)来拥有私有和公共方法。你甚至可以把一切都公开。</p><h2 id="c1ea" class="md me jb bd mf mg mh dn mi mj mk dp ml kz mm mn mo ld mp mq mr lh ms mt mu mv bi translated">结论</h2><p id="6cc2" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">通过这种方法，您可以获得可移植的Three.js代码，这些代码可以在任何框架下使用，也可以不使用框架。您可以继续使用Three.js，就像您习惯使用常规HTML页面一样，同时享受React为您的web应用程序提供的清晰性和结构。</p></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><p id="1ddd" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">你能在哪里找到我？</p><p id="7d82" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在Twitter上关注我:<a class="ae lm" href="https://twitter.com/psoffritti" rel="noopener ugc nofollow" target="_blank">https://twitter.com/psoffritti</a><br/>我的网站/作品集:<a class="ae lm" href="http://pierfrancescosoffritti.com" rel="noopener ugc nofollow" target="_blank">pierfrancescosoffritti.com</a><br/>我的GitHub账号:<a class="ae lm" href="https://github.com/PierfrancescoSoffritti" rel="noopener ugc nofollow" target="_blank">https://github.com/PierfrancescoSoffritti</a><br/>我的LinkedIn账号:<a class="ae lm" href="https://www.linkedin.com/in/pierfrancescosoffritti/en" rel="noopener ugc nofollow" target="_blank">linkedin.com/in/pierfrancescosoffritti/en</a></p></div></div>    
</body>
</html>
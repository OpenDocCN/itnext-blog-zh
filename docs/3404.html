<html>
<head>
<title>What is: Linux keyring, gnome-keyring, Secret Service, and D-Bus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是:Linux密匙环，gnome密匙环，秘密服务，和D-Bus</h1>
<blockquote>原文：<a href="https://itnext.io/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus-349df9411e67?source=collection_archive---------1-----------------------#2019-12-07">https://itnext.io/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus-349df9411e67?source=collection_archive---------1-----------------------#2019-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/9f17767cb4a53967c0e91d1d9235862f.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/0*X3gn0-mlC4FKhBNP.jpg"/></div></figure><p id="7761" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是一篇很长的文章，我不确定是把它分成三部分还是把它们放在一起更好。一边是钥匙圈，另一边是D-Bus，最后是特勤局。</p><p id="f341" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最终，我决定把它们放在一起，因为我在相同的范围内搜索了所有的内容，它们彼此相关。</p><p id="82a0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，在这篇文章中，我们将讨论下一个问题:</p><ul class=""><li id="81d8" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><strong class="jw ir">钥匙圈</strong>到底是什么</li><li id="0ba3" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">Linux钥匙圈和<strong class="jw ir"> GNOME钥匙圈</strong>有什么区别，它们之间有什么联系吗</li><li id="0f63" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">有哪些密匙环实现</li><li id="35b8" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">什么是<code class="fe lg lh li lj b">org.freedesktop</code> <strong class="jw ir">特勤</strong>以及它与<strong class="jw ir">侏儒钥匙圈</strong>的关系</li><li id="6b9d" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">什么是<strong class="jw ir"> D-Bus </strong>，我们如何使用它来查看一个密匙环服务是如何工作的</li><li id="4b98" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">以及几个使用<strong class="jw ir"> Linux密匙环</strong>、<strong class="jw ir"> GNOME密匙环</strong>、<strong class="jw ir"> KWallet </strong>和<strong class="jw ir"> KeePass </strong>作为密匙环后端的例子</li></ul><p id="bff3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这篇文章绝对不是“如何配置它”的“教程”,而是对上面提到的组件的概述，试图理解它们是什么以及如何使用它们。</p><p id="0c06" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一个如何配置KeePass和GNOME Keyring的真实例子，我们会看到下面的帖子。</p><p id="7a51" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个帖子是由一个很长很长的谷歌搜索写的，所以这里会有很多使用过的文档和其他材料的链接。</p><p id="13d8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可能会混淆一些东西，甚至以错误的方式理解，所以如果你看到任何错误，请欢迎评论。</p><p id="26ff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">帖子的写作过程是这样的:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lk"><img src="../Images/433c503bafe9b4116fd8c942bd492675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eOYwNBAc_Va2SUBk.png"/></div></div></figure><h1 id="0d0d" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">内容</h1><ul class=""><li id="1167" class="ks kt iq jw b jx mr kb ms kf mt kj mu kn mv kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#What_is_the_Keyring" rel="noopener ugc nofollow" target="_blank">什么是钥匙圈？</a></li><li id="c7a4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#Linux_keyring_vs_gnome-keyring" rel="noopener ugc nofollow" target="_blank">Linux key ring vs gnome-key ring</a></li><li id="306c" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#Summary" rel="noopener ugc nofollow" target="_blank">总结</a></li><li id="1671" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#Keyrings_implementations" rel="noopener ugc nofollow" target="_blank">钥匙圈实施</a></li><li id="4bc2" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#Passwords_interception_from_the_gnome-keyting" rel="noopener ugc nofollow" target="_blank">从gnome-keying拦截密码</a></li><li id="20d3" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#What_is_the_Secret_Service" rel="noopener ugc nofollow" target="_blank">什么是特勤局？</a></li><li id="188c" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#The_Secret_Service_glossary" rel="noopener ugc nofollow" target="_blank">特勤局术语表</a></li><li id="6d04" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#D-Bus" rel="noopener ugc nofollow" target="_blank"> D-Bus </a></li><li id="cc87" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#D-Bus_tools" rel="noopener ugc nofollow" target="_blank"> D-Bus工具</a></li><li id="33b9" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#Keyrings_examples" rel="noopener ugc nofollow" target="_blank">钥匙圈示例</a></li><li id="20fa" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#Linux_keyring" rel="noopener ugc nofollow" target="_blank"> Linux钥匙圈</a></li><li id="4859" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#keyctl_syscall" rel="noopener ugc nofollow" target="_blank"> keyctl() syscall </a></li><li id="43af" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#gnome-keyring" rel="noopener ugc nofollow" target="_blank">侏儒钥匙圈</a></li><li id="a9b0" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#D-Bus_GetConnectionUnixProcessID" rel="noopener ugc nofollow" target="_blank">D-Bus GetConnectionUnixProcessID</a></li><li id="0ae8" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#python-keyring" rel="noopener ugc nofollow" target="_blank">蟒蛇皮钥匙圈</a></li><li id="ffae" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">秘密工具</li><li id="f7f3" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#KWallet" rel="noopener ugc nofollow" target="_blank"> KWallet </a></li><li id="6c56" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/#KeePass" rel="noopener ugc nofollow" target="_blank"> KeePass </a></li></ul><h2 id="8fd1" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">什么是钥匙圈？</h2><p id="7ee0" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">从“<strong class="jw ir">钥匙圈</strong>这个词到底是什么意思开始？</p><p id="93c2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">先说维基百科—<a class="ae mw" href="https://en.wikipedia.org/wiki/Keyring_(cryptography)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/key ring _(密码术)</a>:</p><blockquote class="nm nn no"><p id="18c0" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">在密码学中，密钥环存储已知的加密密钥(在某些情况下，还存储密码)。</p></blockquote><p id="ee37" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，让我们继续GNOME项目文档—<a class="ae mw" href="https://help.gnome.org/users/seahorse/stable/keyring.html.en" rel="noopener ugc nofollow" target="_blank">https://help . GNOME . org/users/sea horse/stable/key ring . html . en</a>:</p><blockquote class="nm nn no"><p id="080e" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">就像现实生活中的钥匙圈允许您将某些密钥集合在一起一样，密码和密钥中的钥匙圈允许您将密码和密钥放在不同的组中。</p></blockquote><p id="2533" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">甚至让我们来看看MySQL文档—<a class="ae mw" href="https://dev.mysql.com/doc/refman/5.7/en/keyring-service.html" rel="noopener ugc nofollow" target="_blank">https://dev . MySQL . com/doc/ref man/5.7/en/key ring-service . html</a>:</p><blockquote class="nm nn no"><p id="fb1a" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">一种密匙环服务，使内部服务器组件和插件能够安全地存储敏感信息以供以后检索</p></blockquote><p id="bd88" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，看看http://man7.org/linux/man-pages/man7/keyrings.7.html的<em class="np">钥匙圈(7) </em>手册页—<a class="ae mw" href="http://man7.org/linux/man-pages/man7/keyrings.7.html" rel="noopener ugc nofollow" target="_blank"/>:</p><blockquote class="nm nn no"><p id="202e" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">Linux密钥管理工具主要是各种内核组件在内核中保留或缓存安全数据、认证密钥、加密密钥和其他数据的一种方式。</p></blockquote><p id="d18c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，<strong class="jw ir">钥匙圈</strong> <em class="np">概念</em>——它是某种机制，或者设施，或者具体应用，意在存储一些机密数据。</p><p id="78c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">很好，让我们深入一点。</p><h2 id="49aa" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">Linux钥匙圈vs gnome-钥匙圈</h2><p id="0887" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">使用的有用链接:</p><ul class=""><li id="39e4" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><a class="ae mw" href="https://www.kernel.org/doc/Documentation/security/keys.txt" rel="noopener ugc nofollow" target="_blank">内核密钥保留服务</a></li><li id="5d2b" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://www.ict.griffith.edu.au/anthony/info/crypto/passwd_caching.txt" rel="noopener ugc nofollow" target="_blank">http://www . ICT . Griffith . edu . au/Anthony/info/crypto/passwd _ caching . txt</a></li><li id="0a50" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://www.ict.griffith.edu.au/anthony/info/crypto/" rel="noopener ugc nofollow" target="_blank">http://www.ict.griffith.edu.au/anthony/info/crypto/</a></li><li id="2acc" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://wiki.gnome.org/Projects/GnomeKeyring" rel="noopener ugc nofollow" target="_blank">https://wiki.gnome.org/Projects/GnomeKeyring</a></li><li id="df51" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://wiki.archlinux.org/index.php/GNOME/Keyring" rel="noopener ugc nofollow" target="_blank">https://wiki.archlinux.org/index.php/GNOME/Keyring</a></li></ul><p id="d328" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，让我们谈谈<strong class="jw ir"> Linux内核密匙环</strong>和<strong class="jw ir"> GNOME密匙环</strong>之间的区别:起初，当我暗示GNOME密匙环以某种方式使用内核的密匙环工具时，我感到困惑，但现在——这只是不同的事情。</p><p id="55b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们回到第七代Linux钥匙圈:</p><blockquote class="nm nn no"><p id="cbb9" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">密钥环——内核密钥管理和保留工具</p></blockquote><p id="04e7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">即<em class="np"> Linux密匙环</em> —它是内核的机制，提供存储秘密信息的能力。</p><p id="1547" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，让我们阅读<code class="fe lg lh li lj b"><a class="ae mw" href="https://wiki.gnome.org/Projects/GnomeKeyring" rel="noopener ugc nofollow" target="_blank">gnome-keyring</a></code>文档:</p><blockquote class="nm nn no"><p id="1838" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">GNOME Keyring是GNOME中的一个组件集合，它存储秘密、密码、密钥、证书，并使它们对应用程序可用。</p></blockquote><p id="ad01" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，<em class="np">GNOME key ring</em>——是一个存储机密数据的实用程序(<code class="fe lg lh li lj b">gnome-keyring-daemon</code>、库、<code class="fe lg lh li lj b">seahorse</code>包等)的集合。参见<a class="ae mw" href="https://wiki.gnome.org/Projects/GnomeKeyring/Architecture" rel="noopener ugc nofollow" target="_blank"> GNOME钥匙圈架构</a>。</p><p id="654a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好的文档也可以在这里找到——<a class="ae mw" href="http://www.ict.griffith.edu.au/anthony/info/crypto/" rel="noopener ugc nofollow" target="_blank">塔楼——加密</a>，具体参见<a class="ae mw" href="http://www.ict.griffith.edu.au/anthony/info/crypto/passwd_caching.txt" rel="noopener ugc nofollow" target="_blank">缓存密码</a>文档。</p><p id="f59a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">摘要</p><p id="f4da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们总结一下<em class="np"> Linux钥匙圈</em>和<em class="np"> GNOME钥匙圈</em>的主要区别:</p><ul class=""><li id="663b" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">main():</li><li id="8ed2" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">Linux内核——是内核的“密码缓存”工具——它在活动用户/系统会话期间将密码存储在计算机内存中</li><li id="0db4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b">gnome-keyring</code> -是将数据保存在硬盘上的持久存储</li><li id="e3bf" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">存储:</li><li id="49d7" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">Linux key ring——存储在RAM中，因此密码只在会话期间可用，没有必要总是存储它们</li><li id="71a1" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b">gnome-keyring</code> -在磁盘上创建一个文件，通常在<code class="fe lg lh li lj b">~/.local/share/keyrings/</code></li><li id="d215" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">访问:</li><li id="0381" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">Linux密匙环——通过从用户空间到内核空间的系统调用</li><li id="75d4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b">gnome-keyring</code> -途经DBus</li><li id="ec13" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">要访问的应用程序:</li><li id="92bb" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">Linux内核— <code class="fe lg lh li lj b">keyctl</code>、<code class="fe lg lh li lj b">systemd-ask-password</code>等</li><li id="a74b" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b">gnome-keyring</code> - <code class="fe lg lh li lj b"><a class="ae mw" href="http://manpages.ubuntu.com/manpages/bionic/man1/secret-tool.1.html" rel="noopener ugc nofollow" target="_blank">secret-tool</a></code>，像<code class="fe lg lh li lj b"><a class="ae mw" href="https://pypi.org/project/keyring/" rel="noopener ugc nofollow" target="_blank">python-keyring</a></code>、<code class="fe lg lh li lj b"><a class="ae mw" href="https://wiki.gnome.org/Apps/Seahorse" rel="noopener ugc nofollow" target="_blank">seahorse</a></code>等库</li></ul><h2 id="6360" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">钥匙圈实施</h2><ul class=""><li id="2160" class="ks kt iq jw b jx mr kb ms kf mt kj mu kn mv kr kx ky kz la bi translated"><a class="ae mw" href="https://utils.kde.org/projects/kwalletmanager/" rel="noopener ugc nofollow" target="_blank"> KWallet </a></li><li id="7984" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://wiki.gnome.org/Projects/GnomeKeyring" rel="noopener ugc nofollow" target="_blank">侏儒钥匙圈</a></li></ul><p id="013a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">除此之外，<code class="fe lg lh li lj b"><a class="ae mw" href="https://pypi.org/project/keyring/" rel="noopener ugc nofollow" target="_blank">python-keyring</a></code>提一下:</p><ul class=""><li id="ee62" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">g Sheet-keyring——一个在谷歌表单中存储秘密的后端。与<a class="ae mw" href="https://pypi.org/project/ipython-secrets" rel="noopener ugc nofollow" target="_blank"> ipython-secrets </a>一起使用。</li><li id="0d08" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://pypi.org/project/bitwarden-keyring/0.1.0/" rel="noopener ugc nofollow" target="_blank"> bitwarden-keyring </a> —在<a class="ae mw" href="https://bitwarden.com/" rel="noopener ugc nofollow" target="_blank"> BitWarden </a>密码管理器中存储秘密的后端。</li></ul><p id="d1b9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">而且这个名单还不全。</p><p id="17b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，还有许多客户端应用程序要与这些密匙环一起使用，同样，列表也不完整:</p><ul class=""><li id="f89a" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://wiki.gnome.org/Projects/Libsecret" rel="noopener ugc nofollow" target="_blank">libsecret</a></code></li><li id="8d59" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://pypi.org/project/keyring/" rel="noopener ugc nofollow" target="_blank">python-keyring</a></code></li><li id="3a83" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">Java-клиент <a class="ae mw" href="https://github.com/swiesend/secret-service" rel="noopener ugc nofollow" target="_blank">特勤局</a></li><li id="a4dc" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://inqlude.org/libraries/qtkeychain.html" rel="noopener ugc nofollow" target="_blank">qtkeychain</a></code></li><li id="7b02" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="http://manpages.ubuntu.com/manpages/bionic/man1/secret-tool.1.html" rel="noopener ugc nofollow" target="_blank">secret-tool</a></code></li><li id="d246" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://pypi.org/project/SecretStorage/" rel="noopener ugc nofollow" target="_blank">SecretStorage</a></code>图书馆</li></ul><h2 id="e341" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">从<code class="fe lg lh li lj b">gnome-keyting</code>拦截密码</h2><p id="deaf" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">在谷歌搜索的时候，在这里发现了一个有趣的bug讨论——<a class="ae mw" href="https://bugs.launchpad.net/ubuntu/+source/gnome-keyring/+bug/1780365" rel="noopener ugc nofollow" target="_blank">https://bugs . launch pad . net/Ubuntu/+source/gnome-keyring/+bug/1780365</a></p><p id="fad5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">简而言之:</p><ol class=""><li id="2f26" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr nt ky kz la bi translated">客户端和服务通过D-Bus进行通信</li><li id="dcef" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr nt ky kz la bi translated">一个客户向特勤局索要一些数据(在这个案例中是T7)</li><li id="6b01" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr nt ky kz la bi translated">该服务通过D-Bus发送机密数据</li><li id="68c4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr nt ky kz la bi translated">另一个“坏”进程监听dbus消息并截获密码</li></ol><h2 id="6538" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">什么是特勤局？</h2><p id="f353" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">另一个我不得不谷歌的概念是:什么是“特勤局”？它与GNOME钥匙圈和KWallet有什么关系？</p><p id="4db3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它在Linux中做什么，我怎样才能接触到它？</p><p id="be57" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，我们再来看文档—<a class="ae mw" href="https://specifications.freedesktop.org/secret-service/latest/ch01.html" rel="noopener ugc nofollow" target="_blank">https://specifications . free desktop . org/secret-service/latest/ch01 . html</a>:</p><blockquote class="nm nn no"><p id="4b96" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">Secret Service API允许客户端应用程序将机密安全地存储在用户登录会话中运行的服务中。</p></blockquote><p id="784b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">啊哈，即<em class="np">秘密服务</em>——它不是某个特定的服务或应用程序，但它是一种规范，一种由GNOME和KDE项目创建的RFC，用于确定对于想要使用GNOME Keyring或KWallet存储他们的秘密的客户端，该API必须如何实现。</p><p id="e1d9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，秘密服务API不仅受GNOME Keyring和KWallet支持，还受KeePass和其他应用程序的支持。</p><p id="252b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嗯，有点令人困惑的是<em class="np">特勤局</em>的名字本身——“一个隐藏的服务”。如果把它叫做<em class="np">Secret</em><strong class="jw ir"><em class="np">s</em></strong><em class="np">Service</em>，即“a secrets data的服务”，那就清楚多了。</p><h2 id="b8e5" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">特勤局词汇表</h2><p id="8919" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">简而言之:</p><ul class=""><li id="53e4" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><a class="ae mw" href="https://specifications.freedesktop.org/secret-service/latest/ch02.html" rel="noopener ugc nofollow" target="_blank"> secret </a>:密码本身，或者任何其他秘密数据</li><li id="3a36" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://specifications.freedesktop.org/secret-service/latest/ch03.html" rel="noopener ugc nofollow" target="_blank">项</a>:每个这样的秘密加上它的一组属性组成一个<em class="np">项</em></li><li id="2d9d" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">集合:一组这样的物品构成一个集合(类似于钥匙圈或钱包的概念)</li><li id="c7b7" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">由D-Bus对象表示的集合和项目，每个都有其唯一的路径</li><li id="5eee" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://specifications.freedesktop.org/secret-service/latest/ch12.html" rel="noopener ugc nofollow" target="_blank">默认集合</a>:没有特殊条件的客户端应用程序必须将项目保存到默认集合，该集合必须可以通过<code class="fe lg lh li lj b">/org/freedesktop/secrets/aliases/default</code> D-Bus路径访问</li></ul><h2 id="39cc" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">d总线</h2><p id="a469" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">好吧…</p><p id="aa71" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在不是回忆前面部分中经常提到的D总线以及如何处理它的时候。</p><p id="f540" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，Linux内核IPC上的D-Bus—<em class="np">进程间通信</em> —机制，允许操作系统内部的独立进程相互通信。</p><p id="ab11" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有用的链接:</p><ul class=""><li id="16d0" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">文档—<a class="ae mw" href="https://techbase.kde.org/Development/Tutorials/D-Bus/Introduction" rel="noopener ugc nofollow" target="_blank">https://tech base . kde . org/Development/Tutorials/D-Bus/Introduction</a></li><li id="b11d" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">又一个doc:<a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-tutorial.html" rel="noopener ugc nofollow" target="_blank">https://dbus.freedesktop.org/doc/dbus-tutorial.html</a></li><li id="fc38" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">关于D-Bus传输:<a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-specification.html#transports" rel="noopener ugc nofollow" target="_blank">https://dbus . free desktop . org/doc/dbus-specification . html # transports</a></li><li id="6549" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://blog.siphos.be/2014/06/d-bus-quick-recap/" rel="noopener ugc nofollow" target="_blank"> D-Bus，快速回顾</a></li><li id="1c58" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://lists.freedesktop.org/archives/dbus/2008-July/010019.html" rel="noopener ugc nofollow" target="_blank">D-Bus和URI命名空间之间的通用标准映射</a></li><li id="ac0e" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://developer.gnome.org/gio//2.28/gio-D-Bus-Addresses.html" rel="noopener ugc nofollow" target="_blank"> D总线地址— D总线连接端点</a></li></ul><p id="ecfb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">简要介绍D-Bus中的主要概念和术语:</p><ul class=""><li id="4508" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><strong class="jw ir"> D-Bus一般来说</strong>:它是IPC的“总线”，即如果在之前的SSH示例(参见<a class="ae mw" href="https://rtfm.co.ua/en/ssh-rsa-keys-and-ssh-agent-for-ssh-keys-and-their-passwords-management/" rel="noopener ugc nofollow" target="_blank"> SSH: RSA keys和ssh-agent for SSH keys及其密码管理</a>帖子)中使用了UNIX套接字，这次我们使用的是总线机制，参见<a class="ae mw" href="https://www.kernel.org/doc/html/latest/driver-api/driver-model/bus.html" rel="noopener ugc nofollow" target="_blank">https://www . kernel . org/doc/html/latest/driver-API/driver-model/Bus . html</a>。反过来，这些公共汽车可以</li><li id="b8f5" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">会话总线</li><li id="32be" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">系统总线</li><li id="fc3d" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">私人巴士</li><li id="07f4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw ir">消息</strong>:基本通信单元，类似于TCP/IP的数据传输，只是在D-Bus中，消息的所有数据都包含在消息中，而不是分割在TCP包中</li><li id="e3c6" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">当一个消息被发送时，它通常会导致某个方法被提供该方法的应用程序调用来执行某些操作</li><li id="0515" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">应用程序可以向自己发送消息</li><li id="b81a" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw ir">名称空间</strong>和<strong class="jw ir">地址</strong>:</li><li id="ed47" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">由于不同的应用程序可以放在同一条总线上(或“监听同一条总线”)，并且在此期间，同一应用程序可以提供各种可以接受消息的对象，因此需要某种方法来处理这些消息。在D-Bus中，这样的地址由接口名+服务名+对象名组成</li><li id="9722" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">一个名称空间示例— <em class="np"> org.freedesktop.dbus </em></li><li id="8655" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">地址示例—<em class="np">UNIX:tmpdir =/tmp/my-app-name</em></li><li id="0785" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw ir">接口</strong>:特定对象的特定总线上的一组方法和信号。您可以将接口视为命名的方法和信号组。</li><li id="ca8b" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">大多数接口将导致用于应用程序的语言的具体构造，例如，它可以是Java接口或с++中的虚拟类</li><li id="65fc" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">一个接口示例—<em class="np">org . free desktop . introspect</em></li><li id="b2ae" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">服务:代表特定应用程序到总线的具体连接</li><li id="14d7" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">在<em class="np">服务下</em>这里指的是一个总线名称(在<a class="ae mw" href="https://techbase.kde.org/Development/Tutorials/D-Bus/Introduction#Namespaces_and_Addresses" rel="noopener ugc nofollow" target="_blank">起源</a> — <em class="np">“众所周知的”总线名称</em>)，但是要记住这里的“总线名称”意味着一个特定的连接名称，而不是总线名称</li><li id="7513" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">如果一个应用程序有不止一个到总线的连接，或者如果该应用程序运行在多种类型的实例中——例如，通过一个PID号来扩展，以使其唯一</li><li id="5f2f" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">一个服务实例— <em class="np"> org.kde.screensaver </em></li><li id="fe3a" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw ir">对象</strong>:同一个应用程序可以提供对其多个对象的访问，使用路径来分隔这些对象。与服务相关联的每个这样的路径代表一个专用对象，例如<code class="fe lg lh li lj b">/MainInterface</code>或<code class="fe lg lh li lj b">/Documents/Doc1</code>。对象允许访问接口，并且同一个对象可以同时提供对多个接口的访问</li><li id="0f62" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">参见<a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-tutorial.html#objects" rel="noopener ugc nofollow" target="_blank">https://dbus.freedesktop.org/doc/dbus-tutorial.html#objects</a></li><li id="2443" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw ir">方法</strong>:每个对象都有两种类型的成员——方法和信号</li><li id="d094" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">方法—发送到对象的ate消息，用于触发创建该对象的应用程序中的某些操作</li><li id="c775" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">方法可以将数据传递给应用程序的输入，并可以从应用程序返回包含一些值的输出</li><li id="23ab" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">方法总是有发送方和接收方地址</li><li id="ca68" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw ir">信号</strong>:</li><li id="5409" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">类似于这些方法，但是不依赖于任何特定的目的地，并且可以被同一总线上的任何应用程序接受</li><li id="fa0b" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">由导出接口的应用程序生成</li></ul><h2 id="a25b" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">d总线工具</h2><p id="b350" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">CLI:</p><ul class=""><li id="62ad" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="http://manpages.ubuntu.com/manpages/trusty/man1/qdbus.1.html" rel="noopener ugc nofollow" target="_blank">qdbus</a></code> -通过D-Bus观看和发送信息</li><li id="d4db" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-monitor.1.html" rel="noopener ugc nofollow" target="_blank">dbus-monitor</a></code> -查看公交活动</li><li id="a41a" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b">dbus-send</code> -通过D-Bus发送信息</li></ul><p id="0bc0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">图形用户界面:</p><ul class=""><li id="67f5" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://doc.qt.io/qt-5/qdbusviewer.html" rel="noopener ugc nofollow" target="_blank">qdbusviewer</a></code> -查看对象和消息，是<code class="fe lg lh li lj b">qt5-tools </code>设置的一部分</li><li id="cd24" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://wiki.gnome.org/Apps/DFeet" rel="noopener ugc nofollow" target="_blank">d-feet</a></code> - D总线调试器</li><li id="6ca6" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="https://gitlab.freedesktop.org/bustle/bustle" rel="noopener ugc nofollow" target="_blank">bustle</a></code> - D总线消息分析器和分析器</li></ul><p id="31d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">例如<code class="fe lg lh li lj b">d-feet</code>，安装它:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="9578" class="mx lu iq lj b gy ny nz l oa ob">$ sudo pacman -S d-feet</span></pre><p id="e605" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行它:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi oc"><img src="../Images/057ce20b2970aa0b94a074715f5032e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PVwG2QtqUu7CbQvx.png"/></div></div></figure><h2 id="6abd" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">钥匙圈示例</h2><p id="1449" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">以及一些如何从Python或CLI实用程序中使用这些后端的示例。</p><h2 id="a309" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">Linux钥匙圈</h2><p id="9691" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">如前所述，Linux密匙环是内核中的一种“缓存服务”。</p><p id="fe49" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以从<code class="fe lg lh li lj b">keyutils</code>和<code class="fe lg lh li lj b">systemd-ask-password</code>中使用<code class="fe lg lh li lj b">keyctl</code>实用程序。</p><p id="7214" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">阅读:</p><ul class=""><li id="0a39" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><a class="ae mw" href="https://www.kernel.org/doc/Documentation/security/keys.txt" rel="noopener ugc nofollow" target="_blank">内核密钥保留服务文档</a></li><li id="2126" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><code class="fe lg lh li lj b"><a class="ae mw" href="http://man7.org/linux/man-pages/man1/keyctl.1.html" rel="noopener ugc nofollow" target="_blank">keyctl</a></code> <a class="ae mw" href="http://man7.org/linux/man-pages/man1/keyctl.1.html" rel="noopener ugc nofollow" target="_blank"> doc </a></li></ul><p id="9f3d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从文档中可以看出:</p><blockquote class="nm nn no"><p id="7d08" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">每个进程订阅三个密匙环:特定于线程的密匙环、特定于进程的密匙环和特定于会话的密匙环。</p></blockquote><p id="ef74" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们看看哪些钥匙圈可用于我当前的会话:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="4936" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl show @s<br/>Session Keyring<br/>185597501 — alswrv 1000 1000 keyring: _ses<br/>182944921 — alswrv 1000 65534 \_ keyring: _uid.1000</span></pre><p id="1217" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者对于我的用户:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="d62b" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl show @u<br/>Keyring<br/>182944921 — alswrv 1000 65534 keyring: _uid.1000</span></pre><p id="6759" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，在<code class="fe lg lh li lj b">/proc/key-users</code>中，您可以获得所有钥匙圈的信息以及每个用户的统计数据:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="9d51" class="mx lu iq lj b gy ny nz l oa ob">$ cat /proc/key-users<br/>0: 43 42/42 34/1000000 768/25000000<br/>971: 1 1/1 1/200 9/20000<br/>1000: 4 4/4 4/200 46/20000</span></pre><p id="0e2e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以及可供我们的进程读取的密钥(称为<code class="fe lg lh li lj b">cat</code>的<code class="fe lg lh li lj b">bash</code>):</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="583f" class="mx lu iq lj b gy ny nz l oa ob">$ cat /proc/keys<br/>008f6a74 I — Q — — 1 perm 1f3f0000 1000 65534 keyring _uid_ses.1000: 1<br/>0ae78499 I — Q — — 4 perm 1f3f0000 1000 65534 keyring _uid.1000: empty<br/>0b0ffe3d I — Q — — 225 perm 3f030000 1000 1000 keyring _ses: 1<br/>2a28e4fe I — Q — — 33 perm 3f030000 1000 1000 keyring _ses: 1</span></pre><p id="6909" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当前会话中用户的密钥环:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="447b" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl describe @us<br/>-5: -lswrvalswrv — — — — — — 1000 65534 keyring: _uid_ses.1000</span></pre><p id="96fa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当前密钥环中的密钥:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="9f86" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl list @us<br/>1 key in keyring:<br/>182944921: — alswrv 1000 65534 keyring: _uid.1000</span></pre><p id="a8c1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">添加密钥:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="2dfc" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl add user example-key example-data @u<br/>546850615</span></pre><p id="3379" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">找到它:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="05e7" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl request user example-key<br/>546850615</span></pre><p id="7c33" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">已获得其ID，现在可以使用此ID读取其内容:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="82d6" class="mx lu iq lj b gy ny nz l oa ob">$ keyctl print 546850615<br/>example-data</span></pre><p id="6e8d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe lg lh li lj b">keyctl()</code>系统调用</p><p id="c51e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">实际上，<code class="fe lg lh li lj b">keyctl</code>实用程序只是执行<code class="fe lg lh li lj b"><a class="ae mw" href="http://man7.org/linux/man-pages/man2/keyctl.2.html" rel="noopener ugc nofollow" target="_blank">keyctl(2)</a></code>系统调用:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="d3a2" class="mx lu iq lj b gy ny nz l oa ob">$ strace -e keyctl keyctl print 546850615<br/>keyctl(KEYCTL_READ, 546850615, NULL, 0) = 12<br/>keyctl(KEYCTL_READ, 546850615, “example-data”, 12) = 12<br/>example-data<br/>+++ exited with 0 +++</span></pre><p id="7f82" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这里的第一个调用中——<code class="fe lg lh li lj b">keyctl(KEYCTL_READ, 546850615, NULL, 0) = 12</code>——我们通过传递<code class="fe lg lh li lj b">KEYCTL_READ</code>操作和一个密钥ID来执行<code class="fe lg lh li lj b">keyctl()</code>系统调用。</p><p id="273c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好的——这里或多或少清楚了。</p><p id="594d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里使用的材料:</p><ul class=""><li id="1362" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><a class="ae mw" href="https://www.kernel.org/doc/Documentation/security/keys.txt" rel="noopener ugc nofollow" target="_blank">https://www.kernel.org/doc/Documentation/security/keys.txt</a></li><li id="e537" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://www.ibm.com/developerworks/library/l-key-retention/" rel="noopener ugc nofollow" target="_blank">https://www.ibm.com/developerworks/library/l-key-retention/</a></li><li id="972c" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://man7.org/linux/man-pages/man7/keyrings.7.html" rel="noopener ugc nofollow" target="_blank">http://man7.org/linux/man-pages/man7/keyrings.7.html</a></li><li id="e90f" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://man7.org/linux/man-pages/man1/keyctl.1.html" rel="noopener ugc nofollow" target="_blank">http://man7.org/linux/man-pages/man1/keyctl.1.html</a></li><li id="d2d8" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://man7.org/linux/man-pages/man2/keyctl.2.html" rel="noopener ugc nofollow" target="_blank">http://man7.org/linux/man-pages/man2/keyctl.2.html</a></li></ul><p id="f501" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们去钥匙圈仓库吧。</p><h2 id="1653" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated"><code class="fe lg lh li lj b">gnome-keyring</code></h2><p id="9370" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">对我来说，这确实是一个有问题的包，但它仍然是应用最广泛的。</p><p id="26da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果尚不存在，请安装:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="c9cd" class="mx lu iq lj b gy ny nz l oa ob">$ sudo pacman -S gnome-keyring</span></pre><p id="97f7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查D-Bus服务—寻找<code class="fe lg lh li lj b">org.freedesktop.secrets</code>:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="c35d" class="mx lu iq lj b gy ny nz l oa ob">$ dbus-send — session — dest=org.freedesktop.DBus — type=method_call — print-reply /org/freedesktop/DBus org.freedesktop.DBus.ListNames<br/>…<br/>string “org.freedesktop.secrets”<br/>…</span></pre><p id="24e6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">“啊哈，我们到了”</p><p id="91c0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们可以通过使用<code class="fe lg lh li lj b"><a class="ae mw" href="https://www.gnu.org/software/emacs/manual/html_node/dbus/Introspection.html" rel="noopener ugc nofollow" target="_blank">org.freedesktop.DBus.Introspectable.Introspect</a></code>方法获得服务描述:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="49cc" class="mx lu iq lj b gy ny nz l oa ob">$ dbus-send — session — print-reply — dest=org.freedesktop.DBus /org/freedesktop/secrets org.freedesktop.DBus.Introspectable.Introspect<br/>…<br/>&lt;node&gt;<br/>&lt;interface name=”org.freedesktop.DBus”&gt;<br/>&lt;method name=”Hello”&gt;<br/>&lt;arg direction=”out” type=”s”/&gt;<br/>&lt;/method&gt;<br/>&lt;method name=”RequestName”&gt;<br/>&lt;arg direction=”in” type=”s”/&gt;<br/>&lt;arg direction=”in” type=”u”/&gt;<br/>&lt;arg direction=”out” type=”u”/&gt;<br/>&lt;/method&gt;<br/>&lt;method name=”ReleaseName”&gt;<br/>&lt;arg direction=”in” type=”s”/&gt;<br/>&lt;arg direction=”out” type=”u”/&gt;<br/>&lt;/method&gt;<br/>…</span></pre><p id="6a36" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者使用<code class="fe lg lh li lj b">qdbus</code>，首先找到服务:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="9296" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus | grep ‘secrets\|keyring’<br/>org.freedesktop.secrets<br/>org.gnome.keyring</span></pre><p id="d7f7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">阅读<code class="fe lg lh li lj b">qdbus</code>帮助:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="ab5a" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus — help<br/>…<br/>With 0 arguments, qdbus will list the services available on the bus<br/>With just the servicename, qdbus will list the object paths available on the service<br/>With service name and object path, qdbus will list the methods, signals and properties available on the object</span></pre><p id="f8ef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并获得完整服务的描述:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="8d04" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus org.freedesktop.secrets /org/freedesktop/secrets<br/>signal void org.freedesktop.DBus.Properties.PropertiesChanged(QString interface_name, QVariantMap changed_properties, QStringList invalidated_properties)<br/>method QDBusVariant org.freedesktop.DBus.Properties.Get(QString interface_name, QString property_name)<br/>method QVariantMap org.freedesktop.DBus.Properties.GetAll(QString interface_name)<br/>method void org.freedesktop.DBus.Properties.Set(QString interface_name, QString property_name, QDBusVariant value)<br/>method QString org.freedesktop.DBus.Introspectable.Introspect()<br/>method QString org.freedesktop.DBus.Peer.GetMachineId()<br/>method void org.freedesktop.DBus.Peer.Ping()<br/>…</span></pre><p id="2e56" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">d总线<code class="fe lg lh li lj b">GetConnectionUnixProcessID</code></p><p id="f85e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">实际上，我想看看谁在公共汽车的另一边听着。让我们为此使用<code class="fe lg lh li lj b"><a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-java/api/org/freedesktop/DBus.html#GetConnectionUnixProcessID(java.lang.String)" rel="noopener ugc nofollow" target="_blank">GetConnectionUnixProcessID</a></code>方法:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="f373" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus — session org.freedesktop.DBus / org.freedesktop.DBus.GetConnectionUnixProcessID org.freedesktop.secrets<br/>1278791</span></pre><p id="ce66" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们在这里做了:</p><ul class=""><li id="6fa3" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">对org.freedesktop.DBus服务的调用</li><li id="0b93" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">传递/路径</li><li id="f173" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">称为<code class="fe lg lh li lj b">org.freedesktop.DBus.GetConnectionUnixProcessID</code>方法</li><li id="a1c4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">并将服务名<em class="np">org . free desktop . secrets</em>传递给该方法以获取其PID</li></ul><p id="bfcd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查什么是<em class="np"> 1278791 </em> PID:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="5729" class="mx lu iq lj b gy ny nz l oa ob">$ ps xu | grep 1278791<br/>setevoy 1278791 0.0 0.0 383876 8092 ? SLl Dec03 0:00 /usr/bin/gnome-keyring-daemon — start — foreground — components=secrets</span></pre><p id="b740" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">很好。</p><p id="19e7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，现在我们知道特勤局的角色是由<code class="fe lg lh li lj b">gnome-keyring</code>应用程序扮演的。让我们尝试使用<code class="fe lg lh li lj b">python-keyring</code>和<code class="fe lg lh li lj b">secret-tool</code>添加和删除一些数据。</p><p id="e625" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe lg lh li lj b">python-keyring</code></p><p id="9df0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从<code class="fe lg lh li lj b">python-keyring</code>开始。</p><p id="a6f1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">安装它:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="2749" class="mx lu iq lj b gy ny nz l oa ob">$ sudo pacman -S python-keyring</span></pre><p id="46b2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="b0ce" class="mx lu iq lj b gy ny nz l oa ob">&gt;&gt;&gt; import keyring<br/>&gt;&gt;&gt; keyring.set_password(“system”, “username”, “password”)<br/>&gt;&gt;&gt; keyring.get_password(“system”, “username”)<br/>‘password’</span></pre><p id="3078" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果出现类似这样的错误(例如，在Arch Linux上安装后第一次运行时可能发生):</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="d830" class="mx lu iq lj b gy ny nz l oa ob">&gt;&gt;&gt; keyring.set_password(“system”, “username”, “password”)<br/>Traceback (most recent call last):<br/>…<br/>jeepney.wrappers.DBusErrorResponse: [org.freedesktop.DBus.Error.UnknownMethod] (‘No such interface “org.freedesktop.DBus.Properties” on object at path /org/freedesktop/secrets/collection/login’,)</span></pre><p id="407b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="f038" class="mx lu iq lj b gy ny nz l oa ob">Traceback (most recent call last):<br/>…<br/>raise PromptDismissedException(‘Prompt dismissed.’)<br/>secretstorage.exceptions.PromptDismissedException: Prompt dismissed.</span></pre><p id="ca2f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您需要执行<code class="fe lg lh li lj b">/etc/X11/xinit/xinitrc.d/50-systemd-user.sh</code>脚本:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="7039" class="mx lu iq lj b gy ny nz l oa ob">$ . /etc/X11/xinit/xinitrc.d/50-systemd-user.sh</span></pre><p id="b9a8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">创建一个新的密匙环并为其设置密码:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi od"><img src="../Images/80f28e59399b04124f0343b5812e73f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r_QvyN0C67r68L6N.png"/></div></div></figure><p id="321f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们检查一下<code class="fe lg lh li lj b">dbus-monitor</code>，看看D-Bus中发生了什么:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="7bdb" class="mx lu iq lj b gy ny nz l oa ob">…<br/>method call time=1575542111.465749 sender=:1.576 -&gt; destination=org.freedesktop.secrets serial=7 path=/org/freedesktop/secrets/aliases/default; interface=org.freedesktop.Secret.Collection; member=CreateItem<br/>array [<br/>dict entry(<br/>string “org.freedesktop.Secret.Item.Attributes”<br/>variant array [<br/>dict entry(<br/>string “application”<br/>string “Python keyring library”<br/>)<br/>dict entry(<br/>string “service”<br/>string “system”<br/>)<br/>dict entry(<br/>string “username”<br/>string “username”<br/>)<br/>]<br/>)<br/>dict entry(<br/>string “org.freedesktop.Secret.Item.Label”<br/>variant string “Password for ‘username’ on ‘system’”<br/>)<br/>]<br/>…<br/>struct {<br/>object path “/org/freedesktop/secrets/session/s14”<br/>}<br/>…<br/>signal time=1575542111.476006 sender=:1.220 -&gt; destination=(null destination) serial=689 path=/org/freedesktop/secrets/collection/example_2dkeyring; interface=org.freedesktop.Secret.Collection; member=ItemCreated<br/>object path “/org/freedesktop/secrets/collection/example_2dkeyring/5”<br/>…</span></pre><p id="2b0f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里:</p><ol class=""><li id="302a" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr nt ky kz la bi translated"><em class="np"> sender=:1.576 </em> —在D-Bus服务列表中找到1.576—这是我们的Python ( <code class="fe lg lh li lj b">cmd: python</code>):</li></ol><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi oe"><img src="../Images/b2763233fd72aeb925694902b5e5b7f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WO9F9VUBY7uzUzRk.png"/></div></div></figure><ol class=""><li id="d69c" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr nt ky kz la bi translated"><em class="np">destination = org . free desktop . secrets</em><br/>我们的<code class="fe lg lh li lj b">/usr/bin/gnome-keyring-daemon</code>，已经在<code class="fe lg lh li lj b">org.freedesktop.DBus.GetConnectionUnixProcessID</code>输出中看到了</li></ol><p id="9f14" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用<code class="fe lg lh li lj b">seahorse</code>实用程序检查<code class="fe lg lh li lj b">gnome-keyring</code>存储，例如:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/52e6272ff51e91e98276ff1ce7f1a407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*28E7VaExbm7h4pGF.png"/></div></figure><p id="08da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好的，<em class="np">“管用！”</em>。</p><p id="579d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe lg lh li lj b">secret-tools</code></p><p id="535d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另一种方法可以是使用<code class="fe lg lh li lj b">secret-tools</code>实用程序。</p><p id="29d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">添加新的秘密:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="a932" class="mx lu iq lj b gy ny nz l oa ob">$ secret-tool store — label=SecretToolExample username username service secret<br/>Password:</span></pre><p id="e6e6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检索它:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="5a40" class="mx lu iq lj b gy ny nz l oa ob">$ secret-tool lookup username username service secret<br/>password</span></pre><p id="f081" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查仓库里的海马:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/e2290a3cfd32c5b7e3217ef628f046f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/0*yRSJHPQ0stdM8Iym.png"/></div></figure><h2 id="d2d6" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">KWallet</h2><p id="19d1" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">安装:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="1d3f" class="mx lu iq lj b gy ny nz l oa ob">$ sudo pacman -S kwallet</span></pre><p id="0cd2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查D总线:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="c1c6" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus — session org.freedesktop.DBus / org.freedesktop.DBus.GetConnectionUnixProcessID org.freedesktop.secrets<br/>1278791<br/>$ ps aux | grep 1278791<br/>setevoy 1278791 0.0 0.0 384008 8048 ? SLl Dec03 0:00 /usr/bin/gnome-keyring-daemon — start — foreground — components=secrets</span></pre><p id="4431" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">呃…</p><p id="c2ec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为什么不是<code class="fe lg lh li lj b">kwallet</code>，为什么还是<code class="fe lg lh li lj b">gnome-keyring</code>？</p><p id="e798" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">试着杀死它:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="ef4c" class="mx lu iq lj b gy ny nz l oa ob">$ kill 1278791</span></pre><p id="70b2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并且服务文件仍然是旧的:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="4804" class="mx lu iq lj b gy ny nz l oa ob">$ cat /usr/share/dbus-1/services/org.freedesktop.secrets.service<br/>[D-BUS Service]<br/>Name=org.freedesktop.secrets<br/>Exec=/usr/bin/gnome-keyring-daemon — start — foreground — components=secrets</span></pre><p id="b70a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好了，完全删除<code class="fe lg lh li lj b">gnome-keyring</code>:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="6514" class="mx lu iq lj b gy ny nz l oa ob">$ sudo pacman -Rsn seahorse<br/>$ sudo pacman -Rsn gnome-keyring</span></pre><p id="4daf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在没有服务文件:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="715a" class="mx lu iq lj b gy ny nz l oa ob">$ cat /usr/share/dbus-1/services/org.freedesktop.secrets.service<br/>2019/12/05 13:15:03 open /usr/share/dbus-1/services/org.freedesktop.secrets.service: no such file or directory</span></pre><p id="b4e3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重新安装<code class="fe lg lh li lj b">kwallet</code>:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="d48c" class="mx lu iq lj b gy ny nz l oa ob">$ sudo pacman -S kwallet<br/>warning: kwallet-5.64.0–1 is up to date — reinstalling<br/>…</span></pre><p id="d8d4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">没有新的服务文件:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="52f7" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus — session org.freedesktop.DBus / org.freedesktop.DBus.GetConnectionUnixProcessID org.freedesktop.secrets<br/>Error: org.freedesktop.DBus.Error.NameHasNoOwner<br/>Could not get PID of name ‘org.freedesktop.secrets’: no such name</span></pre><p id="3af5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">太奇怪了…</p><p id="54de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">D-Bus和特勤局到底有没有得到KWallet的支持？</p><p id="bc4c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Reddit表示，事实并非如此:</p><blockquote class="nm nn no"><p id="2a5e" class="ju jv np jw b jx jy jz ka kb kc kd ke nq kg kh ki nr kk kl km ns ko kp kq kr ij bi translated">简而言之，据我所知，KDE不再有特工部门了</p></blockquote><p id="5d28" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">并且<code class="fe lg lh li lj b">ksecretsservice</code> <a class="ae mw" href="https://community.kde.org/KDE_Utils/ksecretsservice" rel="noopener ugc nofollow" target="_blank">文档</a>充满了待办事项...</p><p id="be1c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">可惜了。我确实喜欢基于Qt的KDE应用程序。</p><p id="c8ca" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">更奇怪的是，秘密服务规范是由GNOME和KDE项目共同编写的，但是它只被GNOME Keyring支持…</p><p id="f1a4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">尽管如此，我们可以在没有特勤局整合的情况下使用KWallet。</p><p id="9ad7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行KDE钱包管理器:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="a2c5" class="mx lu iq lj b gy ny nz l oa ob">$ kwalletmanager5</span></pre><p id="2b76" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">创建钱包:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/f732ee41f3dd688f1942bb0ae0e2bdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/0*80u7OoWpK7iWGLuA.png"/></div></figure><p id="a8bc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">设置其密码:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/d846fcf32486180a5c2981a1a440e8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/0*8-bFPVg-VDGhwTXa.png"/></div></figure><p id="89da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">显然，现在我们的Python库将停止工作，因为现在没有可用的秘密服务:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="e8cb" class="mx lu iq lj b gy ny nz l oa ob">&gt;&gt;&gt; keyring.set_password(“system”, “username”, “password”)<br/>Traceback (most recent call last):<br/>…<br/>raise value<br/>jeepney.wrappers.DBusErrorResponse: [org.freedesktop.DBus.Error.ServiceUnknown] (‘The name org.freedesktop.secrets was not provided by any .service files’,)<br/>The above exception was the direct cause of the following exception:<br/>Traceback (most recent call last):<br/>…<br/>raise SecretServiceNotAvailableException(data) from resp<br/>secretstorage.exceptions.SecretServiceNotAvailableException: The name org.freedesktop.secrets was not provided by any .service files<br/>During handling of the above exception, another exception occurred:<br/>Traceback (most recent call last):<br/>…<br/>raise RuntimeError(“Unable to initialize SecretService: %s” % e)<br/>RuntimeError: Unable to initialize SecretService: The name org.freedesktop.secrets was not provided by any .service files</span></pre><p id="5a0d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但是你可以<a class="ae mw" href="https://pypi.org/project/keyring/#id7" rel="noopener ugc nofollow" target="_blank">配置一个</a> <code class="fe lg lh li lj b"><a class="ae mw" href="https://pypi.org/project/keyring/#id7" rel="noopener ugc nofollow" target="_blank">keyring</a></code>后端，直接设置<code class="fe lg lh li lj b">kwallet5</code>，谷歌一下<a class="ae mw" href="https://github.com/jaraco/keyring/issues/269#issuecomment-288684527" rel="noopener ugc nofollow" target="_blank">这里&gt; &gt; &gt; </a>:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="f6de" class="mx lu iq lj b gy ny nz l oa ob">&gt;&gt;&gt; kwallet5 = keyring.backends.kwallet.DBusKeyring()<br/>&gt;&gt;&gt; keyring.set_keyring(kwallet5)<br/>&gt;&gt;&gt; keyring.get_keyring()<br/>&lt;keyring.backends.kwallet.DBusKeyring object at 0x7f7efba66fa0&gt;</span></pre><p id="a550" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">添加密码:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="02e9" class="mx lu iq lj b gy ny nz l oa ob">&gt;&gt;&gt; keyring.set_password(“system”, “username”, “password”)</span></pre><p id="3fea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查D总线信息:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="ca05" class="mx lu iq lj b gy ny nz l oa ob">method call time=1575545736.524015 sender=:1.318 -&gt; destination=:1.269 serial=38 path=/modules/kwalletd5; interface=org.kde.KWallet; member=writePassword<br/>int32 365838442<br/>string “system”<br/>string “username”<br/>string “password”<br/>string “Python keyring library”</span></pre><p id="3e3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">还有夸莱特:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/54f554da7bdaf9de8dd0cbf3429f2052.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/0*pDMQn7YE8ZlFHzsP.png"/></div></figure><h2 id="af66" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">KeePass</h2><p id="2bce" class="pw-post-body-paragraph ju jv iq jw b jx mr jz ka kb ms kd ke kf nj kh ki kj nk kl km kn nl kp kq kr ij bi translated">此外，KeePass可以使用Secret Storage规范充当keyring后端服务。</p><p id="c953" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果<code class="fe lg lh li lj b">gnome-keyring</code>仍在运行——你会从KeePass得到“<a class="ae mw" href="https://github.com/keepassxreboot/keepassxc/issues/3945" rel="noopener ugc nofollow" target="_blank"> <em class="np">另一个特工正在运行</em> </a>”错误:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ok"><img src="../Images/7ee9531993eec2b08e1664ba455910e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YIsmY5qA8AwvJzJo.png"/></div></div></figure><p id="9d64" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">取下<code class="fe lg lh li lj b">gnome-keyring</code>，激活特勤:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/28e9ef8be811eddcdbf2bdbdfe044e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/0*ugl-5Sy3C-pnsSZz.png"/></div></figure><p id="e942" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查D-Bus活动:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="5f24" class="mx lu iq lj b gy ny nz l oa ob">method call time=1575546064.021083 sender=:1.599 -&gt; destination=org.freedesktop.DBus serial=26 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=RequestName<br/>string “org.freedesktop.secrets”<br/>uint32 4<br/>signal time=1575546064.021157 sender=org.freedesktop.DBus -&gt; destination=(null destination) serial=258 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=NameOwnerChanged<br/>string “org.freedesktop.secrets”<br/>string “”<br/>string “:1.599”<br/>signal time=1575546064.021212 sender=org.freedesktop.DBus -&gt; destination=:1.599 serial=16 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=NameAcquired<br/>string “org.freedesktop.secrets”<br/>method return time=1575546064.021245 sender=org.freedesktop.DBus -&gt; destination=:1.599 serial=17 reply_serial=26<br/>uint32 1</span></pre><p id="eeee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查查，谁在听<em class="np">org . free desktop . secrets</em>:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="930f" class="mx lu iq lj b gy ny nz l oa ob">$ qdbus — session org.freedesktop.DBus / org.freedesktop.DBus.GetConnectionUnixProcessID org.freedesktop.secrets<br/>4006761<br/>ps aux | grep 4006761<br/>setevoy 4006761 2.0 0.5 475888 89656 tty1 SLl 13:40 0:02 keepassxc</span></pre><p id="fc4e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧——这是我们的通行证。</p><p id="ec1f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">向数据库中添加内容:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="e50e" class="mx lu iq lj b gy ny nz l oa ob">$ secret-tool store — label=SecretToolExample username username service secret<br/>Password:<br/>libsecret-Message: 13:45:13.448: Remote error from secret service: org.freedesktop.DBus.Error.UnknownObject: No such object path ‘/org/freedesktop/secrets/aliases/default’<br/>secret-tool: No such object path ‘/org/freedesktop/secrets/aliases/default’</span></pre><p id="8494" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">呃…</p><p id="ed69" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">啊哈，需要在KeePass数据库中配置一个内部路径，见<a class="ae mw" href="https://github.com/keepassxreboot/keepassxc/issues/3955#issuecomment-560024175" rel="noopener ugc nofollow" target="_blank">这个&gt; &gt; &gt; </a>注释。</p><p id="75d9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在数据库中添加新组:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/822cf9faf89630ab355d35de4bba0903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/0*bWO4CjL_r74cmfm4.png"/></div></figure><p id="84b2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，转到<em class="np">数据库&gt;数据库设置</em>并指定一个目录的本地路径，该目录将在充当特勤局存储时用于存储数据:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/1d22ce7ec952ac6a4cda800782f75905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*gLoM3LfH4g1Nwc2A.png"/></div></figure><p id="0371" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重启KeePass并检查D-Bus —现在可以看到集合是如何添加的了:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="b5d8" class="mx lu iq lj b gy ny nz l oa ob">signal time=1575546948.831195 sender=:1.613 -&gt; destination=(null destination) serial=22 path=/org/freedesktop/secrets; interface=org.freedesktop.Secret.Service; member=CollectionCreated<br/>object path “/org/freedesktop/secrets/collection/Main”</span></pre><p id="6fbe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">添加记录:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="ac5b" class="mx lu iq lj b gy ny nz l oa ob">$ secret-tool store — label=SecretToolExample username username service secret<br/>Password:</span></pre><p id="5eae" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查D总线:</p><pre class="ll lm ln lo gt nu lj nv nw aw nx bi"><span id="1dde" class="mx lu iq lj b gy ny nz l oa ob">…<br/>method call time=1575547056.148892 sender=:1.616 -&gt; destination=org.freedesktop.secrets serial=10 path=/org/freedesktop/secrets/aliases/default; interface=org.freedesktop.Secret.Collection; member=CreateItem<br/>array [<br/>dict entry(<br/>string “org.freedesktop.Secret.Item.Attributes”<br/>variant array [<br/>dict entry(<br/>string “service”<br/>string “secret”<br/>)<br/>dict entry(<br/>string “username”<br/>string “username”<br/>)<br/>]<br/>)<br/>dict entry(<br/>string “org.freedesktop.Secret.Item.Label”<br/>variant string “SecretToolExample”<br/>)<br/>]<br/>…</span></pre><p id="1fb3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以及KeePass本身:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi oo"><img src="../Images/b00de7154fe59a6db5fe2469091bd6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZWy9KDvVL26cmzqJ.png"/></div></div></figure><p id="4634" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">目前就这些。</p><h2 id="4d8b" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">有用的链接</h2><h2 id="d4e1" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">钥匙圈、特勤局等</h2><ul class=""><li id="6900" class="ks kt iq jw b jx mr kb ms kf mt kj mu kn mv kr kx ky kz la bi translated"><a class="ae mw" href="https://wiki.gnome.org/Projects/GnomeKeyring/" rel="noopener ugc nofollow" target="_blank"> GNOME钥匙圈</a> — GNOME项目文档</li><li id="efac" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://wiki.archlinux.org/index.php/GNOME/Keyring" rel="noopener ugc nofollow" target="_blank">GNOME/key ring</a>—Arch Linux Wiki</li><li id="5b0a" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://wiki.archlinux.org/index.php/KDE_Wallet" rel="noopener ugc nofollow" target="_blank"> KDE钱包</a></li><li id="ea14" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://pypi.org/project/keyring/#third-party-backends" rel="noopener ugc nofollow" target="_blank"> Python钥匙圈库</a></li><li id="bbc7" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://www.linux.com/tutorials/manage-passwords-encryption-keys-and-more-seahorse/" rel="noopener ugc nofollow" target="_blank">用海马管理密码、加密密钥等</a></li><li id="8bc6" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://www.mankier.com/1/secret-tool#Examples" rel="noopener ugc nofollow" target="_blank">秘密工具示例</a></li><li id="5baa" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://www.funtoo.org/Keychain" rel="noopener ugc nofollow" target="_blank">钥匙扣</a></li><li id="cd40" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://lzone.de/blog/Using+Linux+keyring+secrets+from+your+scripts" rel="noopener ugc nofollow" target="_blank">从你的脚本中使用Linux密匙环的秘密</a></li><li id="3891" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">特勤局API草案</li><li id="7842" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://pypi.org/project/SecretStorage/" rel="noopener ugc nofollow" target="_blank"> Python绑定到FreeDesktop.org特勤局API </a></li><li id="f61c" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://keyring.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Python钥匙圈库</a></li><li id="2882" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://developer.gnome.org/libsecret/" rel="noopener ugc nofollow" target="_blank"> Libsecret图书馆参考手册</a></li><li id="ab75" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://bugs.launchpad.net/ubuntu/+source/gnome-keyring/+bug/1780365" rel="noopener ugc nofollow" target="_blank">gnome-key ring中的凭证很容易被破解</a></li><li id="88c2" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://lnx.azurewebsites.net/please-enter-password-for-encrypted-keyring-when-running-python-script-on-ubuntu/" rel="noopener ugc nofollow" target="_blank">在Ubuntu上运行Python脚本时“请输入加密密匙环的密码”</a></li><li id="d291" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://alexwlchan.net/2016/11/you-should-use-keyring/" rel="noopener ugc nofollow" target="_blank">使用钥匙圈存储您的凭证</a></li><li id="7ad4" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://github.com/jaraco/keyring/issues/273" rel="noopener ugc nofollow" target="_blank">在KDE等离子中，keyring默认使用gnome-key ring</a>——只是为了好玩</li><li id="c924" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://www.ibm.com/developerworks/library/l-key-retention/" rel="noopener ugc nofollow" target="_blank">开始使用Linux密钥保留服务</a></li></ul><h2 id="1a48" class="mx lu iq bd lv my mz dn lz na nb dp md kf nc nd mh kj ne nf ml kn ng nh mp ni bi translated">d总线</h2><ul class=""><li id="26c3" class="ks kt iq jw b jx mr kb ms kf mt kj mu kn mv kr kx ky kz la bi translated"><a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-tutorial.html" rel="noopener ugc nofollow" target="_blank"> D-Bus教程</a></li><li id="0806" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://techbase.kde.org/Development/Tutorials/D-Bus/Introduction" rel="noopener ugc nofollow" target="_blank">D-Bus/简介</a></li><li id="ceff" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-specification.html" rel="noopener ugc nofollow" target="_blank"> D总线规格</a></li><li id="3ce1" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-api-design.html#documentation" rel="noopener ugc nofollow" target="_blank"> D-Bus API设计指南</a></li><li id="e180" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://www.kaizou.org/2014/06/dbus-command-line.html" rel="noopener ugc nofollow" target="_blank">从命令行自检D-Bus</a></li><li id="585c" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://bootlin.com/pub/conferences/2016/meetup/dbus/josserand-dbus-meetup.pdf" rel="noopener ugc nofollow" target="_blank">了解D总线</a></li><li id="3870" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://dbus.freedesktop.org/doc/dbus-python/tutorial.html" rel="noopener ugc nofollow" target="_blank"> dbus-python教程</a></li><li id="bf47" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="https://lists.freedesktop.org/archives/dbus/2008-July/010019.html" rel="noopener ugc nofollow" target="_blank">D-Bus和URI命名空间之间的通用标准映射</a></li><li id="1b3f" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae mw" href="http://blog.siphos.be/2014/06/d-bus-quick-recap/" rel="noopener ugc nofollow" target="_blank"> D-Bus，快速回顾</a></li></ul></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><p id="07c9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="np">最初发布于</em> <a class="ae mw" href="https://rtfm.co.ua/en/what-is-linux-keyring-gnome-keyring-secret-service-and-d-bus/" rel="noopener ugc nofollow" target="_blank"> <em class="np"> RTFM: Linux、DevOps和系统管理</em> </a> <em class="np">。</em></p></div></div>    
</body>
</html>
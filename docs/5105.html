<html>
<head>
<title>Read data from Google spreadsheet in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从谷歌电子表格中读取数据</h1>
<blockquote>原文：<a href="https://itnext.io/read-data-from-google-spreadsheet-in-angular-209ee74b6cb4?source=collection_archive---------2-----------------------#2020-12-12">https://itnext.io/read-data-from-google-spreadsheet-in-angular-209ee74b6cb4?source=collection_archive---------2-----------------------#2020-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="be44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">Github</strong>:【https://github.com/mehulk05/MyShop T2】T3】</p><p id="4fd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://mehulk05.github.io/MyShop/#/】试玩链接:<a class="ae kl" href="https://mehulk05.github.io/MyShop/#/" rel="noopener ugc nofollow" target="_blank"/></p><p id="46fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">博客链接</strong>:<a class="ae kl" href="https://blogs-by-mehul.blogspot.com/2020/12/read-data-from-google-spreadsheet-in.html" rel="noopener ugc nofollow" target="_blank">https://blogs-by-mehul . blogspot . com/2020/12/read-data-from-Google-spread sheet-in . html</a></p><p id="a440" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你曾经发现自己在问‘我如何用JavaScript访问Google Sheet电子表格？’，那么你可能不是一个人。你只需要在谷歌中输入“使用javascript读取谷歌表单数据”这样的话，你就会被这个难题的大量解决方案淹没。</p><p id="d82f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题是，以我的经验来看，它们要么非常复杂和夸张，要么很难启动和运行(例如，糟糕的文档)，要么它们在如何为您提供那些宝贵的结果方面有点过于规范。这就是为什么我借此机会写一个简单的解决方案</p><h1 id="7293" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">首先，这是否符合我的需求？</h1><p id="11d2" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">下面的博客只允许<em class="lp">阅读</em>公开发布的谷歌表单。如果您的需求如下，那么它可能非常适合您:</p><ul class=""><li id="4aad" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">您可以公开发布您的Google表单</li><li id="952f" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">在单个工作表中有一个相对简单的数据集(多工作表是一个计划中的特性)</li><li id="ed47" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">你只需要<em class="lp">读取</em>数据</li><li id="3c93" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">您不需要访问由官方Google Sheets API提供的更高级的功能(如缓存或OAuth)。</li><li id="4e66" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">您想要一种简单、直接的方式来获取数据&gt;用数据做事&gt;庆祝！</li></ul><h2 id="c1f0" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">第1步:创建Google工作表并保存</h2><ul class=""><li id="ed0e" class="lq lr iq jp b jq lk ju ll jy mq kc mr kg ms kk lv lw lx ly bi translated">首先，我们将进入<a class="ae kl" href="https://docs.google.com/spreadsheets/u/0/" rel="noopener ugc nofollow" target="_blank">谷歌电子表格</a>并创建一个新的工作表。一旦您创建了一个工作表，您将在URL中获得一个特定工作表的唯一id。将id复制到代码中需要它的地方。请查看下图，以便理解</li></ul><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi mt"><img src="../Images/5e1f8cf1d818125638a8c15cb090a9f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvrP_UMC5wMx3nvYX5VbAA.png"/></div></div></figure><h2 id="42c5" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">步骤2:发布电子表格</h2><ol class=""><li id="6f6f" class="lq lr iq jp b jq lk ju ll jy mq kc mr kg ms kk nf lw lx ly bi translated">单击文件&gt;发布到web</li><li id="a5cc" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk nf lw lx ly bi translated">选择“链接”选项卡</li><li id="40ef" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk nf lw lx ly bi translated">选择“整个文档”或(更有可能)特定的工作表名称</li><li id="9df0" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk nf lw lx ly bi translated">在下一个下拉列表中，选择“网页”或“CSV”。哪个并不重要</li><li id="bd4c" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk nf lw lx ly bi translated">展开底部的部分</li><li id="8cd2" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk nf lw lx ly bi translated">选中“进行更改时自动重新发布”旁边的框</li><li id="b19a" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk nf lw lx ly bi translated">点击“发布”。</li></ol><h2 id="207e" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">第三步:获取图纸编号</h2><ul class=""><li id="d620" class="lq lr iq jp b jq lk ju ll jy mq kc mr kg ms kk lv lw lx ly bi translated">有时，一个文件中可以有多张图纸。请查看下图，以便理解。</li></ul><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/8be992250ed05eb9b3b0d2915dfaca60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*fBbUCotbGQ5bc-PMvUqpIw.png"/></div></figure><ul class=""><li id="4ff4" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">因此，要获得我们想要的数据的工作表编号，请访问URL<a class="ae kl" href="https://spreadsheets.google.com/feeds/worksheets/10xN7JKMC8sxoDM03J5dLq9DFyQPgeVSD2jOWafjw1-k/private/full" rel="noopener ugc nofollow" target="_blank">https://spreadsheets.google.com/feeds/worksheets/&lt;您的工作表id&gt;/私有/完整</a>。这里的工作表id是我们在步骤2中创建新工作表时的id。</li><li id="af12" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">一个JSON数据将会出现，我在下面的图片中展示了它。复制我为您生成的黄色编号，如下图所示。</li></ul><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nh"><img src="../Images/86381f2ee8cc4a972946ef25097613c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZryORqT1-C63OyJcCHiLw.png"/></div></div></figure><h2 id="460f" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">创建一个角度项目</h2><p id="27c6" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">所以我在这里只是快速跳过一些步骤，假设你知道如何创建一个angular项目和创建服务和组件。</p><p id="9ce7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">床单服务文件</strong></p><pre class="mu mv mw mx gt ni nj nk nl aw nm bi"><span id="06c5" class="me kn iq nj b gy nn no l np nq">public getCooker(): Observable&lt;any&gt; {</span><span id="9aa9" class="me kn iq nj b gy nr no l np nq">const sheetno="o6isq5z"<br/>     const sheetid = "1GLoPM2OKSGQPypZeBL3uCl4diAi4YXLye-LrXIx4jr4"<br/>     const url = <br/>`https://spreadsheets.google.com/feeds/list/${sheetid}/${sheetno}/public/values?alt=json`;<br/>    <br/>        return this.http.get(url)<br/>          .pipe(<br/>            map((res: any) =&gt; {<br/>              const data = res.feed.entry;<br/>    <br/>              const returnArray: Array&lt;any&gt; = [];<br/>              if (data &amp;&amp; data.length &gt; 0) {<br/>                data.forEach(entry =&gt; {<br/>                  const obj = {};<br/>                  for (const x in entry) {<br/>                    if (x.includes('gsx$') &amp;&amp; entry[x].$t) {<br/>                      obj[x.split('$')[1]] = entry[x]['$t'];<br/>                    }<br/>                  }<br/>                  returnArray.push(obj);<br/>                });<br/>              }<br/>              return returnArray;<br/>            })<br/>          );<br/>      }</span></pre><p id="bd74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">床单。Component.ts </strong></p><pre class="mu mv mw mx gt ni nj nk nl aw nm bi"><span id="dbdd" class="me kn iq nj b gy nn no l np nq">constructor(private csv: CsvParserService,private csvFilter:GetfilterFromCSVService) { }</span><span id="cd2a" class="me kn iq nj b gy nr no l np nq">ngOnInit(): void {</span><span id="6ba3" class="me kn iq nj b gy nr no l np nq">this.csv.getCooker().subscribe(res =&gt; {<br/>      this.productData = res<br/>      this.productDataFilter = res<br/>      console.log(this.productData)<br/>    })<br/>}</span></pre><p id="c56e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以你会得到类似chrome控制台的输出，如下图所示。</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ns"><img src="../Images/9333cb0e04d7e0c24d9d7155223f4560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8agG50KP612_TzgTxCEOQ.png"/></div></div></figure><h2 id="bee6" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">结论</h2><ul class=""><li id="25f1" class="lq lr iq jp b jq lk ju ll jy mq kc mr kg ms kk lv lw lx ly bi translated">这是一个简单而干净的解决方案，可以从一个包含多个工作表的电子表格文件中读取数据。</li><li id="e4f2" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">因此，这是一种快速的变通解决方案，在这种情况下，您不希望为小需求配置数据库。</li><li id="052f" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">一个很好的更简洁的方法，你可以动态地加载经常变化的数据(例如:电子商务网站，你的小商店的库存商品)</li><li id="3ecc" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">成本效益(无存储成本)，更快的访问(谷歌数据库更快)</li></ul><p id="b765" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">限制:</strong></p><ul class=""><li id="575c" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">我们只能从电子表格中读取数据。需要写一个单独的函数来修改或删除项目。</li><li id="2984" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">该文件需要公开发布(不适合敏感数据)。</li></ul><h2 id="3d80" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">我的应用程序使用这种方法的演示图像(电子商务网站)</h2><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nt"><img src="../Images/16cc1bfab23e878607394787915ff030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lq_lTITM8knzvWLDzkBLlg.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk translated"><strong class="bd ko">数据</strong></figcaption></figure><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ny"><img src="../Images/4b0258385815b221078a2b5810f4c800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YOZuH6WSj4ZzACGBqarGoA.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk translated"><strong class="bd ko">我的演示应用</strong></figcaption></figure></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><h2 id="7421" class="me kn iq bd ko mf mg dn ks mh mi dp kw jy mj mk la kc ml mm le kg mn mo li mp bi translated">也阅读</h2><div class="og oh gp gr oi oj"><a rel="noopener  ugc nofollow" target="_blank" href="/authentication-using-jwt-in-mean-stack-6b425247b7d8"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">在均值堆栈中使用JWT的认证</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">从头开始在一个平均堆栈应用程序中使用JWT进行身份验证</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">itnext.io</p></div></div><div class="os l"><div class="ot l ou ov ow os ox nd oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://medium.com/javascript-in-plain-english/how-to-add-medium-blogs-on-your-react-app-a3898a729aad" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">如何在React应用上添加中型博客</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">如何在React应用和其他网站上嵌入中型博客</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox nd oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://codeburst.io/covoid-19-tracker-statistics-app-using-angular-2358347b3d1f" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">COVOID 19跟踪器(统计)应用程序使用角度</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">现场演示:https://mehulk05.github.io/COVOID-19/</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">codeburst.io</p></div></div><div class="os l"><div class="oz l ou ov ow os ox nd oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://codeburst.io/blogging-app-using-angular-9-and-firebase-98e36168d850" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">使用Angular 9和Firebase的博客应用程序等媒体</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">媒体博客应用程序完整演示</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">codeburst.io</p></div></div><div class="os l"><div class="pa l ou ov ow os ox nd oj"/></div></div></a></div></div></div>    
</body>
</html>
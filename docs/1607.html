<html>
<head>
<title>GitHub and Azure Pipelines: Build Triggers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitHub和Azure管道:构建触发器</h1>
<blockquote>原文：<a href="https://itnext.io/github-and-azure-pipelines-build-triggers-d7f36dcf73c4?source=collection_archive---------3-----------------------#2018-12-09">https://itnext.io/github-and-azure-pipelines-build-triggers-d7f36dcf73c4?source=collection_archive---------3-----------------------#2018-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4368" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为对我在<a class="ae kl" href="https://elanderson.net/2018/10/github-and-azure-pipelines/" rel="noopener ugc nofollow" target="_blank"> GitHub和Azure Pipelines </a>上的帖子的回应，我在Reddit上收到了以下<a class="ae kl" href="https://www.reddit.com/r/github/comments/9sbdmm/github_and_azure_pipelines/" rel="noopener ugc nofollow" target="_blank">问题</a>。</p><blockquote class="km kn ko"><p id="ee7c" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">这是自动检测分支吗？从你的截图来看，你是建筑大师。如果复制到特征A，是否会自动创建和构建新管线？</p></blockquote><p id="6cec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我最初回答这个问题时，我回答得不够深入。对于新管道是否会自动创建和构建，我的回答是否定的，但我认为这个问题的意图是，我是否必须在每次创建新分支时都设置一个新管道，答案也是否定的。默认情况下，当任何分支上签入任何更改时，都会触发现有管道。请注意，只有当变更被检入时，才创建分支，这不会被触发。</p><h2 id="2aca" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">限制构建</h2><p id="6b2e" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">有几种方法可以控制什么分支触发持续集成构建。第一种是通过在repo中编辑<strong class="jp ir"> azure-pipeline.yml </strong>文件，第二种是通过Azure Pipeline中的覆盖。</p><p id="1d50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">YAML</p><p id="f3b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">官方的<a class="ae kl" href="https://docs.microsoft.com/en-us/azure/devops/pipelines/build/triggers?view=vsts&amp;tabs=yaml" rel="noopener ugc nofollow" target="_blank">构建管道触发器</a>文档确实很好，但是我将在这里涵盖包括分支和排除分支的基本内容。有关路径包含/排除以及如何控制PR验证的信息，请查看文档。这里的一个例子是yaml文件，用于定义这个 repo中的一个构建。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="651a" class="kt ku iq lw b gy ma mb l mc md">pool:<br/>  vmImage: 'Ubuntu 16.04'<br/><br/>variables:<br/>  buildConfiguration: 'Release'<br/><br/>steps:<br/>- script: dotnet build Sqlite --configuration $(buildConfiguration)<br/>  displayName: 'dotnet build $(buildConfiguration)'</span></pre><p id="068d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了控制构建什么分支，我们需要添加一个<strong class="jp ir">触发器</strong>部分。最有趣的例子是列出您想要构建的分支。允许使用结束通配符。参见下面的例子(摘自官方文件的触发部分)。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="cdb1" class="kt ku iq lw b gy ma mb l mc md">pool:<br/>  vmImage: 'Ubuntu 16.04'<br/><br/>variables:<br/>  buildConfiguration: 'Release'<br/><br/>steps:<br/>- script: dotnet build Sqlite --configuration $(buildConfiguration)<br/>  displayName: 'dotnet build $(buildConfiguration)'<br/><br/>trigger:<br/>- master<br/>- releases/*</span></pre><p id="a085" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将在releases下构建master和所有分支，但不会构建其他的。下面显示了如何一起使用includes和excludes。再次，触发器部分取自官方文件。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="a8f7" class="kt ku iq lw b gy ma mb l mc md">pool:<br/>  vmImage: 'Ubuntu 16.04'<br/><br/>variables:<br/>  buildConfiguration: 'Release'<br/><br/>steps:<br/>- script: dotnet build Sqlite --configuration $(buildConfiguration)<br/>  displayName: 'dotnet build $(buildConfiguration)'<br/><br/>trigger:<br/>  branches:<br/>    include:<br/>    - master<br/>    - releases/*<br/>    exclude:<br/>    - releases/old*</span></pre><p id="10d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将建立主版本和所有不从旧版本开始的版本。真的去读一下关于这个的官方文件，看看所有的细节。</p><p id="07ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">天蓝色管道</p><p id="fb4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要从Azure DevOp覆盖CI构建，请转到有问题的构建，然后单击<strong class="jp ir">编辑</strong>。</p><figure class="lr ls lt lu gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi me"><img src="../Images/f333686cd24125fcf68021ee663b3234.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*czb07szsl9rewBXi.png"/></div></div></figure><p id="df4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，选择<strong class="jp ir">触发器</strong>和<strong class="jp ir">持续积分</strong>，勾选<strong class="jp ir">超控YAML </strong>。</p><figure class="lr ls lt lu gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mm"><img src="../Images/89b34f9bde8a1d5c9bad648131cceddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A_Mj65KqfSrtyiQj.png"/></div></div></figure><p id="4226" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查覆盖后，你会看到更多的选项亮起。正如您在下面的屏幕截图中看到的，相同的包含和排除选项可用于相同的通配符选项。</p><figure class="lr ls lt lu gt mf gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/1361813af321478db8142dc367ad709e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/0*1E8zCiUZ0LjX8WVa.png"/></div></figure><h2 id="65af" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">包扎</h2><p id="acf6" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">如你所见，Azure Pipelines在如何触发构建方面提供了很多灵活的能力。除了我在这里介绍的以外，还有一些选项可以设置预定的构建，以及在一个构建完成时触发另一个构建。如果你遇到了无法涵盖的情况，我很乐意在评论中听到。</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><p id="3463" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kp">原载于</em> <a class="ae kl" href="https://elanderson.net/2018/12/github-and-azure-pipelines-build-triggers/" rel="noopener ugc nofollow" target="_blank"> <em class="kp">埃里克·安德森</em> </a> <em class="kp">。</em></p></div></div>    
</body>
</html>
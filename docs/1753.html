<html>
<head>
<title>Morse Code and the Web Audio APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">莫尔斯电码和网络音频API</h1>
<blockquote>原文：<a href="https://itnext.io/morse-code-and-the-web-audio-apis-594fea0ddb2b?source=collection_archive---------1-----------------------#2019-01-19">https://itnext.io/morse-code-and-the-web-audio-apis-594fea0ddb2b?source=collection_archive---------1-----------------------#2019-01-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d573" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在计算机科学领域，莫尔斯电码是那些仍然很酷的老式技术之一。我们都看过关于第二次世界大战的电影，在电影中，政府使用莫尔斯电码发送电报，远距离传送信息。我们可能也看过海军电影，当船只遇到麻烦时，指挥官会发出著名的“SOS”。这项技术在开发时是开创性的，今天仍然适用。</p><p id="6aac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我对这个感兴趣，所以我想如果可以的话，用一个程序来创建莫尔斯电码会很酷。我在谷歌上搜索了一会儿，发现一些人使用<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API" rel="noopener ugc nofollow" target="_blank">网络音频API </a>用Javascript生成莫尔斯电码。然后，我用Javascript定时器和Web Audio API阅读(和编码)了随后的时间，尝试了通过光(颜色)和声音发送消息的不同方法。</p><p id="e550" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终，因为这些东西很酷，我决定写一篇关于它的文章。</p><p id="eb37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章的其余部分将介绍一些用Javascript创建莫尔斯电码的酷方法。我将使用<strong class="jp ir">网络音频API </strong>和Javascript的<strong class="jp ir"> setTimeout </strong>函数来演练实现。</p><h1 id="4624" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">莫尔斯电码的一些历史</h1><p id="1819" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">莫尔斯电码(发音像“Morsel”中的“Morse”，而不是我妻子向我描述的名字中的“Morris”)可以被定义为一种由“点”和“破折号”组成的编码语言，对应于一个预设的字符表。这些字符包括字母表(a-z)以及数字(0-9)和一些标点符号。组成莫尔斯电码的“点”和“划”可以通过任何可以产生不同信号的东西来传输。这使它变得非常强大，因为只要发送者和接收者都理解莫尔斯电码，就可以用手电筒或收音机远距离发送信息。随着<a class="ae kl" href="https://en.wikipedia.org/wiki/Electrical_telegraph" rel="noopener ugc nofollow" target="_blank">电报</a>的发明，这变得更加强大，因为早在20世纪初，信息就可以远距离传输。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/87fe7ecd2da9c8625773274dd99d5b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w1qMvJtPjREkGCT3GDsoMQ.jpeg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">《唐顿庄园》的粉丝们无疑会记得剧中交换的各种电报(<a class="ae kl" href="https://www.telegraph.co.uk/film/the-lady-in-the-van/why-we-love-maggie-smith/" rel="noopener ugc nofollow" target="_blank">点击此处获取图片来源</a>)</figcaption></figure><p id="53ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">100多年来，莫尔斯电码也在美国军方(以及其他国家)广泛使用。一些著名的战争电影展示了它们，包括<em class="mf">《猎杀红色十月》</em>和<em class="mf">《模仿游戏》</em>。</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="bc3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我推荐查看<a class="ae kl" href="https://en.wikipedia.org/wiki/Morse_code" rel="noopener ugc nofollow" target="_blank">莫尔斯电码维基百科页面</a>和<a class="ae kl" href="https://en.wikipedia.org/wiki/Electrical_telegraph" rel="noopener ugc nofollow" target="_blank">电讯维基百科页面</a>来了解更多。</p><h1 id="f346" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">网络音频的历史</h1><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mi"><img src="../Images/955ab8f9f9f7091abd43c03fb3cf0944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXM86AGt00oeQgMu5lQzQQ.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">网络音频穿越历史(<a class="ae kl" href="https://www.davrous.com/2015/11/05/creating-fun-immersive-audio-experiences-with-web-audio/" rel="noopener ugc nofollow" target="_blank">点击此处获取来源</a>)</figcaption></figure><p id="d753" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你已经有了一些莫尔斯电码的背景知识，让我们来谈谈如何使用Javascript来传输它的颜色和声音。</p><p id="993c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着浏览器的发展，声音一直是一个挑战。最初的网络浏览器对带有特定元素的声音的支持非常少。当<a class="ae kl" href="https://en.wikipedia.org/wiki/Adobe_Flash_Player" rel="noopener ugc nofollow" target="_blank"> flash media </a>被开发出来的时候，它提供了一个跨浏览器的解决方案，但是仍然需要用户安装软件。Flash媒体插件也不够理想。</p><p id="7191" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在HTML5中，<strong class="jp ir"> &lt; audio &gt; </strong>元素修复了很多问题，但如果你想从web应用程序中生成自己的声音，它有很大的局限性。<strong class="jp ir"> &lt; audio &gt; </strong>元素没有像DJ那样给你对声音和操作的精细控制。</p><p id="70a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着<strong class="jp ir"> Web Audio API </strong>的出现，所有之前的挑战都迎刃而解，因为它提供了一个框架来完成(几乎)你能想到的任何类型的声音工作。</p><h1 id="6093" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">网络音频API简介</h1><p id="9fdc" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在下一节中，我将尝试展示Web音频API的高级视图。我建议查看这里的<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API" rel="noopener ugc nofollow" target="_blank">页面</a>了解更多信息。你也可以在这里查看网络音频API的W3C历史。</p><p id="6a76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好的，让我们从头开始…</p><p id="c3da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网络音频API实际上只是一种创建声音系统的虚拟方式。这可以被视为类似于DJ在创建“混音”时使用的方法。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mj"><img src="../Images/00c11e11daf502ed41085ff7854d8d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01TeVF0LVNmGdjhg2W6gyA.jpeg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated"><a class="ae kl" href="https://www.google.com/url?sa=i&amp;source=images&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwj2zJL2kfnfAhVtUd8KHVvtBxgQjRx6BAgBEAU&amp;url=http%3A%2F%2Fwww.agiprodj.com%2Fpioneer-djm-450-2-channel-dj-mixer-with-audio-interface-rekordbox.html&amp;psig=AOvVaw39EEwhBETEUxNyoTUcA5yn&amp;ust=1547963046242801" rel="noopener ugc nofollow" target="_blank">(点击此处获取图片来源)</a></figcaption></figure><p id="b28d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Web Audio API实际上是一组“节点”,它们是虚拟网络的不同部分。创建此网络是为了模拟声音并将源(录制的声音或生成的声音)连接到目的地(扬声器)。下面是我从这里的<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/API/AudioNode" rel="noopener ugc nofollow" target="_blank"> MDN页面复制的一个很棒的整体图</a>:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mj"><img src="../Images/b4019e12ebd83d3918832f8a9bddc05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZgV4mlY1FxW1O7EYxHmXMw.png"/></div></div></figure><p id="a61a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用网络音频API创建的整个音频网络被称为<strong class="jp ir">音频图</strong>。Web Audio API将这个音频图称为<strong class="jp ir"> AudioContext </strong>，它基本上是音频可以在当前浏览器会话中运行的地方。每个浏览器都有一个<strong class="jp ir"> AudioContext </strong>，你需要知道如何引用它才能使用网络音频API。</p><p id="042a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了声音之外，您还可以使用Web Audio API的<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode" rel="noopener ugc nofollow" target="_blank">分析器节点</a>创建声音的可视化效果。</p><p id="53bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果所有这些看起来有点难以理解，我推荐你看下面的视频，它将带你了解一些基本知识。</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h1 id="824e" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">莫尔斯声音</h1><p id="9add" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">既然你已经有了网络音频和莫尔斯电码的介绍，让我们开始编码吧！在学习莫尔斯电码的过程中，我创建了一个应用程序，它使用网络音频API来生成“点”和“破折号”的声音，这种声音通常会在电报或无线电传输中听到。为了创建这个应用程序，我参考了<a class="ae kl" href="https://blog.theincredibleholk.org/blog/2014/06/23/generating-morse-code-with-javascript/" rel="noopener ugc nofollow" target="_blank">这里的博客文章</a>和<a class="ae kl" href="https://gist.github.com/eholk/0115691987090973cefe" rel="noopener ugc nofollow" target="_blank">这里的相关要点</a>，以便更好地理解如何将所有这些联系起来。该应用程序是用Angular构建的，托管在Firebase上。</p><p id="1586" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里玩一个<a class="ae kl" href="https://morse-sound-6ae99.firebaseapp.com" rel="noopener ugc nofollow" target="_blank">运行版的app</a>。你也可以在这里查看GitHub上该应用的<a class="ae kl" href="https://github.com/andrewevans0102/morse-sound" rel="noopener ugc nofollow" target="_blank">源代码。</a></p><p id="48e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于应用程序遵循Angular的基本结构，我不打算进行标准的“ng new”和应用程序设置。我将演示主要组件如何与Web APIs一起工作。请在我上面提供的GitHub链接查看源代码，看看这个应用是如何创建的。</p><p id="5115" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序本身只是接收文本，以莫尔斯电码的形式播放文本，并输出翻译后的结果，如下图所示。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mj"><img src="../Images/c75fbdd421e4d7016388cc1dc4b5cfd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mG7HbtKx8ThA-jY-hqKLvA.png"/></div></div></figure><p id="3ff5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，让我们演练设置这一点…</p><p id="1f2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我应该注意到Web Audio API现在被大多数现代浏览器所支持，但是对于特定的浏览器实现可能会有一些小的不同。我在这里介绍的代码是为Google Chrome开发的。</p><p id="0a41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一项安全措施，Chrome不会在没有手势发生的情况下播放音频。这是有意义的，因为你不想让应用程序未经你的同意就能进入你的电脑音频。因此，为了做到这一点，我的应用程序的主webform创建了带有<strong class="jp ir"> onSubmit </strong>的<strong class="jp ir">音频上下文</strong>，它被绑定到接收输入的主表单。代码如下:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="3b93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的<strong class="jp ir"> createContext </strong>方法创建了我们一直在谈论的音频图。首先，我们创建一个<strong class="jp ir">音频上下文</strong>、<strong class="jp ir">振荡器</strong>和<strong class="jp ir">增益节点</strong>的实例，如下所示:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="a59f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将gain节点的值设置为“0”，以模拟它处于关闭状态(使它不播放声音)。然后我们设置<strong class="jp ir">振荡器</strong>的频率(音高)，将<strong class="jp ir">振荡器</strong>连接到<strong class="jp ir">增益节点</strong>，并将<strong class="jp ir">增益节点</strong>连接到扬声器(音频目的地)，如下所示:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="c55a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们设置声音播放的速率并启动振荡器节点。这一点很重要，因为它成为我们设置的网络“调度”声音的值。</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="210a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">生成的音频图看起来应该有点像下图:</p><p id="eddc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里的图中，所有的节点都存在于一个<strong class="jp ir">音频上下文</strong>中。这里列出的三个节点只是音频图的一部分。<strong class="jp ir">振荡器</strong>连接到<strong class="jp ir">增益</strong>上，增益产生输出并发送到扬声器(音频目的地)。</p><p id="0171" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了音频图形设置，我们接下来需要开始创建声音。这里我们将通过模拟打开和关闭<strong class="jp ir">增益节点</strong>来“安排”声音。我们通过在特定的时间间隔将增益值设置为“0”或“1”来做到这一点。把这想象成打开和关闭扬声器的音量。我们通过以下方式做到这一点:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="0649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> generateMorse </strong>方法通过<strong class="jp ir">audio context . current time</strong>属性使用<strong class="jp ir"> AudioContext的</strong>时间。AudioContext有一个内部时钟，一旦创建，它就会持续计数。我们将使用<strong class="jp ir">audio context . setvalueattime</strong>方法来使用该时钟“调度”音频声音。这就是时间作为参数传递给<strong class="jp ir"> generateMorse </strong>方法的原因。</p><p id="11ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数组<strong class="jp ir"> MORSE </strong>只是一组键值对，将输入的字符与MORSE代码值相关联。</p><p id="46ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还要注意使用<strong class="jp ir">点</strong>值来安排时间。这决定了程序播放“点”和“划”的频率(步调)。</p><p id="9da7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<strong class="jp ir"> generateMorse </strong>方法，循环的<strong class="jp ir">遍历传递给它的短语，然后调用<strong class="jp ir"> createSound </strong>方法。这个方法就是所有神奇的地方。</strong></p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="b373" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该方法调用增益节点<strong class="jp ir"> setValueAtTime </strong>方法，该方法“安排”声音在创建的音频图中播放。<strong class="jp ir">返回值</strong>很重要，因为它强制Javascript事件循环使用声音生成作为堆栈上的操作。如果你不包含返回符<strong class="jp ir">那么Javascript作用域将错过时机，你将听不到任何声音。</strong></p><p id="a8f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">综上所述，最终产品如下所示:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="2f11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查应用程序的运行版本，或者做一个<strong class="jp ir"> git克隆</strong>并自己玩代码。</p><h1 id="483c" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">莫尔斯灯</h1><p id="d03e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">除了我上面创建的声音应用程序，我还创建了第二个角度应用程序，它可以用光生成莫尔斯码。从技术上来说，该应用程序只是使用了一个HTML canvas元素，并用<strong class="jp ir">黄色</strong>和<strong class="jp ir">白色</strong>重新绘制了一个圆，以模拟手电筒打开<strong class="jp ir">打开</strong>和关闭<strong class="jp ir">关闭</strong>。此外，当莫尔斯电码灯显示时，相应的“莫尔斯信”翻译及时输出到所画灯的右侧。</p><p id="c746" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里玩一个<a class="ae kl" href="https://morse-light-6d365.firebaseapp.com" rel="noopener ugc nofollow" target="_blank">运行版的app</a>。你也可以在这里查看GitHub上app的<a class="ae kl" href="https://www.github.com/andrewevans0102/morse-light" rel="noopener ugc nofollow" target="_blank">源代码。</a></p><p id="8c9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是应用程序运行的截图:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ml"><img src="../Images/efedb37c47e6211fae27029c774502cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_HaZT0laswZ5lLCFGvEBZg.png"/></div></div></figure><p id="89fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就像使用sound应用程序一样，我不打算介绍使用Angular CLI创建初始结构的基础知识。我在这里只关注主要的应用程序逻辑，并建议您查看GitHub中的项目，以了解实际项目是如何构建的。</p><p id="4161" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于基本的灯光演示，我使用了<strong class="jp ir"> async/await </strong>和Javascript事件循环来模拟灯光的“开”和“关”。该应用程序基本上接受一个短语作为输入，然后定时调用一个返回<strong class="jp ir">承诺</strong>的方法。由于我使用了<strong class="jp ir"> async/await </strong>，主Javascript事件循环被迫等待，直到<strong class="jp ir"> Promise </strong>在规定的时间内完成。如果你不熟悉<strong class="jp ir"> async/await </strong>，我推荐你在这里看看我的帖子<a class="ae kl" href="https://rhythmandbinary.com/post/Optimizing_Angular_with_Async_Await" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="e339" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序使用<strong class="jp ir">传输</strong>方法和<strong class="jp ir">手电筒</strong>方法完成大部分工作。</p><p id="193c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，<strong class="jp ir">传输</strong>方法是由主输入表单中的“提交”按钮调用的。这个方法使用我最初解释的<strong class="jp ir"> async/await </strong>调用来控制“开”和“关”灯序列的定时。</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="77c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你在这段代码中看到的，<strong class="jp ir">异步</strong>方法调用<strong class="jp ir">手电筒</strong>。这个调用有一个<strong class="jp ir"> await </strong>，它阻塞了主事件循环，迫使程序在改变灯的颜色之前等待。根据传入的颜色值，对<strong class="jp ir">手电筒</strong>的调用也控制颜色。所以<strong class="jp ir">黄色</strong>模拟灯<strong class="jp ir">亮</strong>白色<strong class="jp ir">模拟灯<strong class="jp ir">灭</strong>。如果你把这个和一串莫尔斯电码以点号的形式传进来。</strong>和<strong class="jp ir">破折号="-" </strong>，然后你可以遍历该行并模拟相应的<strong class="jp ir">开</strong>和<strong class="jp ir">关</strong>值。</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><p id="7fdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">手电筒</strong>方法只是在指定的时间内给<strong class="jp ir">画布</strong>元素着色。真正神奇的是<strong class="jp ir"> async/await </strong>阻塞主线程，在画布的绘制/重绘改变灯光颜色之前强制等待。</p><p id="47a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将所有这些放在一起，莫尔斯灯光组件看起来如下:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mk mh l"/></div></figure><h1 id="40dc" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">包扎</h1><p id="ab3f" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">就个人而言，所有这些都是学习莫尔斯电码的有趣方式。我希望我创建的链接和应用程序能帮助你理解一些关于网络音频的基础知识，以及Javascript中的事件计时。</p></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><p id="2892" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mf">原载于2019年1月19日</em><a class="ae kl" href="https://rhythmandbinary.com/post/Morse_Code" rel="noopener ugc nofollow" target="_blank">https://rhythmandbinary.com</a><em class="mf">。</em></p></div></div>    
</body>
</html>
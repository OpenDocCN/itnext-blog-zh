<html>
<head>
<title>Boost web performance with Service Workers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过服务人员提高web性能</h1>
<blockquote>原文：<a href="https://itnext.io/boost-web-performance-with-service-workers-18065d24d007?source=collection_archive---------2-----------------------#2020-08-12">https://itnext.io/boost-web-performance-with-service-workers-18065d24d007?source=collection_archive---------2-----------------------#2020-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/59177539b6a940adc7bdf6e67a949651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*yH9lUfEfllv2wJ1p.jpeg"/></div></figure><p id="9758" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果你已经为你的网站的性能工作了一段时间，还没有尝试过服务人员，请继续阅读。服务工作者是在您的浏览器中运行的脚本，有助于优化网站上的资产加载，甚至允许在浏览器中缓存资产以供离线使用。这不是一个关于服务人员的来龙去脉的深入教程，而是一个关于服务人员给你的网站的灯塔绩效评分带来的好处的见解。</p><p id="016b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">对于本文，我使用Lighthouse，因为它检查的是此时的性能，而不是更长时间内的性能。以下截图已于当日拍摄。第一组截图代表没有注册服务人员的网站，第二组截图是我注册服务人员时拍摄的。同样是网站，唯一不同的是服务人员。</p><h1 id="0ad9" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">在服务人员之前</h1><p id="09ff" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">如果我们没有之前和之后的情况，洞察力就没有任何意义。在下面两张截图中，您可以看到之前的手机和台式机得分截图。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ly"><img src="../Images/7bca2ab1b52e6454d8f8eaafdac0f3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MGlOvXq_k-XJujJ-.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">服务人员之前的Lighthouse绩效评分(桌面)</figcaption></figure><p id="c0db" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">正如你所看到的，桌面的分数已经很好了，不需要太多的改进。然而，如果我们看一下手机的得分，就会发现情况有所不同。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ml"><img src="../Images/a64de989c27f2d5a2ba7975a9664bf1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Nk81KGgIL4zMYXqn.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">服务人员之前的灯塔绩效评分(移动)</figcaption></figure><p id="0cef" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">移动版本的分数不是很高，确实需要一些改进，特别是因为这个网站的大部分流量(80%以上)都是在移动设备上。</p><h1 id="24db" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">服务人员进来了</h1><p id="ade4" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">由于我运行这个测试的网站是用Laravel构建的，所以我使用Laravel Mix来编译Sass和其他资产。Laravel Mix有一个生成服务工作者的插件:<a class="ae mm" href="https://laravel-mix.com/extensions/workbox" rel="noopener ugc nofollow" target="_blank"> laravel-mix-workbox </a>。使用这个扩展，您可以非常容易地为编译的资产生成一个服务工作者。</p><p id="0846" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这是我用来生成服务工作者的配置的摘录:</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="6e38" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这里最重要的一点是，您需要包含“webpackConfig”部分。如果您不这样做，服务人员将尝试使用额外的前导斜杠:"//css/style.css "来缓存您的资产。这将引发错误，并导致服务人员无法启动，因为如果有任何错误，服务人员将无法启动。因此，通过在新的publicPath中添加“webpackConfig ”,可以解决这个问题。</p><p id="c64b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果您使用Webpack来捆绑和编译您的资产，您可以使用相同的配置。只需将“generates SW”替换为“new GenerateSW ”,并将其包含在webpack.config.js文件的plugins部分中。</p><p id="75e2" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在您已经有了sw.js文件，您需要将它包含在您的网页中:</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="585e" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">在服务人员之后</h1><p id="2abe" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">现在，我们已经在您的网页上安装了服务人员，我们可以再次检查我们的灯塔性能得分。这些是包括服务人员在内的Lighthouse手机和台式机性能得分的截图。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mp"><img src="../Images/75f8115b39eaaefcf6d0361b59a0f83e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vjh1VlGcnDxebFMZ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">Lighthouse绩效评分(桌面)售后服务人员</figcaption></figure><p id="50d1" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如你所见，分数比以前高了。这对我们的分数是一个很好的提升，但是桌面版本从来不需要额外的性能。另一方面，移动电话有了巨大的飞跃:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mp"><img src="../Images/cb1cd663d4d0c0e493897a94592b355a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9LbzNYvVFRQ-GmKc.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">灯塔得分(手机)售后服务人员</figcaption></figure><p id="1617" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">移动评分现在已经高到可以绿色了，这是我开始这个的时候的目标。服务人员已经使分数上升了很多，并且更有效地加载了静态资产。</p><h1 id="c08a" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">为提高分数而采取的其他措施</h1><p id="080a" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">要达到这个分数，有一个优化很差的网站，只增加一个服务人员是不够的。在添加服务人员之前，我已经进行了各种不同的优化:</p><ul class=""><li id="787f" class="mq mr it jz b ka kb ke kf ki ms km mt kq mu ku mv mw mx my bi translated">通过loading="lazy "延迟加载图像</li><li id="2b82" class="mq mr it jz b ka mz ke na ki nb km nc kq nd ku mv mw mx my bi translated">使用<a class="ae mm" href="https://roelofjanelsinga.com/articles/technical-seo-improving-your-page-loads-with-properly-sized-images" rel="noopener ugc nofollow" target="_blank"> Gumlet </a>正确调整图像大小</li></ul><p id="cb07" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这些因素都在最终得分中发挥了作用，但这并不意味着服务人员仍然提供了很好的性能提升。</p><h1 id="0abc" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">结论</h1><p id="a5e3" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">在你的网站上增加一名服务人员可以极大地提高灯塔绩效分数，你的UX，甚至可以带来更好的SEO分数。所以，如果你能为你的项目做到这一点，并且你希望从你的网站中获得一些额外的性能，包含一个服务人员是你能获得的最快的性能提升之一。</p><p id="e371" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">发布时间:2020年8月5日</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="c591" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="nl">最初发表于</em><a class="ae mm" href="https://roelofjanelsinga.com/articles/boost-web-performance-with-service-workers" rel="noopener ugc nofollow" target="_blank">T5【https://roelofjanelsinga.com】</a><em class="nl">。</em></p></div></div>    
</body>
</html>
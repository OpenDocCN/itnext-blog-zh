<html>
<head>
<title>How to build an API without coding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在不编码的情况下构建API</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-build-an-api-without-coding-350293c58376?source=collection_archive---------3-----------------------#2019-07-06">https://itnext.io/how-to-build-an-api-without-coding-350293c58376?source=collection_archive---------3-----------------------#2019-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6b6662fbe8f037a68d66437d95fd92cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IwkHGPD0lOfgiSnf"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">卡斯帕·卡米尔·鲁宾在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b003" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在过去的10年里一直是一名系统工程师，这意味着当我第一次必须构建一个API时，我不知道如何去做。我对python相当了解，因为作为一名系统管理员，我经常要写一些或大或小的脚本，但是构建整个API对我来说是一个挑战。当然——我可以谷歌一下这个短语，找到几十个关于如何构建API的教程，但它们都有点复杂，或者是为初级开发人员创建的(这意味着——假设你已经知道很多编程)。幸运的是，在工作中，我被一家公司指派了一个项目，该公司有一个用Python Eve框架编写的API原型。我稍后会解释Python Eve，但它本身并不是一个关于Eve的故事。这是一个关于我如何让用Python Eve构建API变得更加容易的故事。我们走吧。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="8195" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我上面提到的——故事从Python Eve开始，也正如前面提到的——我们今天不关注Eve，但我需要给你一些关于它的背景。Eve是一个以REST为中心的API框架，构建在由<a class="ae kc" href="http://nicolaiarocci.com/" rel="noopener ugc nofollow" target="_blank"> Nicola Iarocci </a>创建的Flask之上。它的伟大之处在于构建完整的API毫不费力，因为您只需要启动一个正在运行的MongoDB服务器和两个简单的python文件(app.py，在大多数基本设置中包含4行代码和settings.py，它们定义了端点、数据库连接和额外的配置，如果您愿意的话)。简单是Eve的第一个卖点，但是不要搞错——它根本不会限制你。它的功能非常丰富(它提供了您期望从API中得到的大部分东西——一整套CRUD操作、过滤、排序、分页、条件请求、数据验证等等)。此外，由于它是建立在Flask之上的——大多数Flask插件也应该可以与Eve一起工作。</p><p id="6715" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，让我快速地向您展示"<em class="li">如何在5分钟内构建一个API</em>"之后，我将向您展示更快的方法；)</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="71ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从Eve开始，您可以简单地用pip安装它:</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="7006" class="ls lt iq lo b gy lu lv l lw lx"><strong class="lo ir">pip install eve</strong></span></pre><p id="7c11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">注意:请使用Python 3 </strong></p><p id="9f81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们安装了Eve，我们需要启动一个MongoDB数据库。这完全取决于你的平台和你的设置，但是假设你已经安装了docker，例如，你可以使用官方的mongo镜像:</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="f075" class="ls lt iq lo b gy lu lv l lw lx"><strong class="lo ir">docker run --name mongo -d mongo</strong></span></pre><p id="efa5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们只需要两个小文件。一个是假设app.py(或者run.py，或者您喜欢的其他名称)包含以下内容:</p><figure class="lj lk ll lm gt jr"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="fafd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们简单地导入Eve，创建新的Eve对象并调用run函数。现在，这足以启动Eve实例，但是我们需要定义所有的端点、到Mongo的连接等等。为此，我们需要一个名为settings.py的文件(默认情况下，Eve expect文件的名称是这样的，如果您愿意，可以更改它，但之后您需要在app.py中指向它——为了简单起见，我们保留默认值)。该文件的内容可以根据您想要使用的功能数量进行定制，但它必须包含以下内容:</p><figure class="lj lk ll lm gt jr"><div class="bz fp l di"><div class="ly lz l"/></div></figure><ol class=""><li id="43a4" class="ma mb iq kf b kg kh kk kl ko mc ks md kw me la mf mg mh mi bi translated">MongoDB定义—在上面的例子中，我使用了_URI版本，但是也可以单独定义MONGO_HOST、MONGO_PORT、MONGO_DBNAME和更多选项</li><li id="06ba" class="ma mb iq kf b kg mj kk mk ko ml ks mm kw mn la mf mg mh mi bi translated">RESOURCE/ITEMS _ METHODS——顾名思义定义了资源REST方法(所以当你向<em class="li"> http://your_api/example </em>发送请求时允许做什么，以及对于像<a class="ae kc" href="http://your_api/example/[uuid]" rel="noopener ugc nofollow" target="_blank"> <em class="li">这样的特定项目允许做什么)</em></a></li><li id="4ccf" class="ma mb iq kf b kg mj kk mk ko ml ks mm kw mn la mf mg mh mi bi translated">模式定义——这是为Eve构建settings.py文件的核心和最耗时的部分。这里您需要为每个端点定义一个模式。在这个例子中，我们只有一个模式，只有两个条目firstname和lastname，它们是字符串。现在，我故意让它变得不切实际地简单，因为这是我们将在下一步中自动化的部分，但请记住，在现实生活场景中，您可能只有几个端点，而每个端点中都有很多模式。</li><li id="c6ca" class="ma mb iq kf b kg mj kk mk ko ml ks mm kw mn la mf mg mh mi bi translated">端点定义—在步骤3中，我们创建了一个模式，在域部分，我们必须定义映射端点&lt;&gt;模式。在我们的例子中，我们简单地创建了映射到people变量的people端点(我们刚刚在第9行定义了它)</li></ol></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="97dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是你构建完整功能所需要的一切(除了它几乎没有用，但要使它有用，我们只需创建更多的端点和模式，这只是定义数据名称和类型(步骤3)并将它们映射到端点。这个故事的重点来了——让我给你介绍EveGenie！</p><div class="mo mp gp gr mq mr"><a href="https://github.com/DavidZisky/evegenie" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">大卫齐斯基/伊夫吉尼</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">一个使Eve模式生成更容易的工具。兼容Python3 - DavidZisky/evegenie</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">github.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf jw mr"/></div></div></a></div><p id="f4c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">EveGenie可以为您生成完整的settings.py文件，方法是向JSON文件提供您期望从API获得的数据。它的意思是，如果你有由某个UI、某个工具、你的同事或任何其他东西生成的JSON文件，你可以执行evegenie —它会读取它并为你创建模式和端点定义(+ MongoDB连接线和RESOURCE/ITEM_METHODS —所以是整个文件)。</p><p id="7e4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那怎么用呢？就像这样:</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="44ec" class="ls lt iq lo b gy lu lv l lw lx">python geneve.py sample.json</span></pre><p id="4189" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="li">注意:evegenie只兼容Python 3.x </em></p><p id="b194" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，忘记在5分钟内构建API吧…你可以在5秒内完成——在GitHub repo中，你还会找到简单的run.py文件，所以你只需要做两件事(假设你已经安装了eve，并且evegenie repo已克隆)就可以创建功能齐全且可运行的API:</p><ol class=""><li id="0058" class="ma mb iq kf b kg kh kk kl ko mc ks md kw me la mf mg mh mi bi translated"><strong class="kf ir"><em class="li">python geneve . py your _ data . JSON</em>T3】</strong></li><li id="b743" class="ma mb iq kf b kg mj kk mk ko ml ks mm kw mn la mf mg mh mi bi translated"><strong class="kf ir">T5】python run . pyT7】</strong></li></ol><p id="4317" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请记住，这将创建一个模式并运行API，但其中没有数据(您为evegenie提供的json文件仅用于创建模式，而不是加载数据)。但是因为您有API在运行，所以您可以简单地用完全相同的JSON文件发送一个POST请求。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="1f0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拥有以这种方式创建API的能力并不是开发人员的解决方案——虽然Eve仍然有许多功能，并且您肯定可以用它来构建非常丰富的生产级API——我向您展示了Eve的最基本用法，因为我将它用作快速微服务/网络测试的系统工程师。我不使用这个解决方案来创建一个API——我使用它来创建一个API，它将帮助我调试Kubernetes网络、Istio测试等问题。但关键是，如果你总是想尝试一些需要运行API的东西，但你不能这样做，因为你不是一个开发人员，或者你甚至是前端开发人员，并希望开始转向全栈角色，希望这是一个简单的解决方案。</p><p id="4b41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最诚挚的问候！</p></div></div>    
</body>
</html>
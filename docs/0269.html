<html>
<head>
<title>Simple Javascript Twitter Bot to greet new followers with a friendly message</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的Javascript Twitter机器人，以友好的信息问候新的追随者</h1>
<blockquote>原文：<a href="https://itnext.io/simple-javascript-twitter-bot-to-greet-new-followers-with-a-friendly-message-f9ac7f589d2d?source=collection_archive---------0-----------------------#2018-02-05">https://itnext.io/simple-javascript-twitter-bot-to-greet-new-followers-with-a-friendly-message-f9ac7f589d2d?source=collection_archive---------0-----------------------#2018-02-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4bb1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Javascript — Twitter Api教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1381a305369fc15ff6e8cb20b18c907a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Nxbf12Qm_QWsVfLyGeaodw.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">机器人的快速演示</figcaption></figure><p id="5c26" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fsimple-javascript-twitter-bot-to-greet-new-followers-with-a-friendly-message-f9ac7f589d2d" rel="noopener ugc nofollow" target="_blank"> <em class="ls">点击这里在LinkedIn </em>上分享这篇文章</a></p><p id="5396" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你在twitter上很活跃，你可能会注意到有些人在你关注他们之后会通过机器人立即给你发问候信息<strong class="kx ir">。如果您想告诉新的关注者他们可以在您的订阅源上找到什么样的内容，这可能特别有用。如果你的主要活动在不同的平台上，你可能也想让他们知道在哪里可以找到你，并给他们发送一个链接到你的个人资料。</strong></p><p id="fe20" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本教程中，我将向你展示如何通过<strong class="kx ir">几个简单的步骤</strong>建立这样一个机器人。现在，如果你对编码<strong class="kx ir"> </strong>不感兴趣，只想让机器人尽可能快地运行，你可能想直接跳到<a class="ae lr" href="https://github.com/justadudewhohacks/twitter-greet-followers-bot" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">库</strong> </a>并按照说明进行操作。然而，如果你对如何构建任何类型的twitter机器人感兴趣，我强烈推荐你阅读这篇文章。</p><h1 id="f271" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">它是如何工作的？</h1><p id="f535" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们所要做的就是编写一些javascript，调用twitter API，并将代码推送给heroku。你唯一需要的是twitter API的凭证和一个免费的heroku账户。</p><h2 id="9020" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated">获取您的Twitter API证书</h2><p id="231d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">如果你还没有，你可以在这里 用你的twitter账号<a class="ae lr" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">创建一个twitter应用。请注意，为了使用twitter API，您必须通过提供您的手机号码来验证您的twitter帐户。给你的应用起个名字，提供描述和网址(不必是现有的网址，你可以在这里输入类似<em class="ls">https://whatever.com</em>的东西)。切换到标签<strong class="kx ir"> <em class="ls">键和</em> </strong>访问令牌，向下滚动点击<strong class="kx ir"> <em class="ls">创建我的访问令牌</em> </strong>。就这样，现在您应该有了您的消费者密钥和消费者密码，以及您的访问令牌和访问令牌密码:</strong></a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/b75c6c37d4302f1db3b06e041913c67c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GjR6ay3UQ2RkY3XOZ_PehQ.png"/></div></div></figure><h2 id="16cb" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated"><strong class="ak">建立一个heroku账户</strong></h2><p id="c19d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">只需创建一个<a class="ae lr" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">免费账号</strong> </a>，下载heroku <a class="ae lr" href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">命令行界面</strong> </a>。不需要输入任何信用卡信息。</p><h1 id="1310" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">使用Twitter API</h1><p id="182d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">构建一个twitter机器人实际上很容易实现，至少比我预期的要容易。Twitter免费提供了一个<strong class="kx ir"> REST API </strong>和一个<strong class="kx ir">流媒体API </strong>。REST API提供了各种各样的功能，比如搜索和过滤推文、推文和转发、收藏、关注他人、发送直接消息等。使用流媒体API，您可以打开与其中一个流媒体端点的连接，并在<strong class="kx ir">实时</strong>获取推文或收听事件，这正是我们需要在有人跟踪我们时得到通知的内容。有兴趣的可以看看twitter <a class="ae lr" href="https://developer.twitter.com/en/docs" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> API文档</strong> </a>。</p><p id="cd6f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的机器人将非常简单，只包含几行代码。实际上，我们唯一要做的就是通过一个流来监听事件，一旦有用户关注我们，就直接发送消息。听起来很简单，但为了更简单，我们将使用<a class="ae lr" href="https://www.npmjs.com/package/twit" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> twit </strong> </a>，这是一个npm包，允许我们通过javascript轻松地与twitter API交互。</p><h1 id="0a55" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">给推特机器人编码</h1><p id="a2a3" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">使用<strong class="kx ir"> twit </strong>，我们可以如下设置twitter客户端:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7e6b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不要在你的源代码中放入任何种类的凭证。我们将凭证作为环境变量传递，稍后我们将为heroku配置这些环境变量。</p><p id="3bde" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来我们要做的是编写一些助手函数来验证我们的凭证是否有效:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="140c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并且用于向用户发送直接消息:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="75c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">重要！！！</strong>我们将始终使用字符串版本<strong class="kx ir"> <em class="ls"> id_str </em> </strong>的用户和tweet ids，因为javascript无法处理大的整数值，因此无法将id表示为数字。</p><p id="495b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要发送直接消息，我们必须指定收件人的id和文本，这是我们的问候消息:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1577" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以调整模板来插入您的问候语。此外，如果你知道他们的<strong class="kx ir"> utf-16代码</strong>，你可以发送表情符号(第6行)。查看这个网站 来查找表情符号的代码。</p><p id="592e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在一切就绪，我们可以向<strong class="kx ir">用户</strong>端点打开一个流:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="13fa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦我们确保了我们的凭证是有效的，我们将向流中添加一个监听器来捕捉任何<strong class="kx ir"> follow </strong>事件。当某个用户关注我们以及我们关注其他人时，将触发follow事件。显然，我们只想在第一种情况下发送问候消息，因此我们检查该事件的发起者的用户id(<strong class="kx ir"><em class="ls">源</em> </strong>)是否不是我们自己的<strong class="kx ir"> <em class="ls"> account_id </em> </strong>。方便的是，我们账户的id从<strong class="kx ir"> <em class="ls">账户/verify_credentials </em> </strong>端点返回。</p><p id="76a7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就这样了。我们现在可以把我们的代码推到heroku。</p><h1 id="631a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">将机器人部署到Heroku</h1><p id="99e5" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">如果您已经克隆了存储库，您可以简单地将cd放入克隆的文件夹中，否则请确保在您的工作目录中初始化一个新的git存储库:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="cf9e" class="mq lu iq ng b gy nk nl l nm nn">git init</span></pre><p id="8586" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们可以从CLI创建一个heroku应用程序。这将友好地将别名为<strong class="kx ir"> <em class="ls"> heroku </em> </strong>的遥控器添加到您的heroku应用程序存储库中:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="5fd5" class="mq lu iq ng b gy nk nl l nm nn">heroku app:create mytwitterbot1234</span></pre><p id="ac68" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来我们要做的是配置heroku使用我们的twitter API凭证。要从CLI设置环境变量，请使用以下命令并填写您的凭据:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="68ff" class="mq lu iq ng b gy nk nl l nm nn">heroku config:set consumer_key=xxx<br/>heroku config:set consumer_secret=xxx<br/>heroku config:set access_token=xxx<br/>heroku config:set access_token_secret=xxx</span></pre><p id="054f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，您可以提交所有更改，例如编辑问候消息并将代码推送到heroku，heroku将构建并运行您的应用程序:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="6a51" class="mq lu iq ng b gy nk nl l nm nn">git add .<br/>git commit -m "changed the greeting message"<br/>git push heroku master</span></pre><h2 id="5fda" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated">配置工作动态</h2><p id="8ffa" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">默认情况下，任何部署到heroku的应用程序都将在web dyno中运行，这意味着您可以从外部通过http请求访问它。显然，我们不希望这样，我们只是希望我们的机器人作为后台任务运行。因此，我们将关闭web dyno，并为我们的应用程序启动一个worker dyno:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="1e52" class="mq lu iq ng b gy nk nl l nm nn">heroku ps:scale web=0 worker=1</span></pre><p id="8863" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了生成worker dyno，还需要将一个Procfile推送到heroku存储库中。只需在该文件中指定以下启动命令，就可以开始了:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="78f3" class="mq lu iq ng b gy nk nl l nm nn">worker: node index.js</span></pre><p id="43c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果一切顺利，你的机器人应该正在运行。你可以通过跟随来测试你的机器人:<a class="ae lr" href="https://twitter.com/justapoliteguy" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir">justapoliteguy</strong></a>，他会跟着你回去。检查您的问候信息是否已发送。您可以通过取消关注和再次关注来重试任意多次。</p><h1 id="1052" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">解决纷争</h1><p id="da43" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">如果你的机器人似乎不工作，你可以打开你的应用程序的heroku仪表板，并通过点击右上角的<strong class="kx ir">更多</strong>按钮导航到<strong class="kx ir">查看日志</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/aecf86035e20a965e296e9dc3c0106e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSC_rtiuwQ-C2AXMl3ml8g.png"/></div></div></figure><p id="c36d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您看到输出<strong class="kx ir">凭证ok——运行bot </strong>，bot应该已经启动，正在观察新的追随者。由于日志只显示几行，您也可以将日志转储到文本文件中:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="46c6" class="mq lu iq ng b gy nk nl l nm nn">heroku logs -a mytwitterbot1234 &gt;&gt; logs.txt</span></pre><p id="cfb0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可能需要检查的另一件事是，您的凭据是否设置正确。导航到<strong class="kx ir">设置</strong>选项卡，点击<strong class="kx ir">显示配置变量</strong>。在此检查并编辑您的凭据。</p><p id="8a37" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">如果你喜欢这篇文章，欢迎留下一些掌声，关注我的媒体和/或</em> <a class="ae lr" href="https://twitter.com/justadudewhohax" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> twitter </em> </a> <em class="ls">:)。也可以随意在</em> <a class="ae lr" href="https://github.com/justadudewhohacks/twitter-greet-followers-bot" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="ls"> github资源库</em> </strong> </a> <em class="ls">上留下一颗星星。敬请关注更多教程！</em></p></div></div>    
</body>
</html>
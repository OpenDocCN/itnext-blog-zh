<html>
<head>
<title>Create your first Web scraper in Go with goQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Go with goQuery中创建您的第一个Web scraper</h1>
<blockquote>原文：<a href="https://itnext.io/create-your-first-web-scraper-in-go-with-goquery-2dcd45743165?source=collection_archive---------0-----------------------#2020-06-14">https://itnext.io/create-your-first-web-scraper-in-go-with-goquery-2dcd45743165?source=collection_archive---------0-----------------------#2020-06-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/eb2a74cee132d5ac8c6bac162ae4b175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/0*mOhHmscK225Wl_PC.jpg"/></div></figure><p id="834a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我已经在这个<a class="ae ks" href="http://blog.adnansiddiqi.me/tag/scraping/" rel="noopener ugc nofollow" target="_blank">博客</a>上报道网络抓取很长时间了，但是它们大部分是用Python写的；无论是Selenium还是Scrapy framework，都是基于Python语言的，但是scraping并不局限于特定的语言。任何为Http客户端和HTML解析器提供API或库的语言都能够为您提供web抓取工具。Go还为你提供了编写网页抓取器的能力。Go是一种编译和静态类型的语言，对于编写高效、快速和可扩展的web抓取器非常有用。感谢<em class="kx"> Goroutunes </em>可以帮助你并行抓取数百个网页。</p><p id="9d2c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇介绍性的文章中，我们将讨论由Go提供的访问网页或文件的Http库。我们还将讨论<strong class="jw ir"> goQuery </strong>，一个Http客户端和一个类似于jQuery的HTML解析器。好了，说够了，我们来写一个基础刮刀吧。</p><h1 id="719b" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">转到HTTP库</h1><p id="87f6" class="pw-post-body-paragraph ju jv iq jw b jx lw jz ka kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr ij bi translated">我正在编写一个简单的scraper，它将使用Go的<code class="fe kt ku kv kw b">net/http</code>库来访问我的主页。我正在写作。我将使用<code class="fe kt ku kv kw b">http.Get</code>访问该页面。<code class="fe kt ku kv kw b">http.Get</code>是Go提供的默认HTTP客户端，默认设置。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/cc31413f8c01e28a7aa8f45f3e7d383c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y_z69SW6hIpwWbgEMjWfBA.png"/></div></div></figure><p id="bd00" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当你运行这个程序时，它打印出我主页的HTML格式。函数<code class="fe kt ku kv kw b">getListing</code>访问通过的URL。为此我们使用了<code class="fe kt ku kv kw b">http.Get</code>方法。导出的函数<code class="fe kt ku kv kw b">Get</code>返回包含HTTP状态代码、响应内容本身等细节的响应对象。后来我使用了<code class="fe kt ku kv kw b">ioutuil</code>的<code class="fe kt ku kv kw b">ReadAll</code>来返回响应的文本。这一切都很好，但是正如我所说的,<code class="fe kt ku kv kw b">Get</code>返回默认设置，您不能覆盖像UserAgent、headers和timeout这样的东西。默认的用户代理是<code class="fe kt ku kv kw b">Go-http-client/1.1</code>，这对于同时检查浏览器用户代理的站点来说并不好。我们应该有一些选项来编写一个scraper，它可以覆盖用户代理、超时，并且还允许设置代理。让我们写一个真实世界的刮刀。</p><h1 id="cf5d" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建Yelp刮刀</h1><p id="ddaf" class="pw-post-body-paragraph ju jv iq jw b jx lw jz ka kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr ij bi translated">我们现在要在Go/Golang中创建一个Yelp scraper，它将抓取旧金山<em class="kx">手机维修店</em>的URL列表。我们将首先建立一个<em class="kx">客户端</em>并创建一个新的<em class="kx">请求</em>。<a class="ae ks" href="https://github.com/PuerkitoBio/goquery" rel="noopener ugc nofollow" target="_blank"> Goquery </a>将用于HTML解析。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mk"><img src="../Images/18e6d09bfb8016484a3b7c3a7c1d88ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WG5Sf3eIo1iT2W57o7uTQ.png"/></div></div></figure><p id="7b77" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我们设置了一个<code class="fe kt ku kv kw b">client</code>变量。由于<code class="fe kt ku kv kw b">client</code>是一个<code class="fe kt ku kv kw b">struct</code>变量，因此，我们使用<code class="fe kt ku kv kw b">&amp;</code>通过引用来调用它。我们将超时设置为30秒，这意味着它将在30秒后关闭连接，否则它将在死机前使用默认时间。接下来，我们通过调用<code class="fe kt ku kv kw b">http.NewRequest</code>创建一个新的请求，在这个例子中，我们传递请求方法<code class="fe kt ku kv kw b">GET</code>和URL。最后一个参数设置为<code class="fe kt ku kv kw b">nil</code>,因为在我们的例子中不需要。接下来，设置所需的头，然后通过调用<code class="fe kt ku kv kw b">client.Do</code>方法发出请求。</p><p id="24c2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦内容被接收，我们通过检查状态码200来确保，我们现在使用<em class="kx"> goQuery </em>库来解析HTML。</p><p id="831a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe kt ku kv kw b">doc, err := goquery.NewDocumentFromReader(resp.Body)</code></p><p id="4ea8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">稍后，我使用了接受CSS选择器并返回元素(如果有的话)的<code class="fe kt ku kv kw b">Find</code>方法。然后，获取的链接被追加到一个数组中，该数组随后被返回。在主打印它们。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ml"><img src="../Images/01a99e2dec664524e9b1eb0ce949314c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eNhFj5RNgBNCfmwd.png"/></div></div></figure><h1 id="e9cd" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="9c6e" class="pw-post-body-paragraph ju jv iq jw b jx lw jz ka kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr ij bi translated">这是关于在Go中编写网页抓取器的入门教程。Go产生了一个编译好的程序，所以不像Python，你可以毫不犹豫地把它分发给你的客户。也不需要安装Go运行时。一如既往，代码可在<a class="ae ks" href="https://github.com/kadnan/yelp-scraper-go" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p><p id="67da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">编写scrapers是一个有趣的旅程，但如果网站屏蔽了你的IP，你可能会碰壁。作为个人，你也买不起昂贵的代理。为您提供一个负担得起的，易于使用的API，让您刮网站没有任何麻烦。你不需要担心被屏蔽，因为Scraper API默认使用代理访问网站。除此之外，您也不需要担心Selenium，因为Scraper API也提供了无头浏览器的功能。我也写过如何使用它。</p><p id="3fed" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="kx">点击此处注册my或输入优惠码</em><strong class="jw ir"><em class="kx">Adnan 10</em></strong><em class="kx">，即可获得</em> <strong class="jw ir"> <em class="kx">九折优惠</em> </strong> <em class="kx">。如果你没有得到折扣，那么就在我的网站上通过电子邮件让我知道，我一定会帮助你。</em></p><p id="a5b3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="kx">打算用Python写一本关于Web抓取的书。点击</em> </strong> <a class="ae ks" href="https://forms.gle/YEyH4dTjeyrnB3DX9" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> <em class="kx">这里</em> </strong> </a> <strong class="jw ir"> <em class="kx">给你反馈</em> </strong></p></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><p id="6b71" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="kx">原载于2020年6月14日</em><a class="ae ks" href="http://blog.adnansiddiqi.me/create-your-first-web-scraper-in-go-with-goquery/" rel="noopener ugc nofollow" target="_blank"><em class="kx">http://blog . adnansiddiqi . me</em></a><em class="kx">。</em></p></div></div>    
</body>
</html>
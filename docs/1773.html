<html>
<head>
<title>TypeScript — Extract/Unpack a Type from a Generic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript —从泛型中提取/解包类型</h1>
<blockquote>原文：<a href="https://itnext.io/typescript-extract-unpack-a-type-from-a-generic-baca7af14e51?source=collection_archive---------0-----------------------#2019-01-25">https://itnext.io/typescript-extract-unpack-a-type-from-a-generic-baca7af14e51?source=collection_archive---------0-----------------------#2019-01-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0ce51d2da2a45820024b140239dc8dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rIXCN1SdFjAmK3Iw"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kc" href="https://unsplash.com/@stijnswinnen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Stijn Swinnen </a>拍摄</figcaption></figure><p id="95bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你有没有想过如何从复合类型中得到一个类型？</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0d5a" class="lk ll iq lg b gy lm ln l lo lp">type Puppy = Animal&lt;BigEyes, SmallNose, SmallEars&gt;;<br/>...<br/>type PuppyEyes = ExtractEyes&lt;Puppy&gt;;</span></pre><p id="b4db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是什么<code class="fe lq lr ls lg b">ExtractEyes</code>？它是如何工作的？</p><p id="e257" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">先来点背景。</p><h1 id="9c64" class="lt ll iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">条件类型</h1><p id="311e" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">TypeScript 2.8引入了一个名为<a class="ae kc" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html" rel="noopener ugc nofollow" target="_blank">条件类型</a>的新特性。<br/>这可以让你更好地控制那些相当流畅/动态的类型。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="84d7" class="lk ll iq lg b gy lm ln l lo lp">T extends U ? X : Y</span></pre><p id="a99c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我不想尝试解释这是什么以及如何应用，有许多资源比官方文档更好地解释了这个想法。</p><p id="c309" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我发现的关于条件类型的最好的文章是David Sheldrick的<a class="ae kc" href="http://artsy.github.io/blog/2018/11/21/conditional-types-in-typescript/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6716" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我鼓励您在继续之前阅读这篇文章，因为它将为您组织这个概念，并帮助您了解我们所取得的成就。</p><h1 id="8ee0" class="lt ll iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">让我们做比萨饼吧！</h1><p id="5f77" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">嗯，我们要用的例子不是小狗，而是披萨。写这篇文章的时候，我想我是饿了..</p><p id="1700" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们定义一个可以添加配料的比萨饼。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="17f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个普通的披萨类，几个浇头选项和一个预设的Margherita披萨。</p><p id="9cbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将创建一个接收浇头类型的函数，并公开一些函数来帮助我们购买浇头，这样我们就可以做比萨饼了。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="5bb6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，现在如果我们尝试购买pizza margherita，我们将有类型完成！</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/ff4d6d909389a0e1ef7996e51f648d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyDC_fObQDoZXpZ3StH0jg.png"/></div></div></figure><p id="1fa5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不错！</p><p id="412c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是你不觉得在<code class="fe lq lr ls lg b">PizzaMargherita</code>已经包含了浇头的情况下再传递浇头是多余的吗？</p><p id="5147" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们能利用它们呢？</p><h2 id="c3ca" class="lk ll iq bd lu my mz dn ly na nb dp mc ko nc nd mg ks ne nf mk kw ng nh mo ni bi translated">提取配料</h2><p id="ece5" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">这就是你应该了解<a class="ae kc" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html" rel="noopener ugc nofollow" target="_blank">条件类型</a>的地方，因为我们将使用它从比萨饼中“提取”浇头</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="7adf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在这里做的是“捕捉”浇头类型，并在<code class="fe lq lr ls lg b">P</code>是<code class="fe lq lr ls lg b">Pizza</code>类型的情况下返回它。</p><p id="2aa1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以现在让我们去掉多余的浇头类型，试试我们的运气:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/c0aa0cd7ff5cc636ff134ca22606a7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CFkiPGtHet1a9YVpafzvqQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">还有打字完成~ :D</figcaption></figure><p id="984d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太神奇了。</p><h1 id="132b" class="lt ll iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">陷阱</h1><p id="08b5" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">发这个帖子的真正原因是想和你分享一些我处理过的事情。</p><p id="134a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们加一些奶酪放在比萨饼上</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="8262" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，奶酪是可选的，我们有一个默认的奶酪类型。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/9c9455ee68a09ae739bb13540e6dfbaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1w69M6NS-elRAYmwANAidg.jpeg"/></div></div></figure><p id="3860" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">什么？现在<code class="fe lq lr ls lg b">toppings</code>的型号是<code class="fe lq lr ls lg b">never</code>！</p><p id="b212" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">问题在于<code class="fe lq lr ls lg b">ExtractToppings</code>类型:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="0773" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意，我们使用<code class="fe lq lr ls lg b">Pizza&lt;infer T&gt;</code>，这意味着这里的奶酪将默认为<code class="fe lq lr ls lg b">BaseCheeses</code>。</p><p id="76fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且由于<code class="fe lq lr ls lg b">BaseCheeses</code>有<code class="fe lq lr ls lg b">MargheritaCheeses</code>没有的<code class="fe lq lr ls lg b">feta</code>→<code class="fe lq lr ls lg b">MargheritaCheeses</code>不延伸<code class="fe lq lr ls lg b">BaseCheeses</code>！</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="c7d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lq lr ls lg b"><strong class="kf ir">PizzaMargherita</strong></code> <strong class="kf ir">不延伸</strong> <code class="fe lq lr ls lg b"><strong class="kf ir">Pizza&lt;infer T, BaseCheeses&gt;</strong></code> <strong class="kf ir">！</strong></p><p id="6d61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们得到了不需要的<code class="fe lq lr ls lg b">never</code>类型..</p><h2 id="d2d7" class="lk ll iq bd lu my mz dn ly na nb dp mc ko nc nd mg ks ne nf mk kw ng nh mo ni bi translated">修复它</h2><p id="e3b0" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">这是一个简单的修复，现在我们知道问题是什么了。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="ff2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们所做的只是给出一个更容易接受的类型。在这种情况下，我们选择了<code class="fe lq lr ls lg b">any</code>。通过这种方式，我们声明我们并不真正关心比萨饼中的奶酪类型，我们只关心上面的配料。</p><p id="c4a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们又回到了以前的类型完成:)</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/c0aa0cd7ff5cc636ff134ca22606a7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CFkiPGtHet1a9YVpafzvqQ.png"/></div></div></figure><h1 id="998c" class="lt ll iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">结论</h1><p id="0656" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">通常，当您开始使用TypeScript的这些高级功能时，这意味着您可能会构建一个框架或类似的东西。</p><p id="0f4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您真的需要使用这样的东西，那么了解TypeScript的功能还是不错的。</p></div></div>    
</body>
</html>
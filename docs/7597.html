<html>
<head>
<title>Flutter Native Ads</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">飘扬的本土广告</h1>
<blockquote>原文：<a href="https://itnext.io/flutter-native-ads-92d802fbd927?source=collection_archive---------0-----------------------#2022-11-19">https://itnext.io/flutter-native-ads-92d802fbd927?source=collection_archive---------0-----------------------#2022-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9f9e01ae6f5e2587d33e2c1392259dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCp1LoiFd7ITOYddQooxuQ.png"/></div></div></figure><p id="5670" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有一些文档，甚至是我们将在本教程中遵循的<a class="ae kw" href="https://codelabs.developers.google.com/codelabs/admob-inline-ads-in-flutter#0" rel="noopener ugc nofollow" target="_blank"> codelab </a>,但通常有一些没有注意到的零碎内容，可能会被跳过，最终，你会浪费很多时间去弄清楚这些。这就是为什么我们将重点放在原生广告上，因为其他人的教程看起来很好，而且简单得多。</p><p id="ea61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为什么要使用原生广告呢？即使实现起来更复杂，答案也很简单——用户体验。没有人喜欢收到垃圾广告，通常免费应用程序会整合广告，以获得一些被动收入来维持项目的进行。因此，原生广告似乎是实现这一目标最不具侵入性的方式。</p><p id="7bf4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">重要提示:在构建和测试你的应用时，确保你使用的是</em> <a class="ae kw" href="https://developers.google.com/admob/android/test-ads" rel="noopener ugc nofollow" target="_blank"> <em class="kx">测试广告</em> </a> <em class="kx">，而不是现场制作广告。否则可能会导致您的帐户被暂停</em></p><h1 id="d880" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤1:广告群设置</h1><p id="be9f" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">设置你的<a class="ae kw" href="https://apps.admob.com/v2/home" rel="noopener ugc nofollow" target="_blank"> ad mob </a>账户，添加android和iOS应用(截图来自<a class="ae kw" href="https://codelabs.developers.google.com/codelabs/admob-inline-ads-in-flutter#0" rel="noopener ugc nofollow" target="_blank"> codelab </a></p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/f532dd8975cd14ac94f9cf0bdc19d42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ip6i2I0km0sQUdCU"/></div></div></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/fe3bf3da8dfb9c4fa5747e2afd69931d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xvyrXZv1hcOxWNul"/></div></div></figure><p id="cdfe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Foreach创建本地添加单元:(截图来自<a class="ae kw" href="https://codelabs.developers.google.com/codelabs/admob-inline-ads-in-flutter#0" rel="noopener ugc nofollow" target="_blank"> codelab </a>)</p><p id="7423" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要添加广告单元:</p><ol class=""><li id="272b" class="mh mi iq ka b kb kc kf kg kj mj kn mk kr ml kv mm mn mo mp bi translated">从AdMob控制台的“应用”菜单中选择AdMob内联广告应用。</li><li id="bd38" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">单击广告单位菜单。</li></ol><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/23feec2a2a1d7197597070a6ad82f6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n0Z9Pl_6C-n_DNVI"/></div></div></figure><h1 id="0ee4" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤2:在flutter应用程序中添加ad mob集成</h1><p id="27c2" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">在你的flutter应用中添加并安装一个<a class="ae kw" href="https://pub.dev/packages/google_mobile_ads" rel="noopener ugc nofollow" target="_blank"> google_mobile_ads </a>包，之后我们需要在android的android manifest和iOS的Info.plist中添加ad mob的凭证。这是来自<a class="ae kw" href="https://codelabs.developers.google.com/codelabs/admob-inline-ads-in-flutter#0" rel="noopener ugc nofollow" target="_blank"> codelab </a>的简单实现，但是如果你使用了flavor，记得在每个环境中使用变量。变量的例子在<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/flutter-new-app-setup-with-flavors-in-one-go-331471b127e3">颤振风味</a>文章中。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/e2f11fc873951390c368be49a7f3766e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dhq82Q8SVyX_WE8W"/></div></div></figure><h1 id="fd8e" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤3:初始化谷歌移动广告SDK</h1><p id="9be8" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">首先，初始化你的flutter ads包，在主页加载之前初始化SDK，你也可以创建一个<a class="ae kw" href="https://codelabs.developers.google.com/codelabs/admob-inline-ads-in-flutter#4" rel="noopener ugc nofollow" target="_blank"> AdHelper </a>类，以便于管理。这是从后端触发生产ad ids以在prod和test helper之间切换的一种很好的方式。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="b263" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤4:实现原生广告</h1><h2 id="0eec" class="mz kz iq bd la na nb dn le nc nd dp li kj ne nf lm kn ng nh lq kr ni nj lu nk bi translated">实现Android的NativeAdFactory(kot Lin)，下面是我们接下来要提到的文件路径的截图。</h2><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/bcc6ca1c8045821920c8d45dd6f93e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/0*zktIIXy6n7F3KfiK"/></div></figure><p id="2692" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们将创建一个名为list_tile_native_ad.xml的原生广告布局，这是一个基本的列表布局，请注意，该布局应符合其目标平台的用户体验的视觉设计。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="cdfa" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建ListTileNativeAdFactory类</h1><p id="807b" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">工厂类负责创建用于呈现原生广告的视图对象。从代码中可以看出，factory类创建了一个NativeAdView，并用一个NativeAd对象填充它。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="cb35" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">注册ListTileNativeAdFactory类</h1><p id="770b" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">NativeAdFactory的实例应该注册到GoogleMobileAdsPlugin，然后才能从Flutter端使用它。因此，相应地更新您的MainActivity.kt:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="0c84" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">为iOS实施NativeAdFactory(Swift)</h1><h1 id="1675" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">准备原生广告布局</h1><p id="0e43" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">您需要一个自定义视图(*。xib)用于布局原生广告资产。这是一个由codelab组合而成的布局，我们一路上都会提到:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="b4b4" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建ListTileNativeAdFactory类</h1><p id="3c85" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">工厂类负责创建用于呈现原生广告的视图对象。从代码中可以看出，factory类创建了一个GADNativeAdView，并用一个GADNativeAd对象填充它。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="8360" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">注册ListTileNativeAdFacotry类</h1><p id="10ee" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">FLTNativeAdFactory的实现应在FLTGoogleMobileAdsPlugin中注册，然后才能从Flutter端使用。因此，相应地更新AppDelegate.swift:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="4f16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意:codelab就是这样，但它给<a class="ae kw" href="https://stackoverflow.com/questions/72870086/why-theres-no-iboutlet-on-gadnativeview-when-implementing-google-admob-native-a" rel="noopener ugc nofollow" target="_blank">网点</a>带来了一个问题。为了解决这个问题，我们将在AppDelegate swift所在的文件夹中添加一个名为GADNativeAd.h的新文件:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="d9a8" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤5:将原生广告与Flutter小部件集成在一起</h1><p id="282a" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">这是dart实现的一个示例，您可以在任何列表中调用它:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="78ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽管你可以在本教程的几乎所有内容中使用codelab，除了文件的出口和路径问题(特别是如果你没有使用Android Studio的话),但我认为如果你第一次在Flutter中实现原生广告，这将对你有所帮助。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Managed Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">托管服务</h1>
<blockquote>原文：<a href="https://itnext.io/managed-services-6e205f502098?source=collection_archive---------2-----------------------#2020-03-29">https://itnext.io/managed-services-6e205f502098?source=collection_archive---------2-----------------------#2020-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b639" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">TL；博士:朋友不让朋友自己卷</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27515c49fd77172a1031e9db4efda27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pow_o1ZcMEu5ncCdAm4CmA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者不详——该文件来自英国国家档案馆收藏，文件编号为FO850/234。对于国家档案馆收藏的任何项目的高质量复制品，请联系图像图书馆。，公共领域，<a class="ae ky" href="https://commons.wikimedia.org/w/index.php?curid=501979" rel="noopener ugc nofollow" target="_blank">https://commons.wikimedia.org/w/index.php?curid=501979</a></figcaption></figure><p id="a1b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经听过一千遍了:Datadog(你的度量/日志提供商的占位符名称)太贵了，为什么我们不推出自己的产品？我们是开发商，没那么复杂。只需安装Elasticsearch + kibana、influx和grafana(跟着<a class="ae ky" href="https://www.youtube.com/watch?v=iEe_eraFWWs" rel="noopener ugc nofollow" target="_blank"> my humps </a>的音乐一起唱)，把一些普罗米修斯扔进火山口，我们就大功告成了。</p><p id="28ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">哦，亲爱的，我们才刚刚开始。</strong></p><p id="f596" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在需要在生产中管理Elasticsearch/influence(可能两者都有),这可能超出了我们的预期(我可以告诉你当我发现我们在elastic search中没有空间时的情况)，我们现在需要知道的远不止我们已经使用过的公共api的部分，同时在我们的机器上的quickstart容器中测试它。</p><p id="59a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还需要管理运行它们的虚拟机(或者它们下面的kubernetes基础设施)。现在谁负责监控我们是否真正得到了我们期望的所有指标？我们是。实施越来越多的特定工具来收集额外的指标？我们请客。</p><p id="d8f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">哦，你还需要APM。祝好运<a class="ae ky" href="https://opentracing.io/" rel="noopener ugc nofollow" target="_blank"> opentracing </a>和<a class="ae ky" href="https://www.jaegertracing.io/" rel="noopener ugc nofollow" target="_blank"> jaeger </a>将所有这些整合在一起，这样我们就可以将跟踪与日志和度量一起查看。当您的团队发现生产中没有日志时，谁的工作是修复它？这是像生产停止时那样严重的事件吗？答案大概是肯定的。</p><p id="5cca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的团队现在表现更好了吗？，当他们除了编写您的产品实际需要的代码之外，还需要专注于管理这个操作平台时？答案大概是<strong class="lb iu">没有</strong>。你<strong class="lb iu">可能</strong>节省了几美元(而<strong class="lb iu">可能</strong>是正确的词，你也可能在托管服务上超支——见后文),但你几乎可以肯定在开发人员生产力上花费了更多。</p><p id="3766" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然监控和日志似乎最容易受到这种逻辑的影响，但它们并不孤单。在其他领域，自己创业通常不是一个好主意。</p><p id="cc9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">持久性</strong></p><p id="6e5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">持久性通常是下一个候选对象，我最近在SQL领域很少看到这种情况，AWS RDS和其他云供应商的类似产品已经将托管SQL(无论您选择什么方言)作为goto解决方案，尽管我仍然偶尔会遇到“它是安全的，因为mysql与我的应用程序运行在同一个虚拟机中，所以它不是公共的”这样的问题。</p><p id="dfb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是当你去NOSQL空间的时候？每个人似乎都提出了其他选择。在生产中运行大型数据库是<strong class="lb iu"> c o m p l i c a t e d </strong>。在你强大的Kubernetes infra上运行它们？更难。修补/扩展/分片/重分片/监控等等。这可能是你的服务的一个关键部分，所以你不能只是修补一些东西并希望它能工作。这就是你，掉进了做DBA工作的兔子洞，而不是编写为你的业务提供动力的代码。</p><p id="5db8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">续词</strong></p><p id="855a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几乎每个人似乎都认为他们应该运行自己的詹金斯，一切都会好的。是的，使用kubernetes pods作为工作器或自动扩展虚拟机比以前更容易扩展这种服务，但这几乎不是复杂的部分。您仍然需要处理清理工作(尤其是存储所有那些额外的docker层),更重要的是，原子性——CI构建必须被隔离。你不能仅仅“相信”编写测试套件的人会正确地做这件事。还有嘿:安全性呢？如果因为拼凑起来的CI服务无法承受压力而无法部署到生产环境中，会发生什么情况？您的“自行开发”CI服务支持高可用性吗？是的，你可以忽略它，但是有太多的选项而不是一个经过仔细审查的子集并不总是对你最有利。</p><p id="1c6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在对于kubernetes，analytics等。涮一涮，重复一遍，都是同一首歌。经营自己的公司可能比你想象的要复杂得多，而且总是有价格标签。</p><p id="48b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">弹性和一些额外成本</strong></p><p id="0c6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了开发人员的注意力和时间问题，滚动自己的，尤其是当你不是大，可以证明是相当昂贵的。托管服务通常可以优化他们的基础架构购买。对于数据库，较低的层使用率允许他们在多租户模型中重复使用相同的虚拟机。对于多租户部署，其他服务可能共享度量或日志的数据库。他们可以优化现场虚拟机和批量采购。</p><p id="1426" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">不能</strong>(或者至少，更难)。</p><p id="5c15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能还需要提供超出常规/预期需求的资源，以防范意外的使用高峰并适应增长。托管服务可能会针对峰值“正常化曲线”,在不同用户之间分摊额外的配置成本。这意味着您为这一额外容量支付的费用可能会高于使用托管服务支付的费用。是的，在云供应商的时代，这比实际购买一台机器并将其连接到机架上要容易得多，但仍然有附加的成本。</p><p id="4c41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么这要花多少钱呢？</p><p id="709d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">托管服务有这样一个特点:你其实知道它们值多少钱。可以推理一下。计算一下您的使用情况和增长情况。当你运行自己的软件时——即使不考虑开发团队的成本和时间，也很难计算出这实际上花费了你多少。如果您正在运行一个大型Kubernetes集群，这一点尤其正确。您的成本中有多少是与运行数据库的pod相关的？IOPS有多少磁盘是由您自己的CI服务驱动的？它可能会迫使你购买额外昂贵的ultra something磁盘。我们如何将这些数据的导入成本分开？你可能不在乎这个。但在未来的某个时候，了解这些东西并能够对您的基础架构预算进行推理将非常重要。</p><p id="535e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">通用指令:</strong></p><p id="d3a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的业务中，购买/构建难题是常见的。这是可以理解的。我们从事的是软件开发业务，我们可能会与现有的团队一起开发，我们也可能会购买服务。但是就像我告诉我的孩子的:</p><p id="bb95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">能够做某事并不意味着这是个好主意。</strong></p><p id="81a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我建议使用软件开发的一般指导作为经验法则:</p><p id="d3fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">“关注你的实际产品”。</strong></p><p id="83e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行CI服务是您实际产品的一部分吗？是管理一个监控平台？如果答案是否定的，那么你应该重新考虑这样做。</p><p id="2a88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">异常情况</strong></p><p id="359c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般指令也有例外:</p><ul class=""><li id="b541" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">当你非常大的时候，购买/建造等式改变了:从建造方面来说，你现在有巨大的建造能力，从购买方面来说，你观察到小的变化节省变成了真正的大钱。您可以构建自己的监控平台或协调引擎，构建自己的数据中心等。当你在监控上花费数百万美元时，推出你自己的监控是完全合理的，这样你既可以节省美元，又可以获得你现在可能需要的控制。我从未在该行业的这一方面工作过，但这肯定是一个明智的决定。</li><li id="4575" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">当你非常非常小的时候。但不是因为这样就可以管理自己的Elasticsearch集群，而是因为你不需要它。您可以在虚拟机上使用bash脚本定期向S3发送日志文件，并向Cloudwatch发送一些基本的虚拟机指标，从而获得“足够好的解决方案”。APM可能通过IDE调试器连接到生产环境，或者在那台机器上运行strace。有些事情本来就是一个爱好/兼职项目，并不打算成长，这没关系。</li><li id="6849" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">当您有一个非常具体的使用案例，其中托管服务提供的挂钩和控制不足以根据您的特定需求定制托管服务。</li><li id="ce51" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">当你的实际产品正在构建这种服务或生态系统中的某些东西时，需要对工具有深入的了解。如果您正在构建一个监控服务，您可能需要运行自己的时间序列数据库，因为您需要对它了如指掌。如果你从事情报工作。那么是的，你应该运行你自己的构建(咄)。</li></ul><p id="ac1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">但这种情况很少发生</strong>。虽然几乎每个人都认为他们有一个超级具体的用例，但通常是<strong class="lb iu">，因为他们没有阅读手册</strong>或联系支持。很有可能以前有人做过。你可能没那么小。<strong class="lb iu">也没有那么大。</strong></p><p id="67db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简要回顾一下:你的开发团队是你的主要资产。你不想把时间花在错误的地方。只需要使用一个该死的托管服务就可以了(但是要仔细评估是什么托管服务，这是另一篇文章的问题)</p></div></div>    
</body>
</html>
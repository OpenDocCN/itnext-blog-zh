<html>
<head>
<title>Modern C++ in Advent of Code: Day17</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代C++代码的出现:第17天</h1>
<blockquote>原文：<a href="https://itnext.io/modern-c-in-advent-of-code-day17-16333c720226?source=collection_archive---------2-----------------------#2021-12-17">https://itnext.io/modern-c-in-advent-of-code-day17-16333c720226?source=collection_archive---------2-----------------------#2021-12-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d8da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天是代码问世<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">的第十七天。今天，我们将模拟一个抛射体在水中的轨迹。</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/8b328a4d6d878fdb23d27adf860ecbe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqfxFaRlu6S-rbAspyzN_A.png"/></div></div></figure><p id="4d85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，请先尝试解决问题，然后再看解决方案。对于本系列中的所有文章，<a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">查看此列表</a>。</p><h1 id="df21" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第17天</h1><p id="7028" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">作为输入，我们接收目标的x和y位置，对于第一部分，我们的任务是确定一个奇特的轨迹，在这个轨迹上，我们希望尽可能高地发射炮弹，但仍然击中目标。</p><p id="513e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mb mc md me b">target area: x=277..318, y=-92..-53</code></p><p id="4311" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模拟是初步的。每次滴答，抛射体基于其x和y速度移动，然后我们减小/增大这些速度:</p><ul class=""><li id="f0be" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">x速度趋于零；也就是说，负的x速度每增加一个节拍，正的x速度每减少一个节拍(零速度保持为零)</li><li id="5cf0" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">y速度每一次跳动都减少(模拟重力)</li></ul><p id="eb6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们将一个抛射体垂直向下发射，它会一直加速，如果我们将它垂直向上发射，它会减速，在某一点达到零速度，然后开始下落并加速。</p><p id="0861" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从编程的角度来看，解决一般情况下的这个问题变得相当麻烦，也不是特别有趣。因此，我将做一些简化:</p><ul class=""><li id="f607" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">目标的x坐标总是正的</li><li id="56e6" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">目标的y坐标总是负的</li><li id="156d" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">目标足够“宽”(我们将在后面讨论这个问题)</li></ul><h2 id="36b3" class="mt kz iq bd la mu mv dn le mw mx dp li jy my mz lm kc na nb lq kg nc nd lu ne bi translated">对称</h2><p id="e805" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们考虑一下，当我们向上发射时，抛射体的y位置会发生什么。在某个点，它将再次落在轴上(位置<code class="fe mb mc md me b">y==0</code>，这是因为该过程是对称的(考虑零速度中点，周围的速度将是<code class="fe mb mc md me b">...4 3 2 1 0 1 2 3 4...</code>)。这也意味着抛射体将有相同的速度穿过轴。</p><p id="ca37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们可以乐观地假设，我们将能够找到相应的x速度，并考虑目标<code class="fe mb mc md me b">y_min</code>的底线。可能的最高速度是抛射体在到达<code class="fe mb mc md me b">y==0</code>后马上到达<code class="fe mb mc md me b">y_min</code>。因此，起始速度就是<code class="fe mb mc md me b">vy_max=-y_min-1</code>(比允许我们到达<code class="fe mb mc md me b">y_min</code>的速度小一)。</p><p id="0dae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们有了速度，我们就知道我们到达了中点<code class="fe mb mc md me b">vy_max+1</code>，在这里速度将为零。最后，我们需要计算出实际的距离。</p><p id="1963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于y-position，我们知道位置是<code class="fe mb mc md me b">vy + vy-1 + vy-2...</code>的和，可以改写为<code class="fe mb mc md me b">vy*steps — (0+1+2...)</code>并简化和:<code class="fe mb mc md me b">vy*ticks-ticks*(ticks-1)/2</code>。x的公式非常相似，除了我们需要在速度为零的点停下来，所以<code class="fe mb mc md me b">new_ticks=min(ticks,vx+1)</code>然后我们可以重用公式:<code class="fe mb mc md me b">vx*new_ticks-new_ticks*(new_ticks-1)/2</code>。</p><p id="1f47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们知道速度，我们可以计算公式:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7421" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我确实提到了简化。我们有可能找不到一个x速度，也能以相同的节拍数落在目标上。为了解决一般情况下的这个问题，我们必须从<code class="fe mb mc md me b">y_min</code>开始向上扫描，如果我们仍然没有找到匹配，考虑在<code class="fe mb mc md me b">y==0</code>和到达目标之间有一个(或多个)中点的情况。</p><h2 id="bcb1" class="mt kz iq bd la mu mv dn le mw mx dp li jy my mz lm kc na nb lq kg nc nd lu ne bi translated">找到所有落在目标上的速度</h2><p id="65ba" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">正确的方法是从目标开始，使用y位置来确定可能的速度。我们知道<code class="fe mb mc md me b">y==0</code>下面的距离必须表示为<code class="fe mb mc md me b">vy+vy-1+vy-2...</code>，从那里，我们将产生所有相应的x速度，这些速度落在目标上。</p><p id="43d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，对于这么简单的事情来说，这太费力了。这是一种蛮力:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7944" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道，我们的y速度必须至少为<code class="fe mb mc md me b">y_min</code>，一步到达底部边界，最多为<code class="fe mb mc md me b">vy_max</code>，这是我们在第一部分中确定的。类似地，对于x速度，最大值是<code class="fe mb mc md me b">x_max</code>，它在一步中到达右边界(我们可以将最小值限制得更紧，但是没有理由)。</p><p id="5062" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我为可能是一个令人失望的解决方案道歉，但是适当-适当的方法是如此远离蛮力解决方案的简单性，并且问题域是如此之小以至于我真的找不到能量。我希望它对你有所帮助。</p><h1 id="3af5" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">链接和技术说明</h1><p id="4698" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">每日解决方案存储库位于:<a class="ae kl" href="https://github.com/HappyCerberus/moderncpp-aoc-2021" rel="noopener ugc nofollow" target="_blank">https://github.com/HappyCerberus/moderncpp-aoc-2021</a>。</p><p id="c84a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">查看此列表，了解《代号</a>问世前几天的文章。</p><p id="4637" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请不要忘记亲自尝试<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">降临码</a>。</p><h1 id="33c6" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">感谢您的阅读</h1><p id="93f6" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">感谢您阅读这篇文章。你喜欢吗？</p><p id="4c64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也在YouTube上发布视频。你有问题吗？在<a class="ae kl" href="https://twitter.com/SimonToth83" rel="noopener ugc nofollow" target="_blank">推特</a>或<a class="ae kl" href="https://www.linkedin.com/in/simontoth" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div></div>    
</body>
</html>
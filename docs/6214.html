<html>
<head>
<title>How To Forward Call Information From Android Device to Web Side? Part 02: Server side</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Android设备的来电信息转发到Web端？第2部分:服务器端</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-forward-call-information-from-android-device-to-web-side-part-02-server-side-98f200fa888?source=collection_archive---------6-----------------------#2021-09-20">https://itnext.io/how-to-forward-call-information-from-android-device-to-web-side-part-02-server-side-98f200fa888?source=collection_archive---------6-----------------------#2021-09-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/aa4b83aeb45567c4516a05a00c74ab71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z7kTUms9b328y9eRucfA3A.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">系统概况</figcaption></figure><p id="8225" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个故事是该系列的下一部分——如何将来自Android设备的呼叫信息转发到Web端？在第01部分中，我们完成了一个Android应用程序的构建。</p><p id="6e45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个故事中，我们将完成服务器端部分——处理来自应用程序的请求。</p><h1 id="0d99" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">带有Typescript的初始服务器项目</h1><p id="c703" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在这个项目中，我使用Nodejs v12.22.6。</p><p id="bd01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">初始节点项目:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="7d35" class="mj ky iq mf b gy mk ml l mm mn">$ npm init -y</span></pre><p id="f6ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装依赖项包:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="71fa" class="mj ky iq mf b gy mk ml l mm mn"># dependencies<br/>$ npm install dotenv express moment mongoose socket.io -S</span><span id="3985" class="mj ky iq mf b gy mo ml l mm mn"># dev dependencies<br/>$ npm install @types/dotenv @types/express @types/moment @types/mongoose @types/socket.io ts-node-dev typescript</span></pre><p id="48ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建Typescript配置文件:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="d5a4" class="mj ky iq mf b gy mk ml l mm mn">$ npx tsc --init</span></pre><p id="4590" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我的<code class="fe mp mq mr mf b">tsconfig.json</code>文件:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="ad3e" class="mj ky iq mf b gy mk ml l mm mn">{<br/>  "compilerOptions": {<br/>    "target": "ES2018",<br/>    "module": "commonjs",<br/>    "sourceMap": true,<br/>    "outDir": "./dist",<br/>    "rootDir": "./src",<br/>    "strict": true,<br/>    "esModuleInterop": true,<br/>    "skipLibCheck": true,<br/>    "forceConsistentCasingInFileNames": true<br/>  }<br/>}</span></pre></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="9d2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们用expressjs创建一个简单的http服务器:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="9b61" class="mj ky iq mf b gy mk ml l mm mn">// src/app.ts<br/>import express from 'express';</span><span id="5c03" class="mj ky iq mf b gy mo ml l mm mn">const app = express();<br/>app.use(express.json());</span><span id="3c15" class="mj ky iq mf b gy mo ml l mm mn">app.get('/', (req, res) =&gt; {<br/>  res.json({ message: 'Hello World!' });<br/>});</span><span id="c9da" class="mj ky iq mf b gy mo ml l mm mn">export default app;</span></pre><p id="11e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建<code class="fe mp mq mr mf b">server.ts</code>文件来启动服务器:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="6cc4" class="mj ky iq mf b gy mk ml l mm mn">// src/server.ts<br/>import * as http from 'http';<br/>import dotenv from 'dotenv';<br/>import app from './app';</span><span id="29a1" class="mj ky iq mf b gy mo ml l mm mn">(async () =&gt; {<br/>  dotenv.config(); // load environment variable from .env file</span><span id="bcc2" class="mj ky iq mf b gy mo ml l mm mn">  const server = http.createServer(app);</span><span id="edd6" class="mj ky iq mf b gy mo ml l mm mn">  server.listen(process.env.PORT, () =&gt; {<br/>    console.log(`listening on *: ${process.env.PORT}`);<br/>  });<br/>})();</span></pre><p id="b3ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用<code class="fe mp mq mr mf b">.env</code>文件:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="14c7" class="mj ky iq mf b gy mk ml l mm mn"># .env<br/>PORT=3000</span></pre><p id="4c93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在开发模式下启动服务器:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="d020" class="mj ky iq mf b gy mk ml l mm mn">$ npx ts-node-dev src/server.ts</span><span id="6541" class="mj ky iq mf b gy mo ml l mm mn">[INFO] 15:39:41 ts-node-dev ver. 1.1.8 (using ts-node ver. 9.1.1, typescript ver. 4.3.5)<br/>listening on *: 3000</span></pre><p id="dc3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了确保它能工作，你可以用你的浏览器访问<a class="ae kw" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a>URL。</p><h1 id="057a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">定义猫鼬模型</h1><p id="53b6" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们定义了两个集合:<code class="fe mp mq mr mf b">customers</code>和<code class="fe mp mq mr mf b">call-states</code>。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/ae5d1d449d9ebae33208b17ff88bb145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZB9mYFm5sjnP4LYt7AWqg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">数据库图表</figcaption></figure><p id="1658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr mf b">customers</code>收款商店客户信息:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="1934" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr mf b">call-states</code>收集门店来电信息:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="1e49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只处理<code class="fe mp mq mr mf b">incomming</code>状态，那么<code class="fe mp mq mr mf b">type</code>的值就是<code class="fe mp mq mr mf b">incomming</code></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="20a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用docker启动一个MongoDB服务:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="1e9f" class="mj ky iq mf b gy mk ml l mm mn">$ docker run -it --rm -p 27017:27017 mongo</span></pre><p id="5c6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更新<code class="fe mp mq mr mf b">.env</code>文件以提供<code class="fe mp mq mr mf b">MONGO_URI</code>值:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="9b8b" class="mj ky iq mf b gy mk ml l mm mn"># .env<br/>PORT=3000<br/>MONGO_URI=mongodb://localhost:27017/tiny-crm</span></pre><p id="99a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr mf b">tiny-crm</code>是数据库名称。</p><p id="d0e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，在启动http服务器之前，更新<code class="fe mp mq mr mf b">server.ts</code>文件以启动连接:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="cf80" class="mj ky iq mf b gy mk ml l mm mn">// src/server.ts<br/>import * as http from 'http';<br/>import dotenv from 'dotenv';<br/>import app from './app';<br/>import mongoose from 'mongoose';</span><span id="c947" class="mj ky iq mf b gy mo ml l mm mn">(async () =&gt; {<br/>  dotenv.config();</span><span id="2b57" class="mj ky iq mf b gy mo ml l mm mn">  const server = http.createServer(app);</span><span id="d963" class="mj ky iq mf b gy mo ml l mm mn">  await mongoose.connect(process.env.MONGO_URI as string, {<br/>    useNewUrlParser: true,<br/>    useUnifiedTopology: true,<br/>    useCreateIndex: true,<br/>  });</span><span id="d788" class="mj ky iq mf b gy mo ml l mm mn">  server.listen(process.env.PORT, () =&gt; {<br/>    console.log(`listening on *: ${process.env.PORT}`);<br/>  });<br/>})();</span></pre><h1 id="74dc" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">处理呼叫状态API</h1><p id="8513" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们需要一个express handle函数来处理来自Android应用程序的请求。</p><p id="b752" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">带有正文的请求<code class="fe mp mq mr mf b">POST /api/v1/call-states</code>如下所示:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="98e1" class="mj ky iq mf b gy mk ml l mm mn">{<br/>  "phone_number": "+199999999",<br/>  "state": "RINGING",<br/>  "timestamp: 1631952316686<br/>}</span></pre><p id="cf77" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们创建<code class="fe mp mq mr mf b">call-state.controller.ts</code>文件:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="ead6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尝试通过<code class="fe mp mq mr mf b">phoneNumber</code>找到一个客户，如果该客户已经存在，只需为该客户创建<code class="fe mp mq mr mf b">call-state</code>。</p><p id="0c47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果客户不存在，我们将用来电号码创建一个新客户，然后为新客户创建<code class="fe mp mq mr mf b">call-state</code>。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="9ab6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向http服务器注册控制器功能。让我们更新<code class="fe mp mq mr mf b">app.ts</code>文件:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="8cbf" class="mj ky iq mf b gy mk ml l mm mn">// src/app.ts<br/>import express, { Router } from 'express';<br/>import callStateController from './controllers/call.state.controller';</span><span id="2129" class="mj ky iq mf b gy mo ml l mm mn">const app = express();<br/>app.use(express.json());</span><span id="3abe" class="mj ky iq mf b gy mo ml l mm mn">app.get('/', (req, res) =&gt; {<br/>  res.json({ message: 'Hello World!' });<br/>});</span><span id="bc9e" class="mj ky iq mf b gy mo ml l mm mn">const router = Router();<br/>router.post('/call-states', callStateController.handleNewCallState);</span><span id="a83c" class="mj ky iq mf b gy mo ml l mm mn">app.use('/api/v1', router);</span><span id="3b73" class="mj ky iq mf b gy mo ml l mm mn">export default app;</span></pre><p id="ed42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尝试向新端点发送请求:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="1a39" class="mj ky iq mf b gy mk ml l mm mn">$ curl --request POST \<br/>  --url <a class="ae kw" href="http://localhost:3000/api/v1/call-states" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/api/v1/call-states</a> \<br/>  --header 'content-type: application/json' \<br/>  --data '{"phone_number": "+10000000","state": "RINGING","timestamp": 1629521463195}'</span><span id="7590" class="mj ky iq mf b gy mo ml l mm mn"># Response<br/>{"success":true}</span><span id="b163" class="mj ky iq mf b gy mo ml l mm mn"># Verify document in mongodb<br/>$ docker exec -it mongo_container_id bash<br/>$ mongo<br/>&gt; use 'tiny-crm';<br/>&gt; db.customers.find()<br/>{ "_id" : ObjectId("614838642532b817ddb167c6"), "phoneNumber" : "+10000000", "name" : "New customer", "__v" : 0 }<br/>&gt; db['call-states'].find()<br/>{ "_id" : ObjectId("614838642532b817ddb167c8"), "type" : "incoming", "customerId" : ObjectId("614838642532b817ddb167c6"), "timestamp" : 1629521463195, "state" : "RINGING", "__v" : 0 }</span></pre><h1 id="058a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">用Socket.io向Web客户端通知呼叫状态事件</h1><p id="10fd" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们希望当android客户端应用程序向http服务器发送请求时，请求信息将被转发到我们的web客户端。</p><p id="440f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，我们将实现一个简单的websocket服务器。为了监听呼叫状态事件，客户端将订阅websocket服务器。客户端web将显示或更新呼叫状态信息。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="2cef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用socket.io创建一个简单的websocket服务器</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="9685" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们导出<code class="fe mp mq mr mf b">emitCallStateChange</code>函数向订阅者发出<code class="fe mp mq mr mf b">call_state_change</code>事件。</p><p id="843d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更新<code class="fe mp mq mr mf b">server.ts</code>文件，用同一个http服务器实例启动socket服务器和http服务器。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="f82c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，只需通过socket服务器向客户端发出新的呼叫状态信息:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="9003" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后一部分是web客户端:<code class="fe mp mq mr mf b">public/index.html</code></p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="2174" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在简单的HTML页面上，我们使用默认设置连接到套接字服务器，并列出<code class="fe mp mq mr mf b">call_state_change</code>事件。当我们收到事件时，如果客户的状态存在，只需删除旧状态并更新新状态。</p><p id="b5af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更新app.ts文件以将index.html文件作为静态文件:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="7d49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr mf b">.env</code></p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5038" class="mj ky iq mf b gy mk ml l mm mn">PORT=3000<br/>MONGO_URI=mongodb://localhost:27017/tiny-crm<br/>PUBLIC_DIR=/Users/supercat/PetProjects/TinyCRM-Server/public # absolute path to the public folder</span></pre></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="bc94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">测试新的HTML页面和套接字服务器:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ng"><img src="../Images/4df5a1801df2be19ea4cc63768cd4261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZuvS8n_GNSwSIQvItFN3kg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">测试新页面</figcaption></figure><h1 id="7640" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">将Android应用程序与服务器连接</h1><p id="aa48" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">让我们更新android应用程序的<code class="fe mp mq mr mf b">ApiInterface.kt</code>文件中的<code class="fe mp mq mr mf b">BASE_URL</code>变量和<code class="fe mp mq mr mf b">POST</code>装饰器:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="1933" class="mj ky iq mf b gy mk ml l mm mn">...<br/><a class="ae kw" href="http://twitter.com/POST" rel="noopener ugc nofollow" target="_blank">@POST</a>("call-states")<br/>fun postPhoneState(<a class="ae kw" href="http://twitter.com/Body" rel="noopener ugc nofollow" target="_blank">@Body</a> body: RequestBody): Call&lt;Any&gt;</span><span id="d6ba" class="mj ky iq mf b gy mo ml l mm mn">companion object {<br/>    private const val BASE_URL = "<a class="ae kw" href="http://192.168.2.100:3000/api/v1/" rel="noopener ugc nofollow" target="_blank">http://192.168.2.100:3000/api/v1/</a>"<br/>...</span></pre><p id="7720" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用你的局域网IP地址替换<code class="fe mp mq mr mf b">192.168.2.100</code>。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ng"><img src="../Images/e7612555faa4f2ca984c950d122acf28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vWLZU2NTrRh4A1SzE1RcuA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">假电话</figcaption></figure><p id="d138" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已！</p><h1 id="1f0e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="f192" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我们已经完成了应用程序的服务器端和web客户端。</p><p id="0536" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的项目中，android应用程序是项目的重点。对我这个后端开发人员来说，这有点难，但这是一次有趣的经历。</p><p id="f72c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望我的故事能帮助你有一些思路来完成你的申请。</p><p id="d691" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文中使用的源代码发布在Github上:</p><ul class=""><li id="6888" class="nh ni iq ka b kb kc kf kg kj nj kn nk kr nl kv nm nn no np bi translated"><a class="ae kw" href="https://github.com/codetheworld-io/Tiny-CRM-Android" rel="noopener ugc nofollow" target="_blank">安卓应用</a></li><li id="f8cc" class="nh ni iq ka b kb nq kf nr kj ns kn nt kr nu kv nm nn no np bi translated"><a class="ae kw" href="https://github.com/codetheworld-io/Tiny-CRM-Server" rel="noopener ugc nofollow" target="_blank">服务器</a></li></ul><p id="f491" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>
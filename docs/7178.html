<html>
<head>
<title>Creating a Dope Expandable Tree View in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中创建Dope可扩展树视图</h1>
<blockquote>原文：<a href="https://itnext.io/creating-a-dope-expandable-tree-view-in-react-5b32a36082d4?source=collection_archive---------0-----------------------#2022-07-06">https://itnext.io/creating-a-dope-expandable-tree-view-in-react-5b32a36082d4?source=collection_archive---------0-----------------------#2022-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4a8c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当单击父节点时，从服务器异步获取子节点</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/26650c16c8f9d0d3ebe21c4757011944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CJ_ZlIjhi-sbo4nw"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@akummur?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿达什·库姆穆尔</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h2 id="2f67" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">动机</h2><p id="7b67" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我编写这个功能是作为显示组织层次结构的工作需求的一部分。结果比我最初预料的要棘手。问题陈述是结构化我们从后端API获取的数据，并将其显示在Material UI 的<a class="ae ky" href="https://material-ui.com/api/tree-view/" rel="noopener ugc nofollow" target="_blank"> TreeView组件中。我们不得不获取大量的数据，所以不能一次加载整个树。当用户单击扩展按钮时，我们需要从后端逐个获取子节点。</a></p><h2 id="c9a3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">解决办法</h2><p id="1588" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我使用来自<a class="ae ky" href="https://material-ui.com/api/tree-view/" rel="noopener ugc nofollow" target="_blank"> TreeView API </a>的<code class="fe mo mp mq mr b">selected</code>和<code class="fe mo mp mq mr b">expanded</code>道具的组合来解决这个问题。在本例中，我们异步加载新的子节点，并在加载后展开父节点。为了能够在内存中保存这些数据，我们还需要使用一个<a class="ae ky" href="https://medium.com/swlh/data-structures-graphs-50a8a032db03" rel="noopener">图形数据结构</a>(这是数据结构在工程面试之外唯一对我有用的时候)。在我的例子中，我调用了数据结构<code class="fe mo mp mq mr b">TreeNode</code>，它有各种方法，例如<em class="ms">遍历</em>、<em class="ms">添加节点</em>和<em class="ms">搜索名称</em>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">TreeNode</figcaption></figure><p id="294b" class="pw-post-body-paragraph lv lw it lx b ly mv ju ma mb mw jx md li mx mf mg lm my mi mj lq mz ml mm mn im bi translated">这是怎么回事？首先，我们从声明一个类开始，这只是用传统的方式在JavaScript中声明函数的语法糖。该类允许我们定义类成员和构造函数来初始化该类的实例。<code class="fe mo mp mq mr b">TreeNode</code>类的每个实例都有一个<code class="fe mo mp mq mr b">id</code>、<code class="fe mo mp mq mr b">root</code>、<code class="fe mo mp mq mr b">name</code>和<code class="fe mo mp mq mr b">children</code>。根表示图中的第一个节点。子节点是指向图中下一个节点的指针。id是唯一的标识符，名称是我们将在屏幕上显示的标签。遍历函数允许我们访问图中的每个节点，还提供了一个回调函数，这意味着我们可以对图中的每个节点进行一些操作。例如，当在某个父节点下添加一个新的子节点时，我们遍历整个图，直到找到父节点的<code class="fe mo mp mq mr b">id</code>，然后将新的子节点(作为<code class="fe mo mp mq mr b">TreeNode</code>本身)添加到父节点的子数组中。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><p id="166e" class="pw-post-body-paragraph lv lw it lx b ly mv ju ma mb mw jx md li mx mf mg lm my mi mj lq mz ml mm mn im bi translated">数据结构准备就绪后，我们现在可以实现UI表示部分了。假设你已经用create-react-app引导了你的项目，剩下的就很简单了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9c1e" class="pw-post-body-paragraph lv lw it lx b ly mv ju ma mb mw jx md li mx mf mg lm my mi mj lq mz ml mm mn im bi translated">我们从材质UI中的<code class="fe mo mp mq mr b">TreeView</code>组件作为外部JSX开始。作为道具我们需要通过<code class="fe mo mp mq mr b">defaultCollapseIcon</code>、<code class="fe mo mp mq mr b">defaultExpandIcon</code>、<code class="fe mo mp mq mr b">selected</code>、<code class="fe mo mp mq mr b">onNodeSelect</code>、<code class="fe mo mp mq mr b">expanded</code>到<code class="fe mo mp mq mr b">TreeView</code>。前两个是简单的SVG图标，<code class="fe mo mp mq mr b">selected</code>跟踪当前选择的节点，<code class="fe mo mp mq mr b">expanded</code>是一个由<code class="fe mo mp mq mr b">id</code>组成的数组，当前它们的子节点在屏幕上展开，<code class="fe mo mp mq mr b">onNodeSelect</code>是选择新节点时要调用的函数。在<code class="fe mo mp mq mr b">TreeView</code>内部，我们需要创建<code class="fe mo mp mq mr b">TreeItem</code> s。我们可以递归地调用<code class="fe mo mp mq mr b">createItemsFromTree</code>来添加我们需要的所有<code class="fe mo mp mq mr b">TreeItem</code>。<code class="fe mo mp mq mr b">handleChange</code>功能是一个事件处理程序，当点击时扩展/收缩树中的节点。它对后端API进行一个<code class="fe mo mp mq mr b">async</code>同步调用来获取父节点的子节点，然后在API调用完成后显示它们。为了跟踪组件中的状态，我们使用react中的<code class="fe mo mp mq mr b">useState</code>钩子来创建3个状态:<code class="fe mo mp mq mr b">expanded</code>、<code class="fe mo mp mq mr b">selected</code>和<code class="fe mo mp mq mr b">tree</code>。将<code class="fe mo mp mq mr b">TreeViewDemo</code>组件插入ReactDOM.render调用中，您可以看到如下所示的树:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b1df440265ceab63a5517138b91a19b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*8rz5PViDN2L4EErPKQiBaA.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">演示</figcaption></figure><h2 id="f356" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="e8d8" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">这个演示解决方案可以帮助您完成80%的工作。其他需要考虑的是实现实际的API调用，在树无限大的情况下虚拟化<code class="fe mo mp mq mr b">TreeItem</code> DOM元素，设计组件样式，以及为底层HTML元素添加可访问性属性。如果你喜欢我的写作风格，请跟我来。我一个月发布1次，我喜欢网络，谢谢</p></div></div>    
</body>
</html>
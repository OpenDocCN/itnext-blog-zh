<html>
<head>
<title>Creating simple application with GoJS — part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用GoJS创建简单的应用程序—第1部分</h1>
<blockquote>原文：<a href="https://itnext.io/creating-simple-application-with-gojs-part-1-e3c320765def?source=collection_archive---------2-----------------------#2018-06-04">https://itnext.io/creating-simple-application-with-gojs-part-1-e3c320765def?source=collection_archive---------2-----------------------#2018-06-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="666a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将通过用非常简单的代码创建一个应用程序来展示GoJS的基本功能。它将被设计用于绘制不复杂的图表。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/6248243288cf67cafcd24d21ae2cbf98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDCr0aJ8k_nJtSKTCmNwCQ.png"/></div></div></figure><blockquote class="kx ky kz"><p id="df7d" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated">与<a class="ae le" href="http://www.synergycodes.com" rel="noopener ugc nofollow" target="_blank"> Synergy Codes </a>合作撰写的帖子。</p></blockquote><h1 id="dcea" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">从图书馆开始</h1><p id="7318" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">GoJS是一个JavaScript库，它获取复杂的数据，并通过灵活的建模选项运行这些数据，以创建易于理解并付诸实施的可视化效果。你可以在<a class="ae le" href="https://gojs.net/latest/index.html" rel="noopener ugc nofollow" target="_blank">官方网站</a>或<a class="ae le" href="http://www.synergycodes.com/blog/gojs-easy-data-visualization" rel="noopener ugc nofollow" target="_blank"> Synergy Codes的博客</a>上了解更多关于GoJS的信息。</p><p id="732c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的起点是导入库的HTML文件。我们可以直接从<a class="ae le" href="https://gojs.net/latest/doc/download.html" rel="noopener ugc nofollow" target="_blank">网站</a>下载，从npm下载，或者我们可以使用CDN。下一步是添加<strong class="jp ir"> div </strong>元素——图的未来位置。注意:我们不自己创建画布，因为库为我们做了。然而，div本身可以被自由地改进以使其与网站相匹配。该文件应该大致如下所示:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单1。index.html文件的初始外观</figcaption></figure><h1 id="7425" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">代码结构</h1><p id="8130" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">下一步是编写创建图表的JavaScript代码。我们创建一个diagram.js文件，将应用程序的整个逻辑放在其中。我们可以用任何约定来创建它——GoJS没有规定任何特定的构建源代码的方式。出于这个例子的目的，我将创建一个IIFE(立即调用的函数表达式)，这将是一个带有外部可用的<strong class="jp ir"> initDiagram </strong>函数的命名图。通过使用IIFE，我们将能够从外部访问隐藏我们实现的一部分。</p><p id="43ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于GoJS，我们创建所有对象的起点是<strong class="jp ir"> go。GraphObject.make </strong>函数，该函数调用所选类的工厂方法。它用得太频繁了，所以我们应该把它赋给一个名字短一点的变量。为此，普遍接受的惯例是使用美元符号。但是，在并行使用jQuery的情况下，我们需要小心。作为第一个参数，该函数接受应该创建其实例的类，而对象的各个字段的值作为后续参数被接受。值得强调的是，通常字符串作为第二个参数给出，带有对象中定义的一个选定字段的值。通常，在给定的上下文中，字段的值是最重要的，比如创建的人物的类型。</p><h1 id="d8b9" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">创建GoJS图—准备</h1><p id="d16f" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">我们首先要创建的是图表本身。它位于<strong class="jp ir"> go的下面。图</strong>类。最重要的参数是它应该被放入的元素的<strong class="jp ir"> id </strong>。这就是为什么我们叫它$(go。图表，“图表-内容”)。</p><p id="c51c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了更好地指定图表对象的操作，请检查它在文档中有哪些字段。例如，我们可以赋值<strong class="jp ir"> go。点中心</strong>到场<strong class="jp ir">初始内容对齐</strong>。这首先将图的元素放置在应用程序的中心(默认情况下，它们在左上角)。让我们把它放到<strong class="jp ir"> initDiagram </strong>中。我们必须记住在HTML文件中调用这个函数。我们应该得到以下JS和HTML文件:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单2。diagram.js框架和空图的创建</figcaption></figure><p id="4a5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图表是空的，所以很遗憾我们还看不到任何动作。唯一能让我们看到GoJS正在工作的是在图上单击鼠标右键的默认动作锁。</p><h1 id="7ab3" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">图表上的数据显示</h1><p id="eb38" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">该图的基础是为其操作创建一个数据模型。该模型由两个表组成— <strong class="jp ir"> nodeDataArray </strong>(节点的数据)和<strong class="jp ir"> linkDataArray </strong>(边的数据)。节点是图形表示对象的图的主要元素(例如，实体关系图中的实体)。链接(边)是节点之间的连接(有向或无向)，根据图的类型，可能有不同的含义(如ERD图中实体之间的关系)。</p><p id="6d34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将单个节点定义为对象，其中唯一必需的字段是键，例如，唯一标识符。此外，我们可以选择定义对象的类别，以及用任何数据来完成它们，这些数据将与图中的节点一起存储。边也被定义为具有两个必需字段的对象——从到<strong class="jp ir">和从<strong class="jp ir">到</strong>，它们的值决定了哪些节点被连接。与节点的情况一样，我们也可以添加自己的附加数据。</strong></p><p id="69cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图表模型位于图表对象的模型字段之下。最好通过创建一个<strong class="jp ir"> go来定义它。我们向其传递节点和边的GraphLinksModel </strong>对象。下面是一个模型定义的示例:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单3。图表模型的定义</figcaption></figure><p id="dfb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在将它放入initDiagram 并运行之后，我们应该会得到一个非常简单的图表。它将向我们显示在由边连接的关键字段中输入的值。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/44d2fd1f5e34d0b88916b3ca8dc4ed3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*HFkJBVRVuDyRM_P_oMcOBQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">图一。第一张图</figcaption></figure><p id="e409" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是为对象提供外观。通过创建<strong class="jp ir"> go来设置外观。节点</strong>对象，我们随后在其中创建定义形状的对象(<strong class="jp ir"> go。形状</strong>。对象外观(模板)的最简单定义如下:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单4。物体外观的最简单定义</figcaption></figure><p id="94ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，我们将创建一个黑色圆圈来表示对象。<strong class="jp ir">自动</strong>表示单个形状的排列。在<strong class="jp ir"> Auto </strong>的情况下，内部定义的每个形状都运行。节点将被放置在对象中心的层中。在形状的例子中，这里选择了<strong class="jp ir">圆</strong>，但是在<a class="ae le" href="https://gojs.net/latest/samples/shapes.html" rel="noopener ugc nofollow" target="_blank">https://gojs.net/latest/samples/shapes.html</a>还有很多其他的可用。我们还可以在shape对象中设置字段值——这将让我们指定类似于以下的元素:<strong class="jp ir">填充</strong>、<strong class="jp ir">描边</strong>或<strong class="jp ir">大小</strong>。此外，我们可以使用<strong class="jp ir"> go从数据模型中加载这些值。绑定</strong>。</p><p id="ef78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">定义外观的另一种方法是使用SVG路径定义创建一个形状。然后，我们使用这个路径作为<strong class="jp ir">几何字符串</strong>字段的值。下面是在这种情况下模板定义的一个例子(我们还将设置填充的大小和颜色):</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单5。使用SVG路径定义外观</figcaption></figure><p id="4d54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还可以使用任何格式(包括SVG)的图像来定义外观。在这样的情况下，与其<strong class="jp ir">走。形状</strong>我们得用<strong class="jp ir">走。图片</strong>。有意思的是，<strong class="jp ir">走。图片</strong>不仅可以存储图片，还可以存储其他画布类型的元素。这允许我们创建更高级的可视化。</p><p id="f2de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">定义物体外观的另一种方法是将许多不同的形状组合成一个形状。这种方法的优点是，在将对象分成几个更小的部分后，我们可以为每个部分定义不同的行为(例如，其中一个形状可能是一个按钮，我们可以在其上定义一个单击动作—在这种情况下，只有这个片段会被分配这个事件)。为了创建复杂的对象，有必要了解在对象上排列形状的方法。我们用了<strong class="jp ir"> Auto </strong>，意思是把所有东西都放在中间。我们还有其他的选择，最基本的包括:<strong class="jp ir">水平</strong>(从左到右)<strong class="jp ir">垂直</strong>(从上到下)<strong class="jp ir">点</strong>(放置在预定位置，如<strong class="jp ir">中心</strong>、<strong class="jp ir">顶部</strong>、<strong class="jp ir">底部</strong>等。).后续形状作为创建节点的函数的下一个参数传递，它们按以下顺序放置。例如，两个矩形，每一个都有不同的外观，一个放在另一个的上面，定义如下:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单6。由几种形状组成的外观的定义</figcaption></figure><p id="c4b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，如果我们想要不同类型的对象呢？为此，我们没有将外观分配给<strong class="jp ir">节点模板</strong>，而是完成了映射— <strong class="jp ir">节点模板映射</strong>，其中键是对象的类别(<strong class="jp ir">类别</strong>，我们已经在模型中定义了)，而<strong class="jp ir">模板</strong>是值。出于这个例子的目的，让我们假设我们将使用上面给出的类别定义:<strong class="jp ir">第一个</strong>将是一个圆形，<strong class="jp ir">第二个</strong>将是SVG形状，<strong class="jp ir">第三个</strong>将是两个矩形。然而，出于实际原因，我们不应该将template直接分配给map，而是应该创建一个函数来返回我们将分配给哪个类别的模板，然后使用其中的数据来补充map — nodeTemplateMap。请注意，在我们提供带有模型的图表之前，应该完成该图。例如，它可能是这样的(为了清楚起见，省略了一些代码片段):</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">清单7。使用nodeTemplateMap的建议</figcaption></figure><p id="090b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样写应该会产生以下效果:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/4aa728786d18160b31418920cc4f1717.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*6QvZkFkLKl-ZExn9XXnwXw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">图二。具有三种不同节点模板的图表</figcaption></figure><p id="4f00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你所看到的，图表开始成形了。另外，值得一提的是，除了节点的外观，还可以确定边的外观。这是以类似的方式定义的，不同之处在于，我们用<strong class="jp ir"> linkTemplate </strong>和<strong class="jp ir"> linkTemplateMap </strong>代替了<strong class="jp ir"> nodeTemplate </strong>和<strong class="jp ir"> nodeTemplateMap </strong>，而在模板定义期间，我们没有创建<strong class="jp ir"> go。节点</strong>对象我们创建一个<strong class="jp ir"> go。链接</strong>对象。</p><p id="f2ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里查看本教程的结果:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mq mj l"/></div></figure><p id="8327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">想要更多吗？查看本教程的第二部分<a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/creating-simple-application-with-gojs-part-2-c33139e934ba"/>！</p><p id="6ad5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">帖子也发表在<a class="ae le" href="http://www.synergycodes.com/blog/" rel="noopener ugc nofollow" target="_blank"> Synergy Codes的博客</a>上，你可以在这里查看<a class="ae le" href="http://www.synergycodes.com/blog/how-do-i-create-a-simple-gojs-application" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="5053" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你想了解更多关于GoJS的知识吗？你可以在这里下载免费的电子书！</p></div></div>    
</body>
</html>
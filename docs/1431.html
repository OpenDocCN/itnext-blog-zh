<html>
<head>
<title>Hass.io Add-On: Remote Access without configuring NAT/firewall</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hass.io插件:无需配置NAT/防火墙的远程访问</h1>
<blockquote>原文：<a href="https://itnext.io/hass-io-add-on-remote-access-without-configuring-nat-or-firewall-7ea9b2ea3a08?source=collection_archive---------1-----------------------#2018-10-12">https://itnext.io/hass-io-add-on-remote-access-without-configuring-nat-or-firewall-7ea9b2ea3a08?source=collection_archive---------1-----------------------#2018-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/496d71692475820536b523578a8eca3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BegaCUzlA9_yHT2A.png"/></div></div></figure><h1 id="7f10" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">本教程的目标</h1><p id="d37d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">无需配置路由器或静态IP，即可对您的家庭助理进行安全的端到端TLS加密访问。我们将使用<a class="ae lu" href="https://webhookrelay.com/v1/guide/tls-tunnels" rel="noopener ugc nofollow" target="_blank"> TLS隧道</a>,而不是在Webhook中继服务器上终止的HTTPS隧道，这些隧道只在您的终端终止，因此即使我们被迫这样做，我们也无法在您的浏览器没有通知您的情况下拦截流量。</p><h1 id="4905" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">我对你的看法</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/58bddb551ed3ee506e4fd8801e061204.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/0*DOiRovwQvbki8N60.jpg"/></div></figure></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h1 id="aa7c" class="jy jz iq bd ka kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv bi translated">在开始之前</h1><p id="647d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">本教程希望您具备:</p><ul class=""><li id="2b74" class="mm mn iq ky b kz mo ld mp lh mq ll mr lp ms lt mt mu mv mw bi translated"><a class="ae lu" href="https://www.home-assistant.io/" rel="noopener ugc nofollow" target="_blank">家庭助手</a>实例</li><li id="a599" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt mt mu mv mw bi translated"><strong class="ky ir">基本加</strong>订阅，支持白名单域和TLS直通隧道。通常情况下，它是付费的，但如果你想尝试一下，只需给我们发电子邮件或通过内部聊天联系，我们将启用这些功能。随时欢迎反馈:)</li><li id="e779" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae lu" href="https://www.duckdns.org/" rel="noopener ugc nofollow" target="_blank"> DuckDNS </a>账号获得自己的免费域名，通过<a class="ae lu" href="https://letsencrypt.org/" rel="noopener ugc nofollow" target="_blank">检索TLS证书让我们加密</a>。</li></ul></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h1 id="6d3d" class="jy jz iq bd ka kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv bi translated">快速启动</h1><ul class=""><li id="a1bd" class="mm mn iq ky b kz la ld le lh nc ll nd lp ne lt mt mu mv mw bi translated">在这里创建Webhook中继账户<a class="ae lu" href="https://my.webhookrelay.com/" rel="noopener ugc nofollow" target="_blank"/></li><li id="69e8" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt mt mu mv mw bi translated">创建<a class="ae lu" href="https://www.duckdns.org/" rel="noopener ugc nofollow" target="_blank"> DuckDNS </a>帐户</li></ul><p id="df84" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">此附加组件的安装非常简单，与安装任何其他<a class="ae lu" href="https://hass.io/" rel="noopener ugc nofollow" target="_blank">has . io</a>附加组件相比没有什么不同:</p><ol class=""><li id="087e" class="mm mn iq ky b kz mo ld mp lh mq ll mr lp ms lt ni mu mv mw bi translated">将我们的Hass.io附加组件存储库URL添加到您的Hass.io实例:<a class="ae lu" href="https://github.com/webhookrelay/home-assistant" rel="noopener ugc nofollow" target="_blank">https://github.com/webhookrelay/home-assistant</a>(如果您是通过您的Home Assistant附加组件页面看到这个，请跳过它)</li><li id="fe37" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt ni mu mv mw bi translated">安装“Webhook Relay”附件。</li><li id="bd59" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt ni mu mv mw bi translated">生成<a class="ae lu" href="https://my.webhookrelay.com/tokens" rel="noopener ugc nofollow" target="_blank">令牌密钥&amp;秘密对</a>并将其添加到附加组件的配置中。</li><li id="3b6c" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt ni mu mv mw bi translated">获得<a class="ae lu" href="https://www.duckdns.org/" rel="noopener ugc nofollow" target="_blank"> DuckDNS </a>令牌并创建你的域名。将这些详细信息添加到“隧道”配置部分和“duck_dns”部分。如果你接受<a class="ae lu" href="https://community.letsencrypt.org/tos" rel="noopener ugc nofollow" target="_blank">让我们加密ToS </a>，设置“accept_terms”为真。</li><li id="5420" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt ni mu mv mw bi translated">启动“Webhook中继”附件。</li><li id="da3a" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt ni mu mv mw bi translated">检查“Webhook Relay”附加组件的日志，看看是否一切顺利。它应该打印出你的公共网址。</li></ol><h1 id="b013" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">TLS直通附加配置</h1><p id="d467" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">一旦你:</p><ul class=""><li id="40ad" class="mm mn iq ky b kz mo ld mp lh mq ll mr lp ms lt mt mu mv mw bi translated">Webhook中继密钥和密码</li><li id="5651" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt mt mu mv mw bi translated">DuckDNS域</li><li id="940d" class="mm mn iq ky b kz mx ld my lh mz ll na lp nb lt mt mu mv mw bi translated">DuckDNS令牌</li></ul><p id="2ab9" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">使用这些详细信息来填充附加配置:</p><pre class="lw lx ly lz gt nj nk nl nm aw nn bi"><span id="f89f" class="no jz iq nk b gy np nq l nr ns">{<br/> "key": "your-webhookrelay-key",<br/> "secret": "your-webhookrelay-secret",<br/> "forwarding": [{<br/>  "bucket": "ha",<br/>  "destination": "<a class="ae lu" href="http://127.0.0.1:8123" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8123</a>"<br/> }],<br/> "tunnels": [{<br/>  "name": "ha",<br/>  "destination": "<a class="ae lu" href="http://127.0.0.1:8123" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8123</a>",<br/>  "protocol": "tls",<br/>  "domain": "your-domain.duckdns.org"<br/> }],<br/> "duck_dns": {<br/>  "token": "your-duckdns-token",<br/>  "accept_terms": true<br/> },<br/> "tunnels_enabled": true,<br/> "forwarding_enabled": false<br/>}</span></pre><p id="b635" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">确保“协议”设置为<code class="fe nt nu nv nk b">tls</code>，<code class="fe nt nu nv nk b">tunnels_enabled</code>设置为<strong class="ky ir">真</strong>。</p><pre class="lw lx ly lz gt nj nk nl nm aw nn bi"><span id="3742" class="no jz iq nk b gy np nq l nr ns">}</span></pre><p id="4dc7" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">确保“协议”设置为<code class="fe nt nu nv nk b">tls</code>，<code class="fe nt nu nv nk b">tunnels_enabled</code>设置为<strong class="ky ir">真</strong>。</p><p id="b733" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">附加组件将自动:</p><ol class=""><li id="4b8c" class="mm mn iq ky b kz mo ld mp lh mq ll mr lp ms lt ni mu mv mw bi translated">将DuckDNS配置为指向正确的地址(公共隧道端点IP)</li></ol></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h1 id="fc7e" class="jy jz iq bd ka kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv bi translated">。/wrap_up</h1><ol class=""><li id="2f4e" class="mm mn iq ky b kz la ld le lh nc ll nd lp ne lt ni mu mv mw bi translated">配置Webhook中继隧道</li></ol><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/b99c9253ea1c1f1221360ddb6651f163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Qcy7tCvpsdRusAyq.png"/></div></div></figure><ol class=""><li id="1eee" class="mm mn iq ky b kz mo ld mp lh mq ll mr lp ms lt ni mu mv mw bi translated">开始提供交通服务</li></ol><h1 id="dc5f" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">。/wrap_up</h1><p id="0e4e" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">就这样，你应该可以通过你配置的域名访问你的家庭助手，在我的例子中是https://auto-ha.duckdns.org。我们拥有完整的端到端加密，无需配置您的路由器或获取静态IP地址:</p><p id="347d" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">此外，除了使用DuckDNS &amp;让我们加密，您可以使用任何您想要的证书，或者不提供任何证书给附加组件，并在Home Assistant服务器上终止TLS。为此，您只需在目的地:<code class="fe nt nu nv nk b">"destination": "https://127.0.0.1:8123"</code>中指定HTTPS</p><h1 id="0ac6" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">附言</h1><p id="2c0e" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如果你只是想获得网页挂钩，请随意使用我们的免费层！或者，如果你觉得破产了，发邮件到<a class="ae lu" href="https://webhookrelay.com/cdn-cgi/l/email-protection" rel="noopener ugc nofollow" target="_blank">【电子邮件保护】</a>给我们，我们可能会想出办法:)</p><p id="7adc" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated">不用Hass.io？点击这里查看我之前的博文，其中详细介绍了Docker <a class="ae lu" href="https://webhookrelay.com/blog/2018/09/03/home-assistant-remote-access/" rel="noopener ugc nofollow" target="_blank">的简单设置。</a></p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><p id="300f" class="pw-post-body-paragraph kw kx iq ky b kz mo lb lc ld mp lf lg lh nf lj lk ll ng ln lo lp nh lr ls lt ij bi translated"><em class="nx">原载于2018年10月12日</em><a class="ae lu" href="https://webhookrelay.com/blog/2018/10/12/hassio-tls-tunnels-duckdns/" rel="noopener ugc nofollow" target="_blank"><em class="nx">webhookrelay.com</em></a><em class="nx">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Android 11 Toast Updates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android 11吐司更新</h1>
<blockquote>原文：<a href="https://itnext.io/android-11-toast-updates-7f1cd2245bc4?source=collection_archive---------1-----------------------#2020-04-24">https://itnext.io/android-11-toast-updates-7f1cd2245bc4?source=collection_archive---------1-----------------------#2020-04-24</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="57d2" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">这个帖子会在新的Android 11预览版发布时持续更新！</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj kj"><img src="../Images/7390e398697597ee2ba34e3f263df00d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/0*DNcgkCtDiCRUSmuc.gif"/></div></figure><p id="9f65" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi ln translated">ndroid 11 (R)是2020年的下一代Android，谷歌在4月初发布了Android 11预览版2.1，供开发者审查。有很多变化，其中一个变化引起了我的注意——新的<code class="fe lw lx ly lz b">Toast</code>行为和对定制的限制。</p><p id="4098" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">在Android 11 (R)中，Google在<code class="fe lw lx ly lz b">Toast</code>上实现了以下变化，本文将详细讨论这些变化:</p><ol class=""><li id="5d98" class="ma mb iu kt b ku kv kx ky la mc le md li me lm mf mg mh mi bi translated">禁止背景定制吐司(见封面照片)</li><li id="8240" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">“文本吐司”不允许定制</li><li id="4598" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">已弃用的函数— <code class="fe lw lx ly lz b">setView()</code></li><li id="7ee6" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">新增回拨— <code class="fe lw lx ly lz b">Toast.Callback</code></li></ol><p id="8238" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">你可以从我的另一篇文章中了解更多关于在以前的API等级中定制<code class="fe lw lx ly lz b">Toast</code>的信息:</p><div class="mo mp gq gs mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/android-custom-toast-37f97aa373c3"><div class="ms ab fp"><div class="mt ab mu cl cj mv"><h2 class="bd iv gz z fq mw fs ft mx fv fx it bi translated">安卓定制吐司</h2><div class="my l"><h3 class="bd b gz z fq mw fs ft mx fv fx dk translated">除了简单地显示信息，Toast还有更多功能。自定义布局、重力、偏移量、双向边距…</h3></div><div class="mz l"><p class="bd b dl z fq mw fs ft mx fv fx dk translated">itnext.io</p></div></div><div class="na l"><div class="nb l nc nd ne na nf kp mr"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h1 id="023e" class="nn no iu bd np nq nr ns nt nu nv nw nx ka ny kb nz kd oa ke ob kg oc kh od oe bi translated">烤面包介绍</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj of"><img src="../Images/80d3afb04c117e313accd3b083cb95bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/0*s8a-PPA_sr_BNjGi.gif"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">带有简单信息的简单吐司插图</figcaption></figure><p id="7653" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated"><code class="fe lw lx ly lz b">Toast</code>是一个浮动在所有应用之上的简单小工具。它通常用于向用户显示简单的消息，例如网络错误消息。有一个优雅的淡入淡出动画来显示和隐藏一个<code class="fe lw lx ly lz b">Toast</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><p id="3067" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">有两种不同的<code class="fe lw lx ly lz b">Toast</code>可以被构造。其中一个是由<code class="fe lw lx ly lz b">Toast(context: Context)</code>构造的“简单的祝酒词”,另一个是由静态方法<code class="fe lw lx ly lz b">Toast(context: Context, text: CharSequence, duration: Int)</code>构造的“文本祝酒词”。<a class="ae om" href="https://developer.android.com/reference/android/widget/Toast#setGravity(int,%20int,%20int)" rel="noopener ugc nofollow" target="_blank">官方文档</a>中陈述的Android R的警告仅影响由后一种方法构建的<code class="fe lw lx ly lz b">Toast</code>，而不是由第一种方法构建的。在阅读以下部分之前，我们必须明确区分它们。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="oo op di oq bf or"><div class="gi gj on"><img src="../Images/06d15f748f535e3d26be1bd648e2d651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MQwy3v-BqWZ0rSIk9zIPyA.png"/></div></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">Android R的警告只对文本吐司有影响。</figcaption></figure></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h1 id="1c89" class="nn no iu bd np nq nr ns nt nu nv nw nx ka ny kb nz kd oa ke ob kg oc kh od oe bi translated">Android 11 (API 30)的变化</h1><h2 id="8680" class="os no iu bd np ot ou dn nt ov ow dp nx la ox oy nz le oz pa ob li pb pc od pd bi translated">1.禁止后台自定义吐司</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pe"><img src="../Images/d72954d49b1fe88510896500bff92ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*-DBIN2hLVJ7amPLI7lthEQ.png"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">更新了不同应用模式下不同吐司类型的状态</figcaption></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><p id="f76f" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">app在后台时<code class="fe lw lx ly lz b">Toast</code>自定义<strong class="kt iv">无法显示</strong>。取而代之的是显示消息“T19背景自定义吐司被阻止用于包[包名]见g.co/dev/toast.”的<code class="fe lw lx ly lz b">Toast</code>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj kj"><img src="../Images/7390e398697597ee2ba34e3f263df00d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/0*DNcgkCtDiCRUSmuc.gif"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">应用程序在后台时定制吐司的图示</figcaption></figure><p id="264c" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">另一方面，普通文本toast仍然可以照常工作:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pf"><img src="../Images/22598f73333bd281748d228d4636c24c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/0*njI87bpSSWbufEA2.gif"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">应用程序在后台时的文本吐司插图</figcaption></figure><h2 id="2d6b" class="os no iu bd np ot ou dn nt ov ow dp nx la ox oy nz le oz pa ob li pb pc od pd bi translated">2.文本吐司不允许定制</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pg"><img src="../Images/337dd454728c2031cde08e5b53a013e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*sTu99BqYVEeE1MST.gif"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">API 29或更早版本中自定义文本吐司的图示</figcaption></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><p id="7266" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">在Android R之前，simple <code class="fe lw lx ly lz b">Toast</code>和text <code class="fe lw lx ly lz b">Toast</code>都可以定制边距，gravity可以定制偏移量。然而，从Android R开始，文本<code class="fe lw lx ly lz b">Toast</code>不能再用这些参数进行设置，因为setter函数已经变成了无操作函数，也就是说，一个函数可以被调用但不做任何事情。<code class="fe lw lx ly lz b">setGravity</code> <a class="ae om" href="https://developer.android.com/reference/android/widget/Toast#setGravity(int,%20int,%20int)" rel="noopener ugc nofollow" target="_blank">官方文档</a>截图见下图。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="oo op di oq bf or"><div class="gi gj ph"><img src="../Images/70bfa210bdbdccabc09a9136fbe10ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sd0cQu_TzzAmwj7ZGOMBAw.png"/></div></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">来自此<a class="ae om" href="https://developer.android.com/reference/android/widget/Toast#setGravity(int,%20int,%20int)" rel="noopener ugc nofollow" target="_blank">链接</a>的setGravity文档截图</figcaption></figure><p id="d363" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">然而，这个新的实现只适用于文本<code class="fe lw lx ly lz b">Toast</code>。换句话说，由<code class="fe lw lx ly lz b">Toast(context: Context)</code>构造的简单<code class="fe lw lx ly lz b">Toast</code>仍然可以定制边距和带偏移的重力。请参见下面的插图:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pf"><img src="../Images/9a6fbbd548d8fc66c4de586ea5142365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/0*8XjcOCG_JosBdOy0.gif"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated">Android R上自定义简单吐司的插图</figcaption></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><h2 id="0d8d" class="os no iu bd np ot ou dn nt ov ow dp nx la ox oy nz le oz pa ob li pb pc od pd bi translated">3.已弃用的函数— setView()</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pi"><img src="../Images/0b56c54443ee2c9470bd36846e7f94e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*5k_Bob7LOfuM0xg6N6nVjg.png"/></div><figcaption class="og oh gk gi gj oi oj bd b be z dk translated"><a class="ae om" href="https://developer.android.com/reference/android/widget/Toast#setView(android.view.View)" rel="noopener ugc nofollow" target="_blank"> setView() </a>官方文档显示该功能在Android R中已被弃用</figcaption></figure><p id="d0b7" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">虽然它仍然允许通过<code class="fe lw lx ly lz b">setView(view: View)</code>自定义<code class="fe lw lx ly lz b">Toast</code>视图，但它实际上是Android R中不赞成使用的功能。</p><p id="e357" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">“<strong class="kt iv">弃用</strong>”表示该功能目前仍可使用，但可能会在未来的Android版本中被移除。建议开发人员避免在长期开发中使用该函数。</p><h2 id="46d8" class="os no iu bd np ot ou dn nt ov ow dp nx la ox oy nz le oz pa ob li pb pc od pd bi translated">4.新增回拨— <code class="fe lw lx ly lz b">Toast.Callback</code></h2><p id="fa3a" class="pw-post-body-paragraph kr ks iu kt b ku pj jv kw kx pk jy kz la pl lc ld le pm lg lh li pn lk ll lm in bi translated">添加了一个新的回调函数(<code class="fe lw lx ly lz b">Toast.Callback</code>)来通知<code class="fe lw lx ly lz b">Toast</code>何时显示和隐藏。它可以通过以下方式轻松添加到<code class="fe lw lx ly lz b">Toast</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h1 id="64a3" class="nn no iu bd np nq nr ns nt nu nv nw nx ka ny kb nz kd oa ke ob kg oc kh od oe bi translated">摘要</h1><ol class=""><li id="d33b" class="ma mb iu kt b ku pj kx pk la po le pp li pq lm mf mg mh mi bi translated">谷歌已经弃用了<code class="fe lw lx ly lz b">setView(view: View)</code>功能，并暗示以后不再设置定制视图(布局)。</li><li id="6ca7" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated"><code class="fe lw lx ly lz b">Toast</code>可分为两种——“简单吐司”和“文字吐司”。</li><li id="710d" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">在Android R中，当app在后台时，自定义<code class="fe lw lx ly lz b">Toast</code> <strong class="kt iv">无法显示</strong>，而是显示警告<code class="fe lw lx ly lz b">Toast</code>。文本toast在这种情况下不受限制。</li><li id="891e" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">用于设置文本toast的偏移量和边距的函数现在是无操作函数，它什么也不做，但可以调用。</li><li id="ec7d" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">当<code class="fe lw lx ly lz b">Toast</code>显示和隐藏时，新的回调(<code class="fe lw lx ly lz b">Toast.Callback</code>)用于通知应用程序。</li></ol></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h1 id="2e38" class="nn no iu bd np nq nr ns nt nu nv nw nx ka ny kb nz kd oa ke ob kg oc kh od oe bi translated">参考和进一步阅读</h1><ol class=""><li id="0fd6" class="ma mb iu kt b ku pj kx pk la po le pp li pq lm mf mg mh mi bi translated"><a class="ae om" href="https://developer.android.com/guide/topics/ui/notifiers/toasts" rel="noopener ugc nofollow" target="_blank">安卓官方吐司概述</a></li><li id="3850" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated"><a class="ae om" href="https://developer.android.com/reference/android/widget/Toast" rel="noopener ugc nofollow" target="_blank">安卓官方吐司文档</a></li><li id="a90b" class="ma mb iu kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">安卓定制吐司(我的另一个中帖)</li></ol><div class="mo mp gq gs mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/android-custom-toast-37f97aa373c3"><div class="ms ab fp"><div class="mt ab mu cl cj mv"><h2 class="bd iv gz z fq mw fs ft mx fv fx it bi translated">安卓定制吐司</h2><div class="my l"><h3 class="bd b gz z fq mw fs ft mx fv fx dk translated">除了简单地显示信息，Toast还有更多功能。自定义布局、重力、偏移量、双向边距…</h3></div><div class="mz l"><p class="bd b dl z fq mw fs ft mx fv fx dk translated">itnext.io</p></div></div><div class="na l"><div class="nb l nc nd ne na nf kp mr"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><p id="3b32" class="pw-post-body-paragraph kr ks iu kt b ku kv jv kw kx ky jy kz la lb lc ld le lf lg lh li lj lk ll lm in bi translated">欢迎关注我的<a class="ae om" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ myrik _ chow</a>了解更多信息。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
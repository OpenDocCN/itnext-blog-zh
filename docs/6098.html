<html>
<head>
<title>Bypass Angular Interceptors with Request Metadata</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用请求元数据绕过角度拦截器</h1>
<blockquote>原文：<a href="https://itnext.io/bypass-angular-interceptors-with-request-metadata-cf28061cda69?source=collection_archive---------0-----------------------#2021-08-18">https://itnext.io/bypass-angular-interceptors-with-request-metadata-cf28061cda69?source=collection_archive---------0-----------------------#2021-08-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9e7623399f33e95cd0344afe6062fc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArqVrKvWOT8TsyetZVxnRg.jpeg"/></div></div></figure><p id="b152" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Angular有一种非常强大的方式为应用程序发出的每个http请求提供公共逻辑。</p><p id="98d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe kw kx ky kz b"><a class="ae la" href="https://angular.io/guide/http#intercepting-requests-and-responses" rel="noopener ugc nofollow" target="_blank">HttpInterceptor</a></code>你可以添加标题、记录日志、处理错误……基本上任何你想对所有<strong class="ka ir">http请求做的事情。</strong></p><p id="9be4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是有时您想绕过拦截器来处理某些请求。到目前为止，您有几种方法可以做到这一点。</p><ul class=""><li id="f255" class="lb lc iq ka b kb kc kf kg kj ld kn le kr lf kv lg lh li lj bi translated">在请求中添加一些http头，并在拦截器中检查它。</li><li id="2001" class="lb lc iq ka b kb lk kf ll kj lm kn ln kr lo kv lg lh li lj bi translated">为您的请求创建一个新的HttpClient。</li><li id="da07" class="lb lc iq ka b kb lk kf ll kj lm kn ln kr lo kv lg lh li lj bi translated">用令牌管理HttpClient注入。</li></ul><p id="ce6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些都是试图让您的拦截器知道您的请求有一些需要区别对待的特殊情况的方法。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="4303" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">HttpContext</h1><p id="0542" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">有了<a class="ae la" href="https://blog.angular.io/angular-v12-is-now-available-32ed51fbfd49" rel="noopener ugc nofollow" target="_blank"> Angular 12 </a>，有了一种新的方式将信息传递给你的拦截器，这看起来不像是你羞于做的事情。=)</p><p id="1360" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在可以使用<a class="ae la" href="https://angular.io/guide/http#passing-metadata-to-interceptors" rel="noopener ugc nofollow" target="_blank"> HttpContext </a>将元数据从请求传递给拦截器。</p><p id="b834" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是您的拦截器:</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="ee97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是你的<code class="fe kw kx ky kz b">httpClient</code>请求:</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c993" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意事项:</p><ul class=""><li id="4388" class="lb lc iq ka b kb kc kf kg kj ld kn le kr lf kv lg lh li lj bi translated">你可以在你觉得更有意义的地方声明你的<code class="fe kw kx ky kz b">HttpContextToken</code>。</li><li id="5c06" class="lb lc iq ka b kb lk kf ll kj lm kn ln kr lo kv lg lh li lj bi translated">这个令牌可以是任何类型的数据。布尔值，数字，字符串，对象，数组...</li><li id="c580" class="lb lc iq ka b kb lk kf ll kj lm kn ln kr lo kv lg lh li lj bi translated">这个上下文是可变的。因此您可以在请求/响应周期中更新它的值。</li></ul></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="6985" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看到这终于在Angular实现了，我很激动！🎉</p><p id="3b8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">非常感谢每一个努力工作并且没有失去希望的人，让这个进入框架！</p><h1 id="d53a" class="lw lx iq bd ly lz nf mb mc md ng mf mg mh nh mj mk ml ni mn mo mp nj mr ms mt bi translated">链接</h1><div class="nk nl gp gr nm nn"><a href="https://angular.io/guide/http#intercepting-requests-and-responses" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">有角的</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">Angular是一个构建移动和桌面web应用程序的平台。加入数百万开发者的社区…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">angular.io</p></div></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://github.com/angular/angular/pull/25751" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">feat(common): http客户端请求元数据，用于FDIM拉请求#25751的拦截器中</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">公关清单请检查您的公关是否满足以下要求:提交信息遵循我们的指导方针…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob jw nn"/></div></div></a></div></div></div>    
</body>
</html>
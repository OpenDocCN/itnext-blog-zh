<html>
<head>
<title>Setup Express in TypeScript with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js在TypeScript中设置Express</h1>
<blockquote>原文：<a href="https://itnext.io/setup-express-in-typescript-with-node-js-ffa3da038fc1?source=collection_archive---------2-----------------------#2021-04-17">https://itnext.io/setup-express-in-typescript-with-node-js-ffa3da038fc1?source=collection_archive---------2-----------------------#2021-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9af1bbc91f9c4d89629f62dc40db63e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1uYc1VpUMioy7DGI2wO6A.png"/></div></div></figure><p id="20f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我将解释在TypeScript中用Express创建新服务器的简单的一步一步的过程。<br/>本例要求具备<a class="ae kw" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>、<a class="ae kw" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>和<a class="ae kw" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>的基础知识。</p><p id="c201" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">设置项目</strong></p><p id="4d1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在开始之前，我们需要为我们的项目创建一个目录。为此，我们输入<code class="fe kx ky kz la b">mkdir typescript-express</code>并用回车确认。<br/>我们用<code class="fe kx ky kz la b">cd typescript-express</code>切换到目录，并建立项目。</p><p id="55cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们用命令<code class="fe kx ky kz la b">npm init -y</code>创建一个Node.js包。之后，我们可以为我们的项目安装模块。因此我们用<code class="fe kx ky kz la b">npm i express</code>安装Express。因为我们在打字稿中工作，我们也需要打字稿和快速打字。我们用命令<code class="fe kx ky kz la b">npm i -D typescript @types/express</code>来做。</p><p id="ad4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后但同样重要的是，让我们为TypeScript创建配置。为此，我们使用命令<code class="fe kx ky kz la b">npx tsc --init</code>。TypeScript编译器将创建一个包含所有可能设置的预定义文件。</p><p id="127f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里所有的命令一个接一个…</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="9703" class="lj lk iq la b gy ll lm l ln lo">mkdir typescript-express<br/>cd typescript-express</span><span id="80d1" class="lj lk iq la b gy lp lm l ln lo">npm init -y</span><span id="f842" class="lj lk iq la b gy lp lm l ln lo">npm i -D typescript @types/express<br/>npm i express</span><span id="bf0e" class="lj lk iq la b gy lp lm l ln lo">npx tsc --init</span></pre><p id="9cea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lq">关于为TypeScript设置项目的更多信息，我只能参考我以前的一篇文章</em> <a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/simple-setup-for-your-typescript-project-d96f66113b41"> <em class="lq">为你的下一个TypeScript项目</em> </a> <em class="lq">简单设置。</em></p><p id="1968" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在那之后，你应该有类似这样的东西:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/697b2d7d02d7ca086888d6c03370298d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Rkd83FhBbb6FOwHLCBpZg.png"/></div></div></figure><h2 id="2b82" class="lj lk iq bd ls lt lu dn lv lw lx dp ly kj lz ma mb kn mc md me kr mf mg mh mi bi translated">编写一个Hello World应用程序</h2><p id="fe0b" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">为了有一个简单的开始，我们直接使用来自<a class="ae kw" href="https://expressjs.com/en/starter/hello-world.html" rel="noopener ugc nofollow" target="_blank">快速页面</a>的例子，并对其进行最小程度的调整。</p><p id="66f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意我们是如何分配端口的。我只能建议总是这样设置端口。这也适用于其他不使用Express的项目。例如，如果您稍后实现服务并将它们部署到Google App Engine(Google Cloud ), Google将设置这个环境变量(PORT)。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/cfd6b421e63d57f228241d58be4278d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-fYR8R_32q0lki-Wi4hjg.png"/></div></div></figure><h2 id="927a" class="lj lk iq bd ls lt lu dn lv lw lx dp ly kj lz ma mb kn mc md me kr mf mg mh mi bi translated">配置项目</h2><p id="cb6d" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">我们为TypeScript配置编译器来创建用于调试的SourceMaps，并将JavaScript文件输出到<code class="fe kx ky kz la b">dist</code>文件夹。</p><p id="570b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，我们在tsconfig.json中做了以下调整</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/a49339fbd7647fd28f7d888366805755.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TiuU1Uq801xiq67xwJCh6Q.png"/></div></div></figure><p id="2778" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了将我们的项目转换成JavaScript，我们添加了一个构建脚本。为此，我们在<code class="fe kx ky kz la b">package.json</code>的<code class="fe kx ky kz la b">scripts</code>部分添加了一个新的<code class="fe kx ky kz la b">build</code>条目。这个脚本只是运行TypeScript编译器<code class="fe kx ky kz la b">tsc</code>(从<code class="fe kx ky kz la b">tsconfig.json</code>获取我们的设置)。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/0f5f357309743eaf30db7e282aa010b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOLU_WOdIgyay4YHM0-hxw.png"/></div></div></figure><p id="9c11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后但同样重要的是，我们配置我们的Visual Studio代码，以便我们可以在Visual Studio代码中使用调试器运行项目。</p><p id="f17e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，我们按下组合键<code class="fe kx ky kz la b">Ctrl+D</code>(在Windows上)并选择“创建一个launch.json文件”。在打开的菜单中，我们选择<code class="fe kx ky kz la b">Node.js (legacy)</code>。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/1972c0d2139e4b22ea6040b5bf319d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8j9c_q1jpmCH0S4HVcBCMg.png"/></div></div></figure><p id="688b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在随后创建的<code class="fe kx ky kz la b">launch.json</code>中，我们调整以下值:</p><ul class=""><li id="cb60" class="ms mt iq ka b kb kc kf kg kj mu kn mv kr mw kv mx my mz na bi translated"><strong class="ka ir">程序:</strong>我们切换到JavaScript文件的输出目录。</li><li id="0131" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated"><strong class="ka ir"> sourceMaps: </strong>设置为true，这样我们可以稍后在TypeScript中调试我们的源代码(例如，使用断点)。</li><li id="1c67" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated"><strong class="ka ir"> preLaunchTask: </strong>总是在我们要启动程序之前执行(只有在调试的时候或者实际上直接从Visual Studio代码启动的时候)。</li></ul><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/997a0f5e4a1242659adc286f4e662c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afzxDvqPF2nX-3dms9fdew.png"/></div></div></figure><p id="4680" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">启动服务器</strong></p><p id="f7c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到目前为止，一切都设置好了，我们可以按<code class="fe kx ky kz la b">F5</code>了。这样我们就启动了Visual Studio代码的调试器和我们的服务器。</p><p id="65c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lq">或者</em> <code class="fe kx ky kz la b">node dist/main.js</code> <em class="lq">也可以在终端中输入，但只能在项目已经转换成JavaScript之后(例如使用</em> <code class="fe kx ky kz la b">npm run build</code> <em class="lq">)。</em></p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/241663ffa41d58c016fd14a6985559c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fjt2RLHpx84OQ8cwLmO0WQ.png"/></div></div></figure><p id="2ea8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在可以打开浏览器并输入地址<code class="fe kx ky kz la b">localhost:3000</code>。我们应该会看到类似下图的内容。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/4987754f68872d863ef03add7672bb5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*XyI69Ss4WAml6WdWY9Zacw.png"/></div></figure><p id="1397" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">一些调试</strong></p><p id="38da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后但同样重要的是，我们对源代码进行了调整</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/ed665a75b79ae672c7023d5745915d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-K_lyq5TEUvPQXwJ_WSPZA.png"/></div></div></figure><p id="a811" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们添加另一个路由<code class="fe kx ky kz la b">Hello</code>，它应该只输出<code class="fe kx ky kz la b">World!</code>。此外，我们为两条路由设置了一个断点。这是代码中的一个位置，当到达代码中的这个位置时，调试器应该在这个位置停止。</p><p id="de94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们用<code class="fe kx ky kz la b">F5</code>再次启动服务器，切换到浏览器并直接导航到<code class="fe kx ky kz la b">localhost:3000</code>。Visual Studio代码应该立即出现在前台，并突出显示源代码中的位置。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/f3b48ab90b3879d591312409b5b53a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKaLcGZYuha42mGQf1eB7A.png"/></div></div></figure><p id="7dbf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe kx ky kz la b">F5</code>,我们让服务器继续运行，并再次切换到浏览器。我们现在应该看到<code class="fe kx ky kz la b">Hello World!</code>。我们最后一次把地址改为<code class="fe kx ky kz la b">localhost:3000/Hello</code>。<br/>我们应该再次进入Visual Studio代码，这一次可以看到<code class="fe kx ky kz la b">Hello</code>的路线被突出显示。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/a4763238096629c6c863b266894decc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Quy3lygphM5V1jQpomLGdA.png"/></div></div></figure><p id="432b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以在Visual Studio代码中再次按下<code class="fe kx ky kz la b">F5</code>来继续服务器。我们现在应该在浏览器中看到<code class="fe kx ky kz la b">World!</code>。</p><h2 id="36cc" class="lj lk iq bd ls lt lu dn lv lw lx dp ly kj lz ma mb kn mc md me kr mf mg mh mi bi translated">我想通过额外的路线和断点实现什么？</h2><p id="3ccc" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">在许多教程中，我错过了设置调试器的方法，这样就可以直接从开发环境中调试程序。特别是对于TypeScript，必须事先进行一些设置才能工作。在这里，我看到了一个很好的机会，在最后简要地谈一谈。</p><h2 id="bc78" class="lj lk iq bd ls lt lu dn lv lw lx dp ly kj lz ma mb kn mc md me kr mf mg mh mi bi translated"><strong class="ak">结论</strong></h2><p id="1d39" class="pw-post-body-paragraph jy jz iq ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">这是一个在TypeScript中的Express的简单设置(调试器的设置)。我决定用Express来展示一个例子，因为尽管它年代久远，但Express至今仍被广泛使用。有足够多的替代方法(例如Nest.js)也在底层结构中使用Express或者构建类似。Express的优势在于它非常适合学习，并且提供了一个简单的服务器开发入门。这并不意味着Express不适合生产就绪的项目，恰恰相反。</p><p id="f0ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据反馈，这将是快速系列的第1部分。目前计划:</p><ul class=""><li id="ae0e" class="ms mt iq ka b kb kc kf kg kj mu kn mv kr mw kv mx my mz na bi translated">中间件/处理器</li><li id="9145" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">REST API的简化示例</li><li id="bc5b" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">简化的GraphQL API(基于相同的模拟数据)以及与REST API的比较</li><li id="6cfc" class="ms mt iq ka b kb nb kf nc kj nd kn ne kr nf kv mx my mz na bi translated">在谷歌云上部署。</li></ul><p id="00ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你喜欢这篇文章，如果你有任何问题或建议，请联系我。</p><p id="b8d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完整的例子可以在GitHub上找到:<a class="ae kw" href="https://github.com/bromix/typescript-express-tutorial" rel="noopener ugc nofollow" target="_blank">https://github.com/bromix/typescript-express-tutorial</a></p></div></div>    
</body>
</html>
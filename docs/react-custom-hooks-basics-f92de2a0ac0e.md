# React-你的第一个定制钩子

> 原文：<https://itnext.io/react-custom-hooks-basics-f92de2a0ac0e?source=collection_archive---------4----------------------->

![](img/dd3cba30b485857afaadbb897e196646.png)

照片由[克里斯·斯科特](https://unsplash.com/@chris_j_scott?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

React 16.8.0 引入了**钩子**。请注意，这不是 React 17.0.0，因为钩子可以无缝集成到 React 代码中，这意味着它们不会破坏现有代码。React 提供了一堆钩子，你可以在他们令人惊奇的文档中读到它们。

然而，还有更多…

*你不仅可以使用* ***钩子*** *React 提供，而且你还可以在它们上面构建你自己的* ***钩子*** *。*

如果你已经用钩子弄脏了你的手，这篇文章将帮助你在坚实的基础上创建你自己的钩子。

## 先决条件:

1.  你应该熟悉 react
2.  你应该熟悉 React 钩子
3.  你应该更喜欢 Javascript 中的函数而不是类

*![](img/b53dcd3bb9260863ebdb4fd4888329e7.png)*

## ***什么时候用钩子？***

*我们都知道钩子的引入是为了在功能组件中包含有状态的东西。因此，在大多数情况下，你可以将类组件转换成功能组件。*

*但是如果我们不再像那样考虑钩子…*

*如果我们把钩子看作是一种编程方式，一种允许我们把逻辑从 UI 中分离出来的工具，这样我们就可以在应用程序的其他地方重用它。*

*作为*增加的*好处，您可以访问组件的状态，因此如果状态发生变化，react 可以进行所有那些花哨的更新。*

## *何时使用定制挂钩？*

*让我们看看一些代码..*

*对知道得比应该知道得多的组件做出反应*

*这是一个使用`useState()`钩子的非常简单的 React `<Form/>`组件。*

1.  *它有一个`<input/>`供用户输入密码*
2.  *它有一个`onChange()`事件来检查密码是否有效*
3.  *如果密码有效，我们会向用户显示它*

*当然，这不是一个真正的形式。它甚至没有一个按钮提交:D
然而，当我们学习新的东西时，我们必须从小处着手。*

*回到我们的例子，你认为这里需要使用定制钩子吗？当我第一次看到这个的时候我真的不知道。*

*正如我之前提到的，*把钩子看作是把你的逻辑和你的 UI 分开的工具。**

*记住，`<Form/>`组件中的`onChange()`方法包含验证密码的逻辑。
`<Form/>`组件太了解密码的处理方式。*

> *每当你看到一个组件知道的比它应该知道的多，它应该是一个你可能需要重构它的信号。*

*![](img/4147ba5eb0bb7903aabbca5166384701.png)*

*让我们从`<Form/>`组件中取出验证逻辑。*

*定制钩子的作用*

*当我第一次看到这样的东西时，我花了大约 15 分钟才明白这里到底发生了什么。你很幸运，你很少会理解这个。*

*事情是这样的:*

1.  *我们创建了一个名为`useSmartPassword()` (14)的定制钩子*
2.  *我们通过使用 React 的`useState()`钩子(15)使我们的定制钩子有状态*
3.  *我们定义了一个函数，我们稍后会公开它，包含我们的逻辑(17)*
4.  *该逻辑从外部接收一些输入，并更新 customHook 的状态(21)*
5.  *最后，我们公开 customHooks 的状态和改变该状态的逻辑函数(24)*

## *还在迷茫？*

*![](img/7b5254c8bf232cf51dfc184c57d245f4.png)*

*每当你写一个自定义钩子时，你必须返回一个包含两个元素的数组。在其他语言中，它被称为元组。*

*这个元组必须包含`currentValue`和一个更新它的函数。类似于:*

```
*[currentValue, setCurrentValue] = customHook();*
```

*更新函数`setCurrentValue()`应该接受参数。该参数可以是更新后的状态或其他值/函数。如果你选择发送一些其他的值/函数，你让更新函数根据它自己的逻辑更新`currentValue`。这就是我们在上面的例子中所做的。*

*记住，无论何时调用更新函数`setCurrentValue()`，都是在更新组件的状态。就像`this.setState()`一样。因此，组件将使用我们的最新状态重新呈现。*

*完整的代码可以在下面的沙盒中看到:*

*使用自定义挂钩的工作示例*

## *结论*

*我想让你从这篇文章中学到的是，如果有必要，钩子可以让你提取逻辑并在应用程序中使用它。因为这些钩子允许您使用 React 的状态，所以您可以让 React 担心组件的更新，同时您可以编写更干净和可伸缩的代码。*

*另外，你再也不需要使用类了。不要再说永远了，但你会明白的。*

*![](img/1cd0fcdd48c2399c46024a96201b9e95.png)*
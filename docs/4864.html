<html>
<head>
<title>Swift Codable — JSON Parser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift Codable — JSON解析器</h1>
<blockquote>原文：<a href="https://itnext.io/swift-codable-json-parser-8661bb57bea7?source=collection_archive---------2-----------------------#2020-10-09">https://itnext.io/swift-codable-json-parser-8661bb57bea7?source=collection_archive---------2-----------------------#2020-10-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/b8f60c7aeea75d525b3d30bc27581d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ff_6hRGazAp6VqyUVjsOMA.png"/></div></div></figure><p id="7b1e" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> C </span> <code class="fe lj lk ll lm b">odable</code>是一个可以将Swift对象本身转换成和转换出<code class="fe lj lk ll lm b">Data</code>类型的协议。<code class="fe lj lk ll lm b">Codable</code>是<code class="fe lj lk ll lm b">Encodable</code>和<code class="fe lj lk ll lm b">Decodable</code>协议的类型别名。这是一个易于使用的官方协议，用于将<code class="fe lj lk ll lm b">JSON</code>对象从服务器解析为Swift对象。</p><p id="a182" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><code class="fe lj lk ll lm b">Encodable</code>用于必须将Swift对象序列化并发送到服务器的情况。另一方面，当服务器JSON数据需要解序列化时，使用<code class="fe lj lk ll lm b">Decodable</code>。</p><p id="bc97" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">此外，符合<code class="fe lj lk ll lm b">Codable</code>的自定义对象现在可以直接保存到<code class="fe lj lk ll lm b">UserDefaults</code>和从<code class="fe lj lk ll lm b">UserDefaults</code>中检索，只需3个步骤。它节省了大量的样板代码。</p><div class="ln lo gq gs lp lq"><a href="https://medium.com/@myrickchow/swift-userdefault-save-custom-object-in-3-steps-only-f4dcf76e85b4" rel="noopener follow" target="_blank"><div class="lr ab fp"><div class="ls ab lt cl cj lu"><h2 class="bd iv gz z fq lv fs ft lw fv fx it bi translated">Swift UserDefault —只需3步即可保存自定义对象！</h2><div class="lx l"><h3 class="bd b gz z fq lv fs ft lw fv fx dk translated">将自定义对象保存到UserDefaults是否困难且繁琐？现在，您只需3个主要步骤即可保存和检索它…</h3></div><div class="ly l"><p class="bd b dl z fq lv fs ft lw fv fx dk translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me ka lq"/></div></div></a></div><p id="c80a" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">我们开始吧！</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="e54a" class="mm mn iu bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">基本解析—简单的JSON</h1><figure class="nk nl nm nn gu jv"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="57d5" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">我们以上面的JSON为例，试着解析成Swift对象。它有4个字段，类型为<code class="fe lj lk ll lm b">String</code>、<code class="fe lj lk ll lm b">Int</code>、<code class="fe lj lk ll lm b">Double</code>，数组为<code class="fe lj lk ll lm b">Int</code>。它们是JSON数据中常见的类型。</p><figure class="nk nl nm nn gu jv"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="1da8" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">通过创建一个符合<code class="fe lj lk ll lm b">Codable</code>的对象，JSON可以直接解码成Swift对象。</p><figure class="nk nl nm nn gu jv"><div class="bz fq l di"><div class="no np l"/></div></figure><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nq"><img src="../Images/32f5aa8db799e955698e56cd0aaf1812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01CNNU5ykRajxTgNSEfg6g.png"/></div></div></figure><p id="5d82" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">默认情况下，Swift结构中的属性名称映射到JSON中的关键字名称。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="51dd" class="mm mn iu bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">按键定制</h1><p id="2f54" class="pw-post-body-paragraph kc kd iu ke b kf nr kh ki kj ns kl km kn nt kp kq kr nu kt ku kv nv kx ky kz in bi translated">按照惯例，JSON中使用snake case(例如<code class="fe lj lk ll lm b">foo_key</code>)而Swift语言中使用camel case(例如<code class="fe lj lk ll lm b">fooKey</code>)。当一个snake case属性出现在一个Swift对象中的时候是超级烦人的。因此，Apple引入了一个<code class="fe lj lk ll lm b">CodingKey</code>协议来提供除原始属性名之外的自定义映射键。</p><figure class="nk nl nm nn gu jv"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="08df" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">所有属性都用骆驼字体书写，如<code class="fe lj lk ll lm b">strProp</code>、<code class="fe lj lk ll lm b">intProp</code>、<code class="fe lj lk ll lm b">doubleProp</code>、<code class="fe lj lk ll lm b">intArrayProp</code>。<code class="fe lj lk ll lm b">init(from decoder: Decoder)</code>为解码<code class="fe lj lk ll lm b">Data</code>提供自定义处理。<code class="fe lj lk ll lm b">Decoder</code>使用<code class="fe lj lk ll lm b">CustomMappingKey</code>中定义的密钥进行解码。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="ea2d" class="mm mn iu bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">编码定制</h1><figure class="nk nl nm nn gu jv"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="ef71" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">为了减少服务器的流量，只有有用的字段才应该序列化并发送给服务器。<code class="fe lj lk ll lm b">encode(to encoder: Encoder)</code>提供定制电子监管和忽略多余字段的机会。在上面的例子中，只有<code class="fe lj lk ll lm b">strProp</code>和<code class="fe lj lk ll lm b">intProp</code>被序列化，而<code class="fe lj lk ll lm b">doubleProp</code>和<code class="fe lj lk ll lm b">intArrayProp</code>被忽略。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="7c0d" class="mm mn iu bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">参考和进一步阅读</h1><h2 id="43e6" class="nw mn iu bd mo nx ny dn ms nz oa dp mw kn ob oc na kr od oe ne kv of og ni oh bi translated">1.可编码文件</h2><div class="ln lo gq gs lp lq"><a href="https://developer.apple.com/documentation/swift/codable" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab fp"><div class="ls ab lt cl cj lu"><h2 class="bd iv gz z fq lv fs ft lw fv fx it bi translated">Apple开发者文档</h2><div class="lx l"><h3 class="bd b gz z fq lv fs ft lw fv fx dk translated">可编码的</h3></div><div class="ly l"><p class="bd b dl z fq lv fs ft lw fv fx dk translated">developer.apple.com</p></div></div></div></a></div><h2 id="ca39" class="nw mn iu bd mo nx ny dn ms nz oa dp mw kn ob oc na kr od oe ne kv of og ni oh bi translated">2.以简单的方式将自定义对象保存到用户默认值</h2><div class="ln lo gq gs lp lq"><a href="https://medium.com/@myrickchow/swift-userdefault-save-custom-object-in-3-steps-only-f4dcf76e85b4" rel="noopener follow" target="_blank"><div class="lr ab fp"><div class="ls ab lt cl cj lu"><h2 class="bd iv gz z fq lv fs ft lw fv fx it bi translated">Swift UserDefault —只需3步即可保存自定义对象！</h2><div class="lx l"><h3 class="bd b gz z fq lv fs ft lw fv fx dk translated">将自定义对象保存到UserDefaults是否困难且繁琐？现在，您可以只通过3个主要步骤来保存和检索它…</h3></div><div class="ly l"><p class="bd b dl z fq lv fs ft lw fv fx dk translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me ka lq"/></div></div></a></div></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/4c04b670b6b538f8e09c1c48ad29dec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*lXznSGgEbsCESDua.png"/></div></figure><p id="75b5" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">欢迎您通过<a class="ae oj" href="https://twitter.com/myrick_chow" rel="noopener ugc nofollow" target="_blank">Twitter @ my rik _ chow</a>关注我，了解更多信息和文章。感谢您阅读这篇文章。祝您愉快！😄</p></div></div>    
</body>
</html>
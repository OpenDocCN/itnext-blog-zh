<html>
<head>
<title>Optional Chaining for Javascript — ES proposal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript-ES建议的可选链接</h1>
<blockquote>原文：<a href="https://itnext.io/optional-chaining-for-javascript-es-proposal-441eb63e14c8?source=collection_archive---------4-----------------------#2019-11-30">https://itnext.io/optional-chaining-for-javascript-es-proposal-441eb63e14c8?source=collection_archive---------4-----------------------#2019-11-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2c9ba86aefe386a8b14f1cf84372442d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jBzeWkpgf_bHJODg.jpg"/></div></div></figure><p id="c07c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">昨天我们看到了<a class="ae kw" href="https://solankiamit.com/nullish-coalescing-for-javascript" rel="noopener ugc nofollow" target="_blank"> nullish合并</a>，今天我们来看看可选链接另一个令人敬畏的ESnext特性。不谈这个太棒了。</p><p id="d6b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就像nullish合并一样，可选链接帮助我们处理<code class="fe kx ky kz la b">undefined</code>和<code class="fe kx ky kz la b">null</code>情况。让我们考虑下面的例子</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="4935" class="lj lk iq la b gy ll lm l ln lo">let<em class="lp"> </em>company<em class="lp"> </em>=<em class="lp"> </em>{<br/>  <em class="lp">name</em>:<em class="lp"> </em>'Github',<br/>  <em class="lp">revenue</em>:<em class="lp"> </em>2000,<br/>  <em class="lp">users</em>:<em class="lp"> </em>[<br/>    {<em class="lp"> name</em>:<em class="lp"> </em>'John',<em class="lp"> handle</em>:<em class="lp"> </em>'@john'<em class="lp"> </em>},<br/>    {<em class="lp"> name</em>:<em class="lp"> </em>'doe',<em class="lp"> handle</em>:<em class="lp"> </em>'@doe'<em class="lp"> </em>},<br/>  ],<br/>  <em class="lp">getUserNames</em>()<em class="lp"> </em>{<br/>    <em class="lp">return users.map</em>(<em class="lp">user </em>=&gt;<em class="lp"> user.name</em>)<br/>  },<br/>}</span></pre><p id="db16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要访问这个对象的值，如果它们或对象可以是<code class="fe kx ky kz la b">undefined</code>或<code class="fe kx ky kz la b">null</code>，我们通常会做以下事情。</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="5c40" class="lj lk iq la b gy ll lm l ln lo">const<em class="lp"> companyName </em>=<br/>  company<em class="lp"> </em>!==<em class="lp"> undefined </em>&amp;&amp;<em class="lp"> </em>company<em class="lp"> </em>!==<em class="lp"> null </em>?<em class="lp"> company.name </em>:<em class="lp"> undefined</em></span></pre><p id="a13f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与可选链接相比，我们可以</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="40c0" class="lj lk iq la b gy ll lm l ln lo">const<em class="lp"> companyName </em>=<em class="lp"> company?.name</em></span></pre><p id="7db2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">语法</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="5ab1" class="lj lk iq la b gy ll lm l ln lo"><em class="lp">obj?.</em>prop //<em class="lp"> optional static property access<br/></em>obj<em class="lp">?.</em>[expr] //<em class="lp"> optional dynamic property access<br/>func?.</em>(...args) //<em class="lp"> optional function or method call</em></span></pre><p id="acae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看看如何处理访问对象属性的多种方式。</p><h1 id="f551" class="lq lk iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">静态属性</h1><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="6d96" class="lj lk iq la b gy ll lm l ln lo">let<em class="lp"> </em>company<em class="lp"> </em>=<em class="lp"> </em>{<br/>  <em class="lp">name</em>:<em class="lp"> </em>'Github',<br/>  <em class="lp">revenue</em>:<em class="lp"> </em>2000,<br/>  <em class="lp">users</em>:<em class="lp"> </em>[<br/>    {<em class="lp"> name</em>:<em class="lp"> </em>'John',<em class="lp"> handle</em>:<em class="lp"> </em>'@john'<em class="lp"> </em>},<br/>    {<em class="lp"> name</em>:<em class="lp"> </em>'doe',<em class="lp"> handle</em>:<em class="lp"> </em>'@doe'<em class="lp"> </em>},<br/>  ],<br/>  <em class="lp">getUserNames</em>()<em class="lp"> </em>{<br/>    <em class="lp">return users.map</em>(<em class="lp">user </em>=&gt;<em class="lp"> user.name</em>)<br/>  },<br/>}</span><span id="a5ff" class="lj lk iq la b gy mn lm l ln lo">//<em class="lp"> with optional Chaining<br/></em>const<em class="lp"> companyName </em>=<em class="lp"> company?.name</em></span><span id="d00e" class="lj lk iq la b gy mn lm l ln lo">//<em class="lp"> without optional Chaining<br/></em>const<em class="lp"> companyName </em>=<br/>  company<em class="lp"> </em>!==<em class="lp"> undefined </em>&amp;&amp;<em class="lp"> </em>company<em class="lp"> </em>!==<em class="lp"> null </em>?<em class="lp"> company.name </em>:<em class="lp"> undefined</em></span></pre><h1 id="5848" class="lq lk iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">动态性能</h1><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="ffcc" class="lj lk iq la b gy ll lm l ln lo">let company = {<br/>  name: 'Github',<br/>  revenue: 2000,<br/>  users: [<br/>    { name: 'John', handle: '<a class="ae kw" href="http://twitter.com/john" rel="noopener ugc nofollow" target="_blank">@john</a>' },<br/>    { name: 'doe', handle: '<a class="ae kw" href="http://twitter.com/doe" rel="noopener ugc nofollow" target="_blank">@doe</a>' },<br/>  ],<br/>  getUserNames() {<br/>    return users.map(user =&gt; user.name)<br/>  },<br/>}</span><span id="6d27" class="lj lk iq la b gy mn lm l ln lo">// with optional Chaining<br/>const companyName = company?.['name']</span><span id="6460" class="lj lk iq la b gy mn lm l ln lo">// without optional Chaining<br/>const companyName =<br/>  company !== undefined &amp;&amp; company !== null ? company['name'] : undefined</span></pre><h1 id="0049" class="lq lk iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">函数调用</h1><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="b434" class="lj lk iq la b gy ll lm l ln lo">let company = {<br/>  name: 'Github',<br/>  revenue: 2000,<br/>  users: [<br/>    { name: 'John', handle: '<a class="ae kw" href="http://twitter.com/john" rel="noopener ugc nofollow" target="_blank">@john</a>' },<br/>    { name: 'doe', handle: '<a class="ae kw" href="http://twitter.com/doe" rel="noopener ugc nofollow" target="_blank">@doe</a>' },<br/>  ],<br/>  getUserNames() {<br/>    return users.map(user =&gt; user.name)<br/>  },<br/>}</span><span id="8f94" class="lj lk iq la b gy mn lm l ln lo">// with optional Chaining<br/>company.getUserNames?.()</span><span id="46ae" class="lj lk iq la b gy mn lm l ln lo">// without optional Chaining<br/>const companyName =<br/>  company !== undefined &amp;&amp;<br/>  company !== null &amp;&amp;<br/>  Object.prototype.hasOwnProperty('getUserNames') &amp;&amp;<br/>  typeof company.getUserNames === 'function'<br/>    ? company['name']<br/>    : undefined</span></pre><h1 id="15c1" class="lq lk iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">Dom访问</h1><p id="e6da" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">可选链接支持DOM及其方法，所以我们可以这样做</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="2f37" class="lj lk iq la b gy ll lm l ln lo">const val = document.querySelector('input#name')?.value</span></pre><p id="ebcf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果表达式失败，可选链接将总是返回<code class="fe kx ky kz la b">undefined</code>。</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="567b" class="lj lk iq la b gy ll lm l ln lo">const value = company?.name</span><span id="d642" class="lj lk iq la b gy mn lm l ln lo">// 'value' will be undefined if company is undefined.</span></pre><p id="5e49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们可以将可选链接与nullish合并结合起来处理这些情况。</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="ee67" class="lj lk iq la b gy ll lm l ln lo">const value = company?.name ?? 'default name'</span><span id="d06d" class="lj lk iq la b gy mn lm l ln lo">// 'value' will be 'default name' if either the company or name is undefined or null.</span></pre><p id="062c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用一个完整的例子来结束它</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="ccfe" class="lj lk iq la b gy ll lm l ln lo">let company = {<br/>  name: 'Github',<br/>  revenue: 2000,<br/>  users: [<br/>    { name: 'John', handle: '<a class="ae kw" href="http://twitter.com/john" rel="noopener ugc nofollow" target="_blank">@john</a>' },<br/>    { name: 'doe', handle: '<a class="ae kw" href="http://twitter.com/doe" rel="noopener ugc nofollow" target="_blank">@doe</a>' },<br/>  ],<br/>  getUserNames() {<br/>    return users.map(user =&gt; user.name)<br/>  },<br/>}</span><span id="b082" class="lj lk iq la b gy mn lm l ln lo">// Static access with default value<br/>const value = company?.name ?? 'default name'</span><span id="195b" class="lj lk iq la b gy mn lm l ln lo">// Dynamic access with default value<br/>const companyName = company?.['name'] ?? 'default value'</span><span id="80a5" class="lj lk iq la b gy mn lm l ln lo">// Function call<br/>company.getUserNames?.()</span></pre><p id="f7c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可选的链接和无效合并带来了很多好处，降低了复杂性，使代码可读。给他们一个机会，并在下面的评论中告诉我你的观点。</p><p id="cc92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今天可以用下面这些巴别塔插件来使用。</p><p id="5fc1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在推特上关注我</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="65cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lp">原载于2019年11月30日</em><a class="ae kw" href="https://solankiamit.com/optional-chaining-for-javascript-es-proposal" rel="noopener ugc nofollow" target="_blank"><em class="lp">https://solankiamit.com</em></a><em class="lp">。</em></p></div></div>    
</body>
</html>
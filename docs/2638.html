<html>
<head>
<title>Create your first web scraper with Scraper API and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Scraper API和Python创建您的第一个web scraper</h1>
<blockquote>原文：<a href="https://itnext.io/create-your-first-web-scraper-with-scraper-api-and-python-a42b9f850eb6?source=collection_archive---------1-----------------------#2019-07-01">https://itnext.io/create-your-first-web-scraper-with-scraper-api-and-python-a42b9f850eb6?source=collection_archive---------1-----------------------#2019-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e34126e68077a9455e784fcd639fc0c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xcT5-nsnAfixPqjWB8JYtg.png"/></div></div></figure><p id="7bb7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最近，我遇到了一个工具，它可以解决你在浏览网站时通常会遇到的许多问题。这个工具叫做<a class="ae kw" href="http://scraperapi.com/?via=adnan98" rel="noopener ugc nofollow" target="_blank"> Scraper API </a>，它提供了一个易于使用的REST API来轻松抓取不同类型的网站(Simple，JS enabled，Captcha等)。在我继续之前，请允许我介绍一下<em class="kx"> Scraper API </em>。</p><h1 id="1652" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">什么是刮刀API</h1><p id="5e3d" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">如果你访问他们的网站<a class="ae kw" href="https://www.scraperapi.com/?fp_ref=adnan22" rel="noopener ugc nofollow" target="_blank">你会发现他们的使命宣言:</a></p><blockquote class="mb mc md"><p id="09dd" class="jy jz kx ka b kb kc kd ke kf kg kh ki me kk kl km mf ko kp kq mg ks kt ku kv ij bi translated">Scraper API处理代理、浏览器和验证码，因此您可以通过简单的API调用从任何网页获取HTML！</p></blockquote><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/61cb539bc9f3d8f25b57dc462a92e774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4kwC2poJ-i3BEUY4.png"/></div></div></figure><p id="9c06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如它所暗示的，它为你提供了所有的东西来处理你在写文章时经常遇到的问题。</p><h1 id="666f" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">发展</h1><p id="1206" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">Scraper API提供了一个可以在任何语言中使用的REST API。因为这篇文章与Python有关，所以我将主要关注使用这个工具的<code class="fe ml mm mn mo b">requests</code>库。</p><p id="f649" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你必须先和他们注册，作为回报，他们会给你一个API密匙来使用他们的平台。他们提供了1000个免费的API调用，足以测试他们的平台。此外，他们提供不同的计划，从初学者到企业，你可以在这里查看<a class="ae kw" href="https://www.scraperapi.com/pricing" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="def3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们尝试一个简单的例子，它也在<a class="ae kw" href="https://www.scraperapi.com/documentation" rel="noopener ugc nofollow" target="_blank">文档</a>中给出。</p><pre class="mh mi mj mk gt mp mo mq mr aw ms bi"><span id="bf1e" class="mt kz iq mo b gy mu mv l mw mx">import requests</span><span id="fd93" class="mt kz iq mo b gy my mv l mw mx">if __name__ == '__main__':<br/>    API_KEY = '&lt;YOUR API KEY&gt;'<br/>    URL_TO_SCRAPE = '<a class="ae kw" href="https://httpbin.org/ip'" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/ip'</a></span><span id="8627" class="mt kz iq mo b gy my mv l mw mx">payload = {'api_key': API_KEY, 'url': URL_TO_SCRAPE}</span><span id="6e61" class="mt kz iq mo b gy my mv l mw mx">r = requests.get('<a class="ae kw" href="http://api.scraperapi.com'" rel="noopener ugc nofollow" target="_blank">http://api.scraperapi.com'</a>, params=payload, timeout=60)</span><span id="fd3b" class="mt kz iq mo b gy my mv l mw mx">print(r.text)</span></pre><p id="eb8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设您已经注册并获得了可以在<a class="ae kw" href="https://www.scraperapi.com/dashboard" rel="noopener ugc nofollow" target="_blank">仪表盘</a>上找到的API，您可以在获得它后立即开始工作。当你运行这个程序时，它会显示你请求的IP地址。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/9eb3daa6494b795407ade0f9dea20fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KF_gCjli6LFwR2mn.png"/></div></div></figure><p id="4b3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你看到了吗，每次它都返回一个新的IP地址，很酷吧？</p><p id="c59f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在某些情况下，您希望使用同一个代理给人一种感觉，好像单个用户正在访问网站的不同部分。为此，您可以在上面的<code class="fe ml mm mn mo b">payload</code>变量中传递<code class="fe ml mm mn mo b">session_number</code>参数。</p><pre class="mh mi mj mk gt mp mo mq mr aw ms bi"><span id="703e" class="mt kz iq mo b gy mu mv l mw mx">URL_TO_SCRAPE = '<a class="ae kw" href="https://httpbin.org/ip'" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/ip'</a><br/>payload = {'api_key': API_KEY, 'url': URL_TO_SCRAPE,'session_number': '123'}<br/>r = requests.get('<a class="ae kw" href="http://api.scraperapi.com'" rel="noopener ugc nofollow" target="_blank">http://api.scraperapi.com'</a>, params=payload, timeout=60)<br/>print(r.text)</span></pre><p id="337c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它会产生以下结果:</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/1ca04b2a502f344f4ee4ce953659fc8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*F47h8KxxRHpc4bV1.png"/></div></figure><p id="ee04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你能注意到这里有相同的代理IP吗？</p><h1 id="bdf5" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建OLX废品收购站</h1><p id="c338" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">就像之前的<a class="ae kw" href="http://blog.adnansiddiqi.me/tag/scraping/" rel="noopener ugc nofollow" target="_blank">刮相关帖子</a>一样，我将再次选择OLX来发表这篇帖子。我将首先迭代列表，然后将刮个别项目。下面是完整的代码。</p><pre class="mh mi mj mk gt mp mo mq mr aw ms bi"><span id="0dd7" class="mt kz iq mo b gy mu mv l mw mx">payload = {'api_key': API_KEY, 'url': URL_TO_SCRAPE, 'session_number': '123'}</span><span id="ad02" class="mt kz iq mo b gy my mv l mw mx">r = requests.get('<a class="ae kw" href="http://api.scraperapi.com'" rel="noopener ugc nofollow" target="_blank">http://api.scraperapi.com'</a>, params=payload, timeout=60)</span><span id="7c0d" class="mt kz iq mo b gy my mv l mw mx">if r.status_code == 200:<br/>        html = r.text.strip()<br/>        soup = BeautifulSoup(html, 'lxml')<br/>        links = soup.select('.EIR5N &gt; a')</span><span id="c5c0" class="mt kz iq mo b gy my mv l mw mx">for l in links:<br/>            all_links.append('<a class="ae kw" href="https://www.olx.com.pk'" rel="noopener ugc nofollow" target="_blank">https://www.olx.com.pk'</a> + l['href'])</span><span id="4403" class="mt kz iq mo b gy my mv l mw mx">idx = 0</span><span id="ba49" class="mt kz iq mo b gy my mv l mw mx">if len(all_links) &gt; 0:<br/>            for link in all_links:<br/>                sleep(5)<br/>                payload = {'api_key': API_KEY, 'url': link, 'session_number': '123'}</span><span id="21f5" class="mt kz iq mo b gy my mv l mw mx">if idx &gt; 1:<br/>                    break</span><span id="f46c" class="mt kz iq mo b gy my mv l mw mx">r = requests.get('<a class="ae kw" href="http://api.scraperapi.com'" rel="noopener ugc nofollow" target="_blank">http://api.scraperapi.com'</a>, params=payload, timeout=60)</span><span id="d10a" class="mt kz iq mo b gy my mv l mw mx">if r.status_code == 200:<br/>                    html = r.text.strip()<br/>                    soup = BeautifulSoup(html, 'lxml')<br/>                    price_section = soup.find('span', {'data-aut-id': 'itemPrice'})<br/>                    print(price_section.text)</span><span id="3804" class="mt kz iq mo b gy my mv l mw mx">idx += 1</span></pre><p id="08a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用<code class="fe ml mm mn mo b">Beautifulsoup</code>来解析HTML。我在这里只提取了价格，因为目的是讲述API本身，而不是<em class="kx"> Beautifulsoup </em>。如果你是scraping和Python的新手，你应该在这里看到我的帖子<a class="ae kw" href="http://blog.adnansiddiqi.me/write-your-first-web-scraper-in-python-with-beautifulsoup/" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="2d76" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="3acc" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">在这篇文章中，你学习了如何使用Scraper API进行抓取。无论你用这个API做什么，你也可以用其他方法来做；这个API为您提供了一切，特别是通过Javascript呈现页面，您需要无头浏览器，有时在远程机器上设置无头抓取会变得很麻烦。Scraper API在打理，对个人和企业象征性收费。我工作的公司每月花费100美元用于代理IP。</p><p id="c45e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">哦，如果你通过我的推荐链接在这里注册<a class="ae kw" href="http://scraperapi.com/?via=adnan98" rel="noopener ugc nofollow" target="_blank">或者输入促销代码<strong class="ka ir"> adnan10 </strong>，你将获得10%的折扣。如果你没有得到折扣，那么就在我的网站上通过电子邮件让我知道，我一定会帮助你。</a></p><p id="fc6a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在接下来的日子里，我会写更多关于Scraper API的帖子，讨论更多的特性。</p><p id="36ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">本帖原载</em> <a class="ae kw" href="http://blog.adnansiddiqi.me/create-your-first-web-scraper-with-scraper-api-and-python/" rel="noopener ugc nofollow" target="_blank"> <em class="kx">此处</em> </a> <em class="kx">。</em></p></div></div>    
</body>
</html>
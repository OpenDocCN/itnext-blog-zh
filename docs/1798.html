<html>
<head>
<title>Get Fluttered: A Deceptively Simple Bottom AppBar Part #1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">飘动:一个看似简单的底部应用程序栏第1部分</h1>
<blockquote>原文：<a href="https://itnext.io/get-fluttered-a-simple-bottom-app-bar-part-1-354b3858e2a8?source=collection_archive---------1-----------------------#2019-01-31">https://itnext.io/get-fluttered-a-simple-bottom-app-bar-part-1-354b3858e2a8?source=collection_archive---------1-----------------------#2019-01-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8c4e33b84077846aaa812a447dd0737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CeMPDJCtaXyXMyYmPdDxxQ.gif"/></div></div></figure><p id="e907" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个小部件就是我们今天要学习构建的！</p><p id="d4e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">几个月前，我开始了学习Flutter的旅程。来自Android背景的颤动感觉更容易处理。但是在这个学习扑朔迷离的阶段，我总是发现很难找到学习它的好资源。因此，我决定为Flutter社区贡献我的一份力量，写一些关于不同事物的文章，希望你和我能一起学习。这是我的第一篇文章！</p><p id="7b8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">什么是扑腾？<br/></strong>Get flated是一个系列文章，在这个系列中，我将尝试重新创作一些我在互联网上找到的美丽设计，并与你分享我的学习。</p><p id="1ce4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你在顶部看到的gif是我们今天要构建的。首先，这个设计灵感来自于Dribbble上维塔利·鲁布索夫的 <a class="ae kw" href="https://dribbble.com/shots/5050708-Tab-Bar-Animation" rel="noopener ugc nofollow" target="_blank">标签栏动画</a>。</p><p id="064e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">有什么先决条件吗？1)关于动画如何在Flutter中工作的一些知识。当你不理解某事时，不要放弃。谷歌一下这个话题，看看视频，然后回来再试一次。</strong></p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="3304" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在编写任何代码之前，让我们看一下我们的小部件，看看构建它需要哪些组件。我看到以下组件-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/a2c803ca3b75c43c15e36f28c1e98e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czdo1btZa-n71IrrmbLMyg.png"/></div></div></figure><p id="0c09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">考虑到所有的动画，还有一些事情(让我们把它们命名为KEYNOTES，因为我会在文章中反复提到它们)我们需要记住:- <br/> 1)在动画的整个持续时间内，新选择的选项比所有其他选项占用更多的空间。<br/> 2)文本仅在当前选择的选项中可见。<br/> 3)当选择一个新选项时，文本从当前选择的选项开始滑动和淡出，然后再次出现，滑入新选择的选项。<br/> 4)新选择的选项图标以3种不同的方式显示动画——向上滑动、向左或向右滑动以及倾斜。对于先前选择的选项，此动画完全反向运行。</p><p id="ea74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好的，这就是我们需要实现的很多目标。但是不要担心，我们会一砖一瓦，一步一步来。</p><p id="c031" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们试着实现KEYNOTE号<br/>,我们需要的是能够在需要的时候沿着选项的宽度调整选项的大小。为此，我们使用了<code class="fe lj lk ll lm b"><a class="ae kw" href="https://docs.flutter.io/flutter/widgets/Flex-class.html" rel="noopener ugc nofollow" target="_blank">Flex</a></code>的概念。<code class="fe lj lk ll lm b">Flex</code>窗口小部件(ex- Flexible、Spacer等)允许我们根据同一层级的其他<code class="fe lj lk ll lm b">Flex</code>窗口小部件来调整元素的大小。例如，如果我考虑两个<code class="fe lj lk ll lm b"><a class="ae kw" href="https://docs.flutter.io/flutter/widgets/Flexible-class.html" rel="noopener ugc nofollow" target="_blank">Flexible</a></code>小部件，并分别为它们提供1和2的<code class="fe lj lk ll lm b">flex</code>，那么它们将沿着特定的轴以1:2的比例占用可用空间。该轴由其父轴定义。如果父级是列，那么小部件在垂直方向弯曲以填充列，如果父级是行，那么小部件在水平方向弯曲以填充行。<br/>让我们看看如何利用这一点来实现我们的第一个主题演讲。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="488b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将一列<code class="fe lj lk ll lm b">flex</code>值定义为<code class="fe lj lk ll lm b">flexValues</code>，并将这些flex值分配给各自的<code class="fe lj lk ll lm b">Flexible </code>小部件。你可能会想，如果是关于按比例调整窗口小部件的大小，那么我们为什么要给它们这么大的flex值，比如100和150。相反，我们应该只提供2和3，因为这些值给出了相同的比率。我来解释一下，<code class="fe lj lk ll lm b">flex</code>只能是整数。我们将使用这些<code class="fe lj lk ll lm b">flex</code>值来制作点击事件的动画。因此，如果我们将我们的<code class="fe lj lk ll lm b">flex</code>值从2变为3，结果将是一个突然的变化，从2直接变为3。相反，如果我们将<code class="fe lj lk ll lm b">flex</code>的值从100动画到150，我们会将这种突然性降低1/50。<br/>我们得到以下输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/e3e5576ad008920fed6a5c03a06040a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1eV7gOX8_CsuF9e_gQjBQ.png"/></div></div></figure><p id="1653" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们包括一个小的测试动画。该动画向我们展示了<code class="fe lj lk ll lm b">flex</code>值的变化如何影响每个选项的宽度。我们只是在<code class="fe lj lk ll lm b">SimpleBottomAppBarState</code>类中添加了以下内容-</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="2159" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们看到以下输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/a87275609ba19343e75df51cb799082d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*scSW7BYjeELcJtzwU2d0dg.gif"/></div></figure><p id="4ce9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在可以有把握地说，我们现在知道如何实施1号基调了吗？嗯……嗯，不尽然。那么，我们错过了什么？Flutter中的许多小部件如果没有子部件，就会采用它们父部件的尺寸，但是当它们有了子部件时，就会采用它们子部件的尺寸。那么这对我们有什么影响呢？正如文件中提到的-</p><blockquote class="lr ls lt"><p id="8b0b" class="jy jz lu ka b kb kc kd ke kf kg kh ki lv kk kl km lw ko kp kq lx ks kt ku kv ij bi translated">默认情况下，占位符的大小适合其容器。</p></blockquote><p id="c0b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这基本上意味着<code class="fe lj lk ll lm b">Placeholder</code>小部件正在迫使灵活的小部件在不溢出的情况下尽可能地扩展(沿着行指定的方向)。如果我们用一个不强迫<code class="fe lj lk ll lm b">Flexible</code>展开的小部件替换<code class="fe lj lk ll lm b">Placeholder</code>小部件，那么<code class="fe lj lk ll lm b">Flexible</code>将收缩到其子部件的大小。<br/>为了理解这一点，用我们需要的图标(主页、时间线、事件、历史)替换所有占位符部件。这是代码-</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="4e60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/d916bc803d326acb3fe03ae6a4917d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3xQviV-hM_VZo1XRF-3NA.png"/></div></div></figure><p id="9df0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如何解决这个问题？我们需要想办法让<code class="fe lj lk ll lm b">Icons</code>迫使<code class="fe lj lk ll lm b">Flexible</code>尽可能多地占用空间。这个问题的解决方案是<code class="fe lj lk ll lm b">Flexible</code>小部件的<code class="fe lj lk ll lm b"><a class="ae kw" href="https://docs.flutter.io/flutter/rendering/FlexFit-class.html" rel="noopener ugc nofollow" target="_blank">fit</a></code>属性。属性可以有两个值，松散或紧密。文件上写着-</strong></p><blockquote class="lr ls lt"><p id="04fe" class="jy jz lu ka b kb kc kd ke kf kg kh ki lv kk kl km lw ko kp kq lx ks kt ku kv ij bi translated">loose → const <a class="ae kw" href="https://docs.flutter.io/flutter/rendering/FlexFit-class.html" rel="noopener ugc nofollow" target="_blank"> FlexFit </a></p><p id="873c" class="jy jz lu ka b kb kc kd ke kf kg kh ki lv kk kl km lw ko kp kq lx ks kt ku kv ij bi translated">孩子被迫填满可用的空间。</p></blockquote><p id="3e2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们需要的是<code class="fe lj lk ll lm b">Flexible</code>小部件的<code class="fe lj lk ll lm b">fit</code>属性的‘紧密’值。所以让我们在代码中做些改变-</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="d6c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/1d97b2236f92b7f0b2d197d1c7a9d325.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*zcOrmpJkWrt3qm7QVVdyEA.gif"/></div></figure><p id="c4a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们看到我们的<code class="fe lj lk ll lm b">Flexible</code>小部件在不溢出的情况下占用了尽可能多的空间。现在我们可以有把握地说，我们已经理解了如何实施第一条基调。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="75b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们继续前进，努力实现第二个主题。<br/>2号主题演讲要求文本必须仅在新选择的选项下方可见。<br/> <strong class="ka ir">那么如何做到这一点呢？</strong> <br/>首先，我们需要一些东西来注册用户的点击。为此，我借助了<code class="fe lj lk ll lm b">FlatButton</code>小部件。正如文件中提到的-</p><blockquote class="lr ls lt"><p id="1622" class="jy jz lu ka b kb kc kd ke kf kg kh ki lv kk kl km lw ko kp kq lx ks kt ku kv ij bi translated">扁平按钮的最小尺寸为88.0×36.0，可以用<a class="ae kw" href="https://docs.flutter.io/flutter/material/ButtonTheme-class.html" rel="noopener ugc nofollow" target="_blank">按钮主题</a>覆盖。</p></blockquote><p id="bb7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以你可能会想，这个尺寸可能会成为一个问题，但是让我们回顾一下我们在执行1号主题演讲时学到的东西。我们看到，如果我们将<code class="fe lj lk ll lm b">Flexible</code>的<code class="fe lj lk ll lm b">fit</code>属性设置为‘紧’,那么子元素会将自身调整到最大允许宽度和高度。因此，如果这个<code class="fe lj lk ll lm b">FlatButton</code>是我们的<code class="fe lj lk ll lm b">Flexible</code>小部件的子部件，它将调整自己的大小到最大可能的可用空间。让我们通过实现下面的代码来看看这一点(我在<code class="fe lj lk ll lm b">initState()</code>方法中注释掉了<code class="fe lj lk ll lm b">_controller.repeat()</code>)</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="c49a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/a215feaf5e95dc5feb8c7105096e07b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_BEq1NqyGvcRlEwL_-9oA.png"/></div></div></figure><p id="1334" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们实现这些<code class="fe lj lk ll lm b">FlatButton</code>部件的子部件。每个<code class="fe lj lk ll lm b">FlatButton</code>小部件的子部件是一个<code class="fe lj lk ll lm b">Column</code>，它有两个子部件，一个<code class="fe lj lk ll lm b">Icon</code>和一个<code class="fe lj lk ll lm b">Text</code>。我们利用<code class="fe lj lk ll lm b">Column</code>小部件的<code class="fe lj lk ll lm b">mainAxisAlignment</code>属性来垂直居中子控件，并利用<code class="fe lj lk ll lm b">crossAxisAlignment</code>属性来水平居中子控件。这是我的代码-</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="97ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你们有些人可能会想，为什么我们要把<code class="fe lj lk ll lm b">Text</code>的<code class="fe lj lk ll lm b">fontWeight</code>设置为400。原因是默认情况下<code class="fe lj lk ll lm b">FlatButton</code>有自己的<code class="fe lj lk ll lm b">Material</code>，因此文本会以粗体显示。这是输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/9c8cfd7ab74561aa8b47e81952f16b41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ug9kdAkIOzyCkSVP08xBKA.png"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="6e0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们通过动画制作<code class="fe lj lk ll lm b">Flexible</code>小部件的<code class="fe lj lk ll lm b">flex</code>值来完成1号主题演讲。同时，让我们在<code class="fe lj lk ll lm b">Text</code>小部件上使用<code class="fe lj lk ll lm b">Opacity</code>小部件来实现KEYNOTE NO. 2。这是我如何实现这两件事的</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="3893" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我在这里做了很多改变。首先，我创建了两个新变量<code class="fe lj lk ll lm b">currentIndex</code>和<code class="fe lj lk ll lm b">previousIndex</code>。它们帮助我跟踪用户选择了哪些选项。我引入了一个名为<code class="fe lj lk ll lm b">_onOptionClicked</code>的新方法，当用户点击任何选项时，它都会更新<code class="fe lj lk ll lm b">currentIndex</code>和<code class="fe lj lk ll lm b">previousIndex</code>的值。在<code class="fe lj lk ll lm b">setState()</code>方法中，我相应地改变不透明度值。我还将AnimationController的持续时间从3秒改为250毫秒。</p><p id="d17a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是输出-</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/86f90cfd37edab088c33410a6581bf67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*tmzMo6jF9NH-Imh7lnPitA.gif"/></div></figure><p id="9cde" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们剩下的是剩余2个主题的实现，我计划在下一篇文章中介绍。我知道我知道，当你想看下一篇文章时，这种感觉很糟糕，但是作者还没有发表它。相信我，我会尽最大努力在几天内把它送出去。在那之前，我会鼓励你继续努力，试着自己建造它。</p><blockquote class="mb"><p id="35d5" class="mc md iq bd me mf mg mh mi mj mk kv dk translated">编辑:<br/>链接到第二部分-</p></blockquote><div class="ml mm mn mo mp mq"><a href="https://medium.com/@guptamanas1998/get-fluttered-a-deceptively-simple-bottom-app-bar-part-2-879ddb7b063c" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd ir gy z fp mv fr fs mw fu fw ip bi translated">飘动:一个看似简单的底部应用程序栏第二部分</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">边建设边学习是我们的座右铭</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">medium.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne jw mq"/></div></div></a></div><p id="0859" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我也想感谢你们所有人一直读到最后，因为我知道有很多东西要经历，但最后，如果你学到了新的东西，那么这一切都是值得的。</p><blockquote class="mb"><p id="103f" class="mc md iq bd me mf mg mh mi mj mk kv dk translated">P.S. - <br/> 1)您对构建这个小部件所需的组件的理解可能与我的完全不同。我鼓励你发扬你的思维方式，并坚持到底。请不要忘记与我分享它！<br/> 2)我希望收到你的反馈，告诉我如何改进我未来的文章。也请不要回避任何形式的批评。如果你想在<a class="ae kw" href="https://twitter.com/Devs_aint_Geeks" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，我们非常欢迎。</p><p id="0da0" class="mc md iq bd me mf mg mh mi mj mk kv dk translated">尽情飘飘！</p></blockquote></div></div>    
</body>
</html>
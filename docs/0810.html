<html>
<head>
<title>Creating an Interpose Vue component from a React implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从React实现创建插入器Vue组件</h1>
<blockquote>原文：<a href="https://itnext.io/creating-an-interpose-vue-component-from-a-react-implementation-80d367a695c6?source=collection_archive---------3-----------------------#2018-06-01">https://itnext.io/creating-an-interpose-vue-component-from-a-react-implementation-80d367a695c6?source=collection_archive---------3-----------------------#2018-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5e8e43de2f4dab2a4a4718a4a4aebf3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DP2Wrb3sXbZR1AlYi8M1Fg.png"/></div></div></figure><p id="962d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">昨天我偶然发现了andrewingram 中的这个很酷的反应要点，Andrew本人和Matt Berridge讨论了一个简单的插入组件来显示列表项之间的分隔符组件。</p><p id="2ca0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个简单的用例，但这正是UI组件的目标:解决一个简单的任务，仅此而已。</p><p id="45c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，提到的要点是:</p><figure class="kz la lb lc gt jr"><div class="bz fp l di"><div class="ld le l"/></div></figure><p id="9b6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是马特的版本，用的是JSX，更具宣言性，也更简洁:</p><pre class="kz la lb lc gt lf lg lh li aw lj bi"><span id="b819" class="lk ll iq lg b gy lm ln l lo lp"><strong class="lg ir">const</strong> Interpose = ({ children, separator: Separator }) =&gt; {<br/>  <strong class="lg ir">return</strong> React.Children.toArray(children).map((element, index) =&gt; (<br/>    &lt;React.Fragment key={`interpose-${index}-fragment`}&gt;<br/>      {index &gt; 0 ? &lt;Separator /&gt; : null}<br/>      &lt;element.type {...element.props} /&gt;<br/>    &lt;/React.Fragment&gt;<br/>  ))<br/>}<br/><br/>Interpose.propTypes = {<br/>  separator: PropTypes.func,<br/>}<br/><br/>Interpose.defaultProps = {<br/>  separator: () =&gt; null<br/>}<br/><br/><strong class="lg ir">export default</strong> Interpose</span></pre></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="bfb9" class="lx ll iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">Vue能做到吗？</h1><p id="28f2" class="pw-post-body-paragraph jy jz iq ka b kb mu kd ke kf mv kh ki kj mw kl km kn mx kp kq kr my kt ku kv ij bi translated">于是我想:我能不能用<strong class="ka ir"> Vue </strong>做点类似的东西？我希望能够写出类似下面这样的东西:</p><pre class="kz la lb lc gt lf lg lh li aw lj bi"><span id="7a24" class="lk ll iq lg b gy lm ln l lo lp">&lt;template&gt;<br/>  &lt;vue-interpose :separator=”MySeparator”&gt;<br/>    &lt;my-list-item v-for=”item in items” :key=”item” v-bind="item" /&gt;<br/>  &lt;/vue-interpose&gt;<br/>&lt;/template&gt;</span></pre><ol class=""><li id="7e63" class="mz na iq ka b kb kc kf kg kj nb kn nc kr nd kv ne nf ng nh bi translated">分隔符组件应该作为属性传递。</li><li id="1c5b" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated">只要它是一个数组，插入组件和它插入的内容之间就不能有依赖关系。家长应该负责提供内容。</li></ol><p id="03d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我想到的解决方案，用JSX的渲染函数:</p><figure class="kz la lb lc gt jr"><div class="bz fp l di"><div class="ld le l"/></div></figure><p id="a623" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如您所见，分隔符是通过prop提供的，而“主要内容”是使用<code class="fe no np nq lg b">context.children</code>属性呈现的，与React中的<code class="fe no np nq lg b">children</code>非常相似。</p><p id="b964" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意我如何使用<code class="fe no np nq lg b">h()</code>方法(又名<code class="fe no np nq lg b">createElement</code>)从我们的分离器道具创建一个真实的组件。我还没有找到将Vue组件作为prop传递的方法，所以我只能传递对象，然后从它们创建组件。</p><p id="771f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://vuejs.org/v2/guide/render-function.html#Functional-Components" rel="noopener ugc nofollow" target="_blank">函数参数</a>派上了用场，因为它创建了一个无状态/无实例组件，并为渲染函数提供了第二个<code class="fe no np nq lg b">context</code>参数。舒服！</p><h2 id="4e6c" class="lk ll iq bd ly nr ns dn mc nt nu dp mg kj nv nw mk kn nx ny mo kr nz oa ms ob bi translated"><strong class="ak">本实施的注意事项:</strong></h2><ul class=""><li id="2b50" class="mz na iq ka b kb mu kf mv kj oc kn od kr oe kv of nf ng nh bi translated">必须在组件的<code class="fe no np nq lg b">data()</code>中声明MySeparator。我想注册成组件，但是找不到合适的方式。</li><li id="82b0" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv of nf ng nh bi translated"><em class="nn">我的插入器组件在其内容周围添加了一个难看的</em> <code class="fe no np nq lg b"><em class="nn">&lt;div&gt;</em></code> <em class="nn">。我希望我有类似于</em> <code class="fe no np nq lg b"><em class="nn">React.Fragment</em></code> <em class="nn">(这个</em> <code class="fe no np nq lg b"><em class="nn">&lt;template&gt;</em></code> <em class="nn">标签在渲染函数中不起作用)。<br/> </em> <strong class="ka ir">再也不是了</strong>！<a class="kx ky ep" href="https://medium.com/u/dfebe6aa25f0?source=post_page-----80d367a695c6--------------------------------" rel="noopener" target="_blank">micham ciński</a>教我“一个函数组件的渲染函数可以返回一个数组”，所以不用再包装了！谢谢你的建议，米歇尔！</li><li id="8432" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv of nf ng nh bi translated">如前所述，分隔符道具只是一个对象，而不是“组件”。应该有某种类型的属性验证来避免无效对象被作为属性传递。</li></ul></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><p id="fb47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的假设是<code class="fe no np nq lg b">scoped-slots</code>可以用来修复一些提到的警告。然而，我想模仿Interpose的React实现，这是我能做到的最接近的。</p><p id="1467" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我错过了一些可以帮助我的很酷的Vue功能吗？欢迎在评论区改进我的解决方案！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Kubernetes local playground alternatives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes当地游乐场替代品</h1>
<blockquote>原文：<a href="https://itnext.io/kubernetes-local-playground-alternatives-e1a590632b9f?source=collection_archive---------0-----------------------#2020-11-27">https://itnext.io/kubernetes-local-playground-alternatives-e1a590632b9f?source=collection_archive---------0-----------------------#2020-11-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/369d9abad7e4311a8c95f68bf4778f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*flTv4RNcalmNEMHV.jpg"/></div></div></figure><h1 id="735e" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">简介</strong></h1><p id="1493" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在本文中，我们将探索在本地运行集群的不同替代方案，用于测试、实践或开发应用程序。</p><p id="9954" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">下面列出了我们将要测试的项目的源代码和/或文档:</p><ul class=""><li id="a2b9" class="lz ma iq ky b kz lu ld lv lh mb ll mc lp md lt me mf mg mh bi translated"><a class="ae mi" href="https://minikube.sigs.k8s.io/docs/start/" rel="noopener ugc nofollow" target="_blank">迷你库贝</a></li><li id="0049" class="lz ma iq ky b kz mj ld mk lh ml ll mm lp mn lt me mf mg mh bi translated"><a class="ae mi" href="https://kind.sigs.k8s.io/docs/user/quick-start/" rel="noopener ugc nofollow" target="_blank">善良</a></li><li id="a1bc" class="lz ma iq ky b kz mj ld mk lh ml ll mm lp mn lt me mf mg mh bi translated"><a class="ae mi" href="https://github.com/kainlite/kubernetes-the-easy-way-with-vagrant" rel="noopener ugc nofollow" target="_blank"> Kubernetes使用流浪者的艰难方式</a></li><li id="89cf" class="lz ma iq ky b kz mj ld mk lh ml ll mm lp mn lt me mf mg mh bi translated"><a class="ae mi" href="https://github.com/kainlite/kubernetes-the-easy-way-with-vagrant-and-kubeadm" rel="noopener ugc nofollow" target="_blank"> Kubernetes与kubeadm使用流浪者</a></li></ul><p id="d3e8" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">还有更多类似于<a class="ae mi" href="https://microk8s.io/" rel="noopener ugc nofollow" target="_blank"> Microk8s </a>的选择，但我将把它留给读者作为练习。</p><p id="645b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">如果你想尝试每一种方法，请确保遵循他们推荐的安装方式或你的发行版/系统方式。</p><p id="e88a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">前两个(minikube和kind)我们将看到如何配置CNI插件，以便能够使用<a class="ae mi" href="https://kubernetes.io/docs/concepts/services-networking/network-policies/" rel="noopener ugc nofollow" target="_blank">网络策略</a>，在其他两个环境中，您可以自定义一切，这些最适合学习而不是日常使用，但是如果您有足够的ram，您也可以这样做。</p><p id="21bc" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们将使用以下pod和网络策略来测试其工作情况，我们将创建3个pod、1个客户端和2个应用后端，一个后端将在TCP/1111端口监听，另一个在TCP/2222端口监听，在我们的网络策略中，我们将只允许我们的客户端连接到app1:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="33f2" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">如果您想了解更多关于netcat和朋友的信息，请访问:<a class="ae mi" href="https://techsquad.rocks/blog/cat_and_friends_netcat_socat/" rel="noopener ugc nofollow" target="_blank"> Cat和朋友:netcat和socat </a></p><h1 id="08fe" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">迷你库贝</strong></h1><p id="6162" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">Minikube使用量很大，但有时可能会太大，无论如何，我们都会看到一个让它与网络策略一起工作的例子，好在它有很多文档，因为很多人都在使用它，而且它经常更新:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="bc6d" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">给它几分钟时间来启动，对于minikube的新版本，你可以这样安装它，否则你可以指定你将安装CNI插件，然后只安装清单。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="33da" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">请注意，我们添加了等待5秒的超时命令，因此我们不必真正等待nc超时，因为默认情况下没有超时，我们还测试了nc超时。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="ff6b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">你可以在他们的<a class="ae mi" href="https://docs.cilium.io/en/v1.9/gettingstarted/minikube/" rel="noopener ugc nofollow" target="_blank">文档</a>上获得更多关于minikube使用纤毛的信息</p><p id="edc5" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">记得打扫干净</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="4c0c" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">善良</strong></h1><p id="edd0" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">kind非常轻量级和快速，我通常使用KIND进行测试和开发，主要原因是几乎所有东西都像在真实集群中一样工作，但它没有开销，安装简单，易于运行，首先我们需要设置这个配置，告诉KIND不要使用它的默认CNI。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="d139" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">然后，我们可以创建集群并安装calico(这里有一个小问题，您需要检查calico节点pod是否启动，如果没有杀死它们，它们应该会启动，一切将开始正常工作，这是由于在部署后添加了环境变量，以便它与KIND一起工作):</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="881a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">验证</strong></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="0176" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">再次测试</strong></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8994" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">你可以在这里查看种类<a class="ae mi" href="https://kind.sigs.k8s.io/docs/user/configuration/#networking" rel="noopener ugc nofollow" target="_blank">的更多配置选项</a></p><h1 id="944e" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak"> Kubeadm和流浪汉</strong></h1><p id="9c57" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这是一个有趣的场景，了解如何使用kubeadm配置集群非常重要，还可以练习添加/删除/升级节点、备份和恢复etcd等。如果你想测试这个，克隆这个repo: <a class="ae mi" href="https://github.com/kainlite/kubernetes-the-easy-way-with-vagrant-and-kubeadm" rel="noopener ugc nofollow" target="_blank"> Kubernetes和kubeadm使用了vacant</a></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="d783" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">接下来，让我们复制kubeconfig并部署我们的资源，然后进行测试(这个部署使用了weave)</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="6a14" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">测试它</strong>(等到pod处于就绪状态)有关更多信息，请参考repo中的自述文件和其中的脚本，应该很容易理解和复制:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c69e" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">清理</strong></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="2439" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">苦尽甘来的流浪者</strong></h1><p id="17c1" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这可能是最复杂的场景，它纯粹是教育性的，你基本上可以手动生成所有的证书，并自己配置一切(如果你感兴趣，请参见原始的repo以了解如何在gcloud中这样做的说明)，如果你想测试这个repo:<a class="ae mi" href="https://github.com/kainlite/kubernetes-the-easy-way-with-vagrant" rel="noopener ugc nofollow" target="_blank">kubernets使用流浪者</a>的艰难方式，但要有耐心，并准备好调试如果事情不顺利。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8864" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">验证</strong></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="cfab" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">安装清单并进行测试</strong></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="307b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">清理</strong></p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="a316" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">总结</strong></p><p id="b6ef" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">每种选择都有其使用案例，测试每一种，并选择最符合您需求的一种。</p><p id="68f7" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">友情提醒:</strong></p><p id="9b49" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">记得清理以恢复机器中的一些资源。</p><h1 id="bfca" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">正误表</h1><p id="8a4c" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如果您发现任何错误或有任何建议，请给我发消息，以便解决问题。</p><p id="06f6" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">此外，您可以在这里查看源代码和<a class="ae mi" href="https://github.com/kainlite/kainlite.github.io" rel="noopener ugc nofollow" target="_blank">生成代码</a>和<a class="ae mi" href="https://github.com/kainlite/blog" rel="noopener ugc nofollow" target="_blank">源代码</a>的变化</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="ecf0" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><em class="nb">原载于2020年11月27日</em><a class="ae mi" href="https://techsquad.rocks/blog/kubernetes_local_playground_alternatives/" rel="noopener ugc nofollow" target="_blank"><em class="nb">https://tech squad . rocks</em></a><em class="nb">。</em></p></div></div>    
</body>
</html>
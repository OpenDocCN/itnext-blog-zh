<html>
<head>
<title>Getting Started with NestJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NestJS入门</h1>
<blockquote>原文：<a href="https://itnext.io/getting-started-with-nestjs-307556e02c8d?source=collection_archive---------1-----------------------#2019-08-25">https://itnext.io/getting-started-with-nestjs-307556e02c8d?source=collection_archive---------1-----------------------#2019-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f3d6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何用TypeScript &amp; NestJS构建web服务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9bc90a0d9bbf4975d372db4e03230e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LsHTe083IpvKL5anH7b_NA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">NestJS标志—<a class="ae ky" href="https://nestjs.com" rel="noopener ugc nofollow" target="_blank">https://nestjs.com</a></figcaption></figure><h2 id="2ccc" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="ee88" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi mo translated">今天的开发人员在构建web服务和其他服务器端应用程序时有很多选择。Node已经成为一种流行的选择，然而许多程序员更喜欢比JavaScript更健壮的语言，尤其是那些来自现代OOP语言的语言，如C#、C++或Java(仅举几例)。虽然<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/server-side-typescript-with-node-c5cef1584684"> TypeScript非常适合Node </a>，但NestJS框架将它带到了一个全新的水平，为现代服务器端开发人员提供了最先进的工具，以使用组件、提供者、模块和其他有用的高级抽象来构建持久的高性能应用程序。</p><p id="2d78" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">在本文中，我们将研究用NestJS构建一个简单的API服务器的过程，以处理一个基本的应用程序场景:创建、存储和检索一个普通商店的产品列表。</p><p id="c575" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">如果你想要这个项目的源代码副本，<a class="ae ky" href="https://github.com/kenreilly/nest-js-example" rel="noopener ugc nofollow" target="_blank">点击这里</a>查看。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="599b" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">项目设置</strong></h2><p id="8bae" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">用Nest构建需要一个节点环境。如果你还没有的话，<a class="ae ky" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">去他们的网站</a>为你的操作系统下载一份。</p><p id="78b3" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">安装框架很简单:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="351c" class="kz la it nk b gy no np l nq nr"><strong class="nk iu">$</strong> <!-- -->npm i -g @nestjs/cli<!-- --> </span></pre><p id="4fe3" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">此项目是通过运行以下命令使用Nest CLI工具创建的:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="8999" class="kz la it nk b gy no np l nq nr"><strong class="nk iu">$</strong> nest new nest-js-example</span></pre><p id="2b2a" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">这个命令将使用所需的配置文件、文件夹结构和服务器样板文件创建一个全新的嵌套项目。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="b84a" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">应用程序入口点</h2><p id="39e0" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">配置和运行服务器的主文件是<strong class="lx iu"> src/main.ts: </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="52ea" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">该文件导入了用于创建应用程序的NestFactory类，以及主应用程序模块文件(我们稍后将对此进行研究)，然后通过实例化它并监听端口<em class="nu"> 3000 </em>来引导应用程序。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="68c4" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">应用模块</h2><p id="6f2b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">声明app组件的文件是<strong class="lx iu"> src/app.module.ts </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="884c" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">该文件用作导入其余应用程序组件并在模块中声明的位置，该模块被导入到我们之前检查的文件(main.ts)中。当被指示生成新组件时，<a class="ae ky" href="https://docs.nestjs.com/cli/usages" rel="noopener ugc nofollow" target="_blank">嵌套CLI工具</a>将根据需要自动更新该文件。这里，<em class="nu">项目</em>的控制器和服务被导入并添加到模块中。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="d230" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">项目控制器</h2><p id="95d0" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们要检查的下一个文件是<strong class="lx iu">src/items/items . controller . ts</strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="effc" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">该文件定义了用于创建项目和检索先前创建的项目列表的控制器。这里导入了几个关键组件:</p><ul class=""><li id="16d2" class="nv nw it lx b ly mx mb my li nx lm ny lq nz mn oa ob oc od bi translated"><strong class="lx iu">createitemdo</strong>:一个<a class="ae ky" href="https://docs.nestjs.com/controllers#request-payloads" rel="noopener ugc nofollow" target="_blank">数据传输对象</a>，定义项目数据如何通过网络发送(即它是JSON数据结构)</li><li id="2ce1" class="nv nw it lx b ly oe mb of li og lm oh lq oi mn oa ob oc od bi translated"><strong class="lx iu"> ItemsService </strong>:一个<a class="ae ky" href="https://docs.nestjs.com/providers" rel="noopener ugc nofollow" target="_blank">提供者</a>，负责处理或存储项目数据</li><li id="9b28" class="nv nw it lx b ly oe mb of li og lm oh lq oi mn oa ob oc od bi translated"><strong class="lx iu">项目</strong>:定义项目内部数据结构的接口</li></ul><p id="9cee" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">装饰器<code class="fe oj ok ol nk b">@Controller('items')</code>向框架表明这个类将服务于REST端点<code class="fe oj ok ol nk b">/items</code>，并且<strong class="lx iu"> ItemsController </strong>的构造器获取了<strong class="lx iu"> ItemsService </strong>的一个实例，它在内部使用该实例来服务于两个HTTP方法:</p><ul class=""><li id="8cf1" class="nv nw it lx b ly mx mb my li nx lm ny lq nz mn oa ob oc od bi translated"><code class="fe oj ok ol nk b">POST /items</code>(根据请求JSON创建新项目)</li><li id="c80d" class="nv nw it lx b ly oe mb of li og lm oh lq oi mn oa ob oc od bi translated"><code class="fe oj ok ol nk b">GET /items</code>(检索之前创建的项目列表)</li></ul><p id="0903" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">对这两个方法的请求由<em class="nu"> create </em>和<em class="nu"> findAll </em>方法处理，这两个方法通过<code class="fe oj ok ol nk b">@Post()</code>和<code class="fe oj ok ol nk b">@Get()</code>装饰器绑定到各自的HTTP方法。装饰器也可以以同样的方式支持额外的方法，比如<code class="fe oj ok ol nk b">@Put()</code>或<code class="fe oj ok ol nk b">@Delete()</code>等。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="a25d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">项目对象接口</h2><p id="127a" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">接下来是两个定义存储项接口的文件，一个用于内部使用，比如编译时类型检查(<strong class="lx iu"> Item </strong>)，另一个用于定义传入JSON的预期结构的外部接口(<strong class="lx iu">createitemdo</strong>):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="c7fd" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated"><strong class="lx iu">条目</strong>接口为一个典型的商店条目定义了三个属性:名称、描述和价格。这确保了应用程序设计中不会混淆项目是什么或它有什么属性。</p><p id="2a43" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated"><strong class="lx iu">createitemdo</strong>类反映了<strong class="lx iu">项</strong>中的属性，用<code class="fe oj ok ol nk b">@IsNotEmpty()</code>修饰每个属性，以确保REST API端点需要所有这些属性。</p><p id="98e0" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">这两个类的所有属性都是强类型的，这是TypeScript的主要优点之一(因此得名)。乍一看，这提高了上下文理解的水平，并且当与实时代码分析工具(例如VSCode 中的<a class="ae ky" href="https://code.visualstudio.com/docs/editor/intellisense" rel="noopener ugc nofollow" target="_blank"> IntelliSense)一起使用时，大大减少了开发时间。对于拥有数百甚至数千个不同的类和接口的大型项目来说尤其如此。对于我们这些缺乏无限容量的完美照相记忆的人(比如我自己)，这远比试图随意记住成千上万的具体细节要容易得多。</a></p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="ad5a" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">项目服务</h2><p id="5eda" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">最后是创建和检索项目的服务，<strong class="lx iu"> items.service.dart </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="c720" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated"><strong class="lx iu"> ItemsService </strong>类为Item对象定义了一个简单的数组，该数组基本上充当我们的示例项目的易失性内存数据存储。写入和读取该“数据存储”属性的两种方法是:</p><ul class=""><li id="6e6b" class="nv nw it lx b ly mx mb my li nx lm ny lq nz mn oa ob oc od bi translated">创建(将一个<strong class="lx iu">项目</strong>保存到列表中并返回其id)</li><li id="2745" class="nv nw it lx b ly oe mb of li og lm oh lq oi mn oa ob oc od bi translated">findAll(返回先前创建的<strong class="lx iu">项目</strong>对象的列表</li></ul></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="157e" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">测试它</h2><p id="e536" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">要启动服务器，使用标准的<code class="fe oj ok ol nk b">npm run start</code>命令。一旦启动并运行，就可以通过从CURL发出HTTP请求来测试应用程序:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="ae95" class="kz la it nk b gy no np l nq nr"><strong class="nk iu">$</strong> curl -X POST localhost:3000/items -d '{"name":"trinket", "description":"whatever", "price": 42.0}'</span></pre><p id="4272" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">运行这个命令将返回一个JSON响应，带有创建的项目的id<em class="nu">和</em>。要查看已经创建的项目列表:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="d67b" class="kz la it nk b gy no np l nq nr"><strong class="nk iu">$</strong> curl localhost:3000/items</span></pre><p id="d4b8" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">上面对/items的GET请求将返回当前存储在内存中的项目的JSON响应。输出应该类似于:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="9660" class="kz la it nk b gy no np l nq nr">[{"{\"name\":\"trinket\", \"description\":\"whatever\", \"price\": 42.0}":""}]</span></pre></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="e33b" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="eba3" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">相对而言，NestJS是服务器端开发游戏的新成员，它具有一系列用于快速构建和部署企业级服务的特性，这些服务支持现代应用程序客户端的需求，并遵循诸如<a class="ae ky" href="https://en.wikipedia.org/wiki/SOLID" rel="noopener ugc nofollow" target="_blank"> SOLID </a>和<a class="ae ky" href="https://12factor.net" rel="noopener ugc nofollow" target="_blank">十二因素应用程序方法论</a>等原则。</p><p id="2142" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">欲了解更多信息，请点击查看NestJS网站。</p><p id="829c" class="pw-post-body-paragraph lv lw it lx b ly mx ju ma mb my jx md li mz mf mg lm na mi mj lq nb ml mm mn im bi translated">谢谢你看我的文章。编码快乐！</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><blockquote class="om"><p id="22e4" class="on oo it bd op oq or os ot ou ov mn dk translated">肯尼斯·雷利(<a class="ae ky" href="https://twitter.com/8_bit_hacker" rel="noopener ugc nofollow" target="_blank"> 8_bit_hacker </a>)是<a class="ae ky" href="https://lvl-up.tech/" rel="noopener ugc nofollow" target="_blank"> LevelUP </a>的CTO</p></blockquote></div></div>    
</body>
</html>
<html>
<head>
<title>A Cleaner Startup for .NET 6’s Minimal Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个更干净的开始。NET 6的最小方法</h1>
<blockquote>原文：<a href="https://itnext.io/a-cleaner-startup-for-net-6s-minimal-approach-c1c05a672c6a?source=collection_archive---------1-----------------------#2022-06-29">https://itnext.io/a-cleaner-startup-for-net-6s-minimal-approach-c1c05a672c6a?source=collection_archive---------1-----------------------#2022-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="291c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">中更简洁的应用程序启动和配置方法。在微软杀死并保留了旧的启动文件之后。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f6e0a3188777249327438702a129b93a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4hzixLkZjUMN-TAZ"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">克里斯蒂安·保罗·斯托比在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="36c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看完<a class="ae kv" href="https://docs.microsoft.com/en-us/aspnet/core/migration/50-to-60?view=aspnetcore-6.0&amp;tabs=visual-studio" rel="noopener ugc nofollow" target="_blank">。在过去的一周里，我制定了一个微软推荐方法的替代方案。老实说，我去年创造了这种方法，最近又对它进行了改进，使它可以与他人分享。</a></p><p id="34e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">起点是找到一些关于在新版本中使用<code class="fe ls lt lu lv b">Startup.cs</code>文件的帖子。NET 6最小主机模型。我知道不止我一个人觉得微软的格式比什么都讨厌。由于微软取消了默认的<code class="fe ls lt lu lv b">Startup.cs</code>文件，这让我认为他们认为Program.cs会是一个又大又长的烂摊子。在阅读帖子和微软的文档时，我意识到他们有一个建议的实现。问题是我认为实现有点混乱。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="6476" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">微软的解决方案</h1><p id="e394" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">当我通读他们的文档时，我发现…</p><blockquote class="na nb nc"><p id="a2b3" class="kw kx nd ky b kz la jr lb lc ld ju le ne lg lh li nf lk ll lm ng lo lp lq lr ij bi translated"><em class="iq">迁移到6.0的应用不需要使用新的最小托管模型。</em></p></blockquote><p id="0a32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个惊喜，因为我以为他们已经杀死了<code class="fe ls lt lu lv b">Startup.cs</code>文件，这是一个问题，因为我发现这侵蚀了他们的最小模型。这种方法导致在<code class="fe ls lt lu lv b">Program.cs</code>中插入一些额外的行来处理所有的服务和中间件配置。它创建了一个新格式的<code class="fe ls lt lu lv b">Startup.cs</code>文件，由两个方法和一组注入的配置组成，很容易就完成了工作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">微软记录的应用程序启动方法。网络6</figcaption></figure><p id="aa2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结合以下Startup.cs类</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">微软记录的应用程序启动方法。网络6</figcaption></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="c02d" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">可选择的解决方案</h1><p id="5730" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">上面的代码工作得很好，它可能看起来有点笨拙，但它确实工作。我提出的另一种方法只是扩展方法的简单使用。没有什么改变世界，但我发现它是一个更精简和干净的外观。扩展方法传入了<code class="fe ls lt lu lv b">WebApplicationBuilder</code>和<code class="fe ls lt lu lv b">WebApplication</code>对象。<code class="fe ls lt lu lv b">WebApplication</code>可以访问<code class="fe ls lt lu lv b">Environment</code>配置，双方也可以访问<code class="fe ls lt lu lv b">IConfiguraiton</code>。这保持了旧<code class="fe ls lt lu lv b">Startup.cs</code>的精神，就像微软的方法一样，但我发现它也保持了<code class="fe ls lt lu lv b">Program.cs</code>的干净和清晰。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">中应用程序启动的替代方法。网络6</figcaption></figure><p id="9878" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结合下面的<code class="fe ls lt lu lv b">ProgramExtentions.cs</code>类。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">中应用程序启动的替代方法。网络6</figcaption></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="ad04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法不会改变你的生活，但我发现了它的价值。可能有点迂腐，但是我喜欢这些扩展方法提供的简单性。如果它们的大小很大，可以针对每种方法将它们分成单独的文件。如果任何配置变得更大更重要，就有可能产生<code class="fe ls lt lu lv b">ConfigureApplication</code>和<code class="fe ls lt lu lv b">ConfigureExceptionHandling</code>方法。这种模式的可能性是无限的。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt nj lv nk nl aw nm bi"><span id="be69" class="nn me iq lv b gy no np l nq nr"><strong class="lv ir">Connect or Support?</strong></span><span id="4111" class="nn me iq lv b gy ns np l nq nr">If you like this, or want to checkout my other work, please connect with me on <a class="ae kv" href="https://www.linkedin.com/in/stphnwlsh" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae kv" href="https://twitter.com/stphnwlsh" rel="noopener ugc nofollow" target="_blank">Twitter</a> or <a class="ae kv" href="https://github.com/stphnwlsh" rel="noopener ugc nofollow" target="_blank">GitHub</a>, and consider supporting me at <a class="ae kv" href="https://www.buymeacoffee.com/stphnwlsh" rel="noopener ugc nofollow" target="_blank">Buy Me a Coffee</a>.</span></pre></div></div>    
</body>
</html>
<html>
<head>
<title>Dynamic component creation in Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue.js中的动态组件创建</h1>
<blockquote>原文：<a href="https://itnext.io/dynamic-component-creation-in-vue-js-b002bb41aaf4?source=collection_archive---------0-----------------------#2018-05-16">https://itnext.io/dynamic-component-creation-in-vue-js-b002bb41aaf4?source=collection_archive---------0-----------------------#2018-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d7a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事情是这样的:</p><p id="e5ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，您正在创建一个包含重复字段列表的表单；</p><ol class=""><li id="03ad" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">电话号码、地址、标签、姓名等的列表。,</li><li id="1b0c" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">愿望列表、输入具有嵌入其中的搜索功能，</li><li id="8b7e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">可能是todo应用？实际上还在21世纪？</li></ol><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/db2bceb09a5003a5cff58e06f4de5e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kf37tRiP21JCskyNvoV6ww.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">也许是这样的？</figcaption></figure><p id="cca8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你是JavaScript开发人员，你会这么做；</p><ol class=""><li id="9d94" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">创建单行表单输入的模板，</li><li id="8737" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">在行尾放置一些“添加/删除”按钮或图标，</li><li id="1b4f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">使用jQuery clone命令并在行列表的末尾或开头附加/前置，</li><li id="a7a3" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">重置输入内容的新行并聚焦它们，这样用户可以捕捉到刚刚发生的事情。</li></ol></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="b85a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，如果你是用Vue.js开发的，你应该知道更多的东西。因为你现在有组件，观察器和其他一些令人兴奋的东西可以使用，一旦你做了，你可能会在其他地方再次使用。所以复制/粘贴片段，不再仅仅是复制/粘贴片段。是时候阻止你的雇主嘲笑自己是本月(或年度)复制/粘贴员工了？)</p><p id="cd1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先是创建一个可重用的组件。我将创建一个电话号码组件，稍后我将在应用程序的创建联系人页面中使用它。但重点是使用相同的电话号码组件也在编辑联系页面内，可能显示电话号码页面等。</p><p id="fc89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我使用的是<a class="ae lw" href="https://quasar.dev/introduction-to-quasar" rel="noopener ugc nofollow" target="_blank">类星体框架</a>，<em class="lx">，顺便说一下</em>很棒，我将使用它的一些其他组件。所以不要介意标签以小写字母Q加破折号开始，它们会按照破折号后面的意思工作(Q-Field是一个表单域，Q-Input是一个表单输入等等。)它们也有类星体的一些特殊属性，但都是不言自明的。您可以在几秒钟内用原生div/input标记替换它们。</p><p id="36cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们的伙伴PhoneNumberLine组件的模板；</p><pre class="la lb lc ld gt ly lz ma mb aw mc bi"><span id="a641" class="md me iq lz b gy mf mg l mh mi">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;div <strong class="lz ir">v-for="(line, index) in lines"</strong> <strong class="lz ir">:key="index" </strong>class="row"&gt;<br/>      &lt;div class="col-lg-6"&gt;<br/>        &lt;div class="row"&gt;<br/>          &lt;div class="col-2"&gt;<br/>            &lt;q-select<br/>              <strong class="lz ir">v-model="line.countryCode"</strong><br/>              label="Country Code"<br/>              :options="countryPhoneCodes"<br/>            /&gt;<br/>          &lt;/div&gt;<br/>          &lt;div class="col-10"&gt;<br/>            &lt;q-input<br/>              <strong class="lz ir">v-model="line.number"</strong><br/>              label="Phone Number"<br/>              type="tel"<br/>              placeholder="5551234567"<br/>              value=""<br/>            /&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/><br/>      &lt;div class="col-lg-4"&gt;<br/>        &lt;q-select<br/>          <strong class="lz ir">v-model="line.phoneUsageType"</strong><br/>          label="Type of Usage"<br/>          :options="phoneUsageTypes"<br/>        /&gt;<br/>      &lt;/div&gt;<br/><br/>      &lt;div class="col-lg-2"&gt;<br/>        &lt;div class="block float-right"&gt;<br/>          &lt;q-btn round <strong class="lz ir">@click="removeLine(index)"</strong> icon="delete" /&gt;<br/>          &lt;q-btn round v-if="index + 1 === lines.length" <strong class="lz ir">@click="addLine"</strong> icon="playlist-plus"/&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi mj"><img src="../Images/ee2a1d82754dcbe08c706f94518b5839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRMAljxc8U3JoXaEjGAMqw.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">组件的基本视图</figcaption></figure><p id="7d6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经强调了代码的重要部分。从上到下更好的解释那些；</p><ol class=""><li id="d6e3" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">我们在组件的数据部分有一个<em class="lx">数组</em>(名为<strong class="jp ir">行</strong>)，它在<a class="ae lw" href="https://vuejs.org/v2/guide/list.html#Mapping-an-Array-to-Elements-with-v-for" rel="noopener ugc nofollow" target="_blank"> v-for指令</a>中使用，</li><li id="e7fa" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">应该有<a class="ae lw" href="https://vuejs.org/v2/guide/list.html#key" rel="noopener ugc nofollow" target="_blank">键绑定</a>，这样Vue.js就可以跟踪要创建的列表的元素，这就是我们的<strong class="jp ir">索引</strong>，</li><li id="9461" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">输入将使用<a class="ae lw" href="https://vuejs.org/v2/guide/forms.html" rel="noopener ugc nofollow" target="_blank"> v-model指令</a>将其值绑定到<strong class="jp ir">行</strong>数组内的<strong class="jp ir">行</strong>和<em class="lx">对象</em>中。也就是说<strong class="jp ir">行</strong> <em class="lx">对象</em>本身应该包含<strong class="jp ir">国家代码</strong>，<strong class="jp ir">编号</strong>，以及<strong class="jp ir"> phoneUsageType </strong> <em class="lx">键</em>。</li><li id="c94e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">最后是删除和添加新行的按钮。删除按钮的<strong class="jp ir"> removeLine </strong> <em class="lx">方法</em>以<strong class="jp ir"> index </strong>为属性，另一个按钮的<strong class="jp ir"> addLine </strong> <em class="lx">方法</em>已经绑定到它们的<a class="ae lw" href="https://vuejs.org/v2/guide/events.html#Listening-to-Events" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> click </strong> </a> <em class="lx">事件。</em></li></ol><p id="68e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们准备创建组件的其余部分；</p><pre class="la lb lc ld gt ly lz ma mb aw mc bi"><span id="39cc" class="md me iq lz b gy mf mg l mh mi">&lt;script&gt;<br/><strong class="lz ir">export default </strong>{<br/>  name: 'PhoneNumberLine',<br/>  data () {<br/>    <strong class="lz ir">return </strong>{<br/>      lines: [],<br/>      blockRemoval: <strong class="lz ir">true,</strong><br/>      phoneUsageTypes: [<br/>        {<br/>          label: 'Home', value: 'home'<br/>        }, {<br/>          label: 'Work', value: 'work'<br/>        }, {<br/>          label: 'Mobile', value: 'mobile'<br/>        }, {<br/>          label: 'Fax', value: 'fax'<br/>        }<br/>      ],<br/>      countryPhoneCodes: [<br/>        {<br/>          label: '+90',<br/>          value: '+90'<br/>        }, {<br/>          label: '+1',<br/>          value: '+1'<br/>        }<br/>      ]<strong class="lz ir"><br/>    </strong>}<br/>  },<br/>  watch: {<br/>    lines () {<br/>      <strong class="lz ir">this</strong>.blockRemoval = <strong class="lz ir">this</strong>.lines.length &lt;= 1<br/>    }<br/>  },<br/>  methods: {<br/>    addLine () {<br/>      <strong class="lz ir">let </strong>checkEmptyLines = <strong class="lz ir">this</strong>.lines.filter(line =&gt; line.number === <strong class="lz ir">null</strong>)<br/><br/>      <strong class="lz ir">if </strong>(checkEmptyLines.length &gt;= 1 &amp;&amp; <strong class="lz ir">this</strong>.lines.length &gt; 0) {<br/>         <strong class="lz ir">return<br/></strong>      } <strong class="lz ir"><br/><br/>      this</strong>.lines.push({<br/>        countryCode: <strong class="lz ir">null</strong>,<br/>        number: <strong class="lz ir">null</strong>,<br/>        phoneUsageType: <strong class="lz ir">null<br/>      </strong>})<br/>    },<br/><br/>    removeLine (lineId) {<br/>      <strong class="lz ir">if </strong>(!<strong class="lz ir">this</strong>.blockRemoval) {<br/>         <strong class="lz ir">this</strong>.lines.splice(lineId, 1)<br/>      }<br/>    }<br/>  },<br/>  mounted () {<br/>    <strong class="lz ir">this</strong>.addLine()<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="bbff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上，<strong class="jp ir">行</strong>阵<em class="lx">阵</em>你已经了解了一点。但是另一段代码有；</p><ol class=""><li id="869d" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated"><strong class="jp ir"> blockRemoval </strong> <em class="lx">数据<em class="lx">对象</em>的键</em>仅仅是在<strong class="jp ir">行</strong> <em class="lx">数组</em> <strong class="jp ir">表</strong> <em class="lx">方法</em>内设置为<strong class="jp ir">真</strong>时阻止我们最后一行输入的移除。</li><li id="5490" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir"> phoneUsageTypes </strong>和<strong class="jp ir"> countryPhoneCodes </strong>键只是选择输入的数据提供者。</li><li id="36ac" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">在<strong class="jp ir">行</strong>行<em class="lx">观察器</em>中，Vue跟踪<strong class="jp ir">行</strong>行<em class="lx">阵列</em>的长度并切换<strong class="jp ir">块移除</strong>。</li><li id="f11f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir"> addLine </strong> <em class="lx">方法</em>，当被相关按钮触发时，首先检查有多少电话号码字段是空的，然后检查我们总共有多少行，如果已经有空的电话号码字段和零行以上，它会阻止新行的创建。这样做是因为当组件被渲染时，<strong class="jp ir"> lines </strong> <em class="lx"> array </em>为空，在v-for指令中不应该有任何行被渲染。但是由于这个方法同时检查空字段和总行长度，所以它允许在安装组件时创建第一个空行。</li><li id="4b1d" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir"> addLine </strong> <em class="lx">方法</em>最终将一个空对象推送到<strong class="jp ir"> lines </strong> <em class="lx">数组</em>中，由于我们的reactive v-for指令，应该会自动创建新的输入行。</li><li id="40f2" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir"> removeLine </strong> <em class="lx">方法</em>检查<strong class="jp ir"> blockRemoval </strong> <em class="lx">键</em>并从<strong class="jp ir"> lines </strong> <em class="lx">数组</em>中删除相关项。v-for指令完成剩下的工作，并从表单中删除一行输入。</li><li id="41c8" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">还有我们的<strong class="jp ir">挂载的</strong> <em class="lx">函数</em>调用<strong class="jp ir"> addLine </strong> <em class="lx">方法</em>一次，创建我们的第一个空行。</li></ol><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi mk"><img src="../Images/7ef4dd20a17abe2dff8ab45abcbf4e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QTyIP-JHXzzshDWmpGgyXw.gif"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">添加新行</figcaption></figure></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="3b53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">给你。最终版本有；</p><ol class=""><li id="9def" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">防止最后一行被删除，</li><li id="1921" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">如果已经有一个空行，则阻止添加新行，</li><li id="ccb1" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">保持输入数据的持久记录。</li></ol><p id="3f65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是本教程的完成代码:</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="ml mm l"/></div></figure></div></div>    
</body>
</html>
<html>
<head>
<title>Production Server setup — Vultr Tutorial [Part 2]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生产服务器设置— Vultr教程[第2部分]</h1>
<blockquote>原文：<a href="https://itnext.io/production-server-setup-part-2-vultr-tutorial-87a6e19f9a2f?source=collection_archive---------8-----------------------#2020-01-12">https://itnext.io/production-server-setup-part-2-vultr-tutorial-87a6e19f9a2f?source=collection_archive---------8-----------------------#2020-01-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="a4b7" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">第2部分—服务器设置:</h1><p id="cc92" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在我们之前的主题中，我们部署了自己的VPS，并且能够作为<code class="fe lj lk ll lm b">root</code>用户通过ssh访问它。现在我们需要创建一个部署用户。我们将使用这个<em class="ln">部署用户</em>而不是<code class="fe lj lk ll lm b">root</code>来部署我们的应用程序。</p><p id="e859" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated">创建一个部署用户——让我们将这个新用户命名为<code class="fe lj lk ll lm b">deploy</code>。我不确定这是否是部署的标准名称，但它很容易记住，所以我们就用它吧！</p><p id="e0bb" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated">第一次SSH到您的服务器:</p><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="8d99" class="mb jo iq lm b gy mc md l me mf">ssh root@IP-ADDRESS-OF-SERVER</span></pre><p id="cd6c" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated">运行命令以添加部署用户:</p><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="42ed" class="mb jo iq lm b gy mc md l me mf">$ sudo adduser deploy # any secure password, keep somewhere safe!</span></pre><p id="1bf0" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated"><strong class="kn ir">添加部署到sudoers : </strong></p><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="f744" class="mb jo iq lm b gy mc md l me mf">$ sudo visudo</span><span id="a5a8" class="mb jo iq lm b gy mg md l me mf"># an editor will open find a line says<br/>root ALL=(ALL:ALL) ALL</span><span id="dad8" class="mb jo iq lm b gy mg md l me mf"># add one with your username below that<br/>deploy ALL=(ALL:ALL) ALL</span><span id="fb6c" class="mb jo iq lm b gy mg md l me mf">#Type ctrl+x Type Y to the prompt</span></pre><figure class="lt lu lv lw gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mh"><img src="../Images/0ae8597c3fa3a58f593e7e4c34adc3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-K6ywT209tYwH08SpRhyA.png"/></div></div></figure><p id="c98b" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated"><strong class="kn ir">退出&amp;作为部署用户重新连接到远程:</strong></p><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="849c" class="mb jo iq lm b gy mc md l me mf">ssh deploy@xxxx.xxx.xxxx.xxxx</span></pre><blockquote class="mp mq mr"><p id="66b5" class="kl km ln kn b ko lo kq kr ks lp ku kv ms lq ky kz mt lr lc ld mu ls lg lh li ij bi translated">注意这次我们做了<code class="fe lj lk ll lm b">ssh deploy@xxx</code>而不是<code class="fe lj lk ll lm b">ssh root@xxx</code></p></blockquote><p id="af52" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated"><strong class="kn ir">安装用于部署的初始包，</strong>这里我们使用Nginx作为web服务器</p><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="aa3a" class="mb jo iq lm b gy mc md l me mf">$ sudo apt-get install curl git-core nginx -y</span></pre><h2 id="1abc" class="mb jo iq bd jp mv mw dn jt mx my dp jx kw mz na kb la nb nc kf le nd ne kj nf bi translated"><strong class="ak">添加交换空间</strong></h2><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="06aa" class="mb jo iq lm b gy mc md l me mf"># Add twice of our server ram<br/>$ <!-- -->sudo fallocate -l 2G /swapfile</span><span id="9654" class="mb jo iq lm b gy mg md l me mf"># Lockdown swap space<br/>$ sudo chmod 600 /swapfile</span><span id="8d7f" class="mb jo iq lm b gy mg md l me mf"># Setup swapspace<br/>$ sudo mkswap /swapfile</span><span id="13ce" class="mb jo iq lm b gy mg md l me mf"># Enable swapspace<br/>$ sudo swapon /swapfile</span><span id="770f" class="mb jo iq lm b gy mg md l me mf"># verify swapspace, should show /swapfile<br/>$ <!-- -->sudo swapon -s</span></pre><figure class="lt lu lv lw gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi ng"><img src="../Images/9e77d5941b79ffaa5704e111bcfdff45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PnqOyK5GDcGaavXKbPC_bA.png"/></div></div></figure><h2 id="5112" class="mb jo iq bd jp mv mw dn jt mx my dp jx kw mz na kb la nb nc kf le nd ne kj nf bi translated">生成不带密码的SSH密钥，将其pub密钥复制到您的git存储库中:</h2><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="3fa2" class="mb jo iq lm b gy mc md l me mf"><br/># on your server<br/>$ ssh-keygen -t rsa<br/><br/># Copy pub key<br/>$ cat ~/.ssh/id_rsa.pub</span><span id="8698" class="mb jo iq lm b gy mg md l me mf"># Add pub key to Github repo <a class="ae nh" href="https://github.com/moseslucas/ocsc-ima/settings/keys" rel="noopener ugc nofollow" target="_blank">https://github.com/username/app-name/settings/keys</a></span><span id="ad87" class="mb jo iq lm b gy mg md l me mf"># Test Github access<br/>$ ssh -T git@github.com</span></pre><h2 id="ab3e" class="mb jo iq bd jp mv mw dn jt mx my dp jx kw mz na kb la nb nc kf le nd ne kj nf bi translated">添加授权密钥:</h2><pre class="lt lu lv lw gt lx lm ly lz aw ma bi"><span id="7209" class="mb jo iq lm b gy mc md l me mf"># on your server<br/>$ touch ~/.ssh/authorized_keys<br/>$ chmod 600 ~/.ssh/authorized_keys<br/><br/># on your local machine<br/>$ cat ~/.ssh/id_rsa.pub | ssh deploy@xxx.xxx.xxx.xxx 'cat &gt;&gt; .ssh/authorized_keys'</span></pre><p id="4f44" class="pw-post-body-paragraph kl km iq kn b ko lo kq kr ks lp ku kv kw lq ky kz la lr lc ld le ls lg lh li ij bi translated">就这样，我们的VPS准备好了！该服务器现在已准备好在上部署。</p></div></div>    
</body>
</html>
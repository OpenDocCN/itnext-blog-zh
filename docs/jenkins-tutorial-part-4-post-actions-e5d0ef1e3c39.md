# Jenkins 教程—第 4 部分—发布操作

> 原文：<https://itnext.io/jenkins-tutorial-part-4-post-actions-e5d0ef1e3c39?source=collection_archive---------1----------------------->

![](img/c518273176f996c36d381a98cf53ea9a.png)

在 Jenkins 教程的这一部分，我将解释 **Jenkins Post 操作**，并向您展示如何为您的管道编写 Post 操作。如果你没看过以前的文章，先看看吧。所以让我们开始派对吧。

[Jenkins 教程—第 1 部分—管道](/jenkins-tutorial-part-1-pipelines-bd1397cf5509)

[Jenkins 教程—第 2 部分—管道变量](/jenkins-tutorial-part-2-pipeline-variables-5e4783aa2c07)

[Jenkins 教程—第 3 部分—参数化管道](/jenkins-tutorial-part-3-parameterized-pipeline-3898643ac6ad)

# 什么是 Jenkins Pipeline Post 操作？

Post 操作就像其他正常阶段一样，只是在特定条件下运行。Jenkins 支持 10 个特殊动作条件，当这些条件满足时，这些条件就会运行。它们与运行状态相关，可在`post`块中为整个管道和每个阶段定义。

**总是**顾名思义总是运行。此发布操作不绑定到任何特定的构建/运行状态。像发送通知和保存日志这样的操作可以在这个块中完成。

**变更**仅在当前构建的状态与前一个**不同**时运行。发送通知和运行另一个管道来调查管道之类的操作可以在这个块中完成。

**修复了**在当前构建状态为**成功**且之前的构建失败或不稳定时运行。像发送通知或触发另一个管道这样的操作可以在这个块中完成。

**回归**在当前构建状态为失败、中止或不稳定的情况下运行，上一次运行**为** **成功**。像回滚这样的操作，例如在 CD 管道中，可以在这个 post 块中完成。

**不稳定**当前状态标记为不稳定时运行。例如，当测试失败，或者应用程序代码覆盖率低于期望的百分比时。像尝试其他测试和运行 lazy canary 环境这样的一些操作可以在这个块中完成。

**中止**在构建过程中止时运行，通常是手动中止。例如，在中止管道之前发生的所有事情都应该用这个 post 操作恢复。

**失败**在当前构建状态为失败时运行。像发送警报、回滚 CD 管道、删除中间工件等一些操作应该在这个块中完成。

**成功**在构建的当前状态为成功时运行。像保存工件、上传工件和触发 CD 管道这样的操作必须通过这个 post 操作来完成。

**不成功**当构建状态不是成功时运行。这种情况是失败、中止和不稳定状态的混合。你可以在这个街区做相关的事情。

**清除**总是在评估完所有其他条件后运行。所有清理过程，比如删除中间工件、日志、临时文件等等，都应该用这个动作来完成。

# 完整的 Jenkins Post 操作示例:

我应该提醒您，这些条件/块可以针对整个管道和每个阶段进行定义。在运行所有阶段后，评估在`stages`程序块之后定义的`post`程序块，并且在运行该阶段后，评估在`steps`程序块之后每个阶段定义的`post`程序块。在哪里定义这些条件或需要定义哪个条件取决于您的管道需求和管道的目标。在许多真实世界的管道中，您需要定义管道和每个阶段的各种条件。祝你一切顺利。

关注我的领英[https://www.linkedin.com/in/ssbostan](https://www.linkedin.com/in/ssbostan)
<html>
<head>
<title>SwiftUI: Limit the amount of characters in a TextField view</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI:限制TextField视图中的字符数量</h1>
<blockquote>原文：<a href="https://itnext.io/swiftui-limit-the-amount-of-characters-in-a-textfield-view-906e819529a5?source=collection_archive---------1-----------------------#2021-04-07">https://itnext.io/swiftui-limit-the-amount-of-characters-in-a-textfield-view-906e819529a5?source=collection_archive---------1-----------------------#2021-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7faf7f6b120a5409c86323968c3f6889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WSfpA1PgCBcXz6yw"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@patrickian4?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">帕特里克·福尔</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><blockquote class="kd ke kf"><p id="0048" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ir"> ⚠️更新:</strong> <strong class="kj ir">这个例子只适用于iOS 15之前的iOS版本。自从iOS 15和XCode 13发布后，这个例子就不再起作用了。</strong></p></blockquote><p id="b650" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">有时，您需要限制用户可以在应用程序的输入字段中输入的字符数量，例如在输入邮政编码时。</p><p id="6a1f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在UIKit中，您可能熟悉<a class="ae kc" href="https://developer.apple.com/documentation/uikit/uitextfielddelegate/1619599-textfield" rel="noopener ugc nofollow" target="_blank"> <em class="ki">文本字段(_:shouldchangecharacters in:replacementString:)</em></a><em class="ki"/>方法来限制UIKit文本字段的字符。</p><p id="2871" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">SwiftUI中的TextField似乎缺乏这种功能，因为它没有为我们提供完成这种任务的回调或方法，但仍然有一种方法可以解决这一问题——你只需要改变思维方式。</p></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><h2 id="1a80" class="lp lq iq bd lr ls lt dn lu lv lw dp lx lf ly lz ma lg mb mc md lh me mf mg mh bi translated">问题是</h2><p id="b550" class="pw-post-body-paragraph kg kh iq kj b kk mi km kn ko mj kq kr lf mk ku kv lg ml ky kz lh mm lc ld le ij bi translated">如果你试图限制用户可以输入的字符数量，你会很孤独。即使您截断了TextView本身的绑定值，它也会忽略这个值，因此用户仍然可以在输入中输入字符。</p><p id="70c4" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">类似以下示例的内容将不起作用，因为它只会截断结果字符串，而不会截断文本字段本身的值:</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="771f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">运行这段代码只会产生类似这样的结果:</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/ae0c3854ba32b192737914c840dac183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*ZVLvUMCbhIr3zQNVhLIrow.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">非工作示例结果</figcaption></figure><p id="a0cc" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">改变<em class="ki"> zipCode </em>变量本身也不起作用。这将导致更糟糕的状态，因为它既不会限制字符串，也不会限制文本视图的值。</p></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><h2 id="98e7" class="lp lq iq bd lr ls lt dn lu lv lw dp lx lf ly lz ma lg mb mc md lh me mf mg mh bi translated">解决方案——真理的单一来源</h2><p id="228c" class="pw-post-body-paragraph kg kh iq kj b kk mi km kn ko mj kq kr lf mk ku kv lg ml ky kz lh mm lc ld le ij bi translated">随着SwiftUI的推出，苹果给开发者带来了一种新的应用编程方法。开发人员现在不得不遵从MVVM模式，而不是通常的UIKit MVC模式，这需要一种新的思维方式。</p><p id="ff25" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">一个中心关键词是“真理之源”。有关该主题的更多信息，我推荐WWDC会议视频，请点击此处:</p><p id="24d4" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">🎬<a class="ae kc" href="https://developer.apple.com/videos/play/wwdc2020/10040/" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/videos/play/wwdc2020/10040/</a></p><p id="bcc8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这种<em class="ki">编写应用程序的新思路</em>是我们问题的解决方案。操纵绑定本身可能是不可能的，但是在视图模型的帮助下，我们可以实现我们想要的功能。</p><h2 id="58da" class="lp lq iq bd lr ls lt dn lu lv lw dp lx lf ly lz ma lg mb mc md lh me mf mg mh bi translated">视图模型</h2><p id="bd7d" class="pw-post-body-paragraph kg kh iq kj b kk mi km kn ko mj kq kr lf mk ku kv lg ml ky kz lh mm lc ld le ij bi translated">对于我们的例子，我们坚持输入邮政编码，为了简单起见，我们将只构建一个非常基本的模型。</p><p id="c733" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们的邮政编码模型可能如下所示:</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="6482" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">该模型由一个指定最大字符数的整数和一个保存邮政编码本身的字符串变量组成。在该字符串的属性观察者<em class="ki"> didSet </em>中，我们将该字符串截断到我们指定的长度。</p><p id="8eec" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这基本上是我们限制SwiftUI TextField视图中可能的字符数量所需要的所有魔法。</p><p id="68a7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在视图模型的帮助下，所有截断字符串的逻辑都被封装，并且与文本视图本身的绑定不冲突。</p></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><h2 id="d1a3" class="lp lq iq bd lr ls lt dn lu lv lw dp lx lf ly lz ma lg mb mc md lh me mf mg mh bi translated">完整示例</h2><p id="581c" class="pw-post-body-paragraph kg kh iq kj b kk mi km kn ko mj kq kr lf mk ku kv lg ml ky kz lh mm lc ld le ij bi translated">让我们看看如何在一个完整的示例中使用该模型:</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="dd6d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">代码应该非常简单——和往常一样。第一行是上面的模型，ContentView本身只定义了一个可观察的对象，带有一个模型实例和一个TextField视图。绑定被设置为模型的字符串值。</p><p id="7716" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">就是这样！剩下的只是化妆品。现在，用户只能输入指定数量的字符(在我们的例子中是五个)，在达到限制后，输入将不允许任何进一步的输入。</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to create a simple REST Client for testing your API.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建一个简单的REST客户端来测试您的API。</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-a-simple-rest-client-for-testing-your-api-a0554d8380f8?source=collection_archive---------0-----------------------#2020-03-07">https://itnext.io/how-to-create-a-simple-rest-client-for-testing-your-api-a0554d8380f8?source=collection_archive---------0-----------------------#2020-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5d3bab86faab7997a87fb871f224fb7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yZrUkrjWwIh_5877c_GpxQ.jpeg"/></div></div></figure><p id="c8a4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">在本文中，我将讨论如何快速创建一个使用REST API的Java客户端。我将向你展示两种快速有效地达到预期效果的方法。这两种方法都涉及到使用第三方库。</p><p id="7b12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是在开始创建REST客户机之前，您需要记住这个理论。</p><p id="3cbf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated"><span class="l kx ky kz bm la lb lc ld le di"> A </span> PI代表应用编程接口。它是软件到软件的界面，而不是用户界面。有了API，应用程序无需客户端学习或干预就可以相互交流。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/1becb83fa83cd87953e1dbf7ed1eea93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k89qLtcXSLcha5Z_1v79Cg.jpeg"/></div></div></figure><p id="a8f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated"><span class="l kx ky kz bm la lb lc ld le di">一个</span> PI测试利用编程向API发送调用并获得结果。它将测试中的段视为黑盒。API测试的主要目标是在将所有API(如果有的话)协调到应用程序之前，确认它们的正确执行和故障处理。</p><p id="c18e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">休息:具象状态转移。</strong></p><ul class=""><li id="2b73" class="lk ll iq ka b kb kc kf kg kj lm kn ln kr lo kv lp lq lr ls bi translated">它是测试人员执行请求和接收响应的功能安排。在REST中，API交互是通过HTTP协议进行的。</li><li id="9f43" class="lk ll iq ka b kb lt kf lu kj lv kn lw kr lx kv lp lq lr ls bi translated">REST还允许计算机通过网络相互通信。</li><li id="0d47" class="lk ll iq ka b kb lt kf lu kj lv kn lw kr lx kv lp lq lr ls bi translated">对于发送和接收消息，它涉及使用HTTP方法，并且不需要严格的消息定义，这与web服务不同。</li><li id="d889" class="lk ll iq ka b kb lt kf lu kj lv kn lw kr lx kv lp lq lr ls bi translated">REST消息通常接受XML或JavaScript对象符号(JSON)的形式。</li></ul><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/4df7ee09c4c8c20960602eb03e12ae08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*_qekYdnw0QKeZKwiN1SKwA.png"/></div></figure><ol class=""><li id="1443" class="lk ll iq ka b kb kc kf kg kj lm kn ln kr lo kv lz lq lr ls bi translated"><strong class="ka ir"> Apache HTTPClient。</strong></li></ol><p id="eed7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">Apache HttpComponents项目负责创建和维护一个专注于HTTP和相关协议的低级Java组件工具集。</p><p id="ce40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Apache HttpClient库极大地简化了HTTP请求的处理。为了使用这个库，您必须访问Apache网站。阅读官方文档。并为Maven或Gradle添加一个依赖项:</p><p id="4efe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Maven:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="277e" class="mf mg iq mb b gy mh mi l mj mk">&lt;dependency&gt;<br/>    &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;<br/>    &lt;artifactId&gt;httpclient&lt;/artifactId&gt;<br/>    &lt;version&gt;4.5.11&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="8696" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">格拉德:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="342b" class="mf mg iq mb b gy mh mi l mj mk">compile group: 'org.apache.httpcomponents', name: 'httpclient', version: '4.5.11'</span></pre><p id="97f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面我将给出一个GET请求的例子:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="bee3" class="mf mg iq mb b gy mh mi l mj mk"><strong class="mb ir">final </strong>HttpClient httpClient = <strong class="mb ir">new </strong>DefaultHttpClient();<br/><strong class="mb ir">final </strong>HttpGet httpGet = <strong class="mb ir">new </strong>HttpGet(<strong class="mb ir">"http://localhost:8080"</strong>);<br/>HttpResponse response = <strong class="mb ir">null</strong>;<br/><strong class="mb ir">try </strong>{<br/>    response = httpClient.execute(httpGet);<br/>} <strong class="mb ir">catch </strong>(IOException ex) {<br/>    <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>        <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>    }<br/>}<br/>BufferedReader reader = <strong class="mb ir">null</strong>;<br/><strong class="mb ir">try </strong>{<br/>    reader = <strong class="mb ir">new </strong>BufferedReader(<strong class="mb ir">new </strong>InputStreamReader(response.getEntity().getContent()));<br/>} <strong class="mb ir">catch </strong>(IOException ex) {<br/>    <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>        <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>    }<br/>}<br/>String line = <strong class="mb ir">""</strong>;<br/><strong class="mb ir">while </strong>(<strong class="mb ir">true</strong>) {<br/>    <strong class="mb ir">try </strong>{<br/>        <strong class="mb ir">if </strong>(!((line = reader.readLine()) != <strong class="mb ir">null</strong>)) <strong class="mb ir">break</strong>;<br/>    } <strong class="mb ir">catch </strong>(IOException ex) {<br/>        <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>            <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>        }<br/>    }<br/>    <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(line);<br/>}</span></pre><p id="1a35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面我将给出一个POST请求的例子:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="4bf5" class="mf mg iq mb b gy mh mi l mj mk"><strong class="mb ir">final </strong>HttpClient httpClient = <strong class="mb ir">new </strong>DefaultHttpClient();<br/><strong class="mb ir">final </strong>HttpPost httpPost = <strong class="mb ir">new </strong>HttpPost(<strong class="mb ir">"http://localhost:8080"</strong>);<br/>StringEntity input = <strong class="mb ir">null</strong>;<br/><strong class="mb ir">try </strong>{<br/>    input = <strong class="mb ir">new </strong>StringEntity(<strong class="mb ir">"id"</strong>);<br/>} <strong class="mb ir">catch </strong>(UnsupportedEncodingException ex) {<br/>    <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>        <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>    }<br/>}<br/>httpPost.setEntity(input);<br/>HttpResponse response = <strong class="mb ir">null</strong>;<br/><strong class="mb ir">try </strong>{<br/>    response = httpClient.execute(httpPost);<br/>} <strong class="mb ir">catch </strong>(IOException ex) {<br/>    <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>        <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>    }<br/>}<br/>BufferedReader reader = <strong class="mb ir">null</strong>;<br/><strong class="mb ir">try </strong>{<br/>    reader = <strong class="mb ir">new </strong>BufferedReader(<strong class="mb ir">new </strong>InputStreamReader(response.getEntity().getContent()));<br/>} <strong class="mb ir">catch </strong>(IOException ex) {<br/>    <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>        <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>    }<br/>}<br/>String line = <strong class="mb ir">""</strong>;<br/><strong class="mb ir">while </strong>(<strong class="mb ir">true</strong>) {<br/>    <strong class="mb ir">try </strong>{<br/>        <strong class="mb ir">if </strong>(!((line = reader.readLine()) != <strong class="mb ir">null</strong>)) <strong class="mb ir">break</strong>;<br/>    } <strong class="mb ir">catch </strong>(IOException ex) {<br/>        <strong class="mb ir">if </strong>(<strong class="mb ir"><em class="ml">LOGGER</em></strong>.isLoggable(Level.<strong class="mb ir"><em class="ml">INFO</em></strong>)) {<br/>            <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"The method is down." </strong>+ ex.getMessage());<br/>        }<br/>    }<br/>    <strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(line);<br/>}</span></pre><p id="f544" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.<strong class="ka ir">球衣</strong></p><p id="eff6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Jersey是一个提供JAX-RS (JSR-370)实现的REST框架。</p><p id="7c32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Jersey框架比JAX-RS参考实现更多。Jersey提供了自己的API，用额外的特性和实用程序扩展了JAX-RS工具包，以进一步简化RESTful服务和客户端开发。Jersey还公开了许多扩展SPI，以便开发人员可以扩展Jersey以最好地满足他们的需求。</p><p id="e5d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Maven:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="f9a0" class="mf mg iq mb b gy mh mi l mj mk">&lt;dependency&gt;<br/>    &lt;groupId&gt;com.sun.jersey&lt;/groupId&gt;<br/>    &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;<br/>    &lt;version&gt;1.19.4&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="a1ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">格拉德:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="7bc5" class="mf mg iq mb b gy mh mi l mj mk">compile group: 'com.sun.jersey', name: 'jersey-client', version: '1.19.4'</span></pre><p id="6b2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">GET请求的示例:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="da22" class="mf mg iq mb b gy mh mi l mj mk"><strong class="mb ir">final </strong>ClientConfig clientConfig = <strong class="mb ir">new </strong>DefaultClientConfig();<br/><strong class="mb ir">final </strong>Client client = Client.create(clientConfig);<br/><strong class="mb ir">final </strong>WebResource webResource = client.resource(UriBuilder.fromUri(<strong class="mb ir">"http://localhost:8080"</strong>).build());<br/><strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(webResource.path(<strong class="mb ir">"restPath"</strong>).path(<strong class="mb ir">"resourcePath"</strong>).accept(MediaType.<strong class="mb ir"><em class="ml">APPLICATION_JSON</em></strong>).get(String.<strong class="mb ir">class</strong>));<br/><strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(webResource.path(<strong class="mb ir">"restPath"</strong>).path(<strong class="mb ir">"resourcePath"</strong>).accept(MediaType.<strong class="mb ir"><em class="ml">APPLICATION_XML</em></strong>).get(String.<strong class="mb ir">class</strong>));</span></pre><p id="905e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发布请求的示例:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="c02a" class="mf mg iq mb b gy mh mi l mj mk"><strong class="mb ir">final </strong>ClientConfig clientConfig = <strong class="mb ir">new </strong>DefaultClientConfig();<br/><strong class="mb ir">final </strong>Client client = Client.create(clientConfig);<br/><strong class="mb ir">final </strong>WebResource webResource = client.resource(UriBuilder.fromUri(<strong class="mb ir">"http://localhost:8080"</strong>).build());<br/><strong class="mb ir">final </strong>MultivaluedMap multivaluedMap = <strong class="mb ir">new </strong>MultivaluedMapImpl();<br/>multivaluedMap.add(<strong class="mb ir">"name1"</strong>, <strong class="mb ir">"val1"</strong>);<br/><strong class="mb ir">final </strong>ClientResponse clientResponse = webResource.type(MediaType.APPLICATION_FORM_URLENCODED_TYPE).post(ClientResponse.<strong class="mb ir">class</strong>, multivaluedMap);<br/><strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"Response " </strong>+ clientResponse.getEntity(String.<strong class="mb ir">class</strong>));</span></pre><p id="083e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以使用您自己的POST类:</p><pre class="lg lh li lj gt ma mb mc md aw me bi"><span id="b1e2" class="mf mg iq mb b gy mh mi l mj mk"><strong class="mb ir">final </strong>ClientResponse clientResponse = webResource.path(<strong class="mb ir">"restPath"</strong>).path(<strong class="mb ir">"resourcePath"</strong>).<br/>        type(MediaType.<strong class="mb ir"><em class="ml">APPLICATION_JSON</em></strong>).accept(MediaType.<strong class="mb ir"><em class="ml">APPLICATION_JSON</em></strong>).post(ClientResponse.<strong class="mb ir">class</strong>, myPojo);<br/><strong class="mb ir"><em class="ml">LOGGER</em></strong>.info(<strong class="mb ir">"Response " </strong>+ clientResponse.getEntity(String.<strong class="mb ir">class</strong>));</span></pre><p id="b24f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">本文中介绍的其他库使得创建查询、从服务器获取响应、处理它们并输出结果变得非常容易。我个人更喜欢Apache Http客户端。因为它相当轻便，很受欢迎。</p></div></div>    
</body>
</html>
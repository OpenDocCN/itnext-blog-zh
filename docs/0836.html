<html>
<head>
<title>A Quick, Practical Use Case for ES6 Generators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ES6发电机的快速实用用例</h1>
<blockquote>原文：<a href="https://itnext.io/a-quick-practical-use-case-for-es6-generators-building-an-infinitely-repeating-array-49d74f555666?source=collection_archive---------1-----------------------#2018-06-06">https://itnext.io/a-quick-practical-use-case-for-es6-generators-building-an-infinitely-repeating-array-49d74f555666?source=collection_archive---------1-----------------------#2018-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c11" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建无限重复的数组</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/387dbd2a244ab0ee683daeb4ac6ecc8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x6jtKAwoKfKNMNjAEreiYg.png"/></div></div></figure><h1 id="6d74" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">前言</h1><p id="f51a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">您可能听说过ES6生成器，也许您甚至学习过语法，您可能想知道它们在现实生活中到底有什么用。</p><h2 id="6134" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">定义(从<a class="ae mr" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*" rel="noopener ugc nofollow" target="_blank"> MDN </a></h2><blockquote class="ms"><p id="5868" class="mt mu iq bd mv mw mx my mz na nb me dk translated"><em class="nc">发电机是可以退出并在以后重新进入的功能。它们的上下文(变量绑定)将在重入时被保存。</em></p></blockquote><p id="8907" class="pw-post-body-paragraph lj lk iq ll b lm nd jr lo lp ne ju lr ls nf lu lv lw ng ly lz ma nh mc md me ij bi translated">你可能会想，“<em class="ni">好吧，但是我为什么要这么做呢？</em>“事实证明，有从简单到复杂的一系列用例，其中许多都涉及到承诺异步请求(async/await构建在生成器之上)。我的目标是通过一个简单的、真实的例子，向您提供理解它们如何工作的第一步，以便您开始注意到什么时候生成器是您自己代码中问题的最合适的解决方案。开始了。</p><h1 id="29ab" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">用例</h1><p id="5fcc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我正在构建一个应用程序，我的用户可以计算3周的锻炼周期，并设置在周期内每周工作3至7天。每个个人健身程序都基于以下4个举重项目中的一个:<em class="ni">深蹲</em>、<em class="ni">卧推</em>、<em class="ni">硬举</em>和<em class="ni">头顶推举</em>，并且每个连续的健身程序都必须基于按此顺序的下一个举重项目:</p><ul class=""><li id="2315" class="nj nk iq ll b lm nl lp nm ls nn lw no ma np me nq nr ns nt bi translated">蹲着的</li><li id="1bc6" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">长凳，长椅</li><li id="18e4" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">硬拉</li><li id="d7a7" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">高架压力机</li><li id="a0c8" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">蹲着的</li><li id="23db" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">长凳，长椅</li><li id="b0eb" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">硬拉</li><li id="b8ec" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">高架压力机</li><li id="f87a" class="nj nk iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi">…</li></ul><p id="0b9b" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">你大概可以看到这是怎么回事。</p><p id="a844" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">我需要我的代码来说，“<em class="ni">给我下一次锻炼的电梯，然后下一次，然后下一次，等等。当到达列表的末尾时，从头开始，永远重复，直到我生成了3周周期的所有锻炼。</em>“这是我最初实现它的简化版本，<strong class="ll ir">没有</strong>生成器:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="83f2" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">不算太差，但可以更具宣示性。如果我们不必直接在我们的锻炼生成代码中跟踪那个<em class="ni">当前生活指数</em>不是很好吗？它降低了代码的可读性，感觉它属于自己的功能。下面是使用生成器函数的代码，我将在下面解释。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="1ccc" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">在这里，代码更具声明性和可读性。我们将索引跟踪逻辑抽象成一个通用的实用函数，称为<em class="ni"> repeatedArray </em>。<em class="ni"> function * </em>语法告诉JavaScript这是一个生成器函数。我们所要做的就是请求“重复数组”中的下一项，我们的生成器会将它交给我们。最好的部分是<strong class="ll ir">我们不必担心它是如何在我们的生成器函数之外发生的。</strong></p><p id="ebc6" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">事情是这样的:</p><p id="deb1" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">当我们在第9行调用repeatedArray函数本身(读取两次)时，<em class="ni"> repeatedArray </em>返回一个<strong class="ll ir">迭代器</strong>对象<em class="ni">。迭代器存储在名为<em class="ni"> nextLiftGenerator </em>的变量中。理解函数中的代码此时还没有被执行是很重要的。只有当我们在<em class="ni"> nextLiftGenerator </em>迭代器上调用<em class="ni"> next() </em>函数时，该函数才会被执行，并且直到它达到<em class="ni"> yield </em>时才会被执行。我们的生成器给我们这个值，然后等待直到下一个调用继续执行，直到它达到另一个<em class="ni"> yield </em>，然后返回这个值。有道理吗？就是这样！</em></p><p id="7b7c" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">这显然是一个非常简单的例子，但希望它能帮助您理解生成器是如何工作的，以及为什么生成器是JavaScript中如此强大的功能。</p><p id="8272" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">如果你喜欢这篇文章，请在<a class="ae mr" href="https://twitter.com/ReisnerShawn" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae mr" href="https://www.instagram.com/shawn.webdev/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注我，了解更多有趣的内容！</p><p id="6636" class="pw-post-body-paragraph lj lk iq ll b lm nl jr lo lp nm ju lr ls nz lu lv lw oa ly lz ma ob mc md me ij bi translated">编码快乐！</p></div></div>    
</body>
</html>
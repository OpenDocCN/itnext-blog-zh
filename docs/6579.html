<html>
<head>
<title>Modern C++ in Advent of Code: Day22</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代C++代码的出现:第22天</h1>
<blockquote>原文：<a href="https://itnext.io/modern-c-in-advent-of-code-day22-ff85b2540d9b?source=collection_archive---------3-----------------------#2021-12-22">https://itnext.io/modern-c-in-advent-of-code-day22-ff85b2540d9b?source=collection_archive---------3-----------------------#2021-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="fc9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是代码问世的第二十二天。今天，我们将交叉3D范围。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/928320515b7a6a9c5bf7473ed805cddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYCfRgYH3GR6hfnsNqVh0Q.png"/></div></div></figure><p id="00be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，请先尝试解决问题，然后再看解决方案。对于本系列的所有文章，<a class="ae kl" href="https://medium.com/@happy.cerberus/list/advent-of-code-2021-using-modern-c-c5814cb6666e" rel="noopener">请查看这个列表</a>。</p><h1 id="533d" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第22天</h1><p id="1335" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">今天，我们的任务是处理在3D范围内激活和去激活体素的开和关指令。我们的最终输出是处理完所有指令后活动体素的数量。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="50f7" class="mg kz iq mc b gy mh mi l mj mk">on x=-7..47,y=-1..44,z=-40..13<br/>off x=-47..-31,y=12..24,z=4..19</span></pre><p id="87f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当应用指令时，我们可以将重叠的长方体分割成更小的不重叠的长方体。然而，由于我们只对活动体素的总和感兴趣，我们可以简化这个问题。</p><p id="808c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们先来看看2D版本。有两条指令:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="bc9a" class="mg kz iq mc b gy mh mi l mj mk">on x=1..3,y=1..3<br/>on x=3..5,y=3..5</span></pre><p id="fa8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这会导致以下情况:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="d857" class="mg kz iq mc b gy mh mi l mj mk">XXX<br/>XXX<br/>XX@YY<br/>  YYY<br/>  YYY</span></pre><p id="9241" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们计算像素的数量(9+9)，我们将会过度计算交集，这可以通过生成一个新的指令来补偿。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="02a7" class="mg kz iq mc b gy mh mi l mj mk">on x=1..3,y=1..3<br/>on x=3..5,y=3..5<br/>off x=3..3,y=3..3</span></pre><p id="1e78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以对每个指令重复遵循这个逻辑。如果与列表中的现有指令有重叠，我们生成相应的补偿指令。</p><p id="eef3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加否定指令的工作方式有点不同。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="1b51" class="mg kz iq mc b gy mh mi l mj mk">on x=1..3,y=1..3<br/>off x=2..4,y=2..4</span></pre><p id="375b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果是:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="2617" class="mg kz iq mc b gy mh mi l mj mk">XXX<br/>X..<br/>X..</span></pre><p id="51af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们不想将否定指令添加到列表中，相反，我们只想保留交集。在这种情况下:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="606e" class="mg kz iq mc b gy mh mi l mj mk">on x=1..3,y=1..3<br/>off x=2..3,y=2..3</span></pre><p id="d0d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们总结结果:9–4 = 5。</p><h2 id="bf68" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">要点和说明</h2><p id="65dc" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我们可以重用以前的3D点类型。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="d9e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在此基础上构建表示指令类型:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="5626" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了解析规则，我们读取每一行，然后解析结果字符串:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="eb70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">交集(如果存在的话)仅仅是最小边界的最大值和最大边界的最小值。补偿规则总是与其适用的规则相反:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h2 id="6e54" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">计算体素</h2><p id="204a" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">为了确定体素的最终数量，我们需要处理所有的输入，在进行过程中生成补偿规则:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="d64d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于第一部分，我们需要将自己限制在一个更小的范围内(第6-11行)。之后，我们简单地将我们的规则与所有现有规则相交，生成补偿规则(第19行)。最后，我们简单地对所有生成的规则的所有体素进行计数，将负规则作为负值计数(第25行):</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="60c9" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">链接和技术说明</h1><p id="5280" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">每日解决方案存储库位于:【https://github.com/HappyCerberus/moderncpp-aoc-2021】T4。</p><p id="ae2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看此列表，了解《代码降临》其他日子的相关文章。</p><p id="0795" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请不要忘记亲自尝试<a class="ae kl" href="https://adventofcode.com/2021" rel="noopener ugc nofollow" target="_blank">降临码</a>。</p><h1 id="519f" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">感谢您的阅读</h1><p id="f5e2" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">感谢您阅读这篇文章。你喜欢吗？</p><p id="a222" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也在YouTube上发布视频。你有问题吗？在<a class="ae kl" href="https://twitter.com/SimonToth83" rel="noopener ugc nofollow" target="_blank">推特</a>或<a class="ae kl" href="https://www.linkedin.com/in/simontoth" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Fixing issues caused by future SDKs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">修复由未来SDK引起的问题</h1>
<blockquote>原文：<a href="https://itnext.io/fixing-issues-caused-by-future-sdks-ae0896384abf?source=collection_archive---------7-----------------------#2019-09-16">https://itnext.io/fixing-issues-caused-by-future-sdks-ae0896384abf?source=collection_archive---------7-----------------------#2019-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bbfe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如果您需要修复由比您正在使用的Xcode版本更新的iOS版本引起的问题，该怎么办？</h2></div><p id="518a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着iOS13即将发布，我们发现了一些关键问题，这些问题只能通过使用只能通过Xcode 11获得的新API来解决。然而，我们的项目使用Xcode 10——从Xcode 11构建会引入更多问题。当然，我们最终需要迁移到最新的IDE，但是现在我们需要一个低风险的解决方案。</p><h1 id="66d7" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">问题是</h1><p id="3734" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">我们有一只<code class="fe ly lz ma mb b">UINavigationBar</code>具有以下外观特征:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/27ac6e16180244430cdcd4041b528932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*zRxs9NsA_GRUp7zLzWzEGg.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">迅速发生的</figcaption></figure><p id="63b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种定制的组合在iOS12和更早的版本上可以完美地工作，但在iOS13上，该栏的背景显示为白色(当从Xcode 10和11构建时)。<strong class="kh ir">因此，在导航栏中看不到任何按钮或标题。</strong></p><p id="97f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须使用一些新的API来定制导航栏，参见文档diff:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/ae912312696f9b908782a7dac626656e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_8-aL9_2QpkEW2AphHMYA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae mt" href="https://developer.apple.com/documentation/uikit/uinavigationbar?changes=latest_major" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/documentation/ui kit/uinavigationbar？变更=最新_主要</a></figcaption></figure><h2 id="4d8e" class="mu lc iq bd ld mv mw dn lh mx my dp ll ko mz na ln ks nb nc lp kw nd ne lr nf bi translated">不想要的解决方案</h2><p id="e720" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">修复这个问题的代码可以放在一个<code class="fe ly lz ma mb b">if #available(iOS 13.0, *)</code>中，用Xcode 11编译:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ng"><img src="../Images/3de82b33c9fd0efa212e41436b462472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_iTT6OJfnBjuaF8-8DNNA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">迅速发生的</figcaption></figure><p id="7a20" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，由于我们被迫保留Xcode 10以降低风险，我们如何访问这些API呢？</p><h1 id="7824" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">教授Xcode未来的iOS版本</h1><p id="cd93" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">这是非常标准的，但我还是要简单地回顾一下。</p><p id="23e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过从Xcode 11拷贝相关支持文件，您可以允许Xcode 10构建到您连接的iOS13设备。为此，请访问<code class="fe ly lz ma mb b">Xcode11.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport</code>目录。里面有一个叫做<code class="fe ly lz ma mb b">13.0</code>的文件夹——你必须把它复制到你的<code class="fe ly lz ma mb b">Xcode10.app</code>里面的同一个目录下。</p><p id="28c2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你需要支持测试版，你可能需要复制旧Xcode中的文件夹，并将其命名为<code class="fe ly lz ma mb b">13.1 (17A5831c)</code></p><p id="efdf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然这很不方便，但它确实允许您直接从旧版本的Xcode构建到运行新操作系统的设备上。</p><h1 id="4d6c" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">目标-C是你的朋友</h1><p id="5f4c" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">随着Swift sky rocketing的流行，Objective-C不仅被遗忘，而且从未被教授过。有一些优秀的开发者在Swift推出后才开始做iOS！</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nh"><img src="../Images/b81cf953d70be60714d5f3252c1fca8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AB4k3MhBi3jXYzNl53CSAA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae mt" href="https://trends.google.com/trends/explore?hl=en-US&amp;tz=-600&amp;date=today+5-y&amp;q=%2Fm%2F010sd4y3,%2Fm%2F05q31&amp;sni=3" rel="noopener ugc nofollow" target="_blank">谷歌趋势</a></figcaption></figure><p id="12d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，它的权力目标-C挥舞，将有助于我们今天的追求。</p><p id="a18a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您知道吗，在Objective-C中，您可以在运行时动态实例化一个类，并向它发送消息。通过适当的检查来确保我们在iOS13下运行，我们可以使用<code class="fe ly lz ma mb b">NSClassFromString</code>来访问我们之前发现的新的<code class="fe ly lz ma mb b">UINavigationBarAppearance</code>，即使它只在未来的Xcode中可用！</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ni"><img src="../Images/0bee90092f59da679f669119c2c670a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZlX9-ABEgIqhZtEN0DgMw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">目标-C，但也是C</figcaption></figure><p id="b5c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们需要遵循上面的“不需要的解决方案”,并将其转化为Objective-C。为了在<code class="fe ly lz ma mb b">ios13Appearance</code>上设置属性，让我们定义一个函数来帮助我们:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nj"><img src="../Images/08054bb266df25f3153506c568117ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HeCSTS6Y2X58dsprBY_F1Q.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">C函数，但目标是C内容</figcaption></figure><p id="b666" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这需要一个对象<code class="fe ly lz ma mb b">target</code>，一个函数<code class="fe ly lz ma mb b">selectorString</code>和一个将成为函数<code class="fe ly lz ma mb b">selectorString</code>参数的对象。然后我们可以创建一个选择器，检查目标是否响应它——如果是，那么用参数运行它。</p><p id="87b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以使用setters设置所需的属性:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nk"><img src="../Images/669dad07ff678d1cd63245cb4bc502d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfht1BuDA5coq0c-bzehEw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">同时也是客观的</figcaption></figure><p id="f620" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不幸的是，我们不能将<code class="fe ly lz ma mb b">UIAppearance</code>与我们创建的<code class="fe ly lz ma mb b">UINavigationBarAppearance</code>实例一起使用。相反，我们需要在应用程序中创建的每个导航栏上运行这段代码:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nl"><img src="../Images/f88093ccc065171975091c50ccb1b2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JANOGRBDYNNaVSypfYUwA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">C</figcaption></figure><h1 id="dce0" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">抓住它的要点</h1><p id="819d" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">我已经将这个特殊的案例包装在一个名字可怕的类中，这个类将在您的代码中突出出来，需要被移除。当然，你可能会遇到其他问题，你可以用同样的方法解决，所以请记住:虽然Objective-C被认为是旧的和笨重的，但在某些情况下，它可以为你提供比Swift更多的功能！</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div></div>    
</body>
</html>
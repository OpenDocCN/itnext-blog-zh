<html>
<head>
<title>Tip: Using the latest TLS version with Azure Cache for Redis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提示:将最新的TLS版本与Azure Cache一起用于Redis</h1>
<blockquote>原文：<a href="https://itnext.io/tip-using-the-latest-tls-version-with-azure-cache-for-redis-91a4b02fabb4?source=collection_archive---------7-----------------------#2020-06-09">https://itnext.io/tip-using-the-latest-tls-version-with-azure-cache-for-redis-91a4b02fabb4?source=collection_archive---------7-----------------------#2020-06-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6296" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://docs.microsoft.com/azure/azure-cache-for-redis/cache-overview?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Cache for Redis </a>提供基于开源软件Redis的内存数据存储。</p><p id="8775" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">作为全行业推动专用传输层安全(<code class="fe kp kq kr ks b">TLS</code>)版本<code class="fe kp kq kr ks b">1.2</code>或更高版本的一部分，Redis的Azure Cache将不支持<code class="fe kp kq kr ks b">TLS</code>版本1.0和1.1，即您的应用程序将被要求使用<code class="fe kp kq kr ks b">TLS</code> 1.2或更高版本来与您的缓存通信</p><blockquote class="kt ku kv"><p id="31ba" class="jq jr kw js b jt ju jv jw jx jy jz ka kx kc kd ke ky kg kh ki kz kk kl km kn im bi translated"><em class="it">阅读详细内容，</em> <a class="ae ko" href="https://docs.microsoft.com/azure/azure-cache-for-redis/cache-remove-tls-10-11?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="it">请参考本页来自</em> </a>的产品文档</p></blockquote><p id="e58e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">了解这将如何体现在你的围棋应用中可能会有所帮助(我用<code class="fe kp kq kr ks b"><a class="ae ko" href="https://github.com/go-redis/redis" rel="noopener ugc nofollow" target="_blank">go-redis</a></code> <a class="ae ko" href="https://github.com/go-redis/redis" rel="noopener ugc nofollow" target="_blank">客户端</a>作为例子)</p><h1 id="e241" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">如果您根本没有指定<code class="fe kp kq kr ks b">TLS</code></h1><p id="5a18" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">例如</p><pre class="md me mf mg gt mh ks mi mj aw mk bi"><span id="0fc1" class="ml lb it ks b gy mm mn l mo mp">c := redis.NewClient(&amp;redis.Options{Addr: endpoint, Password: password})</span><span id="f1db" class="ml lb it ks b gy mq mn l mo mp">err := c.Ping().Err()<br/>    if err != nil {<br/>        log.Fatal(err)<br/>    }<br/>defer c.Close()</span></pre><p id="a18a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">..你会遇到这个错误<code class="fe kp kq kr ks b">i/o timeout</code>(可能没什么帮助)</p><h1 id="b329" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">如果指定的<code class="fe kp kq kr ks b">TLS</code>版本低于<code class="fe kp kq kr ks b">1.2</code></h1><p id="d90a" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">例如</p><pre class="md me mf mg gt mh ks mi mj aw mk bi"><span id="d9ae" class="ml lb it ks b gy mm mn l mo mp"><strong class="ks iu">tlsConfig := &amp;tls.Config{MaxVersion: tls.VersionTLS11, MinVersion: tls.VersionTLS10}</strong></span><span id="a477" class="ml lb it ks b gy mq mn l mo mp">c := redis.NewClient(&amp;redis.Options{Addr: endpoint, Password: password, TLSConfig: tlsConfig})</span><span id="8aee" class="ml lb it ks b gy mq mn l mo mp">err := c.Ping().Err()<br/> if err != nil {<br/>    log.Fatal(err)<br/> }</span><span id="1a68" class="ml lb it ks b gy mq mn l mo mp">defer c.Close()</span></pre><p id="7915" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">..您将最终导致一个<code class="fe kp kq kr ks b">tls: DialWithDialer timed out</code>错误(同样，不是那么明显)</p><h1 id="29b9" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">不过，解决方案很明显</h1><p id="ac38" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">如果不设置<code class="fe kp kq kr ks b">MaxVersion</code>或<code class="fe kp kq kr ks b">MinVersion</code>，即使用<code class="fe kp kq kr ks b">tlsConfig := &amp;tls.Config{}</code>，它将从<code class="fe kp kq kr ks b">MaxVersion</code>默认到<code class="fe kp kq kr ks b">TLS1.3</code>开始工作(参见<a class="ae ko" href="https://golang.org/pkg/crypto/tls/#Config" rel="noopener ugc nofollow" target="_blank">https://golang.org/pkg/crypto/tls/#Config</a>)</p><p id="88a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了清楚起见，最好是明确的，即</p><pre class="md me mf mg gt mh ks mi mj aw mk bi"><span id="12da" class="ml lb it ks b gy mm mn l mo mp">tlsConfig := &amp;tls.Config{MinVersion: tls.VersionTLS12}</span></pre><p id="662f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您在使用Go连接到Azure Cache for Redis时遇到任何问题，我希望这能对您有所帮助</p><p id="6d72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">干杯！</p></div></div>    
</body>
</html>
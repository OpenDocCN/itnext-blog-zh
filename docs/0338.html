<html>
<head>
<title>Handle Tab changes in React Navigation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理React导航中的选项卡更改</h1>
<blockquote>原文：<a href="https://itnext.io/handle-tab-changes-in-react-navigation-3717180cddb?source=collection_archive---------2-----------------------#2018-02-22">https://itnext.io/handle-tab-changes-in-react-navigation-3717180cddb?source=collection_archive---------2-----------------------#2018-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3d645f9e4b47d10bae910c16919a03b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QY5S4senfFh-mIViSi5A_Q.png"/></div></div></figure><p id="6819" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fhandle-tab-changes-in-react-navigation-3717180cddb" rel="noopener ugc nofollow" target="_blank"> <em class="kx">点击这里在LinkedIn上分享这篇文章</em> </a></p><blockquote class="ky kz la"><p id="ae52" class="jy jz kx ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><strong class="ka ir">注</strong>:本文涵盖react-navigation v1.x，关于react-navigation v2.x，请参见<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/handle-tab-changes-in-react-navigation-v2-faeadc2f2ffe">React Navigation v2中的处理选项卡变化</a>。</p></blockquote><p id="5b20" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最近我不得不在用户使用<a class="ae kw" href="https://v1.reactnavigation.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">React Navigation v1</strong></a>切换到<strong class="ka ir">React Native</strong><em class="kx">Tab navigator</em>中的特定选项卡时执行一些操作。</p><p id="3884" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们考虑下面的TabNavigator:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="4643" class="ln lo iq lj b gy lp lq l lr ls"><em class="kx">import</em> { TabNavigator } <em class="kx">from</em> "react-navigation";</span><span id="e03b" class="ln lo iq lj b gy lt lq l lr ls"><em class="kx">export</em> <em class="kx">default</em> TabNavigator({<br/>  Home: { screen: HomeScreen },<br/>  Settings: { screen: SettingsScreen }<br/>}, {<br/>  <strong class="lj ir">lazy: false</strong><br/>});</span></pre><blockquote class="ky kz la"><p id="59e7" class="jy jz kx ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><strong class="ka ir">更新9-Jun-2018: <br/> </strong>为了让这个工作，你需要把<code class="fe lu lv lw lj b">lazy</code>配置选项设置为<code class="fe lu lv lw lj b">false</code>。</p></blockquote><p id="4c7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，假设您想在用户聚焦Home选项卡时做一些事情。为此，您必须在<code class="fe lu lv lw lj b"><strong class="ka ir">navigationOptions</strong></code>属性上设置<code class="fe lu lv lw lj b"><a class="ae kw" href="https://reactnavigation.org/docs/tab-navigator.html#tabbaronpress" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">tabBarOnPress</strong></a></code>回调:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a1e2" class="ln lo iq lj b gy lp lq l lr ls">class HomeScreen extends Component {</span><span id="bd94" class="ln lo iq lj b gy lt lq l lr ls">  static navigationOptions = () =&gt; {<br/>    <em class="kx">return</em> {<br/>      tabBarOnPress({ jumpToIndex, scene }) {</span><span id="0f7e" class="ln lo iq lj b gy lt lq l lr ls">        // perform your logic here</span><span id="26e8" class="ln lo iq lj b gy lt lq l lr ls">        // this is mandatory to perform the actual switch<br/>        // you can omit this if you want to prevent it<br/>        jumpToIndex(scene.index);<br/>      }<br/>    };<br/>  };</span><span id="4ae8" class="ln lo iq lj b gy lt lq l lr ls">  ...</span><span id="ce55" class="ln lo iq lj b gy lt lq l lr ls">}</span></pre><p id="6cb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您的逻辑可以在回调中直接执行，那么您就可以开始了。</p><p id="74fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是如果你需要在组件上执行一些<strong class="ka ir">方法</strong>，或者访问组件的<strong class="ka ir">状态</strong>或者<strong class="ka ir">属性</strong>，我们需要做一些额外的工作:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="87a8" class="ln lo iq lj b gy lp lq l lr ls">class HomeScreen extends Component {</span><span id="9924" class="ln lo iq lj b gy lt lq l lr ls">  static navigationOptions = ({ navigation }) =&gt; {</span><span id="2fe6" class="ln lo iq lj b gy lt lq l lr ls">    const { params } = navigation.state;</span><span id="2054" class="ln lo iq lj b gy lt lq l lr ls">    <em class="kx">return</em> {<br/>      tabBarOnPress({ jumpToIndex, scene }) {</span><span id="e3d1" class="ln lo iq lj b gy lt lq l lr ls">        // now we have access to Component methods<br/>        params.onTabFocus();</span><span id="47c3" class="ln lo iq lj b gy lt lq l lr ls">        jumpToIndex(scene.index);<br/>      }<br/>    };<br/>  };</span><span id="0acd" class="ln lo iq lj b gy lt lq l lr ls">  componentDidMount() {</span><span id="8b86" class="ln lo iq lj b gy lt lq l lr ls">    // set a custom param on the navigation object</span><span id="9156" class="ln lo iq lj b gy lt lq l lr ls">    <em class="kx">this</em>.props.navigation.setParams({<br/>      onTabFocus: <em class="kx">this</em>.handleTabFocus<br/>    });<br/>  }</span><span id="5ac7" class="ln lo iq lj b gy lt lq l lr ls">  handleTabFocus = () =&gt; {<br/>    // perform your logic here<br/>  }</span><span id="201b" class="ln lo iq lj b gy lt lq l lr ls">  ...</span><span id="5e9d" class="ln lo iq lj b gy lt lq l lr ls">}</span></pre><p id="5ec6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，我们不直接访问状态或道具。相反，我们:</p><ul class=""><li id="183d" class="lx ly iq ka b kb kc kf kg kj lz kn ma kr mb kv mc md me mf bi translated">使用<code class="fe lu lv lw lj b"><em class="kx">this</em>.props.navigation.setParams({ <em class="kx">myParam</em>: this.<em class="kx">myHandler</em> })</code>在导航对象上设置自定义参数</li><li id="a739" class="lx ly iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">因此可以使用<code class="fe lu lv lw lj b">navigation.state.params.<em class="kx">myParam</em></code>在导航选项中调用这个自定义参数</li></ul><h1 id="ee51" class="ml lo iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">使用案例:</h1><ul class=""><li id="bad2" class="lx ly iq ka b kb ni kf nj kj nk kn nl kr nm kv mc md me mf bi translated">切换到选项卡时重置一些状态</li><li id="bb4b" class="lx ly iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">当用户聚焦选项卡时，执行任何附加逻辑</li><li id="4189" class="lx ly iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">防止用户聚焦特定选项卡</li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Fixed with absolute</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绝对固定</h1>
<blockquote>原文：<a href="https://itnext.io/fixed-with-absolute-be55976e6644?source=collection_archive---------5-----------------------#2018-05-01">https://itnext.io/fixed-with-absolute-be55976e6644?source=collection_archive---------5-----------------------#2018-05-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3058740061a2d6b5576e49a1998aa761.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7nb-owwLC4MMYZTlyFZ7w.png"/></div></div></figure><h1 id="7022" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">几个概念</h1><ul class=""><li id="2ee5" class="kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetWidth" rel="noopener ugc nofollow" target="_blank"> offsetWidth </a>:给出元素的宽度，以像素为单位。</li><li id="7ae4" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetHeight" rel="noopener ugc nofollow" target="_blank"> offsetHeight </a>:给出元素的高度，以像素为单位。</li><li id="ac99" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/clientWidth" rel="noopener ugc nofollow" target="_blank"> clientWidth </a>:给出元素内部空间的大小，忽略边框宽度。</li><li id="3d95" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/clientHeight" rel="noopener ugc nofollow" target="_blank"> clientHeight </a>:给出元素内部空间的大小，忽略边框高度。</li><li id="9002" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/pageXOffset" rel="noopener ugc nofollow" target="_blank"> pageXOffset </a>:返回沿横轴(左右)滚动的像素数。</li><li id="cbc0" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/pageYOffset" rel="noopener ugc nofollow" target="_blank">page yo offset</a>:返回文档当前沿纵轴滚动的像素数，值0.0表示文档的上边缘当前与窗口内容区域的上边缘对齐。</li><li id="7ee3" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect" rel="noopener ugc nofollow" target="_blank"> getBoundingClientRect </a>:返回一个具有top、bottom、left和right属性的对象，指示元素各边相对于视口左上角的像素位置。如果希望它们相对于整个文档，则必须添加当前滚动位置，可以在pageXOffset和pageYOffset绑定中找到该位置。</li><li id="d1b6" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/innerHeight" rel="noopener ugc nofollow" target="_blank"> innerWidth </a>:浏览器窗口视区的宽度(以像素为单位)，包括垂直滚动条(如果渲染的话)。</li><li id="345c" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/innerHeight" rel="noopener ugc nofollow" target="_blank"> innerHeight </a>:浏览器窗口视区的高度(以像素为单位)，包括水平滚动条(如果渲染的话)。</li><li id="f2a5" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollWidth" rel="noopener ugc nofollow" target="_blank"> scrollWidth </a>:元素内容宽度的度量，包括因溢出而在屏幕上不可见的内容。</li><li id="38e4" class="kw kx iq ky b kz lp lb lq ld lr lf ls lh lt lj lk ll lm ln bi translated"><a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight" rel="noopener ugc nofollow" target="_blank"> scrollHeight </a>:测量元素内容的高度，包括因溢出而在屏幕上不可见的内容。</li></ul><h1 id="4fd6" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">实践</h1><p id="bb53" class="pw-post-body-paragraph lu lv iq ky b kz la lw lx lb lc ly lz ld ma mb mc lf md me mf lh mg mh mi lj ij bi translated">让我们把上面的概念放在一起，用<code class="fe mj mk ml mm b">absolute</code>位置实现<code class="fe mj mk ml mm b">fixed</code>位置效果，以及滚动进度功能。</p><pre class="mn mo mp mq gt mr mm ms mt aw mu bi"><span id="c435" class="mv jz iq mm b gy mw mx l my mz">// fixed.html<br/>&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="UTF-8"&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;<br/>    &lt;title&gt;Fixed&lt;/title&gt;<br/>    &lt;style&gt;<br/>        body {<br/>            margin: 0;<br/>            position: relative;<br/>            /* extend the body so that it can scroll to see the fixed effect */<br/>            width: 2000px;<br/>            height: 2000px;<br/>        }<br/>        #greet {<br/>            width: 100px;<br/>            height: 100px;<br/>            line-height: 100px;<br/>            padding: 5px;<br/>            text-align: center;<br/>            border: 2px solid green;<br/>            position: absolute;<br/>        }<br/>        .progress {<br/>            text-align: center;<br/>            border: 1px solid black;<br/>            /* fixed for progress as we only want to demonstrate the usage of scrollWidth and page offset for progress functionality */<br/>            position: fixed;<br/>            left: 50%;<br/>            padding: 10px;<br/>            /* center the progress info divs */<br/>            transform: translateX(-50%);<br/>        }<br/>        #xprogress{<br/>            top: 0;<br/>        }<br/>        #yprogress{<br/>            top: 50px;<br/>        }<br/>    &lt;/style&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div id="greet"&gt; Hello World &lt;/div&gt;<br/>    &lt;div id="xprogress" class="progress"&gt;horizontal: 0&lt;/div&gt;<br/>    &lt;div id="yprogress" class="progress"&gt;vertical: 0&lt;/div&gt;<br/>    &lt;script&gt;<br/>        let node = document.querySelector('#greet');<br/>        console.log(JSON.stringify({<br/>            offsetWidth: node.offsetWidth, // 114 - with padding and border<br/>            offsetHeight: node.offsetHeight, // 114 - with padding and border<br/>            clientWidth: node.clientWidth, // 110 - with padding but without border<br/>            clinetHeight: node.clientHeight, // 110 - with padding but without border<br/>            innerWidth: innerWidth, // 1670, vary based on your setting<br/>            innerHeight: innerHeight // 700, vary based on your setting<br/>        }, null, '\t'));<br/>        node.style.left = (innerWidth / 2 - node.offsetWidth / 2) + 'px';<br/>        node.style.top = (innerHeight / 2 - node.offsetHeight / 2) + 'px';</span><span id="bef0" class="mv jz iq mm b gy na mx l my mz">        // for fixed div<br/>        document.addEventListener('scroll', function() { // listen to scroll event, adjust the position based on the scroll infomation<br/>            let rec = node.getBoundingClientRect();<br/>            let {top, left, width, height} = rec; // top and left is based on viewport, need to take scroll offset into account<br/>            console.log(JSON.stringify({<br/>                width,<br/>                height,<br/>                top,<br/>                left,<br/>                pageYOffset,<br/>                pageXOffset<br/>            }, null, '\t'));<br/>            node.style.left = (pageXOffset + innerWidth / 2 - width / 2) + 'px';<br/>            node.style.top = (pageYOffset + innerHeight / 2 - height / 2) + 'px';<br/>        });</span><span id="876d" class="mv jz iq mm b gy na mx l my mz">        let yMax = document.body.scrollHeight - innerHeight;<br/>        let xMax = document.body.scrollWidth - innerWidth;<br/>        // for progress bar<br/>        document.addEventListener('scroll', function () {<br/>            let xProgress = document.querySelector('#xprogress');<br/>            let yProgress = document.querySelector('#yprogress');</span><span id="73cc" class="mv jz iq mm b gy na mx l my mz">            xProgress.textContent = `horizontal: ${pageXOffset * 100/ xMax}%`;<br/>            yProgress.textContent = `vertical: ${pageYOffset * 100 / yMax}%`;<br/>        });<br/>    &lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="db66" class="pw-post-body-paragraph lu lv iq ky b kz nb lw lx lb nc ly lz ld nd mb mc lf ne me mf lh nf mh mi lj ij bi translated"><a class="ae lo" href="https://github.com/n0ruSh/the-art-of-reading/blob/master/javascript/Eloquent%20Javascript/fixed.html" rel="noopener ugc nofollow" target="_blank">代码示例</a></p><h1 id="4560" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">参考</h1><ul class=""><li id="baeb" class="kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><a class="ae lo" href="https://www.amazon.com/Eloquent-JavaScript-2nd-Ed-Introduction/dp/1593275846" rel="noopener ugc nofollow" target="_blank">雄辩的JavaScript </a></li></ul><h1 id="86ee" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">通知；注意</h1><ul class=""><li id="98d0" class="kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">读书笔记系列如果想关注最新的新闻/文章，请<a class="ae lo" href="https://github.com/n0ruSh/the-art-of-reading" rel="noopener ugc nofollow" target="_blank">【观看】</a>订阅。</li></ul></div></div>    
</body>
</html>
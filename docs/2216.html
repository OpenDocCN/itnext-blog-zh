<html>
<head>
<title>React- Your First Custom Hook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React-你的第一个定制钩子</h1>
<blockquote>原文：<a href="https://itnext.io/react-custom-hooks-basics-f92de2a0ac0e?source=collection_archive---------4-----------------------#2019-04-17">https://itnext.io/react-custom-hooks-basics-f92de2a0ac0e?source=collection_archive---------4-----------------------#2019-04-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/dd3cba30b485857afaadbb897e196646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QLE074rzEkTTJoiO"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@chris_j_scott?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·斯科特</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="9df8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">React 16.8.0引入了<strong class="ki iu">钩子</strong>。请注意，这不是React 17.0.0，因为钩子可以无缝集成到React代码中，这意味着它们不会破坏现有代码。React提供了一堆钩子，你可以在他们令人惊奇的文档中读到它们。</p><p id="e5f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，还有更多…</p><p id="cd34" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">你不仅可以使用</em> <strong class="ki iu"> <em class="le">钩子</em> </strong> <em class="le"> React提供，而且你还可以在它们上面构建你自己的</em> <strong class="ki iu"> <em class="le">钩子</em> </strong> <em class="le">。</em></p><p id="a7df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你已经用钩子弄脏了你的手，这篇文章将帮助你在坚实的基础上创建你自己的钩子。</p><h2 id="88b2" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">先决条件:</h2><ol class=""><li id="e1bb" class="ly lz it ki b kj ma kn mb kr mc kv md kz me ld mf mg mh mi bi translated">你应该熟悉react</li><li id="82d0" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">你应该熟悉React钩子</li><li id="684c" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">你应该更喜欢Javascript 中的函数而不是类<em class="le"/></li></ol><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/b53dcd3bb9260863ebdb4fd4888329e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/1*7qlNdQrS6cpp2WvgqZebFQ.gif"/></div></figure><h2 id="5567" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated"><strong class="ak">什么时候用钩子？</strong></h2><p id="fae7" class="pw-post-body-paragraph kg kh it ki b kj ma kl km kn mb kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">我们都知道钩子的引入是为了在功能组件中包含有状态的东西。因此，在大多数情况下，你可以将类组件转换成功能组件。</p><p id="fbe9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是如果我们不再像那样考虑钩子…</p><p id="2447" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们把钩子看作是一种编程方式，一种允许我们把逻辑从UI中分离出来的工具，这样我们就可以在应用程序的其他地方重用它。</p><p id="5aa1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为<em class="le">增加的</em>好处，您可以访问组件的状态，因此如果状态发生变化，react可以进行所有那些花哨的更新。</p><h2 id="325a" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">何时使用定制挂钩？</h2><p id="7f15" class="pw-post-body-paragraph kg kh it ki b kj ma kl km kn mb kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">让我们看看一些代码..</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mw mx l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">对知道得比应该知道得多的组件做出反应</figcaption></figure><p id="d5af" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个使用<code class="fe my mz na nb b">useState()</code>钩子的非常简单的React <code class="fe my mz na nb b">&lt;Form/&gt;</code>组件。</p><ol class=""><li id="a1dc" class="ly lz it ki b kj kk kn ko kr nc kv nd kz ne ld mf mg mh mi bi translated">它有一个<code class="fe my mz na nb b">&lt;input/&gt;</code>供用户输入密码</li><li id="d955" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">它有一个<code class="fe my mz na nb b">onChange()</code>事件来检查密码是否有效</li><li id="6239" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">如果密码有效，我们会向用户显示它</li></ol><p id="7a28" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，这不是一个真正的形式。它甚至没有一个按钮提交:D <br/>然而，当我们学习新的东西时，我们必须从小处着手。</p><p id="a076" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回到我们的例子，你认为这里需要使用定制钩子吗？当我第一次看到这个的时候我真的不知道。</p><p id="273a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我之前提到的，<em class="le">把钩子看作是把你的逻辑和你的UI分开的工具。</em></p><p id="d21e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">记住，<code class="fe my mz na nb b">&lt;Form/&gt;</code>组件中的<code class="fe my mz na nb b">onChange()</code>方法包含验证密码的逻辑。<br/><code class="fe my mz na nb b">&lt;Form/&gt;</code>组件太了解密码的处理方式。</p><blockquote class="nf ng nh"><p id="eaad" class="kg kh le ki b kj kk kl km kn ko kp kq ni ks kt ku nj kw kx ky nk la lb lc ld im bi translated">每当你看到一个组件知道的比它应该知道的多，它应该是一个你可能需要重构它的信号。</p></blockquote><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4147ba5eb0bb7903aabbca5166384701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*9xTaZ8xBWdlnFOL0ntPWcg.gif"/></div></figure><p id="9161" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从<code class="fe my mz na nb b">&lt;Form/&gt;</code>组件中取出验证逻辑。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mw mx l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">定制钩子的作用</figcaption></figure><p id="1c19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我第一次看到这样的东西时，我花了大约15分钟才明白这里到底发生了什么。你很幸运，你很少会理解这个。</p><p id="4d1c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事情是这样的:</p><ol class=""><li id="a11f" class="ly lz it ki b kj kk kn ko kr nc kv nd kz ne ld mf mg mh mi bi translated">我们创建了一个名为<code class="fe my mz na nb b">useSmartPassword()</code> (14)的定制钩子</li><li id="7728" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">我们通过使用React的<code class="fe my mz na nb b">useState()</code>钩子(15)使我们的定制钩子有状态</li><li id="8536" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">我们定义了一个函数，我们稍后会公开它，包含我们的逻辑(17)</li><li id="7d23" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">该逻辑从外部接收一些输入，并更新customHook的状态(21)</li><li id="d5ed" class="ly lz it ki b kj mj kn mk kr ml kv mm kz mn ld mf mg mh mi bi translated">最后，我们公开customHooks的状态和改变该状态的逻辑函数(24)</li></ol><h2 id="1646" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">还在迷茫？</h2><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7b5254c8bf232cf51dfc184c57d245f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*K90C-MvFAxU4EpiDkq3Hww.gif"/></div></figure><p id="2713" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每当你写一个自定义钩子时，你必须返回一个包含两个元素的数组。在其他语言中，它被称为元组。</p><p id="b470" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个元组必须包含<code class="fe my mz na nb b">currentValue</code>和一个更新它的函数。类似于:</p><pre class="mp mq mr ms gt nn nb no np aw nq bi"><span id="06ec" class="lf lg it nb b gy nr ns l nt nu">[currentValue, setCurrentValue] = customHook();</span></pre><p id="1128" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更新函数<code class="fe my mz na nb b">setCurrentValue()</code>应该接受参数。该参数可以是更新后的状态或其他值/函数。如果你选择发送一些其他的值/函数，你让更新函数根据它自己的逻辑更新<code class="fe my mz na nb b">currentValue</code>。这就是我们在上面的例子中所做的。</p><p id="355e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">记住，无论何时调用更新函数<code class="fe my mz na nb b">setCurrentValue()</code>，都是在更新组件的状态。就像<code class="fe my mz na nb b">this.setState()</code>一样。因此，组件将使用我们的最新状态重新呈现。</p><p id="75cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完整的代码可以在下面的沙盒中看到:</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="nv mx l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用自定义挂钩的工作示例</figcaption></figure><h2 id="8d32" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">结论</h2><p id="9b93" class="pw-post-body-paragraph kg kh it ki b kj ma kl km kn mb kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">我想让你从这篇文章中学到的是，如果有必要，钩子可以让你提取逻辑并在应用程序中使用它。因为这些钩子允许您使用React的状态，所以您可以让React担心组件的更新，同时您可以编写更干净和可伸缩的代码。</p><p id="aeb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，你再也不需要使用类了。不要再说永远了，但你会明白的。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/1cd0fcdd48c2399c46024a96201b9e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/1*Cgb-YKK6j2AjXO4ai3JPQQ.gif"/></div></figure></div></div>    
</body>
</html>
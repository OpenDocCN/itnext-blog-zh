<html>
<head>
<title>Who needs Redux anyway?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谁需要Redux呢？</h1>
<blockquote>原文：<a href="https://itnext.io/who-needs-redux-anyway-1d946e9ffa3b?source=collection_archive---------6-----------------------#2018-03-04">https://itnext.io/who-needs-redux-anyway-1d946e9ffa3b?source=collection_archive---------6-----------------------#2018-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0c8bf5e7b10328577204adb59909ce48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1xOJrwkohayBV41FOBOEw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">TL；博士</strong>——【https://github.com/amitayh/no-redux】T2</figcaption></figure><p id="4a44" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><a class="ae kd" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fwho-needs-redux-anyway-1d946e9ffa3b" rel="noopener ugc nofollow" target="_blank"> <em class="lc">点击这里在LinkedIn上分享这篇文章</em> </a></p><p id="21c9" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">Redux是一个非常流行的状态管理库，通常与React一起使用。人们喜欢它，因为它提供了一个可预测的数据模型，灵感来自Elm架构。然而，JS社区中有许多人<a class="ae kd" href="https://medium.com/@machnicki/why-redux-is-not-so-easy-some-alternatives-24816d5ad22d" rel="noopener">不</a> <a class="ae kd" href="https://games.greggman.com/game/react-and-redux-are-a-joke-right/" rel="noopener ugc nofollow" target="_blank">喜欢</a> <a class="ae kd" href="https://news.ycombinator.com/item?id=10940845" rel="noopener ugc nofollow" target="_blank"> it </a>并且更喜欢选择替代品，例如<a class="ae kd" href="https://github.com/mobxjs/mobx" rel="noopener ugc nofollow" target="_blank"> MobX </a>。</p><p id="2b64" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">总结一下通常出现的主要利弊:</p><h2 id="95ab" class="ld le iq bd kc lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">Redux的优势</h2><ul class=""><li id="ddd4" class="lv lw iq kg b kh lx kl ly kp lz kt ma kx mb lb mc md me mf bi translated">可预测性和简单性</li><li id="0854" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">单向数据流和不变性</li><li id="e3f2" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">数据和表示的分离</li><li id="1731" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">可扩展性(通过中间件)</li><li id="3075" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">受欢迎程度和社区</li><li id="93ba" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">工具支持</li></ul><h2 id="a7c6" class="ld le iq bd kc lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">Redux的弱点</h2><ul class=""><li id="0ce9" class="lv lw iq kg b kh lx kl ly kp lz kt ma kx mb lb mc md me mf bi translated">样板文件(视图、动作类型、动作创建者、缩减者、选择器等等)</li><li id="79a0" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">没有现成的解决副作用的方法(可通过中间件如<a class="ae kd" href="https://github.com/gaearon/redux-thunk" rel="noopener ugc nofollow" target="_blank"> redux-thunk </a>或<a class="ae kd" href="https://github.com/redux-saga/redux-saga" rel="noopener ugc nofollow" target="_blank"> redux-saga </a>获得)</li><li id="1094" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">动作与它们的效果(在reducer中定义)是分离的</li></ul><h1 id="aa26" class="ml le iq bd kc mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">一种相似但不同的方法</h1><p id="ebb0" class="pw-post-body-paragraph ke kf iq kg b kh lx kj kk kl ly kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ij bi translated">在我最近参与的一个项目中，我对自己说“我甚至需要一些第三方库来管理我的状态吗”？React本身就是一个很棒的库，我可以通过一个不可变的值来控制我的状态，这个值带有在状态之间转换的纯函数。React会处理剩下的事情。</p><h2 id="6695" class="ld le iq bd kc lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">纯洁</h2><p id="5808" class="pw-post-body-paragraph ke kf iq kg b kh lx kj kk kl ly kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ij bi translated">我想保持大部分应用程序的纯净，使用过Scala、Clojure和Haskell等语言，并看到了函数式编程和不变性的好处。</p><p id="136e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="kg ir">纯视图</strong>——这个很简单。React给了我们一个编程模型</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="8ac6" class="ld le iq nk b gy no np l nq nr">view = f(state)</span></pre><p id="38b1" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">所以我们需要做的就是写下<em class="lc"> f </em>。不需要连接的组件或内部组件状态。我们也可以从React的<a class="ae kd" href="https://reactjs.org/docs/react-api.html#reactpurecomponent" rel="noopener ugc nofollow" target="_blank">纯组分</a>中受益，该纯组分比常规组分具有更好的性能。</p><p id="f5e7" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="kg ir">纯态</strong>——再次声明，此处无需赘述。我们可以简单地用一个不可变的值来表示我们整个应用程序的状态。像<a class="ae kd" href="https://facebook.github.io/immutable-js/" rel="noopener ugc nofollow" target="_blank">不可变. js </a>或<a class="ae kd" href="http://ramdajs.com/" rel="noopener ugc nofollow" target="_blank"> Ramda </a>这样的库可以帮助我们管理不可变状态。</p><p id="9c77" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="kg ir">纯更新</strong>——在Redux和Elm中，应用程序的一个关键部分是在状态之间转换的功能。在Elm中，这是<em class="lc">更新</em>功能，在Redux中，这是<em class="lc">减速器</em>。它们都具有相同的结构</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="f658" class="ld le iq nk b gy no np l nq nr">(state, action) =&gt; new state</span></pre><p id="efb2" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">传统上，他们在动作/消息类型上使用某种模式匹配或switch语句，并返回带有所需更新的状态的新副本。这种方法让我感到困扰的是，每次更新都通过同一个函数，这违反了<a class="ae kd" href="https://en.wikipedia.org/wiki/Single_responsibility_principle" rel="noopener ugc nofollow" target="_blank">单一责任原则</a>并且可能变得很难维护<a class="ae kd" href="https://github.com/reactjs/redux/blob/master/examples/todomvc/src/reducers/todos.js" rel="noopener ugc nofollow" target="_blank">即使对于小应用程序</a>。我宁愿使用多态调度，其中更新函数是动作的一部分。</p><h2 id="8a3a" class="ld le iq bd kc lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">行动</h2><p id="ce74" class="pw-post-body-paragraph ke kf iq kg b kh lx kj kk kl ly kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ij bi translated">与Redux类似，我写了“动作创作者”。但是与Redux不同的是，这些动作只是更新函数的容器。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d659" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这是非常独立和解耦的。我们只需要一种方式来调度这些行动。这并不太难，我们在项目的根部保留了一个可变变量来保存我们的状态。然后我们渲染应用程序，将调度功能作为道具传递。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h2 id="ef6c" class="ld le iq bd kc lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">跑步(副作用)</h2><p id="3f2d" class="pw-post-body-paragraph ke kf iq kg b kh lx kj kk kl ly kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ij bi translated">我们希望能够以可控和可预测的方式触发副作用(例如，发出AJAX请求)。在Elm中，这是通过允许<em class="lc"> update </em>函数返回一个<a class="ae kd" href="https://www.elm-tutorial.org/en/03-subs-cmds/02-commands.html" rel="noopener ugc nofollow" target="_blank">命令</a>以及更新后的模型来实现的。命令本身不会导致副作用，而仅仅是对将要发生的效果的描述。我们将使用类似的方法，允许我们的动作定义一个<em class="lc"> runEffect </em>函数。这将保持动作本身的纯净——因为它们实际上并不运行效果。这将在我们的计划之外，在“世界的尽头”的一个地方处理</p><p id="290b" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们将更新我们的调度功能以允许这种行为:</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="a1b2" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在，我们可以定义产生副作用的动作，保持应用程序的其余部分纯净和安全:</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="a69d" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这种方法非常简单，但它提供了我喜欢的Redux的东西，并消除了一些复杂性和样板文件。它确实有一些问题我想很快解决:</p><ul class=""><li id="080e" class="lv lw iq kg b kh ki kl km kp nu kt nv kx nw lb mc md me mf bi translated"><strong class="kg ir">工具:</strong>因为这里没有库，也没有社区支持，所以没有像<a class="ae kd" href="https://github.com/gaearon/redux-devtools" rel="noopener ugc nofollow" target="_blank"> Redux DevTools </a>这样棒的工具。然而，我发现添加一个用于调试的实用函数非常容易，它记录每个动作，包括新旧状态。</li><li id="8f20" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated"><strong class="kg ir">可串行化:</strong> Redux的动作只保存动作数据和类型。这使您可以轻松地保存它们，或通过网络传输它们。这对于我描述的动作创建者来说是不可能的。然而，通过在action对象上添加一个<em class="lc">类型</em>属性，并拥有某种可以从其有效负载中重新创建action对象的工厂函数，可以很容易地获得同样的好处。</li></ul><h1 id="c5d6" class="ml le iq bd kc mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">结论</h1><p id="b71f" class="pw-post-body-paragraph ke kf iq kg b kh lx kj kk kl ly kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ij bi translated">这对我来说是一个有趣的项目，向我展示了有时我可以稍微改变一下熟悉的模式来实现更简单的代码库。这并不意味着Redux是一个坏的或无用的库——只是你可能并不总是需要它为你的用例提供的一切(对于每个框架/库都是如此)。所以花时间想想你真正需要的是什么，因为简单很重要。</p><p id="ef37" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下面是使用这种方法的强制todo MVC实现:</p><ul class=""><li id="d174" class="lv lw iq kg b kh ki kl km kp nu kt nv kx nw lb mc md me mf bi translated">演示:<a class="ae kd" href="https://amitayh.github.io/no-redux" rel="noopener ugc nofollow" target="_blank">https://amitayh.github.io/no-redux</a></li><li id="100f" class="lv lw iq kg b kh mg kl mh kp mi kt mj kx mk lb mc md me mf bi translated">回购:<a class="ae kd" href="https://github.com/amitayh/no-redux" rel="noopener ugc nofollow" target="_blank">https://github.com/amitayh/no-redux</a></li></ul></div></div>    
</body>
</html>
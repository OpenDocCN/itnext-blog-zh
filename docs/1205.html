<html>
<head>
<title>You don’t need GUI — how to control iOS Simulator from command line</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你不需要图形用户界面——如何从命令行控制iOS模拟器</h1>
<blockquote>原文：<a href="https://itnext.io/you-dont-need-gui-or-how-to-control-ios-simulator-from-command-line-bf5cfa60aed2?source=collection_archive---------0-----------------------#2018-08-11">https://itnext.io/you-dont-need-gui-or-how-to-control-ios-simulator-from-command-line-bf5cfa60aed2?source=collection_archive---------0-----------------------#2018-08-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d5d27ba7e609011d3aa72275db89ee05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9vF1yE_0l4vqgI0CjK6WQ.png"/></div></div></figure><p id="f8fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回到过去，如果你使用计算机，你通常使用命令行用户界面。今天的开发使用GUI (Xcode，Simulator等)。)而且非常容易使用。但是，如果您需要使用CI或想要自动执行一些流程，如创建/删除特定的模拟器、更改一些设置，该怎么办呢？在这种情况下，您可以使用Xcode的simctl实用程序和bash脚本。下面你会看到一个如何编写bash脚本的手册，它将使用CLI简化iOS模拟器的工作。</p><p id="56ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该脚本应该能够管理以下操作:</p><ul class=""><li id="a1e9" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated"><code class="fe lf lg lh li b">getuid</code></li><li id="8208" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">create</code></li><li id="d25c" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">delete</code></li><li id="6cff" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">boot</code></li><li id="5c7b" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">open</code></li><li id="4ceb" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">shutdown</code></li></ul><p id="946f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将要实施的另一个操作是使用配置文件更改模拟器的语言设置(可以是任何其他设置)。</p><p id="c203" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于所有这些动作，将使用强制的<code class="fe lf lg lh li b">name</code>参数。</p><h1 id="e457" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">Bash脚本，初始设置</h1><p id="75d2" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">创建bash文件并使其可执行:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="a281" class="mz lp iq li b gy na nb l nc nd">$ touch ios_simulator_cli.sh<br/>$ chmod +x ios_simulator_cli.sh</span></pre><p id="b8d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在编辑器中打开它，并添加以下内容:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="74e2" class="mz lp iq li b gy na nb l nc nd">#!/bin/bash<br/>SIMULATOR_NAME="$1"<br/>COMMAND="$2"</span><span id="5d84" class="mz lp iq li b gy ne nb l nc nd">print_params () {<br/>  echo "print_params"<br/>}</span><span id="372e" class="mz lp iq li b gy ne nb l nc nd">get_uid() {<br/>  echo "get_uid"<br/>}</span><span id="d67f" class="mz lp iq li b gy ne nb l nc nd">create () {<br/>  echo "create"<br/>}</span><span id="57d6" class="mz lp iq li b gy ne nb l nc nd">delete () {<br/>  echo "delete"<br/>}</span><span id="d6cb" class="mz lp iq li b gy ne nb l nc nd">boot () {<br/>  echo "boot"<br/>}</span><span id="0726" class="mz lp iq li b gy ne nb l nc nd">open () {<br/>  echo "open"<br/>}</span><span id="7605" class="mz lp iq li b gy ne nb l nc nd">shutdown () {<br/>  echo "shutdown"<br/>}</span><span id="ba74" class="mz lp iq li b gy ne nb l nc nd">locale () {<br/>  echo "locale"<br/>}</span><span id="ee89" class="mz lp iq li b gy ne nb l nc nd">if [ -z $SIMULATOR_NAME ] || [ -z $COMMAND ]<br/>then<br/>  print_params "Simulator name and COMMAND has to be specified"<br/>  exit 1<br/>fi</span><span id="b923" class="mz lp iq li b gy ne nb l nc nd">case $COMMAND in<br/>  ("getuid") get_uid ;;<br/>  ("create") create $3 $4 ;;<br/>  ("delete") delete ;;<br/>  ("boot") boot ;;<br/>  ("open") open_simulator ;;<br/>  <br/>  ("shutdown") shutdown ;;<br/>  <br/>  ("locale") set_locale $3 ;;<br/>  (*)<br/>    print_params "Unknown COMMAND [$COMMAND]"<br/>    exit 1<br/>    ;;<br/>esac</span></pre><p id="40fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们实现所有这些功能:</p><h2 id="0577" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">打印参数</h2><p id="f427" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">这是一个助手，可以用来定义脚本支持哪些参数以及如何使用它。内容将是:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="9adb" class="mz lp iq li b gy na nb l nc nd">print_params () {<br/>  echo "$1. Example:<br/>    ./scripts/ios_simulator_cli.sh SIMULATOR_NAME COMMAND<br/>  Where COMMAND can be:<br/>    create - create new simulator<br/>    shutdown - shutdown simulator<br/>    delete - delete simulator<br/>    boot - boot simulator<br/>    open - open simulator<br/>    locale - set locale<br/>    getuid - get simulator uid"<br/>}</span></pre><h2 id="35d8" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">获取_uid</h2><p id="2e42" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">所有带有<code class="fe lf lg lh li b">simctl</code>的动作都需要模拟器uid。要获得它，需要执行以下操作:</p><ul class=""><li id="31b7" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">使用<code class="fe lf lg lh li b">xcrun simctl list</code>获取所有设备的列表</li><li id="7a01" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated">使用<code class="fe lf lg lh li b">grep</code>按名称过滤结果</li><li id="76b1" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated">和一点神奇的<code class="fe lf lg lh li b">awk</code>来解析结果并得到<code class="fe lf lg lh li b">uid</code></li></ul><p id="7649" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">结果你会得到一个函数:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="138e" class="mz lp iq li b gy na nb l nc nd">get_uid() {<br/>  echo $( xcrun simctl list | grep -w $SIMULATOR_NAME | awk 'match($0, /\(([-0-9A-F]+)\)/) { print substr( $0, RSTART + 1, RLENGTH - 2 )}' )<br/>}</span></pre><p id="c8fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">执行脚本:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="5aff" class="mz lp iq li b gy na nb l nc nd">$ ./ios_simulator_cli.sh my_simulator getuid</span></pre><p id="5da5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果模拟器存在，脚本将打印uid，否则输出空结果。</p><h2 id="e86a" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">创造</h2><p id="448b" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">创建新的模拟器<code class="fe lf lg lh li b">simctl</code>需要以下参数:</p><ul class=""><li id="b236" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated"><code class="fe lf lg lh li b">name</code> -可以是任何名称，例如“我的模拟器”</li><li id="2ff4" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">device type</code> -使用<code class="fe lf lg lh li b">xcrun simctl list devicetypes</code>命令获取设备的完整列表</li><li id="7508" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">runtime</code> -使用<code class="fe lf lg lh li b">xcrun simctl list runtimes</code>命令获取完整列表</li></ul><p id="7660" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe lf lg lh li b">create</code>功能的内容为:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="1820" class="mz lp iq li b gy na nb l nc nd">create () {<br/>  TYPE=$1<br/>  RUNTIME=$2<br/>  SIMULATOR_ID=$( xcrun simctl create $SIMULATOR_NAME com.apple.CoreSimulator.SimDeviceType.$TYPE com.apple.CoreSimulator.SimRuntime.$RUNTIME )<br/>  echo $SIMULATOR_ID<br/>}</span></pre><p id="509c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在您可以运行脚本来创建新的模拟器:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="3dea" class="mz lp iq li b gy na nb l nc nd">./ios_simulator_cli.sh my_simulator create iPhone-7-Plus iOS-11-4</span></pre><h2 id="a37e" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">删除/启动</h2><p id="a672" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">删除或启动模拟器<code class="fe lf lg lh li b">simctl</code>只需要模拟器uid和相应的命令。因此，这些功能的内容是:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="40aa" class="mz lp iq li b gy na nb l nc nd">delete () {<br/>  SIMULATOR_ID=$( get_uid )<br/>  xcrun simctl delete $SIMULATOR_ID<br/>}</span><span id="99db" class="mz lp iq li b gy ne nb l nc nd">boot () {<br/>  SIMULATOR_ID=$( get_uid )<br/>  xcrun simctl boot $SIMULATOR_ID<br/>}</span></pre><h2 id="31aa" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">打开</h2><p id="839a" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">要打开模拟器，可以使用<code class="fe lf lg lh li b">open</code>命令:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="5da1" class="mz lp iq li b gy na nb l nc nd">open_simulator () {<br/>  SIMULATOR_ID=$( get_uid )<br/>  open -a Simulator --args -CurrentDeviceUDID $SIMULATOR_ID<br/>}</span></pre><h2 id="810d" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">关机</h2><p id="77c5" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">最后一步是关闭模拟器。该功能需要检查当前状态，其实现类似于<code class="fe lf lg lh li b">get_uid</code>功能:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="e550" class="mz lp iq li b gy na nb l nc nd">get_status () {<br/>  echo $(xcrun simctl list | grep -w $SIMULATOR_NAME | awk 'match($0, /\(([a-zA-Z]+)\)/) { print substr( $0, RSTART + 1, RLENGTH - 2 )}')<br/>}</span></pre><p id="6ee9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并将使用一个循环来检查状态:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="ecc8" class="mz lp iq li b gy na nb l nc nd">shutdown () {<br/>  SIMULATOR_ID=$( get_uid )<br/>  RETRY_DELAY=5<br/>  retry_cnt=10</span><span id="9973" class="mz lp iq li b gy ne nb l nc nd">  for (( ; ; ))<br/>  do<br/>    SIMULATOR_STATUS=$(get_status)</span><span id="e9c1" class="mz lp iq li b gy ne nb l nc nd">    if [ $SIMULATOR_STATUS = "Shutdown" ]<br/>    then<br/>      break<br/>    elif [ $SIMULATOR_STATUS = "Booted" ]<br/>    then<br/>      xcrun simctl shutdown $SIMULATOR_ID<br/>    else<br/>      echo "Retrying in $RETRY_DELAY seconds, status is [$SIMULATOR_STATUS]"<br/>    fi</span><span id="0ef6" class="mz lp iq li b gy ne nb l nc nd">    if [ $retry_cnt = 0 ]<br/>    then<br/>      echo "Cannot shutdown simulator $SIMULATOR_ID"<br/>      exit -1<br/>    fi<br/>    retry_cnt=$((retry_cnt - 1))<br/>    sleep $RETRY_DELAY<br/>  done<br/>}</span></pre><p id="402d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已！使用<code class="fe lf lg lh li b">xcrun simctl</code>的基本功能已经实现，可能足以满足您的需求，否则您可以继续扩展脚本。</p><h2 id="fcd3" class="mz lp iq bd lq nf ng dn lu nh ni dp ly kj nj nk mc kn nl nm mg kr nn no mk np bi translated">扩展设置</h2><p id="a7ae" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">如果您想更改模拟器中的一些设置，例如语言/区域设置，您可以修改位于以下位置的配置文件<code class="fe lf lg lh li b">.GlobalPreferences.plist </code>:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="9213" class="mz lp iq li b gy na nb l nc nd">"$HOME/Library/Developer/CoreSimulator/Devices/$SIMULATOR_ID/data/Library/Preferences/</span></pre><p id="8926" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个二进制文件，有一些不同的方法可以修改它。最简单的方法是使用Xcode或者像TextWrangler这样的编辑器，但是因为我们只使用CLI做所有的事情，所以我们将使用另一种方法。有一个叫做<code class="fe lf lg lh li b">plutil</code>的工具，它允许在Mac OS中将plist文件转换为XML或二进制，替换设置中的属性，等等。</p><p id="80c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导航到<code class="fe lf lg lh li b">$HOME/Library/Developer/CoreSimulator/Devices/$SIMULATOR_ID/data/Library/Preferences/</code>文件夹(在我的例子中，我有04 babe1a-7398-47AE-99 F2-165 AC 642 f 578 uid)并将<code class="fe lf lg lh li b">.GlobalPreferences.plist</code>转换为XML(在您还可以复制这个文件之前):</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="46d8" class="mz lp iq li b gy na nb l nc nd">$ cd $HOME/Library/Developer/CoreSimulator/Devices/04BABE1A-7398-47AE-99F2-165AC642F578/data/Library/Preferences/<br/>$ cp .GlobalPreferences.plist .GlobalPreferences.plist.orig<br/>$ plutil -convert xml1 .GlobalPreferences.plist</span></pre><p id="deec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在检查文件的内容:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="554b" class="mz lp iq li b gy na nb l nc nd">$ cat .GlobalPreferences.plist<br/>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<br/>&lt;plist version="1.0"&gt;<br/>&lt;dict&gt;<br/>    &lt;key&gt;AppleLanguages&lt;/key&gt;<br/>    &lt;array&gt;<br/>        &lt;string&gt;en&lt;/string&gt;<br/>    &lt;/array&gt;<br/>    &lt;key&gt;AppleLocale&lt;/key&gt;<br/>    &lt;string&gt;en_US&lt;/string&gt;<br/>&lt;/dict&gt;<br/>&lt;/plist&gt;</span></pre><p id="7155" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">定义了一些属性。不要忘记将文件转换回二进制文件:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="afe0" class="mz lp iq li b gy na nb l nc nd">$ plutil -convert binary1 .GlobalPreferences.plist</span></pre><p id="103e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，使用刚刚创建的脚本打开模拟器:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="e416" class="mz lp iq li b gy na nb l nc nd">$ ./ios_simulator_cli.sh my_simulator boot<br/>$ ./ios_simulator_cli.sh my_simulator open</span></pre><p id="815a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在模拟器中导航到设置-&gt;通用，并更改一些设置。例如，从语言和地区到乌克兰语</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/240c3095e13bfb8d875810e9528b5a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*pwVUcCtmLxw3Ih79WKHlUw.png"/></div></figure><p id="50a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关闭模拟器，再次将<code class="fe lf lg lh li b">.GlobalPreferences.plist</code>转换为xml以检查差异。将会有一些变化，包括:</p><ul class=""><li id="12ac" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated"><code class="fe lf lg lh li b">AppleKeyboards</code>键，其值为<code class="fe lf lg lh li b">&lt;string&gt;uk_UA@sw=Ukrainian;hw=Automatic&lt;/string&gt;</code></li><li id="c223" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated"><code class="fe lf lg lh li b">AppleLanguages</code>键，带有<code class="fe lf lg lh li b">&lt;string&gt;uk-US&lt;/string&gt;</code>值</li><li id="9fe5" class="kw kx iq ka b kb lj kf lk kj ll kn lm kr ln kv lb lc ld le bi translated">等等。</li></ul><p id="0f0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这正是我们所需要的，也是可以使用命令行和<code class="fe lf lg lh li b">plutil</code>来改变的。恢复对设置文件的更改，并在bash脚本中定义<code class="fe lf lg lh li b">locale</code>函数:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="ec99" class="mz lp iq li b gy na nb l nc nd">set_locale () {<br/>  LOCALE=$1<br/>  SIMULATOR_ID=$( get_uid )<br/>  PLIST_FILE="$HOME/Library/Developer/CoreSimulator/Devices/$SIMULATOR_ID/data/Library/Preferences/.GlobalPreferences.plist"<br/>  plutil -replace AppleLocale -string $LOCALE $PLIST_FILE<br/>  plutil -replace AppleLanguages -json "[ \"$LOCALE\" ]" $PLIST_FILE<br/>  plutil -replace AppleKeyboards -json '[ "uk_UA@sw=Ukrainian;hw=Automatic" ]' $PLIST_FILE<br/>}</span></pre><p id="5671" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该功能检查模拟器，并使用<code class="fe lf lg lh li b">plutil</code>替换设置文件中的<code class="fe lf lg lh li b">AppleLocale</code>、<code class="fe lf lg lh li b">AppleLanguages</code>和<code class="fe lf lg lh li b">AppleKeyboards</code>键。现在，您可以运行脚本来更改语言并启动模拟器:</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="61a7" class="mz lp iq li b gy na nb l nc nd">$ ./ios_simulator_cli.sh my_simulator locale uk_UA<br/>$ ./ios_simulator_cli.sh my_simulator boot<br/>$ ./ios_simulator_cli.sh my_simulator open</span></pre><p id="a5c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您将获得具有您刚刚定义的语言的模拟器:</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/fbd08efadb37e2daef485a91fbd12748.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*wB-EzTX3Zj_JVpEXO7RcyQ.png"/></div></figure><p id="5803" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，您可以尝试更改其他设置，并为此编写bash脚本函数。</p><h1 id="a41b" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">结论</h1><p id="dc00" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">使用CLI、<code class="fe lf lg lh li b">bash</code>脚本或<code class="fe lf lg lh li b">simctl</code>、<code class="fe lf lg lh li b">plutil</code>等实用程序并不复杂。这样的bash脚本可以简化您的日常工作，特别是如果您想自动化一些流程或使用CI(可以是另一个bash脚本):</p><pre class="mr ms mt mu gt mv li mw mx aw my bi"><span id="f50d" class="mz lp iq li b gy na nb l nc nd">./ios_simulator_cli.sh <!-- -->my_simulator<!-- --> create iPhone-X iOS-11-4<br/>./ios_simulator_cli.sh <!-- -->my_simulator<!-- --> locale uk_UA<br/>....<br/># do some tests<br/>...<br/>./ios_simulator_cli.sh <!-- -->my_simulator<!-- --> delete</span></pre><p id="e2b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你也可以下载<a class="ae ns" href="https://gist.github.com/rumax/2470ec2fcc3ef84420542f049589407e" rel="noopener ugc nofollow" target="_blank">整个剧本</a>并尝试一下。该脚本是用Xcode 9.4编写和测试的。</p></div></div>    
</body>
</html>
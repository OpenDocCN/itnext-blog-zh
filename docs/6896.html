<html>
<head>
<title>Containerize a basic HTML/CSS/JS app with nerdctl &amp; Rancher Desktop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用nerdctl &amp; Rancher桌面容器化一个基本的HTML/CSS/JS应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/containerize-a-basic-html-css-js-app-with-nerdctl-rancher-desktop-817981ede2a4?source=collection_archive---------1-----------------------#2022-04-06">https://itnext.io/containerize-a-basic-html-css-js-app-with-nerdctl-rancher-desktop-817981ede2a4?source=collection_archive---------1-----------------------#2022-04-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/3fd1a107bdbbe1630fb10b283a21e742.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HN5nmUUtH0mvq6hvxonzeA.png"/></div></div></figure><p id="8e86" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">容器📦是在客户的基础设施上部署应用程序及其所有库/依赖项的便捷而安全的方式。在本教程中，我将使用免费工具<a class="ae la" href="https://github.com/containerd/nerdctl" rel="noopener ugc nofollow" target="_blank"> containerd的nerd CTL</a>&amp;<a class="ae la" href="https://rancherdesktop.io/" rel="noopener ugc nofollow" target="_blank">Rancher Desktop</a>(不是Docker Desktop)来容器化一个我使用KaboomJS 编写的基本HTML/CSS/JS应用<a class="ae la" href="https://kaboomjs.com/play?demo=movement" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8cb3" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated"><strong class="ke iv">先决条件:</strong> <a class="ae la" href="https://rancherdesktop.io/" rel="noopener ugc nofollow" target="_blank">自由牧场主桌面</a>，又名<a class="ae la" href="https://jyeee.medium.com/elasticsearch-kibana-on-k8s-w-rancher-desktop-rancher-cluster-manager-2-6-f155c86164c0" rel="noopener">双击为K8s </a>🙌，以获取<a class="ae la" href="https://github.com/containerd/nerdctl" rel="noopener ugc nofollow" target="_blank"> nerdctl </a>和一个本地容器注册表。</p><blockquote class="lb lc ld"><p id="604c" class="kc kd le ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz in bi translated">这里有一个不错的<a class="ae la" href="https://www.youtube.com/watch?v=lYM5lCHhbL8" rel="noopener ugc nofollow" target="_blank">牧场主桌面安装视频</a></p></blockquote><p id="5fab" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">在本教程中，我们将</p><ol class=""><li id="be3e" class="li lj iu ke b kf kg kj kk kn lk kr ll kv lm kz ln lo lp lq bi translated">基于托管JS应用程序的安全nginx非特权映像编写Dockerfile</li><li id="363c" class="li lj iu ke b kf lr kj ls kn lt kr lu kv lv kz ln lo lp lq bi translated">基于docker文件构建容器映像，并运行本地托管的容器映像</li><li id="4324" class="li lj iu ke b kf lr kj ls kn lt kr lu kv lv kz ln lo lp lq bi translated">额外内容:登录Docker Hub(免费)，推送容器映像，运行托管在Docker Hub上的容器映像</li></ol><h1 id="1b56" class="lw lx iu bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">1/3基于托管JS应用程序的安全nginx非特权映像编写Dockerfile</h1><div class="mu mv gq gs mw mx"><a href="https://javascript.plainenglish.io/kaboom-js-repl-it-custom-top-down-shooter-in-5-min-ebad8157073a" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd iv gz z fq nc fs ft nd fv fx it bi translated">使用kaboom.js和repl.it在5分钟内创建一个自定义的自上而下的射手</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">我小时候喜欢玩自上而下的射击游戏，比如《银河战舰》和《太空入侵者》,希望我也能自己定制一款…</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ka mx"/></div></div></a></div><p id="a99b" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">首先克隆我在Kaboom中构建的游戏shooter-jade repo，它模拟了您编写和构建的基本HTML/CSS/JS应用程序。</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="5df3" class="nv lx iu nr b gz nw nx l ny nz">git clone <a class="ae la" href="https://github.com/jwsy/shooter-jade.git" rel="noopener ugc nofollow" target="_blank">https://github.com/jwsy/shooter-jade.git</a><br/>cd shooter-jade</span></pre><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oa"><img src="../Images/d537bb86c5b550db0f3c53a1cb874af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYu_9u24nxo_RPIeliAwjg.png"/></div></div></figure><p id="9145" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">这是我最近添加的一个非常简单的nginx非特权<a class="ae la" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank"> Dockerfile </a>例子(只有下面显示的五行！)将应用程序的文件添加到最小的<a class="ae la" href="https://hub.docker.com/r/nginxinc/nginx-unprivileged" rel="noopener ugc nofollow" target="_blank">nginx-无特权容器映像</a>中。相比之下，nginx:alpine容器图像具有方便但不必要的工具，如vi和wget。</p><blockquote class="lb lc ld"><p id="7e49" class="kc kd le ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz in bi translated">这个other文件中显示的容器的一个重要安全特性是，您必须<em class="iu">显式地公开</em>默认的nginx端口，并且没有其他端口是开放的。</p></blockquote><figure class="nm nn no np gu jv"><div class="bz fq l di"><div class="ob oc l"/></div></figure><h1 id="e90f" class="lw lx iu bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">2/3基于docker文件构建容器映像，并运行本地托管的容器映像</h1><p id="916f" class="pw-post-body-paragraph kc kd iu ke b kf od kh ki kj oe kl km kn of kp kq kr og kt ku kv oh kx ky kz in bi translated">现在您已经有了一个Dockerfile文件，使用它来构建一个容器映像。在这个例子中，我们用我的公共Docker Hub repo<em class="le">jwsy/shooter-jade</em>的名字构建并标记它。你仍然可以在Docker Hub上免费托管图片(相对于你可能需要在工作中付费的Docker桌面应用)<a class="ae la" href="https://hub.docker.com/repository/docker/jwsy/shooter-jade" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/repository/docker/jwsy/shooter-jade</a></p><p id="1a50" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">首先，让我们用<code class="fe oi oj ok nr b">nerdctl images</code>命令看看现有的容器图像。比较当您省略或使用由Rancher Desktop提供的K8s集群中指定容器注册表的<code class="fe oi oj ok nr b">-n k8s.io</code>参数时所看到的内容。现有的注册中心拥有用于运行K8s集群的容器。</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="a482" class="nv lx iu nr b gz nw nx l ny nz">nerdctl images<br/>nerdctl <strong class="nr iv">-n k8s.io</strong> images</span></pre><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ol"><img src="../Images/b2170de991f7d286ea6fce96f62aeda5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPqgsG24oVZlhIQuy1nSnw.png"/></div></div></figure><p id="e532" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">现在构建图像，然后在K8s注册表中的图像列表中查看带有<em class="le"> jwsy/shooter-jade:v1.0 </em>标签的图像</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="5e85" class="nv lx iu nr b gz nw nx l ny nz">nerdctl <strong class="nr iv">-n k8s.io</strong> build . -t jwsy/shooter-jade:v1.0</span></pre><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj om"><img src="../Images/25b0c5b63fbb0e7e536076123eb57cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Onh_4fNrhFsMO-1tSN-Bg.png"/></div></div></figure><p id="6233" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">我们现在可以看到我们的图像，它<em class="le">只占用54.2兆字节</em>！！由于容器的魔力，这比我们曾经创建的任何VM设备映像都要小得多。让我们使用<code class="fe oi oj ok nr b">nerdctl run</code>在本地运行这个本地托管的映像，注意我是如何在本地端口<strong class="ke iv"> 8081 </strong>上公开服务的，目标端口是容器映像公开的端口。</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="7e7c" class="nv lx iu nr b gz nw nx l ny nz">nerdctl -n k8s.io run -d -p <strong class="nr iv">8081</strong>:8080 jwsy/shooter-jade:v1.0</span></pre><p id="6475" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">浏览至<a class="ae la" href="http://localhost:8081" rel="noopener ugc nofollow" target="_blank">http://localhost:<strong class="ke iv">8081</strong></a><strong class="ke iv"/>享受app！</p><blockquote class="lb lc ld"><p id="29ca" class="kc kd le ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz in bi translated">这比摆弄VirtualBox网络设置好多了！</p></blockquote><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj on"><img src="../Images/47e3a300bdda45e7e12d73c8d0e5e6a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7Jpp4nQsGmiyxZS-ZTyaw.png"/></div></div></figure><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="bdc5" class="nv lx iu nr b gz nw nx l ny nz"># See container logs for dca1...<br/>nerdctl -n k8s.io logs dca</span><span id="44d4" class="nv lx iu nr b gz oo nx l ny nz"># Stop &amp; remove this container dca1... <br/>nerdctl -n k8s.io rm dca # or use rm -f to remove it completely</span></pre><h1 id="6d5f" class="lw lx iu bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">3/3奖励内容:登录Docker Hub，推送容器镜像，运行托管在Docker Hub上的容器镜像</h1><p id="722d" class="pw-post-body-paragraph kc kd iu ke b kf od kh ki kj oe kl km kn of kp kq kr og kt ku kv oh kx ky kz in bi translated">登录到<a class="ae la" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub容器注册表</a>🐳📦(你需要注册，但仍然是免费的)，使用<code class="fe oi oj ok nr b">nerdctl login</code>。如果你想推送其他注册中心，包括ECR、ACR、GHCR、GCR等，你也可以阅读这些nerdctl注册中心文档。</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="dd3a" class="nv lx iu nr b gz nw nx l ny nz">nerdctl login -u jwsy</span></pre><p id="b34b" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">登录后，使用<code class="fe oi oj ok nr b">nerdctl push</code>将本地托管的映像推送到Docker Hub。您仍然需要使用<code class="fe oi oj ok nr b">-n k8s.io</code>，因为您使用的是本地容器注册表。</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="a512" class="nv lx iu nr b gz nw nx l ny nz">nerdctl<strong class="nr iv"> -n k8s.io </strong>push jwsy/shooter-jade:v1.0</span></pre><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj op"><img src="../Images/b0ba003965168472afe28ebf3cbe0759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNnVwoV3FlMJ9EOsbdtN3g.png"/></div></div></figure><p id="6b57" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">您的容器图像将显示在Docker Hub</p><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj on"><img src="../Images/e7358c3f93e73a613abf9da2a2b2117d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZrQ0CqD-DvmI5HUM_b90Xg.png"/></div></div></figure><p id="f91e" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">现在，运行托管在Docker Hub上的映像，这次不带<code class="fe oi oj ok nr b">-n k8s.io</code>并在端口<strong class="ke iv"> 8089 </strong>上运行(与本地托管映像的8081相反)。注意nerdctl将如何从Docker Hub下载映像，因为它不存在于非K8s注册表中。</p><pre class="nm nn no np gu nq nr ns nt aw nu bi"><span id="f082" class="nv lx iu nr b gz nw nx l ny nz">nerdctl run -d -p <strong class="nr iv">8089</strong>:8080 jwsy/shooter-jade:v1.0</span></pre><p id="7889" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">浏览到<a class="ae la" href="http://localhost:8089" rel="noopener ugc nofollow" target="_blank"> http://localhost:8089 </a>并享受应用程序！</p><figure class="nm nn no np gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj on"><img src="../Images/6d2c2ae651ba57e9bf93bf0062b2488f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e9qSDYAiQjffuj5oYkp2Ew.png"/></div></div></figure><p id="df25" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">恭喜你！如果您已经做到了这一步，那么您可能想要尝试部署您在Kubernetes集群上创建的这个新映像，您可以使用Rancher Desktop，如下文所示。</p><div class="mu mv gq gs mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/rancher-desktop-and-nerdctl-for-local-k8s-dev-d1348629932a"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd iv gz z fq nc fs ft nd fv fx it bi translated">适用于本地K8s开发的Rancher Desktop和nerdctl</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">我花了相当长的时间(2.6)试图(2.5)为Kubernetes初学者找出(2.4)一个好的本地开发设置(2.3)</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">itnext.io</p></div></div><div class="ng l"><div class="oq l ni nj nk ng nl ka mx"/></div></div></a></div><p id="6cc1" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">如果你有兴趣通过例子探索K8s是如何工作的，那么这篇我们安装Elasticsearch &amp; Kibana的文章可能也会有所帮助。</p><div class="mu mv gq gs mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/elasticsearch-kibana-on-k8s-w-rancher-desktop-rancher-cluster-manager-2-6-f155c86164c0"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd iv gz z fq nc fs ft nd fv fx it bi translated">K8s上的Elasticsearch &amp; Kibana，带有Rancher Desktop &amp; Rancher Cluster Manager 2.6</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">唯一的先决条件:从https://rancherdesktop.io/安装牧场主桌面</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">itnext.io</p></div></div><div class="ng l"><div class="or l ni nj nk ng nl ka mx"/></div></div></a></div><p id="b383" class="pw-post-body-paragraph kc kd iu ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz in bi translated">请考虑加入Medium，并添加您自己的故事来帮助社区！<a class="ae la" href="https://jyeee.medium.com/membership" rel="noopener"> <em class="le">我没想到我简单的研究文章会被成千上万的其他技术人员阅读，但他们的确是——我很高兴我分享了这些！</em> </a></p><div class="mu mv gq gs mw mx"><a href="https://jyeee.medium.com/membership" rel="noopener follow" target="_blank"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd iv gz z fq nc fs ft nd fv fx it bi translated">通过我的推荐链接加入Medium-Jason Yee</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">我不认为我简单的研究文章会被成千上万的其他技术人员阅读，但他们确实是——我很高兴我分享了这些文章！</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">jyeee.medium.com</p></div></div><div class="ng l"><div class="os l ni nj nk ng nl ka mx"/></div></div></a></div></div></div>    
</body>
</html>
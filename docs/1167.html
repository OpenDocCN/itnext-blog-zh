<html>
<head>
<title>I’m making an offline first WordPress PWA, part 7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我正在制作一个离线的第一个WordPress PWA，第7部分</h1>
<blockquote>原文：<a href="https://itnext.io/im-making-an-offline-first-wordpress-pwa-part-7-5d1ee68ec6bd?source=collection_archive---------5-----------------------#2018-08-02">https://itnext.io/im-making-an-offline-first-wordpress-pwa-part-7-5d1ee68ec6bd?source=collection_archive---------5-----------------------#2018-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2f7a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">最佳化</h2></div><p id="6545" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我以前说过，过分依赖客户端渲染违背了我的原则。据说(？)从SEO的角度来看，如果服务器端呈现的HTML看起来像这样，那就没关系了:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="66e2" class="lk ll iq lg b gy lm ln l lo lp">&lt;body&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>&lt;/body&gt;</span></pre><p id="c5a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是从性能的角度来看，这更糟糕，因为在站点上渲染像素需要更长的时间。浏览器应该解析HTML，构建DOM，下载渲染阻塞样式表，稍后还要下载脚本。</p><blockquote class="lq"><p id="1510" class="lr ls iq bd lt lu lv lw lx ly lz la dk translated">浏览器在执行JavaScript代码之前有很多事情要做。在普通的安卓手机上，这需要更长的时间。</p></blockquote><p id="b06d" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">但是JS框架已经在这里了，这让我很有兴趣看看我能以多快的速度写这个博客。<em class="mf">(我会忽略这样一个事实，即实际上存在渲染Vue的解决方案。JS和React在服务器上。)</em></p><h2 id="6102" class="lk ll iq bd mg mh mi dn mj mk ml dp mm ko mn mo mp ks mq mr ms kw mt mu mv mw bi translated">情况</h2><p id="094d" class="pw-post-body-paragraph kf kg iq kh b ki mx jr kk kl my ju kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">Chrome Developer tools的性能审计如下所示:</p><figure class="lb lc ld le gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nc"><img src="../Images/e69b204963d6515471e2700bcb7a30a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uE7G8IhIfhM65f6Sa1dqMQ.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">67/100分，无任何优化</figcaption></figure><p id="27f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在站点开始渲染之前的两秒钟根本不是一个好数字。你更希望在稳定的3G连接下，网站能在三秒钟内感觉到或多或少的满载。</p><p id="59e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据报告，呈现阻塞样式表是最关键的问题。</p><blockquote class="no np nq"><p id="86b9" class="kf kg mf kh b ki kj jr kk kl km ju kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">减少呈现阻塞样式表</p></blockquote><h2 id="0aca" class="lk ll iq bd mg mh mi dn mj mk ml dp mm ko mn mo mp ks mq mr ms kw mt mu mv mw bi translated">自动优化将解决一切</h2><p id="ff98" class="pw-post-body-paragraph kf kg iq kh b ki mx jr kk kl my ju kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated">我之前已经放弃了几次WordPress插件<a class="ae nu" href="https://wordpress.org/plugins/autoptimize/" rel="noopener ugc nofollow" target="_blank">自动优化</a>。它实际上是我最喜欢的插件之一，因为它以一种简单的方式解决了多个问题。</p><p id="596a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自动优化将为你缩小HTML，JavaScript和CSS。它还会将<code class="fe nv nw nx lg b">defer</code>属性添加到<code class="fe nv nw nx lg b">&lt;script&gt;</code>标签中，并将它们移动到HTML文档的底部。</p><p id="9eaf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是自动优化真正强大的地方在于它可以帮助你进行“折叠以上”的优化。它在<code class="fe nv nw nx lg b">&lt;head&gt;</code>中注入关键的CSS并延迟加载样式表。<br/>你需要自己做的“唯一一件事”就是生成关键CSS，但这可以通过在线工具<a class="ae nu" href="https://jonassebastianohlsson.com/criticalpathcssgenerator/" rel="noopener ugc nofollow" target="_blank">关键路径CSS生成器</a>相当简单地完成。</p><figure class="lb lc ld le gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ny"><img src="../Images/c81b2d3322eea563f00385db29192eb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EFtpvmvQOzUYQaPA4XEL4g.png"/></div></div></figure><p id="969a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将生成的CSS复制并粘贴到自动优化的设置页面:</p><figure class="lb lc ld le gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nz"><img src="../Images/3f1b1270ffdd3d0ddbc9822608419e5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oCjzLjjhBdmF1JADPcncw.png"/></div></div></figure><p id="441c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">开发人员工具中的结果如下所示:</p><figure class="lb lc ld le gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi oa"><img src="../Images/b199a7aac1929fb7e123edb5877f6f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sWVWNCdtSYQvDfzMhBhcgA.png"/></div></div></figure><p id="8103" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我多次重新加载页面并确保服务人员更新了缓存时，我在性能审计中获得了以下分数:</p><figure class="lb lc ld le gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ob"><img src="../Images/c684617010f69d194f866a64e7e3863a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4DaD1ZRw52SMM3JUR1hERA.png"/></div></div></figure><p id="b91d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">93/100的客户端渲染应用程序！但我怀疑这有点异想天开。这个博客只有两个帖子，每个帖子都包含几个句子。在现实生活中，博客上肯定会有大量的图片。对加载速度有很大影响并会增加JavaScript执行等待时间的图片…</p><p id="d673" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我将把这个故事留到以后再讲，并在这里结束这个系列。感谢您花时间通读这个系列，我希望您已经学到了一些东西。我当然有！</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="a775" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以前的零件:</p><ul class=""><li id="d065" class="oj ok iq kh b ki kj kl km ko ol ks om kw on la oo op oq or bi translated">第一部分:HTTPS </li><li id="17b3" class="oj ok iq kh b ki os kl ot ko ou ks ov kw ow la oo op oq or bi translated">第二部分:Manifest.json </li><li id="36ac" class="oj ok iq kh b ki os kl ot ko ou ks ov kw ow la oo op oq or bi translated"><a class="ae nu" href="https://medium.com/@stefanledin/im-making-an-offline-first-wordpress-pwa-part-3-1ddf61891121" rel="noopener">第3部分:带工具箱的服务人员</a></li><li id="7300" class="oj ok iq kh b ki os kl ot ko ou ks ov kw ow la oo op oq or bi translated"><a class="ae nu" href="https://medium.com/@stefanledin/im-making-an-offline-first-wordpress-pwa-part-4-be2d06e6ff28" rel="noopener">第四部分:应用外壳模型</a></li><li id="db41" class="oj ok iq kh b ki os kl ot ko ou ks ov kw ow la oo op oq or bi translated"><a class="ae nu" href="https://medium.com/@stefanledin/im-making-an-offline-first-wordpress-pwa-part-5-e3293faefb88" rel="noopener">第五部分:先下线</a></li><li id="ff9c" class="oj ok iq kh b ki os kl ot ko ou ks ov kw ow la oo op oq or bi translated"><a class="ae nu" rel="noopener ugc nofollow" target="_blank" href="/im-making-an-offline-first-wordpress-pwa-part-6-1f4beea6e641">第六部分:单页App </a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Integrating Blockchain-based Code Signing into Your Application Using Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Golang将基于区块链的代码签名集成到您的应用中</h1>
<blockquote>原文：<a href="https://itnext.io/integrating-blockchain-based-code-signing-into-your-application-using-golang-2ba5aaef96d6?source=collection_archive---------3-----------------------#2019-06-26">https://itnext.io/integrating-blockchain-based-code-signing-into-your-application-using-golang-2ba5aaef96d6?source=collection_archive---------3-----------------------#2019-06-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6429b20beb6ad134220922fcbbadb6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*hDFuuCC3C62BMMMY.png"/></div></figure><h1 id="93b9" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">介绍</h1><p id="6e1b" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">了解您的数字资产是否可以安全使用，将有助于您避免在开发、测试和生产环境中运行的受损或错误代码带来的复杂性。这篇博客将带您了解使用Golang将基于区块链的代码签名集成到您的应用程序中的过程。</p><h1 id="a646" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">签署资产</h1><p id="be5e" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为了让您的应用程序验证您想要使用的资产，需要对这些资产进行签名，并将其签名存储在区块链上。这样，无论托管服务或存储位置如何，它们都可以被全局引用。但是，在开始签署资产之前，您需要准备一些东西。</p><h1 id="ddc9" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">先决条件</h1><p id="04eb" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">首先，您需要创建您的code公证人帐户，您可以这样做，并观看如何做的视频。一旦您设置了帐户，您将能够开始使用code公证人<code class="fe lq lr ls lt b">vcn</code> CLI工具签署资产。下一步是准备您的<code class="fe lq lr ls lt b">vcn</code>配置，您可以简单地通过运行<code class="fe lq lr ls lt b">vcn login</code>来完成。第一次执行该命令时，将使用配置创建一个<code class="fe lq lr ls lt b">$HOME/.vcn</code>文件夹，并为您生成一个用户密钥。更多细节，请查看我们的GitHub用户配置指南。另外，你要确保<code class="fe lq lr ls lt b">$HOME~/.vcn</code>文件夹可以被你正在编写的程序访问。</p><h1 id="53cc" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">在Go代码中使用资产签名</h1><p id="1c83" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们创建<code class="fe lq lr ls lt b">vcn</code>是为了能够在单个应用程序的代码结构中直接使用。提取一个像<code class="fe lq lr ls lt b">vcn</code>这样的全局验证检查器并直接放入你的项目中，这样你就可以配置它在你需要或想要的时候运行。</p><p id="5c7b" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">要在代码中包含资产签名，请使用下面的代码片段:</p><pre class="lz ma mb mc gt md lt me mf aw mg bi"><span id="6fe1" class="mh jv iq lt b gy mi mj l mk ml">package main<br/><br/>import (<br/>    "fmt"<br/> <br/>    <a class="ae mm" href="http://github.com/vchain-us/vcn/pkg/api" rel="noopener ugc nofollow" target="_blank">github.com/vchain-us/vcn/pkg/api</a>"<br/>    <a class="ae mm" href="http://github.com/vchain-us/vcn/pkg/meta" rel="noopener ugc nofollow" target="_blank">github.com/vchain-us/vcn/pkg/meta</a>"<br/>    <a class="ae mm" href="http://github.com/vchain-us/vcn/pkg/store" rel="noopener ugc nofollow" target="_blank">github.com/vchain-us/vcn/pkg/store</a>"<br/>)<br/><br/>func init() {<br/>    // Set ~/.vcn directory<br/>    if err := store.SetDefaultDir(); err != nil {<br/>        panic(err)  <br/> <br/>    // Load the configuration<br/>    if err := store.LoadConfig(); err != nil {<br/>        panic(err) <br/>}<br/><br/>// currentUser returns the current authenticated vcn user, if any, <br/>otherwise an error is returned<br/>func currentUser() (*api.User, error) {<br/>    email := store.Config().CurrentContext<br/>    if email == "" {<br/>        return nil, fmt.Errorf("no user has been set for current context")<br/>}<br/>    u := api.NewUser(email)<br/>    return u, nil<br/>}<br/><br/>func main() {<br/>    passphrase := "&lt;passphrase here&gt;"<br/>    // Get the current user<br/>    user, err := currentUser()<br/>    if err != nil {<br/>        panic(err) <br/>     <br/>    // Create a fake asset<br/>    asset := api.Artifact{<br/>        Name: "&lt;asset name here&gt;",<br/>        Hash: "&lt;my hash here&gt;",<br/>        Size: 11, // a size &gt; 0 is required <br/>     <br/>    verification, err := user.Sign(<br/>        asset,<br/>        user.DefaultKey(), // get and use the default key, optionally another key can be used<br/>        passphrase,<br/>        meta.StatusTrusted,     // other status (meta.StatusUntrusted, meta.StatusUnsupported) can be used too<br/>        meta.VisibilityPrivate, // or meta.VisibilityPublic <br/>    if err != nil {<br/>        panic(err) <br/>}<br/>     fmt.Println("Asset has been successfully signed with Status: ", meta.StatusName(verification.Status))<br/>}</span></pre><h1 id="1956" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">它是如何工作的</h1><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/3f0e461facc0adad6a6821ec1e6c0318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*faQqHXs0jehVbFmF6emyxw.png"/></div></div></figure><p id="0519" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated"><code class="fe lq lr ls lt b">github.com/vchain-us/vcn/pkg/api</code>包让你可以访问所有的底层功能。</p><p id="bd12" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated"><code class="fe lq lr ls lt b">github.com/vchain-us/vcn/pkg/storepackage</code>拉进<code class="fe lq lr ls lt b">vcn</code> API，允许你直接写区块链。</p><p id="1057" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">然后<code class="fe lq lr ls lt b">store.SetDefaultDir</code>设置您的默认目录，您将在本地存储您的资产签名。然后<code class="fe lq lr ls lt b">store.LoadConfig</code>将在本地设置配置，使您能够写入区块链。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ms"><img src="../Images/49690360f39268a3703c6307a93313d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UAM9iom4QO3Zf8xZkQlz0Q.png"/></div></div></figure><p id="0702" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">接下来，您需要创建函数<code class="fe lq lr ls lt b">currentUser</code>来验证当前的<code class="fe lq lr ls lt b">vcn</code>用户是否存在于系统中。如果输入的信息是正确的，那么允许用户继续，否则，返回一个错误。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mt"><img src="../Images/ccd38de5777295a827fc6fc2de0ab15e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_wkAVc4NwHe8Q6bZ4nVsw.png"/></div></div></figure><p id="4eaa" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">在设置路径以检查您的用户信息是否存储在系统中之后，您需要创建一个允许您输入密码的函数，这将使您能够对资产进行签名并将其哈希写入区块链。然后,<code class="fe lq lr ls lt b">vcn</code>应用程序会将之前输入的<code class="fe lq lr ls lt b">currentUser</code>与输入的密码相匹配。如果成功，系统将允许您继续操作。否则，将返回一个错误。</p><p id="b5f7" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">下一步是选择您想要加载以便以后签名的资产。(如果您只是测试功能，也可以创建一个假资产。)但是首先，您需要设置输出字段，以便正确存储新签名资产的名称、散列和大小，供<code class="fe lq lr ls lt b">api.Artifact</code>函数将创建的数据插入其中。</p><p id="fe0e" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">你可以在<a class="ae mm" href="https://godoc.org/github.com/vchain-us/vcn/pkg/api#Artifact." rel="noopener ugc nofollow" target="_blank">https://godoc . org/github . com/vchain-us/vcn/pkg/API # Artifact阅读更多关于我们Go文档中所有字段的信息。</a></p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mu"><img src="../Images/f18dca3332e13b753ab514d7e5381848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a54kPGzcHs2b_EXAlX-kFw.png"/></div></div></figure><p id="920a" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">一旦您的字段被设置为存储您的签名工件，您需要获得您第一次使用<code class="fe lq lr ls lt b">vcn login</code>登录时系统为您生成的密钥，默认情况下，该密钥存储在<code class="fe lq lr ls lt b">~/.vcn</code>文件夹中。(如果您愿意，您也可以选择使用另一个密钥进行签名，尽管您必须专门指定它。)在您告诉系统在签名过程中使用哪个密钥之后，您需要指定允许您的密钥用于签名资产的密码短语。</p><p id="9ebc" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">如果一切顺利，系统会将指定的<code class="fe lq lr ls lt b">meta.Status</code>和<code class="fe lq lr ls lt b">meta.Visibility</code>添加到您的签名中。您应该看到的输出是如下例所示的打印行:</p><p id="2217" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated"><code class="fe lq lr ls lt b">Asset has been successfully signed with Status: TRUSTED</code></p><h1 id="6ff3" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="eb49" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为您的应用程序添加对您创建或使用的数字资产进行签名的功能，可让您从区块链的不变性中获益，并确保您的代码、组件、应用程序等与您离开时一样安全。</p><p id="b735" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">关于我们整个<code class="fe lq lr ls lt b">vcn</code>项目的信息可以在我们的GitHub资源库中找到，您可以通过下面的链接查看。</p><p id="585a" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated"><a class="ae mm" href="https://github.com/vchain-us" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir">带我去GitHub回购</strong> </a></p><p id="8129" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated">或者</p><p id="5677" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated"><a class="ae mm" href="https://www.codenotary.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir">了解更多详情</strong></a></p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="b4ff" class="pw-post-body-paragraph ks kt iq ku b kv lu kx ky kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp ij bi translated"><em class="nc">原载于2019年6月26日</em><a class="ae mm" href="https://www.codenotary.io/integrating-blockchain-based-code-signing-into-your-application-using-golang/" rel="noopener ugc nofollow" target="_blank"><em class="nc">https://www . code公证人. io </em> </a> <em class="nc">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Ultimate Local Development Setup with Angular, Firebase &amp; Stripe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有角形、火基和条纹的终极本地开发设置</h1>
<blockquote>原文：<a href="https://itnext.io/ultimate-local-development-setup-with-angular-firebase-stripe-fcc6fca3543c?source=collection_archive---------6-----------------------#2021-12-05">https://itnext.io/ultimate-local-development-setup-with-angular-firebase-stripe-fcc6fca3543c?source=collection_archive---------6-----------------------#2021-12-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c55a0fb605548e73c4fad6a5aad87012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i8rCu6l3M0QnFB67y84nFw.png"/></div></div></figure><p id="f408" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">建立一个电子商务网站是一项复杂的任务。尤其是当您有不同的服务需要相互通信时。这是一个场景，您没有在本地为开发做好一切准备。</p><p id="a115" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如题，用来创建一个电子商务网站的栈是</p><ul class=""><li id="409c" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated"><a class="ae li" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank">棱角分明的</a> —前端</li><li id="a4c7" class="kz la it kd b ke lj ki lk km ll kq lm ku ln ky le lf lg lh bi translated"><a class="ae li" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a> —认证+数据库+存储+ API</li><li id="64cb" class="kz la it kd b ke lj ki lk km ll kq lm ku ln ky le lf lg lh bi translated"><a class="ae li" href="https://stripe.com/en-ca" rel="noopener ugc nofollow" target="_blank">条纹</a> —支付处理</li></ul><p id="461e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">没有本地开发能力</strong></p><p id="0f99" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你应该设置本地开发的大部分原因是<strong class="kd iu">节省时间</strong>，而<strong class="kd iu">时间</strong>是$$$。</p><ul class=""><li id="a8ef" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">直接对firebase项目进行身份验证</li><li id="5125" class="kz la it kd b ke lj ki lk km ll kq lm ku ln ky le lf lg lh bi translated">如果你正在使用Webhook，云功能的部署需要时间和金钱——尤其是对于初学者</li><li id="cf1b" class="kz la it kd b ke lj ki lk km ll kq lm ku ln ky le lf lg lh bi translated">数据库活动正在吞噬你的免费轮胎——你不应该处理生产数据</li></ul><p id="1ff3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">没有本地开发能力</strong></p><p id="c5f1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在当地发生的事情，留在当地——而不是用于开发的条纹支付记录。</p><h2 id="e30f" class="lo lp it bd lq lr ls dn lt lu lv dp lw km lx ly lz kq ma mb mc ku md me mf mg bi translated">角度和火焰模拟器设置</h2><p id="ea63" class="pw-post-body-paragraph kb kc it kd b ke mh kg kh ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky im bi translated">我不打算详细介绍如何创建一个新的角度项目。假设您的package.json中已经有了一个带有<code class="fe mm mn mo mp b">@angular/fire</code>的Angular项目</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="4225" class="lo lp it mp b gy my mz l na nb">// app.module.ts</span><span id="bb17" class="lo lp it mp b gy nc mz l na nb">import { AngularFireAuthModule, USE_EMULATOR as USE_AUTH_EMULATOR } from '@angular/fire/auth'</span><span id="a4ff" class="lo lp it mp b gy nc mz l na nb">import { AngularFirestoreModule, USE_EMULATOR as USE_FIRESTORE_EMULATOR } from '@angular/fire/firestore'</span><span id="4720" class="lo lp it mp b gy nc mz l na nb">import { AngularFireFunctionsModule, USE_EMULATOR as USE_FUNCTIONS_EMULATOR } from '@angular/fire/functions'</span><span id="86b3" class="lo lp it mp b gy nc mz l na nb">....</span><span id="f1f2" class="lo lp it mp b gy nc mz l na nb">providers: [<br/>    AuthService,<br/>    {<br/>      provide: USE_AUTH_EMULATOR,<br/>      useValue: environment.useEmulators ? ['localhost', 9099] : undefined,<br/>    },<br/>    {<br/>      provide: USE_FIRESTORE_EMULATOR,<br/>      useValue: environment.useEmulators ? ['localhost', 8080] : undefined,<br/>    },<br/>    {<br/>      provide: USE_FUNCTIONS_EMULATOR,<br/>      useValue: environment.useEmulators ? ['localhost', 5001] : undefined,<br/>    },<br/>  ],</span></pre><p id="3131" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">确保检查<code class="fe mm mn mo mp b">firebase.json</code>文件中的<a class="ae li" href="https://firebase.google.com/docs/emulator-suite" rel="noopener ugc nofollow" target="_blank">仿真器</a>端口。</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="21b3" class="lo lp it mp b gy my mz l na nb">// firebase.json</span><span id="b7d6" class="lo lp it mp b gy nc mz l na nb">"emulators": {<br/>    "firestore": {<br/>      "port": "8080"<br/>    },<br/>    "ui": {<br/>      "enabled": true,<br/>      "host": "localhost",<br/>      "port": 4001<br/>    },<br/>    "functions": {<br/>      "port": "5001"<br/>    },<br/>    "database": {<br/>      "port": "9000"<br/>    },<br/>    "pubsub": {<br/>      "port": "8085"<br/>    },<br/>    "auth": {<br/>      "port": 9099<br/>    },<br/>    "hosting": {<br/>      "port": 5000<br/>    }<br/>  }</span></pre><p id="8a7f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，当您为firebase函数运行模拟器时，Angular项目将使用本地模拟器来处理身份验证、数据库、函数…</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="6c40" class="lo lp it mp b gy my mz l na nb">firebase emulators:start</span></pre><h2 id="d63c" class="lo lp it bd lq lr ls dn lt lu lv dp lw km lx ly lz kq ma mb mc ku md me mf mg bi translated">条带设置</h2><p id="e448" class="pw-post-body-paragraph kb kc it kd b ke mh kg kh ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky im bi translated">首先，您需要安装<a class="ae li" href="https://stripe.com/docs/stripe-cli" rel="noopener ugc nofollow" target="_blank"> Stripe CLI </a>并使用<code class="fe mm mn mo mp b">stripe login</code>进行认证。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/4b5542a4ac5163bb3da6017bf3a67af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLl6RRnirLnnM_oSKRuZVQ.png"/></div></div></figure><p id="6ba9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将事件转发到本地服务器</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="f8cb" class="lo lp it mp b gy my mz l na nb">dalenguyen$ stripe listen --forward-to localhost:5000/api-stripe</span><span id="df80" class="lo lp it mp b gy nc mz l na nb">A newer version of the Stripe CLI is available, please update to: v1.7.8<br/>&gt; Ready! Your webhook signing secret is whsec_gD8ixxxnxxxg1tv (^C to quit)</span></pre><p id="02eb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，您可以通过本地触发器触发事件</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="b69d" class="lo lp it mp b gy my mz l na nb">dalenguyen$ stripe trigger payment_intent.created</span><span id="fed6" class="lo lp it mp b gy nc mz l na nb">A newer version of the Stripe CLI is available, please update to: v1.7.8<br/>Setting up fixture for: payment_intent<br/>Trigger succeeded! Check dashboard for event details.</span><span id="06b2" class="lo lp it mp b gy nc mz l na nb">----&gt; on another terminal</span><span id="4a08" class="lo lp it mp b gy nc mz l na nb">2021-11-21 10:34:54   --&gt; payment_intent.created [evt_3JyI49ESKh0WH3011opuksXb]<br/>2021-11-21 10:34:54  &lt;--  [200] POST <a class="ae li" href="http://localhost:5000/api-stripe" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/api-stripe</a> [evt_3JyI49ESKh0WH3011opuksXb]</span><span id="4957" class="lo lp it mp b gy nc mz l na nb">----&gt; on firebase functions log</span><span id="6ab4" class="lo lp it mp b gy nc mz l na nb">i  functions: Beginning execution of "us-central1-api-stripe"<br/>&gt;  stripeObjectid pi_3JyI49ESKh0WH3011Hl3lDrr<br/>i  functions: Finished "us-central1-api-stripe" in ~1s</span></pre><p id="8a46" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，一切准备发展。一切都发生在你的机器上。</p><h2 id="a234" class="lo lp it bd lq lr ls dn lt lu lv dp lw km lx ly lz kq ma mb mc ku md me mf mg bi translated">测试条纹网钩</h2><p id="e7a1" class="pw-post-body-paragraph kb kc it kd b ke mh kg kh ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky im bi translated">当您将事件转发到本地计算机时。所有的webhooks事件都将被转发给Firebase模拟器函数。</p><p id="8cd2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，您创建了一个条带结帐会话，他们为该会话付费。然后，将从条带仪表板触发webhooks。然后在您的本地机器上，该事件将在您的Stripe终端和firebase模拟器函数上被触发。</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="280b" class="lo lp it mp b gy my mz l na nb">---&gt; stripe terminal</span><span id="a076" class="lo lp it mp b gy nc mz l na nb">2021-11-21 11:25:52   --&gt; customer.created [evt_1JyIrUESKh0WH301SrYeIZkg]<br/>2021-11-21 11:25:52   --&gt; payment_intent.succeeded [evt_3JyIpzESKh0WH3011OWfb84B]<br/>2021-11-21 11:25:53   --&gt; charge.succeeded [evt_3JyIpzESKh0WH30115gKa8GM]<br/>2021-11-21 11:25:53   --&gt; checkout.session.completed [evt_1JyIrVESKh0WH301osTVBhQI]<br/>2021-11-21 11:25:54  &lt;--  [200] POST <a class="ae li" href="http://localhost:5000/api-stripe" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/api-stripe</a> [evt_1JyIrUESKh0WH301SrYeIZkg]<br/>2021-11-21 11:25:54  &lt;--  [200] POST <a class="ae li" href="http://localhost:5000/api-stripe" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/api-stripe</a> [evt_3JyIpzESKh0WH30115gKa8GM]<br/>2021-11-21 11:25:54  &lt;--  [200] POST <a class="ae li" href="http://localhost:5000/api-stripe" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/api-stripe</a> [evt_3JyIpzESKh0WH3011OWfb84B]<br/>2021-11-21 11:25:54  &lt;--  [200] POST <a class="ae li" href="http://localhost:5000/api-stripe" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/api-stripe</a> [evt_1JyIrVESKh0WH301osTVBhQI]</span></pre><p id="1a60" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae li" href="https://twitter.com/dale_nguyen" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">在Twitter上关注我</strong> </a>获取Angular、JavaScript &amp; WebDevelopment的最新内容👐</p></div></div>    
</body>
</html>
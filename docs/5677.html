<html>
<head>
<title>The VotingApp Reloaded</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VotingApp重新加载</h1>
<blockquote>原文：<a href="https://itnext.io/the-votingapp-reloaded-e4f237b8f3bf?source=collection_archive---------2-----------------------#2021-04-30">https://itnext.io/the-votingapp-reloaded-e4f237b8f3bf?source=collection_archive---------2-----------------------#2021-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8221" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对这个演示应用程序的增强概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f8bad72e78be7e11730ad075402cdede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPDvGc1KLBVxgWAdYaTLkA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">乔安娜·科辛斯卡在<a class="ae ky" href="https://unsplash.com/s/photos/presentation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="31c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我在其他文章中使用(并将使用)VotingApp来说明不同种类的容器相关技术一样，我将在这里介绍整个应用程序和最近完成的增强。为了避免太多的重复，我将引用其他人的这篇文章。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="56b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/dockersamples/example-voting-app" rel="noopener ugc nofollow" target="_blank"> VotingApp </a>是Docker创建的一个演示微服务应用程序，它主要用于演示Docker和Kubernetes的功能。基本上，它允许用户从一个web界面投票，并从另一个界面查看结果。</p><div class="kj kk kl km gt ab cb"><figure class="mc kn md me mf mg mh paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/0877035e8e41a9f8b35571c2b8e8236f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*2rhnRsO76ZACzqmWIahu7Q.png"/></div></figure><figure class="mc kn mi me mf mg mh paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/41c01da14df79e23f3a8f2dce596d199.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*AgEfUfd0IgLg1YEXP-A1xg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk mj di mk ml translated">投票看看结果。简单却非常有趣</figcaption></figure></div><p id="aa4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔥这个应用程序没有遵循所有最好的微服务架构模式，但它绝对非常适合演示和展示，因为它使用了几种语言、不同的组件，并且非常容易理解:)</p><p id="2f8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最初的应用程序被托管在一个单独的GitHub库中，但是为了展示额外的功能(并对整个应用程序进行增强),我在<a class="ae ky" href="https://gitlab.com/voting-application" rel="noopener ugc nofollow" target="_blank"> GitLab </a>中创建了它的新的(非官方的)家，其中每个微服务都有自己的库。添加了一个额外的<a class="ae ky" href="https://gitlab.com/voting-application/config" rel="noopener ugc nofollow" target="_blank">配置库</a>，它定义了应用程序:</p><ul class=""><li id="a6a1" class="mm mn it lb b lc ld lf lg li mo lm mp lq mq lu mr ms mt mu bi translated">使用Docker合成文件</li><li id="5f4b" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated">使用yaml规范</li><li id="74fd" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated">通过<a class="ae ky" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank">舵</a>图</li><li id="aec9" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated">通过<a class="ae ky" href="https://kustomize.io/" rel="noopener ugc nofollow" target="_blank">切槽</a>结构</li></ul><p id="1da9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">VotingApp现在有3个不同的版本，让我们看看每个版本之间的主要区别。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="71bd" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated"><strong class="ak">版本1 </strong></h2><p id="31f1" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">下面的模式说明了VotingApp v1(应用程序的原始版本)的全局架构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/14ec036d790dec20040623527113501f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zLe_I4aDD68eaxkW.png"/></div></div></figure><p id="b52b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是每个微服务的详细信息:</p><ul class=""><li id="7400" class="mm mn it lb b lc ld lf lg li mo lm mp lq mq lu mr ms mt mu bi translated"><strong class="lb iu">投票</strong>:用Python开发的前端，它允许用户在猫和狗之间选择</li><li id="c241" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated">redis :储存选票的数据库</li><li id="f07c" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated">worker :从Redis获取投票并将结果存储在Postgres数据库中的服务。一个Java，。现在这个服务已经有了Rust版本(感谢托马斯·卡斯特利的最后一个版本)</li><li id="c21d" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><strong class="lb iu">db</strong>:Postgres数据库，工作人员在其中合并投票</li><li id="7fc8" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><strong class="lb iu">结果</strong>:node . js开发的前端，显示投票结果</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="0096" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated"><strong class="ak">第二版</strong></h2><p id="60ae" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">v2版本是v1的增强版。它基本上将前端和它们所依赖的后端分离开来。以下架构说明了VotingApp v2的全局架构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/756fd06aec5b945262ee7bbd17af2f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*evTDUJHxcN-BT0NRYVJkxw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">VotingApp版本2将前端/后端解耦</figcaption></figure><p id="e51e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它仍然使用<code class="fe oc od oe of b">redis</code>、<code class="fe oc od oe of b">db</code>和<code class="fe oc od oe of b">worker</code>微服务，但是<code class="fe oc od oe of b">vote</code>和<code class="fe oc od oe of b">result</code>已经被修改/拆分:</p><ul class=""><li id="1b8d" class="mm mn it lb b lc ld lf lg li mo lm mp lq mq lu mr ms mt mu bi translated"><strong class="lb iu">vote-ui</strong>:vue js中的前端，允许用户选择一个项目</li><li id="3f60" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><strong class="lb iu">投票</strong>:后端用Python / Flask公开一个API</li><li id="67a3" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><strong class="lb iu">结果</strong>:后端通过websocket向UI发送分数</li><li id="be48" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><strong class="lb iu"> result-ui </strong>:前端角度显示投票结果</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="fac9" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated"><strong class="ak">第三版</strong></h2><p id="b786" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">这个v3版本使用了一些v2组件，但是数据库和<code class="fe oc od oe of b">worker</code>部分已经被替换为<a class="ae ky" href="https://nats.io/" rel="noopener ugc nofollow" target="_blank"> NATS </a>，以确保<code class="fe oc od oe of b">vote</code>和<code class="fe oc od oe of b">result</code>之间的通信的发布/订阅。以下模式说明了VotingApp v3的全局架构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f1dbbba408e65fe41f23aa637b14507e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQzci2n9-zPB9JwrXS3kaQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">VotingApp版本3使用NATS作为发布/订阅</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="d9a3" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">摘要</h2><p id="ed0a" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">本文仅介绍VotingApp及其新架构。在以后的文章中，我们将使用这个应用程序来说明许多有趣的概念和工具。有些文章已经有了:</p><ul class=""><li id="c1ae" class="mm mn it lb b lc ld lf lg li mo lm mp lq mq lu mr ms mt mu bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/k8s-tips-manifests-helm-kustomize-12f72f878022">使用原始清单、Helm和Kustomize部署VotingApp】</a></li><li id="384e" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/docker-kaniko-buildah-209abdde5f94"> Docker、Kaniko、Buildah构建图像</a></li><li id="7d25" class="mm mn it lb b lc mv lf mw li mx lm my lq mz lu mr ms mt mu bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/deploying-the-votingapp-on-shipa-2af9c6097bb3">在Shipa上部署voting app</a></li></ul><p id="becc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">敬请期待下期:)</p></div></div>    
</body>
</html>
<html>
<head>
<title>Chat in 30 minutes with ReactNative and Firebase, seriously! Pt. 1.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在30分钟内与ReactNative和Firebase聊天，认真！角。1.</h1>
<blockquote>原文：<a href="https://itnext.io/chat-in-30-minutes-with-reactnative-and-firebase-seriously-pt-1-1712a18f7c8a?source=collection_archive---------0-----------------------#2019-05-03">https://itnext.io/chat-in-30-minutes-with-reactnative-and-firebase-seriously-pt-1-1712a18f7c8a?source=collection_archive---------0-----------------------#2019-05-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c0c0a0111993520240f1337c07766c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRZMtQogufnpFUTVWJYnFg.jpeg"/></div></div></figure></div><div class="ab cl jy jz hu ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ij ik il im in"><p id="bf38" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><em class="ld">结语。</em></p><p id="2ed3" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><em class="ld">聊天功能几乎是每个现代应用程序的必备功能，前端开发人员常常无法与陌生的后端人员完成这项任务:)</em></p><p id="e166" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">如果我告诉你，你不需要一个后端的家伙呢？</p><p id="df3f" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">如果我告诉你，你可以在15分钟内完成最低限度的一对一聊天，会怎么样？</p><p id="f3b6" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">如果我告诉你这对你的客户来说会便宜很多呢？</p><p id="14aa" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们的目标:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/ffe5f0df8dad18e4ee3ee35df851bc7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pCV152ky-64BfMF8eZvFEg.gif"/></div></div></figure></div><div class="ab cl jy jz hu ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ij ik il im in"><h1 id="06af" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">第一集。设置</h1><p id="ac24" class="pw-post-body-paragraph kf kg iq kh b ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky ml la lb lc ij bi translated">我们需要从包装中得到什么？</p><ol class=""><li id="df8a" class="mm mn iq kh b ki kj km kn kq mo ku mp ky mq lc mr ms mt mu bi translated">react-native-firebase  —它将是我们的后端和发布-订阅主机(Websockets)。你可以在这里找到包裹<a class="ae mv" href="https://github.com/invertase/react-native-firebase" rel="noopener ugc nofollow" target="_blank"/>。我们需要为iOS的Firebase应用程序初始化<code class="fe mw mx my mz b">CocoaPods</code>。</li><li id="c4b3" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated">lodash——只是为了让我们的代码更干净。你可以在这里找到包裹<a class="ae mv" href="https://github.com/lodash/lodash" rel="noopener ugc nofollow" target="_blank"/>。</li></ol><p id="5ae2" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">因此，让我们从初始化一个空项目开始:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="ce34" class="nj lk iq mz b gy nk nl l nm nn">react-native init SimpleChat</span></pre><p id="ae7e" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在直接添加所需的包:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="a72e" class="nj lk iq mz b gy nk nl l nm nn">yarn add lodash &amp;&amp; yarn add firebase</span></pre><p id="ef1c" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kh ir">重要提示:</strong>暂时不要做<code class="fe mw mx my mz b">react-native link</code>！</p><p id="f6ed" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kh ir">安卓</strong></p><p id="a651" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><a class="ae mv" href="https://rnfirebase.io/docs/v5.x.x/installation/android" rel="noopener ugc nofollow" target="_blank">官方安装指南</a>。你最好使用官方的安装指南，因为它足够详细。</p><p id="d16e" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kh ir"> iOS </strong></p><p id="5c7b" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><a class="ae mv" href="https://rnfirebase.io/docs/v5.x.x/installation/ios" rel="noopener ugc nofollow" target="_blank">官方安装指南</a>或者你可以进一步阅读，我们打算一步一步来做这个。</p><p id="412d" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">好了，既然Android已经设置好了，我们可以从<code class="fe mw mx my mz b">CocoaPods</code>开始。我会假设你正在使用<code class="fe mw mx my mz b">Mac</code>或者你已经安装了<code class="fe mw mx my mz b">Ruby</code> <em class="ld">(是的，它还没有死)。</em>如果没有，请按照此处<a class="ae mv" href="https://rvm.io" rel="noopener ugc nofollow" target="_blank">的说明</a>安装<code class="fe mw mx my mz b">RVM</code>和<code class="fe mw mx my mz b">Ruby</code>。</p><p id="ced5" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">初始化<code class="fe mw mx my mz b">CocoaPods</code>，更多关于如何安装<code class="fe mw mx my mz b">CocoaPods</code>的细节你可以在这里找到<a class="ae mv" href="https://cocoapods.org" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="2944" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">导航到您的<code class="fe mw mx my mz b">/ios</code>文件夹，然后运行:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="def8" class="nj lk iq mz b gy nk nl l nm nn">pod init</span></pre><p id="25d4" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">你会看到现在<code class="fe mw mx my mz b">/ios</code>文件夹里有<code class="fe mw mx my mz b">Podfile</code>(<code class="fe mw mx my mz b">CocoaPods</code>世界里的<code class="fe mw mx my mz b">package.json</code>模拟)和<code class="fe mw mx my mz b">SimpleChat.xcworkspace</code>。这意味着您的项目现在已经安装了<code class="fe mw mx my mz b">CocoaPods</code>。</p><p id="a6a7" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kh ir">重要提示:</strong>如果你正在使用Xcode，请点击<code class="fe mw mx my mz b">SimpleChat.xcworkspace</code>而不是<code class="fe mw mx my mz b">.xcodeproj</code>文件来打开你的项目。</p><p id="ae2e" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在，我们为<code class="fe mw mx my mz b">react-native link</code>做好了准备，导航到您的项目根目录并执行:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="b4e4" class="nj lk iq mz b gy nk nl l nm nn">react-native link</span></pre><p id="673a" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">目前，该命令有两个用途:</p><ol class=""><li id="aabb" class="mm mn iq kh b ki kj km kn kq mo ku mp ky mq lc mr ms mt mu bi translated">它会把<code class="fe mw mx my mz b">Firebase/Core</code>加到你的<code class="fe mw mx my mz b">Podfile</code>上。</li><li id="22ec" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated">它将更新构建阶段，并将Firebase库本地链接到您的项目。</li></ol><p id="f1ef" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们还需要Firebase包中的两个额外的库:</p><ol class=""><li id="4d7b" class="mm mn iq kh b ki kj km kn kq mo ku mp ky mq lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">Firebase/Firestore</code> — Firebase数据库</li><li id="9eae" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">Firebase/Auth</code> —使用Firebase进行授权(例如，如果您有一个后端，您没有必要安装它，但是在本教程中，我需要它来识别用户)</li></ol><p id="00e0" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">所以，去更新我们的<code class="fe mw mx my mz b">/ios/Podfile</code>并添加几行代码。现在它应该是这样的:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="93a0" class="nj lk iq mz b gy nk nl l nm nn">platform :ios, '9.0'<br/><br/>target 'SimpleChat' do<br/>  pod 'Firebase/Core', '~&gt; 5.20.2'<br/>  pod 'Firebase/Firestore', '~&gt; 5.20.2'<br/>  pod 'Firebase/Auth', '~&gt; 5.20.2'<br/>end</span></pre><p id="7cc6" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">注意:如果你知道自己在做什么，请不要忘记删除文件中不必要的内容。</p><p id="da60" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">当<code class="fe mw mx my mz b">react-native link</code>完成并且您添加了所需的包后，现在您需要导航到<code class="fe mw mx my mz b">/ios</code>文件夹并运行:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="48ea" class="nj lk iq mz b gy nk nl l nm nn">pod install</span></pre><p id="14d8" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在我们需要修改我们的<code class="fe mw mx my mz b">AppDelegate.m</code>并添加两行代码，首先在您的导入旁边:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="32f5" class="nj lk iq mz b gy nk nl l nm nn">#import &lt;Firebase.h&gt;</span></pre><p id="5561" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">定义后第二个在<code class="fe mw mx my mz b">didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code>内:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="0b53" class="nj lk iq mz b gy nk nl l nm nn">[FIRApp configure];</span></pre><p id="1dc9" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">所有库都设置好了。现在我们需要设置Firebase应用程序本身。</p></div><div class="ab cl jy jz hu ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ij ik il im in"><h1 id="c258" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">第二集。Firebase应用</h1><p id="0ced" class="pw-post-body-paragraph kf kg iq kh b ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky ml la lb lc ij bi translated">前往Firebase控制台。如果您没有帐户，请创建一个。它是免费的。</p><p id="59f5" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">创建一个新项目并输入其名称:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/7453377c50487d85b32c49727d8e686d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*-D77TfaUc7gQblKpTsXG1w.png"/></div></figure><p id="f967" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在我们需要设置<code class="fe mw mx my mz b">Authentication</code>，同样，如果你有后端，这一步对你来说是不必要的。</p><p id="04e6" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">导航至<code class="fe mw mx my mz b">Authentication</code> &gt; <code class="fe mw mx my mz b">Setup sign-in method</code>并选择符合您需求的提货方式。对于本教程，匿名认证就足够了:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/5ff20452dd146fca7e86d4f9b8b79787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UEjuQYSEZaMc8IisAF6X3Q.png"/></div></div></figure><p id="ddf2" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在我们需要打开Firestore，导航到<code class="fe mw mx my mz b">Database</code> &gt; <code class="fe mw mx my mz b">Create database</code> &gt;选择模式(对于本教程—我使用<code class="fe mw mx my mz b">test mode</code>，这样就够了)。如果您做的一切都正确，您应该会看到数据库管理页面:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/b1e9bf8a498dea0eb541f50027b44fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DbWTiZMhaKZhnEtmj_wPOA.png"/></div></div></figure><p id="6b78" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">太好了，服务准备好了，现在，创建iOS和Android应用程序。导航到<code class="fe mw mx my mz b">Project Overview</code> &gt;选择你需要的操作系统(在本教程中，我只有iOS项目，但它在Android和iOS上都工作得很好。</p><p id="6a87" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">对于这两个操作系统，只需按照firebase控制台中的说明进行操作(除了您已经完成的步骤，在您成功完成安装后，您将收到配置文件。</p><p id="963e" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kh ir">安卓</strong></p><p id="88a5" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">把你的<code class="fe mw mx my mz b">google-service.json</code>放进<code class="fe mw mx my mz b">/android/app</code>:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e4eaa754a81e0af0b127c42d69d3253e.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*W4Dei8AJ_zuZCTVx2TgBEQ@2x.png"/></div></figure><p id="6094" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kh ir"> iOS </strong></p><p id="47f5" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">将您的<code class="fe mw mx my mz b">GoogleService-Info.plist</code>放入Xcode根目录:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/05745eef22adfea04ae3a34c56285ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*_RMMCmniogh8aFu4Sr8j6A.png"/></div></figure><p id="3f85" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在我们准备好了。<em class="ld">让代码。</em></p></div><div class="ab cl jy jz hu ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ij ik il im in"><h1 id="e33f" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">第三集。利润</h1><p id="8081" class="pw-post-body-paragraph kf kg iq kh b ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky ml la lb lc ij bi translated">我会用<code class="fe mw mx my mz b">React Hooks</code>写所有的东西，但是你会在库中看到没有钩子的例子。</p><p id="7ff4" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们的项目树将如下所示:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="9db5" class="nj lk iq mz b gy nk nl l nm nn">|- /SimpleChat<br/>|  |- /src<br/>|  |  |- /components<br/>|  |  |  |- /common<br/>|  |  |  |  |- /Button<br/>|  |  |  |  |  |- /index.js<br/>|  |  |  |  |  |- /styles.js<br/>|  |  |  |  |- /Loader<br/>|  |  |  |  |  |- /index.js<br/>|  |  |  |  |  |- /styles.js<br/>|  |  |  |- /HooksExample<br/>|  |  |  |  |- /index.js<br/>|  |  |  |  |- /reducers.js<br/>|  |  |  |- /Input<br/>|  |  |  |  |- /index.js<br/>|  |  |  |  |- /styles.js<br/>|  |  |  |- /Message<br/>|  |  |  |  |- /index.js<br/>|  |  |  |  |- /styles.js<br/>|  |  |- /constants<br/>|  |  |  |- /collection.js<br/>|  |  |  |- /index.js<br/>|  |  |- /services<br/>|  |  |  |- /index.js<br/>|  |  |  |- /FirebaseService.js<br/>|  |  |- /styles<br/>|  |  |  |- /chat-room.js<br/>|  |  |  |- /colors.js<br/>|  |  |  |- /index.js<br/>|  |  |- /index.js<br/>|  |  |- /contexts.js</span></pre><p id="c932" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">关于结构的一些细节:</p><ol class=""><li id="b87b" class="mm mn iq kh b ki kj km kn kq mo ku mp ky mq lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">/src/context.js</code> —这是我们放置所有上下文的地方(例如<code class="fe mw mx my mz b">currentUser</code>)。</li><li id="da25" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">/src/styles/chat-room.js</code> —这只是一个样式，因为我将在类组件示例中重用它们，这里的样式只是为了避免重复(不要重复)。通常，您可以将它放在您的组件文件夹下，在本例中，例如it <code class="fe mw mx my mz b">HooksExample</code>。</li><li id="dc9b" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">/src/components/HooksExample/reducers.js</code> —是我把复杂的逻辑用钩子挂起来的地方。</li><li id="65ab" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">/src/services/FirebaseService.js</code> —这是我们要与firebase沟通的地方。</li><li id="f6fe" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">/src/constants/collections.js</code> —这是我们保持我们的firebase系列名称的地方</li></ol><p id="be79" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">从我们的主要组件开始。我们将在下一部分写出我们的逻辑。</p><p id="5393" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">因此，目前我们将在没有组件标记的情况下工作。基本上，所有聊天都有两个屏幕部分，消息和创建消息的输入加号按钮。</p><p id="1dac" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们将创建我们的主组件，在本教程中我们称它为<code class="fe mw mx my mz b">HooksExample</code>，但它的正确名称是<code class="fe mw mx my mz b">Chat</code>组件。它将呈现带有我们的消息的<code class="fe mw mx my mz b">FlatList</code>和一个<code class="fe mw mx my mz b">Input</code>组件，我们将在其中填充消息并发送它们。</p><p id="2b95" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">所以让我们从我们的<code class="fe mw mx my mz b">Input</code>组件开始。让我们编码:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="c42e" class="nj lk iq mz b gy nk nl l nm nn"><em class="ld">import </em>React, { useCallback, useState } <em class="ld">from </em>'react'<br/><em class="ld">import </em>{ View, TextInput } <em class="ld">from </em>'react-native'<br/><br/><em class="ld">import </em>Button <em class="ld">from </em>'../common/Button'<br/><br/><em class="ld">import </em>styles <em class="ld">from </em>'./styles'<br/><br/><em class="ld">export default function </em>Input () {<br/>  <em class="ld">const </em>[message, setMessage] = useState('')<br/><br/>  <em class="ld">const </em>handlePress = useCallback(<br/>    <em class="ld">function </em>() {<br/>      // todo this<br/>    },<br/>    [message]<br/>  )<br/><br/>  <em class="ld">return </em>(<br/>    &lt;View <em class="ld">style</em>={styles.container}&gt;<br/>      &lt;View <em class="ld">style</em>={styles.inputContainer}&gt;<br/>        &lt;TextInput <em class="ld">style</em>={styles.input} <em class="ld">value</em>={message} <em class="ld">onChangeText</em>={setMessage} <em class="ld">placeholder</em>="Write you message" /&gt;<br/>      &lt;/View&gt;<br/><br/>      &lt;Button <em class="ld">text</em>="Send" <em class="ld">onPress</em>={handlePress} /&gt;<br/>    &lt;/View&gt;<br/>  )<br/>}</span></pre><p id="96d4" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们的风格:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="6f51" class="nj lk iq mz b gy nk nl l nm nn"><em class="ld">import </em>{ StyleSheet } <em class="ld">from </em>'react-native'<br/><br/><em class="ld">import </em>{ COLORS } <em class="ld">from </em>'../../styles'<br/><br/><em class="ld">export default </em>StyleSheet.create({<br/>  container: {<br/>    flexDirection: 'row',<br/>    alignItems: 'center',<br/>    justifyContent: 'space-around',<br/>    width: '100%'<br/>  },<br/>  inputContainer: {<br/>    width: '70%'<br/>  },<br/>  input: {<br/>    height: 40,<br/>    borderColor: COLORS.GREY,<br/>    borderWidth: 1,<br/>    borderRadius: 3,<br/>    flexDirection: 'row',<br/>    paddingHorizontal: 10<br/>  }<br/>})</span></pre><p id="5f74" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">这就是我们的示意图:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/681c972cd0dca9337de1e31e7050feff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*89r6le18zKbWVqWu21Xh5w.png"/></div></div></figure><p id="50ff" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在，瞄准<code class="fe mw mx my mz b">Message</code>组件:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="9383" class="nj lk iq mz b gy nk nl l nm nn"><em class="ld">import </em>React <em class="ld">from </em>'react'<br/><em class="ld">import </em>{ View, Text } <em class="ld">from </em>'react-native'<br/><br/><em class="ld">import </em>{ styles, flattenedStyles } <em class="ld">from </em>'./styles'<br/><br/><em class="ld">export default function </em>Message ({ message, side }) {<br/>  <em class="ld">const </em>isLeftSide = side === 'left'<br/><br/>  <em class="ld">const </em>containerStyles = isLeftSide ? styles.container : flattenedStyles.container<br/>  <em class="ld">const </em>textContainerStyles = isLeftSide ? styles.textContainer : flattenedStyles.textContainer<br/>  <em class="ld">const </em>textStyles = isLeftSide ? flattenedStyles.leftText : flattenedStyles.rightText<br/><br/>  <em class="ld">return </em>(<br/>    &lt;View <em class="ld">style</em>={containerStyles}&gt;<br/>      &lt;View <em class="ld">style</em>={textContainerStyles}&gt;<br/>        &lt;Text <em class="ld">style</em>={textStyles}&gt;<br/>          {message}<br/>        &lt;/Text&gt;<br/>      &lt;/View&gt;<br/>    &lt;/View&gt;<br/>  )<br/>}</span></pre><p id="5463" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">该组件接受两个<code class="fe mw mx my mz b">props</code>:</p><ol class=""><li id="b8ad" class="mm mn iq kh b ki kj km kn kq mo ku mp ky mq lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">message</code> —文本，字符串</li><li id="a7c4" class="mm mn iq kh b ki na km nb kq nc ku nd ky ne lc mr ms mt mu bi translated"><code class="fe mw mx my mz b">side</code> —字符串，将是<code class="fe mw mx my mz b">left</code>或<code class="fe mw mx my mz b">right</code>。这将帮助组件选择消息组件的样式。</li></ol><p id="b1c6" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们需要为左侧和右侧应用不同的样式。以下是它的风格:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="1673" class="nj lk iq mz b gy nk nl l nm nn"><em class="ld">import </em>{ StyleSheet } <em class="ld">from </em>'react-native'<br/><br/><em class="ld">import </em>{ COLORS } <em class="ld">from </em>'../../styles'<br/><br/><em class="ld">const </em>styles = StyleSheet.create({<br/>  container: {<br/>    width: '100%',<br/>    paddingVertical: 3,<br/>    paddingHorizontal: 10,<br/>    flexDirection: 'row',<br/>    alignItems: 'center',<br/>    justifyContent: 'flex-start'<br/>  },<br/>  textContainer: {<br/>    width: 160,<br/>    backgroundColor: COLORS.GREY,<br/><br/>    borderRadius: 40,<br/>    paddingHorizontal: 15,<br/>    paddingVertical: 12,<br/>    marginLeft: 10<br/>  },<br/>  rightContainer: {<br/>    justifyContent: 'flex-end'<br/>  },<br/>  rightTextContainer: {<br/>    backgroundColor: COLORS.PRIMARY,<br/>    marginRight: 10<br/>  },<br/>  leftText: {<br/>    textAlign: 'left'<br/>  },<br/>  rightText: {<br/>    textAlign: 'right'<br/>  },<br/>  text: {<br/>    fontSize: 12<br/>  }<br/>})<br/><br/><em class="ld">const </em>flattenedStyles = {<br/>  container: StyleSheet.flatten([styles.container, styles.rightContainer]),<br/>  textContainer: StyleSheet.flatten([styles.textContainer, styles.rightTextContainer]),<br/>  leftText: StyleSheet.flatten([styles.leftText, styles.text]),<br/>  rightText: StyleSheet.flatten([styles.rightText, styles.text])<br/>}<br/><br/><em class="ld">export </em>{<br/>  styles,<br/>  flattenedStyles<br/>}</span></pre><p id="f3bf" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">现在，我之所以创建一个名为<code class="fe mw mx my mz b">flattenedStyles</code>的对象，是为了创建一个带有ID的样式数组，这个机制是<code class="fe mw mx my mz b">StyleSheet</code>为我们提供的，它有助于进行简单的优化。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/cd2353199ff85f0092735a740eeabfde.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*Ou9hNvktkGJjWS2wfzBAIQ.png"/></div></figure><p id="1f69" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们如何拥有<code class="fe mw mx my mz b">Message</code>和<code class="fe mw mx my mz b">Input</code>组件，并且我们必须将它们合并到我们的<code class="fe mw mx my mz b">HooksExample</code>组件中。</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="30df" class="nj lk iq mz b gy nk nl l nm nn"><em class="ld">import </em>React <em class="ld">from </em>'react'<br/><em class="ld">import </em>{ FlatList, SafeAreaView, View } <em class="ld">from </em>'react-native'<br/><br/><em class="ld">import </em>Input <em class="ld">from </em>'../Input'<br/><em class="ld">import </em>Message <em class="ld">from </em>'../Message'</span><span id="8253" class="nj lk iq mz b gy nv nl l nm nn"><em class="ld">import </em>{ chatRoomStyles <em class="ld">as </em>styles } <em class="ld">from </em>'../../styles'<br/><br/><em class="ld">export default function </em>HooksExample () {<br/>  const mock = [<br/>    { id: 1, message: 'Hello', side: 'left' }, <br/>    { id: 2, message: 'Hi!', side: 'right' }<br/>  ]</span><span id="75b4" class="nj lk iq mz b gy nv nl l nm nn">  <em class="ld">return </em>(<br/>    &lt;SafeAreaView&gt;<br/>      &lt;View <em class="ld">style</em>={styles.messagesContainer}&gt;<br/>        &lt;FlatList<br/>          <em class="ld">inverted<br/>          data</em>={}<br/>          <em class="ld">keyExtractor</em>={<em class="ld">function </em>(item) {<br/>            <em class="ld">return </em>item.id<br/>          }}<br/>          <em class="ld">renderItem</em>={<em class="ld">function </em>({ item }) {<br/>            <em class="ld">return </em>(<br/>              &lt;Message <em class="ld">side</em>={data.side} <em class="ld">message</em>={data.message} /&gt;<br/>            )<br/>          }}<br/>        /&gt;<br/>      &lt;/View&gt;<br/><br/>      &lt;View <em class="ld">style</em>={styles.inputContainer}&gt;<br/>        &lt;Input /&gt;<br/>      &lt;/View&gt;<br/>    &lt;/SafeAreaView&gt;<br/>  )<br/>}</span></pre><p id="921c" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们的样式为<code class="fe mw mx my mz b">HooksExample</code>组件:</p><pre class="lf lg lh li gt nf mz ng nh aw ni bi"><span id="c981" class="nj lk iq mz b gy nk nl l nm nn"><em class="ld">import </em>{ StyleSheet } <em class="ld">from </em>'react-native'<br/><br/><em class="ld">import </em>COLORS <em class="ld">from </em>'./colors'<br/><br/><em class="ld">export default </em>StyleSheet.create({<br/>  messagesContainer: {<br/>    height: '100%',<br/>    paddingBottom: 100<br/>  },<br/>  inputContainer: {<br/>    width: '100%',<br/>    height: 100,<br/>    position: 'absolute',<br/>    bottom: 0,<br/>    paddingVertical: 10,<br/>    paddingLeft: 20<br/><br/>    borderTopWidth: 1,<br/>    borderTopColor: COLORS.GREY<br/>  }<br/>})</span></pre><p id="efbc" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">所以，最后，我们会收到一个聊天记录</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/edcef168e4ab50b00081d095f0d7cf1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aq0zw2yBFakGzefEIAMZvA.png"/></div></div></figure></div><div class="ab cl jy jz hu ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ij ik il im in"><p id="8a1c" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><em class="ld">开场白。</em></p><p id="acc6" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">我们的标记准备好了，我们可以写我们的逻辑了。访问<a class="ae mv" href="https://medium.com/@andriidrozdov/chat-in-30-minutes-with-reactnative-and-firebase-seriously-pt-2-1994d2401774" rel="noopener"><em class="ld">30分钟内与ReactNative和Firebase聊天，认真！角。2 </em> </a> <em class="ld">。继续阅读……</em></p><p id="f022" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><a class="ae mv" href="https://github.com/tech-by-andrii/chat-in-30-minutes-with-react-native-and-firebase" rel="noopener ugc nofollow" target="_blank"> <em class="ld">链接到知识库。</em>T25】</a></p><p id="c29d" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">存储库中的项目已经有了一个安装Firebase应用程序，您可以克隆这个存储库并进行试验。</p><p id="6c70" class="pw-post-body-paragraph kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">更多信息请关注我！</p></div></div>    
</body>
</html>
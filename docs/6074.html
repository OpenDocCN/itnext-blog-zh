<html>
<head>
<title>Using Mongoose with Next.js 11</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Next.js 11中使用Mongoose</h1>
<blockquote>原文：<a href="https://itnext.io/using-mongoose-with-next-js-11-b2a08ff2dd3c?source=collection_archive---------0-----------------------#2021-08-10">https://itnext.io/using-mongoose-with-next-js-11-b2a08ff2dd3c?source=collection_archive---------0-----------------------#2021-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f7df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在最新版本的Next.js框架中使用Mongoose ORM for MongoDb的简单指南。</p><h2 id="f8f9" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">1.创建一个Next.js 11项目</h2><p id="0775" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">创建Next.js项目最简单的方法是使用<code class="fe lm ln lo lp b">create-next-app</code>。在您的终端中运行以下命令。</p><pre class="lq lr ls lt gt lu lp lv lw aw lx bi"><span id="c63f" class="ko kp it lp b gy ly lz l ma mb">npx create-next-app my-mongoose-app-name</span></pre><p id="1028" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该过程完成后，用代码编辑器打开项目目录。</p><h2 id="30d5" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated"><strong class="ak"> 2。添加环境变量</strong></h2><p id="d8be" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">我们只需要一个变量，那就是<code class="fe lm ln lo lp b">MONGODB_URI</code>。在你的项目目录中创建一个名为<code class="fe lm ln lo lp b">.env.local</code>的文件。我在这里使用我的本地数据库，你可以改变你自己的值。</p><figure class="lq lr ls lt gt mc"><div class="bz fp l di"><div class="md me l"/></div></figure><h2 id="f99f" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">3.安装猫鼬</h2><p id="c6ef" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">现在让我们安装mongoose npm包。</p><pre class="lq lr ls lt gt lu lp lv lw aw lx bi"><span id="460d" class="ko kp it lp b gy ly lz l ma mb">npm i mongoose</span></pre><h2 id="bb0c" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">4.添加连接文件</h2><p id="a3d5" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">现在我们需要一个文件来初始化数据库连接。我们还将全局缓存连接。让我们创建一个文件— <code class="fe lm ln lo lp b">lib/dbConnect.js</code>并粘贴下面的代码。</p><figure class="lq lr ls lt gt mc"><div class="bz fp l di"><div class="md me l"/></div></figure><h2 id="8528" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">5.创建一个猫鼬模型</h2><p id="0d9a" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">让我们创建一个Mongoose模型，这样我们可以将一些数据插入到我们的数据库中。你可以使用你喜欢的任何型号。下面是一个简单的用户模型的例子，它有一个名字和一个电子邮件字段。<strong class="js iu">注意最后一行</strong>，导出与我们在Express中的方式不同。这可以防止Mongoose重新编译模型。你可以创建这个文件为<code class="fe lm ln lo lp b">/models/User.js</code>。</p><figure class="lq lr ls lt gt mc"><div class="bz fp l di"><div class="md me l"/></div></figure><h2 id="e90d" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">6.创建API路线</h2><p id="728a" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">以下示例在<code class="fe lm ln lo lp b">/api/users.js</code>处创建一个端点。它包括两种方法— <code class="fe lm ln lo lp b">GET</code>和<code class="fe lm ln lo lp b">POST</code>。<code class="fe lm ln lo lp b">GET</code>方法获取数据库中的所有用户，<code class="fe lm ln lo lp b">POST</code>方法使用<code class="fe lm ln lo lp b">req.body</code>中提供的参数创建一个用户。注意，我们在运行数据库查询之前做了一个<code class="fe lm ln lo lp b">dbConnect()</code>。</p><figure class="lq lr ls lt gt mc"><div class="bz fp l di"><div class="md me l"/></div></figure><h2 id="459c" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">7.测试您的路线！</h2><p id="959b" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">这将是我们的最后一步。为了测试我们的端点，我们可以通过您选择的任何HTTP客户端发送请求。下面是CURL命令，您可以用它来快速验证一切是否正常。</p><p id="f091" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lm ln lo lp b"><em class="mf">POST</em></code> <em class="mf">首先，用</em> <code class="fe lm ln lo lp b"><em class="mf">GET</em></code>获取一些数据</p><pre class="lq lr ls lt gt lu lp lv lw aw lx bi"><span id="e1f0" class="ko kp it lp b gy ly lz l ma mb"><strong class="lp iu">POST - CREATE NEW USERS</strong></span><span id="d984" class="ko kp it lp b gy mg lz l ma mb"><strong class="lp iu">EXAMPLE REQUEST<br/></strong>curl --request POST \<br/>  --url <a class="ae mh" href="http://localhost:3000/api/users" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/api/users</a> \<br/>  --header 'Content-Type: application/json' \<br/>  --data '{<br/> "name": "John Doe",<br/> "email": "<a class="ae mh" href="mailto:john@doe.com" rel="noopener ugc nofollow" target="_blank">john@doe.com</a>"<br/>}'</span><span id="7c57" class="ko kp it lp b gy mg lz l ma mb"><strong class="lp iu">EXAMPLE RESPONSE<br/></strong>{<br/>  "success": true,<br/>  "data": {<br/>    "_id": "6112570b245e401eb895c35d",<br/>    "name": "John Doe",<br/>    "email": "<a class="ae mh" href="mailto:john@doe.com" rel="noopener ugc nofollow" target="_blank">john@doe.com</a>",<br/>    "__v": 0<br/>  }<br/>}</span><span id="50e0" class="ko kp it lp b gy mg lz l ma mb"><strong class="lp iu">GET - GET ALL USERS</strong></span><span id="2538" class="ko kp it lp b gy mg lz l ma mb"><strong class="lp iu">EXAMPLE REQUEST<br/></strong>curl --request GET \<br/>  --url <a class="ae mh" href="http://localhost:3000/api/users" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/api/users</a> \<br/>  --header 'Content-Type: application/json'</span><span id="4a24" class="ko kp it lp b gy mg lz l ma mb"><strong class="lp iu">EXAMPLE RESPONSE<br/></strong>{<br/>  "success": true,<br/>  "data": [<br/>    {<br/>      "_id": "6112570b245e401eb895c35d",<br/>      "name": "John Doe",<br/>      "email": "<a class="ae mh" href="mailto:john@doe.com" rel="noopener ugc nofollow" target="_blank">john@doe.com</a>",<br/>      "__v": 0<br/>    }<br/>  ]<br/>}</span></pre><p id="f967" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🥳就是这样！我们都准备好了！和猫鼬玩得开心！如果你想看更多Next.js文章，请留下评论。我们不就是❤️ Next.js吗？我知道我有！</p><p id="54e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">完整项目回购地点:</strong></p><p id="35b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mh" href="https://github.com/skolhustick/nextjs-mongoose-example" rel="noopener ugc nofollow" target="_blank">https://github.com/skolhustick/nextjs-mongoose-example</a></p><figure class="lq lr ls lt gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mi"><img src="../Images/324eb4f11dec1185302d678dabd054d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GoK5Az8RBi6KMF_U8A_P9Q.jpeg"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">简·安东宁·科拉尔在<a class="ae mh" href="https://unsplash.com/s/photos/database?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1b12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">相关文章:</p><div class="mt mu gp gr mv mw"><a href="https://eshwaren.medium.com/using-prisma-orm-with-mongodb-in-next-js-e42b1f7543e6" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">在Next.js中使用Prisma ORM和MongoDB</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">让我们创建一个简单的CRUD应用程序👉</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">eshwaren.medium.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk mn mw"/></div></div></a></div><p id="acee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi">👇👇👇 🙏</p><p id="339f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你觉得上面的文章有用，请考虑使用下面我的推荐链接订阅Medium。对你来说没有额外的花费，我将每个月得到一小笔捐款。🙇‍♂️</p><div class="mt mu gp gr mv mw"><a href="https://medium.com/@eshwaren/membership" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">通过我的推荐链接加入Medium</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">medium.com</p></div></div><div class="nf l"><div class="nl l nh ni nj nf nk mn mw"/></div></div></a></div></div></div>    
</body>
</html>
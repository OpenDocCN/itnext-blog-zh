<html>
<head>
<title>Pre-rendering your React application with react-snap</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用react-snap预渲染React应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/pre-rendering-your-react-application-with-react-snap-234e2408ed39?source=collection_archive---------1-----------------------#2018-04-30">https://itnext.io/pre-rendering-your-react-application-with-react-snap-234e2408ed39?source=collection_archive---------1-----------------------#2018-04-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a086" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想提高网站的搜索引擎优化性能，并使其对搜索引擎可见，那么预渲染React应用程序是非常有用的。大多数搜索引擎机器人不执行客户端javascript代码，这使得React制作的网站在搜索引擎结果中不可见。</p><p id="5f86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使谷歌说它正在执行客户端Javascript代码，它最好也能被其他搜索引擎看到。这个问题的一个解决方案是在服务器端预先渲染你的页面，然后把这个html文件返回给客户端或者搜索引擎机器人。</p><p id="7b8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，我将提到使用<a class="ae kl" href="https://github.com/stereobooster/react-snap" rel="noopener ugc nofollow" target="_blank"> react-snap </a>预渲染你的应用程序。如果你想尝试不同的项目，你也可以尝试类似的选择，如<a class="ae kl" href="https://github.com/geelen/react-snapshot" rel="noopener ugc nofollow" target="_blank">反应快照</a>、<a class="ae kl" href="https://github.com/graphcool/prep" rel="noopener ugc nofollow" target="_blank">准备</a>或<a class="ae kl" href="https://github.com/chrisvfritz/prerender-spa-plugin" rel="noopener ugc nofollow" target="_blank">预渲染-spa-插件</a>。那么，我们开始吧。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="96b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将使用<a class="ae kl" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>创建一个新的react应用程序。如果不知道怎么做，可以先看<a class="ae kl" href="https://medium.com/@ahmetkapusuz/react-series-1-create-your-first-react-application-5aad15625da0" rel="noopener">这个教程</a>。</p><p id="4114" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我正在用下面的命令创建应用程序:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="3816" class="lc ld iq ky b gy le lf l lg lh">create-react-app pre-rendered-app</span></pre><p id="1580" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后转到应用程序文件夹，运行“npm start”来查看是否一切正常，您应该能够看到react应用程序示例的主页。</p><p id="eb8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将安装react-snap作为开发依赖项。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="7d05" class="lc ld iq ky b gy le lf l lg lh">npm install --only=dev react-snap</span></pre><p id="cdcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在package.json文件的scripts字段下添加以下行。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="7bda" class="lc ld iq ky b gy le lf l lg lh">"postbuild": "react-snap"</span></pre><p id="b01f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的package.json应该有如下所示的脚本部分:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="f8b1" class="lc ld iq ky b gy le lf l lg lh">"scripts": {<br/>  "start": "react-scripts start",<br/>  "build": "react-scripts build",<br/>  "test": "react-scripts test --env=jsdom",<br/>  "eject": "react-scripts eject",<br/>  "postbuild": "react-snap"<br/>}</span></pre><p id="627b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在更改src/index.js:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="d9bd" class="lc ld iq ky b gy le lf l lg lh"><strong class="ky ir">import </strong>React <strong class="ky ir">from </strong>'react';<br/><strong class="ky ir">import </strong>'./index.css';<br/><strong class="ky ir">import </strong>App <strong class="ky ir">from </strong>'./App';<br/><strong class="ky ir">import </strong>{ hydrate, render } <strong class="ky ir">from </strong>'react-dom';<br/><strong class="ky ir">import </strong>registerServiceWorker <strong class="ky ir">from </strong>'./registerServiceWorker';<br/><br/><strong class="ky ir">const </strong>rootElement = document.getElementById('root');<br/><strong class="ky ir">if </strong>(rootElement.hasChildNodes()) {<br/>    hydrate(&lt;App /&gt;, rootElement);<br/>} <strong class="ky ir">else </strong>{<br/>    render(&lt;App /&gt;, rootElement);<br/>}<br/>registerServiceWorker();</span></pre><p id="1068" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有配置都做好了！让我们建立，看看会发生什么。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="f7c0" class="lc ld iq ky b gy le lf l lg lh">npm install<br/>npm run build</span></pre><p id="3abc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">构建完成后，您将看到react-snap被执行并打印出一些类似于下面的日志。</p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi li"><img src="../Images/a381bba6e11fb919459459a4b77a9306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uWg3KZnT5L9kJ7bvIzMZwQ.png"/></div></div></figure><p id="3d85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">构建之后，您可以使用serve命令为您的应用程序提供服务。如果没有安装，您可以通过命令“npm install -g serve”进行安装。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="de51" class="lc ld iq ky b gy le lf l lg lh">serve -s build</span></pre><p id="4dfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在您的应用程序将在5000端口上提供服务，您可以在<a class="ae kl" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000 </a>上访问它。</p><p id="61c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在构建文件夹下看到预渲染的index.html文件，你原来的index.html文件也被重命名为200.html。</p><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lq"><img src="../Images/4757a83121a8ac7990f4f424d8182095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lw_2awzM02-Ly4ojS46e_A.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">预渲染index.html文件</figcaption></figure><p id="67dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你也可以在localhost:5000页面打开Chrome Developer Tool，进入网络选项卡，选择“所有”过滤器。然后刷新页面，您将看到响应本地主机请求的呈现的html文件。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><figure class="kt ku kv kw gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lv"><img src="../Images/97f54405cbbee87620180c99422b080f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iby7h2NQ-Qlppu68b2f3Ug.png"/></div></div></figure><p id="4675" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以从这个github repo 中获得完整的代码。</p></div></div>    
</body>
</html>
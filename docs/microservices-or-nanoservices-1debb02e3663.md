# 微服务还是纳米服务？

> 原文：<https://itnext.io/microservices-or-nanoservices-1debb02e3663?source=collection_archive---------0----------------------->

![](img/f380ac157bd94cb4fcb578f34395bfaf.png)

里克·梅森在 [Unsplash](https://unsplash.com/s/photos/lego-mess?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的照片

快到 2022 年圣诞节了，软件开发行业吸取了很多教训。其中之一是巨石柱是邪恶的。但是如果我们走另一个极端，提供了太多的服务，那会怎么样呢？这是我们要反思的。

整体缺点

*   一个大的部署导致部署延迟和协调。
*   一个大的扩展模型，与每个服务的微服务可扩展性相比。
*   因为它是一个大的代码库，所以耦合可能会导致更新依赖关系甚至编程语言选择的困难。

因此，现在的神圣银弹是微服务，而不是单片，它解决了单片的缺点。但是我们需要明白的是，**软件工程是一个权衡取舍的职业**，那么微服务有哪些弊端呢？

*   代码被分割在多个存储库中。调试或理解需要跳。
*   API 调用而不是模块调用增加了网络延迟和更复杂的错误处理。
*   将建立多个管道、监控和警报。

那么，如果我们有这些缺点，并通过制造许多迷你服务使它们成倍恶化，那又会怎样呢？我们称之为纳米服务。

# 我说的纳米服务是什么意思？

假设有一个微服务从队列中读取消息并发送电子邮件。

![](img/6eccc29162ed49922e13cd9447a6e43d.png)

向 SMTP 服务器发送电子邮件的队列

这种微服务的成本是否合理？

*   监视
*   建设管道
*   维护文档

我强烈反对，发送电子邮件的代码有 5-10 行长。为什么我们要投资数百条管线来部署 5-10 条管线？

这个服务应该与代码的其他部分放在一起，可能在一个通信域中，或者给想要发送电子邮件的消费者。

# 重量类比

![](img/06636d9c53145a5e395f93e14b514cd9.png)

维克多·弗雷塔斯在 [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

让我们想象一下，我们可以将我们的软件量化为权重。对于一家电子商务公司来说，500 公斤的重量代表软件的复杂性，8 公斤的支撑条代表管道、监控和警报。

如果我们把这些都放在一个酒吧里，那就太重了。它需要多人抬起，团队间的协调和部署不经常进行，因为太重而无法移动。

相反，我们可以将 500 公斤分成更小的重量，达到另一个极端。让我们把 500 公斤的杠铃分成 2 公斤，放在每根杠铃上。所以现在我们可以举起 250 个小重物，不是更容易吗？现在我们有 500 公斤的重量加上 250 个 8 公斤的杠铃，总共 2000 公斤杠铃。

![](img/21ff1aba35a5839936dace02df94aa07.png)

由[雄心勃勃的创意公司——Rick Barrett](https://unsplash.com/@weareambitious?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)拍摄于 [Unsplash](https://unsplash.com/s/photos/weight-bar?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

## 平衡是关键

我们知道，一杠 508 KG 太多了，250 的重量会给我们过多的额外杠。目标是找到正确的平衡。也许这 500 公斤可以分成 10 根杠，这就增加了额外的 72 公斤杠，但总的来说，这是值得的，因为我们现在可以更快更独立地移动这 500 公斤。

也许搬进 20 间酒吧会更好。不知道。它因情况而异。我希望你考虑一下你为每项服务支付的额外费用。所以你的团队不需要携带太多额外的 8 公斤杠铃，或者他们做出了明智的决定。

在划分服务时，您可以问一些微服务味道的问题:

*   两个服务需要相同的数据库吗？
*   对你来说测试一个服务，它需要经过另一个服务吗？
*   一个服务只能被另一个服务使用吗？几乎是作为一门私课？
*   服务责任是琐碎的工作吗？比如邮件发送的例子？

如果你想更精通微服务，了解更多关于最佳服务规模的信息，我推荐两个资源:

*   [微服务马丁福勒 GOTO 2014](https://www.youtube.com/watch?v=wgdBVIX9ifA&ab_channel=GOTOConferences)
*   Sam Newman 的构建微服务

快乐工程。
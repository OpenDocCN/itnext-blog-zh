<html>
<head>
<title>Custom RXJS operators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自定义RXJS运算符</h1>
<blockquote>原文：<a href="https://itnext.io/custom-rxjs-operators-200c732a9039?source=collection_archive---------2-----------------------#2021-03-26">https://itnext.io/custom-rxjs-operators-200c732a9039?source=collection_archive---------2-----------------------#2021-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="267a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当在Angular中工作时，我们习惯于在日常工作中使用observables和pipes，但有时我们会遇到大量的代码重复，我们使用相同的操作符来获得类似的UI和UX感觉。</p><p id="2cbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们使用一个搜索栏作为例子，因为它很容易理解，我们知道从结果中可以期待什么。</p><p id="07c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们必须以经典的方式写下来，它会是这样的:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/8bcc0e1e01d61eab4e0277343987c3d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_zX9Plyx3JHxJi-Cu59jw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">编写搜索管道的简单方法</figcaption></figure><p id="c667" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能是创建搜索输入栏逻辑的最常见的方式，也是最简单的。<br/>我们首先使用“debounceTime(500)”以便不在每次击键时发出，而是在500毫秒内发出一次。然后我们使用distinctUntillChanged以便不一个接一个地发出相同的搜索值。然后我们拥有的任何逻辑都可以在之后完成。这是可行的，但是随着你的应用程序的增长，你会有越来越多的具有完全相同逻辑的搜索栏，所以让我们自己制作一个包含逻辑的操作符。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lb"><img src="../Images/363b9558a5c5512fb572d2bf0d82be88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lNA9xb4f1JMudToLlUTnkg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">与上图完全相同的逻辑，但不需要重写相同的逻辑</figcaption></figure><p id="3cc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我的操作符返回type: OperatorFunction <any any="">这一事实，我知道它将向我们的tap/map/concatmap发出值。</any></p><p id="0d4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在可以给我们的操作添加一些很酷的特性，比如一个过滤器来“吞下”不符合我们要求的事件，对于我们的例子，我将使用最少数量的字符。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/b459e1c732d7201487d5fd5de7642c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHASdiuhmjv0Kqfj_9oegw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">按字符长度过滤</figcaption></figure><p id="ac63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">filter操作符不会传递没有通过我们的要求的值，在本例中，只有当值为空或超过2个字符时才通过。</p><p id="068c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是等等…我们的下一个输入需要超过4个字符才能按预期进行搜索。所以现在我们需要给我们的操作符添加选项。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/53e7e917d32c768e8d51ea2ba8d151c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYgnawh3NStt27jysGNvig.png"/></div></div></figure><p id="b2f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的图片中，我们设置了传递选项的能力，它有一个minLength的键。如果我们将minLength键传递给它，我们的过滤器现在将检查该值是否超过4个字符。</p><p id="8ae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建自定义RxJs操作符应该是一种简单的方法，可以避免代码重复，能够轻松访问自定义选项，并为您的应用程序提供全面的相似感觉和体验。</p></div></div>    
</body>
</html>
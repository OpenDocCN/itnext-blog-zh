<html>
<head>
<title>You need to read this before backuping your Kubernetes cluster</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在备份您的Kubernetes集群之前，您需要阅读这篇文章</h1>
<blockquote>原文：<a href="https://itnext.io/you-need-to-read-this-before-backuping-your-kubernetes-cluster-9a673f1151af?source=collection_archive---------2-----------------------#2022-11-27">https://itnext.io/you-need-to-read-this-before-backuping-your-kubernetes-cluster-9a673f1151af?source=collection_archive---------2-----------------------#2022-11-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a389" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">欢迎来到我的Kubernetes博客。这些博客旨在为您提供有效的Kubernetes知识和工具，提高效率，同时减少压力和交付高质量解决方案的时间。点按“关注”按钮，以便在新故事发布时得到通知。</p><p id="861f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">让我们开始吧……</strong></p><p id="13a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只需要看看每日新闻，就可以了解日益增长的网络攻击威胁，5g、AI等新兴技术可能带来的威胁，以及网络犯罪集团之间日益增长的协调。无论你认同什么理由，数据备份对任何公司来说都是必不可少的，这一点很清楚。</p><p id="3e26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一家企业因违规或任何其他原因遭受数据丢失，该公司能多快恢复？虽然数据备份不能保护您免受网络攻击，但它可以帮助您快速恢复。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/49d6ed6f554489428a49c0feed32a905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*oDz-QRpkcriI6W35"/></div></figure><p id="aefa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Kubernetes的早期，驻留在Kubernetes集群上的大多数应用程序都是无状态的。将这些应用程序打包在helm charts中，使Kubernetes管理员能够通过将应用程序helm charts重新部署到新的集群来快速从集群故障中恢复。</p><p id="f24f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">需要注意的是，在on-permiss场景中，更常见的是备份您的etcd和集群证书，以恢复集群中出现故障的控制平面节点。</p><p id="9f80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，Kubernetes社区和生态系统已经显著增长，有状态应用程序的使用已经变得更加普遍，因此需要一个集中的备份系统。</p><p id="04a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">那么让我们来回顾一下下面的话题。</strong></p><ul class=""><li id="e989" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">备份和恢复Kubernetes集群的挑战</li><li id="30a4" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">备份系统工作的最佳时机</li><li id="f1d6" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">velero——面向Kubernetes生态系统的开源备份解决方案</li></ul><p id="4b07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">备份和恢复Kubernetes集群的挑战</strong></p><p id="3178" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如简介中所述，在Kubernetes集群中使用有状态应用程序比以往更加普遍。掌舵图和操作符的使用使集群管理员能够轻松部署这些应用程序并有效地管理它们。</p><p id="6bea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着有状态应用程序在Kubernetes集群中的普遍使用，我们面临着更多需要定制备份和恢复操作的组件。</p><p id="d668" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们会发现自己在为集群状态备份etcd，为不同的有状态应用程序数据定制备份和恢复操作，以及维护不同的脚本来解决我们的备份和恢复需求，这些脚本可能会变得复杂且容易出现故障。</p><p id="2265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">备份系统工作的最佳时机</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi li"><img src="../Images/c872c8a330cf8af9c807dbcec3db5889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A_a6AsCfsV1Tmj9q"/></div></div></figure><p id="ec69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然这可能是一个有争议的话题，因为每个集群管理员对于何时应该有一个备份系统都有不同的观点。我认为Kubernetes集群上的备份工作可以推迟，特别是在初创公司，如果满足以下条件。</p><ol class=""><li id="072f" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk ln la lb lc bi translated">您的集群只包含无状态的应用程序。</li><li id="a1ad" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk ln la lb lc bi translated">这些应用程序作为helm存储在打包工具中，可以在几秒钟内部署到不同的集群。</li><li id="128c" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk ln la lb lc bi translated">您正在使用云提供商或任何其他能够在可接受的时间内提供新的Kubernetes集群的平台。</li><li id="aa2e" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk ln la lb lc bi translated">您的公司可以承受长时间的停机。</li></ol><p id="da32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，一些有状态的应用程序正与备份和恢复工具打包在一起，这些工具可以轻松配置为<a class="ae lo" href="https://bitnami.com/stack/thanos/helm" rel="noopener ugc nofollow" target="_blank"> thanos </a>和<a class="ae lo" href="https://github.com/zalando/postgres-operator" rel="noopener ugc nofollow" target="_blank"> zalando postgres </a>，不需要您准备一个强大的备份解决方案。</p><p id="57e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Velero —面向Kubernetes生态系统的开源备份解决方案</strong></p><p id="a7e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然市场上有许多备份解决方案，但用于备份、恢复、迁移和复制Kubernetes集群的领先开源工具是<a class="ae lo" href="https://velero.io/" rel="noopener ugc nofollow" target="_blank"> Velero </a>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/fbef40b621ec9c9c66d7150a36afcd74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/0*IyMWQsePNWxiVvA2"/></div></figure><p id="02da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Velero是一个开源解决方案，用于集中式备份和恢复操作、集群迁移和集群复制。Velero通过利用自定义资源定义(CRD)和实现处理CRD以执行备份、恢复和所有相关操作的自定义控制器来扩展Kubernetes API。</p><p id="2878" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Velero可用于备份您的洞群资源，或者您可以筛选和决定特定的资源。</p><p id="0514" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Velero使用object storage bucket作为s3、google cloud storage和类似的对象存储解决方案来备份包含Kubernetes资源的tarballs。Velero还使用cloud-api为集群中的持久性卷执行磁盘卷快照。</p><p id="9502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您的Kubernetes集群没有位于受支持的提供者上来执行磁盘备份，Velero通过实现文件系统备份来解决这个问题。</p><p id="0d62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论</strong> <br/>保持数据的安全性和弹性是每个公司努力追求的目标，尤其是在当前由黑客、数据丢失风险和数据损坏构成的全球形势下。在Kubernetes中，虽然备份解决方案可以推迟，但我们可以使用Velero等工具来集中Kubernetes集群的备份、恢复、迁移和复制操作。</p><p id="6213" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢，如果您有任何问题或需要任何帮助，您可以通过<a class="ae lo" href="https://www.linkedin.com/in/dekel-malul/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。如果你想深入了解Velero，请在下面的评论中或者通过直接留言告诉我。</p><p id="caa1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">***********************************************************************</p><p id="bb3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">链接:</p><p id="aa12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lo" href="http://www.devunet.com" rel="noopener ugc nofollow" target="_blank">www.devunet.com</a>(访问我公司网站)</p><p id="687d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lo" href="https://www.linkedin.com/in/dekel-malul/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/dekel-malul/</a>(在Linkedin联系我)</p><p id="55ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lo" href="https://www.linkedin.com/company/devunet/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/company/devunet/</a>(在Linkedin上关注我们的独家视频)</p></div></div>    
</body>
</html>
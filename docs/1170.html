<html>
<head>
<title>Publish a Vuepress site on GitHub pages with Travis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Travis一起在GitHub页面上发布Vuepress网站</h1>
<blockquote>原文：<a href="https://itnext.io/publish-a-vuepress-site-on-github-pages-with-travis-82036243bf36?source=collection_archive---------2-----------------------#2018-08-03">https://itnext.io/publish-a-vuepress-site-on-github-pages-with-travis-82036243bf36?source=collection_archive---------2-----------------------#2018-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/0f2fd6620a0d90bf74316d0e6fe87172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3mqGnoYlv8BQ4XcIqbaUA.jpeg"/></div></div></figure><div class=""/><pre class="jy jz ka kb gt kc kd ke kf aw kg bi"><span id="7c4b" class="kh ki jb kd b gy kj kk l kl km">published on August 3, 2018<br/>vuepress version: 0.13.1</span></pre><p id="0c00" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated"><a class="ae ll" href="https://vuepress.vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vuepress </a>是由<a class="ae ll" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vuejs </a>的创造者尤雨溪创造的一个奇妙的静态站点生成器。Vuepress的理念与Vuejs相同，可以用一个词概括:简单。</p><p id="836b" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">就目前而言，Vuepress非常适合生成文档网站，像往常一样，在Vuejs生态系统中，文档是您开始工作时唯一需要的东西。</p><p id="366f" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">由于我必须弄清楚如何使用特拉维斯连接点，我决定分享，以加快其他冒险家的进程。</p><p id="fd10" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">Vuepress生成简单html和js的静态网站。它们可以部署在任何静态网站主机、廉价的互助服务器上，也可以部署在GitHub上。Vue press是一个非常好的团队协作生成文档的选择。将它与<code class="fe lm ln lo kd b">git</code>和GitHub配对使得协作和跟踪修订变得容易。与Travis相关联的GitHub将允许团队不用担心如何发布，而只需添加文档、推送文档，剩下的就交给他们(我们)处理了。</p><p id="8fd3" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">此外，GitHub可以作为文档的(基本)CMS，因为可以在那里创建和编辑文件。这对于快速更新或者不希望安装<code class="fe lm ln lo kd b">git</code>并在他们的计算机上安装代码编辑器的不太懂技术的用户来说非常有用。</p><p id="c488" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">Vuepress根据Markdown文件的内容生成页面和导航。Markdown很容易学，事实上，我所在公司的所有内容编辑都使用Markdown在网上发布内容。大概需要15分钟训练他们，交接和小抄。</p><p id="c343" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">对于这个设置，我建议有一个repo来处理文档，并且Travis将在每次主分支上有推送时自动发布站点。</p><p id="3d1b" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">要进行该设置，您需要:</p><ol class=""><li id="be67" class="lp lq jb kp b kq kr ku kv ky lr lc ls lg lt lk lu lv lw lx bi translated">一个<a class="ae ll" href="https://travis-ci.org/" rel="noopener ugc nofollow" target="_blank">特拉维斯</a>的账户</li><li id="a8cc" class="lp lq jb kp b kq ly ku lz ky ma lc mb lg mc lk lu lv lw lx bi translated">一个<a class="ae ll" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>账户</li><li id="e928" class="lp lq jb kp b kq ly ku lz ky ma lc mb lg mc lk lu lv lw lx bi translated">Vuepress的<a class="ae ll" href="https://vuepress.vuejs.org/guide/getting-started.html#global-installation" rel="noopener ugc nofollow" target="_blank">工作安装</a></li></ol><p id="1a6b" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">所有其他配置都是可选的，允许你添加侧栏、顶部导航、项目标题等。</p><p id="cb82" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated"><code class="fe lm ln lo kd b">&lt;publication-repo-name&gt;</code>是<code class="fe lm ln lo kd b">github.com/&lt;username || organisation name&gt;/</code>之后的路径。它将用于GitHub页面的工作。所以，是的…创建两个存储库:</p><ol class=""><li id="5355" class="lp lq jb kp b kq kr ku kv ky lr lc ls lg lt lk lu lv lw lx bi translated">工作存储库</li><li id="d103" class="lp lq jb kp b kq ly ku lz ky ma lc mb lg mc lk lu lv lw lx bi translated">出版物存储库</li></ol><p id="90f4" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">在你的电脑上创建一个文件夹来存放你的项目，打开它并初始化一个git项目，我们将创建一个最小的<code class="fe lm ln lo kd b">package.json</code>文件，<code class="fe lm ln lo kd b">.travis.yml</code>来保存Travis配置，一个<code class="fe lm ln lo kd b">.gitignore</code>和一个<code class="fe lm ln lo kd b">docs</code>文件夹将包含我们的Vuepress配置和内容。然后通过添加正确的远程源将其链接到您的工作存储库。</p><pre class="jy jz ka kb gt kc kd ke kf aw kg bi"><span id="164b" class="kh ki jb kd b gy kj kk l kl km">$ mkdir &lt;folder name&gt;<br/>$ cd &lt;folder name&gt;<br/>$ git init<br/>$ touch package.json .travis.yml .gitignore<br/>$ <!-- -->mkdir -p<!-- --> docs/.vuepress<br/>$ cd docs/.vuepress</span></pre><p id="f168" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">产生的文件夹结构是:</p><pre class="jy jz ka kb gt kc kd ke kf aw kg bi"><span id="e516" class="kh ki jb kd b gy kj kk l kl km">└── &lt;folder name&gt;<br/>  ├── docs<br/>  |   └──.vuepress<br/>  |       └── config.js<br/>  ├── .gitignore<br/>  ├── .travis.yml<br/>  ├── package.json<br/>  └── README.md //optional</span></pre><p id="aec8" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">Vuepress易于安装，它的所有配置都放在一个<code class="fe lm ln lo kd b">.vuepress</code>文件夹中。该项目运行所需的唯一配置是在该文件夹的根目录下创建一个<code class="fe lm ln lo kd b">config.js</code>文件，该文件导出一个包含以下内容的模块以及您希望用于项目的任何附加配置。</p><pre class="jy jz ka kb gt kc kd ke kf aw kg bi"><span id="fbf7" class="kh ki jb kd b gy kj kk l kl km">module.exports = {<br/>    base: ‘/&lt;publication-repo-name&gt;/’, <br/>    // ...<br/>};</span></pre><p id="e905" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated"><code class="fe lm ln lo kd b">package.json</code>将保持:</p><pre class="jy jz ka kb gt kc kd ke kf aw kg bi"><span id="7406" class="kh ki jb kd b gy kj kk l kl km">{<br/>    "scripts": {<br/>        "docs:dev": "vuepress dev docs",<br/>        "docs:build": "vuepress build docs"<br/>    }<br/>}</span></pre><p id="207e" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">在您处理文档时，将从项目的根位置<code class="fe lm ln lo kd b">&lt;folder name&gt;</code>使用<code class="fe lm ln lo kd b">docs:dev</code>命令来查看文档站点。它是热重装的，所以当你保存时，你可以立即看到你的改变</p><p id="2797" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">我们的Travis脚本将使用第二个命令来生成静态站点。我们现在将对其进行配置。</p><p id="3106" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">打开<code class="fe lm ln lo kd b">.travis.yml</code>文件，复制以下内容:</p><pre class="jy jz ka kb gt kc kd ke kf aw kg bi"><span id="618a" class="kh ki jb kd b gy kj kk l kl km">language: node_js<br/>node_js:<br/>    - "10"<br/>env:<br/>    - CXX=g++-4.8</span><span id="71f5" class="kh ki jb kd b gy md kk l kl km">addons:<br/>    apt:<br/>        sources:<br/>            - ubuntu-toolchain-r-test<br/>        packages:<br/>            - g++-4.8<br/>install:<br/>    - npm install -g vuepress<br/>script:<br/>    - npm run docs:build<br/>cache:<br/>    directories:<br/>        - "node_modules"<br/>notifications:<br/>    email: false<br/>deploy:<br/>    provider: pages<br/>    skip-cleanup: true<br/>    local_dir: docs/.vuepress/dist<br/>    github-token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable<br/>    repo: &lt;username || or org name&gt;/&lt;publication repo name&gt;<br/>    keep-history: true<br/>    target-branch: master<br/>    on:<br/>        branch: master</span></pre><p id="13fb" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">我们首先安装nodejs 10默认情况下Travis安装的是旧版本，与要求nodejs ≥ 8的vuepress不兼容。然后Vuepress被全局安装，我们运行之前配置的构建脚本。我们像这样缓存<code class="fe lm ln lo kd b">node_modules</code>，下一次构建会更快。我不想收到每个版本的邮件，所以我在这里关闭了它。如果你想收到电子邮件，删除它。</p><p id="8d47" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">然后我们部署构建的结果。注意，我们只获取了<code class="fe lm ln lo kd b">dist</code>文件夹中生成的内容。为了发布到repo，我们需要一个git令牌。我们接下来会这样做，但这是我们将在Travis中使用的变量名。</p><p id="a9bb" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">然后我们设置<code class="fe lm ln lo kd b">repo</code>要发布到哪个分支上。<code class="fe lm ln lo kd b">keep-history</code>属性非常重要。没有它，你将没有任何东西可以发布，因为Travis已经删除了这些文件。所以，是的，保留这些文件，以便我们可以把它推到某个地方；)</p><p id="334c" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">对于GitHub令牌，转到您的设置(屏幕右上角您的头像的下拉菜单)，在左侧菜单中点击<code class="fe lm ln lo kd b">Developer Settings</code>，然后点击<code class="fe lm ln lo kd b">Personal Access Tokens</code>。创建一个新的。你只能看到一次…所以复制它，我们现在将设置特拉维斯。如果你没有得到我，有一个由GitHub出版的<a class="ae ll" href="https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/" rel="noopener ugc nofollow" target="_blank">逐步指南</a></p><p id="4b10" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">现在，关于您的Travis帐户，我们需要:</p><ol class=""><li id="1bbd" class="lp lq jb kp b kq kr ku kv ky lr lc ls lg lt lk lu lv lw lx bi translated">连接您的Github帐户</li><li id="b102" class="lp lq jb kp b kq ly ku lz ky ma lc mb lg mc lk lu lv lw lx bi translated">激活您的工作库</li></ol><p id="a88b" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">完成后，转到您的项目设置:</p><figure class="jy jz ka kb gt is gh gi paragraph-image"><div class="gh gi me"><img src="../Images/c7c74a0e97129fb8a6449f2f6794cba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*RgioGAGYq8AHrFlSThvTNw.png"/></div></figure><p id="8904" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">你可以在<code class="fe lm ln lo kd b">More options</code>下拉列表中找到这个。您将看到以下屏幕:</p><figure class="jy jz ka kb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mf"><img src="../Images/d462a6f18ecdddb9ae562ac5455f0bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-uUhT3fJGpSIOtxpfxamw.png"/></div></div></figure><p id="3b68" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">您可以在这里创建新的环境变量。创建一个值为<code class="fe lm ln lo kd b">GITHUB_TOKEN</code>的新令牌，没有<code class="fe lm ln lo kd b">$</code>符号，并在该值中添加您新创建的GitHub令牌的值。确保切换设置为红色框中的状态。这将隐藏构建日志中的变量值。这很重要。如果没有，你会给谁访问你的仓库。</p><p id="3abc" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">最后一步，我们需要配置GitHub页面。转到出版物存储库的设置:</p><figure class="jy jz ka kb gt is gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/042b7af3683ae3f26718768fe65ed384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*7yKrP3kmnpI2uethJ7FYyQ.png"/></div></figure><p id="f220" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">向下滚动到GitHub页面配置并设置:</p><figure class="jy jz ka kb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mh"><img src="../Images/df670054b809e8d9154d8e1650ba137d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZnhKtK3Khyyey6fyleisow.png"/></div></div></figure><p id="c65d" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">请注意源是<code class="fe lm ln lo kd b">master branch</code>，您是否看到路径的最后一段以红色突出显示？这是您的存储库的名称，也是我们在<code class="fe lm ln lo kd b">config.js</code>文件中配置的<code class="fe lm ln lo kd b">base</code>属性。</p><p id="0996" class="pw-post-body-paragraph kn ko jb kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ij bi translated">正常情况下，一切都应该正常。是的通常情况下。通过在你的<code class="fe lm ln lo kd b">docs</code>文件夹中添加一些Markdown文件来创建一些内容，然后推送你的更改，坐下来，享受自动化的数字世界为你工作。</p></div></div>    
</body>
</html>
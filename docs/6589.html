<html>
<head>
<title>Create an Azure Databricks workspace using Bicep Language</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Bicep语言创建Azure Databricks工作区</h1>
<blockquote>原文：<a href="https://itnext.io/create-an-azure-databricks-workspace-using-bicep-language-60d86e97fda4?source=collection_archive---------2-----------------------#2021-12-27">https://itnext.io/create-an-azure-databricks-workspace-using-bicep-language-60d86e97fda4?source=collection_archive---------2-----------------------#2021-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8ce4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">学习利用基础设施即代码来创建Azure Databricks工作区。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/e1aeacc0696d667a7c29d75cf1861c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3cv8VdqrTJS8sUcK-85f2Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">使用Bicep语言创建Azure Databricks工作区</figcaption></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="bec4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将使用Bicep语言创建一个Azure Databricks工作区，Bicep语言是一种特定于领域的<strong class="jp ir">语言</strong> (DSL)，它使用声明性语法来部署Azure资源。</p><h1 id="281f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">为什么选择Azure Databricks？</h1><p id="9cf9" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated"><strong class="jp ir"> Azure Databricks </strong>旨在与Azure数据存储和服务无缝集成。<strong class="jp ir"> Azure Databricks </strong>是一个快速、简单、协作的基于Apache Spark的大数据分析服务，专为数据科学和数据工程而设计。</p><p id="90aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以利用三种环境来开发数据密集型应用程序:</p><ul class=""><li id="525d" class="ml mm iq jp b jq jr ju jv jy mn kc mo kg mp kk mq mr ms mt bi translated">数据块SQL</li><li id="125f" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">Databricks数据科学与工程</li><li id="9525" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">数据块机器学习</li></ul><h1 id="344f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">azure data bricks——高级架构</h1><p id="b5f6" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">Azure Databricks在<em class="mz">控制平面</em>和<em class="mz">数据平面之外运行。</em></p><ul class=""><li id="daeb" class="ml mm iq jp b jq jr ju jv jy mn kc mo kg mp kk mq mr ms mt bi translated">控制平面包含Azure帐户中管理的后端服务。</li><li id="a929" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">数据层是您的数据所在的位置，将由您的Azure帐户管理。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi na"><img src="../Images/2817f024410c745c26e0f35e29129a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xgR2Nq_joOpK7407.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Azure Databricks架构</figcaption></figure><p id="3615" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在使用Azure Databricks之前，您需要有一个<em class="mz">工作空间</em>。</p><p id="3769" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个工作区是访问所有数据块资产的基本组件。工作区将包含多个对象，您可以将它们组织到文件夹中，并支持对这些对象和计算资源的粒度访问。</p><p id="1711" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mz">工作空间</em>包括:</p><ul class=""><li id="2d25" class="ml mm iq jp b jq jr ju jv jy mn kc mo kg mp kk mq mr ms mt bi translated">笔记本电脑</li><li id="7531" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">仪表盘</li><li id="bbed" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">图书馆</li><li id="ccbb" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">被卖方收回的汽车</li><li id="4dc8" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">实验</li></ul><p id="2376" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将使用Bicep语言创建一个Azure Databricks工作区。</p><h1 id="5265" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">使用Bicep语言创建Azure Databricks工作区</h1><h2 id="bb67" class="nb lj iq bd lk nc nd dn lo ne nf dp ls jy ng nh lw kc ni nj ma kg nk nl me nm bi translated">先决条件。</h2><ul class=""><li id="068a" class="ml mm iq jp b jq mg ju mh jy nn kc no kg np kk mq mr ms mt bi translated">有效的Azure订阅</li><li id="f6ba" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">在订阅中创建资源的权限</li><li id="79f2" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">Azure Biccep已安装—<a class="ae nq" href="https://bit.ly/bicep-install" rel="noopener ugc nofollow" target="_blank">bit.ly/bicep-install</a></li><li id="2589" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">Azure PowerShell</li></ul><h1 id="0849" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">解决方案概述</h1><p id="3352" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">我们将创作一个Bicep模板，创建一个Azure Databricks workspace的实例，用于访问所有Azure Databricks资产。</p><p id="ac9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该解决方案将包括以下文件:</p><ul class=""><li id="392f" class="ml mm iq jp b jq jr ju jv jy mn kc mo kg mp kk mq mr ms mt bi translated"><strong class="jp ir">📄<em class="mz"> main.bicep </em> </strong>:这是二头肌模板</li><li id="0f25" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated"><strong class="jp ir">📄<em class="mz">azure deploy . parameters . JSON</em></strong>:这个参数文件包含用于部署Bicep模板的值。</li></ul><p id="5f47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开始吧！</p><h1 id="0db9" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建Azure权限的Azure Bicep文件</h1><p id="66e5" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">第一步是创建一个名为'<em class="mz"> main.bicep </em>'的文件，我们将从定义Azure Databricks workspace实例的几个参数开始。</p><h1 id="cfde" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">Azure Bicep文件-参数</h1><p id="2dba" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">在您的工作目录中创建一个新文件，并将其命名为'<em class="mz"> main.bicep </em>'。我们将定义以下参数:</p><pre class="km kn ko kp gt nr ns nt nu aw nv bi"><span id="4cc4" class="nb lj iq ns b gy nw nx l ny nz">@description('Specifies whether to deploy Azure Databricks workspace with Secure Cluster Connectivity (No Public IP) enabled or not')<br/>param disablePublicIp bool = false</span><span id="bf77" class="nb lj iq ns b gy oa nx l ny nz">@description('The name of the Azure Databricks workspace to create.')<br/>param workspaceName string</span><span id="f6d9" class="nb lj iq ns b gy oa nx l ny nz">@description('The pricing tier of workspace.')<br/>@allowed([<br/>  'standard'<br/>  'premium'<br/>])<br/>param pricingTier string = 'premium'</span><span id="701e" class="nb lj iq ns b gy oa nx l ny nz">@description('Location for all resources.')<br/>param location string = resourceGroup().location</span></pre><p id="5fd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将为托管资源组名称定义一个变量:</p><pre class="km kn ko kp gt nr ns nt nu aw nv bi"><span id="e10f" class="nb lj iq ns b gy nw nx l ny nz">var managedResourceGroupName = 'databricks-rg-${workspaceName}-${uniqueString(workspaceName, resourceGroup().id)}'</span></pre><h1 id="388f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">Azure Bicep模板—参考资料部分</h1><p id="373e" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">我们将定义Azure Databricks工作区的实例:</p><pre class="km kn ko kp gt nr ns nt nu aw nv bi"><span id="f33f" class="nb lj iq ns b gy nw nx l ny nz">resource workspaceName_resource 'Microsoft.Databricks/workspaces@2018-04-01' = {<br/>  name: workspaceName<br/>  location: location<br/>  sku: {<br/>    name: pricingTier<br/>  }<br/>  properties: {<br/>    managedResourceGroupId: subscriptionResourceId('Microsoft.Resources/resourceGroups', managedResourceGroupName)<br/>    parameters: {<br/>      enableNoPublicIp: {<br/>        value: disablePublicIp<br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="a1bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，您可以为工作区属性定义一个输出，如下所示:</p><pre class="km kn ko kp gt nr ns nt nu aw nv bi"><span id="d516" class="nb lj iq ns b gy nw nx l ny nz">output workspace object = workspaceName_resource.properties</span></pre><h1 id="053d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">参数文件</h1><p id="1a65" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">创建一个名为“<em class="mz">azure deploy . parameters . JSON</em>”的新文件。下面的代码显示了参数文件的定义:</p><pre class="km kn ko kp gt nr ns nt nu aw nv bi"><span id="340f" class="nb lj iq ns b gy nw nx l ny nz">{<br/>    "$schema": "<a class="ae nq" href="https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#</a>",<br/>    "contentVersion": "1.0.0.0",<br/>    "parameters": {<br/>      "disablePublicIp": {<br/>        "value": false,<br/>        "allowedValues": [<br/>            false,<br/>            true<br/>          ]<br/>      },<br/>      "workspaceName": {<br/>        "value": "Your-Workspace-Name"<br/>      },<br/>      "pricingTier": {<br/>        "value": "premium"<br/>      }<br/>    }<br/>  }</span></pre><h1 id="176f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">Azure Bicep模板-部署</h1><p id="4315" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">我们将使用下面的命令来部署我们的二头肌模板:</p><pre class="km kn ko kp gt nr ns nt nu aw nv bi"><span id="6ac6" class="nb lj iq ns b gy nw nx l ny nz">$date = Get-Date -Format "MM-dd-yyyy"<br/>$deploymentName = "AzInsiderDeployment"+"$date"</span><span id="855f" class="nb lj iq ns b gy oa nx l ny nz">New-AzResourceGroupDeployment -Name $deploymentName -ResourceGroupName azinsider_demo -TemplateFile .\main.bicep -TemplateParameterFile .\azuredeploy.parameters.json -c</span></pre><p id="5bae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">提示:您可以创建一个script.ps1并运行该脚本来执行这个部署。</p><p id="dc21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:在执行实际部署操作之前，我们利用假设操作来验证我们的部署。</p><p id="be57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图显示了部署的预览:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ob"><img src="../Images/3d416d904de13b619a964a2eeb650e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsrNQyIhq4jgx88zmkVlYg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Azure Databricks工作区— BIcep语言部署</figcaption></figure><p id="264e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们将执行部署。下图显示了部署输出:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oc"><img src="../Images/ea26b4150dda9c585f51a92fb1648e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*41n1XcDFkfLa5tAbryPyLw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Azure Databricks工作区— BIcep语言部署操作</figcaption></figure><p id="3619" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在下面的URL中找到这个解决方案的代码，请随意投稿！</p><div class="od oe gp gr of og"><a href="https://github.com/daveRendon/azinsider/tree/main/application-workloads/azure-databricks-workspace" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">azin sider/应用程序-工作负载/azure-数据块-主daveRendon/azinsider上的工作区</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">在GitHub上创建一个帐户，为daveRendon/azinsider开发做出贡献。</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">github.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kv og"/></div></div></a></div><p id="d4c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在Azure门户中，您应该会看到Azure Databricks服务的实例，如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ov"><img src="../Images/83d1ef72f0f97c6f4c928b274c71ee10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KwXIcyl9ahDftc6E--FzHA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Azure门户— Azure数据块</figcaption></figure><p id="921d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，您可以启动您的工作区，并登录到Databricks:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ow"><img src="../Images/e18721fa1f434a81e0d830404923a003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r19eVKXwVraIx5Vlun_BtA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">数据块登录</figcaption></figure><p id="4412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">登录后，您将访问Azure Databricks UI，这是一个工作区文件夹及其包含的对象、数据对象和计算资源的图形界面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ox"><img src="../Images/e3e13e774ad534444371188cf6948718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UqELGn-MrtxmS_IBdSYNTg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Azure数据砖块用户界面</figcaption></figure><h1 id="3477" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结论</h1><p id="1569" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">在本文中，我们回顾了如何使用Bicep语言利用基础设施即代码来创建Azure Databricks工作区，并验证了部署。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><a href="https://www.buymeacoffee.com/drbmc"><div class="gh gi oy"><img src="../Images/2c5b182596bd701cac27cf5b4a1128a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*heGyKzpzJvQEmpjSYldJWQ.png"/></div></a></figure><p id="ae8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">👉<a class="ae nq" href="http://eepurl.com/gKmLdf" rel="noopener ugc nofollow" target="_blank"> <em class="mz">在此加入</em><strong class="jp ir"><em class="mz">azin sider</em></strong><em class="mz">邮箱列表。</em>T11】</a></p><p id="4ca6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mz">-戴夫·r</em></p></div></div>    
</body>
</html>
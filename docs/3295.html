<html>
<head>
<title>Changing children's state from another component with React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React挂钩从另一个组件更改子组件的状态</h1>
<blockquote>原文：<a href="https://itnext.io/changing-children-state-from-another-component-with-react-hooks-5c982c042e8?source=collection_archive---------1-----------------------#2019-11-17">https://itnext.io/changing-children-state-from-another-component-with-react-hooks-5c982c042e8?source=collection_archive---------1-----------------------#2019-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2568" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近，我经常使用React进行快速原型开发和开发人员交接，但是当您需要从一个组件改变另一个组件的状态时，我遇到了问题——在我的例子中，它是一个“Toast”组件。今天，让我们考虑几个关于这项任务的例子。</p><blockquote class="kl"><p id="b3a7" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated">任务 ⤵</p><p id="2d72" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="kv">我们在父组件中有一个CTA按钮，当我们单击它时，会显示一个子组件。子组件有一个“关闭”按钮，当我们点击它时，我们隐藏子组件。</em></p></blockquote><p id="cb74" class="pw-post-body-paragraph jn jo iq jp b jq kw js jt ju kx jw jx jy ky ka kb kc kz ke kf kg la ki kj kk ij bi translated">这里主要的事情是我们需要从父组件中改变子组件的状态——我们应该只有一个可共享的状态。如果<code class="fe lb lc ld le b">states</code>和<code class="fe lb lc ld le b">props</code>相同的话就简单多了，因为在React中传球我们可以很容易的通过道具，但不幸的是，不可以——<code class="fe lb lc ld le b">states</code>是动态的，<code class="fe lb lc ld le b">props</code>是静态的。</p></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h1 id="ee76" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">设计和状态</h1><p id="1ca1" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">这是对与错陈述的基本切换情况。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mp"><img src="../Images/afae66676c2af70949cefd95537fa10e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTyL0H2KQ4d0Khepv2zXbg.png"/></div></div></figure></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h1 id="6847" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">解决方案1。使用Ref</h1><p id="938b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">在本例中，我们使用了<code class="fe lb lc ld le b">useRef</code>、<code class="fe lb lc ld le b">forwardRef</code>和<code class="fe lb lc ld le b">useImperativeHandle</code>。</p><p id="18b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在父组件中使用<code class="fe lb lc ld le b">useRef</code>，我们可以使用<code class="fe lb lc ld le b">useImperativeHandle</code>到达子组件中的函数、属性和值。</p><p id="c415" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nb">例如，我们在子组件中有这个函数，我们需要将它放到外部来显示:</em></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nc"><img src="../Images/f1e3357b632a0f62f5e21c7ed6f56d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8SKsrdLglzxj887gLNMnMw.png"/></div></div></figure><p id="d500" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nb">当</em> <code class="fe lb lc ld le b"><em class="nb">value</em></code> <em class="nb">为</em> <code class="fe lb lc ld le b"><em class="nb">true</em></code> <em class="nb">时我们显示该组件，当</em> <code class="fe lb lc ld le b"><em class="nb">false</em></code> <em class="nb">时我们通过切换className: </em>将其隐藏</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nc"><img src="../Images/2bf081b9b8935511b085dc299843537f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nli8TsmjNQW5J9m_eAeg2g.png"/></div></div></figure><p id="a389" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nb">为此，我们需要创建</em> <code class="fe lb lc ld le b"><em class="nb">useImperativeHandle</em></code> <em class="nb">并在这里添加</em><code class="fe lb lc ld le b"><em class="nb">showToast</em></code><em class="nb"/></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nc"><img src="../Images/0afa249d2025323231a3dbbbf4af6111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6p5i5kU2BaomMayA-NC5Q.png"/></div></div></figure><p id="6fa6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nb">然后在父组件中，我们可以到达</em> <code class="fe lb lc ld le b"><em class="nb">showToast</em></code> <em class="nb">函数调用</em> <code class="fe lb lc ld le b"><em class="nb">ref.current</em></code></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nc"><img src="../Images/92398f4e92d642e8373d68b9f8cea631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAfYdkfphtcHWII_NYFBOw.png"/></div></div></figure><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h1 id="d08e" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">解决方案2。使用上下文提供程序</h1><p id="c587" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">在这种情况下，我们将为子组件和父组件共享相同的上下文。</p><p id="b485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为此，我们需要创建一个新文件<code class="fe lb lc ld le b">ToastProvider.js</code>并将我们的上下文放在那里:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nc"><img src="../Images/dbdd6074ce78376c8243dae376183012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pjKlbYJxwKD0oqi9J_nKBg.png"/></div></div></figure><p id="52ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们将谷歌这种方法，许多情况下将致力于主题改变<code class="fe lb lc ld le b">ThemeProvider</code>就像这个例子——<a class="ae nf" href="https://codesandbox.io/s/m5q79oq8y8?from-embed" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/m5q79oq8y8?from-embed</a></p><p id="647f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们的解决方案:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h1 id="a65d" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">就这些，谢谢:-)如果你有自己的解决方案，请叉开我的例子，在下面的评论区留下你的解决方案，我会添加到文章中。</h1></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><p id="c685" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对这篇文章的特别“感谢”是针对这个StackOverflow问题:</p><div class="ng nh gp gr ni nj"><a href="https://stackoverflow.com/questions/55889357/change-react-hook-state-from-parent-component" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">从父组件更改反应挂钩状态</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">stackoverflow.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx mz nj"/></div></div></a></div></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h1 id="d197" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">参考文献</h1><p id="ee4e" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">以下是关于该主题的一些附加材料和文章:</p><div class="ng nh gp gr ni nj"><a href="https://hackernoon.com/how-do-i-use-react-context-3eeb879169a2" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">如何使用新的React上下文API</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">谣言满天飞！语境能代替redux吗？是不是让道具钻灭绝了？就算语境！==世界和平……</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">hackernoon.com</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx mz nj"/></div></div></a></div><div class="ng nh gp gr ni nj"><a href="https://medium.com/simply/state-management-with-react-hooks-and-context-api-at-10-lines-of-code-baf6be8302c" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">用10行代码实现React钩子和上下文API的状态管理！</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">终极和超级简单的Redux替代你的应用程序。</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nz l nu nv nw ns nx mz nj"/></div></div></a></div><div class="ng nh gp gr ni nj"><a href="https://blog.bitsrc.io/state-of-react-state-management-in-2019-779647206bbc" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">2019年反应状态管理状态</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">在野外观察国家管理…商店开门营业了！🐯</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">blog.bitsrc.io</p></div></div><div class="ns l"><div class="oa l nu nv nw ns nx mz nj"/></div></div></a></div><div class="ng nh gp gr ni nj"><a href="https://medium.com/javascript-in-plain-english/state-management-with-react-hooks-no-redux-or-context-api-8b3035ceecf8" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">使用React挂钩进行状态管理——没有冗余或上下文API</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">反应钩比你想象的更强大。今天，我们将探索它并开发一个自定义挂钩来管理…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="ob l nu nv nw ns nx mz nj"/></div></div></a></div><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="nd ne l"/></div></figure><div class="ng nh gp gr ni nj"><a href="https://github.com/diegohaz/awesome-react-context" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">diegohaz/awesome-react-上下文</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">一个与新的React上下文API特性相关的精选列表🔥Constate，一个状态管理库，使用…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="oc l nu nv nw ns nx mz nj"/></div></div></a></div><div class="ng nh gp gr ni nj"><a href="https://medium.com/@pgivens/simplifying-global-state-with-react-hooks-4d7df52d363" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">用React钩子简化全局状态</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">用useContext和useReducer构建一个极简的全局状态管理解决方案</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="od l nu nv nw ns nx mz nj"/></div></div></a></div></div></div>    
</body>
</html>
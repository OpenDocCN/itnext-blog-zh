<html>
<head>
<title>Testing Jakarta EE 9 Applications with Arquillian and Glassfish v6</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Arquillian和Glassfish v6测试Jakarta EE 9应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/testing-jakarta-ee-9-applications-with-arquillian-and-glassfish-v6-9981e454e6eb?source=collection_archive---------2-----------------------#2020-12-04">https://itnext.io/testing-jakarta-ee-9-applications-with-arquillian-and-glassfish-v6-9981e454e6eb?source=collection_archive---------2-----------------------#2020-12-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f0df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="http://www.arquillian.org" rel="noopener ugc nofollow" target="_blank"> Arquillian </a>增加了一个新模块<a class="ae kl" href="https://github.com/arquillian/arquillian-container-glassfish6" rel="noopener ugc nofollow" target="_blank">Arquillian Container glassfish 6</a>以配合Jakarta EE 9的变化和Arquillian Core 1.7.0中引入的特性。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/bbe525b66addc9069a161aebd3e74370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZgar-TMaqJ9r-ovXsLz_A.png"/></div></div></figure><p id="174e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Arquillian容器Glassfish6 被指定在Glassfish v6上运行测试，Glassfish V6是一个全功能的Jakarta EE 9兼容应用服务器，因此您可以使用这个新的Arquillian Glassfish容器测试所有Jakarta EE 9组件。</p><p id="7af0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将尝试使用托管和远程适配器在Glassfish容器上运行我们的测试。</p><ul class=""><li id="9ba9" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">使用托管适配器时，Arquillian能够管理Glassfish服务器的生命周期，例如，在测试执行期间启动和停止容器。</li><li id="10ee" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">当使用远程适配器时，Arquillian将尝试对远程容器运行测试，并通过代理收集测试报告并发送回客户端(IDE、Maven命令控制台等)。).</li></ul><blockquote class="lm ln lo"><p id="e57a" class="jn jo lp jp b jq jr js jt ju jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj kk ij bi translated"><em class="iq">注意:原来的</em><a class="ae kl" href="https://github.com/arquillian/arquillian-container-glassfish/tree/master/glassfish-embedded-3.1" rel="noopener ugc nofollow" target="_blank"><em class="iq">Aruqillian Glassfish嵌入式容器</em> </a> <em class="iq">现在没有移植到最新的Glassfish v6上。</em></p></blockquote></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="127c" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">先决条件</h1><ul class=""><li id="7a76" class="ky kz iq jp b jq my ju mz jy na kc nb kg nc kk ld le lf lg bi translated">Java 8 ( <a class="ae kl" href="https://openjdk.java.net/install/" rel="noopener ugc nofollow" target="_blank"> OpenJDK </a>或<a class="ae kl" href="https://adoptopenjdk.net/installation.html" rel="noopener ugc nofollow" target="_blank"> AdoptOpenJDK </a></li><li id="2e77" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">最新<a class="ae kl" href="http://maven.apache.org/download.cgi" rel="noopener ugc nofollow" target="_blank">阿帕奇Maven </a></li><li id="dfba" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><a class="ae kl" href="https://junit.org/junit5/" rel="noopener ugc nofollow" target="_blank"> JUnit的基础知识5 </a></li><li id="6d52" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">了解阿尔奎利亚语的基础</li></ul><blockquote class="lm ln lo"><p id="4d85" class="jn jo lp jp b jq jr js jt ju jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj kk ij bi translated"><em class="iq">注意:确保你使用的是Java 8，Glassfish v6.0不支持Java 11。Glassfish v6.1将专注于Java 11支持。</em></p></blockquote></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="07aa" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">测试Restful Web服务</h1><p id="62e3" class="pw-post-body-paragraph jn jo iq jp b jq my js jt ju mz jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">目前，我们的示例项目中只包含了两个简单的Arquillian集成测试，我们在上一篇文章中已经介绍了CDI组件。</p><p id="f1ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们继续讨论<code class="fe ng nh ni nj b">GreetingResourceTest</code>。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="3696" class="no mb iq nj b gy np nq l nr ns">@ExtendWith(ArquillianExtension.class)<br/>public class GreetingResourceTest {<br/>    private final static Logger LOGGER = Logger.getLogger(GreetingResourceTest.class.getName());</span><span id="5a3b" class="no mb iq nj b gy nt nq l nr ns">    @Deployment(testable = false)<br/>    public static WebArchive createDeployment() {<br/>        return ShrinkWrap.create(WebArchive.class)<br/>                .addClass(GreetingMessage.class)<br/>                .addClass(GreetingService.class)<br/>                .addClasses(GreetingResource.class, JaxrsActivator.class)<br/>                // Enable CDI<br/>                .addAsWebInfResource(EmptyAsset.INSTANCE, "beans.xml");<br/>    }</span><span id="17eb" class="no mb iq nj b gy nt nq l nr ns">    @ArquillianResource<br/>    private URL base;</span><span id="4280" class="no mb iq nj b gy nt nq l nr ns">    private Client client;</span><span id="dc18" class="no mb iq nj b gy nt nq l nr ns">    @BeforeEach<br/>    public void setup() {<br/>        this.client = ClientBuilder.newClient();<br/>        //removed the Jackson json provider registry, due to OpenLiberty 21.0.0.1 switched to use Resteasy.<br/>    }</span><span id="2624" class="no mb iq nj b gy nt nq l nr ns">    @AfterEach<br/>    public void teardown() {<br/>        if (this.client != null) {<br/>            this.client.close();<br/>        }<br/>    }</span><span id="c3b1" class="no mb iq nj b gy nt nq l nr ns">    @Test<br/>    public void should_create_greeting() throws MalformedURLException {<br/>        LOGGER.log(Level.INFO, " Running test:: GreetingResourceTest#should_create_greeting ... ");<br/>        final WebTarget greetingTarget = client.target(new URL(base, "api/greeting/JakartaEE").toExternalForm());<br/>        try (final Response greetingGetResponse = greetingTarget.request()<br/>                .accept(MediaType.APPLICATION_JSON)<br/>                .get()) {<br/>            assertThat(greetingGetResponse.getStatus()).isEqualTo(200);<br/>            assertThat(greetingGetResponse.readEntity(GreetingMessage.class).getMessage()).startsWith("Say Hello to JakartaEE");<br/>        }<br/>    }<br/>}</span></pre><p id="19c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中。</p><ul class=""><li id="15c9" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">使用一个<code class="fe ng nh ni nj b">@ExtendWith(ArquillianExtension.class)</code>来扩展默认的JUnit生命周期，JUnit 5中新引入了<code class="fe ng nh ni nj b">@ExtendWith</code>来取代<code class="fe ng nh ni nj b">@RunWith(...)</code>。</li><li id="d46f" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">用<code class="fe ng nh ni nj b">@Deployment(testable = false)</code>标注的静态方法用于描述部署单元。这里的<code class="fe ng nh ni nj b">testable = false</code>表示这个测试是以客户端模式运行的，您不能像以前一样注入beans。</li><li id="d523" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">通过一个<code class="fe ng nh ni nj b">@ArquillianResource</code>注释，您可以在这个应用程序被部署到目标服务器之后获得它的URL。</li><li id="6b77" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">一个测试方法被标注了<code class="fe ng nh ni nj b">@Test</code>注释。</li></ul><p id="6a83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe ng nh ni nj b">should_create_greeting</code>方法中，它使用Restful WS客户端API与Restful APIs握手。您应该添加Restful WS客户端的实现。目前只有<strong class="jp ir">泽</strong>完成了变身。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="f5c7" class="no mb iq nj b gy np nq l nr ns">&lt;!-- Jersey --&gt;<br/>&lt;dependency&gt;<br/>    &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br/>    &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt;<br/>    &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;<br/>&lt;dependency&gt;<br/>    &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br/>    &lt;artifactId&gt;jersey-media-json-binding&lt;/artifactId&gt;<br/>    &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;<br/>&lt;dependency&gt;<br/>    &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;<br/>    &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;<br/>    &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;<br/>&lt;dependency&gt;<br/>    &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;<br/>    &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;<br/>    &lt;version&gt;${jersey.version}&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><p id="e5b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中，添加了一些依赖项。</p><ul class=""><li id="8420" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated"><code class="fe ng nh ni nj b">jersey-client</code>是Jakarta Restful WS Client的实现。</li><li id="9b05" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><code class="fe ng nh ni nj b">jersey-hk2</code>是<strong class="jp ir">球衣</strong>中的依赖注入引擎，将来会被CDI取代。</li><li id="04b4" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">使用<strong class="jp ir"> Jakarta JSON绑定</strong>将<code class="fe ng nh ni nj b">jersey-media-json-binding</code>用于JSON序列化和反序列化。</li><li id="5100" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><code class="fe ng nh ni nj b">jersey-media-sse</code>负责处理媒体类型<code class="fe ng nh ni nj b">text/event-stream</code>。</li></ul><p id="290a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在配置Arquillian Glassfish容器支持之前，请确保您已经添加了<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/docs/arq-weld.md" rel="noopener ugc nofollow" target="_blank"> Arquillian Jarkarta EE 9和JUnit 5依赖项</a>。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="fdb3" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">配置Glassfish托管容器适配器</h1><p id="1b87" class="pw-post-body-paragraph jn jo iq jp b jq my js jt ju mz jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">将<code class="fe ng nh ni nj b">arquillian-glassfish-managed-6</code>依赖项添加到您的项目中。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="0455" class="no mb iq nj b gy np nq l nr ns">&lt;dependency&gt;<br/>    &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;<br/>    &lt;artifactId&gt;arquillian-glassfish-managed-6&lt;/artifactId&gt;<br/>    &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><p id="4cd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<em class="lp"> arquillian.xml </em>文件中创建一个容器配置。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="d43b" class="no mb iq nj b gy np nq l nr ns">&lt;container qualifier="arq-glassfish-managed"&gt;<br/>    &lt;configuration&gt;<br/>        &lt;property name="allowConnectingToRunningServer"&gt;false&lt;/property&gt;<br/>        &lt;!--            &lt;property name="glassFishHome"&gt;target/${glassfish.home}&lt;/property&gt;--&gt;<br/>        &lt;property name="adminHost"&gt;localhost&lt;/property&gt;<br/>        &lt;property name="adminPort"&gt;4848&lt;/property&gt;<br/>        &lt;property name="enableDerby"&gt;${enableDerby:true}&lt;/property&gt;<br/>        &lt;property name="outputToConsole"&gt;true&lt;/property&gt;<br/>    &lt;/configuration&gt;<br/>&lt;/container&gt;</span></pre><p id="f76f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在<em class="lp"> arquillian.xml </em>文件中定义一个<code class="fe ng nh ni nj b">glassFishHome</code>属性来指定本地系统中现有Glassfish服务器的位置。</p><p id="7c48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，为了获得一个干净的环境来每次运行您的测试，您可以配置一个<strong class="jp ir">依赖Maven插件</strong>来下载一份Glassfish，并使用它来运行您的测试。这是在您的CI服务器中连续运行测试的一个很好的选择。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="d1df" class="no mb iq nj b gy np nq l nr ns">&lt;plugin&gt;<br/>     &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>     &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;<br/>     &lt;version&gt;${maven-dependency-plugin.version}&lt;/version&gt;<br/>     &lt;executions&gt;<br/>         &lt;execution&gt;<br/>             &lt;id&gt;unpack&lt;/id&gt;<br/>             &lt;phase&gt;pre-integration-test&lt;/phase&gt;<br/>             &lt;goals&gt;<br/>                 &lt;goal&gt;unpack&lt;/goal&gt;<br/>             &lt;/goals&gt;<br/>             &lt;configuration&gt;<br/>                 &lt;artifactItems&gt;<br/>                     &lt;artifactItem&gt;<br/>                         &lt;groupId&gt;org.glassfish.main.distributions&lt;/groupId&gt;<br/>                         &lt;artifactId&gt;glassfish&lt;/artifactId&gt;<br/>                         &lt;version&gt;${glassfish.version}&lt;/version&gt;<br/>                         &lt;type&gt;zip&lt;/type&gt;<br/>                         &lt;overWrite&gt;false&lt;/overWrite&gt;<br/>                         &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;<br/>                     &lt;/artifactItem&gt;<br/>                 &lt;/artifactItems&gt;<br/>             &lt;/configuration&gt;<br/>         &lt;/execution&gt;<br/>     &lt;/executions&gt;<br/>&lt;/plugin&gt;<br/>&lt;plugin&gt;<br/>    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>    &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;<br/>    &lt;version&gt;${maven-failsafe-plugin.version}&lt;/version&gt;<br/>    &lt;configuration&gt;<br/>        &lt;environmentVariables&gt;<br/>            &lt;GLASSFISH_HOME&gt;${project.build.directory}/glassfish6&lt;/GLASSFISH_HOME&gt;<br/>        &lt;/environmentVariables&gt;<br/>    &lt;/configuration&gt;<br/>&lt;/plugin&gt;</span></pre><p id="e602" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行以下命令，对由Arquillian管理的Glassfish容器运行测试。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="d4d4" class="no mb iq nj b gy np nq l nr ns">mvn clean verify -Parq-glassfish-managed</span></pre><p id="a7c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在托管模式下，Arquillian负责启动和停止Glassfish容器。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="d7b8" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">配置Glassfish远程容器适配器</h1><p id="43c7" class="pw-post-body-paragraph jn jo iq jp b jq my js jt ju mz jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">使用Arquillian Glassfish远程容器，您可以针对正在运行的Glassfish服务器运行测试。它运行在不同的服务器上。</p><p id="2dcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">改为添加以下<code class="fe ng nh ni nj b">arquillian-glassfish-remote-6</code>依赖项。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="cac7" class="no mb iq nj b gy np nq l nr ns">&lt;dependency&gt;<br/>    &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;<br/>    &lt;artifactId&gt;arquillian-glassfish-remote-6&lt;/artifactId&gt;<br/>    &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;<br/>// the jersey client depdenceies are omitted.</span></pre><p id="7993" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并在该远程容器的<em class="lp"> arquillian.xml </em>文件中添加一个<em class="lp">容器</em>段，如果与默认值不同，则配置<code class="fe ng nh ni nj b">adminHost</code> <code class="fe ng nh ni nj b">adminPort</code>、<code class="fe ng nh ni nj b">adminUser</code>、<code class="fe ng nh ni nj b">adminPassword</code>。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="1897" class="no mb iq nj b gy np nq l nr ns">&lt;container qualifier="glassfish-remote"&gt;<br/>        &lt;configuration&gt;<br/>            &lt;!--Supported property names:<br/>            [adminHttps,<br/>            remoteServerHttpPort,<br/>            libraries,<br/>            type,<br/>            remoteServerAddress,<br/>            target,<br/>            retries,<br/>            remoteServerAdminPort,<br/>            remoteServerAdminHttps,<br/>            adminUser,<br/>            authorisation,<br/>            waitTimeMs,<br/>            adminPort,<br/>            properties,<br/>            adminPassword,<br/>            adminHost]--&gt;<br/>            &lt;property name="adminHost"&gt;localhost&lt;/property&gt;<br/>            &lt;property name="adminPort"&gt;4848&lt;/property&gt;<br/>            &lt;property name="adminUser"&gt;admin&lt;/property&gt;<br/>            &lt;!-- if https is enabled via `asadmin enable-secure-admin` on a remote server --&gt;<br/>            &lt;!-- &lt;property name="adminHttps"&gt;true&lt;/property&gt;--&gt;<br/>            &lt;!-- if admin password is changed via `asadmin change-admin-password` --&gt;<br/>            &lt;!--&lt;property name="adminPassword"&gt;adminadmin&lt;/property&gt;--&gt;<br/>            &lt;!-- default is empty --&gt;<br/>            &lt;property name="adminPassword"&gt;&lt;/property&gt;<br/>        &lt;/configuration&gt;<br/>    &lt;/container&gt;</span></pre><p id="f679" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在执行测试之前，确保目标Glassfish服务器正在运行。</p><p id="2d4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行以下命令，针对正在运行的Glassfish服务器运行测试。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="516a" class="no mb iq nj b gy np nq l nr ns">mvn clean verfiy -Parq-glassfish-managed</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="e0f2" class="ma mb iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">保护管理</h1><p id="740e" class="pw-post-body-paragraph jn jo iq jp b jq my js jt ju mz jw jx jy nd ka kb kc ne ke kf kg nf ki kj kk ij bi translated">默认情况下，Glassfish不会为<code class="fe ng nh ni nj b">admin</code>用户设置密码，您可以通过在Glassfish服务器端执行命令<code class="fe ng nh ni nj b">asadmin change-admin-password</code>来更改密码，不要忘记更改上面<em class="lp"> arquillian.xml </em>文件中<code class="fe ng nh ni nj b">adminPassword</code>属性的值。</p><p id="3d6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要在远程Glassfish服务器上部署应用程序，最好在远程Glassfish服务器上启用安全连接。在Glassfish端执行<code class="fe ng nh ni nj b">asadmin enable-secure-admin</code>来启用安全连接。相应地，在<em class="lp"> arquillian.xml </em>文件中将<code class="fe ng nh ni nj b">adminHttps</code>设置为<strong class="jp ir"> true </strong>。</p><p id="b627" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦设置了<code class="fe ng nh ni nj b">adminHttps</code>，当运行测试时，您可能会得到一个与SSL认证相关的异常，原因是客户端JVM无法识别Glassfish服务器中使用的证书。尝试按照以下步骤来克服这一障碍。</p><p id="7cc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，使用JDK附带的<code class="fe ng nh ni nj b">keytool</code>工具从<em class="lp"> [Glassfish安装目录]/Glassfish/domains/domain 1/config/keystore . jks</em>中导出证书。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="3cbe" class="no mb iq nj b gy np nq l nr ns">keytool -export -alias default -file testwlp.crt -keystore [Glassfish install dir]/glassfish/domains/domain1/config/keystore.jks</span></pre><p id="9d54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并将其导入到您用来运行测试的JVM中。</p><pre class="kn ko kp kq gt nk nj nl nm aw nn bi"><span id="3baf" class="no mb iq nj b gy np nq l nr ns">keytool -import -trustcacerts -keystore ${JAVA_HOME}/jre/lib/security/cacerts -storepass changeit -alias testwlp -file testwlp.crt -noprompt</span></pre><p id="0d06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在再次运行测试，证书异常应该会消失。</p><p id="fcb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从我的Github 中抓取一份<a class="ae kl" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank">源代码，然后自己探索它们。</a></p></div></div>    
</body>
</html>
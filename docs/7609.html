<html>
<head>
<title>Handling time zones in OutSystems: A case study</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在外部系统中处理时区:案例研究</h1>
<blockquote>原文：<a href="https://itnext.io/handling-time-zones-in-outsystems-a-case-study-4be0b1f8c02b?source=collection_archive---------2-----------------------#2022-11-22">https://itnext.io/handling-time-zones-in-outsystems-a-case-study-4be0b1f8c02b?source=collection_archive---------2-----------------------#2022-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/17598aa16dcfbb36ff27f35e8d2d7f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EGQv4Ayz8UEEGtsdFe0ehg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">世界时区</figcaption></figure><p id="44f3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">反应式应用程序在平台保存和显示<em class="la">日期时间</em>字段的方式上带来了一些新的更新。当用户保存一个<em class="la">日期时间</em>字段时，平台会自动将该值从用户时区转换为服务器时区。然后，当获取属性时，平台会反其道而行之，确保用户总是看到他们所在时区的值。</p><p id="082c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这样做是为了确保所有的<em class="la">日期时间</em>值都在同一个时区，并且您可以安全地比较这些属性。</p><p id="99db" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">很酷，对吧？这将为我们开发人员省去很多麻烦。但是有一个问题。如果用户为将在另一个时区发生的事件选择了一个<em class="la">日期时间</em>会怎么样？</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/9345da6677598bfcb0793ffd090f3995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpnjl3QsDrCyd1fkD_LHgQ.jpeg"/></div></div></figure><h1 id="673d" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">场景</h1><p id="431b" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">为了更好地理解OutSystems平台如何处理时区，让我们想象以下场景。我们正在为一家航空公司构建一个后台办公室，其中有一个用户，让我们称她为Mia，需要为她的公司将要乘坐的航班创建记录。</p><p id="7da1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Mia将打开应用程序，用下面的信息创建一个从洛杉矶到纽约的航班。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/7eb26216c45d537258065d9ffe56989b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cY0ErQ1A7VXtWXK_Iw3quA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">航班细节</figcaption></figure><p id="faca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可能知道，出发和到达时间总是在城市时区，即出发时间在洛杉矶时区，到达时间在纽约时区。因此，如果我们想用UTC(云的时区)保存这些值，我们应该有以下内容:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/dfb2496c28fb4c28fe374e0fbd6f5dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fYATmdERXHV_xVxo2gpiZQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">世界协调时出发时间</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/851ec981a703403287d424e5b31a33cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpJ_kNE0KZ9vdOLsl267EQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">到达世界协调时的时间</figcaption></figure><p id="3cdd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然而，正如您已经预料到的，这些不是我们将在数据库中找到的值。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/146599e2ca121376a1e9bb4beae7bdcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTho2hzG6tLepY0te3HI5g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">保存在数据库中的值</figcaption></figure><p id="8b1c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">平台将表单中输入的值转换为UTC，但假设Mia的时区(中欧时间)，这是完全不同的值。那么，如何避免这种情况呢？</p><p id="1d7d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通过将<em class="la">日期时间</em>属性的数据类型更改为<em class="la">文本，</em>平台将停止<em class="la"> </em>这些值的自动转换。尽管如此，这意味着我们需要在保存之前手动将<em class="la"> datetime </em>值转换为UTC，然后在获取时从UTC转换。好玩吧。</p><p id="416e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是在我们研究一些可能的方法之前，首先我们需要讨论时区类型。</p><h2 id="7dae" class="mn lh iq bd li mo mp dn lm mq mr dp lq kn ms mt lu kr mu mv ly kv mw mx mc my bi translated">首先:时区</h2><p id="e5ba" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">每个人都知道什么是时区，时区是如何工作的。但是，对于本文来说，理解存在多种时区是很重要的。</p><p id="3fee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您正在与微软合作，则有<a class="ae mz" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/default-time-zones?view=windows-11" rel="noopener ugc nofollow" target="_blank"> 141个时区可用</a>，如果您在微软数据库上执行以下查询，则可以获取这些时区。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/6e1f737ddb99825e73d0857df4055ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyqEwS5i9lMLoVRScEACdQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">查询以返回所有系统时区</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/9a8d36a26e266643c8640e5a0dde7872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_tFGEGfqk9675ZovN8uuQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">返回的时区</figcaption></figure><p id="46de" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这些标识符用于SQL Server和使用的forge组件中。NET来处理时区转换。</p><p id="35e1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然而，JavaScript使用一种不同的格式，叫做IANA。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7d5c06046c5cfc754f66eca3872487d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*JOSiGAYkw7GJ1pqXxx0t4g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">用JavaScript获取用户时区。</figcaption></figure><p id="992e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">理解这一点很重要，因为用于转换这些值的工具将决定所需的时区类型，从而决定数据模型。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="7dc5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们对时区有了更多的了解，让我们回到我们的问题上来:我们如何手动将城市时区转换为UTC，反之亦然？</p><p id="2571" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">1-</strong><a class="ae mz" href="https://www.outsystems.com/forge/component-overview/500/time-zone" rel="noopener ugc nofollow" target="_blank">T5】时区 </a> <strong class="ke ir">分量</strong></p><p id="b2e2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们可以利用该组件的动作将<em class="la"> datetime </em>值与UTC值相互转换。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/70d64c18fde2ba2f20721bac4f257003.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*xfUICmCOlb8rxOtUj1u78Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">时区_库操作</figcaption></figure><p id="b4c2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然而，如果我们想转换一个值，这是没问题的，但是如果我们想显示一个有多条记录的表，我们需要迭代每条记录，并在每次迭代中调用这个服务器动作，这在性能方面不是很好。</p><p id="f97b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> 2- SQL </strong></p><p id="efc0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了解决这个问题，我们可以利用我们的好朋友SQL。使用下面的语法，我们可以将一个<em class="la">日期时间</em>字段从一个时区转换到另一个时区。下面我们使用关键字<a class="ae mz" href="https://docs.microsoft.com/en-us/sql/t-sql/queries/at-time-zone-transact-sql?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank">在时区</a>将<em class="la"> UTC </em>当前时间转换为<em class="la">CEST</em>。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/2cfb8ec7d7ae831b64d7ac37b66dd1d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5rnKWPpRjsPrhUmBWjOk9A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">查询的输入</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/240832c042a44b390c88b8e64ba916ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoiSrg8sF148lwzd9XFbqA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">查询的输出</figcaption></figure><p id="4516" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个查询的输出(如上)将会是<em class="la"> datetimeoffset </em>格式<em class="la">，</em>这意味着如果您希望它是<em class="la"> datetime格式，</em>您将需要转换它:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/a434a3fabde55d9ed7d8fc38e5660371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XaHsHFEu_yUNz1D9wGR53g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用CONVERT输入查询</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/c63efb949a41126ca4472380daf0fe93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyhrTvwzmiKc_g0BV1FmyQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用CONVERT的查询输出</figcaption></figure><p id="1982" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">时区中的命令和时区组件中的操作使用Microsoft时区标识符。</p><h2 id="5fa7" class="mn lh iq bd li mo mp dn lm mq mr dp lq kn ms mt lu kr mu mv ly kv mw mx mc my bi translated">3- <a class="ae mz" href="https://www.outsystems.com/forge/component-overview/2199/timezonereactiveutils" rel="noopener ugc nofollow" target="_blank">时区反应实用程序</a>组件</h2><p id="b518" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">最后提出的解决方案利用了一个名为MomentJS的JavaScript库来解决这个问题。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/65696c7565f0183dae5c54b6434850f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*iAGyQTQjUjWaRQ9L86YRPw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">时区反应实用程序</figcaption></figure><p id="7d33" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">该组件具有可以在时区之间转换日期时间值的客户端操作，这使得在客户端执行该操作成为可能，而不是在服务器中执行该逻辑。</p><p id="2b49" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这种解决方案有几个优点:</p><p id="cdc5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">1.良好的性能，因为服务器上没有执行额外的时区转换逻辑。</p><p id="6a3b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2.<em class="la"> datetime </em>值总是在客户端进行转换，因此在服务器端，这些值总是采用UTC格式，这样更易于维护。</p><p id="3e9e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这些操作将IANA格式的时区作为输入。</p><h1 id="028c" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">解决办法</h1><p id="b74c" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">那么，让我们的注意力回到Mia和我们的后台应用程序，我们如何确保所有的日期时间值都被正确保存并显示给用户呢？</p><ol class=""><li id="57b2" class="nq nr iq ke b kf kg kj kk kn ns kr nt kv nu kz nv nw nx ny bi translated">将<em class="la">部门时间</em>和<em class="la">到达时间</em>字段更改为<em class="la">文本</em>以避免自动转换。</li><li id="942f" class="nq nr iq ke b kf nz kj oa kn ob kr oc kv od kz nv nw nx ny bi translated">以所需的格式保存相应城市的时区(这将取决于您选择的值转换方式)。在下面的例子中将使用IANA格式。</li></ol><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/40dbf62680599e91c2b154cf0f578922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-W0jDrSbXgQGO1OH0U6DXw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">数据模型</figcaption></figure><p id="4ade" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">3.在保存记录之前，请将值从城市时区转换为UTC。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/3fffc1548e38a2032dfb4f9170df7621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SW_nAhWHrZBYtEptt_2p3Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">保存操作</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/1558ef5a8e0bc2e943ee54ad4646ed15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q3fedqwn1agkjeIvxHCn3Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">TZ_ConvertToUTC操作的用法</figcaption></figure><p id="7ddb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">4.显示记录时，将值从UTC转换为城市时区。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/17631c4f11bfcd5f9d1870e41b9e3c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GLKXmqMbzUTlKCh4_gyvwg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">TZ _ convertfromuct操作的用法</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="ad55" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，让我们完全像以前一样创建另一个记录，但是在代码中做了这些更改。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/ee65b565657f3a70bf87a27d181e0693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gdeep9wcX3lc1Wtg7xZRw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">航班细节</figcaption></figure><p id="d76f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">并检查数据库…</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/b8e676c2f2fc23ba25e082969b3578bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7eCHjQqBSAWfr3x86TGBQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">以DepartureTime和ArrivalTime为文本的实体的详细信息</figcaption></figure><p id="a5f9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如我们所看到的，这些值被成功地转换为UTC。</p><p id="e7ad" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管如此，当Mia查看航班列表屏幕时，她会看到每个城市的时区时间。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/265a4758725242713898b0a529b900f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wM-yNCvmCkPETc1o7oRfUg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">转换为城市时区的日期时间值</figcaption></figure><h1 id="4add" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">技巧</h1><h2 id="860b" class="mn lh iq bd li mo mp dn lm mq mr dp lq kn ms mt lu kr mu mv ly kv mw mx mc my bi translated">1-小心空值</h2><p id="b61a" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">在您的<em class="la"> datetime </em>属性不是强制的情况下，您不希望转换空值，所以确保在保存或获取值时考虑到这一点。</p><p id="4de2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您正在使用来自<a class="ae mz" href="https://www.outsystems.com/forge/component-overview/2199/timezonereactiveutils" rel="noopener ugc nofollow" target="_blank">时区反应实用程序</a>的动作，这已经被自动处理了，但是如果您正在手动进行转换，请注意这一点。</p><h2 id="2128" class="mn lh iq bd li mo mp dn lm mq mr dp lq kn ms mt lu kr mu mv ly kv mw mx mc my bi translated">双日期选择器</h2><p id="c3d3" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">在将<em class="la">日期时间</em>字段转换为文本字段后，您将不再能够简单地将变量置于<em class="la">日期时间</em>输入中，并享受内置的日期选择器。</p><p id="d5b1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是，您可以使用OutSystemsUI的<em class="la"> DatePicker </em>小部件来解决这个问题。好的一面是，您将有更多高级选项可以使用。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/cde469100b012fb38ec4e22b8b64e606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OuW5T-iapP3G4oXeoSQmvg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">日期选择器小部件</figcaption></figure><h2 id="1fad" class="mn lh iq bd li mo mp dn lm mq mr dp lq kn ms mt lu kr mu mv ly kv mw mx mc my bi translated">3-获取用户时区</h2><p id="ca9b" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">如果出于某种原因您正在使用这种方法，但是在其他场景中您仍然需要将<em class="la"> datetime </em>转换为用户时区，也有一种方法可以做到这一点！</p><p id="bc57" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">组件<a class="ae mz" href="https://www.outsystems.com/forge/component-overview/2199/timezonereactiveutils" rel="noopener ugc nofollow" target="_blank"> Timezone Reactive Utils </a>有一个以IANA格式返回用户时区的动作。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/1820ed36904436a12a5610e41430da98.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*WHxxr-xY2mV10QOdvC4EjA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">TZ _获取用户时区操作</figcaption></figure><h1 id="dfe3" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="af2a" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">这里提出的解决方案只是解决自动转换<em class="la">日期时间</em>的许多可能想法之一。已经有了一个<a class="ae mz" href="https://www.outsystems.com/ideas/10564/make-datetime-conversion-to-client-timezone-in-reactive-apps-optional/" rel="noopener ugc nofollow" target="_blank">的想法</a>让这个特性可选，但是同时你仍然需要一个变通方法。</p><p id="20d8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你有其他方法做这件事吗？对提议的解决方案有任何问题吗？请在评论里告诉我:)</p><p id="3466" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你能从这篇文章中学到一些东西，感谢你的阅读！</p></div></div>    
</body>
</html>
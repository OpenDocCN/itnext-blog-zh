<html>
<head>
<title>Adding Elixir to Erlang via Rebar3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Rebar3向Erlang添加酏剂</h1>
<blockquote>原文：<a href="https://itnext.io/adding-elixir-to-erlang-via-rebar3-2ad83476b627?source=collection_archive---------1-----------------------#2022-10-07">https://itnext.io/adding-elixir-to-erlang-via-rebar3-2ad83476b627?source=collection_archive---------1-----------------------#2022-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5c0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi ko translated"><span class="l kp kq kr bm ks kt ku kv kw di"> E </span> lixir和Erlang都是运行在BEAM虚拟机上的函数式编程语言。两种语言的程序都被编译成字节码。可以从Erlang调用Elixir代码，反之亦然。因为Erlang模块由原子表示，所以可以很容易地从Elixir中调用Erlang库函数，如下所示</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/2c221fa4cc10b00414019b0f154b29aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*kQJFcDc_f3xEYXqJsItY9g.png"/></div></figure><p id="c201" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，我从Elixir控制台调用Erlang的<strong class="js iu"> rand </strong>模块的<strong class="js iu">制服</strong>函数。然而，本文的重点是反过来的——我们不想在<a class="ae lf" href="https://github.com/erlang/rebar3" rel="noopener ugc nofollow" target="_blank"> rebar3 </a>托管的Erlang应用程序中从Erlang代码访问Elixir函数。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/c5a4c6ce80e599e1902fc9c72f19bea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*6vl2uyOI7aH1OGhaDzTrug.png"/></div></figure><h2 id="d7f8" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">rebar3是什么？</h2><p id="d5cf" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">正如rebar3的github提到的—</p><blockquote class="mf mg mh"><p id="ec2e" class="jq jr mi js b jt ju jv jw jx jy jz ka mj kc kd ke mk kg kh ki ml kk kl km kn im bi translated">Rebar3是一个Erlang工具，它使得以可重复的方式创建、开发和发布Erlang库、应用程序和系统变得非常容易</p></blockquote><p id="00e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我假设您已经对rebar3有所了解，并且已经将它与Elixir和Erlang一起安装在您的系统上。如果你不熟悉rebar3，<a class="ae lf" href="https://medium.com/erlang-central/building-your-first-erlang-app-using-rebar3-25f40b109aad" rel="noopener">这篇</a>文章会很好的介绍。</p><h2 id="7305" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">创建rebar3项目</h2><p id="d512" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我使用rebar3命令创建了一个示例项目，如下所示</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/b3cc3eab936beb062aad691f30e81299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*wDuvTd11Wxm2eHLh1ctnGA.png"/></div></figure><p id="f41e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在创建新的应用程序后，<strong class="js iu"> rebar.config </strong>将如下所示</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/3446c764975bcfbb74335c63c68c2b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*nYuNNP-jDH2HxGP6Ht1leg.png"/></div></figure><p id="91f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还没有一个<strong class="js iu"> rebar.lock </strong>文件，但是运行<code class="fe mo mp mq mr b">rebar3 get-deps</code>会生成一个如下所示的文件</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/ed601c1661d516d1c8355a45995e916a.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*X1Mlz93DnOSD4jCuHGPtWg.png"/></div></figure><p id="d452" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这几乎是空的，因为还没有外部依赖。让我们改变这一点。</p><h2 id="bcea" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">安装钢筋混合</h2><p id="191a" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我在这个项目中使用<a class="ae lf" href="https://github.com/Supersonido/rebar_mix" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">rebar _ mix</strong></a><strong class="js iu">安装并配置了elixir依赖项。</strong>正如github page所说<strong class="js iu"> rebar_mix </strong>是— <em class="mi">“一个rebar插件，用于构建与mix的药剂依赖关系。”</em></p><p id="65fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在项目中添加了这个插件，在<strong class="js iu"> rebar.config </strong>中添加了下面几行</p><pre class="ky kz la lb gt mt mr mu mv aw mw bi"><span id="7264" class="lh li it mr b gy mx my l mz na">{plugins, [rebar_mix]}.<br/>{provider_hooks, [<br/>  {post, [{compile, {mix, consolidate_protocols}}]}<br/>]}.</span></pre><p id="c488" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">做一个<code class="fe mo mp mq mr b">rebar3 get-deps</code>现在会在<strong class="js iu"> _build </strong>文件夹下创建一个<strong class="js iu">插件</strong>目录，里面有<strong class="js iu"> rebar_mix </strong></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/4e64ccd84becb110cb5f58ba6a362d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*sy_TwiAb7mPmtfCpzl3QoA.png"/></div></div></figure><h2 id="c8bd" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">添加酏剂依赖性</h2><p id="b56b" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">接下来，我通过在<strong class="js iu"> deps </strong>部分添加以下内容，在<strong class="js iu"> rebar.config </strong>中添加了一个药剂十六进制包<a class="ae lf" href="https://hex.pm/packages/decimal" rel="noopener ugc nofollow" target="_blank"> decimal </a></p><pre class="ky kz la lb gt mt mr mu mv aw mw bi"><span id="7541" class="lh li it mr b gy mx my l mz na">{deps, [<br/>           {decimal, "2.0.0"}<br/>]}.</span></pre><p id="eadc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完整的<strong class="js iu"> rebar.config </strong>现在应该看起来如下—</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0416d34a86bca439948c5afe22210522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*Ob9RtWc4ELH_vkn8i5v61g.png"/></div></figure><p id="8383" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">执行<code class="fe mo mp mq mr b">rebar3 get-deps</code>将获取新的依赖关系。此时<strong class="js iu"> rebar.lock </strong>文件应该如下所示</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nh"><img src="../Images/603c817989eced83d921470c01003626.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jzJZTblHfJ0DnrfjTplL6w.png"/></div></div></figure><h2 id="e309" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">应用代码</h2><p id="0f50" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">现在我可以添加一些应用程序代码来从app访问Elixir库。编辑<strong class="js iu"> elixirapp_app.erl </strong>后，应该如下图所示</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ni"><img src="../Images/911afcc3249a8bc613d6dd25fe83b2b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVmmddRq3n6qbK-eDnVmVw.png"/></div></div></figure><p id="4e2d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从rebar3 shell ( <strong class="js iu">命令:rebar3 shell </strong>)运行的一个示例显示，这些新添加的3个函数可以访问Elixir库。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/c9620544aef0933aa522b6ae8413dfc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*rzbNzCCrsg9V3Et2LaoHmw.png"/></div></figure><p id="382f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有酏剂模块都以前缀<strong class="js iu">酏剂</strong>开头，后跟常规模块名。在这里，我从标准库中访问Elixir的<strong class="js iu">字符串</strong>和<strong class="js iu">列表</strong>模块，从新添加的<strong class="js iu">十进制</strong>包中访问<strong class="js iu">十进制</strong>模块。</p><h2 id="3dc2" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">结论</h2><p id="1874" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">在本文中，我展示了如何在rebar3托管的Erlang应用程序中添加elixir hex包依赖项，以便从Erlang代码中访问elixir库。这款应用的完整源代码在这里——<a class="ae lf" href="https://github.com/imeraj/erlang_playground/tree/main/elixirapp" rel="noopener ugc nofollow" target="_blank">https://github . com/imeraj/Erlang _ playground/tree/main/elixirapp</a></p><p id="c8b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mi">更多详细和深入的未来技术帖子请关注我这里或</em> <a class="ae lf" href="https://twitter.com/meraj_enigma" rel="noopener ugc nofollow" target="_blank"> <em class="mi">推特</em> </a> <em class="mi">。</em></p><h2 id="3be0" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">参考</h2><ul class=""><li id="e867" class="nk nl it js b jt ma jx mb kb nm kf nn kj no kn np nq nr ns bi translated"><a class="ae lf" href="https://github.com/erlang/rebar3" rel="noopener ugc nofollow" target="_blank">https://github.com/erlang/rebar3</a></li><li id="9cd8" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated"><a class="ae lf" href="https://github.com/Supersonido/rebar_mix" rel="noopener ugc nofollow" target="_blank">https://github.com/Supersonido/rebar_mix</a></li><li id="0759" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated"><a class="ae lf" href="https://hex.pm/packages/decimal" rel="noopener ugc nofollow" target="_blank">https://hex.pm/packages/decimal</a></li><li id="7113" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated"><a class="ae lf" href="https://rebar3.org/docs/configuration/plugins/#elixir-dependencies" rel="noopener ugc nofollow" target="_blank">https://rebar 3 . org/docs/configuration/plugins/# elixir-dependencies</a></li><li id="fea3" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated"><a class="ae lf" href="https://medium.com/erlang-central/building-your-first-erlang-app-using-rebar3-25f40b109aad" rel="noopener">https://medium . com/Erlang-central/building-your-first-Erlang-app-using-rebar 3-25f 40 b 109 aad</a></li></ul></div></div>    
</body>
</html>
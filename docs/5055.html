<html>
<head>
<title>Deploying Jakarta EE 9 applications to WildFly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Jakarta EE 9应用程序部署到WildFly</h1>
<blockquote>原文：<a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-wildfly-e271d1403b2c?source=collection_archive---------1-----------------------#2020-11-28">https://itnext.io/deploying-jakarta-ee-9-applications-to-wildfly-e271d1403b2c?source=collection_archive---------1-----------------------#2020-11-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e1be" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">WildFly 22.0.0.Alph1 为Jakarta EE 9提供了一个独立的预览版。</h2></div></div><div class="ab cl kg kh hu ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ij ik il im in"><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/bbe525b66addc9069a161aebd3e74370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZgar-TMaqJ9r-ovXsLz_A.png"/></div></div></figure><h1 id="0468" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">先决条件</h1><p id="e022" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">确保您已经安装了以下软件。</p><ul class=""><li id="ffe1" class="mn mo iq lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">Java 8或Java 11</li><li id="6b65" class="mn mo iq lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">Apache Maven 3.6</li><li id="8303" class="mn mo iq lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">野花22.0.0.Alpha1雅加达EE 9预览版</li></ul><p id="43a7" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">进入Wi <a class="ae kf" href="https://www.wildfly.org/downloads/" rel="noopener ugc nofollow" target="_blank"> ldFly下载</a>页面，确保下载的是<a class="ae kf" href="https://download.jboss.org/wildfly/22.0.0.Alpha1/wildfly-preview-22.0.0.Alpha1.zip" rel="noopener ugc nofollow" target="_blank"> Jakarta EE 9预览版</a>。</p><p id="979d" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated"><strong class="lt ir">从我的github中获取</strong> <a class="ae kf" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ir">源代码</strong> </a> <strong class="lt ir">。</strong></p></div><div class="ab cl kg kh hu ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ij ik il im in"><h1 id="45dd" class="kz la iq bd lb lc ng le lf lg nh li lj jw ni jx ll jz nj ka ln kc nk kd lp lq bi translated">手动部署</h1><p id="b7c5" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">从我的github账号克隆<a class="ae kf" href="https://github.com/hantsy/jakartaee9-starter-boilerplate" rel="noopener ugc nofollow" target="_blank">源代码</a>，然后构建项目。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="23b4" class="nq la iq nm b gy nr ns l nt nu">mvn clean package</span></pre><p id="f27b" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">完成后，在<em class="nv">目标</em>文件夹中打包了一个<em class="nv">jakartaee 9-starter-boilerplate . war</em>文件。</p><p id="a593" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">将WildFly文件解压到本地磁盘，进入WildFly文件夹，启动WildFly服务器。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="dc50" class="nq la iq nm b gy nr ns l nt nu"># cd [wildfly-preview-22.0.0.Alpha1 install dir]\bin</span><span id="2191" class="nq la iq nm b gy nw ns l nt nu"># standalone.bat<br/>Calling "D:\appsvr\wildfly-preview-22.0.0.Alpha1\bin\standalone.conf.bat"<br/>Setting JAVA property to "D:\jdk11\bin\java"<br/>===============================================================================</span><span id="3c23" class="nq la iq nm b gy nw ns l nt nu">  JBoss Bootstrap Environment</span><span id="ac2d" class="nq la iq nm b gy nw ns l nt nu">  JBOSS_HOME: "D:\appsvr\wildfly-preview-22.0.0.Alpha1"</span><span id="2d0f" class="nq la iq nm b gy nw ns l nt nu">  JAVA: "D:\jdk11\bin\java"</span><span id="6494" class="nq la iq nm b gy nw ns l nt nu">  JAVA_OPTS: "-client -Dprogram.name=standalone.bat -Xms64M -Xmx512M -XX:MetaspaceSize=96M -XX:MaxMetaspaceSize=256m -Djava.net.preferIPv4Stack=true -Djboss.modules.system.pkgs=org.jboss.byteman  --add-exports=java.base/sun.nio.ch=ALL-UNNAMED --add-exports=jdk.unsupported/sun.misc=ALL-UNNAMED --add-exports=jdk.unsupported/sun.reflect=ALL-UNNAMED"</span><span id="0a4c" class="nq la iq nm b gy nw ns l nt nu">===============================================================================<br/>  ...<br/>  14:06:11,863 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0051: Admin console listening on <a class="ae kf" href="http://127.0.0.1:9990" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:9990</a></span></pre><p id="a224" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">这里我在Windows CMD中执行了传统的批处理命令。当您使用Windows PowerShell时，请使用<code class="fe nx ny nz nm b">standalone.ps1</code>，或者当您使用类似Linux的终端时，请使用<code class="fe nx ny nz nm b">standalone.sh</code>。</p><p id="4243" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">要部署我们的应用程序，只需将war复制到<em class="nv">wild fly-preview-22 . 0 . 0 . alpha 1 dir/standalone/deployments</em>文件夹中。</p><p id="5595" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">它将自动执行部署，并生成一个<code class="fe nx ny nz nm b">.deployed</code>文件来指示部署状态已完成。</p><p id="814f" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">要取消部署应用程序，只需从<em class="nv">wild fly-preview-22 . 0 . 0 . alpha 1 dir/standalone/deployments</em>文件夹中删除war文件。它将生成一个<code class="fe nx ny nz nm b">.undeployed</code>文件，指示取消部署操作已成功完成。</p></div><div class="ab cl kg kh hu ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ij ik il im in"><h1 id="3d61" class="kz la iq bd lb lc ng le lf lg nh li lj jw ni jx ll jz nj ka ln kc nk kd lp lq bi translated">使用WildFly maven插件</h1><p id="f127" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">在项目<em class="nv"> pom.xml </em>文件的<code class="fe nx ny nz nm b">build/plugins</code>节下声明一个<code class="fe nx ny nz nm b">wildfly-maven-plugin</code>配置。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="5740" class="nq la iq nm b gy nr ns l nt nu">&lt;plugin&gt;<br/>     &lt;groupId&gt;org.wildfly.plugins&lt;/groupId&gt;<br/>     &lt;artifactId&gt;wildfly-maven-plugin&lt;/artifactId&gt;<br/>     &lt;version&gt;${wildfly-maven-plugin.version}&lt;/version&gt;<br/> &lt;/plugin&gt;</span></pre><p id="9c4e" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">只需运行以下命令将应用程序部署到WildFly server。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="eec4" class="nq la iq nm b gy nr ns l nt nu">mvn clean package wildfly:run -Dwildfly.version=22.0.0.Alpha1 -Dwildfly.artifactId=wildfly-preview-dist</span></pre><blockquote class="oa ob oc"><p id="ce91" class="lr ls nv lt b lu mp jr lw lx mq ju lz od nd mc md oe ne mg mh of nf mk ml mm ij bi translated"><em class="iq">注意:你要指定</em> <code class="fe nx ny nz nm b"><em class="iq">wildfly-preview-dist</em></code> <em class="iq">作为神器id才能接Jakarta EE 9预览版。如果没有设置，它会选择兼容雅加达EE 8的</em> <code class="fe nx ny nz nm b"><em class="iq">wildfly-dist</em></code> <em class="iq">。</em></p></blockquote><p id="f48f" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated"><code class="fe nx ny nz nm b">wildfly-maven-plugin</code>在这里管理WildFly服务器的生命周期，它将尝试为该应用程序下载并准备WildFly服务器的副本，并启动它，然后将该应用程序部署到WildFly服务器。</p><p id="586d" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">如果你想重用你机器上现有的WildFly服务器，在插件的<code class="fe nx ny nz nm b">configuration</code>部分配置一个<code class="fe nx ny nz nm b">jboss-as.home</code>或<code class="fe nx ny nz nm b">jbossHome</code>属性。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="08c9" class="nq la iq nm b gy nr ns l nt nu">&lt;configuration&gt;<br/>    &lt;!-- if a jboss-as.home or jboss.home property is not present, firstly it will download<br/>                            a copy of wildfly distribution automatically --&gt;<br/>    &lt;!-- &lt;jossHome&gt;&lt;/jbossHome&gt;--&gt;<br/>    ...</span></pre><p id="007f" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">或者附加一个<code class="fe nx ny nz nm b">jboss-as.home</code>参数来运行<code class="fe nx ny nz nm b">wildfly:run</code>目标。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="0005" class="nq la iq nm b gy nr ns l nt nu">mvn clean package wildfly:run -Djboss-as.home=[ the path of wildfly-preview-22.0.0.Alpha1 install dir]</span></pre><p id="22a1" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">如果您想要将应用程序部署到正在运行的WildFly服务器，特别是WildFly服务器位于远程主机中。在配置中配置WildFly服务器的<code class="fe nx ny nz nm b">hostname</code>、<code class="fe nx ny nz nm b">port</code>和admin账户信息。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="1e32" class="nq la iq nm b gy nr ns l nt nu">&lt;configuration&gt;</span><span id="fcb4" class="nq la iq nm b gy nw ns l nt nu">    &lt;!-- To deploy a running wildfly server --&gt;<br/>    &lt;hostname&gt;&lt;/hostname&gt;<br/>    &lt;port&gt;&lt;/port&gt;<br/>    &lt;username&gt;&lt;/username&gt;<br/>    &lt;password&gt;&lt;/password&gt;<br/>    ...</span></pre><p id="81c8" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">使用以下命令部署和取消部署应用程序。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="2010" class="nq la iq nm b gy nr ns l nt nu"># deploy applications<br/>mvn clean package wildfly:deploy</span><span id="210b" class="nq la iq nm b gy nw ns l nt nu"># undeploy <br/>mvn wildfly:undeploy</span></pre><p id="8921" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">在正在运行的WildFly服务器的服务器日志中，您可以看到如下所示的部署和取消部署进度。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="2d89" class="nq la iq nm b gy nr ns l nt nu">15:07:20,568 INFO  [org.jboss.as.repository] (management-handler-thread - 1) WFLYDR0001: Content added at location D:\appsvr\wildfly-preview-22.0.0.Alpha1\standalone\data\content\9b\8908496997cd79b1bfa229ef2a24107315b429\content<br/>15:07:20,568 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-5) WFLYSRV0027: Starting deployment of "jakartaee9-starter-boilerplate.war" (runtime-name: "jakartaee9-starter-boilerplate.war")<br/>15:07:25,093 INFO  [org.jboss.weld.deployer] (MSC service thread 1-4) WFLYWELD0003: Processing weld deployment jakartaee9-starter-boilerplate.war<br/>15:07:25,165 INFO  [io.jaegertracing.internal.JaegerTracer] (MSC service thread 1-4) No shutdown hook registered: Please call close() manually on application shutdown.<br/>15:07:25,250 INFO  [io.smallrye.metrics] (MSC service thread 1-6) MicroProfile: Metrics activated (SmallRye Metrics version: 2.4.4)<br/>15:07:25,438 INFO  [org.jboss.resteasy.resteasy_jaxrs.i18n] (ServerService Thread Pool -- 87) RESTEASY002225: Deploying jakarta.ws.rs.core.Application: class com.example.JaxrsActivator$Proxy$_$$_WeldClientProxy<br/>15:07:25,438 INFO  [org.wildfly.extension.undertow] (ServerService Thread Pool -- 87) WFLYUT0021: Registered web context: '/jakartaee9-starter-boilerplate' for server 'default-server'<br/>15:07:25,469 INFO  [org.jboss.as.server] (management-handler-thread - 1) WFLYSRV0010: Deployed "jakartaee9-starter-boilerplate.war" (runtime-name : "jakartaee9-starter-boilerplate.war")<br/>15:07:36,538 INFO  [org.wildfly.extension.undertow] (ServerService Thread Pool -- 87) WFLYUT0022: Unregistered web context: '/jakartaee9-starter-boilerplate' from server 'default-server'</span><span id="1247" class="nq la iq nm b gy nw ns l nt nu">// starting a undeployment<br/>15:07:36,569 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) WFLYSRV0028: Stopped deployment jakartaee9-starter-boilerplate.war (runtime-name: jakartaee9-starter-boilerplate.war) in 47ms<br/>15:07:36,616 INFO  [org.jboss.as.repository] (management-handler-thread - 1) WFLYDR0002: Content removed from location D:\appsvr\wildfly-preview-22.0.0.Alpha1\standalone\data\content\9b\8908496997cd79b1bfa229ef2a24107315b429\content<br/>15:07:36,616 INFO  [org.jboss.as.server] (management-handler-thread - 1) WFLYSRV0009: Undeployed "jakartaee9-starter-boilerplate.war" (runtime-name: "jakartaee9-starter-boilerplate.war")</span></pre><p id="124d" class="pw-post-body-paragraph lr ls iq lt b lu mp jr lw lx mq ju lz ma nd mc md me ne mg mh mi nf mk ml mm ij bi translated">出于安全考虑，您可以配置这些敏感信息，如<code class="fe nx ny nz nm b">username</code>、<code class="fe nx ny nz nm b">password</code>等。在本地Maven设置(<em class="nv"> ~/.m2/settings.xml </em>)的<code class="fe nx ny nz nm b">server</code>部分下，在配置中按id引用。</p><pre class="ko kp kq kr gt nl nm nn no aw np bi"><span id="e7bd" class="nq la iq nm b gy nr ns l nt nu">&lt;configuration&gt;<br/>    &lt;!-- or set a wildfly.id property to add a server in settings.xml --&gt;<br/>    &lt;!--&lt;id&gt;wildfly-svr&lt;/id&gt; --&gt;<br/>&lt;/configuration&gt;</span></pre></div></div>    
</body>
</html>
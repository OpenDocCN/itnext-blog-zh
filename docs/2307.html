<html>
<head>
<title>To reset a form or to resetForm?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重置表单还是重置表单？</h1>
<blockquote>原文：<a href="https://itnext.io/to-reset-a-form-or-to-resetform-555d3da47c52?source=collection_archive---------0-----------------------#2019-05-05">https://itnext.io/to-reset-a-form-or-to-resetform-555d3da47c52?source=collection_archive---------0-----------------------#2019-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5351184f2d8619c0f2ecd75c24fb6d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*itpAdE6O7ldkLqBqvW2ZTA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我应该选择什么？</figcaption></figure><p id="6503" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如威廉·莎士比亚名剧《哈姆雷特》中的自我解惑一样，我也遇到了类似的情况(不涉及死亡或自杀)，我不得不寻找一种方法来重新设定一个有角度的形式。</p><p id="2c95" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Angular中的<a class="ae la" href="https://angular.io/guide/reactive-forms" rel="noopener ugc nofollow" target="_blank">反应式表单</a>在开发人员中非常流行，因为它们是可伸缩的、可重用的和可测试的。由于我来自AngularJS背景，我习惯使用我更熟悉的<a class="ae la" href="https://angular.io/guide/forms" rel="noopener ugc nofollow" target="_blank">模板驱动的</a>表单。最近，我遇到了一个用例，我必须动态地重置这样一个表单的值。这篇博文描述了在实施解决方案的过程中所面临的问题和发现的结果。</p><h1 id="7a12" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">提交表格</h1><p id="37a8" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">当您想要提交表单时，一个常见的场景是根据表单字段的有效性来启用/禁用提交按钮。正如你在下面的第一个表单中看到的<strong class="ke ir"> Toggle submit </strong>，按钮<code class="fe me mf mg mh b">Submit</code>被禁用，直到在<code class="fe me mf mg mh b">Name</code>字段中输入一个必需的值。提交按钮的状态由表单域的验证结果决定。</p><p id="54e6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在我的案例中，方法完全不同。<code class="fe me mf mg mh b">Submit</code>按钮<em class="mi">始终</em>启用，不依赖于现场验证的结果。提交表单后，任何验证错误都会显示给用户，正如您在第二个名为<strong class="ke ir">的表单中看到的，总是提交</strong>。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">示例应用程序</figcaption></figure><p id="9485" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这两种方法在我看来都不错。我个人认为，对于新的应用程序来说，如何实现表单提交是一个偏好问题，对于现有的应用程序来说，你已经向用户提供了什么样的体验。假设您的所有表单都遵循<strong class="ke ir"> Toggle submit </strong>工作流，您应该继续使用相同的模式创建新的表单。</p><p id="8c40" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">例如在<a class="ae la" href="https://plexearth.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> Plexscape </strong> </a>，Plex的用户。地球人习惯于直接点击提交按钮，而不关心预先的验证。所以我们的网络应用补充了Plex。地球，遵循同样的原则。</p><p id="6aee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通过这种方式，您可以在整个应用程序生态系统中为您的用户提供相同的唯一UX。</p><h1 id="ede5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">重置表单</h1><p id="c97f" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">每个表单还有一个<code class="fe me mf mg mh b">Reset</code>按钮，点击时清除字段值。让我们首先尝试提交并重置第一个表单，看看会发生什么。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/b2c185b226b07eef1d8e83fc213a64ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AAt_V2486oNHGIGvjMqJZA.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">切换提交表单</figcaption></figure><p id="bb84" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">太好了！一切按预期运行。现在，让我们对第二个做同样的事情。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/7fa8f0816ed236031d140d60ad73e0f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6_FNMTHKsc48notNLsriWQ.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">总是提交表单</figcaption></figure><p id="a3a9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">嗯…这似乎不对。即使我们重置了表单，验证错误消息<code class="fe me mf mg mh b">Name is required</code>仍然显示在表单上。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/59fa51f0ba200222e62db9c753257a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xIBklL2_tJmnIVv0vtHHBQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae la" href="https://www.pexels.com/@olly?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> bruce mars </a>从<a class="ae la" href="https://www.pexels.com/photo/man-wearing-brown-jacket-and-using-grey-laptop-874242/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>拍摄</figcaption></figure><p id="6567" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们试着揭开正在发生的事情。我们将从检查两个表单的模板开始。如果您看一下第一个表单的reset按钮，<strong class="ke ir"> Toggle submit </strong>，您会注意到它在按钮的<code class="fe me mf mg mh b">click</code>事件上调用了一个方法<code class="fe me mf mg mh b">resetForm()</code>。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/1ea5d331f2d4aa311ae5598261f8bb11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i6V_zbfd7p9Qhm44kO6fQQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">resetForm()方法</figcaption></figure><p id="7e09" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">类似地，第二个表单<strong class="ke ir">总是提交</strong>，调用一个方法<code class="fe me mf mg mh b">reset()</code>。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/9b171f90d0e77eb7bf64cb59059c5ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSrlag-96_63GP9i2HNPdg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">reset()方法</figcaption></figure><p id="3431" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这两种方法都在<code class="fe me mf mg mh b">heroForm</code>对象上被调用。</p><h1 id="1de5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">文档是你最好的朋友</h1><p id="e668" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">那些方法是什么？为什么重置表单有不同的方法？我们应该使用哪一个？当你开始问自己这样的问题时，是时候去<a class="ae la" href="https://www.angular.io" rel="noopener ugc nofollow" target="_blank"> angular.io </a>查看官方文档了。如果你没有找到你要找的东西，那么开始挖掘Angular源代码。</p><blockquote class="mu"><p id="ae64" class="mv mw iq bd mx my mz na nb nc nd kz dk translated">反正我喜欢看角源代码。这仍然是了解事物内部如何工作的最好方法！</p></blockquote><p id="930e" class="pw-post-body-paragraph kc kd iq ke b kf ne kh ki kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz ij bi translated">让我们去看看官方的角度文档，检查一下<code class="fe me mf mg mh b"><a class="ae la" href="https://angular.io/api/forms/NgForm#ngform" rel="noopener ugc nofollow" target="_blank">NgForm</a></code>的API。我们正在寻找<code class="fe me mf mg mh b">reset</code>和<code class="fe me mf mg mh b">resetForm</code>方法。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/9606fb9ddccbed302404633461441132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*ftziDXZK5J8OMhrEmJtpsw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">resetForm()文档</figcaption></figure><p id="db79" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">啊哈！有一个<code class="fe me mf mg mh b">resetForm</code>方法。此时，我们可以验证第二个表单的reset按钮应该调用这个方法，因为验证消息的外观状态依赖于表单的<code class="fe me mf mg mh b">submitted</code>状态。</p><p id="de90" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们最终解决了我们的问题，但是我们还是没有找到任何方法。太奇怪了，我们继续找。点击<strong class="ke ir">查看源代码&lt; &gt; </strong>按钮，您将被重定向到<code class="fe me mf mg mh b">resetForm</code>方法的源代码。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/48991a44031e3edd4702166ebcb8c115.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*JLk29_dtP9wQTlQt-SD6_w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">resetForm()源代码</figcaption></figure><p id="1c8c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">等等…这里有一个从<code class="fe me mf mg mh b">resetForm</code>内部调用的<code class="fe me mf mg mh b">reset</code>方法。有趣…但是什么是<code class="fe me mf mg mh b">this.form</code>？如果你在变量声明中更进一步，你会看到它是一个类型为<code class="fe me mf mg mh b">FormGroup</code>的对象。如果我们去<code class="fe me mf mg mh b"><a class="ae la" href="https://angular.io/api/forms/FormGroup#formgroup" rel="noopener ugc nofollow" target="_blank">FormGroup</a></code> API，我们会找到<code class="fe me mf mg mh b"><a class="ae la" href="https://angular.io/api/forms/FormGroup#reset" rel="noopener ugc nofollow" target="_blank">reset</a></code>方法的文档。</p><p id="23d6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以<code class="fe me mf mg mh b">resetForm</code>和<code class="fe me mf mg mh b">reset</code>是一样的，但是不同之处在于影响了表单的<code class="fe me mf mg mh b">submitted</code>状态。</p><h1 id="8af3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="a0ab" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">有人会说，我应该从一开始就选择<code class="fe me mf mg mh b">resetForm</code>方法，根本不用费心去使用<code class="fe me mf mg mh b">reset</code>方法。<strong class="ke ir">这是一个合理的说法，但我喜欢证明我使用的东西和我可以使用的替代物。这让我感觉更好，也让我对使用什么更有信心。</strong></p><p id="6b2a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您必须从组件中调用reset方法，还要考虑这可能会导致混乱。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/d2ddc892218a3edacbce3c58c9cbf42f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*KEavj3dC3ayW9hlInRQssg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">重置组件中的表单</figcaption></figure><p id="c80d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">很难区分哪种方法是哪种，不是吗？。Intellisense显示了同一对象上的两个方法，即使它们引用不同的类型<code class="fe me mf mg mh b">NgForm</code>和<code class="fe me mf mg mh b">FormGroup</code>。这是为什么呢？回想一下官方的角度文件</p><blockquote class="mu"><p id="4802" class="mv mw iq bd mx my mz na nb nc nd kz dk translated">组件中的顶级表单是<code class="fe me mf mg mh b">FormGroup</code></p></blockquote><p id="79da" class="pw-post-body-paragraph kc kd iq ke b kf ne kh ki kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz ij bi translated">在这种情况下，每个组件有且只有一个表单，这意味着它们是顶级表单。</p><p id="b8dd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">就是这样！非常感谢您阅读我的文章。我希望它能告诉我们什么时候使用每个重置表单方法。</p><p id="db51" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有没有经历过类似的情况？你喜欢哪种方法？请在下面的评论中告诉我！</p></div></div>    
</body>
</html>
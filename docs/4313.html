<html>
<head>
<title>The Universe has no Time Zone</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">宇宙没有时区</h1>
<blockquote>原文：<a href="https://itnext.io/the-universe-has-no-time-zone-a3eeffd17f92?source=collection_archive---------0-----------------------#2020-06-06">https://itnext.io/the-universe-has-no-time-zone-a3eeffd17f92?source=collection_archive---------0-----------------------#2020-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4bdc3798c819595615dd26477d6d50ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tgDAyJlgsAr7EVZPkUkTw.jpeg"/></div></div></figure><p id="c8bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很久很久以前，宇宙诞生了。这被广泛认为是不受欢迎的举动，并使许多人愤怒。</p><p id="903f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">雪上加霜的是，人类创造了“时区”，以简化对他们的时间的推理。看，几个世纪以来，我们人类已经习惯了<em class="kw">当地时间</em>，即使我们没有太多的衡量标准。我们很高兴地说，对T4我来说，日出发生在早上6点。但是对我来说是早上6点，对日本的某人来说可能是早上8点。因此，世界走到了一起，并将地球分成了时区。这样，一个时区的每个人都可以忽略其他人，或者更确切地说，可以参考他们的当地时间，而不必太担心地球上的其他人。</p><p id="1bc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">时区是在大约公元1675年创建的，位于英格兰格林威治的<a class="ae kx" href="https://www.rmg.co.uk/royal-observatory" rel="noopener ugc nofollow" target="_blank">皇家天文台</a>在其全盛时期，就像所有的英国事物<em class="kw">一样，是时间本身的中心。于是就有了GMT，格林威治标准时间。也称为UTC，协调世界时。请不要问我CUT是怎么变成UTC的。</em></p><p id="78d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">继续前进，世界，因为它是，接受GMT时间，或格林威治地区的时间，作为世界时间，没有任何时区。</p><p id="bcf3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，如果您不在GMT，那么您所在位置的当地时间将由GMT的一个偏移量来标识。因此，如果在印度，时间是08:30:24 (hh:mm:ss)，这意味着现在是印度指定时区IST的08:30:24，定义为<strong class="ka ir"> UTC+05:30 </strong>。</p><p id="715a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更进一步，当事件发生在IST的08:30:24时，这意味着格林威治时间，GMT / UTC时区是03:00:24 (08:30:24 - 05:30:00)。</p><p id="32d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，名称<strong class="ka ir"> hh:mm:ss + th:tm </strong>意味着，由<strong class="ka ir"> hh:mm:ss </strong>部分表示的时间是<strong class="ka ir">当地时间</strong>，为了获得UTC时间，我们必须从中减去<strong class="ka ir"> th:tm </strong>。</p><h1 id="9b5a" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">问题是</h1><p id="6bdb" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">大约在20世纪70年代，在所有的计算机革命之前，对于正常的应用程序来说，编程时间和日期没有太多问题。你做了一个软件，配置成在给定的时区使用，人们对它很满意。其他时区的用户也同样配置了他们的软件，他们也很高兴。</p><p id="a934" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当一个时区的软件与其他时区的软件交互时，问题就出现了。你看，如果你不小心编程你的软件，很好地照顾时区，你可能会以损坏的时间/日期值为你的数据而告终。</p><p id="61d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后互联网出现了。其要点是让整个工厂的网络能够相互通信。</p><p id="9435" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，日期和时间的编码问题变得复杂了。很多次了。以至于即使是现在，在21世纪，我们仍然有正确的日期和时间编程的问题。</p><h1 id="9f53" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">解决方案</h1><p id="109b" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">有几种方法可以简化时区的日期和时间编码。一些简单的规则可以使软件中关于日期和时间的推理更容易处理。</p><ul class=""><li id="b8dc" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">确保<em class="kw">代码中的所有</em>时间戳都用时区定义为<em class="kw">。</em></li><li id="9dcd" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">始终依赖运行软件的系统提供的时区信息。</li><li id="f995" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">转换为UTC后，始终存储所有时间戳。注意，这只是针对存储部分。根据您的应用程序，您可以通过用户输入或运行环境，在校正相关时区后向用户显示时间戳。</li></ul><h1 id="73c4" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">进入节点时间</h1><p id="b593" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">NodaTime是一个. NET库，它极大地简化了。NET平台。图书馆有一种不同的方法来考虑日期、时间和时区。</p><ul class=""><li id="b4b6" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">在内部，野田时间将时间视为一条单一的、非相对论性的线性时间线，“零”点是Unix纪元(UTC 1970年1月1日午夜)。这意味着，如果野田时间图书馆被拟人化，它就是一个漂浮的外星人，比如说在我们的太阳周围，保持着一个始于Unix时代的秒表。现在，由于UTC也处于“零”时区参考中，一个在UTC时区格林威治的人，拥有一个在同一Unix纪元开始的秒表，他的秒表上的刻度将与外星人拥有的秒表完全匹配。野田时间称秒表的数字为<strong class="ka ir">瞬间。</strong>这是野田时间保持的全球时间线。</li><li id="0171" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">外星人或人类的秒表每一秒都在滴答作响。这意味着，Noda时间库中的一种即时数据类型是一个数字，它显示自Unix纪元以来已经过去了多少纳秒。这个数字对于太阳附近的外星人和UTC区域的人类是一样的。</li><li id="5b01" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">因为即时类型只是纳秒，所以它没有隐含的日历系统。因此，为了获得给定日历系统中的本地时间，程序员可以使用工具将这些即时值转换成所需的参考时区和时间段。</li></ul><p id="103f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看一些代码。假设您有一个数据库，在本例中是PostgreSQL，它有一个带时区列的时间戳。要创建NodaTime时区的日期时间，我们可以执行以下操作</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="e32e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要将实体插入数据库，我们可以这样做。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="cae9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要检索同一个实体，我们可以这样做。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="7166" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">BrandEntity对象定义如下</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b891" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们已经介绍了使用NodaTime获取、存储和检索时区日期时间对象。一定要查看它的文档，了解一些有用的方法和操作符。</p><p id="17ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">注意</strong>:你必须像这样配置Npgsql来使用NodaTime。对于ASP.NET核心MVC应用程序，这可以在启动类ConfigureServices方法中完成。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="d221" class="na kz iq mw b gy nb nc l nd ne">NpgsqlConnection.GlobalTypeMapper.UseNodaTime();</span></pre><p id="b904" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我强烈建议每个人都使用NodaTime。NET项目。您可以在中了解为什么会有这样一个库，以及它为什么会取代DateTime实用程序。网本身在<a class="ae kx" href="https://blog.nodatime.org/2011/08/what-wrong-with-datetime-anyway.html" rel="noopener ugc nofollow" target="_blank">这个博客帖子</a>由乔恩斯基特。</p></div></div>    
</body>
</html>
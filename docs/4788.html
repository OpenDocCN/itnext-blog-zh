<html>
<head>
<title>Ingress for Anthos — Multi-cluster Ingress and Global Service Load Balancing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Anthos的入口—多集群入口和全局服务负载平衡</h1>
<blockquote>原文：<a href="https://itnext.io/ingress-for-anthos-multi-cluster-ingress-and-global-service-load-balancing-c56c57b97e82?source=collection_archive---------1-----------------------#2020-09-18">https://itnext.io/ingress-for-anthos-multi-cluster-ingress-and-global-service-load-balancing-c56c57b97e82?source=collection_archive---------1-----------------------#2020-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/e432484d75668f59c58437b47f4364c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_VIymOI2Tut5HSKuhFObg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">地理感知多集群入口Anthos的入口</figcaption></figure><div class=""/><p id="2353" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Anthos的入口是一个谷歌云托管的多集群入口控制器，用于Anthos GKE集群。Ingress for Anthos支持跨集群和跨区域部署共享负载平衡资源，使用户能够为运行在多集群和多区域拓扑中的应用程序使用带有任播IP的同一负载平衡器。</p><p id="1854" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">简而言之，这允许用户将位于不同区域的多个GKE集群置于一个负载平衡器之下。它是外部HTTP(S)负载平衡器的控制器，通过使用<a class="ae la" href="https://cloud.google.com/load-balancing/docs/negs" rel="noopener ugc nofollow" target="_blank">网络端点组</a> (NEGs)对外部HTTP(S)负载平衡器进行编程，为来自互联网的流量提供跨一个或多个集群的入口。neg对于容器本地负载平衡很有用，其中每个容器都可以表示为负载平衡器的端点。</p><p id="8386" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">利用GCP的100多个存在点和全球网络，Ingress for Anthos利用GCLB以及在世界各地运行的多个Kubernetes引擎集群，使用单个任播IP地址为来自最近集群的流量提供服务。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lb"><img src="../Images/7144c70d08ec68f9a241097568e9c58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qLtCiHtksYDuBUk8"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">基于地理感知的邻近选播路由</figcaption></figure><h1 id="014e" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">利用任播实现全局负载平衡</h1><p id="91bf" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">Ingress for Anthos在<a class="ae la" href="https://cloud.google.com/network-tiers/docs/overview" rel="noopener ugc nofollow" target="_blank">高级层</a>中创建了一个外部HTTP(S)负载平衡器，它使用一个作为任播IP公布的全球外部IP地址，并可以根据邻近程度智能地将用户的请求路由到最近的后端实例组或NEG(网元组)。与使用基于DNS的负载平衡的多个地址相比，专用任播地址意味着任何地方的客户端都可以连接到同一个IP地址，同时仍然可以尽快进入谷歌的网络，并连接到谷歌网络边缘的负载平衡器，流量进入该网络，从而最大限度地缩短客户端和前线负载平衡器之间的网络距离。</p><p id="af6f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">任播支持使用相同的IP地址，并且在世界各地不同的地理区域请求具有相同内容的后端提供了可能的最短响应时间。任播根据边界网关协议(BGP)路径将数据包定向到地理上最近的后端。例如，如果用户在北美、欧洲和亚洲设置了实例组/neg，并将它们连接到负载平衡器的后端服务，则世界各地的用户请求会自动发送到离用户最近的虚拟机/pod，前提是这些虚拟机/pod通过了运行状况检查并具有足够的容量(由平衡模式定义)。</p><p id="60a3" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">任播与BGP协议相关联，BGP协议确保路由器的所有邻居都知道可以通过该路由器到达的网络以及到这些网络的拓扑距离。有了任播，系统每次都会一致地选择最短路径。如果一个节点出现故障，将确定下一个最短的路由，并在无需更改IP地址的情况下重定向流量。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mj"><img src="../Images/ef1be963e983c1e312bf6e0e24793622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BoWr4bb0I7K2weN_"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">任播路由</figcaption></figure><p id="3412" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">任播提高了吞吐量，最大限度地减少了世界各地客户的延迟。此外，如果添加了<a class="ae la" href="https://cloud.google.com/cdn/docs/" rel="noopener ugc nofollow" target="_blank">云CDN </a>，则可以在这些边缘位置启用缓存。全球任播IP地址使用户能够无缝地更改或添加用于部署应用实例的区域，并根据需要增加容量。除了延迟优化之外，这种方法的另一个最大优势是高可用性，如果最近的后端都不正常，或者如果最近的实例组/NEG达到容量，而另一个实例组/NEG没有达到容量，负载平衡器会自动将请求发送到下一个具有容量的最近区域。</p><h1 id="233b" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">冷土豆路由到谷歌流行</h1><p id="d552" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">来自客户的请求被路由到<a class="ae la" href="https://wikipedia.org/wiki/Hot-potato_and_cold-potato_routing" rel="noopener ugc nofollow" target="_blank">冷土豆</a>谷歌PoP，这意味着互联网流量去最近的PoP，并尽快到达谷歌主干。</p><p id="fd24" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">冷土豆技术与热土豆(流量被发送到最近的交换点的对等点)相反，在使用内部网络/主干将数据包传送到对等点之前，尽可能长时间地传送客户的流量。虽然Cold Potato增加了总体运营成本，但它提供了一些优势，如使流量更长时间地处于网络管理员的控制之下，使用自定义软件堆栈应用复杂的规则，允许配置良好的网络的运营商向他们的客户提供更高质量的服务。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mk"><img src="../Images/abf6c70cffdefc45106436f61a4a8833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zzx4mX6ToQlGpKb2"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">冷土豆vs热土豆路由</figcaption></figure><p id="7c1b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">谷歌PoPs或GFE的(<a class="ae la" href="https://cloud.google.com/security/security-design#google_front_end_service" rel="noopener ugc nofollow" target="_blank">谷歌前端</a>)是软件定义的分布式系统，位于谷歌存在点(PoPs)，与其他系统和控制平面一起执行全局负载平衡。任何选择对外发布自己的内部服务都使用GFE作为智能反向代理前端。该前端提供其公共DNS名称的公共IP托管、拒绝服务(DoS)保护和TLS终止。</p><h1 id="b175" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">具有NEG(网络端点组)的容器本地负载平衡</h1><p id="398b" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">NEG是Google云负载平衡器使用的IP地址列表，NEG中的IP地址可以是虚拟机的主要或次要IP地址，这意味着它们可以是Pod IPs。在GKE VPC本地集群中(Pod IP地址可在集群的VPC网络和通过VPC网络对等连接到它的其他VPC网络中本地路由)，GCP VPC网络知道别名IP，因此路由由VPC负责，无需任何额外的路由配置。</p><p id="ed22" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">neg对于容器本地负载平衡很有用，其中每个容器都可以表示为负载平衡器的端点。这实现了容器本地负载平衡，将流量从Google Cloud负载平衡器直接发送到Pods。</p><p id="57c9" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在旧的GKE负载平衡方法中，传统的实例组曾经是后端，它们组成了工作负载运行的实际Kubernetes节点。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/5aec6b7f405579aaa864757b9b3fa6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e6OYosm_KkcFMTfY"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">负载平衡器—后端—实例组</figcaption></figure><p id="73b6" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">具有Kubernetes节点的实例组:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/91cf1bccc73b049de1688ce0bf4fbcd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T5-Oe3ned9IGE0O0"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">实例组— Kubernetes节点</figcaption></figure><p id="ad5b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">用户可以使用一个名为<a class="ae la" href="https://github.com/GoogleCloudPlatform/k8s-multicluster-ingress" rel="noopener ugc nofollow" target="_blank"> kubemci </a>的工具(一个配置Kubernetes ingress以跨多个Kubernetes集群负载平衡流量的工具)来创建一个跨集群分布的负载平衡器，并关联一个任播IP。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/cbc82ee265501e9e13991d2dc26ad674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZgMbbHw_maQKS2SU"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">带任播IP的LB</figcaption></figure><p id="1ec9" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这种方法现在已被否决，而Ingress for Anthos是部署多集群Ingress的推荐方法。</p><p id="7202" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果没有容器本地负载平衡，负载平衡器会将数据包分发到每个节点(Kubernetes节点),每个节点中的iptables会将数据包进一步分发到每个pod/容器，这增加了额外的跳数。使用容器本地负载平衡，优势是更好的负载分布、减少额外的跳数以减少延迟和更好的健康检查。</p><p id="6e9c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Anthos的Ingress是一个云托管的多集群ingress控制器，它使用<a class="ae la" href="https://cloud.google.com/load-balancing/docs/negs" rel="noopener ugc nofollow" target="_blank">网络端点组</a> (NEGs)对外部HTTP(S)负载平衡器进行编程。这项服务由Google托管，支持跨集群和跨地区部署共享负载平衡资源。控制器部署计算引擎负载平衡器资源，并在用户创建MultiClusterIngress资源时跨集群将适当的pod配置为后端。neg用于动态跟踪Pod端点，因此Google负载平衡器拥有一组健康的后端。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mm"><img src="../Images/1c86f73d5fdb3063f6f7349bedeeb508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vEy9R7zu6D6hocnE"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">具有NEGs的容器本地负载平衡</figcaption></figure><p id="45de" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在GKE上，可以通过向Kubernetes服务(<em class="mn">cloud.google.com/neg</em>)添加注释来自动创建和管理NEGs。当NEGs与Anthos Ingress一起使用时，Ingress控制器有助于创建L7负载平衡器的所有方面。这包括创建虚拟IP地址、转发规则、健康检查、防火墙规则等。</p><h1 id="0005" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">试验</h1><p id="d735" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">在三个不同的地区创建了三个GKE集群，并且所有这三个集群都注册到了Anthos Hub。us-west2-a中的集群被选为配置集群，配置集群是多集群资源——multiclustergress和MultiClusterService——的集中控制点。这些多集群资源存在于单个逻辑API中，并且可以从单个逻辑API进行访问，以保持所有集群之间的一致性。入口控制器监视配置集群并协调负载平衡基础设施。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/a651897b98288ced49167f77ee004b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p2JfFcBRcVig8cc2"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">多集群和多区域拓扑</figcaption></figure><p id="8d08" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">入口控制器是一个全局分布式控制平面，作为集群外部的服务运行。Environ提供了一种统一的方式来查看和管理多个集群及其工作负载，作为Anthos的一部分。集群使用项目的environ通过Connect向Anthos注册，ingress使用environ的概念来说明如何跨不同的集群应用Ingress。注册到环境的集群对Ingress变得可见，因此它们可以用作Ingress的后端。注册成为中心成员的GKE集群成为概念上被称为T2环境T3的一部分。</p><p id="86f0" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注册到environ的集群称为成员集群，在上面的拓扑中，所有三个集群都是成员集群(配置集群可以用集群选择器隔离)。环境中的成员集群包括Ingress知道的所有后端。</p><p id="1535" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">MCI(multiclusteringress)和MCS (MultiClusterService)是自定义资源(CRD ),它们是入口和服务资源的多群集等价物。这些是在配置集群上配置的，MCS在成员集群中创建所需的派生服务(映射到端点的实际服务)。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/fa32b70f29aa93d2d203422f80c6b4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ppGpv4rzPMWyX2a7"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">多群集回归和多群集服务</figcaption></figure><p id="c604" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">MultiClusterIngress资源包含后端服务列表(与此MCI部署在同一命名空间和配置群集中的MCS的名称)。MultiClusterIngress (MCI)资源在许多方面的行为与核心入口资源相同。两者在定义主机、路径、协议终端和后端方面都有相同的规范。</p><p id="0d6d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">多集群服务(MCS)是Ingress for Anthos使用的自定义资源，是跨多个集群的服务的逻辑表示。MCS与核心服务类型相似，但本质上不同。MCS仅存在于配置集群中，并在目标集群中生成派生服务。MCS不像ClusterIP、LoadBalancer或NodePort服务那样路由任何东西。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/77c7f558753229b0d953c28dcf642670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8FW9wqLTBaaTw2nZ"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">多群集回归和多群集服务</figcaption></figure><p id="c5b0" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一个MCI资源可以有一个默认后端(MCS)和指定多个后端的规则列表。MCI通过将流量发送到后端中指定的MCS资源，将流量与规则中指定的主机上的VIP进行匹配，所有其他不匹配的流量将被发送到默认后端MCS。</p><p id="7506" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">用户可以在MCS配置上使用“<em class="mn">集群</em>有选择地应用入口规则，其中派生服务仅在指定列表上创建。如果未指定MultiClusterService的“clusters”部分，或者未列出任何集群，则它将被解释为默认的“all”集群。该特征提供了如下优点:隔离配置集群以防止MCS在它们之间进行选择，路由到仅存在于集群/区域的子集内的应用后端，等等。，以有助于应用迁移的蓝绿色方式控制集群之间的流量，便于不同集群使用单个L7 VIP。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/7d2bcb4ef13615dfbf4fd054cd3280dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AWlJEZIDM_2TDQIc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">多集群入口和多集群服务—集群选择器和入口规则</figcaption></figure><p id="c9ab" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以下是跨多个集群为Anthos配置入口的工作流中的步骤:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mq"><img src="../Images/d02a5ebc5cfac4ca31cc2fa1ca2f272e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P8hkRL_PfboFNbko"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">工作流—为Anthos配置入口</figcaption></figure><p id="5cf6" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">应在项目中启用多集群入口API:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/d619451e4e79d45d6e7e5138f978eb15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gLGW-H3TwTxTp_7Y"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">多聚类回归API</figcaption></figure><p id="ce70" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如下所示，在不同的区域创建了三个GKE集群，并将其添加到中心。选择Cluster1作为配置集群，并在集线器级别启用多集群入口功能。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/e0369527ebddfec4ac9775987ecf1106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N9sNcFE_EObBKm6H"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">启用多集群入口功能</figcaption></figure><p id="f57c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用Connect添加到集线器的所有集群，因为所有这些集群都是GKE管理的集群，类型将它们指定为GKE:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mr"><img src="../Images/791403002c5e926eadc84c7661f13aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y_KyrkOMI1M2Q5uy"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">集线器中的集群—使用Connect注册</figcaption></figure><p id="f481" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从Anthos门户启用入口功能:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/ced21795c59edcf6d8f8e05649801570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TUwnVxiAwiV2pMj1"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">启用多集群入口功能— Anthos门户</figcaption></figure><p id="5808" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">显示配置集群信息和所有其他已注册集群(成员)的入口详细信息页面:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ms"><img src="../Images/3b7d5a974209460b3e4644516c6b285f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4duZj1ngNdiOYk2a"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">集群成员和配置成员</figcaption></figure><p id="2fbf" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在所有三个集群上都部署了一个演示应用程序“zone-ingress ”,该应用程序在被访问时只打印运行它的数据中心的名称。</p><p id="1591" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在跨集群部署应用程序时，用户必须考虑一个称为“<a class="ae la" href="https://cloud.google.com/kubernetes-engine/docs/concepts/ingress-for-anthos#namespace_sameness" rel="noopener ugc nofollow" target="_blank"> <em class="mn">名称空间一致性</em> </a> <em class="mn">”、</em>的概念，这是环境所具有的一个特征。这假设在集群中具有相同名称和相同命名空间的资源被认为是同一资源的实例。实际上，这意味着从Anthos入口的角度来看，跨不同集群的标签为“app: zoneprinter”的“zoneprinter”命名空间中的pod都被视为同一个应用程序后端池的一部分。这对不同的开发团队如何在一组集群中操作有影响。</p><p id="7fbd" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在此场景中，名为zone-ingress的部署部署在“zoneprinter”命名空间中的所有三个集群上:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/0a542606ab2528b3bbd75f68050e8d3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l1kCO6Ikc5vn98YC"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">部署在所有集群上的演示应用程序</figcaption></figure><p id="7bd2" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">MCI (MuliClusterIngress)和MCS (MultiClusterService)在配置群集上创建:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/77c13db3bcf9b7b19666aa6db46f8d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YwfsNU8NZKvGogkc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">在配置群集中创建了MultiClusterIngress和MultiClusterService</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/0c3edc60eadeb48b16c7cf768f026220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OvoXdjCLOHTgnT3B"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">在配置群集中创建了MultiClusterIngress和MultiClusterService</figcaption></figure><p id="6a3b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">由于我们没有在MCS配置中提供任何“集群”,因此将在包括配置集群在内的所有三个集群上创建一个派生服务:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/de6209d7d78aac056d7707cdd067a88d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Sfw4Fq2knH2n4SPt"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">MCS在所有成员集群上创建的派生服务</figcaption></figure><p id="8706" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在成员集群(本例中为所有三个集群)中创建的派生服务使用NEGs(各自网元组的映射)、multiclusterservice-parent(在配置集群上创建的MCS)和端口信息进行注释，如下所示:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/7bea1d2444833d023c609d30a0e433a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L2_2PjonfQc4RKP8"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">MCS在成员群集上创建的派生服务</figcaption></figure><p id="742a" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这一步在计算引擎中创建NEGs，开始注册和管理服务端点。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/4dafa6c644d6f44eb902a6fe8bca47de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nIWTT9VYD-_FVqCt"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">负附件</figcaption></figure><p id="89ad" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">控制器会自动创建负号。neg映射所有三个集群中的“区域入口”pod:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/5c79325986031c0c5d1d848782aaa156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6VK_QQtk4koHDjof"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">网络元素组</figcaption></figure><p id="6863" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如下所示，NEG中的网络端点映射到集群1上的<em class="mn">区域入口</em>的pod_ip:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/0b19db49a95848a18f9ee5988c9ae190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KrNjsw1jLPsagEWv"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">指向Pod_IP的网络元素组</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/843696deeb698c5672a575e4a104b577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6IJh8LgwQ_LArbsq"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">指向Pod_IP的网络元素组</figcaption></figure><p id="7c6f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正在配置群集上创建MCI资源:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/7f550629006f5d0774cb67bf943f8528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*scjDWmA86ez3OJY0"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">正在配置群集上创建MCI资源</figcaption></figure><p id="2eff" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此步骤部署计算引擎外部负载平衡器资源，并通过单个负载平衡器VIP跨集群公开端点。</p><p id="e35e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">MultiClusterIngress资源“状态”字段显示后端服务:MCS、防火墙、转发规则、健康检查和单个群集的neg。VIP是映射到负载平衡器的任播IPV4地址。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/9a72451ae539cdaba420c160f40144cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NudZXS-jXXqRHmke"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">具有后端服务、防火墙、转发规则、健康检查和否定的MCI资源</figcaption></figure><p id="261c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">负载平衡器后端将NEGs映射为后端，这是在创建MCI对象时由入口控制器自动创建的:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/9acf0283259f49d9c97003f6d2b942b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X-N-PUQPjMj4bBLO"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">以负数作为后端的负载平衡器</figcaption></figure><p id="6033" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">neg被配置为负载平衡器的后端。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/9e2d0e62132047182c08bf7df521e785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CM68yi6vUZPg3n2h"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">以负数作为后端的负载平衡器</figcaption></figure><p id="4113" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">前端映射到单个IPV4任播地址。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/7c37fc6b48b6ade4775f37300cfa3178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_jIDo1QTdTRVVSoc"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">具有任播IPV4地址的负载平衡器</figcaption></figure><p id="58b3" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">转发规则被配置为将流量从LB发送到入口资源。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/9edc34185b83ed169cf9bd5c44f8665a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6iiuGT7qsdJFYaAH"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">转发规则</figcaption></figure><h1 id="7d08" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">从不同地理区域访问演示服务(Zoneprinter)</h1><p id="1a9f" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">在GKE集群所处的各个分区中创建了三个虚拟机实例，以复制来自不同区域的访问。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/37af69b5d04f10da1d0655d884770530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U52ZDNq1xUYlQ_P3"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">测试实例—测试来自不同区域的访问</figcaption></figure><p id="67d8" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从US-West使用LB的任播IP访问Zoneprinter，从集群1-US-West 2-a中运行的Zoneprinter pod返回响应。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/9d4f77b29bc14ee6a390e6aeff4c9ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EikC7nvqC6oqBT6e"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">从美国西部进入</figcaption></figure><p id="b01c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从US-East使用LB的任播IP访问Zoneprinter，从在cluster 2-US-East 4-a中运行的Zoneprinter pod返回响应。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/9f2cb1f3076f8b945d07bac5fdb1c189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-S0R4rHSdafWSzc4"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">从美国东部进入</figcaption></figure><p id="520f" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用来自EU-西部的LB的任播IP访问Zoneprinter，返回来自在集群3-欧洲-西部2-b中运行的Zoneprinter pod的响应</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi my"><img src="../Images/ba2e8deb996c00b9e3bc55610f0b4e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pm-rhIy8ldO_mZbu"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">从EU-西进入</figcaption></figure><p id="ab9d" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用网页性能工具访问应用程序显示，美国和欧洲的响应时间相同。</p><p id="dba5" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">来自弗吉尼亚:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/feece0c88ce02271108f708198eb849b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qP71zhg73Prx_1f3"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">从弗吉尼亚访问(美国东部)</figcaption></figure><p id="bf62" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">来自伦敦:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/0b8641395d191b444dee3246135dd9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dCFSGjlfFcQ6ZwbC"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">从伦敦访问(欧盟西部)</figcaption></figure><p id="bd8e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">比较LB的任播IP和在传统EIP(弹性IP)上运行的应用程序的<em class="mn"> traceroute </em>结果，显示出响应时间和下一跳数的巨大差异。</p><p id="da30" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从不同区域到LB的任播IP的<em class="mn">跟踪路由</em>显示出最小的跳数和较低的响应时间。这基本上证明了基于邻近性的路由选择在最近的集群上运行的应用。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/841e9c6818c2f3fa4502d6e4ab0a68b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D9G9mJSB5W0vW_dA"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Traceroute —来自不同地区的任播IP</figcaption></figure><p id="2711" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从纽约到伦敦EIP上的应用程序的<em class="mn"> traceroute </em>显示了跳数和响应时间的显著增加。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/bd784de5e6cca71498cfbd6c2adaf91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oTafpWuC6yltLTF1"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Traceroute —从纽约到伦敦的EIP</figcaption></figure><h1 id="cf75" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">监控和指标</h1><p id="711c" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">负载平衡器详细信息部分提供后端运行状况、利用率和请求指标。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/a60278da67f85efb490206f155797afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TVUVbDkHExwJ0kRa"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">LB —监控</figcaption></figure><p id="ed56" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">显示请求、流量和服务后端的地图。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/7901c38f3f51b58245c4c68c87888a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*grOzs4kjHZamn9aW"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">LB —监控</figcaption></figure><h1 id="d000" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">其他功能</h1><p id="3b48" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">Anthos的Ingress支持其他功能，例如:</p><ul class=""><li id="9936" class="nd ne jf ke b kf kg kj kk kn nf kr ng kv nh kz ni nj nk nl bi translated">支持HTTPS:库本内特家族<a class="ae la" href="https://cloud.google.com/kubernetes-engine/docs/concepts/secret" rel="noopener ugc nofollow" target="_blank">的秘密</a>支持HTTPS。在启用HTTPS支持之前，用户必须创建一个静态IP地址。这个静态IP允许HTTP和HTTPS共享同一个IP地址。可以使用MCI资源中的“tls”参数来提供该秘密。</li><li id="07a5" class="nd ne jf ke b kf nm kj nn kn no kr np kv nq kz ni nj nk nl bi translated">后端配置支持:<a class="ae la" href="https://cloud.google.com/kubernetes-engine/docs/how-to/ingress-for-anthos#backendconfig_support" rel="noopener ugc nofollow" target="_blank">后端配置CRD </a>允许您定制计算引擎后端服务资源上的设置。</li></ul><h1 id="8b9d" class="lg lh jf bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">有云甲的晶片</h1><p id="3cfa" class="pw-post-body-paragraph kc kd jf ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">谷歌云盔甲部署在谷歌网络的边缘，并与全球负载平衡基础设施紧密耦合。Cloud Armor可以使用Google Cloud提供的自定义或预配置规则来实现基于地理的访问控制、预配置WAF规则和自定义L7过滤策略。Google Cloud Armor提供了预配置的复杂web应用防火墙(WAF)规则，这些规则带有几十个根据开源行业标准编译的<em class="mn">签名</em>。</p><p id="4fbe" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">用户可以制定安全和SSL策略，这些策略可以应用于目标，这里的目标是负载平衡器。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/d2946d70d880af03e69767cbf6676725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MZry-yqMLEON-5z6"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">云装甲—安全策略</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/85c34353ad8dd59c5d472b9fa017e04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w9jguMg8C-te4LKd"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">云甲——增加LB作为目标</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/22f85938b323ca9bb72564068c0e0b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lusPps_oCRF629S8"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">云装甲— SSL策略</figcaption></figure><p id="118e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="6d0b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">除了基于邻近度的路由，多集群入口还简化了其他操作，如蓝/绿集群升级、灾难恢复、基于复杂健康检查的自动故障转移、在Kubernetes上运行高可用性(HA)应用、降低DDoS攻击风险等。并且具有许多其他优势，所有这些优势都有可能转化为显著的竞争优势。</p></div></div>    
</body>
</html>
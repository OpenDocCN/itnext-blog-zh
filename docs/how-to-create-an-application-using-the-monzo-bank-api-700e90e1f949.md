# 如何使用 Monzo Bank API 创建应用程序

> 原文：<https://itnext.io/how-to-create-an-application-using-the-monzo-bank-api-700e90e1f949?source=collection_archive---------2----------------------->

![](img/81181fd7bcdd87d7988ea59da2c2f899.png)

监控你的支出是保持你的财务领先的推荐方法之一，由于 Monzo 等银行创新，这变得非常容易。我们将与 Monzo API 进行对话，以提取我们的帐户和交易列表。我们不会构建一个单一页面的应用程序，因为这里的重点是通过后端代码演示 API 访问。

过去探索 OAuth 对我来说很可怕，我相信其他人也会有这种感觉。然而，由于 OAuth 2 中的一些变化，使用 API 变得更加简单。这里希望降低进入的门槛，这样你就可以自信地亲自尝试，体验这一领域的成功。肯定会有一个*来回的证书交换*，然而之后就一帆风顺了。下图显示了该流程的预期结果:

![](img/3520aea480340d5bb1fa69fc9315d830.png)

申请流程。我们的应用程序请求一个访问令牌，但它没有包含在这个图中，这样我们可以简化事情:)

流程可以描述如下:

1.  用户进入欢迎屏幕
2.  用户点击“登录”按钮
3.  用户被引导到 Monzo 的授权屏幕上
4.  用户输入他们的电子邮件地址并点击“提交”
5.  用户查看他们的电子邮件并点击“登录 Monzo”链接
6.  用户被重定向回我们的应用程序，显示他们的 Monzo 帐户
7.  用户点击账户，将他们引导到属于该特定账户的所有交易的页面

# 为我们的应用程序创建 OAuth 客户端

在我们编写应用程序之前，我们需要在 [Monzo 的开发者网站](https://developers.monzo.com/)上创建一个 OAuth 客户端。进入网站，点击“**用你的 Monzo 账户**登录，进入游乐场。一旦你进去了:

1.  点击右上角主导航上的“**客户端**
2.  点击“**新建 OAuth 客户端**
3.  提供**名称**、**重定向 URL**和**描述**。*我们不会担心这个例子中的其他字段。*
4.  点击**提交**创建您的客户

执行上述操作后，您将返回到“**管理 OAuth 客户端**”屏幕，其中列出了您的条目(*如果看不到，请尝试刷新页面*)。选择您创建的客户端，并记下**客户端 ID** 和**客户端密码**。我们将在下一步中需要这些。

# 开始编码吧！

我们将与 NPM 包裹[快递](https://www.npmjs.com/package/express)和[请求](https://www.npmjs.com/package/request)进行轻松合作。让我们通过在我们的项目目录中运行`npm i express request --save`来安装这些。然后，我们将使用下面的代码片段设置我们的服务器和欢迎页面:

运行上面的代码会为我们设置一个欢迎屏幕，其中包含我们的行动要求，以启动流程的其余部分。稍后将填充 **accessToken** 变量。这将保存有关当前用户会话的信息。*有一种更安全的方式来处理这个会话，并将这个挑战留给你*。现在让我们继续。

点击按钮中的**符号，页面将转到 Monzo 的授权页面，该页面包含查询字符串中的表单字段值。为了让我们成功地从 Monzo 重定向，我们需要定义一个端点来接受用户重定向到我们的应用程序时发送给我们的授权码。在`app.listen(3000);`之前让我们来看看:**

我们的端点是根据创建 OAuth 客户机时设置的重定向 url 命名的。成功重定向后，Monzo 将发送关键字'**代码**'和'**状态**'的查询字符串值。我们将在下面的请求中使用'**代码**'来检索访问令牌。这将持续几个小时。然后，我们将这个访问令牌持久化到我们之前创建的 **accessToken** 变量中。我们还会将用户重定向到**/账户**屏幕。让我们现在创建这个。

# 从用户帐户中检索信息

现在我们有了令牌，可以列出帐户了:

这将显示一个无序的帐户信息列表，并带有一个查看所选帐户交易历史的链接。这将要求我们的最后一个端点获取并显示该事务信息:

金额以便士的形式返回，因此需要如代码片段所示的格式。完整的解决方案可在找到。下面可以看到一个演示:

# 结论

我们的教程到此结束。一如既往，最好的学习方法是实践。我希望您花时间尝试代码片段，并从结果中学到一些东西。目前，电子邮件链接似乎是用户授权你的应用程序的主要方式，尽管 Monzo 可能正在做出改进。

你认为这个解决方案怎么样？在评论里告诉我。

# 进一步阅读

1.  [Monzo 开发者 API](https://developers.monzo.com)
2.  艾伦·帕雷基的《T4》第二版简化版
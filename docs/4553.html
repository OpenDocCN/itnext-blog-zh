<html>
<head>
<title>Building A Medium-like Text Editor in ReactJS Using Draftail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Draftail在ReactJS中构建一个类似媒体的文本编辑器</h1>
<blockquote>原文：<a href="https://itnext.io/building-a-medium-like-text-editor-in-reactjs-using-draftail-ce47ffcbe240?source=collection_archive---------2-----------------------#2020-07-23">https://itnext.io/building-a-medium-like-text-editor-in-reactjs-using-draftail-ce47ffcbe240?source=collection_archive---------2-----------------------#2020-07-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1bdec92d9b202572ea7151e824101271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GQAAm6QJ0yLbj-7J"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">科琳·库兹在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="e7b3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为一名软件开发人员，你可能需要为你的ReactJS应用程序构建一个文本编辑组件，而你只是不想在其中加入那些花哨的老式<em class="le">文本区</em>或<em class="le">输入</em>标签。他们只是不符合你的要求。</p><p id="cbf1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从零开始建立？从时间角度来看，这可能也不是一个好的选择。</p><p id="db11" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你开始在你的浏览器里打开一个新的标签页，然后在谷歌里搜索，结果并不好。有太多的选择，它们会让你陷入更深的困惑。既然如此，这就是我写这个故事的原因。</p><h1 id="b346" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">你的第一步:起草文件</h1><p id="7ca4" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">在这个故事中，我们将使用Draftail作为富文本编辑器的主要组件。我很喜欢使用它，我想现在是我回报它的时候了。</p><p id="426e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，这个故事的目标不是构建一个全功能的中等富文本编辑器，而是我们正在构建一个看起来很像的工作编辑器，所以代码很少。您可以根据自己的需要对其进行定制。</p><p id="9d07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据他们的网站，Draftail是一个用Draft.js构建的可配置富文本编辑器。它易于使用，无论技能水平如何，它是可扩展的(这意味着你可以为特定的用例构建自己的自定义扩展)，它的API由<a class="ae kf" href="https://www.draftail.org/blog/2018/03/05/why-wagtail-new-editor-is-built-with-draft-js" rel="noopener ugc nofollow" target="_blank"> Draft.js和React </a>支持。如果你想了解更多关于Draftail的信息，你可以查看他们的网站:<a class="ae kf" href="https://draftail.org" rel="noopener ugc nofollow" target="_blank">Draftail.org</a>。</p><h1 id="fb44" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">弄脏我们的手</h1><p id="91de" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">现在，让我们跳到代码中，在那里我们将实际构建我们的类似媒体的文本编辑器。我尽可能让它简单明了，所以你可以很容易地遵循每一个步骤。</p><ol class=""><li id="e740" class="mi mj it ki b kj kk kn ko kr mk kv ml kz mm ld mn mo mp mq bi translated">打开您的终端，创建您的工作目录，并切换到它。</li></ol><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9a69" class="na lg it mw b gy nb nc l nd ne">$ mkdir medium-like-text-editor &amp;&amp; cd medium-like-text-editor</span></pre><p id="85d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.在工作目录中创建ReactJS应用程序(命令中的点/句点表示ReactJS应用程序将安装在当前目录中)。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5e98" class="na lg it mw b gy nb nc l nd ne">$ npx create-react-app .</span></pre><p id="4300" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.安装所需的依赖项。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="52c2" class="na lg it mw b gy nb nc l nd ne">$ npm install --save draftail draft-js@0.10.5 draft-js-inline-toolbar-plugin draft-js-side-toolbar-plugin</span></pre><p id="effe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将看到上面的命令指定了一个DraftJS版本(0.10.5)。这是因为，当我写这篇文章时，最新支持的版本是DraftJS v0.10.5。我试图使用较新版本的DraftJS，但它目前无法与最新版本的Draftail兼容。</p><p id="7b99" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基于生成的ReactJS应用程序，我们将只需要处理2个文件:<code class="fe nf ng nh mw b">App.js</code>和<code class="fe nf ng nh mw b">App.css</code>。让我们开始吧。</p><p id="b440" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.编辑你的<code class="fe nf ng nh mw b">App.js</code>,让它看起来像这样:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="b14e" class="na lg it mw b gy nb nc l nd ne">import React from <em class="le">"react"</em>;<br/>import { DraftailEditor } from <em class="le">"draftail"</em>;<br/>import { EditorState } from <em class="le">"draft-js"</em>;<br/>import createInlineToolbarPlugin from <em class="le">"draft-js-inline-toolbar-plugin"</em>;<br/>import createSideToolbarPlugin from <em class="le">"draft-js-side-toolbar-plugin"</em>;</span><span id="3786" class="na lg it mw b gy ni nc l nd ne">import <em class="le">"./App.css"</em>;<br/>import <em class="le">"draft-js/dist/Draft.css"</em>;<br/>import <em class="le">"draftail/dist/draftail.css"</em>;<br/>import <em class="le">"draft-js-inline-toolbar-plugin/lib/plugin.css"</em>;<br/>import <em class="le">"draft-js-side-toolbar-plugin/lib/plugin.css"</em>;</span><span id="0459" class="na lg it mw b gy ni nc l nd ne">const inlineToolbarPlugin = createInlineToolbarPlugin();<br/>const { InlineToolbar } = inlineToolbarPlugin;</span><span id="00f3" class="na lg it mw b gy ni nc l nd ne">const sideToolbarPlugin = createSideToolbarPlugin();<br/>const { SideToolbar } = sideToolbarPlugin;</span><span id="7a56" class="na lg it mw b gy ni nc l nd ne">const plugins = [inlineToolbarPlugin, sideToolbarPlugin];</span><span id="2034" class="na lg it mw b gy ni nc l nd ne">class App extends React.<em class="le">Component</em> {<br/>    constructor(<em class="le">props</em>) {<br/>        super(props);<br/>        this.state = {<br/>            editorState: EditorState.createEmpty()<br/>        };<br/>        this.changeState = this.changeState.bind(this);<br/>    }</span><span id="3184" class="na lg it mw b gy ni nc l nd ne">    changeState(<em class="le">state</em>) {<br/>        this.setState({<br/>            editorState: state<br/>        });<br/>    }</span><span id="eda2" class="na lg it mw b gy ni nc l nd ne">    render() {<br/>        return (<br/>            &lt;div className=<em class="le">"App"</em>&gt;<br/>                &lt;DraftailEditor<br/>                    editorState={this.state.editorState}<br/>                    onChange={this.changeState}<br/>                    placeholder=<em class="le">"Tell your story..."<br/>                    </em>plugins={plugins}<br/>                /&gt;<br/>                &lt;InlineToolbar /&gt;<br/>                &lt;SideToolbar /&gt;<br/>            &lt;/div&gt;<br/>        );<br/>    }<br/>}</span><span id="87f2" class="na lg it mw b gy ni nc l nd ne">export default App;</span></pre><p id="f90b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.编辑您的<code class="fe nf ng nh mw b">App.css</code>,使其看起来像这样:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5a86" class="na lg it mw b gy nb nc l nd ne">.App {<br/>    font-family: sans-serif;<br/>    text-align: center;<br/>    display: block;<br/>}</span><span id="21e3" class="na lg it mw b gy ni nc l nd ne"><em class="le">/* Override default */<br/></em>.Draftail-Toolbar {<br/>    background: transparent !important;<br/>    border: none !important;<br/>}</span><span id="9678" class="na lg it mw b gy ni nc l nd ne"><em class="le">/* Override default */<br/></em>.Draftail-Editor {<br/>    border: none !important;<br/>    width: 60% !important;<br/>    margin-top: 100px !important;<br/>    margin-left: auto !important;<br/>    margin-right: auto !important;<br/>}</span><span id="8822" class="na lg it mw b gy ni nc l nd ne"><em class="le">/* Override default */<br/></em>.public-DraftEditor-content {<br/>    font-family: Georgia, <em class="le">"Times New Roman"</em>, Times, serif !important;<br/>}</span><span id="9c82" class="na lg it mw b gy ni nc l nd ne"><em class="le">/* Override default */<br/></em>.public-DraftEditorPlaceholder-inner {<br/>    font-family: Georgia, <em class="le">"Times New Roman"</em>, Times, serif !important;<br/>}</span></pre><p id="fd17" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有些人可能不喜欢在CSS中使用<code class="fe nf ng nh mw b">!important</code>，但这是目前我们能做的最快的一步。</p><p id="9252" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.运行它</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="dc8d" class="na lg it mw b gy nb nc l nd ne">$ npm start</span></pre><p id="ea9f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您的终端应该会自动打开浏览器，并打开刚刚运行的ReactJS应用程序。如果没有，在浏览器中打开<code class="fe nf ng nh mw b"><a class="ae kf" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>。</p><p id="dfd9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在你的浏览器中，它看起来只不过是“<em class="le">讲述你的故事……</em>”，但仅此而已。试着点一下，想写什么就写什么。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/0afa536e4ad7e973afd17964f90416e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2MgUmIuKktlJJYoKopS-Q.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">默认视图</figcaption></figure><p id="573f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在左侧会有一个浮动图标，你可以悬停和点击。如果你想格式化一个特定的单词/字符，阻止它，一个浮动工具栏就会出现。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e8d3184b82e1e50bc572713ace022bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/1*bqHSUESAMlu2YVqvc9vpuw.gif"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">它是如何工作的</figcaption></figure><p id="535e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你不想按部就班地做，我已经把这个项目放在我的<a class="ae kf" href="https://github.com/dkhd/medium-like-text-editor" rel="noopener ugc nofollow" target="_blank"> Github </a>中，你可以克隆它并在你的机器上运行。此外，您可能还想尝试一下<a class="ae kf" href="https://codesandbox.io/s/medium-like-text-editor-ifdbt" rel="noopener ugc nofollow" target="_blank"> Codesandbox </a>中的工作演示。</p><p id="5b35" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">祝你今天开心！玩的开心！</p></div></div>    
</body>
</html>
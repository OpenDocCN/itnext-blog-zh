<html>
<head>
<title>Amazon EKS upgrade journey from 1.15 to 1.16</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊EKS从1.15升级到1.16的旅程</h1>
<blockquote>原文：<a href="https://itnext.io/amazon-eks-upgrade-journey-from-1-15-to-1-16-4f48c7b6e512?source=collection_archive---------1-----------------------#2020-05-06">https://itnext.io/amazon-eks-upgrade-journey-from-1-15-to-1-16-4f48c7b6e512?source=collection_archive---------1-----------------------#2020-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7cc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">EKS控制平面升级到1.16版本的流程和注意事项</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/31c17ba57ac23da291be839251ec9df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AueuegYlDBSqfitSnBVS1g.jpeg"/></div></div></figure><h1 id="6ab5" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">概观</h1><p id="db30" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">AWS最近发布了对<a class="ae mb" href="https://aws.amazon.com/about-aws/whats-new/2020/04/amazon-eks-now-supports-kubernetes-version-1-16/" rel="noopener ugc nofollow" target="_blank">亚马逊Kubernetes服务1.16 </a>的支持。在该版本中，有大量的更改需要检查或更新。在这篇文章中，我将介绍一些在考虑升级EKS之前必须检查和升级的服务。</p><h1 id="5c28" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Kubernetes 1.16特性</h1><p id="c930" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">当然，Kubernetes发展很快，有新的功能和缺陷修复。主要的新功能包括:</p><ul class=""><li id="706c" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated"><a class="ae mb" href="https://kubernetes-csi.github.io/docs/volume-expansion.html" rel="noopener ugc nofollow" target="_blank">音量大小调整支持</a></li><li id="dd3b" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated"><a class="ae mb" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-gmsa/" rel="noopener ugc nofollow" target="_blank"> Windows GMSA </a></li><li id="2b01" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated"><a class="ae mb" href="https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/#garbage-collecting-load-balancers" rel="noopener ugc nofollow" target="_blank">服务负载平衡器的终结器保护</a>现在处于测试状态。</li><li id="0e5b" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">可扩展性机制<a class="ae mb" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" rel="noopener ugc nofollow" target="_blank">自定义资源定义</a>和<a class="ae mb" href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/" rel="noopener ugc nofollow" target="_blank">准入webhooks </a>现已普遍可用。</li><li id="bc4a" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">一个新的注释:<code class="fe mq mr ms mt b">service.beta.kubernetes.io/aws-load-balancer-eip-allocations</code>在服务类型<code class="fe mq mr ms mt b">LoadBalancer</code>上可用，为网络负载平衡器分配一个弹性IP地址。</li></ul><p id="77c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您需要更多信息，请访问<a class="ae mb" href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.16.md" rel="noopener ugc nofollow" target="_blank"> Kubernetes项目发布说明</a>。</p><h1 id="8d40" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Kubernetes 1.16突破</h1><p id="673f" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">真正的突破性变化实际上与过时的API有关。1.16版已停止为以下产品提供服务:</p><ol class=""><li id="d862" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mu mi mj mk bi translated">不再提供<strong class="jp ir">扩展/v1beta1 </strong> API版本中的网络策略。所有网络策略都需要使用<strong class="jp ir">networking.k8s.io/v1.</strong></li><li id="dee4" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated"><strong class="jp ir">扩展/v1beta1 </strong> API版本中的PodSecurityPolicy不再适用。需要使用API版本<strong class="jp ir"> policy/v1beta1 </strong>。这一点对于EKS的顾客来说尤其重要。</li><li id="e7c3" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">不再提供<strong class="jp ir">扩展/v1beta1 </strong>和<strong class="jp ir">应用/v1beta2 </strong> API版本中的DaemonSet。您必须迁移到使用<strong class="jp ir"> apps/v1 </strong> API版本。此外，规范定义中还有一些重要的变化:删除了<br/>*<code class="fe mq mr ms mt b">spec.templateGeneration</code><br/>*<code class="fe mq mr ms mt b">spec.selector</code>是必需的，并且在创建后不可更改<br/> * <code class="fe mq mr ms mt b">spec.updateStrategy.type</code>现在默认为<code class="fe mq mr ms mt b">RollingUpdate</code>(这最终被修复，在以前的API版本<code class="fe mq mr ms mt b">extensions/v1beta1</code>中默认为<code class="fe mq mr ms mt b">OnDelete</code>，这没有任何意义)。</li><li id="5ef4" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">不再提供<strong class="jp ir">扩展/v1beta1 </strong>、<strong class="jp ir">应用/v1beta1 </strong>和<strong class="jp ir">应用/v1beta2 </strong> API版本中的部署。您必须迁移到使用<strong class="jp ir"> apps/v1 </strong> API版本。<br/>此外，规格定义也有变化:<br/> * <code class="fe mq mr ms mt b">spec.rollbackTo</code>被删除<br/> * <code class="fe mq mr ms mt b">spec.selector</code>现在是必需的，创建后不可更改；使用现有模板标签作为无缝升级的选择器<br/> * <code class="fe mq mr ms mt b">spec.progressDeadlineSeconds</code>现在默认为<code class="fe mq mr ms mt b">600</code>秒(在<code class="fe mq mr ms mt b">extensions/v1beta1</code>中默认为无截止日期)<br/> * <code class="fe mq mr ms mt b">spec.revisionHistoryLimit</code>现在默认为<code class="fe mq mr ms mt b">10</code>(在<code class="fe mq mr ms mt b">apps/v1beta1</code>中默认为<code class="fe mq mr ms mt b">2</code>，<code class="fe mq mr ms mt b">extensions/v1beta1</code>中默认为保留全部)<br/> * <code class="fe mq mr ms mt b">maxSurge</code>和<code class="fe mq mr ms mt b">maxUnavailable</code>现在默认为<code class="fe mq mr ms mt b">25%</code>(在<code class="fe mq mr ms mt b">extensions/v1beta1</code>中默认为<code class="fe mq mr ms mt b">1</code>)</li><li id="1835" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">不再提供<strong class="jp ir"> apps/v1beta1 </strong>和<strong class="jp ir"> apps/v1beta2 </strong> API版本中的StatefulSet。您必须转到<strong class="jp ir"> apps/v1 </strong> API版本。<br/>另外，规格定义也有变化:<br/> * <code class="fe mq mr ms mt b">spec.selector</code>现在是必需的，创建后不可更改<br/> * <code class="fe mq mr ms mt b">spec.updateStrategy.type</code>现在默认为<code class="fe mq mr ms mt b">RollingUpdate</code>(在<code class="fe mq mr ms mt b">apps/v1beta1</code>中默认为<code class="fe mq mr ms mt b">OnDelete</code>，这又没有意义了)</li><li id="73f4" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">不再提供<strong class="jp ir">扩展/v1beta1 </strong>、<strong class="jp ir">应用/v1beta1 </strong>和<strong class="jp ir">应用/v1beta2 </strong> API版本中的副本集。使用<strong class="jp ir"> apps/v1 </strong> API版本。<br/>此外，规格定义也有变化:<br/> * <code class="fe mq mr ms mt b">spec.selector</code>现在是必需的，创建后不可更改</li></ol><p id="e3f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上是所有值得一提的大变化，以及在升级EKS控制平面到1.16之前需要注意的一切。现在，我将展示我通常在集群内部运行的服务，这些服务可能需要在升级之前进行检查。</p><h2 id="909e" class="mv kz iq bd la mw mx dn le my mz dp li jy na nb lm kc nc nd lq kg ne nf lu ng bi translated">达蒙塞特</h2><ol class=""><li id="6d6b" class="mc md iq jp b jq lw ju lx jy nh kc ni kg nj kk mu mi mj mk bi translated">kube代理</li><li id="6bcf" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">aws-node ( <a class="ae mb" href="https://github.com/aws/amazon-vpc-cni-k8s" rel="noopener ugc nofollow" target="_blank">亚马逊-vpc-cni-k8s </a>)</li><li id="7a0c" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">印花布节点</li><li id="52ae" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">AWS-节点终止处理器(处理现场中断)</li><li id="69a3" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">newrelic-infra(对kubernetes的监测)</li></ol><h2 id="4282" class="mv kz iq bd la mw mx dn le my mz dp li jy na nb lm kc nc nd lq kg ne nf lu ng bi translated">部署</h2><ol class=""><li id="220e" class="mc md iq jp b jq lw ju lx jy nh kc ni kg nj kk mu mi mj mk bi translated">coredns</li><li id="712d" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">聚类自动缩放器</li><li id="96bc" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">外部dns</li><li id="530b" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">度量-服务器</li><li id="6eae" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">kube-状态-度量</li><li id="f35f" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">入口控制器</li><li id="73d2" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">重装机</li><li id="b022" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">外部秘密</li><li id="59fa" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">印花布-香蒲和印花布-水平-自动缩放</li></ol><p id="6c96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上所有组件都必须检查，以确保使用新的API版本。我在升级与<code class="fe mq mr ms mt b">spec.selector</code>相关的内容时发现了错误，所以记得将该字段添加到所有yaml定义中。</p><p id="bee9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">举个简单的例子，要将一个旧的部署转换成apps/v1，可以运行:<code class="fe mq mr ms mt b">kubectl convert -f ./deployment.yaml --output-version apps/v1</code>这对于daemonsets来说也是一样的。</p><p id="f0ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我会使用完全相同的过程来检查和升级StatefulSet。我不太喜欢在Kubernetes中使用StatefulSet，所以我干脆不使用它们。</p><p id="984b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于复制集，我使用利用复制集的部署。因此，我没有任何有效的服务示例。然而，同样的原则也适用于部署的情况。</p><p id="5806" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网络策略非常简单，只需要将API版本升级到<strong class="jp ir">networking.k8s.io/v1.</strong>此处不再添加任何内容。</p><h2 id="8631" class="mv kz iq bd la mw mx dn le my mz dp li jy na nb lm kc nc nd lq kg ne nf lu ng bi translated">PodSecurityPolicy</h2><p id="0ca2" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">PodSecurityPolicy或简称PSP可能是需要升级的最重要的组件。这在您使用默认的EKS PSP时尤其重要，该PSP是在集群创建期间部署的，名为“eks.privileged”。注意，你不需要在升级前重新部署默认的PSP。如果你使用的是你自己的PSP，它更安全，也更严格，只需为它们更新API版本。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nk"><img src="../Images/4a269a3ef1906d5f3ca17a30935f6552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FENvFXQDj3Wiz8JJIGx01w.png"/></div></div></figure><p id="73d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PSP可能是Kubernetes中最难理解的概念之一，许多人只是简单地将默认的PSP留在EKS上。</p><p id="8a48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仔细看看它，你会发现它使用的是旧版本的API。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nl"><img src="../Images/aa0e5461fea8986571f7704c82766bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*wc0upnPr4aLZaZW92_ca0w.png"/></div></div></figure><p id="4078" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">升级这个资源是绝对必须的！这里有一些模板，你可以简单地复制并应用到你的文件名中。</p><pre class="kn ko kp kq gt nm mt nn no aw np bi"><span id="7afa" class="mv kz iq mt b gy nq nr l ns nt">apiVersion: policy/v1beta1<br/>kind: PodSecurityPolicy<br/>metadata:<br/>  name: eks.privileged<br/>  annotations:<br/>    kubernetes.io/description: 'privileged allows full unrestricted access to<br/>      pod features, as if the PodSecurityPolicy controller was not enabled.'<br/>    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'<br/>  labels:<br/>    kubernetes.io/cluster-service: "true"<br/>    eks.amazonaws.com/component: pod-security-policy<br/>spec:<br/>  privileged: true<br/>  allowPrivilegeEscalation: true<br/>  allowedCapabilities:<br/>  - '*'<br/>  volumes:<br/>  - '*'<br/>  hostNetwork: true<br/>  hostPorts:<br/>  - min: 0<br/>    max: 65535<br/>  hostIPC: true<br/>  hostPID: true<br/>  runAsUser:<br/>    rule: 'RunAsAny'<br/>  seLinux:<br/>    rule: 'RunAsAny'<br/>  supplementalGroups:<br/>    rule: 'RunAsAny'<br/>  fsGroup:<br/>    rule: 'RunAsAny'<br/>  readOnlyRootFilesystem: false</span></pre><p id="a5e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得澄清的是，在应用新API版本的默认PSP后，它仍然会显示旧版本的API，因为PSP仍然是扩展API的一部分。但是，注释中的apiVersion包含正确的版本，所以您可以开始了。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nu"><img src="../Images/6570d1188044211ca1821d19deff86d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rWL36y_gCrNqx1vI-EFpow.png"/></div></div></figure><p id="2f9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成所有必要的步骤后，您终于可以将控制平面和工作节点升级到EKS 1.16了。</p><h2 id="e685" class="mv kz iq bd la mw mx dn le my mz dp li jy na nb lm kc nc nd lq kg ne nf lu ng bi translated">使用terraform升级</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nv"><img src="../Images/589eb613d1695cad7aae0641b82eec55.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*xHMMVpMz9MDowVTNwvROPQ.png"/></div></div></figure><p id="f7e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我个人使用terraform来部署和升级我的EKS集群。下面是EKS集群资源的一个例子。</p><pre class="kn ko kp kq gt nm mt nn no aw np bi"><span id="b1dd" class="mv kz iq mt b gy nq nr l ns nt">resource "aws_eks_cluster" "cluster" {<br/>  enabled_cluster_log_types = ["audit"]<br/>  name                      = local.name_prefix<br/>  role_arn                  = aws_iam_role.cluster.arn<br/>  version                   = "1.16"</span><span id="37a8" class="mv kz iq mt b gy nw nr l ns nt">  vpc_config {<br/>    subnet_ids              = flatten([module.vpc.public_subnets, module.vpc.private_subnets])<br/>    security_group_ids      = []<br/>    endpoint_private_access = "true"<br/>    endpoint_public_access  = "true"<br/>  }</span><span id="7a62" class="mv kz iq mt b gy nw nr l ns nt">  encryption_config {<br/>    resources = ["secrets"]<br/>    provider {<br/>      key_arn = module.kms-eks.key_arn<br/>    }<br/>  }</span><span id="c1c9" class="mv kz iq mt b gy nw nr l ns nt">  tags = var.tags<br/>}</span></pre><h2 id="fbfd" class="mv kz iq bd la mw mx dn le my mz dp li jy na nb lm kc nc nd lq kg ne nf lu ng bi translated">升级EKS控制平面后</h2><p id="a19a" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">请记住升级建议用于EKS 1.16的核心部署和默认设置。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nx"><img src="../Images/f5b2203f11240a2c9195ca399688c743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hxlk7kLTSU6UzdE8poTV_Q.png"/></div></div></figure><p id="75ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上只是AWS的推荐。您应该考虑将所有组件升级到1.16版本。它们可能包括:</p><ol class=""><li id="6edd" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mu mi mj mk bi translated">印花布节点</li><li id="7a54" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">聚类自动缩放器</li><li id="a558" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">kube-状态-度量</li><li id="0128" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mu mi mj mk bi translated">印花布-香蒲和印花布-水平-自动缩放</li></ol><h1 id="7785" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">摘要</h1><p id="6103" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><strong class="jp ir">升级到1.16之前</strong></p><ul class=""><li id="e71a" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated">更改您的YAML文件以引用新的API。</li><li id="5076" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">更新定制集成和控制器以调用新的API。</li><li id="9bce" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">确保您使用任何第三方工具的更新版本，如入口控制器、连续交付系统和其他调用新API的工具。</li></ul><p id="3cb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要轻松检查集群中不推荐使用的API，请确保启用了<code class="fe mq mr ms mt b">audit</code> <a class="ae mb" href="https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html" rel="noopener ugc nofollow" target="_blank">控制平面日志</a>，并将<code class="fe mq mr ms mt b">v1beta</code>指定为事件过滤器。</p><p id="9541" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对EKS的整个terraform设置感兴趣，你可以在我的github-&gt;<a class="ae mb" href="https://github.com/marcincuber/eks/tree/master/terraform-aws" rel="noopener ugc nofollow" target="_blank">https://github . com/marcincuber/eks/tree/master/terra form-AWS</a>上找到它</p><p id="af6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这篇文章很好地汇总了所有关于升级EKS的重要信息，它将帮助人们加快他们的任务。</p><p id="ad97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">享受Kubernetes！！！</p></div></div>    
</body>
</html>
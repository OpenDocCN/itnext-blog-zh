<html>
<head>
<title>Git Submodule Update</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Git子模块更新</h1>
<blockquote>原文：<a href="https://itnext.io/git-submodule-update-30ef27ea1f79?source=collection_archive---------0-----------------------#2022-05-23">https://itnext.io/git-submodule-update-30ef27ea1f79?source=collection_archive---------0-----------------------#2022-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5088" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">子模块是git将一个存储库嵌入另一个存储库的解决方案。子模块的一些最常见的用例如下:</p><ul class=""><li id="f1a4" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">将共享模块嵌入到多个其他存储库中，</li><li id="6d26" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">嵌入第三方库，</li><li id="eb58" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">分离责任和关注点，例如，将同一项目的不同reposss嵌入到主repo中，然后由主repo负责它们的集成。</li></ul><p id="e587" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这篇文章是我之前写的介绍文章的后续文章，假设你熟悉子模块的概念。如果你不熟悉子模块，请先看看前传。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/b5def588406f55ea672e5563b32330d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0R6eCb1pEtt-YiCmxkM3qg.png"/></div></div></figure><h1 id="bc4b" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">将子模块更新至最新版本</h1><blockquote class="mn"><p id="3718" class="mo mp it bd mq mr ms mt mu mv mw kn dk translated">子模块就像版本化的第三方库。由于升级到依赖项的最新版本可能会破坏您的代码，所以升级到子模块的最新版本也是如此。</p></blockquote><p id="da2b" class="pw-post-body-paragraph jq jr it js b jt mx jv jw jx my jz ka kb mz kd ke kf na kh ki kj nb kl km kn im bi translated">要将子模块更新到最新版本，请执行以下操作:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="d142" class="nh lq it nd b gy ni nj l nk nl">git submodule update</span></pre><p id="8601" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要查看添加到子模块的提交，请执行以下操作:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="2db5" class="nh lq it nd b gy ni nj l nk nl">git diff --submodule</span></pre><p id="e1e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在根据新的子模块版本测试代码之后，通过暂存子模块的路径来提交子模块:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="58f0" class="nh lq it nd b gy ni nj l nk nl">git add &lt;the-submodule-path&gt;<br/>git commit -m "Update submodule to version XXX"</span></pre><p id="0bef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有一个有意义的提交消息也很重要。如果子模块没有单独的版本，试着说明子模块更新的原因。例如</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="f267" class="nh lq it nd b gy ni nj l nk nl">git commit -m "Update submodule to use Python 3.9"</span></pre><h1 id="a39f" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">将子模块更新到特定版本</h1><p id="df70" class="pw-post-body-paragraph jq jr it js b jt nm jv jw jx nn jz ka kb no kd ke kf np kh ki kj nq kl km kn im bi translated">现在让我们假设您想要将您的子模块状态升级(或降级)到一个特定的版本，例如另一个repo或特定分支上的特定标记，或者甚至是特定的提交。</p><p id="b49c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们假设您的子模块在路径<code class="fe nr ns nt nd b">shared</code>下。将您的目录更改到此分支:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="cc4b" class="nh lq it nd b gy ni nj l nk nl">cd shared</span></pre><p id="66b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有一个显示分支的终端，它很可能会显示一个散列而不是一个名字:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="cf96" class="nh lq it nd b gy ni nj l nk nl">~/the-repo/shared [(569d7ce...)]$</span></pre><p id="0a95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您也可以运行:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="e18b" class="nh lq it nd b gy ni nj l nk nl">git branch</span></pre><p id="8b83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出会是这样的:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="6a36" class="nh lq it nd b gy ni nj l nk nl">* (HEAD detached at 569d7ce)<br/>  master</span></pre><p id="03a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">“HEAD detached”状态基本上意味着子模块的当前状态“没有名称”，即没有分支或标签指向该特定提交。如果没有，也不错。</p><p id="d4d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们要做的就是改变子模块repo的状态。</p><h2 id="5c96" class="nh lq it bd lr nu nv dn lv nw nx dp lz kb ny nz md kf oa ob mh kj oc od ml oe bi translated">1.更新到特定的分支或标签</h2><p id="41a1" class="pw-post-body-paragraph jq jr it js b jt nm jv jw jx nn jz ka kb no kd ke kf np kh ki kj nq kl km kn im bi translated">要将子模块更新到特定的分支或标记，只需切换到该分支或标记:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="49ce" class="nh lq it nd b gy ni nj l nk nl">git switch specific-branch </span></pre><p id="3796" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中<code class="fe nr ns nt nd b">specific-branch</code>是您想要将子模块更新到的分支的名称。该命令与以下命令相同:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="796d" class="nh lq it nd b gy ni nj l nk nl">git checkout specific-branch</span></pre><p id="35bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将在以后的文章中讨论签出和切换。</p><h2 id="41f0" class="nh lq it bd lr nu nv dn lv nw nx dp lz kb ny nz md kf oa ob mh kj oc od ml oe bi translated">2.降级一次提交</h2><p id="03b1" class="pw-post-body-paragraph jq jr it js b jt nm jv jw jx nn jz ka kb no kd ke kf np kh ki kj nq kl km kn im bi translated">要回到过去，你可以检查<code class="fe nr ns nt nd b">HEAD~1</code>:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="7c7f" class="nh lq it nd b gy ni nj l nk nl">git checkout HEAD~1</span></pre><h2 id="f933" class="nh lq it bd lr nu nv dn lv nw nx dp lz kb ny nz md kf oa ob mh kj oc od ml oe bi translated">3.转到特定提交</h2><p id="60e2" class="pw-post-body-paragraph jq jr it js b jt nm jv jw jx nn jz ka kb no kd ke kf np kh ki kj nq kl km kn im bi translated">现在让我们假设您想要将状态更改为特定的提交。首先，找出散列并对其进行校验:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="0da3" class="nh lq it nd b gy ni nj l nk nl">git checkout bfa784412503902f1d07edacb2e0e0954e2e221f</span></pre><h2 id="f733" class="nh lq it bd lr nu nv dn lv nw nx dp lz kb ny nz md kf oa ob mh kj oc od ml oe bi translated">回来提交</h2><p id="de3c" class="pw-post-body-paragraph jq jr it js b jt nm jv jw jx nn jz ka kb no kd ke kf np kh ki kj nq kl km kn im bi translated">既然您对子模块状态/版本感到满意，那么您可以返回到最初的repo:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="dac1" class="nh lq it nd b gy ni nj l nk nl">cd ..</span></pre><p id="60cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要查看对子模块所做的更改，请执行以下操作:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="c501" class="nh lq it nd b gy ni nj l nk nl">git diff --submodule</span></pre><p id="cd1e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它将列出添加或删除的提交，例如:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="4999" class="nh lq it nd b gy ni nj l nk nl">Submodule shared 43222e8..569d7ce (rewind): <br/>  &lt; Add venv and pyc files to .gitignore <br/>  &lt; Fix urllib3 version</span></pre><p id="c26f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这意味着上面提到的两个提交从子模块(rewind)中删除了。</p><p id="bbd0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，添加子模块并提交它:</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="335a" class="nh lq it nd b gy ni nj l nk nl">git add shared<br/>git commit -m "Rewind the commits"</span></pre><h1 id="1e71" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">最后的话</h1><ul class=""><li id="cde8" class="ko kp it js b jt nm jx nn kb of kf og kj oh kn kt ku kv kw bi translated"><a class="ae lc" href="https://medium.com/subscribe/@aerabi" rel="noopener">订阅</a>my Medium publishes，以便在新的Git周刊发布时获得通知。</li><li id="bd5d" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">关注Twitter 上的<a class="ae lc" href="https://twitter.com/MohammadAliEN" rel="noopener ugc nofollow" target="_blank">我，获取git上的每周文章和每日推文。</a></li></ul></div></div>    
</body>
</html>
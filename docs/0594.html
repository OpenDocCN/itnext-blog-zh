<html>
<head>
<title>Notific8 — From Old School to Modern: Part 3 — Starting the Factory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通知8 —从老派到现代:第3部分—启动工厂</h1>
<blockquote>原文：<a href="https://itnext.io/notific8-from-old-school-to-modern-part-3-starting-the-factory-ee863454389b?source=collection_archive---------5-----------------------#2018-04-06">https://itnext.io/notific8-from-old-school-to-modern-part-3-starting-the-factory-ee863454389b?source=collection_archive---------5-----------------------#2018-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1b621afef70b0f6aac41fdcc13c8dca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pK2uOKwytAZmqL_cPujdlw.png"/></div></div></figure><blockquote class="jy jz ka"><p id="1e14" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae la" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Fnotific8-from-old-school-to-modern-part-3-starting-the-factory-ee863454389b%3Futm_source%3Dmedium_sharelink%26utm_medium%3Dsocial%26utm_campaign%3Dbuffer" rel="noopener ugc nofollow" target="_blank">点击这里在LinkedIn上分享这篇文章</a></p></blockquote><p id="9192" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在上一篇博文中，我们致力于启动Notific8Options接口。既然接口已经启动，下一个逻辑位置就是我在第1部分中简要提到的新Notific8工厂。</p><h1 id="b878" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">工厂的职责</h1><p id="c13e" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">工厂将管理的工作包括:</p><ul class=""><li id="bc6c" class="mh mi iq ke b kf kg kj kk lb mj lc mk ld ml kz mm mn mo mp bi translated">跟踪默认值(设置和返回)</li><li id="e621" class="mh mi iq ke b kf mq kj mr lb ms lc mt ld mu kz mm mn mo mp bi translated">初始化通知容器</li><li id="6d8f" class="mh mi iq ke b kf mq kj mr lb ms lc mt ld mu kz mm mn mo mp bi translated">销毁通知容器</li><li id="cf11" class="mh mi iq ke b kf mq kj mr lb ms lc mt ld mu kz mm mn mo mp bi translated">创建通知</li></ul><p id="a455" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在这篇文章中，我将重点讨论第一点。</p><p id="1e3b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">和任何项目一样，单元测试是必须的。除非有正当理由，否则我不会在这篇或以后的文章中列举单元测试代码。然而，我将在每篇文章末尾的提交散列列表中包含与每篇文章相关的单元测试的提交散列。</p><h1 id="b8ae" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">工厂结构</h1><p id="c5a7" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">将有一个工厂维护上面列出的功能。一种选择是创建一个只允许创建一个实例的类。然而，使用Typescript，很容易利用<code class="fe mv mw mx my b">namespace</code>结构，因此不需要实例化。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8512" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">工厂将维护通知的默认选项列表。该模块开始时有一些默认值。提供一种简单的方法将它们重置回初始值也是一个好主意。这个方法也可以用来初始化变量，保持代码干燥(不要重复)。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2171" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在上面的代码中，初始化了具有在<code class="fe mv mw mx my b">Notific8Options</code>接口中定义的属性的<code class="fe mv mw mx my b">notific8DefaultOptions</code>变量。然后调用下面定义的<code class="fe mv mw mx my b">resetDefaultOptions()</code>方法来设置模块默认值。</p><p id="64e8" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">很有可能开发者想要使用一些默认选项，所以工厂需要提供一个方法来实现。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="deb5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">下一个任务是给开发者一个方法来设置他们自己的默认值。开发人员可能希望一次设置一组默认值，或者只设置一个默认值。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a9a5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">需要对现有的接口代码进行两处更改。第一种方法是通过在每个属性的末尾添加<code class="fe mv mw mx my b">?</code>来标记可选，从而只允许<code class="fe mv mw mx my b">Notific8Options</code>中的选项子集。第二种方法是修复以下错误:</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="d3e0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">可以通过为接口创建索引签名来修复该错误。更新后的界面如下:</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a161" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">索引签名必须与接口中的属性相匹配。每个索引都是一个字符串。每个值都有字符串、数字或布尔类型。还添加了Undefined，因为每个索引都是可选的。</p><h1 id="298c" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">为JavaScript提供更多保护</h1><p id="5235" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">对于使用Typescript的开发人员来说，如果存在无效的属性，项目中可用的类型将阻止他们的代码进行转换。对于JavaScript开发人员来说，需要在代码中添加一些保护措施来警告他们无效的属性。</p><figure class="mz na nb nc gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cb1a" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">相同的属性检查可用于设置单个选项和多个选项，因此它被提取到一个方法中。如果开发人员试图使用无效的属性，代码将抛出一个带有适当消息的<code class="fe mv mw mx my b">TypeError</code>。</p><h1 id="2df5" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">后期总结</h1><p id="971c" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">把这些放在一起，我们就有了通知工厂的开端！这篇文章初始化了管理通知默认值的能力。</p><p id="1bce" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在下一篇文章中，我将开始研究由工厂创建的实际通知类。</p><h1 id="7720" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">跟着走！</h1><p id="b205" class="pw-post-body-paragraph kb kc iq ke b kf mc kh ki kj md kl km lb me kp kq lc mf kt ku ld mg kx ky kz ij bi translated">该项目托管在https://github.com/willsteinmetz/notific8<a class="ae la" href="https://github.com/willsteinmetz/notific8" rel="noopener ugc nofollow" target="_blank">的GitHub上</a>我将从<code class="fe mv mw mx my b"><a class="ae la" href="https://github.com/willsteinmetz/notific8/tree/ts-2018" rel="noopener ugc nofollow" target="_blank">ts-2018</a></code>分支开始工作，并在每篇介绍代码更改的帖子末尾发布相关的提交散列。</p><ul class=""><li id="5127" class="mh mi iq ke b kf kg kj kk lb mj lc mk ld ml kz mm mn mo mp bi translated"><a class="ae la" href="https://github.com/willsteinmetz/notific8/commit/3ec0ebcdc898e1a745a8931312d77bdc8d2ad732" rel="noopener ugc nofollow" target="_blank"> 3ec0ebc </a> —增加启动Notific8Factory的单元测试</li><li id="5f84" class="mh mi iq ke b kf mq kj mr lb ms lc mt ld mu kz mm mn mo mp bi translated"><a class="ae la" href="https://github.com/willsteinmetz/notific8/commit/f8679480f9901a21985a3c9933ed67bf391d7bf8" rel="noopener ugc nofollow" target="_blank"> f867948 </a> —使用与默认选项相关的方法启动通知工厂</li></ul></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="7d3b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><em class="kd">最初发表于</em><a class="ae la" href="https://gist.github.com/3ae0aaec7d2b2a37adfd98635a1f9b4e" rel="noopener ugc nofollow" target="_blank"><em class="kd">gist.github.com</em></a><em class="kd">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Build a DeepL Translate Add-In for Microsoft Outlook with OutSystems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OutSystems为Microsoft Outlook构建一个DeepL翻译插件</h1>
<blockquote>原文：<a href="https://itnext.io/build-a-deepl-translate-add-in-for-microsoft-outlook-with-outsystems-a59a9dd34e3e?source=collection_archive---------2-----------------------#2022-06-08">https://itnext.io/build-a-deepl-translate-add-in-for-microsoft-outlook-with-outsystems-a59a9dd34e3e?source=collection_archive---------2-----------------------#2022-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4ee9dd55206c94b2ba8f9d7803c8d771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVIrKotkmyPQMpq0I_jQOg.png"/></div></div></figure><p id="8ba0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您想到<a class="ae kw" href="https://www.outsystems.com" rel="noopener ugc nofollow" target="_blank"> OutSystems </a>时，您通常会想到web和移动应用程序，但您也可以开发Microsoft Office Web Add-Ins，而且它甚至相对简单，但正如我们将看到的那样，有一些限制。本教程通过一个示例插件来解释这些步骤，该插件在<a class="ae kw" href="https://www.deepl.com" rel="noopener ugc nofollow" target="_blank"> DeepL </a>的帮助下翻译电子邮件。我们还负责身份验证，并学习如何在办公主机和我们的应用程序之间实现单点登录。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="1972" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">外部系统</h1><p id="691a" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">OutSystems是低代码应用平台。支持整个应用程序开发生命周期的可视化开发环境。低代码意味着您仍然可以使用自定义代码，无论是前端的JavaScript还是服务器端的C#。你可以在他们的网站上了解更多关于<a class="ae kw" href="https://www.outsystems.com" rel="noopener ugc nofollow" target="_blank"> OutSystems的信息。</a></p><h1 id="fbb6" class="le lf iq bd lg lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb bi translated">DeepL</h1><p id="42ab" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">DeepL是一个支持超过25种语言的在线文本和文档翻译服务。它以翻译文本的高准确性而闻名，并远远超过其他语言的翻译服务。</p><h1 id="61fd" class="le lf iq bd lg lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb bi translated">Microsoft Office加载项</h1><p id="da7a" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">使用自定义Office加载项，可以扩展Microsoft Office应用程序并与Office文档中的内容进行交互。无论是在桌面应用还是在网络上。</p><p id="20f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://docs.microsoft.com/en-us/office/dev/add-ins/overview/office-add-ins" rel="noopener ugc nofollow" target="_blank"> Office插件平台概述— Office插件| Microsoft文档</a></p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="f6ca" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">摘要</h1><p id="028c" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">在本教程中，我们将为Microsoft Outlook构建一个简单的任务窗格外接程序，在阅读邮件时使用。在我们的任务窗格(或侧边栏)中，我们要求用户选择一种目标语言，然后我们获取当前邮件的内容，用DeepL翻译并显示结果。我们还将看到如何使用Office主机应用程序用户凭证来自动登录我们的OutSystems应用程序。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/a524d0d6a578449e423e8bb101d18017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIaZ6puS2bDTEHp56kvKtA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">已完成的加载项</figcaption></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="3fad" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">限制</h1><p id="e8a8" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">用OutSystems构建Office插件有一些缺点</p><ul class=""><li id="cb09" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">使用<strong class="ka ir">目的地</strong>或<strong class="ka ir">重定向到另一个屏幕</strong>不起作用。Javascript API函数<strong class="ka ir"> $public也是如此。Navigation.navigateTo() </strong>。</li></ul><p id="dbae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认重定向是使用<strong class="ka ir">推状态</strong>写入浏览器历史。在Office Online IFRAME或Outlook桌面应用程序WebView控件中运行时，这将引发异常(<strong class="ka ir"> pushState </strong>不是函数)。</p><blockquote class="ne nf ng"><p id="51ba" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">这是一个真正的问题，因为它影响了很多功能。当您到达本教程中的身份验证步骤时，您会注意到我们不会使用SecurityException处理程序重定向到登录屏幕，而是在任务窗格屏幕上执行所有操作。在撰写本文时，我仍在等待外部系统支持如何解决这个问题的回复。</p></blockquote><ul class=""><li id="c119" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">Outlook Online中的<strong class="ka ir">任务窗格</strong>无法调整大小。它非常狭窄，尤其是当你翻译HTML格式的电子邮件时，它是不可用的。在Outlook桌面中，可以调整<strong class="ka ir">任务窗格</strong>的大小。</li></ul></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="15ba" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">你需要什么</h1><p id="64f3" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">要遵循本教程，您需要</p><ul class=""><li id="6c04" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">外部系统开发环境。(<a class="ae kw" href="https://www.outsystems.com/PartnerSignup/GetStarted.aspx?PartnerId=bdbab3cf-076f-49e2-91ac-a9157081eace&amp;utm_source=ISD%20FENIQS%20GmbH&amp;utm_medium=partner&amp;utm_campaign=partner-personal-environment&amp;utm_content=personal-environment" rel="noopener ugc nofollow" target="_blank">一个人的环境就够了</a>)</li><li id="f3b5" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">至少一个<a class="ae kw" href="https://www.deepl.com/de/pro-api?cta=header-pro-api/" rel="noopener ugc nofollow" target="_blank">免费的DeepL开发者账号</a>。注册后，进入您的账户页面，复制<strong class="ka ir">认证密钥</strong>。</li><li id="9a39" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">访问您的生命周期环境和配置安全设置的权利。我们必须设置Cookie SameSite设置，以便外接程序正常工作。</li><li id="f170" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">【OutSystems Forge的DeepL连接器。这将您的应用程序与DeepL REST API连接起来。</li><li id="9e7c" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><a class="ae kw" href="https://www.outsystems.com/forge/component-overview/13166/microsoft-office-addin-sso-connector" rel="noopener ugc nofollow" target="_blank">来自OutSytems Forge的Microsoft Office AddIn SSO连接器</a>。登录连接器提供从办公室主机检索用户访问令牌和执行外部系统登录的操作。</li><li id="1444" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">你的插件图标。Microsoft Office加载项需要三种大小的jpg或png格式的图标。16x16、32x32和80x80(例如DeepL80.png、DeepL80.png和DeepL80.png)。你也可以在这里下载这组图标。</li><li id="4c92" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">对您的Azure Active Directory租户的访问权限以及添加应用程序注册的权限。要在Microsoft Office和您的外部系统应用程序之间执行单点登录，这是一项必要的任务。</li><li id="e483" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">您还需要一个类似Visual Studio代码的文本编辑器来创建Office AddIn清单xml文件。</li></ul><h1 id="755f" class="le lf iq bd lg lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb bi translated">外部系统锻造</h1><p id="f241" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">OutSystems Forge主机OutSystems和社区创建的可重用组件。免费下载。DeepL和Microsoft Office主机登录连接器都由我在ISD FENIQS的团队维护。如果您想了解更多关于我们组件的信息，请访问Anvil。Anvil是我们所有外部系统组件的专用微型网站。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="92dc" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">逐步地</h1><p id="c92d" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated"><strong class="ka ir">步骤1 —配置终身安全设置</strong></p><p id="1afd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的OutSystems应用程序将嵌入Outlook Web上的IFRAME和桌面应用程序的Web视图容器中运行。Chrome和Edge浏览器有一个名为<strong class="ka ir"> SameSite </strong>的安全设置，默认设置为<strong class="ka ir"> Lax </strong>。这可以防止跨域发送cookies。</p><p id="ccad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以阅读更多关于她的信息</p><ul class=""><li id="0cf3" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><a class="ae kw" href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-handle-samesite-cookie-changes-chrome-browser?tabs=dotnet" rel="noopener ugc nofollow" target="_blank">如何处理Chrome浏览器中的SameSite cookie变更—微软Entra |微软Docs </a></li><li id="ab4a" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><a class="ae kw" href="https://success.outsystems.com/Support/Enterprise_Customers/Maintenance_and_Operations/Upcoming_changes_in_cookie_handling_in_Google_Chrome?utm_source=ost-outsystems%20tools&amp;utm_medium=ost-lifetime&amp;utm_campaign=ost-docrouter&amp;utm_content=ost-helpid-30237&amp;utm_term=ost-contextualhelp" rel="noopener ugc nofollow" target="_blank">Google Chrome cookie处理即将发生的变化——out systems支持</a></li></ul><p id="a475" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在生存期中，我们可以为每个环境设置一个安全设置，告诉浏览器将其<strong class="ka ir"> SameSite </strong>行为设置为<strong class="ka ir"> None </strong>，从而允许跨域cookie请求。不幸的是，我们只能对每个环境这样做，而不能对每个应用程序这样做(至少我还没有找到这样做的方法。如果你知道如何做到这一点，我会感谢一个消息)。</p><p id="59c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以直接进入你的生活环境或者点击服务工作室中的<strong class="ka ir">齿轮图标</strong>。这将打开您的浏览器，并将您重定向到您环境的服务中心。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/ef340b1117de1b00a211dcec68883c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:56/format:webp/1*uOigZDei5W0WVlQnhpiaSg.png"/></div></figure><p id="a798" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在服务中心，单击最右侧的<strong class="ka ir">管理生命周期内的所有环境</strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b0eeaebfef8bd37082b6cc7ceaa3965f.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*6JuoQ1lz90eBWV_qU9r68Q.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">终生管理环境</figcaption></figure><p id="76d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在生命周期中，点击菜单中的<strong class="ka ir">环境</strong>选项卡。在需要更改安全设置的环境中，点击<strong class="ka ir">更多安全设置</strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ab1e7067d0ecae65fcfd048eed3e62a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*m-IIQXj5CZwE4SQloVUB2Q.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">更多安全设置</figcaption></figure><p id="4728" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在“安全设置”页面上，确保</p><ul class=""><li id="602e" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir">启用HTTP严格传输安全(HSTS) </strong>已启用，这将自动设置<strong class="ka ir">在Web应用程序中强制HTTPS</strong>。</li></ul><p id="8f35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nh">您也可以禁用严格传输，只启用Web应用程序屏幕的强制HTTPS。</em></p><ul class=""><li id="b199" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">在<strong class="ka ir">cookie</strong>下，<strong class="ka ir">安全</strong>设置被启用。</li><li id="bfcf" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir"> SameSite </strong>设置设为<strong class="ka ir">无。</strong></li></ul><p id="49c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击<strong class="ka ir">保存</strong>。您可以忽略告诉您执行全部发布的消息。当我们创建我们的应用程序时，它会考虑这个设置，而所有现有的应用程序都不会，直到你重新发布它们。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="a8f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤2——创建一个外部系统反应式Web应用程序</strong></p><p id="d963" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio中创建新的反应式Web应用程序(例如OfficeAddIn)。创建默认的反应式Web模块并发布它。</p><p id="3b8b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">主流程</strong>中创建一个新的<strong class="ka ir">屏幕</strong>，并将其命名为<strong class="ka ir">任务窗格。</strong></p><p id="0f90" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">转到新<strong class="ka ir">任务窗格</strong>屏幕的小部件树，将布局设置为<strong class="ka ir">布局空白</strong>(移除不必要的占位符项目)。我们的插件不需要菜单，只需要一个简单的空白屏幕。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/f8326a5edea8f91b9410a18788d8dd2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*VfDHHJL5s_InhVfcoTlYkA.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">坯件布置</figcaption></figure><p id="8df5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用<strong class="ka ir"> Hello World </strong>为内容添加一个文本小部件🙂。</p><p id="a34a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">允许<strong class="ka ir">匿名</strong>角色访问任务窗格屏幕。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7a897a18ef9e1a66ad0b20a13c40f699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*zOs7dpsLOvUWF4Ybt_oytw.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">允许匿名角色</figcaption></figure><p id="86bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio的<strong class="ka ir">界面</strong>选项卡上，在<strong class="ka ir">图像</strong>下新建一个文件夹<strong class="ka ir">图标</strong>。</p><p id="3add" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将三个插件图标上传到文件夹并发布您的模块。让Service Studio和您的模块保持打开状态，我们将继续下一步。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/1b1b3ae49a0a371db0eb001532e33d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*HG8DtD-pFGWxKiGe9dpZIg.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">上传加载项图标</figcaption></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="29ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤3 —添加Office Javascript </strong></p><p id="8d82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Office主机——在我们的例子中是Microsoft Outlook——和您的应用程序可以通过<a class="ae kw" href="https://docs.microsoft.com/en-us/office/dev/add-ins/reference/javascript-api-for-office" rel="noopener ugc nofollow" target="_blank"> Office Javascript框架</a>进行交互。该框架提供了一个大的Api，如检索邮件正文，我们将在本教程中使用。</p><p id="7b9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们必须确保在尝试与办公室主机交互之前初始化框架。</p><p id="d637" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">步骤2 </strong>中，我们将任务栏屏幕的布局块更改为<strong class="ka ir"> LayoutBlank </strong>。加载Office Javascript最简单的方法是在<strong class="ka ir"> LayoutBlank </strong>块的<strong class="ka ir"> OnReady </strong>事件处理程序中要求它。</p><p id="fc48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio中，转到<strong class="ka ir">布局</strong> UI流程并选择<strong class="ka ir">布局空白</strong>块。</p><p id="b2c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">双击已经存在的<strong class="ka ir"> OnReady </strong>事件处理程序。</p><p id="dddb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> AddFavIcon </strong>动作下面添加一个新的<strong class="ka ir">运行客户端动作</strong>。选择<strong class="ka ir">要求脚本</strong>动作。使用配置Url属性</p><p id="51ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" rel="noopener ugc nofollow" target="_blank">https://appsforoffice.microsoft.com/lib/1/hosted/office.js</a></p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/837ac0067b342da8a005eda3dc97bd03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*vj8XlIr_21CS8bEo11nOew.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">要求脚本配置</figcaption></figure><blockquote class="ne nf ng"><p id="bf4c" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">如果您找不到RequireScript客户端操作，那么您必须向它添加一个依赖项。RequireScript是(系统)模块的一部分。</p></blockquote><p id="2b8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在RequireScript之后，添加一个包含以下脚本的Javascript元素</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="07fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你的流程应该是这样的</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/ed12c06055f257dd95c59c0df4ee7f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOVwCnKzfN2VbM7-q-w2LA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">LayoutBlank块的OnReady事件处理程序</figcaption></figure><p id="61d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发布您的应用程序。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="18d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤4——创建Office插件清单文件</strong></p><p id="d72b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">清单文件是对我们的Office外接程序的描述。XML清单文件使Office插件能够执行以下操作(摘自<a class="ae kw" href="https://docs.microsoft.com/en-us/office/dev/add-ins/develop/add-in-manifests?tabs=tabid-1" rel="noopener ugc nofollow" target="_blank">这里的</a>)</p><ul class=""><li id="cd62" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">通过提供ID、版本、描述、显示名称和默认区域设置来描述自身。</li><li id="989a" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">在Office应用程序功能区中指定用于标记加载项的图像和用于加载项命令的图标。</li><li id="1bf3" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">指定外接程序如何与Office集成，包括任何自定义用户界面，如外接程序创建的功能区按钮。</li><li id="5f6a" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">为内容外接程序指定要求的默认尺寸，为Outlook外接程序指定要求的高度。</li><li id="4f21" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">声明Office外接程序所需的权限，如读取或写入文档。</li><li id="30a1" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">对于Outlook外接程序，定义一个或多个规则，这些规则指定它们将被激活并与邮件、约会或会议请求项目交互的上下文。</li></ul><p id="c9e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">清单很大，有很多选择。我们不会在本教程中详细介绍，但是你可以在这里进一步阅读关于可能性的内容。</p><p id="5f82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我们清单文件的起始模板。将内容复制到您的本地文本编辑器中。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="35a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您必须更改的所有内容都包含方括号[]中的属性。这些是</p><ul class=""><li id="e796" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir">应用Id </strong> —创建一个新的UUID并将其放在这里</li><li id="2608" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">提供商名称</strong> —指定您的公司名称作为提供商</li><li id="05e2" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">默认区域设置</strong> —更改为您的区域设置。</li><li id="a22b" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">显示名称和说明</strong> —这是Office外接程序在外接程序目录中的显示方式。</li><li id="f534" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">图标Url </strong>和<strong class="ka ir">高分辨率图标Url </strong> —将值设置为DeepL32.png和DeepL80.png的完整路径。该路径由您的环境url加上运行时路径组成，当您在Service Studio中单击相应的图像时会看到该路径</li></ul><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b555daf63a48f93effcc678a82b4e553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*ARXW038dLA45ZDvnsAYhsw.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">图像的运行时路径</figcaption></figure><ul class=""><li id="7643" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">AppDomain  —设置为您的环境url。</li><li id="6b32" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir"> FormSettings </strong> —将<strong class="ka ir"> SourceLocation </strong>属性设置为任务窗格屏幕的完整路径。完整路径由您的环境url加上您的web模块名(OfficeAddIn)和屏幕名组成。</li><li id="485f" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">资源</strong> —将<strong class="ka ir">图标</strong>值设置为图标图像的完整路径，并将<strong class="ka ir"> Url </strong>值设置为任务窗格屏幕。</li></ul></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="ae1d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤5 —侧面加载Office插件</strong></p><p id="8d7c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过侧加载，您可以测试Office加载项，而无需将其添加到租户的加载项目录中。</p><ul class=""><li id="2103" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">打开您的Microsoft Outlook桌面应用程序</li><li id="a46b" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">在功能区中点击<strong class="ka ir">获取插件</strong>按钮</li><li id="81a9" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">选择<strong class="ka ir">我的附加模块</strong>并找到自定义附加模块部分</li><li id="7428" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">点击<strong class="ka ir">添加一个自定义插件</strong>并从文件中选择<strong class="ka ir"/></li><li id="b3be" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">上传您之前修改的清单</li></ul><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/5577305bc009b6b3fb4360cfb5bd89bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yiat-ComBnhoytrgcG-kTA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">侧面加载自定义加载项</figcaption></figure><p id="01ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Office会检查您的清单文件是否有效。如有必要，请更正错误并重新上传。</p><p id="4ebc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果有效，您应该会在自定义加载项部分看到一个新条目。显示名称和描述，当然还有清单中的图标。</p><p id="8196" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在进入你的收件箱，选择一封邮件。现在，您应该会在外接程序的功能区中看到一个用于打开任务窗格的附加按钮。如果一切正常，你应该在任务窗格中看到<strong class="ka ir"> Hello World </strong>。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="7e0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤6 —添加DeepL连接器</strong></p><p id="4850" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们将所需的DeepL连接器依赖项添加到我们的应用程序中。从<strong class="ka ir">你需要的DeepL_Connect_IS </strong>模块</p><ul class=""><li id="3e3e" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir"> DeepL_TextTranslate </strong>服务器动作</li><li id="a006" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">所有的<strong class="ka ir">静态实体</strong>(它们是帮助你选择服务器动作的正确配置选项的枚举)</li></ul><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/2486030e9babb06dce1dd14bfc0c8378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u0T7XX-u1JGZd90HZjf2vw.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">DeepL连接器依赖关系</figcaption></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="6271" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第7步—添加翻译</strong></p><p id="96db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候给我们的插件添加翻译了。在用户启动我们的插件后，我们会询问目标语言。我们将用户的语言选择存储在一个客户端变量中。<strong class="ka ir"> DeepL_Connect_IS </strong>模块已经包含一个具有所有目标语言的<strong class="ka ir">静态实体</strong>(<strong class="ka ir">target language</strong>)，我们将在客户端变量中存储该静态实体的标识符。</p><p id="9197" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio的<strong class="ka ir">数据</strong>选项卡中添加一个新的<strong class="ka ir">客户端变量</strong>并命名为<strong class="ka ir"> TargetLanguageId </strong>。检查数据类型是否设置为<strong class="ka ir">目标语言标识符</strong>。</p><p id="ab64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio中的<strong class="ka ir">界面</strong>选项卡上，打开<strong class="ka ir">任务窗格</strong>屏幕。添加一个数据类型为Text的局部变量。</p><ul class=""><li id="399a" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir"> MailOriginalBody </strong> —它将保存我们检索到的邮件的当前内容。</li></ul><p id="ab25" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向屏幕添加一个新的客户端动作，并将其命名为<strong class="ka ir"> TranslateMailOnClick </strong>。我们暂时让它空着。</p><p id="a8ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向您的屏幕添加一个新的集合(<strong class="ka ir">从数据库</strong>获取数据)。将<strong class="ka ir"> TargetLanguage </strong>静态实体从<strong class="ka ir"> DeepL_Connect_IS </strong>模块中拖到聚合中。将聚合命名为<strong class="ka ir"> GetLanguages </strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a3d075e6df23333068ca8b060627786c.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*hgUFulv3fS8MCPcRGHTNzw.png"/></div></figure><p id="8108" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">转到<strong class="ka ir">任务窗格</strong>屏幕的小部件树。</p><p id="8029" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">内容</strong>占位符中添加一个<strong class="ka ir">容器</strong>小部件，并添加以下<strong class="ka ir">样式类</strong>。</p><ul class=""><li id="d702" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir"> display-flex </strong></li><li id="fa45" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">伸缩方向栏</strong></li><li id="5e89" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">衬垫底座</strong></li></ul><p id="7f02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在该容器内创建另一个<strong class="ka ir">三个</strong>容器。在第二个容器中添加一个<strong class="ka ir">y底座</strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/85604b568d236e6923957cee226d2c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*AuTSfXuI7eHQLlAfi4yZaw.png"/></div></figure><p id="52a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">右击</strong>第一个容器，添加一个<strong class="ka ir">下拉小工具</strong>。(注意，我们将变量设置为我们之前创建的客户端变量。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/e37d4c76e7feb0215eac930ced2f7053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmnDluHfwUOihMRiicqmNg.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">语言下拉列表</figcaption></figure><p id="a4c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">右击</strong>第二个容器<strong class="ka ir">并添加一个<strong class="ka ir">按钮</strong>(例如带有文本“翻译邮件”)。(注意<strong class="ka ir">启用的</strong>条件和额外的<strong class="ka ir">样式类</strong> <strong class="ka ir">全角</strong>和我们之前创建的<strong class="ka ir">点击</strong>处理程序)</strong></p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/42d05952fad32801f0c6f07ede234343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*5fKq7Iuj2SFQRNiRtNasPA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">翻译按钮</figcaption></figure><p id="f70d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加一个<strong class="ka ir">从其他来源获取数据</strong>到您的屏幕。将输出变量(如结果)数据类型设置为Text _ Translate _ Result(DeepL _ Connect _ IS模块)的<strong class="ka ir">列表。</strong></p><p id="6843" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将您的数据操作命名为<strong class="ka ir"> GetTranslation </strong>，并将操作的<strong class="ka ir"> Fetch </strong>属性设置为<strong class="ka ir"> Only on demand </strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/0e2d905a1d22cad9df970be48a3ee0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*u-eQMRSfQF9rfxXw5OUdcQ.png"/></div></figure><p id="ef99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir"> DeepL_TranslateText </strong>服务器动作从<strong class="ka ir"> DeepL_Connect_IS </strong>模块拖到数据动作流中，并将其属性设置为</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/8db8d08d49e300cf73375f8c7db827cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*AgOG84G0yivGf8ZPhFuRQQ.png"/></div></figure><blockquote class="ne nf ng"><p id="b7ca" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">DeepL需要一个<strong class="ka ir">认证密钥</strong>，你可以从你的DeepL账户页面获得。您可以像上面的例子一样将密钥放在<strong class="ka ir">站点属性</strong>中(推荐),或者在字段中硬编码。</p></blockquote><p id="61e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将操作的结果赋给数据操作的输出参数。你的流程应该是这样的。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/65d36fb16b4cc8e587b1756139634c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oP09F6PhUDYFXXIrXeFeBg.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">获取翻译数据操作流程</figcaption></figure><p id="e81a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">任务窗格</strong>屏幕中打开<strong class="ka ir">translate mailon点击</strong>客户端动作。</p><p id="8185" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向流中添加一个<strong class="ka ir"> Javascript </strong>元素。</p><p id="9275" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为<strong class="ka ir">数据类型文本</strong>的<strong class="ka ir"> Javascript </strong>元素创建一个新的输出属性，并将其命名为<strong class="ka ir">主体</strong>。</p><p id="e81b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将以下脚本复制到<strong class="ka ir"> Javascript </strong>元素。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="f339" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该脚本执行以下操作</p><ul class=""><li id="f5b4" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">它在Office Javascript框架完全初始化时执行(<strong class="ka ir"> Office.onReady </strong>)</li><li id="3c7e" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">以文本形式获取当前邮件项目的正文。我们稍后将处理html。</li><li id="da2c" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir"> $resolve() </strong>是特定于等待直到承诺被履行的系统。</li></ul><p id="44c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回到流程<strong class="ka ir">中，将Javascript的输出<strong class="ka ir">主体</strong>分配给本地<strong class="ka ir">mailroriginalbody</strong>变量。</strong></p><p id="964c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir"> GetTranslation数据动作</strong>拖到赋值下面，刷新数据源。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/7e891d4fd23e980a8ea9f674bc441abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUhSvbO509EiZx0xfmOwmg.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">TranslateMailOnClick客户端操作</figcaption></figure><p id="bb94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回到你的任务窗格屏幕的窗口小部件树，添加一个<strong class="ka ir">列表</strong>窗口小部件到最后一个容器，并设置它的数据源为<strong class="ka ir"> GetTranslation。结果</strong></p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/05e8a3d28162554dd88449c3fa07ce51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*4uOBoj_3vzqrvMY5_iwDDg.png"/></div></figure><p id="d239" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在列表中创建另一个容器，在该容器中添加一个<strong class="ka ir">表达式</strong>，并将其值设置为<strong class="ka ir"> GetTranslation。结果.当前.文本</strong></p><blockquote class="ne nf ng"><p id="e12c" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">DeepL总是返回一个翻译数组。对于我们当前的方法，在包含整个翻译的数组中只有一项。</p></blockquote><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/2b7d326876399e5d0260e7b43b0b3366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*a7ipyw8gDnt6AfexM9HOaw.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">完整的任务窗格布局和小部件</figcaption></figure><p id="67ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是时候试试了。在Microsoft Outlook中，从收件箱中选择一个邮件项目。在功能区中，单击加载项的“翻译”按钮。</p><p id="3c9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择目标语言并点击翻译按钮。DeepL返回结果后，您应该会在按钮下方看到翻译后的文本。</p><blockquote class="ne nf ng"><p id="58dc" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">当你试图翻译一封包含表格和图片的邮件时。你会注意到这导致了一个难以阅读的翻译。在我们的Javascript中，我们接收文本格式的主体，它去掉了所有的html内容。也有可能获得HTML中的主体，甚至DeepL支持在不破坏其结构的情况下翻译HTML文档。</p></blockquote></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="4616" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤8 —翻译HTML而不是文本邮件正文(可选步骤)</strong></p><p id="54e2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这一步中，我们在<strong class="ka ir"> TranslateMailOnClick </strong>客户端操作和<strong class="ka ir"> GetTranslation </strong>数据操作中对Javascript做了一些小的修改。</p><p id="196d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">translate mailonclick Javascript</strong>元素中，将<strong class="ka ir">office . context . mailbox . item . body . get async</strong>的第一个参数改为“<strong class="ka ir"> html </strong>”。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="f160" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在GetTranslation data动作中，修改<strong class="ka ir"> DeepL_TranslateText </strong>配置，并将<strong class="ka ir"> TagHandlingId </strong>属性设置为<strong class="ka ir">Entities.TagHandling.Html</strong>。这告诉DeepL让HTML保持原样，只翻译文本。</p><p id="3dc6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您尝试这样做，您会注意到结果包含HTML输出。OutSystems表达式不呈现html，而只是把它当作文本。</p><p id="6dc4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在主UI流程中创建一个新的<strong class="ka ir">块</strong>，并将其命名为<strong class="ka ir"> RenderHtml </strong>。</p><p id="500c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加数据类型文本的输入属性<strong class="ka ir"> Html </strong>。</p><p id="8586" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将单个<strong class="ka ir">容器</strong>添加到块中，并将其名称设置为<strong class="ka ir"> RenderContent </strong>。</p><p id="26ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向该块添加一个<strong class="ka ir"> OnReady </strong>事件处理程序。</p><p id="4f00" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> OnReady </strong>事件处理程序中，使用以下输入参数添加一个新的<strong class="ka ir"> Javascript </strong>元素。</p><ul class=""><li id="b0fa" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir">数据类型<strong class="ka ir">文本</strong>的WidgetId </strong></li><li id="1d2a" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir"> Html </strong>的数据类型<strong class="ka ir">文本</strong></li></ul><p id="904d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">编写以下脚本</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="e985" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">设置Javascript元素的输入属性</p><ul class=""><li id="e7ee" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">用于呈现内容的WidgetId。身份</li><li id="cd9f" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir"> Html </strong>到Html块的输入属性</li></ul><p id="2aec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在任务窗格屏幕小组件树中，删除列表中的表达式。</p><p id="8e74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加新块，并将其<strong class="ka ir"> Html </strong>属性设置为<strong class="ka ir"> GetTranslation。结果.当前.文本</strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/edbec3fca59e8a5d15535d0368ad68eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*jSC5h1XQ0DDNHFfP2yJfCw.png"/></div></figure><p id="3ba8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发布并尝试。邮件正文的内容现在应该呈现在Html中。您会注意到，由于一些图像没有显示，因此会有一些损失。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="9e0b" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">证明</h1><p id="e9c6" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">直到现在，我们的插件仍然不需要登录外部系统就可以运行。OutSystems的默认设置是从屏幕上删除匿名角色。如果用户点击屏幕，则会引发安全异常，并由<strong class="ka ir">通用</strong>流程中的默认<strong class="ka ir">异常处理程序处理。这里，用户被重定向到<strong class="ka ir">登录屏幕</strong>。我们不能使用默认重定向，更不能使用JavaScript(window . location . href)重定向——这会抛出一个<strong class="ka ir"> No Permission </strong>错误。</strong></p><p id="5a26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们将<strong class="ka ir">匿名</strong>角色留在我们的<strong class="ka ir">任务窗格</strong>屏幕上，并执行用户登录检查，然后登录我们屏幕上的<strong class="ka ir"> OnReady </strong>处理程序。</p><p id="b77c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Office Javascript框架提供了一个接口，指示Office主机代表我们的应用程序从Azure Active Directory中检索访问令牌并返回它，以便我们可以使用它来执行外部系统登录。</p><p id="b355" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这一部分包括以下步骤</p><ul class=""><li id="af55" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">在Azure Active Directory中注册我们的Office加载项应用程序</li><li id="0fb0" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">修改清单文件，并在Azure Active Directory中添加有关已注册应用程序的详细信息。</li><li id="564c" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">修改OutSystems登录。</li></ul></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="cb94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第9步——在Azure Active Directory中注册应用</strong></p><p id="715b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<a class="ae kw" href="https://portal.azure.com" rel="noopener ugc nofollow" target="_blank">https://portal.azure.com</a>进入你的Azure门户网站</p><blockquote class="ne nf ng"><p id="588a" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">以下内容摘自官方文件。</p></blockquote><p id="b3ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在顶部搜索栏中搜索应用程序注册，然后单击服务部分中的应用程序注册。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/f934e99f63768ae1ec4fcc5c6b909d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*av-2MS9jpfLK2sZ5t0ttbg.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">应用程序注册搜索</figcaption></figure><p id="4229" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在应用程序注册列表屏幕中，单击新注册。</p><ul class=""><li id="53bc" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">为您的应用程序提供一个有意义的名称</li><li id="2395" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">仅在该组织目录中选择<strong class="ka ir">账户</strong>。(我们只想允许来自我们自己组织的用户，而不是来自其他组织的用户)</li><li id="7961" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">让<strong class="ka ir">重定向URI </strong>为空</li><li id="20d9" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">点击<strong class="ka ir">注册</strong></li></ul><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/e7fd00319741eb954d988bdcb826183d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_s4XrKKhKV6nCMQ0ReydzA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">注册申请</figcaption></figure><p id="ad03" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">复制<strong class="ka ir">应用(客户端)ID </strong>和<strong class="ka ir">目录(租户)ID </strong>的值。我们以后会需要的。</p><p id="cb50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在左侧窗格的管理下，单击<strong class="ka ir">证书&amp;机密</strong>。检查是否选择了<strong class="ka ir">客户端机密</strong>选项卡，并点击<strong class="ka ir">新客户端机密</strong>。</p><p id="780a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">输入密码的描述和到期时间。然后点击<strong class="ka ir">添加</strong>。</p><p id="a8b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下面的屏幕中，立即<strong class="ka ir">复制客户端密码(值)</strong>非常重要。客户端密码在此屏幕上仅显示一次，以后无法检索。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/ea09776384666b202fb1d5f7d01dbfb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m2MLh_KVXke9jb-H7yh1jQ.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">秘密</figcaption></figure><p id="9cfd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在管理下，选择<strong class="ka ir">公开一个API </strong>，选择<strong class="ka ir">设置</strong>链接。这将打开一个<strong class="ka ir">设置应用ID URI </strong>框，其中以api:// &lt;应用id &gt;的形式生成了应用ID URI。在&lt; application-id &gt;之前插入您的外部系统环境的完全合格的域名。整个ID应该采用api:// &lt; OutSystems环境URL &gt; &gt; / &lt;应用程序id &gt;的形式；比如API://my personal . outsystemscloud . com/c 6 C1 f 32 b-5e 55–4997–881 a-753 C1 d 563 b 7。</p><p id="9a03" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择<strong class="ka ir">添加一个范围</strong>。在打开的面板中，输入<strong class="ka ir"> access_as_user </strong>作为作用域名称。</p><p id="0efe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">设定<strong class="ka ir">谁能同意</strong>？给<strong class="ka ir">管理员和用户。</strong></p><p id="225b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用适合于<strong class="ka ir"> access_as_user </strong>范围的值填写用于配置管理和用户同意提示的字段，这使得Office客户端应用程序能够使用您的外接程序的web APIs，并具有与当前用户相同的权限。建议:</p><ul class=""><li id="43dc" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">管理员同意显示名称:Office可以充当用户。</li><li id="f3b8" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">管理员同意说明:使Office能够以与当前用户相同的权限调用外接程序的web APIs。</li><li id="ea64" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">用户同意显示名称:Office可以充当您的角色。</li><li id="8e2d" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">用户同意说明:允许Office使用与您相同的权限调用外接程序的web APIs。</li></ul><p id="a58a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保<strong class="ka ir">状态</strong>设置为<strong class="ka ir">使能</strong>。然后<strong class="ka ir">添加范围</strong>。</p><p id="bba2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">授权的客户端应用程序</strong>部分，输入以下ID对所有Microsoft Office应用程序端点进行预授权。</p><blockquote class="ne nf ng"><p id="8e4c" class="jy jz nh ka b kb kc kd ke kf kg kh ki ni kk kl km nj ko kp kq nk ks kt ku kv ij bi translated">ea5a 67 f 6-b6f 3–4338-b240-c 655 DDC 3c c8 e</p></blockquote><p id="c4f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择<strong class="ka ir">添加客户端应用</strong>。在打开的面板中，将<strong class="ka ir">客户端ID </strong>设置为相应的GUID，并选中API://out systems environment URL/&lt;application-ID&gt;/access _ as _ user复选框。</p><p id="99da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后一步是配置权限。在左窗格中点击<strong class="ka ir"> API权限</strong>。您会注意到已经有一个权限集<strong class="ka ir">用户。读取委托类型的</strong>。这是用户登录所需的最低权限。</p><ul class=""><li id="4deb" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">点击<strong class="ka ir">添加一个权限</strong></li><li id="32cc" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">选择<strong class="ka ir">微软图形</strong>和<strong class="ka ir">委托权限</strong></li><li id="44f3" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">从权限列表中选择以下权限:<strong class="ka ir"> openid、配置文件、offline_access、文件。阅读.所有</strong></li><li id="fd51" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated">点击<strong class="ka ir">添加权限</strong></li></ul><p id="2ed7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您不希望您的用户给予同意，您也可以给予管理员同意。关于如何做到这一点，请看这里。</p><p id="ce9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一步需要来自<strong class="ka ir">概览</strong>页面的<strong class="ka ir">应用ID URI </strong>值。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="be49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤10 —修改Office外接程序清单</strong></p><p id="4a12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要修改我们的清单文件，以便Office主机知道如何与我们的应用程序注册交互。</p><p id="406d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第二个<strong class="ka ir">版本覆盖</strong>标签的末尾添加以下XML部分。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="2681" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir">应用ID </strong>和<strong class="ka ir">应用ID URI </strong>值更改为您的注册值。</p><p id="287e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从Office My Add-Ins中移除当前的外接程序，并上载新的清单。(参见步骤5)。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="586e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤11——向您的外部系统应用程序添加依赖关系</strong></p><p id="fd4d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为您的应用程序添加依赖项</p><ul class=""><li id="54b0" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated"><strong class="ka ir">office host _ AccessTokenGet</strong>客户端操作</li><li id="669d" class="mv mw iq ka b kb nl kf nm kj nn kn no kr np kv na nb nc nd bi translated"><strong class="ka ir">office host _ AccessTokenLogin</strong>服务器操作</li></ul><p id="07ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">来自<strong class="ka ir"> OfficeHost_SignOn_CS </strong>模块。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="be10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第12步—创建一个Office登录包装器</strong></p><p id="7fcc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio的“数据”选项卡中，创建一个数据类型为text的新站点属性ApplicationIDURI。在此处设置DefaultValue(不推荐),或者在服务中心将其发布并设置为Azure Active Directory应用注册中的应用ID Uri。(API://[环境Url]/[应用程序ID]。</p><p id="a95f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Service Studio的<strong class="ka ir">逻辑</strong>选项卡中创建一个新的服务器动作<strong class="ka ir"> DoOfficeLogin </strong>。</p><p id="717d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个新的数据类型为<strong class="ka ir"> text的输入属性<strong class="ka ir">标记</strong>。</strong></p><p id="07c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建数据类型为<strong class="ka ir">布尔</strong>的输出属性<strong class="ka ir"> IsSuccess </strong>。</p><p id="693c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建数据类型为<strong class="ka ir">文本</strong>的输出属性<strong class="ka ir">消息</strong>。</p><p id="c118" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir">office host _ AccessTokenLogin</strong>服务器动作从<strong class="ka ir"> OfficeHost_SignOn_CS </strong>模块拖到流程中。</p><p id="4849" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir">令牌</strong>属性设置为<strong class="ka ir">令牌</strong></p><p id="8060" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir">受众</strong>属性设置为您的站点属性<strong class="ka ir">站点。应用程序IDURI </strong></p><p id="8109" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">将<strong class="ka ir">office host _ AccessTokenLogin</strong>的</strong>issue access和<strong class="ka ir">消息</strong>分配给<strong class="ka ir">输出属性</strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/68eff5ecc0804005a08acbe0b053f8da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*Q2hxjstCNXpSCim74OEesg.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">DoOfficeLogin服务器操作</figcaption></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="ae67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第13步—在Ready事件处理程序上添加任务窗格</strong></p><p id="f043" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的<strong class="ka ir"> Taskpane </strong>屏幕中创建一个新的数据类型为<strong class="ka ir"> Boolean </strong>的本地变量<strong class="ka ir"> IsAuthenticated </strong>，并将其默认值<strong class="ka ir">设置为</strong>False。</p><p id="a746" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将<strong class="ka ir"> OnReady </strong>事件处理程序添加到您的任务窗格屏幕。</p><p id="325a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果以<strong class="ka ir">get userid()= null identifier()</strong>为条件，将<strong class="ka ir">添加到流中</strong></p><p id="0201" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> False </strong>分支上添加一个赋值并将IsAuthenticated变量设置为True。</p><p id="6ffe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">真</strong>分支上添加来自<strong class="ka ir"> OfficeHost_SignOn_CS </strong>模块的<strong class="ka ir">office host _ AccessTokenGet</strong>客户端动作。</p><p id="a9e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就在它添加我们的<strong class="ka ir"> DoOfficeLogin </strong>服务器动作并将令牌输入设置为<strong class="ka ir">office host _ AccessTokenGet</strong>的<strong class="ka ir">Token o</strong>output之后。</p><p id="3c92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果带有<strong class="ka ir"> DoOfficeLogin的条件，则添加另一个<strong class="ka ir">。发布成功</strong></strong></p><p id="4400" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">真</strong>分支上添加另一个<strong class="ka ir"> Assign </strong>为<strong class="ka ir"> IsAuthenticated </strong>并将其设置为<strong class="ka ir">真</strong>。</p><p id="a477" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir">假</strong>分支上只加一个<strong class="ka ir">端</strong>。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/1f81aa928755d41e463b4c9ce91eb85f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dS1ZbnnYF_XcZ4yNqXVR5Q.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">在任务窗格屏幕上阅读</figcaption></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="1db6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第14步—修改用户界面</strong></p><p id="8594" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Taskpane小部件树中，如果并将其条件设置为<strong class="ka ir"> IsAuthenticated </strong>，则将整个内容包装在一个<strong class="ka ir">中。</strong></p><p id="8730" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> False </strong>分支中添加一个<strong class="ka ir">中心内容</strong>小部件，并在中心占位符中放置一些有意义的内容。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/e89b215a2ae606a5abe63ee149b0356a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*qkomcggMZSsLARCGldZt-A.png"/></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="c62a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就是这样。发布您的应用程序并试用它。当然，这只是一个开始，许多事情都可以优化(例如，当认证失败时给出反馈，或者在登录asf时显示一个漂亮的动画。).</p><p id="0bd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你喜欢它的工作，因为我在创建它的乐趣。</p><p id="4b4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您在启动和运行时遇到困难，请使用OutSystems论坛获得帮助。非常欢迎对如何改进这篇文章提出建议。通过我的<a class="ae kw" href="https://www.outsystems.com/profile/0qginuc0j5/overview" rel="noopener ugc nofollow" target="_blank"> OutSystems档案</a>给我发消息，或者直接在medium上回复。低编码快乐！</p></div></div>    
</body>
</html>
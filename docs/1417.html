<html>
<head>
<title>Create a MySQL Server with Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Docker创建一个MySQL服务器</h1>
<blockquote>原文：<a href="https://itnext.io/create-a-mysql-server-with-docker-55ea405f64b0?source=collection_archive---------2-----------------------#2018-10-10">https://itnext.io/create-a-mysql-server-with-docker-55ea405f64b0?source=collection_archive---------2-----------------------#2018-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ce6584a6b46ffbfe6a351d15de95e907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Yo7ixCaV3BGK-vrNKdPwAg.png"/></div></figure><p id="8225" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">恰好我想为我的Django Rest API创建一个MySQL服务器。所以Django Rest API位于我的主机上——我很快会把它移到一个容器中。MySQL将放在一个容器中。主机可以与容器内的数据库通信。</p><p id="f42d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以下是命令:</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="f38f" class="lb lc iq kx b gy ld le l lf lg">docker run -d -p 3306:3306 --name=mysql-server --env="MYSQL_ROOT_PASSWORD=123456" mysql</span><span id="b825" class="lb lc iq kx b gy lh le l lf lg"># This runs on a detached mode<br/># Open port 3306:3306<br/># Name of the server: mysql-server<br/># root password: 123456<br/># Container is created from mysql image</span></pre><p id="9cf3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">备注:</strong></p><ul class=""><li id="d60a" class="li lj iq jw b jx jy kb kc kf lk kj ll kn lm kr ln lo lp lq bi translated">请检查是否有其他应用程序监听您的主机上的端口3306。如果是，您可以将端口更改为不同的端口。</li></ul><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="2891" class="lb lc iq kx b gy ld le l lf lg">-p 12345:3306</span><span id="49a0" class="lb lc iq kx b gy lh le l lf lg"># This is one method to check for the port on MAC OS<br/>netstat -vanp tcp | grep 3306</span></pre><ul class=""><li id="c8ea" class="li lj iq jw b jx jy kb kc kf lk kj ll kn lm kr ln lo lp lq bi translated">如果您无法从另一个docker连接到MySQL，并得到以下错误:</li></ul><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="fd95" class="lb lc iq kx b gy ld le l lf lg">Unable to load authentication plugin 'caching_sha2_password'.</span></pre><p id="e9dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，您可以在运行容器时添加下面的参数。是因为新版MySQL使用了<strong class="jw ir"> caching_sha2_password </strong>而不是<strong class="jw ir"> mysql_native_password </strong>。</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="0124" class="lb lc iq kx b gy ld le l lf lg">mysqld --default-authentication-plugin=mysql_native_password</span></pre><ul class=""><li id="a30e" class="li lj iq jw b jx jy kb kc kf lk kj ll kn lm kr ln lo lp lq bi translated">你可以通过你的主机访问MySQL</li></ul><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="7c34" class="lb lc iq kx b gy ld le l lf lg"># Through host<br/>mysql -host 127.0.0.1 -P 3306 —protocol=tcp -u root -p</span><span id="1d0a" class="lb lc iq kx b gy lh le l lf lg"># Through container<br/>docker exec -ti mysql-server bash<br/>mysql -u root -p</span></pre><ul class=""><li id="8fdd" class="li lj iq jw b jx jy kb kc kf lk kj ll kn lm kr ln lo lp lq bi translated">为连接创建用户和数据库</li></ul><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="f263" class="lb lc iq kx b gy ld le l lf lg">CREATE DATABASE databaseName;</span><span id="15a8" class="lb lc iq kx b gy lh le l lf lg">CREATE USER 'dnguyen'@'localhost' IDENTIFIED BY '123456';</span><span id="2c68" class="lb lc iq kx b gy lh le l lf lg">GRANT ALL PRIVILEGES ON databaseName.* TO 'dnguyen'@'localhost';</span><span id="a65e" class="lb lc iq kx b gy lh le l lf lg">FLUSH PRIVILEGES;</span><span id="e0b9" class="lb lc iq kx b gy lh le l lf lg">QUIT</span></pre><ul class=""><li id="6a4e" class="li lj iq jw b jx jy kb kc kf lk kj ll kn lm kr ln lo lp lq bi translated">如果你使用Django，下面是你需要放入<strong class="jw ir"> settings.py </strong>的内容</li></ul><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="6c5f" class="lb lc iq kx b gy ld le l lf lg">DATABASES = {<br/>      'default': {<br/>        'ENGINE': 'django.db.backends.mysql',<br/>        'NAME': 'databaseName',<br/>        'USER': 'dnguyen', # or root<br/>        'PASSWORD': '123456',<br/>        'HOST': '127.0.0.1',<br/>        'PORT': '3306', # or 12345<br/>        'OPTIONS': {<br/>            # Tell MySQLdb to connect with 'utf8mb4' character set<br/>            'charset': 'utf8mb4',<br/>        },<br/>    }<br/>}</span></pre><p id="41a9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从现在起，你可以随时连接到你的MySQL。</p><p id="bc5c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">希望这有所帮助；)</p></div></div>    
</body>
</html>
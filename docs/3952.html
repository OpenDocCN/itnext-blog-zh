<html>
<head>
<title>Learn how to use Azure Functions to process data from Azure Event Hubs and persist to Azure Cosmos DB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解如何使用Azure函数处理来自Azure Event Hubs的数据，并持久化到Azure Cosmos DB</h1>
<blockquote>原文：<a href="https://itnext.io/learn-how-to-use-azure-functions-to-process-data-from-azure-event-hubs-and-persist-to-azure-cosmos-e61794776dd?source=collection_archive---------3-----------------------#2020-03-31">https://itnext.io/learn-how-to-use-azure-functions-to-process-data-from-azure-event-hubs-and-persist-to-azure-cosmos-e61794776dd?source=collection_archive---------3-----------------------#2020-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d645" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/azure-event-hubs-multi-protocol-support-d0e41834510b">之前的一篇博客</a>讲述了<a class="ae kl" href="https://docs.microsoft.com/azure/event-hubs/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Event Hubs </a>如何支持<a class="ae kl" href="https://docs.microsoft.com/azure/event-hubs/event-hubs-exchange-events-different-protocols?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">多协议</a>进行数据交换的一些概念。在这篇博客中，我们将通过一个例子来看看它的实际应用。借助示例应用程序，您将看到如何将实时数据接收组件与无服务器处理层结合起来。</p><p id="b631" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">示例应用程序具有以下组件:</p><ul class=""><li id="c917" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">Azure事件中心<a class="ae kl" href="https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">和Kafka端点</a></li><li id="a808" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">将数据推送到事件中心主题的生产者应用程序</li><li id="cc9f" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">一个使用<a class="ae kl" href="https://docs.microsoft.com/azure/azure-functions/?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Functions </a>构建的无服务器应用程序，它从事件中心消费、丰富并最终存储在<a class="ae kl" href="https://docs.microsoft.com/azure/cosmos-db/?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB </a>中</li></ul><p id="b93f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了跟进并将该解决方案部署到Azure，您将需要一个<a class="ae kl" href="https://docs.microsoft.com/azure/cosmos-db/create-cosmosdb-resources-portal?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Microsoft Azure </a>帐户。<a class="ae kl" href="https://azure.microsoft.com/free/?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">还没有的可以免费抢一个</a>！</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="a1b2" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated">应用程序组件</h2><p id="8e67" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们来看看应用程序的各个组件</p><blockquote class="mf mg mh"><p id="2423" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">一如既往的，</em> <a class="ae kl" href="https://github.com/abhirockzz/eventhubs-functions-cosmosdb-example" rel="noopener ugc nofollow" target="_blank"> <em class="iq">代码在GitHub </em> </a>上可用</p></blockquote><p id="d40c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">生产者成分</strong></p><p id="4df8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这非常简单——这是一个Go应用程序，它使用<a class="ae kl" href="https://github.com/Shopify/sarama" rel="noopener ugc nofollow" target="_blank"> Sarama Kafka客户端</a>向Azure Event Hubs (Kafka主题)发送(模拟)<code class="fe mm mn mo mp b">"orders"</code>。为便于使用，它以<a class="ae kl" href="https://hub.docker.com/r/abhirockzz/eventhubs-kafka-producer" rel="noopener ugc nofollow" target="_blank"> Docker图像</a>的形式提供(详情见下一节)</p><p id="58bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是相关的代码片段:</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="d2c2" class="lh li iq mp b gy my mz l na nb">order := Order{OrderID: "order-1234", CustomerID: "customer-1234", Product: "product-1234"}</span><span id="e4c1" class="lh li iq mp b gy nc mz l na nb">b, err := json.Marshal(order)</span><span id="b658" class="lh li iq mp b gy nc mz l na nb">msg := &amp;sarama.ProducerMessage{Topic: eventHubsTopic, Key: sarama.StringEncoder(oid), Value: sarama.ByteEncoder(b)}<br/>producer.SendMessage(msg)</span></pre><p id="c953" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(从上面的片段中)省略了很多细节——你可以在这里搜索<a class="ae kl" href="https://github.com/abhirockzz/eventhubs-functions-cosmosdb-example/blob/master/eventhubs-kafka-producer/producer.go" rel="noopener ugc nofollow" target="_blank">的完整代码</a>。总而言之，创建一个<code class="fe mm mn mo mp b">Order</code>，将其转换(编组)成JSON ( <code class="fe mm mn mo mp b">bytes</code>)并发送到事件中心Kafka endpoint。</p><p id="1354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">无服务器组件</strong></p><p id="668c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mm mn mo mp b">Serverless</code>部分是一个<a class="ae kl" href="https://docs.microsoft.com/azure/azure-functions/functions-reference-java?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Java Azure函数</a>。它利用了以下功能:</p><ul class=""><li id="3092" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><a class="ae kl" href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-event-hubs-trigger?tabs=java&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure事件中心触发</a>，以及</li><li id="ecf2" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><a class="ae kl" href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-cosmosdb-v2-output?tabs=java&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB输出绑定</a></li></ul><p id="fdd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mi">触发器</em>允许Azure函数逻辑在<code class="fe mm mn mo mp b">order</code>事件被发送到Azure事件中心时被调用。<em class="mi">输出绑定</em>负责所有繁重的工作，比如建立数据库连接、伸缩、并发等。剩下我们要构建的就是业务逻辑，在这种情况下，它非常简单——在从Azure Event Hubs接收到<code class="fe mm mn mo mp b">order</code>数据后，该函数用额外的信息(在这种情况下是客户和产品名称)丰富它，并将它保存在一个<a class="ae kl" href="https://docs.microsoft.com/azure/cosmos-db/databases-containers-items?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB容器</a>中。</p><p id="043d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在Github 上查看<code class="fe mm mn mo mp b"><a class="ae kl" href="https://github.com/abhirockzz/eventhubs-functions-cosmosdb-example/blob/master/consumer-azure-function/src/main/java/com/abhirockzz/OrderProcessor.java" rel="noopener ugc nofollow" target="_blank">OrderProcessor</a></code> <a class="ae kl" href="https://github.com/abhirockzz/eventhubs-functions-cosmosdb-example/blob/master/consumer-azure-function/src/main/java/com/abhirockzz/OrderProcessor.java" rel="noopener ugc nofollow" target="_blank">代码，不过这里是要点:</a></p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="e36e" class="lh li iq mp b gy my mz l na nb">@FunctionName("storeOrders")<br/>public void storeOrders(</span><span id="654d" class="lh li iq mp b gy nc mz l na nb">  @EventHubTrigger(name = "orders", eventHubName = "", connection = <br/>  "EventHubConnectionString", cardinality = Cardinality.ONE) <br/>  OrderEvent orderEvent,</span><span id="9758" class="lh li iq mp b gy nc mz l na nb">  @CosmosDBOutput(name = "databaseOutput", databaseName = "AppStore", <br/>  collectionName = "orders", connectionStringSetting = <br/>  "CosmosDBConnectionString") <br/>  OutputBinding&lt;Order&gt; output,</span><span id="2314" class="lh li iq mp b gy nc mz l na nb">  final ExecutionContext context) {<br/>....</span><span id="6ac0" class="lh li iq mp b gy nc mz l na nb">Order order = new Order(orderEvent.getOrderId(),Data.CUSTOMER_DATA.get(orderEvent.getCustomerId()), orderEvent.getCustomerId(),Data.PRODUCT_DATA.get(orderEvent.getProduct());<br/>output.setValue(order);</span><span id="15b5" class="lh li iq mp b gy nc mz l na nb">....<br/>}</span></pre><p id="453a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mm mn mo mp b">storeOrders</code>方法用<code class="fe mm mn mo mp b"><a class="ae kl" href="https://docs.microsoft.com/java/api/com.microsoft.azure.functions.annotation.functionname?view=azure-java-stable&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">@FunctionName</a></code>注释，它以<code class="fe mm mn mo mp b">OrderEvent</code>对象的形式从事件中心接收数据。多亏了<code class="fe mm mn mo mp b"><a class="ae kl" href="https://docs.microsoft.com/java/api/com.microsoft.azure.functions.annotation.eventhubtrigger?view=azure-java-stable&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">@EventHubTrigger</a></code>注释，平台负责将事件中心的有效负载转换成Java <code class="fe mm mn mo mp b">POJO</code>(类型为<code class="fe mm mn mo mp b">OrderEvent</code>)并正确路由它。<code class="fe mm mn mo mp b">connection = "EventHubConnectionString"</code>部分指定<a class="ae kl" href="https://docs.microsoft.com/azure/event-hubs/event-hubs-get-connection-string?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">事件集线器连接字符串</a>在名为<code class="fe mm mn mo mp b">EventHubConnectionString</code>的<a class="ae kl" href="https://docs.microsoft.com/azure/azure-functions/functions-how-to-use-azure-function-app-settings?WT.mc_id=devto-blog-abhishgu#settings" rel="noopener ugc nofollow" target="_blank">功能配置/设置</a>中可用</p><p id="6048" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mm mn mo mp b"><a class="ae kl" href="https://docs.microsoft.com/java/api/com.microsoft.azure.functions.annotation.cosmosdboutput?view=azure-java-stable&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">@CosmosDBOutput</a></code>注释用于持久化Azure Cosmos DB中的数据。它包含Cosmos DB数据库和容器名，以及将从函数中的<code class="fe mm mn mo mp b">CosmosDBConnectionString</code>配置参数中选取的连接字符串。POJO(在本例中是<code class="fe mm mn mo mp b">Order</code>)通过对<code class="fe mm mn mo mp b"><a class="ae kl" href="https://docs.microsoft.com/java/api/com.microsoft.azure.functions.outputbinding?view=azure-java-stable&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">OutputBinding</a></code>对象的一个<code class="fe mm mn mo mp b">setValue</code>方法调用被持久化到Cosmos DB——这个平台让这变得非常简单，但是在幕后还有很多事情要做！</p><p id="bbb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们换个话题，学习如何将解决方案部署到Azure</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="ce9e" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated">先决条件</h2><p id="50c1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><em class="mi">注</em></p><ul class=""><li id="a943" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><em class="mi">理想情况下，所有组件(事件中心、Cosmos DB、存储和Azure功能)应该在同一个区域</em></li><li id="2927" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><em class="mi">建议</em> <a class="ae kl" href="https://docs.microsoft.com/cli/azure/group?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-group-create" rel="noopener ugc nofollow" target="_blank"> <em class="mi">创建一个新的资源组</em> </a> <em class="mi">对这些服务进行分组，以便于定位和删除</em></li></ul><p id="c89e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是先决条件:</p><ul class=""><li id="9873" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><a class="ae kl" href="https://docs.microsoft.com/azure/cosmos-db/create-cosmosdb-resources-portal?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">微软Azure </a>账号(如开头所述)</li><li id="c362" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><a class="ae kl" href="https://docs.microsoft.com/azure/event-hubs/event-hubs-quickstart-kafka-enabled-event-hubs?WT.mc_id=devto-blog-abhishgu#create-a-kafka-enabled-event-hubs-namespace" rel="noopener ugc nofollow" target="_blank">创建一个支持Kafka的事件中心命名空间</a></li><li id="0f99" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><a class="ae kl" href="https://docs.microsoft.com/azure/cosmos-db/create-cosmosdb-resources-portal?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">创建Azure Cosmos DB组件</a>:账户、数据库和容器(请确保Cosmos DB数据库的名称是<code class="fe mm mn mo mp b">AppStore</code>并且容器被命名为<code class="fe mm mn mo mp b">orders</code>，因为这是Azure函数逻辑使用的)</li><li id="96a4" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">创建一个Azure存储帐户 —这将由Azure函数使用</li></ul></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="806e" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated">部署订单处理器功能</h2><p id="8079" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">这个例子使用了<a class="ae kl" href="https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions" rel="noopener ugc nofollow" target="_blank"> Azure Functions Maven插件</a>进行部署。首先，更新<code class="fe mm mn mo mp b">pom.xml</code>来添加所需的配置。</p><p id="d10f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更换<code class="fe mm mn mo mp b">&lt;appSettings&gt;</code>部分，更换<code class="fe mm mn mo mp b">AzureWebJobsStorage</code>、<code class="fe mm mn mo mp b">EventHubConnectionString</code>和<code class="fe mm mn mo mp b">CosmosDBConnectionString</code>参数值</p><blockquote class="mf mg mh"><p id="02ee" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">使用Azure CLI </em> </a> <em class="iq">轻松获取所需的详细信息</em></p></blockquote><ul class=""><li id="3b52" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">对于<code class="fe mm mn mo mp b">AzureWebJobsStorage</code>:获取<a class="ae kl" href="https://docs.microsoft.com/cli/azure/storage/account?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-storage-account-show-connection-string" rel="noopener ugc nofollow" target="_blank"> Azure存储连接字符串</a></li><li id="f325" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">对于<code class="fe mm mn mo mp b">EventHubConnectionString</code>:获取<a class="ae kl" href="https://docs.microsoft.com/cli/azure/eventhubs/eventhub/authorization-rule/keys?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-eventhubs-eventhub-authorization-rule-keys-list" rel="noopener ugc nofollow" target="_blank">事件中枢连接字符串</a></li><li id="e9ab" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">对于<code class="fe mm mn mo mp b">CosmosDBConnectionString</code>:获取<a class="ae kl" href="https://docs.microsoft.com/cli/azure/cosmosdb/keys?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-cosmosdb-keys-list" rel="noopener ugc nofollow" target="_blank"> Cosmos DB连接字符串</a></li></ul><p id="b6ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mm mn mo mp b">configuration</code>部分，更新以下内容:</p><ul class=""><li id="bce2" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><code class="fe mm mn mo mp b">resourceGroup</code>:要部署功能的资源组</li><li id="70a4" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><code class="fe mm mn mo mp b">region</code>:您要部署功能的Azure区域(<a class="ae kl" href="https://docs.microsoft.com/cli/azure/account?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-account-list-locations" rel="noopener ugc nofollow" target="_blank">获取位置列表</a>)</li></ul><p id="0034" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要进行部署，您需要两个命令:</p><ul class=""><li id="9efd" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><code class="fe mm mn mo mp b">mvn clean package</code> -准备部署神器</li><li id="8b72" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><code class="fe mm mn mo mp b">mvn azure-functions:deploy</code> -部署到Azure</li></ul><blockquote class="mf mg mh"><p id="8ce8" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">您可以使用Azure CLI </em> <code class="fe mm mn mo mp b"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/functionapp?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-functionapp-list" rel="noopener ugc nofollow" target="_blank"><em class="iq">az functionapp list --query "[?name=='orders-processor']"</em></a></code> <em class="iq">或门户</em>进行确认</p></blockquote></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="c735" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated">运行事件中心生成器</h2><p id="5102" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">设置环境变量:</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="0279" class="lh li iq mp b gy my mz l na nb">export EVENTHUBS_BROKER=&lt;namespace&gt;.servicebus.windows.net:9093<br/>export EVENTHUBS_TOPIC=&lt;event-hub-name&gt;<br/>export EVENTHUBS_CONNECTION_STRING="Endpoint=sb://&lt;namespace&gt;.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=&lt;primary_key&gt;"</span></pre><p id="d626" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行Docker映像</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="9e3f" class="lh li iq mp b gy my mz l na nb">docker run -e EVENTHUBS_BROKER=$EVENTHUBS_BROKER -e EVENTHUBS_TOPIC=$EVENTHUBS_TOPIC -e EVENTHUBS_CONNECTION_STRING=$EVENTHUBS_CONNECTION_STRING abhirockzz/eventhubs-kafka-producer</span></pre><blockquote class="mf mg mh"><p id="78bf" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">按</em> <code class="fe mm mn mo mp b"><em class="iq">ctrl+c</em></code> <em class="iq">停止生产事件</em></p></blockquote></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="bbc9" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated">在Azure Cosmos DB中确认结果</h2><p id="7a4b" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">您可以使用<a class="ae kl" href="https://docs.microsoft.com/azure/cosmos-db/data-explorer?WT.mc_id=devto-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB数据浏览器</a> (web界面)来检查容器中的项目。您应该会看到类似如下的结果:</p><figure class="mq mr ms mt gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nd"><img src="../Images/00c63ef6e10768b28ccb6ff6b8240855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*crTvCh6x2d9_sbjo.png"/></div></div></figure></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="91bf" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated">打扫</h2><p id="37dc" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">假设您将所有服务放在同一个资源组中，您可以使用一个<a class="ae kl" href="https://docs.microsoft.com/cli/azure/group?view=azure-cli-latest&amp;WT.mc_id=devto-blog-abhishgu#az-group-delete" rel="noopener ugc nofollow" target="_blank">命令</a>删除它们:</p><pre class="mq mr ms mt gt mu mp mv mw aw mx bi"><span id="35b4" class="lh li iq mp b gy my mz l na nb">export RESOURCE_GROUP_NAME=&lt;enter the name&gt;<br/>az group delete --name $RESOURCE_GROUP_NAME --no-wait</span></pre><p id="5f62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读🙂很高兴通过Twitter获得您的反馈，或者发表评论🙏🏻敬请关注更多内容！</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to Boost Vue.js Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何提升Vue.js性能</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-boost-vue-js-performance-c7df027ff3f5?source=collection_archive---------0-----------------------#2019-11-26">https://itnext.io/how-to-boost-vue-js-performance-c7df027ff3f5?source=collection_archive---------0-----------------------#2019-11-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/aad608052ffc633ea3b49e1f560a5ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VMiFBi9kOp8tXIV_LmrC3g.gif"/></div></div></figure><p id="5f2c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">避免巨大的网络负载</strong></p><blockquote class="kz la lb"><p id="a4d9" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">减少网络请求的总大小可以加快页面加载速度，并节省用户在蜂窝数据上的开支。—谷歌</p></blockquote><p id="a78d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们第一次在Vue中启动SPA项目时，通常我们会用<a class="ae lg" href="https://cli.vuejs.org/" rel="noopener ugc nofollow" target="_blank"> CLI 3.0 </a> +快速准备项目框架和开发环境，并开始创建页面和组件。</p><p id="6546" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我们继续以这种加速度发展。我们的页面增加，我们放在这些页面上的组件成倍增加。但是在背景中，还有一件事我们忘记了，那就是尺寸的增加。这是我们的捆绑文件。</p><p id="fc73" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你有没有想过你的用户甚至不会访问那个页面的可能性？或者是在某种条件下无法满足你所渲染的组件需求的可能性。你创造的大多数模型可能永远不会被看到。</p><p id="8e09" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将所有这些冗余代码发送给我们的用户。然而，用户只想查看单个页面。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h1 id="60d0" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">好的..我们能做什么？</h1><h2 id="85f5" class="mm lp it bd lq mn mo dn lu mp mq dp ly km mr ms mc kq mt mu mg ku mv mw mk mx bi translated">首先..代码分割和延迟加载</h2><p id="f3a8" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">通过应用基于路由和基于组件的代码分割和延迟加载，我们可以将包文件分割成小块。</p><p id="f1ef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了用<a class="ae lg" href="https://router.vuejs.org/guide/advanced/lazy-loading.html" rel="noopener ugc nofollow" target="_blank"> vue-router </a>实现这一点，我们可以用这种特殊的语法导入页面，而不是直接导入。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="8218" class="mm lp it ni b gy nm nn l no np">const router = new VueRouter({<br/>  routes: [<br/>    { <br/>      path: '/foo', <br/>      component: () =&gt; <br/>        import(/* webpackChunkName: "foo" */ '@/views/foo'), <br/>    }<br/>  ]<br/>})</span></pre><p id="5c96" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nq nr ns ni b"><strong class="kd iu">webpackChunkName</strong></code> <strong class="kd iu"> </strong>是一个特殊的关键字。有时，我们希望将几个页面或组件合并到同一个块中。webpack将识别这个关键字，并在同一个块下组合具有相同名称的页面和组件。</p><p id="3d05" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在组件中，我们有条件地呈现:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a5fb" class="mm lp it ni b gy nm nn l no np">&lt;template&gt;<br/>  &lt;div&gt; <br/>    &lt;admin-panel v-if="userRole === 'admin'" /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="48d5" class="mm lp it ni b gy nt nn l no np">&lt;script&gt;<br/> const adminPanel = () =&gt; import('AdminPanel.vue')</span><span id="3cce" class="mm lp it ni b gy nt nn l no np"> export default {<br/>   components: { adminPanel }<br/> }<br/>&lt;/script&gt;</span></pre><p id="54fd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以这样使用它。一旦满足条件，就会包含此组件。在那之前它不会被包括在内。因此，只有当条件满足时，用户才会下载该组件的代码。</p><p id="6eeb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我举过一个例子，特别是如上。因为我想提的是，你可以开发一个<code class="fe nq nr ns ni b"><strong class="kd iu">multi-role</strong></code>应用。如果您正在开发一个具有多个角色的应用程序，那么拆分代码的重要性就变得更加重要。</p><p id="efb1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设您有一个三层系统，客户端、管理员和来宾。</p><p id="b2f2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们没有拆分代码，用户就会下载属于所有角色的代码，而不管他的角色是什么。除了生成包含过多不必要代码的大文件的问题之外，这也是一个安全漏洞。</p><h2 id="e6e5" class="mm lp it bd lq mn mo dn lu mp mq dp ly km mr ms mc kq mt mu mg ku mv mw mk mx bi translated">樱桃采摘</h2><p id="268e" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">如果你使用的组件库使用像<code class="fe nq nr ns ni b"><a class="ae lg" href="https://bootstrap-vue.js.org/" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">bootstrap-vue</strong></a></code>这样的es模块，你可以挑选它的组件，而不是全局注册它们。</p><p id="569b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不要这样做:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="176e" class="mm lp it ni b gy nm nn l no np">import Vue from 'vue';<br/>import BootstrapVue from 'bootstrap-vue';<br/><br/>Vue.use(BootstrapVue);</span></pre><p id="b93f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以这样使用它:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="07f7" class="mm lp it ni b gy nm nn l no np">import {<br/> Modal,<br/> Table,<br/> Pagination,<br/> Button,<br/> Layout,<br/>} from 'bootstrap-vue/es/components';</span><span id="9d5a" class="mm lp it ni b gy nt nn l no np">import bTooltipD from 'bootstrapvue/es/directives/tooltip/tooltip';</span><span id="3f6f" class="mm lp it ni b gy nt nn l no np">[Modal, Table, Pagination, Button, Layout].forEach(<em class="lc">comp</em> =&gt; {<br/>  Vue.use(comp);<br/>});</span><span id="c132" class="mm lp it ni b gy nt nn l no np">Vue.directive('b-tooltip', bTooltipD);</span></pre><p id="9648" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">或者用<code class="fe nq nr ns ni b"><a class="ae lg" href="https://www.npmjs.com/package/lodash-es" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">lodash-es</strong></a></code>代替<code class="fe nq nr ns ni b"><a class="ae lg" href="https://www.npmjs.com/package/lodash" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">lodash</strong></a></code>。</p><p id="f130" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以搜索您使用的其他库的支持。这也意味着许多不会被使用的代码不会被发送给用户。</p><p id="3f6e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">完成此操作后，我们的JavaScript和CSS代码将以类似于以下结构的方式分离:</p><figure class="nd ne nf ng gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/44672a4b1e1771861187640af5c35ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wwc0cLnk7TkCb98moK1sEQ.png"/></div></div><figcaption class="nv nw gj gh gi nx ny bd b be z dk translated">您可以使用<strong class="bd lq">vue-CLI-service build-report</strong>来获取该报告。</figcaption></figure><p id="e397" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">是的，我用lodash代替lodash-es。我还没碰过。因为我就是文章开头提到的那个家伙:)我在考虑马上换一个。</p><p id="d31b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你已经注意到了，我们的“块供应商”文件也很大。如果你想对此做些什么，你可以在我们的<code class="fe nq nr ns ni b"><strong class="kd iu">vue.config.js</strong></code>文件中根据<a class="ae lg" href="https://hackernoon.com/the-100-correct-way-to-split-your-chunks-with-webpack-f8a9df5b7758" rel="noopener ugc nofollow" target="_blank">David Gilbertson<a class="ae lg" href="https://hackernoon.com/@david.gilbertson" rel="noopener ugc nofollow" target="_blank">的</a>这篇文章</a>进行设置。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="aee7" class="mm lp it ni b gy nm nn l no np">module.exports = {<br/>...<br/>  configureWebpack: {<br/>    optimization: {<br/>      runtimeChunk: 'single',<br/>      splitChunks: {<br/>        chunks: 'all',<br/>        maxInitialRequests: Infinity,<br/>        minSize: 0,<br/>        cacheGroups: {<br/>          vendor: {<br/>            test: /[\\/]node_modules[\\/]/,<br/>            name(module) {<br/>              const packageName = module.context.match(/[\\/]node_modules[\\/](.*?)([\\/]|$)/)[1];<br/>              return `npm.${packageName.replace('@', '')}`;<br/>            },<br/>          },<br/>        },<br/>      },<br/>    },<br/>  },<br/>...<br/>};</span></pre><p id="5e29" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将为我们的<a class="ae lg" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>包创建单独的块:</p><figure class="nd ne nf ng gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/f1d6b69dea7ec3c344436c86920fb3b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LjgcLS66Y2_yMHH0bt7ZIA.png"/></div></div></figure><p id="4c76" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，考虑一下Webpack团队的Sean T. Larkin的解释是很有用的。</p><div class="oa ob gp gr oc od"><a href="https://medium.com/@TheLarkInn/hey-david-b6649337d331" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">嘿大卫，</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">这是一篇很好的文章，但是作为webpack的维护者之一，我想对这一批评做出权威性的评价…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div></div></a></div><div class="nd ne nf ng gt ab cb"><figure class="om ju on oo op oq or paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/426885cd9b9a89b6121505c1c21bcc8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*X0uqENCfY0jg_UI1-QS6-A.png"/></div></figure><figure class="om ju os oo op oq or paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/4ccc964561a551fabc26a17d94752f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*9Od7dalHpDTQZ4eV09OOdA.png"/></div></figure></div><div class="ab cb"><figure class="om ju ot oo op oq or paragraph-image"><img src="../Images/f42f81b3342cee2ad8c404290c412c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*-dZBNI0D90V2TkVFePCUKg.png"/></figure><figure class="om ju ou oo op oq or paragraph-image"><img src="../Images/1b07b26c3d7526cda1dbb9940e12181a.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*UYeSPivWV7w_GIkWHzToLw.png"/><figcaption class="nv nw gj gh gi nx ny bd b be z dk ov di ow ox translated">未分割(左)和分割(右)“大块供应商”的表现。</figcaption></figure></div><p id="fa53" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如您可以从跟踪中看到的，您可能并不真正需要分割您的“块供应商”文件。</p><h2 id="6615" class="mm lp it bd lq mn mo dn lu mp mq dp ly km mr ms mc kq mt mu mg ku mv mw mk mx bi translated">最后..捆</h2><figure class="nd ne nf ng gt ju"><div class="bz fp l di"><div class="oy oz l"/></div></figure><p id="ba77" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们在传统浏览器支持下编译我们的代码，我们为什么要将那些具有冗余传统支持功能的编译代码发送到支持原生ES2015的现代浏览器？</p><p id="7d18" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">幸运的是，有了Vue的'<a class="ae lg" href="https://cli.vuejs.org/guide/browser-compatibility.html#modern-mode" rel="noopener ugc nofollow" target="_blank">Mode</a>'选项，我们可以轻松解决这个问题，不需要任何特殊的开发。</p><p id="6bff" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">只需将“modern”标志<code class="fe nq nr ns ni b"><strong class="kd iu">vue-cli-service build --modern</strong></code>传递给构建脚本。仅此而已。结果呢？</p><blockquote class="kz la lb"><p id="ad05" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">对于Hello World应用程序来说，modern bundle已经小了16%。在生产中，现代包通常会显著加快解析和评估速度，提高应用程序的加载性能。</p></blockquote></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="48c6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我想写一篇文章，结合我在发展和关心绩效时所学到的东西。希望对你有帮助。感谢您的阅读。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="ade2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="lc">原载于【radity.com】<a class="ae lg" href="https://radity.com/en/digital-magazine/how-to-boost-vue-js-performance/" rel="noopener ugc nofollow" target="_blank"><em class="lc"/></a><em class="lc">。</em></em></p></div></div>    
</body>
</html>
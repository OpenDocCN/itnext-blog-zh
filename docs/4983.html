<html>
<head>
<title>Vue tricks: smart layouts for VueJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue技巧:VueJS的智能布局</h1>
<blockquote>原文：<a href="https://itnext.io/vue-tricks-smart-layouts-for-vuejs-5c61a472b69b?source=collection_archive---------0-----------------------#2020-11-09">https://itnext.io/vue-tricks-smart-layouts-for-vuejs-5c61a472b69b?source=collection_archive---------0-----------------------#2020-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/407d44a0b872b9dc79414ef5ba95574d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P3ODlZMsFN3uCmnTY3smaA.png"/></div></figure><p id="78f7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嗨，亲爱的朋友们！</p><p id="0f23" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">今天，我想和你谈谈你的VueJS应用程序的布局系统。我的朋友Philipp问我如何为他的面包店应用程序添加不同的布局。在谷歌搜索了几个小时后，他发现了一些有趣的技巧，并问我对VueJS的布局有什么看法。在这篇文章中，我决定分享我对这个话题的想法，并向你展示如何为VueJS项目创建智能布局的技巧。</p><p id="67ab" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但是在我们开始之前，问你自己一个问题:</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/e1138aec930b56b948633bdcf28c1efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*8vwStRQEmds9ShNZej9bzg.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">"当前的VueJS布局有什么问题？"</figcaption></figure><p id="aa8d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">答案很简单:</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/2509ffda299b4ca576af1fdc60685480.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*uqOSDBvmSqHxwFlV2hTJ4A.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">“他们不存在”</figcaption></figure><p id="f1dd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">VueJS开发者通常如何解决这个问题？最常见的方法是创建高阶组件并将其添加到所有页面中。</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">高阶组件示例</figcaption></figure><p id="2090" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我认为这种方法存在两个问题:</p><ol class=""><li id="99d8" class="ld le iq jw b jx jy kb kc kf lf kj lg kn lh kr li lj lk ll bi translated">我们应该在不同的页面上反复导入我们的布局。</li><li id="6cdc" class="ld le iq jw b jx lm kb ln kf lo kj lp kn lq kr li lj lk ll bi translated">我们应该用布局组件包装我们内容。</li><li id="aafc" class="ld le iq jw b jx lm kb ln kf lo kj lp kn lq kr li lj lk ll bi translated">这使得我们的代码有点复杂，并迫使组件负责渲染布局。</li></ol><p id="bc72" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一方面，这应该不是什么大事，但我对NuxtJS添加布局的方法印象深刻，并希望创建类似的东西。如果你不熟悉NuxtJS的方式，我可以说两个字:“太神奇了”。你可以将你的布局定义为一个组件的属性，你不应该添加更高阶的组件来将布局添加到你的应用程序中。但是现在让我们忘记NuxtJS，看看我们可以用VueJS中的布局做什么。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="a04d" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">先决条件</h1><p id="def7" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">让我们使用vue CLI<a class="ae nb" href="https://cli.vuejs.org/" rel="noopener ugc nofollow" target="_blank"><em class="nc"/></a>开始并创建一个新的Vue项目</p><pre class="kt ku kv kw gt nd ne nf ng aw nh bi"><span id="a219" class="ni lz iq ne b gy nj nk l nl nm">vue create vue-layouts</span></pre><p id="0bca" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在Vue2+和Vue3+之间随意选择。</p><h1 id="9c0d" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">清理项目</h1><p id="6f1d" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">我们应该清理我们的项目并删除由vue cli创建的未使用的文件。</p><p id="f6aa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，移除<em class="nc"> HelloWorld.vue </em>组件和组件文件夹。在这个项目中不需要它。在<em class="nc"> Home.vue </em>中，我们应该移除对<em class="nc"> HelloWorld.vue </em>组件的导入。</p><p id="708c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">删除包含内容的资产文件夹，并创建一个新文件<em class="nc"> views/Contacts.vue </em>。</p><p id="91c8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">移除未使用的文件后，我们的项目看起来像:</p><pre class="kt ku kv kw gt nd ne nf ng aw nh bi"><span id="312c" class="ni lz iq ne b gy nj nk l nl nm">--src<br/>----views<br/>------About.vue<br/>------Contacts.vue<br/>------Home.vue<br/>----App.vue<br/>----main.js<br/>----router.js</span></pre><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">App.vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">views/Home.vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">views/About.vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">视图/联系人. vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">router.js</figcaption></figure><p id="5170" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们准备创建我们的布局。</p><h1 id="0092" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">创建布局构造器</h1><p id="338a" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">作为第一步，我们需要创建一个名为<em class="nc">“layouts/applayout . vue”</em>的新组件(不要忘记创建<em class="nc">“layouts”</em>文件夹)。<br/>下面是Vue 2版本的实现:</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">layouts/AppLayout.vue</figcaption></figure><p id="1090" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如你所见，这是一个非常简单的组件，但这是我们布局系统的核心。让我们更深入地看看它是如何工作的。</p><p id="b64a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在模板部分，我们添加了动态组件。作为动态组件的内容，我们添加了名为“布局”的计算属性。该计算属性查看当前路线并检查那里的布局，或者使用我们在常量中定义的默认布局<em class="nc"> "AppLayoutDefault" </em>。如果找到了路线，computed property会尝试找到适当的布局并将其加载到动态组件中。</p><p id="98f6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是Vue 3的实现:</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="4092" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们不是在getter中导入组件，而是在watcher中导入组件，并通过数据将其传递给动态组件。</p><p id="90de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是Vue 3合成API实现(感谢克里斯托佛·罗恩·李的想法【https://twitter.com/KristofferRoenL<a class="ae nb" href="https://twitter.com/KristofferRoenL" rel="noopener ugc nofollow" target="_blank">】)</a></p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><h1 id="01a9" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">创建布局</h1><p id="4ecb" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">现在，我们要创建我们的布局。对于这个项目，我们将为每个页面创建三种不同的布局。当然，对于您的项目，您可以根据需要选择任意多的布局。</p><p id="7b99" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但在我们继续布局之前，让我们稍微重构一下代码，将路由器链接从<em class="nc"> App.vue </em>移到一个新组件<em class="nc">“layoutlinks/AppLayoutLinks”</em>。</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">layouts/AppLayoutLinks.vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">App.vue</figcaption></figure><p id="030e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个小的重构之后，我们应该创建我们的三个布局和默认布局。让我们从默认的一个开始。对我来说，这非常简单。你可能想把它创造得更漂亮。</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">AppLayoutDefault.vue</figcaption></figure><p id="37a0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请注意，您的默认布局的名称必须与我们的布局构造函数<em class="nc"> AppLayout.vue. </em>中的<em class="nc"> defaultLayout </em>常量相同，在我们的例子中是<em class="nc"> "AppLayoutDefault" </em>(没有文件扩展名)。</p><p id="226b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以及我们的三个主要布局</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">layouts/AppLayoutHome.vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">layouts/AppLayoutAbout.vue</figcaption></figure><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">layouts/AppLayoutContacts.vue</figcaption></figure><p id="ab0e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我没有花太多时间来创建漂亮的布局。唯一的区别是不同的颜色。但是我相信，对于本文的目的来说，这已经足够了。</p><h1 id="3bad" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">将布局移动到路由器级别</h1><p id="2795" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">是时候玩我们的新布局了。让我们再来看看我们的路由器。花点时间想想我们可以在哪里添加我们的布局。</p><p id="9687" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">没错，我们可以将它添加到我们正在使用的每条路线的元属性中。你可能已经注意到，在我们的布局构造函数中，我们使用了<em class="nc"> this。$route.meta.layout </em>属性。你可以在这里阅读关于路线属性<a class="ae nb" href="https://router.vuejs.org/api/#routes" rel="noopener ugc nofollow" target="_blank"/></p><p id="fcc7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，让我们现在就做，并添加我们的布局到每条路线</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">router.js</figcaption></figure><h1 id="80dc" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">最后一笔</h1><p id="e554" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">你现在可以说:“嗯，还是不行”。是的，我们只需要做最后一件事——将我们的布局构造函数与应用程序连接起来。有两种方法:</p><p id="c381" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，使用旧的好的高阶组件将我们的<em class="nc"> router-view </em>封装在<em class="nc"> App.vue </em>中。就像这样:</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">App.vue</figcaption></figure><p id="efa8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">是的，我添加了一个高阶组件，尽管我在文章的开头说过。但是正如你所看到的，它只进口了一次，我认为它完全没问题。</p><p id="0f9e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">还有一个办法。我们可以创建一个全局vue组件并将其包含到vue应用程序中，而不是在<em class="nc"> App.vue </em>中导入我们的<em class="nc"> AppLayout.vue </em>。我们应该更改我们的<em class="nc"> main.js </em>文件。</p><p id="8c36" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是Vue 2版本:</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">main.js Vue 2</figcaption></figure><p id="1112" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和版本Vue 3:</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">main.js Vue 3</figcaption></figure><p id="5b3a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">清除回<em class="nc"> App.vue </em>文件</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="lb lc l"/></div></figure><h1 id="141d" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">测试默认布局</h1><p id="5916" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">为了确保一切按预期工作，让我们创建一个新的测试路线，并检查默认布局是否正常工作。<br/>在router.js中添加新路由</p><pre class="kt ku kv kw gt nd ne nf ng aw nh bi"><span id="37bb" class="ni lz iq ne b gy nj nk l nl nm">{<br/>  path: '/test',<br/>  name: 'Test',<br/>  component: () =&gt; <em class="nc">import</em>('@/views/Home.vue')<br/>}</span></pre><p id="57e3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您现在访问“/test”route，您可以看到我们的默认布局，因为我们没有在路由器中定义任何布局。</p><h1 id="b382" class="ly lz iq bd ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv bi translated">结论</h1><p id="3eab" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr ij bi translated">我发现这个布局系统在我的VueJS应用程序中使用非常方便。我看到了一些好处:</p><ol class=""><li id="db75" class="ld le iq jw b jx jy kb kc kf lf kj lg kn lh kr li lj lk ll bi translated">容易实现。您可以在创建新项目后的几分钟内添加它。</li><li id="0f38" class="ld le iq jw b jx lm kb ln kf lo kj lp kn lq kr li lj lk ll bi translated">好用。布局只需在适当的路线中指定即可。但是如果你忘记这样做，默认的布局仍然有效。</li><li id="ec06" class="ld le iq jw b jx lm kb ln kf lo kj lp kn lq kr li lj lk ll bi translated">使我们的组件更干净，没有至少一个导入语句和模板包装。</li><li id="b57e" class="ld le iq jw b jx lm kb ln kf lo kj lp kn lq kr li lj lk ll bi translated">将所有布局逻辑移至布线器层，而不是元件层。</li></ol><p id="bb24" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">希望你喜欢这篇文章，并找到一些可以在日常工作中使用的有用技巧。你可以在我的github账户上找到代码库—<a class="ae nb" href="https://github.com/NovoManu/vue-smart-layouts" rel="noopener ugc nofollow" target="_blank">https://github.com/NovoManu/vue-smart-layouts</a></p><p id="2a0a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您对本文或我的其他文章感兴趣，请随时关注我:</p><p id="7bfd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">github:<a class="ae nb" href="https://github.com/NovoManu" rel="noopener ugc nofollow" target="_blank">https://github.com/NovoManu</a></p><p id="4dbf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">https://twitter.com/ManuSEngineer</p><p id="3a88" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">乡亲们就这些了，<br/>下篇见。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Blazor Forms and Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Blazor表单和验证</h1>
<blockquote>原文：<a href="https://itnext.io/blazor-forms-and-validation-418173350435?source=collection_archive---------4-----------------------#2019-09-16">https://itnext.io/blazor-forms-and-validation-418173350435?source=collection_archive---------4-----------------------#2019-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/5e92863df87cfb2d5a242da84f93844e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4oD-aiBLl0PKOiuv1BKQtQ.png"/></div></div></figure><div class=""/><p id="a9c5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本周我将探索在服务器端Blazor中使用表单和验证的基础知识。这是一个Blazor团队仍然在做很多改变的领域，所以如果这篇文章中的一些东西需要调整，不要感到惊讶。如果你需要帮助创建Blazor应用程序，请查看我的<a class="ae kw" href="https://elanderson.net/2019/08/asp-net-core-server-side-blazor-with-authentication/" rel="noopener ugc nofollow" target="_blank">ASP.NET核心服务器端带认证的Blazor</a>帖子，这是我用来写这篇帖子的应用程序。</p><h2 id="e1d8" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">模型</h2><p id="0214" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">对于这个例子，我将创建一个用于编辑联系人的表单。Blazor将利用数据注释，并自动确保条件有效。下面是我作为模型使用的类，其中加入了一些数据注释。项目结构方面，我添加了一个模型目录，并在那里添加了我的模型类。</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="961c" class="kx ky jb ma b gy me mf l mg mh">public class Contact<br/>{<br/>    public int Id { get; set; }<br/>    [Required]<br/>    public string Name { get; set; }<br/>    public string Address { get; set; }<br/>    public string City { get; set; }<br/>    public string State { get; set; }<br/>    [StringLength(5, <br/>                  MinimumLength = 5, <br/>                  ErrorMessage = "Postal Code must be 5 characters")]<br/>    public string PostalCode { get; set; }<br/>    public string Phone { get; set; }<br/>    [Required]<br/>    [EmailAddress]<br/>    public string Email { get; set; }<br/>}</span></pre><p id="9ff6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您在课程中看到的,<strong class="ka jc">姓名</strong>和<strong class="ka jc">电子邮件</strong>都是必填字段。<strong class="ka jc">电子邮件</strong>也需要是有效的电子邮件地址。<strong class="ka jc"> PostalCode </strong>不是必填项，但如果输入必须是5个字符。如果输入了邮政编码，但不是5个字符，则指定的错误消息将显示在UI中。</p><h2 id="8af6" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">成分</h2><p id="f8db" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">接下来，我添加了一个新的<strong class="ka jc"> ContactEdit </strong>组件。有关如何添加新组件的详细信息，请查看Blazor 中的<a class="ae kw" href="https://elanderson.net/2019/08/razor-components-in-blazor/" rel="noopener ugc nofollow" target="_blank"> Razor Components，它将指导您使用Visual Studio添加新组件。它还将显示您必须将组件添加到现有页面。</a></p><p id="b554" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是完整的组件。大部分组件是普通的HTML表单元素。在代码之后，我将指出几件事情。</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="e767" class="kx ky jb ma b gy me mf l mg mh">@using Models<br/>@using System.Diagnostics<br/><br/>&lt;h3&gt;Contact Edit&lt;/h3&gt;<br/><br/>&lt;div class="row"&gt;<br/>    &lt;div class="col-md-4"&gt;<br/>        &lt;EditForm Model="@contact" OnValidSubmit="@ValidSubmit"&gt;<br/>            &lt;DataAnnotationsValidator /&gt;<br/>            &lt;ValidationSummary /&gt;<br/><br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="name" class="control-label"&gt;Name: &lt;/label&gt;<br/>                &lt;InputText id="name" @bind-value="contact.Name" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.Name)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="address" class="control-label"&gt;Address: &lt;/label&gt;<br/>                &lt;InputText id="address" @bind-value="contact.Address" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.Address)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="city" class="control-label"&gt;City: &lt;/label&gt;<br/>                &lt;InputText id="city" @bind-value="contact.City" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.City)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="state" class="control-label"&gt;State: &lt;/label&gt;<br/>                &lt;InputText id="state" @bind-value="contact.State" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.State)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="postalCode" class="control-label"&gt;Postal Code: &lt;/label&gt;<br/>                &lt;InputText id="postalCode" @bind-value="contact.PostalCode" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.PostalCode)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="phone" class="control-label"&gt;Phone: &lt;/label&gt;<br/>                &lt;InputText id="phone" @bind-value="contact.Phone" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.Phone)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;div class="form-group"&gt;<br/>                &lt;label for="email" class="control-label"&gt;Email: &lt;/label&gt;<br/>                &lt;InputText id="email" @bind-value="contact.Email" class="form-control" /&gt;<br/>                &lt;ValidationMessage For="@(() =&gt; contact.Email)" /&gt;<br/>            &lt;/div&gt;<br/>            &lt;button type="submit"&gt;Submit&lt;/button&gt;<br/>        &lt;/EditForm&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;<br/><br/>@code {<br/>    private Contact contact = new Contact<br/>    {<br/>        Id = 1,<br/>        Name = "Eric",<br/>        Address = "578 Main St.",<br/>        City = "Nashville",<br/>        State = "TN",<br/>        Phone = "615-555-5555",<br/>        Email = "ericeric.com"<br/>    };<br/><br/>    private void ValidSubmit()<br/>    {<br/>        Debug.WriteLine("ValidSubmit");<br/>    }<br/>}</span></pre><p id="79b1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是上面代码的一个小节，它不同于标准的HTML表单。</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="af27" class="kx ky jb ma b gy me mf l mg mh">&lt;EditForm Model="@contact" OnValidSubmit="@ValidSubmit"&gt;<br/>    &lt;DataAnnotationsValidator /&gt;<br/>    &lt;ValidationSummary /&gt;<br/><br/>    &lt;div class="form-group"&gt;<br/>        &lt;label for="name" class="control-label"&gt;Name: &lt;/label&gt;<br/>        &lt;InputText id="name" @bind-value="contact.Name" class="form-control" /&gt;<br/>        &lt;ValidationMessage For="@(() =&gt; contact.Name)" /&gt;<br/>    &lt;/div&gt;<br/>    &lt;button type="submit"&gt;Submit&lt;/button&gt;<br/>&lt;/EditForm&gt;</span></pre><p id="85cf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc"> EditForm </strong>是微软创建的一个组件，它将绑定到您的模型，并允许您指定提交时将调用什么函数。在这个例子中，我们使用<strong class="ka jc"> OnValidSubmit </strong>来调用<strong class="ka jc"> ValidSubmit </strong>函数，前提是模型有效。记下<strong class="ka jc">dataannotationvalidator</strong>的用法，它是一个组件，支持基于我们放在模型类上的数据注释进行验证。</p><p id="8b90" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一件需要注意的事情是<strong class="ka jc"> ValidationSummary </strong>组件的使用，它显示了模型上所有验证问题的摘要。这个例子也使用<strong class="ka jc"> ValidationMessage </strong>来显示与相关字段一致的错误。在实际的应用程序中，我怀疑这两种方法是否都会用到，但是我想展示如何使用这两种方法。</p><h2 id="d1d7" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">包扎</h2><p id="470d" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">希望这是对Blazor中表单和验证的有益介绍。我可能会在其他提交选项上写一篇后续文章。</p><p id="2116" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保并查看<a class="ae kw" href="https://docs.microsoft.com/en-us/aspnet/core/blazor/forms-validation?view=aspnetcore-3.0" rel="noopener ugc nofollow" target="_blank">官方文件</a>以获取更多信息。雷米·布尔加雷尔在T2也有一个关于这个话题的帖子。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="a233" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mp">原载于</em><a class="ae kw" href="https://elanderson.net/2019/09/blazor-forms-and-validation/" rel="noopener ugc nofollow" target="_blank"><em class="mp"/></a><em class="mp">。</em></p></div></div>    
</body>
</html>
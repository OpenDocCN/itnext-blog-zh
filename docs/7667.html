<html>
<head>
<title>AdMob Banner &amp; Interstitial Ads in Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jetpack中的AdMob横幅和间隙广告构成</h1>
<blockquote>原文：<a href="https://itnext.io/admob-banner-interstitial-in-jetpack-compose-47a1b700198c?source=collection_archive---------0-----------------------#2022-12-13">https://itnext.io/admob-banner-interstitial-in-jetpack-compose-47a1b700198c?source=collection_archive---------0-----------------------#2022-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/eec51e8399e8d8523a84d010ab88f73b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xadnwdROWhFJF189D4ksSA.png"/></div></div></figure><p id="b548" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不幸的是，Jetpack Compose还不支持AdMob，但这并不意味着我们不能添加AdMob。</p><h1 id="23b7" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">入门指南</h1><p id="3ff9" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我假设你已经向AdMob注册了你的应用。所以，你要准备好你的<a class="ae lz" href="https://support.google.com/admob/answer/7356431?utm_source=developers.google.com" rel="noopener ugc nofollow" target="_blank"> AdMob App ID </a>。</p><p id="e5db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要首先添加播放服务依赖。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="e8b5" class="mj kx iq mf b be mk ml l mm mn">implementation 'com.google.android.gms:play-services-ads:21.3.0'</span></pre><p id="d476" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们需要AdMob应用程序ID。打开<code class="fe mo mp mq mf b">AndroidManifest.xml</code>文件并添加这一行。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="98b7" class="mj kx iq mf b be mk ml l mm mn">&lt;manifest&gt;<br/>    &lt;application&gt;<br/>        &lt;!-- Sample AdMob app ID: ca-app-pub-3940256099942544~3347511713 --&gt;<br/>        &lt;meta-data<br/>            android:name="com.google.android.gms.ads.APPLICATION_ID"<br/>            android:value="ca-app-pub-xxxxxxxxxxxxxxxx~yyyyyyyyyy"/&gt;<br/>    &lt;/application&gt;<br/>&lt;/manifest&gt;</span></pre><p id="c623" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，初始化广告。(可以在<code class="fe mo mp mq mf b">MainActivity</code> <code class="fe mo mp mq mf b">onCreate</code>中初始化)</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="3bfa" class="mj kx iq mf b be mk ml l mm mn">MobileAds.initialize(this)<br/>//Optional if you want to add test device<br/>val configuration = RequestConfiguration.Builder()<br/>            .setTestDeviceIds(Collections.singletonList("DEVICE ID"))<br/>            .build()<br/>MobileAds.setRequestConfiguration(configuration)</span></pre><h1 id="c5a1" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">旗帜</h1><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="9bec" class="mj kx iq mf b be mk ml l mm mn">@Composable<br/>fun BannerAdView() {<br/>    AndroidView(<br/>        modifier = Modifier<br/>            .fillMaxWidth(),<br/>        factory = { context -&gt;<br/>            AdView(context).apply {<br/>                setAdSize(AdSize.BANNER)<br/>                // Add your adUnitID, this is for testing.<br/>                adUnitId = "ca-app-pub-3940256099942544/6300978111"<br/>                loadAd(AdRequest.Builder().build())<br/>            }<br/>        }<br/>    )<br/>}</span></pre><p id="1f54" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于我们没有本地支持，我们将把<code class="fe mo mp mq mf b">AdView</code>包装在<code class="fe mo mp mq mf b"><a class="ae lz" href="https://developer.android.com/reference/kotlin/androidx/compose/ui/viewinterop/package-summary#AndroidView(kotlin.Function1,androidx.compose.ui.Modifier,kotlin.Function1)" rel="noopener ugc nofollow" target="_blank">AndroidView</a></code>中。你可以再从<a class="ae lz" href="https://support.google.com/admob/answer/7356431?utm_source=developers.google.com" rel="noopener ugc nofollow" target="_blank">这个链接</a>找到你的<code class="fe mo mp mq mf b">adUnitId</code>。</p><p id="df28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">班纳到此为止。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/b26b8cd4d2e1c6fff2276e20f616c6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJQHqm5e0xFotnER-qaQnw.png"/></div></div></figure><h1 id="886a" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">空隙的</h1><p id="9f25" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><em class="ms">我已经想出了我的方法，你可以修改和优化它。</em></p><p id="85ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个不同于横幅广告，需要不同的逻辑。我们将为Interstitial创建单独文件。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c652" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mo mp mq mf b">loadInterstitial</code>功能加载间隙广告。</p><p id="c3e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mo mp mq mf b">showInterstitial</code>功能将显示广告。广告被用户取消后，它会重新加载广告。<code class="fe mo mp mq mf b">onAdDismissed</code>功能可选。当用户取消广告时，它将被触发。</p><p id="834b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mo mp mq mf b">removeInterstitial</code>用于防止内存泄漏。</p><p id="e88b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另外，<code class="fe mo mp mq mf b">findActivity</code>是一个自定义扩展函数。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="e868" class="mj kx iq mf b be mk ml l mm mn">fun Context.findActivity(): Activity? = when (this) {<br/>    is Activity -&gt; this<br/>    is ContextWrapper -&gt; baseContext.findActivity()<br/>    else -&gt; null<br/>}</span></pre><p id="1df0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们在UI内部实现它。在<code class="fe mo mp mq mf b">MainActivity</code>中，</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="8f69" class="mj kx iq mf b be mk ml l mm mn">class MainActivity : ComponentActivity() {<br/>    override fun onCreate(savedInstanceState: Bundle?) {<br/>        //...<br/>        loadInterstitial(this)<br/>    }<br/><br/>    override fun onDestroy() {<br/>        removeInterstitial()<br/>        super.onDestroy()<br/>    }<br/>}</span></pre><p id="e803" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，您可以从任何想要的组合中调用<code class="fe mo mp mq mf b">showInterstitial</code>,</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="806a" class="mj kx iq mf b be mk ml l mm mn">showInterstitial(context) {<br/>    //On Ad Dismiss Lambda Function<br/>    //e.g. you can show dialog to the user or redirect them etc.<br/>}</span></pre><p id="3f40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就是这样！我希望它是有用的。👋👋</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/78d4c3afe4868bae5333f1caa73929d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*hfRspjhn1vXxtSC4RSr6tw.png"/></div></figure><h2 id="1a6e" class="mw kx iq bd ky mx my dn lc mz na dp lg kj nb nc lk kn nd ne lo kr nf ng ls nh bi translated">来源:</h2><ul class=""><li id="4c27" class="ni nj iq ka b kb lu kf lv kj nk kn nl kr nm kv nn no np nq bi translated"><a class="ae lz" href="https://developers.google.com/admob/android/quick-start" rel="noopener ugc nofollow" target="_blank">入门|安卓|谷歌开发者</a></li><li id="2ba3" class="ni nj iq ka b kb nr kf ns kj nt kn nu kr nv kv nn no np nq bi translated"><a class="ae lz" href="https://andresand.medium.com/add-admob-ad-banner-using-android-compose-9ba78c8f1591" rel="noopener">使用Android Compose添加AdMob广告横幅| Andres Sandoval | Medium</a></li></ul></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="7a3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以联系我，</p><ul class=""><li id="7c55" class="ni nj iq ka b kb kc kf kg kj od kn oe kr of kv nn no np nq bi translated"><a class="ae lz" href="https://www.linkedin.com/in/burak-fidan/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="07d3" class="ni nj iq ka b kb nr kf ns kj nt kn nu kr nv kv nn no np nq bi translated"><a class="ae lz" href="https://github.com/MrNtlu" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="cf46" class="ni nj iq ka b kb nr kf ns kj nt kn nu kr nv kv nn no np nq bi translated"><a class="ae lz" href="https://twitter.com/BurakFNtlu" rel="noopener ugc nofollow" target="_blank">推特</a></li></ul></div></div>    
</body>
</html>
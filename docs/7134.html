<html>
<head>
<title>DevOps and Kubernetes. You build it, you run it.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DevOps和Kubernetes。你建造它，你经营它。</h1>
<blockquote>原文：<a href="https://itnext.io/devops-on-kubernetes-you-build-it-you-run-it-81a98db00e51?source=collection_archive---------1-----------------------#2022-06-21">https://itnext.io/devops-on-kubernetes-you-build-it-you-run-it-81a98db00e51?source=collection_archive---------1-----------------------#2022-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/01c29420127be0d699ac08ddcf2b3bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yD01_HxdCSDFHsagwHtxYw.png"/></div></div></figure><p id="b4c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用一个平台在Kubernetes上编码、构建、部署、操作和监控容器化的应用。</p><blockquote class="kw kx ky"><p id="e3ee" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">使用Kubernetes时，准备好所有工具来支持您的DevOps之旅是一项挑战。如果有一个单一的Kubernetes安装来支持团队从头到尾实践DevOps会怎么样？</p></blockquote><p id="9dd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我将向您展示如何使用Kubernetes和Otomi开始练习DevOps，并且没有任何依赖性。从将您的代码推送到Git repo，构建映像，将映像推送到私有注册表，部署映像，以安全的方式公开应用程序，以及监控应用程序。我们只会使用集成到Otomi的技术。所以自我托管，没有使用任何其他(SaaS)服务。唯一的要求是启动并运行Kubernetes集群，并访问DNS区域。</p><p id="eeba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Otomi为Kubernetes提供了一个完整的自托管DevOps平台作为服务，可以一次性安装。对于本文，我将在Azure Kubernetes服务(AKS)上安装Otomi和DNS。使用DNS和Let ' s Encrypt production certificates是将Harbor用作映像注册中心的先决条件。</p><p id="096a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">没有DNS也可以安装Otomi。在这种情况下，Otomi将使用nip.io作为主机名，并生成一个自定义CA。开始使用Otomi最简单的方法是从<a class="ae ld" href="https://marketplace.digitalocean.com/apps/otomi?refcode=476bfcac9ec9&amp;action=deploy" rel="noopener ugc nofollow" target="_blank">数字海洋市场</a>安装它。但是如前所述，在这种情况下，您不能使用Harbor(或者您需要手动将生成的CA添加到集群节点中)。</p><h2 id="dbdc" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">安装Otomi</h2><p id="a8b2" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">安装otomi的说明见<a class="ae ld" href="https://otomi.io" rel="noopener ugc nofollow" target="_blank"> otomi.io </a>。我正在使用舵图安装Otomi:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="59c1" class="le lf iq mh b gy ml mm l mn mo">helm repo add otomi https://otomi.io/otomi-core<br/>helm repo update<br/>helm install -f values.yaml otomi otomi/otomi</span></pre><p id="09a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些是我的价值观:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="7d8b" class="le lf iq mh b gy ml mm l mn mo">cluster:<br/>  k8sVersion: "1.22"<br/>  name: demo<br/>  provider: azure<br/>  domainSuffix: demo.aks.r6s.io # required for DNS<br/>otomi:<br/>  hasExternalDNS: true # required for DNS<br/>dns:<br/>  provider:<br/>    azure:<br/>      resourceGroup: external-dns<br/>      aadClientId: xx<br/>      aadClientSecret: xx<br/>      tenantId: xx<br/>      subscriptionId: xx<br/>apps:<br/>  cert-manager:<br/>    issuer: letsencrypt<br/>    stage: production<br/>    email: <a class="ae ld" href="mailto:sre@r6s.io" rel="noopener ugc nofollow" target="_blank">sre@r6s.io</a><br/>  external-dns:<br/>    domainFilters:<br/>      - aks.r6s.io</span></pre><p id="7e66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当安装程序工作完成后，按照<a class="ae ld" href="https://otomi.io/docs/installation/activation/" rel="noopener ugc nofollow" target="_blank">这里</a>描述的激活步骤进行操作。</p><h2 id="266e" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">在Otomi中激活应用程序</h2><p id="d458" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">安装Otomi后，只有核心应用程序(Keycloak、Istio、cert-manager、Drone和Gitea)可用。所有其他应用程序都是可选的。这使得Otomi成为一个可组合的平台。让我们首先激活我们将要使用的所有技术:通过将以下应用拖到活动应用平面来激活它们:</p><ul class=""><li id="0a88" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated"><strong class="ka ir"> Harbor </strong>作为存储我们图像的私有图像注册表)</li><li id="aa7c" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated"><strong class="ka ir"> Knative </strong>用于无服务器容器的快速部署和自动伸缩</li></ul><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/8818f258916a5406cb8dda2c8e90c9ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwtaQhofmFamX6DbclbkAg.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">通过将应用程序拖到“已启用的应用程序”部分来激活它们</figcaption></figure><p id="8e4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在单击“部署更改”。</p><p id="72a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其次，我们将在Otomi创建一个团队。Otomi中的团队是Kubernetes中的一个名称空间，但也向团队成员提供了自助任务的委托。我们不会在这里深入讨论这个问题，但是请记住，您总是需要至少一个团队来部署应用程序。</p><p id="b1c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，应用程序已被激活，团队也已创建，平台上的一切都已准备好构建、部署和运行容器化的应用程序。所以让我们先开始创建一个代码库。</p><h2 id="c95b" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">在Gitea中创建Git存储库</h2><p id="ee26" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">转到Gitea并创建一个新的存储库。提供回购的名称，并确保回购是私有的。</p><ul class=""><li id="1ef4" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">打开Gitea</li><li id="35c3" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">在右侧的“存储库”下，单击+</li><li id="5dfe" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">提供一个名称(团队-演示-helloworld)</li><li id="eedb" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">单击使存储库私有</li><li id="1e23" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">单击创建存储库</li></ul><p id="93be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于本文，我将使用一个示例NodeJS hello-world应用程序。</p><p id="83fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">复制示例报告:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="3972" class="le lf iq mh b gy ml mm l mn mo">git clone <a class="ae ld" href="https://github.com/redkubes/nodejs-helloworld.git" rel="noopener ugc nofollow" target="_blank">https://github.com/redkubes/nodejs-helloworld.git</a><br/>cd cd nodejs-helloworld</span></pre><p id="6728" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并将示例repo镜像到新的Gitea repo:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="5177" class="le lf iq mh b gy ml mm l mn mo">git push --mirror <a class="ae ld" href="https://gitea.demo.aks.r6s.io/otomi-admin/team-demo-helloworld.git" rel="noopener ugc nofollow" target="_blank">https://gitea.demo.aks.r6s.io/otomi-admin/team-demo-helloworld.git</a></span></pre><p id="d365" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">克隆新的回购:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="b1ac" class="le lf iq mh b gy ml mm l mn mo">git clone <a class="ae ld" href="https://gitea.demo.aks.r6s.io/otomi-admin/team-demo-helloworld.git" rel="noopener ugc nofollow" target="_blank">https://gitea.demo.aks.r6s.io/otomi-admin/team-demo-helloworld.git</a></span></pre><h2 id="3bbc" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">在Harbor创建一个机器人帐户</h2><p id="5293" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">因为我们将从代码中构建一个映像，然后将它推送到一个私有的注册中心，所以我们首先需要创建将映像推送到注册中心的凭证。</p><p id="c3c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">前往Harbor，为团队演示创建一个新的机器人帐户:</p><ol class=""><li id="4748" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv ni mv mw mx bi translated">点击机器人账户</li><li id="9387" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv ni mv mw mx bi translated">单击新建机器人帐户</li><li id="925a" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv ni mv mw mx bi translated">名称:团队演示无人机</li><li id="2fc9" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv ni mv mw mx bi translated">选择团队-演示</li><li id="e3d3" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv ni mv mw mx bi translated">复制名称和令牌</li></ol><h2 id="2326" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">在无人机中配置管道</h2><p id="4659" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">Drone CI是Otomi自己用的，但是也可以用于自己的项目。打开无人机，进入无人机仪表盘，点击“同步”。您将在存储库列表中看到您的新回购弹出。点击新的回购协议，然后点击“激活”。</p><p id="d0c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们需要将机器人帐户的凭证作为机密添加到Drone:</p><ol class=""><li id="2bdd" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv ni mv mw mx bi translated">在Drone中，单击team-demo-app存储库。</li><li id="106c" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv ni mv mw mx bi translated">在“设置”下，单击“机密”</li><li id="502c" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv ni mv mw mx bi translated">添加以下两个秘密:</li></ol><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="bc5f" class="le lf iq mh b gy ml mm l mn mo">REGISTRY_USERNAME = otomi-team-demo-drone</span><span id="923b" class="le lf iq mh b gy nj mm l mn mo">REGISTRY_PASSWORD = &lt;the-token-of-the-robot-account&gt;</span></pre><p id="a519" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们将把无人机管道定义添加到我们的回购协议中。</p><ul class=""><li id="f3ce" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">将. drone.yml内容替换为以下内容:</li></ul><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="4ee3" class="le lf iq mh b gy ml mm l mn mo">kind: pipeline<br/>type: kubernetes<br/>name: default<br/>steps:<br/>  - name: build-push<br/>    image: plugins/docker<br/>    settings:<br/>      registry: harbor.&lt;your-ip&gt;.nip.io<br/>      repo: harbor.&lt;your-ip&gt;.nip.io/team-demo/nginx<br/>      insecure: true<br/>      username:<br/>        from_secret: REGISTRY_USERNAME<br/>      password:<br/>        from_secret: REGISTRY_PASSWORD<br/>      tags:<br/>        - ${DRONE_BRANCH}</span></pre><ul class=""><li id="762b" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">调整. drone.yml文件中的注册表和repo名称</li><li id="fba4" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">推动变革:</li></ul><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="9b71" class="le lf iq mh b gy ml mm l mn mo">git add .<br/>git commit -m “add drone pipeline”<br/>git push</span></pre><p id="7255" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在无人机中，你会看到管道已经自动开始建设，然后推动新的图像到港口。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/812b3b9d0690cb6e6d2d54105e5fb611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4Ym-AyD0dzEfpbWp_om6w.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">无人机流水线执行</figcaption></figure><p id="2c91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Harbor中，您会看到新创建的注册表:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/5544785a7512266a5a30890b57143bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldnTy0OGzuntEatUrtGQ7Q.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">港口图像登记处</figcaption></figure><p id="59d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可选地，您现在也可以使用Trivy扫描图像的漏洞。</p><h2 id="9aab" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">在Kubernetes上部署和展示应用程序</h2><p id="e230" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">现在映像已经构建好了，我们可以部署它了。Otomi提供了多种部署选项。您可以:</p><ul class=""><li id="7e5d" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">创建您自己的部署和服务清单，并使用Argo CD进行部署</li><li id="d229" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">创建一个舵图，并将其添加到Harbor的海图库中</li><li id="8ea4" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">使用Otomi为您创建一个有价值的服务</li></ul><p id="a61c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，我将使用Otomi为自己创建一个新的Knative服务。</p><p id="1107" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，当我们在Otomi中创建一个团队时，已经为注册表创建了一个pull secret，并将其添加到团队名称空间中。</p><ul class=""><li id="903a" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">在web控制台的顶部栏中选择演示团队</li><li id="29fb" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">在左侧菜单(在团队演示下)中，单击服务</li><li id="345a" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">点击新服务</li><li id="003f" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">填写服务的名称(hello-world)</li><li id="efcd" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">在服务类型下选择新的服务</li></ul><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/dab6d7e015bb72eaa65e07f4fd8b4952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2uwx4Mi_wHYGJwtzTweeA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">新创意服务</figcaption></figure><ul class=""><li id="35fe" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">填写存储库名称和标签</li><li id="fb98" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">填写限额和要求</li></ul><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/1dbe351b311dd2f9b44524658a25abb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyqO7xX2ztVTLEDmL4XsRA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">回购和资源请求和限制</figcaption></figure><ul class=""><li id="3561" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">在暴露入口下，选择入口</li></ul><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/6a564b264f6d01e1c7aae6b0a4efcf2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbyX07Mlt_SOWSF3WXWZtw.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">配置入口</figcaption></figure><ul class=""><li id="edcc" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated">单击提交</li></ul><p id="7895" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在服务列表中，您会看到新创建的服务和URL。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/43462b5b5595719ce897d4d7e85dbca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1W8M5aIqQg1k8L9aHmJFSA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">创建的服务</figcaption></figure><p id="4eb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击网址。这是你应该看到的:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/fe600443e3e54518fed6945a4793207b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gnssHdhmqTBr4SmQFTCFxw.png"/></div></div></figure><p id="d6c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">应用程序已部署并公开展示。在这种情况下，Otomi不仅创建了Knative服务，还生成了所有的入口配置(包括Istio ),并确保将主机名添加到DNS区域并创建了证书。简单对吗？</p><h2 id="3d60" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">监控应用程序</h2><p id="aae1" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">为了能够监控部署的应用程序，我们首先需要激活几个应用程序。转到左侧菜单中平台下的应用部分，将以下应用拖到活动应用平面:</p><ul class=""><li id="34e4" class="mp mq iq ka b kb kc kf kg kj mr kn ms kr mt kv mu mv mw mx bi translated"><strong class="ka ir">普罗米修斯</strong></li><li id="817a" class="mp mq iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated"><strong class="ka ir">洛基</strong>(也会自动激活<strong class="ka ir">格拉夫纳</strong>)</li></ul><p id="5256" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在单击“部署更改”。</p><p id="ddef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当Prometheus和Loki安装完成后(这可能需要几分钟)，点击左侧菜单中团队演示下的应用项目。让我们首先检查日志。点击Loki，然后点击右上角的<code class="fe nr ns nt mh b">play</code>按钮。如您所见，Loki将立即显示团队中运行的容器的日志。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/8ffc798bc31467e64832bfc2fd46fcd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UF_i6LYUxQ4a-XoSj0L8Pg.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">使用Loki的日志聚合</figcaption></figure><p id="09c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在去普罗米修斯。单击状态，然后单击目标:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/20302d5dbbc67dc5de5855d9300499f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QCfkr-RZ2avIEQPlMCeow.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">使用黑盒导出器监控服务</figcaption></figure><p id="15ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Otomi使用Blackbox Exporter自动开始监控新服务的可用性。如果您激活警报管理器，您将在服务关闭时收到通知。</p><h2 id="5da8" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">包扎</h2><p id="3d0d" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">Kubernetes看起来相对简单，但仍然非常复杂。在你开始使用Kubernetes后不久，你会发现香草Kubernetes不会让你走得太远。你需要添加许多额外的应用程序，并将它们粘合在一起，以支持你的DevOps实践。这可能需要几个月到几年时间。</p><p id="3269" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Otomi为Kubernetes提供了一个完整的自托管DevOps平台作为服务，可以在任何Kubernetes集群上一次性安装。没有依赖和完全独立，这意味着你不需要任何额外的(SaaS)服务。但是如果你喜欢，你仍然可以。</p><p id="fe4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我展示了如何在使用Kubernetes时开始使用Otomi来支持DevOps。10分钟内从建筑代码到完全可观察性。你自己试试！</p><p id="ab3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">前往<a class="ae ld" href="https://github.com/redkubes/otomi-core" rel="noopener ugc nofollow" target="_blank">https://github.com/redkubes/otomi-core</a>开始。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Simple way to create kubernetes cluster locally using kind.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用kind在本地创建kubernetes集群的简单方法。</h1>
<blockquote>原文：<a href="https://itnext.io/simple-way-to-create-kubernetes-cluster-locally-using-kind-fb8f0f75e372?source=collection_archive---------2-----------------------#2020-07-05">https://itnext.io/simple-way-to-create-kubernetes-cluster-locally-using-kind-fb8f0f75e372?source=collection_archive---------2-----------------------#2020-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b86c00cffb3739dc02e3316070d70eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nzCO38pyKTeYN2Z-Ydh29A.png"/></div></div></figure><h1 id="74bb" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h1><p id="32f5" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">是另一个Kubernetes SIGs项目，但是与minikube相比有很大的不同。它将集群移动到Docker容器中。与生成虚拟机相比，这将显著加快启动速度。</p><p id="c222" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><a class="ae lx" href="https://sigs.k8s.io/kind" rel="noopener ugc nofollow" target="_blank"> kind </a>是一个使用Docker容器“节点”运行本地Kubernetes集群的工具(CLI)。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><p id="8e1f" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">让我们开始吧。</p><h1 id="9d84" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">先决条件:</h1><p id="6547" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">本地系统中应该有以下内容。</p><p id="6b86" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><code class="fe mk ml mm mn b"><em class="mo">go</em></code>(<a class="ae lx" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank">https://golang.org/</a>)</p><p id="de59" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><code class="fe mk ml mm mn b"><em class="mo">docker</em></code> <em class="mo"> —服务需要运行</em>(<a class="ae lx" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">https://www.docker.com/</a>)</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="c454" class="kb kc it bd kd ke mp kg kh ki mq kk kl km mr ko kp kq ms ks kt ku mt kw kx ky bi translated">装置</h1><p id="f60e" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">以下命令应该下载并安装<code class="fe mk ml mm mn b">kind</code>二进制文件。</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="e678" class="nc kc it mn b gy nd ne l nf ng">GO111MODULE=”on” go get sigs.k8s.io/kind@v0.8.1</span></pre><h1 id="36fe" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">确保存在二进制类型</h1><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="b684" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kind</strong> version<br/>kind v0.8.1 go1.14.2 darwin/amd64</span></pre><p id="bc70" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">现在我们应该能够使用<code class="fe mk ml mm mn b">kind</code> CLI启动k8s集群了。</p><p id="1cf8" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><code class="fe mk ml mm mn b">kind</code>的用法:</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="6c94" class="nc kc it mn b gy nd ne l nf ng">Usage:<br/>  kind [command]</span><span id="ab07" class="nc kc it mn b gy nh ne l nf ng">Available Commands:<br/>  build       Build one of [node-image]<br/>  completion  Output shell completion code for the specified shell<br/>  create      Creates one of [cluster]<br/>  delete      Deletes one of [cluster]<br/>  export      Exports one of [kubeconfig, logs]<br/>  get         Gets one of [clusters, nodes, kubeconfig]<br/>  help        Help about any command<br/>  load        Loads images into nodes<br/>  version     Prints the kind CLI version</span></pre><p id="2aec" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在本文中，我们将主要关注<code class="fe mk ml mm mn b">create</code>、<code class="fe mk ml mm mn b">get</code>、<code class="fe mk ml mm mn b">delete</code>命令。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="ad98" class="kb kc it bd kd ke mp kg kh ki mq kk kl km mr ko kp kq ms ks kt ku mt kw kx ky bi translated">创建一个集群</h1><p id="c32b" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">要创建集群，只需执行。</p><p id="a137" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><strong class="lb iu">cmd:</strong>T8】</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="efbf" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kind</strong> create cluster<br/>Creating cluster "kind" ...<br/> ✓ Ensuring node image (kindest/node:v1.18.2) 🖼<br/> ✓ Preparing nodes 📦<br/> ✓ Writing configuration 📜<br/> ✓ Starting control-plane 🕹️<br/> ✓ Installing CNI 🔌<br/> ✓ Installing StorageClass 💾<br/>Set kubectl context to "kind-kind"<br/>You can now use your cluster with:</span><span id="cf71" class="nc kc it mn b gy nh ne l nf ng">kubectl cluster-info --context kind-kind</span><span id="a30b" class="nc kc it mn b gy nh ne l nf ng">Have a nice day! 👋</span></pre><p id="d252" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">这将通过拉最新的kubernetes节点(1.18.2版)来创建kubernetes集群，因此我们创建了1.18.2版的kubernetes集群。</p><p id="166a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">如果我们在创建集群时没有传递<code class="fe mk ml mm mn b">--name</code>参数，那么集群名称默认设置为<code class="fe mk ml mm mn b">kind</code></p><h1 id="1dcb" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">创建特定版本的k8s集群</h1><p id="b40e" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我们可以通过<code class="fe mk ml mm mn b">--image</code>参数来部署特定版本的k8s集群。</p><p id="8796" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><strong class="lb iu">命令:</strong>T12】</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="770a" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kind</strong> create cluster --image kindest/node:v1.15.6 --name kind-1.15.6<br/>Creating cluster "kind" ...<br/> ✓ Ensuring node image (kindest/node:v1.15.6) 🖼<br/> ✓ Preparing nodes 📦<br/> ✓ Writing configuration 📜<br/> ✓ Starting control-plane 🕹️<br/> ✓ Installing CNI 🔌<br/> ✓ Installing StorageClass 💾<br/>Set kubectl context to "kind-kind"<br/>You can now use your cluster with:</span><span id="229d" class="nc kc it mn b gy nh ne l nf ng">kubectl cluster-info --context kind-kind</span><span id="22ca" class="nc kc it mn b gy nh ne l nf ng">Have a nice day! 👋</span></pre><p id="9e05" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">所有支持的k8s版本标签列表可以在<a class="ae lx" href="https://hub.docker.com/r/kindest/node/tags" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="ad75" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">列出已部署的集群</h1><p id="27be" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="lb iu">命令:</strong>T13】</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="79de" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kind</strong> get clusters<br/>kind<br/>kind-1.15.6</span></pre><p id="379b" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">这应该会列出自从我们为两个不同的k8s版本执行<code class="fe mk ml mm mn b">kind create cluster</code>以来创建的两个集群。</p><h1 id="f369" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">为kubectl设置上下文</h1><p id="243b" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">创建集群后<code class="fe mk ml mm mn b">kubectl</code>将始终指向最近创建的k8s集群。</p><p id="c41a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">让我们检查所有可用的上下文。</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="d76a" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kubectl </strong>config get-contexts<strong class="mn iu"><br/></strong>CURRENT   NAME                               CLUSTER                      <br/>          kind-kind                          kind-kind            <br/>*         kind-kind-1.15.6                   kind-kind-1.15.6     </span></pre><p id="1ad6" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">从输出中，我们可以推断出<code class="fe mk ml mm mn b">kubectl</code>上下文当前已经被设置为最新的集群，即<code class="fe mk ml mm mn b">kind-1.15.6</code></p><p id="41aa" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">上下文名称以<code class="fe mk ml mm mn b">kind</code>为前缀</p><p id="e3fc" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">要将<code class="fe mk ml mm mn b">kubectl</code>上下文设置为<code class="fe mk ml mm mn b">kind</code>集群(即最新的1.18.2版),我们需要</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="1226" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kubectl</strong> config set-context kind-kind <br/>Context "kind-kind" modified.</span></pre><p id="0c7f" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">为了验证<code class="fe mk ml mm mn b">kubectl</code>指向正确的集群，让我们检查节点。</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="e6b5" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kubectl</strong> get nodes<br/>NAME                        STATUS   ROLES    AGE     VERSION<br/>kind-1.18.2-control-plane   Ready    master   8m20s   v1.18.2</span></pre><h1 id="2f6f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">删除集群</h1><p id="2229" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">要删除特定的集群，可以将集群名称传递给<code class="fe mk ml mm mn b">--name</code>参数中的<code class="fe mk ml mm mn b">delete</code>命令。</p><p id="9474" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><strong class="lb iu">cmd:</strong>T8】</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="0146" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kind</strong> delete cluster --name kind<br/>Deleting cluster "kind" ...</span></pre><h1 id="86b5" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">删除所有集群</h1><p id="0c8e" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">如果我们想一次性删除所有集群，请执行</p><p id="634d" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><strong class="lb iu">cmd:</strong>T9】</p><pre class="mu mv mw mx gt my mn mz na aw nb bi"><span id="c6c4" class="nc kc it mn b gy nd ne l nf ng">&gt; <strong class="mn iu">kind</strong> delete clusters --all<br/>Deleted clusters: ["kind-1.15.6"]</span></pre><h1 id="3a62" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">为什么善良？</h1><ul class=""><li id="704d" class="ni nj it lb b lc ld lg lh lk nk lo nl ls nm lw nn no np nq bi translated">kind支持多节点(包括高可用性)集群</li><li id="f502" class="ni nj it lb b lc nr lg ns lk nt lo nu ls nv lw nn no np nq bi translated">kind支持Linux、macOS和Windows</li><li id="d593" class="ni nj it lb b lc nr lg ns lk nt lo nu ls nv lw nn no np nq bi translated">kind是CNCF认证的符合Kubernetes安装程序</li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Good separation: HTML5 data attributes to generalise JavaScript modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">良好的分离:HTML5数据属性概括了JavaScript模块</h1>
<blockquote>原文：<a href="https://itnext.io/good-separation-html5-data-attributes-to-generalise-javascript-modules-cac36a13cb72?source=collection_archive---------2-----------------------#2018-07-09">https://itnext.io/good-separation-html5-data-attributes-to-generalise-javascript-modules-cac36a13cb72?source=collection_archive---------2-----------------------#2018-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/11ae197927223bc42f603221e54af850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxr8lDLVWcCwEJ4ReV3LsA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分离和连接</figcaption></figure><p id="4f21" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您正在编写JavaScript来处理现有的HTML，您可以有效地利用<a class="ae la" href="https://www.w3schools.com/tags/att_global_data.asp" rel="noopener ugc nofollow" target="_blank"> HTML5 </a> <code class="fe lb lc ld le b"><a class="ae la" href="https://www.w3schools.com/tags/att_global_data.asp" rel="noopener ugc nofollow" target="_blank">data</a></code> <a class="ae la" href="https://www.w3schools.com/tags/att_global_data.asp" rel="noopener ugc nofollow" target="_blank">属性</a>来使您的代码通用化；也就是说，不是为HTML唯一部分编写的。</p><p id="72de" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有许多公共库使用这种技术，并真正展示了拥有通用代码的价值，这些代码的行为可以由HTML定制。我最喜欢的例子是<a class="ae la" href="http://parsleyjs.org/" rel="noopener ugc nofollow" target="_blank">欧芹</a>，一个表单验证库，它在你的HTML表单上初始化，并从<code class="fe lb lc ld le b">data</code>属性中获取所有的配置和行为。</p><p id="9976" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，快速回顾一下什么是<code class="fe lb lc ld le b">data</code>属性。HTML5允许您向任何元素添加以<code class="fe lb lc ld le b">data-</code>开头的属性，这实质上允许您指定定制的但仍然有效的属性。例如:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="2503" class="ln lo iq le b gy lp lq l lr ls">&lt;div id="mydiv" data-info="some info about this div"&gt;...&lt;/div&gt;</span></pre><p id="efc7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这很有用，因为页面上的任何JavaScript都可以从中提取信息<em class="lt">，或者将信息<em class="lt">存储在这些标签的</em>中。这允许HTML作者指定信息，通用JavaScript库可以使用这些信息来确定如何在该页面上表现。</em></p><p id="8723" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们做几个实际例子来看看这一点。</p><h1 id="f658" class="lu lo iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">控制文本突出显示的方式</h1><p id="ef22" class="pw-post-body-paragraph kc kd iq ke b kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz ij bi translated">假设我们想要一个非常简单的JavaScript库，当你将鼠标悬停在文本块上时，它可以高亮显示文本块，并且我们想要文本块告诉我们要高亮显示什么颜色。</p><p id="ffa6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">也许这在CMS中很有用，我们希望内容作者可以控制高亮颜色。或者可能文本的颜色来自数据库，我们无法提前知道它以将其包含在我们的CSS中。</p><p id="6b02" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们的HTML可能是这样的:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="549e" class="ln lo iq le b gy lp lq l lr ls">&lt;div class="highlightable" <br/>     data-highlight="#ff0000"&gt;<br/>        Highlight this text<br/>&lt;/div&gt;</span></pre><p id="85f7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们的第一步是想出一个可以读取<code class="fe lb lc ld le b">data-highlight</code>属性并适当设置<code class="fe lb lc ld le b">div</code>背景的函数。大概是这样的:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="c62f" class="ln lo iq le b gy lp lq l lr ls">function(element) {<br/>  var jqel = $(element);<br/>  var colour = jqel.attr("data-highlight");<br/>  jqel.css("background-color", color);<br/>}</span></pre><p id="fe26" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这需要一个DOM元素，并使用jQuery首先提取<code class="fe lb lc ld le b">data-attribute</code>的值，然后将其设置为CSS中的<code class="fe lb lc ld le b">background-color</code>。</p><p id="42f2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们立即将它包装在一个jQuery事件处理程序中，这样我们就可以看到它的运行:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="41f4" class="ln lo iq le b gy lp lq l lr ls">$(".highlightable").on("hover", function() {<br/>  var jqel = $(this);<br/>  var colour = jqel.attr("data-highlight");<br/>  jqel.css("background-color", color);<br/>});</span></pre><p id="c075" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们用类<code class="fe lb lc ld le b">highlightable</code>将<strong class="ke ir">悬停</strong>事件绑定到页面中的元素，并使用jQuery提供的<code class="fe lb lc ld le b">this</code>替换了<code class="fe lb lc ld le b">element</code>的显式传递。</p><p id="a59c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你实现了这一点，当你悬停在它上面时，你会立即看到元素改变了颜色，但当你再次移开鼠标时不会；它会一直高亮显示。</p><p id="558c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这给了我们一个使用属性在元素中存储数据的借口。</p><p id="6b83" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将通过使用jQuery的快捷方式将事件处理程序绑定到<code class="fe lb lc ld le b">mouseenter</code>和<code class="fe lb lc ld le b">mouseleave</code>事件来实现这一点:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="645b" class="ln lo iq le b gy lp lq l lr ls">$(".highlightable").on("hover", <br/>  function() {<br/>    // function for mouseenter<br/>  },<br/>  function() {<br/>    // function for mouseleave<br/>  }<br/>});</span></pre><p id="a3a5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第一个函数在鼠标进入元素区域时运行，第二个函数在鼠标离开元素区域时运行。</p><p id="d889" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们增加了设置高光的功能，以记录元素的原始颜色:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="1f73" class="ln lo iq le b gy lp lq l lr ls">$(".highlightable").on("hover", <br/>  function() {<br/>    var jqel = $(this);</span><span id="09dd" class="ln lo iq le b gy mw lq l lr ls">    var originalColour = jqel.css("background-color");<br/>    jqel.attr("data-original", originalColour);</span><span id="1472" class="ln lo iq le b gy mw lq l lr ls">    var highlightColour = jqel.attr("data-highlight");<br/>    jqel.css("background-color", highlightColour);<br/>  },<br/>  function() {<br/>    // function for mouseleave<br/>  }<br/>});</span></pre><p id="4c7c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当第一个函数运行时，它将首先从元素的CSS中提取当前颜色，并将其存储在<code class="fe lb lc ld le b">data-original</code>下的元素中，然后继续设置高光。在DOM中，我们的<code class="fe lb lc ld le b">div</code>现在看起来像这样:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="8f72" class="ln lo iq le b gy lp lq l lr ls">&lt;div class="highlightable" <br/>     data-highlight="#ff0000"<br/>     data-original="#ffffff"<br/>     style="background-color: #ff0000"&gt;<br/>        Highlight this text<br/>&lt;/div&gt;</span></pre><p id="cb72" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了处理<code class="fe lb lc ld le b">mouseleave</code>事件，我们需要做的就是反转这个过程:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="dc3d" class="ln lo iq le b gy lp lq l lr ls">$(".highlightable").on("hover", <br/>  function() {<br/>    var jqel = $(this);</span><span id="e79a" class="ln lo iq le b gy mw lq l lr ls">    var originalColour = jqel.css("background-color");<br/>    jqel.attr("data-original", originalColour);</span><span id="385b" class="ln lo iq le b gy mw lq l lr ls">    var highlightColour = jqel.attr("data-highlight");<br/>    jqel.css("background-color", highlightColour);<br/>  },<br/>  function() {<br/>    var jqel = $(this);<br/>    var originalColor = jqel.attr("data-original")<br/>    jqel.css("background-color", originalColour);<br/>  }<br/>});</span></pre><p id="11eb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们现在已经扩展了我们的第二个函数来读回<code class="fe lb lc ld le b">data-original</code>的值，并将CSS恢复到原来的颜色。</p><h1 id="c924" class="lu lo iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">显示和隐藏页面部分</h1><p id="f489" class="pw-post-body-paragraph kc kd iq ke b kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz ij bi translated">让我们做一个稍微复杂一点的工作示例，它来自您最终必然会遇到的真实世界用例:基于按钮点击显示和隐藏页面部分。</p><p id="9dd2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将首先想象一下，允许我们这样做的HTML看起来会是什么样子。类似于:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="029b" class="ln lo iq le b gy lp lq l lr ls">&lt;a href="#" <br/>  data-blink="controller" <br/>  data-blink-controls="my-content"<br/>  data-blink-init="hidden"&gt;<br/>    Show<br/>&lt;/a&gt;</span><span id="25e7" class="ln lo iq le b gy mw lq l lr ls">&lt;div data-blink="container" data-blink-id="my-content"&gt;<br/>  This content can be shown and hidden.<br/>&lt;/div&gt;</span></pre><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/1f3da7007e9dee9432446857541953f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*dPtB0BXkpySC7K3LPAUpUw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">上面的HTML在你的浏览器中是什么样子</figcaption></figure><p id="0870" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先要注意的是，我们已经开始将单词<code class="fe lb lc ld le b">blink</code>包含到我们的数据属性中。这样做的原因是为了给我们的通用应用程序提供一个名称空间，我们称之为“blink”。这意味着如果页面上有其他库的其他数据属性，我们可以避免应用程序意外地被它们绊倒。这是值得遵循的一般良好实践。</p><p id="104b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里我们定义了一个锚标签，它有三个属性，都是我们的应用程序特有的(也就是说，它们不是HTML的特殊特性):</p><ul class=""><li id="4dfb" class="my mz iq ke b kf kg kj kk kn na kr nb kv nc kz nd ne nf ng bi translated"><strong class="ke ir">data-blink = " controller "</strong>—这告诉我们，锚标签是我们的应用程序将称为“控制器”的东西，也就是说，它将控制显示/隐藏</li><li id="2f01" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated"><strong class="ke ir">data-blink-controls = " my-content "</strong>—这告诉我们链接将显示/隐藏的内容的id</li><li id="c856" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated"><strong class="ke ir">data-blink-init = " hidden "</strong>—这告诉我们最初应该隐藏内容</li></ul><p id="4a94" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后我们有一个<code class="fe lb lc ld le b">div</code>,它也有一些属性</p><ul class=""><li id="297c" class="my mz iq ke b kf kg kj kk kn na kr nb kv nc kz nd ne nf ng bi translated"><strong class="ke ir"> data-blink="container" </strong> —这告诉我们这是我们想要显示/隐藏的内容的容器</li><li id="ede0" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated"><strong class="ke ir">data-blink-id = " my-content "</strong>—这给了容器一个id，我们可以通过它找到容器。</li></ul><p id="c702" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们想要的行为是，当你点击“显示”链接，然后相关的容器将出现，链接将被“隐藏”所取代。然后，当你点击“隐藏”相关的容器将消失，链接将再次显示“显示”。</p><p id="47d6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们一步一步地构建这个代码。在这篇文章的最后是完整的功能代码片段。</p><p id="2cfc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，为页面上的代码建立框架:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="bb1b" class="ln lo iq le b gy lp lq l lr ls">&lt;script type="application/javascript"&gt;<br/>    function <em class="lt">init</em>() {<br/>        // implementation will go here<br/>    }<br/><br/>    jQuery(document).ready(function($) {<br/>        <em class="lt">init</em>();<br/>    });<br/>&lt;/script&gt;</span></pre><p id="f03e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们将实现<code class="fe lb lc ld le b">init</code>函数，它将分两部分工作:</p><ol class=""><li id="c96c" class="my mz iq ke b kf kg kj kk kn na kr nb kv nc kz nm ne nf ng bi translated">将页面设置为初始状态</li><li id="d552" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nm ne nf ng bi translated">添加事件处理程序来显示/隐藏容器</li></ol><p id="ea8c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是实现初始状态设置的代码块:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="6188" class="ln lo iq le b gy lp lq l lr ls">function <em class="lt">init</em>() {<br/>    var controllers = <em class="lt">$</em>("[data-blink=controller]");<br/>    for (var i = 0; i &lt; controllers.length; i++) {<br/>        var controller = <em class="lt">$</em>(controllers[i]);<br/>        var id = controller.attr("data-blink-controls");<br/>        var initialState = controller.attr("data-blink-init");<br/>        var container = <em class="lt">$</em>("[data-blink-id=" + id + "]");<br/>        if (initialState === "hidden") {<br/>            container.hide();<br/>        } else if (initialState === "shown") {<br/>            container.show();<br/>        }<br/>    }<br/>}</span></pre><p id="3c38" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">更详细地解释一下:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="49eb" class="ln lo iq le b gy lp lq l lr ls">var controllers = <em class="lt">$</em>("[data-blink=controller]");<br/>for (var i = 0; i &lt; controllers.length; i++) {<br/>    var controller = <em class="lt">$</em>(controllers[i]);</span></pre><p id="c805" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通过使用基于属性的选择器，它可以找到所有声明自己是应用程序的“控制器”的页面元素。然后我们遍历每个控制器，在这个例子中我用for循环部分是为了显式，部分是因为我是老式的。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="f204" class="ln lo iq le b gy lp lq l lr ls">var id = controller.attr("data-blink-controls");<br/>var initialState = controller.attr("data-blink-init");</span></pre><p id="4092" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它读取数据属性以获取该元素控制的容器的id，并找出我们希望该容器的初始状态。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="834d" class="ln lo iq le b gy lp lq l lr ls">var container = $("[data-blink-id=" + id + "]");<br/>if (initialState === "hidden") {<br/>  container.hide();<br/>} else if (initialState === "shown") {<br/>  container.show();<br/>}</span></pre><p id="f511" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我们获得容器的句柄，并根据所需的初始状态显示或隐藏它。</p><p id="9694" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，我们需要将一个事件处理程序绑定到我们的控制器，它将触发显示或隐藏机制。同样，这里是全文，然后我们将更详细地浏览:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="7b02" class="ln lo iq le b gy lp lq l lr ls">function <em class="lt">init</em>() {<br/>    var controllers = <em class="lt">$</em>("[data-blink=controller]");<br/>    <br/>    // ... init code from above<br/><em class="lt"><br/>    </em>controllers.on("click", function() {<br/>        var controller = <em class="lt">$</em>(this);<br/><em class="lt"><br/>        </em>var id = controller.attr("data-blink-controls");<br/>        var state = controller.attr("data-blink-state");<br/>        var initialState = controller.attr("data-blink-init");<br/><em class="lt"><br/>        </em>if (state === undefined) {<br/>            state = initialState;<br/>        }<br/><em class="lt"><br/>        </em>var newState = state === "hidden" ? "shown" : "hidden";<br/><em class="lt"><br/>        </em>var container = <em class="lt">$</em>("[data-blink-id=" + id + "]");<em class="lt"><br/>        </em>if (newState === "hidden") {<br/>            container.hide();<br/>            controller.html("Show");<br/>        } else if (newState === "shown") {<br/>            container.show();<br/>            controller.html("Hide");<br/>        }<br/><em class="lt"><br/>        </em>controller.attr("data-blink-state", newState);<br/>    });<br/>}</span></pre><p id="fd48" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">关注这个<code class="fe lb lc ld le b">init</code>功能的新部分，然后:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="5135" class="ln lo iq le b gy lp lq l lr ls">controllers.on("click", function() {<br/>    var controller = <em class="lt">$</em>(this);</span></pre><p id="547a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在<strong class="ke ir"> click </strong>事件上绑定一个函数，从jQuery的<code class="fe lb lc ld le b">this</code>引用中获取控制器的句柄。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="d6ea" class="ln lo iq le b gy lp lq l lr ls">var id = controller.attr("data-blink-controls");<br/>var state = controller.attr("data-blink-state");<br/>var initialState = controller.attr("data-blink-init");</span></pre><p id="9086" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从控制器中提取我们想要的三个属性:</p><ul class=""><li id="425d" class="my mz iq ke b kf kg kj kk kn na kr nb kv nc kz nd ne nf ng bi translated">控制器控制的容器的id</li><li id="b0dd" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated">容器的当前状态(注意这可能还没有设置)</li><li id="d1b4" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated">容器的初始状态(如果没有设置当前状态，我们可能会使用它)</li></ul><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="eb44" class="ln lo iq le b gy lp lq l lr ls">if (state === undefined) {<br/>    state = initialState;<br/>}</span></pre><p id="ed26" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果未设置，则默认状态为初始状态</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="47f1" class="ln lo iq le b gy lp lq l lr ls">var newState = state === "hidden" ? "shown" : "hidden";</span></pre><p id="76b0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">确定新的状态是什么；以此为借口，使用<a class="ae la" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator" rel="noopener ugc nofollow" target="_blank">三元运算符</a>而不是更长形式的if/else，将状态从一个翻转到另一个。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="60dd" class="ln lo iq le b gy lp lq l lr ls">var container = <em class="lt">$</em>("[data-blink-id=" + id + "]");<br/>if (newState === "hidden") {<br/>    container.hide();<br/>    controller.html("Show");<br/>} else if (newState === "shown") {<br/>    container.show();<br/>    controller.html("Hide");<br/>}</span></pre><p id="9611" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">获取对容器的引用，然后做两件事:</p><ul class=""><li id="821b" class="my mz iq ke b kf kg kj kk kn na kr nb kv nc kz nd ne nf ng bi translated">将可见性设置为“显示”或“隐藏”</li><li id="f1dc" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated">更新控制器的文本，使其显示适当的动作词。也就是说，如果控制器是隐藏的，让链接显示“显示”，如果是显示的，让链接显示“隐藏”。</li></ul><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="375f" class="ln lo iq le b gy lp lq l lr ls">controller.attr("data-blink-state", newState);</span></pre><p id="d6f1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我们设置或更新控制器上的<code class="fe lb lc ld le b">data-blink-state</code>属性，这样我们就知道容器处于什么状态，以备将来参考。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/da1d06409cd1edcddd142474d7881e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*69ZIV8E_tDn2N24sw8VJYg.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我们完全实现的使用数据属性的显示/隐藏功能</figcaption></figure></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="530b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们已经看到了如何利用HTML5数据属性实现一些小特性。这些特性都不是革命性的，当然，如果没有这些属性，您可以用不同的方式实现它们。不过，我希望您已经感受到了这种方法的威力。它不仅为您提供了一种实现特性的简洁方式，还允许您编写通用特性，这些特性可以被不需要理解代码本身如何工作的HTML作者所利用。</p><p id="c9bf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="lt">理查德是</em> <a class="ae la" href="https://cottagelabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="lt">山寨实验室</em> </a> <em class="lt">的创始人和高级合伙人，这是一家专注于数据生命周期所有方面的软件开发咨询公司。他偶尔会在推特上发</em><a class="ae la" href="https://twitter.com/richard_d_jones" rel="noopener ugc nofollow" target="_blank"><em class="lt">@ Richard _ d _ Jones</em></a></p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="4c50" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">PS —这是完整的显示/隐藏脚本，供您开始使用:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="eedb" class="ln lo iq le b gy lp lq l lr ls">&lt;a href="#"<br/>   data-blink="controller"<br/>   data-blink-controls="my-content"<br/>   data-blink-init="hidden"&gt;<br/>    Show<br/>&lt;/a&gt;<br/>&lt;div data-blink="container" data-blink-id="my-content"&gt;<br/>    This content can be shown and hidden.<br/>&lt;/div&gt;<br/><br/>&lt;script type="text/javascript" src="jquery.min.js"&gt;&lt;/script&gt;<br/><br/>&lt;script type="application/javascript"&gt;<br/>    function <em class="lt">init</em>() {<br/>        var controllers = <em class="lt">$</em>("[data-blink=controller]");<br/>        for (var i = 0; i &lt; controllers.length; i++) {<br/>            var controller = <em class="lt">$</em>(controllers[i]);<br/>            var id = controller.attr("data-blink-controls");<br/>            var initialState = controller.attr("data-blink-init");<br/>            var container = <em class="lt">$</em>("[data-blink-id=" + id + "]");<br/>            if (initialState === "hidden") {<br/>                container.hide();<br/>            } else if (initialState === "shown") {<br/>                container.show();<br/>            }<br/>        }<br/>        <br/>        controllers.on("click", function() {<br/>            var controller = <em class="lt">$</em>(this);<br/>            <br/>            var id = controller.attr("data-blink-controls");<br/>            var state = controller.attr("data-blink-state");<br/>            var initialState = controller.attr("data-blink-init");<br/>            <br/>            if (state === undefined) {<br/>                state = initialState;<br/>            }<br/>            <br/>            var newState = state === "hidden" ? "shown" : "hidden";<br/>            <br/>            var container = <em class="lt">$</em>("[data-blink-id=" + id + "]");<br/>            <br/>            if (newState === "hidden") {<br/>                container.hide();<br/>                controller.html("Show");<br/>            } else if (newState === "shown") {<br/>                container.show();<br/>                controller.html("Hide");<br/>            }<br/>            <br/>            controller.attr("data-blink-state", newState);<br/>        });<br/>    }<br/><br/>    jQuery(document).ready(function($) {<br/>        <em class="lt">init</em>();<br/>    });<br/>&lt;/script&gt;</span></pre></div></div>    
</body>
</html>
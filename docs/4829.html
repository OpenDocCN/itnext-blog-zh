<html>
<head>
<title>Builder Design Pattern in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中的构建器设计模式</h1>
<blockquote>原文：<a href="https://itnext.io/builder-design-pattern-in-swift-2de3f7cdc357?source=collection_archive---------4-----------------------#2020-09-28">https://itnext.io/builder-design-pattern-in-swift-2de3f7cdc357?source=collection_archive---------4-----------------------#2020-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="30cb" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">如何在Swift中使用Build设计模式？</h2><div class=""/><div class=""><h2 id="a641" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">在Swift中使用构建器模式</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/0e0576bf6dc21dd1fc6afcd9d185132f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*2lJOOfoDSp4KYdLv.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">在Swift中实施生成器设计模式</figcaption></figure><p id="a886" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi lw translated">作为一名开发人员，我们应该始终遵循一个设计原则，作为构建代码的指南，使其模块化、易于阅读、易于理解和可伸缩。在本文中，我将讨论行为设计模式，如何使用它们，以及它们在Swift中的实现。请继续阅读！</p><h1 id="b0f5" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">设计模式的分类</h1><p id="77af" class="pw-post-body-paragraph la lb iq lc b ld mx ka lf lg my kd li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">设计模式主要分为以下几类</p><h1 id="d428" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">1.创造型的</h1><h1 id="9863" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">2.结构的</h1><h1 id="b130" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">3.行为的</h1><p id="5faa" class="pw-post-body-paragraph la lb iq lc b ld mx ka lf lg my kd li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">在本文中，我们将介绍生成器设计器模式，这是一种创造性的设计模式</p><h1 id="bc4f" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">生成器设计模式</h1><h2 id="c8c0" class="nc mg iq bd mh nd ne dn ml nf ng dp mp lj nh ni mr ln nj nk mt lr nl nm mv iw bi translated">为什么？</h2><p id="a516" class="pw-post-body-paragraph la lb iq lc b ld mx ka lf lg my kd li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">我们为类创建对象来利用类提供的功能。有时对象创建很简单，可以通过简单的初始化器来完成。其他对象可能有复杂的需求，例如，它可能需要大量的参数来初始化对象，这在我看来太麻烦了，而且没有效率。此外，我们可能需要混合和匹配这些参数进行初始化。在这些情况下，我们应该进行分段初始化/构造。为了实现这一点，我们需要一个实现为我们提供一步一步的机制，这样我们就有一个更简单的API方法来访问对象创建版本的粒度控制。</p><p id="8d18" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">我们举个例子来了解一下。假设我们想为recipe应用程序创建一个对象APIRequest类。这个类帮助我们创建请求对象来发出不同的API请求。首先，当前的API请求类帮助我们创建只有两个参数的对象。</p><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="b6f6" class="nc mg iq no b gy ns nt l nu nv"><strong class="no ja">enum</strong> Endpoint:String {</span><span id="233f" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">case</strong> receipesUrl = "/recipes"</span><span id="1764" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">case</strong> receipeDetail = "/recipes/id"</span><span id="aba7" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="c080" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">class</strong> ApiRequest {</span><span id="aede" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> endpoint:Endpoint</span><span id="11f7" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">init</strong>(endPoint:Endpoint) {</span><span id="5da9" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.endpoint = endPoint</span><span id="6001" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="0712" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="feb0" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> apiRequest = ApiRequest(endPoint: .receipesUrl)</span></pre><p id="2edf" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">现在假设您想在Http方法(POST、GET等)、头、URL参数等中传递它。假设我们给我们的初始化式增加了更多的参数，看起来像这样。</p><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="0233" class="nc mg iq no b gy ns nt l nu nv"><strong class="no ja">enum</strong> HTTPMethod:String {</span><span id="d053" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">case</strong> get = "GET"</span><span id="6bc5" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">case</strong> post = "POST"</span><span id="1d55" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="b4f2" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">enum</strong> Endpoint:String {</span><span id="a64c" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">case</strong> receipesUrl = "/recepies"</span><span id="2683" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">case</strong> receipeDetail = "/recepies/id"</span><span id="fca9" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="1da5" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">class</strong> ApiRequest {</span><span id="e888" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> endpoint:Endpoint</span><span id="3fb7" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> urlParams:[String:String]</span><span id="875f" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> httpMethod:HTTPMethod</span><span id="8d64" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> headers:[String:String]</span><span id="45e7" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">init</strong>(endPoint:Endpoint, httpMethod:HTTPMethod, headers:[String:String], urlParams:[String:String]) {</span><span id="819c" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.endpoint = endPoint</span><span id="4898" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.httpMethod = httpMethod</span><span id="51da" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.headers = headers</span><span id="b643" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.urlParams = urlParams</span><span id="b602" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="67e8" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="e3f8" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> apiRequest = ApiRequest(endPoint: .receipesUrl, httpMethod: .get, headers: [:],urlParams: [:])</span></pre><p id="28e0" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">正如你现在看到的，我们的初始化器已经开始成长了。我们仍然需要添加更多的参数，如搜索参数、HTTP方案(HTTP或HTTPS)、路径参数、有效载荷、过滤器等。有了这么多的参数，这将变得非常难看，而且我们还必须为初始化传递不同的参数，这可能是我们不需要的。我们可以有一个缺省值，或者让一些参数可选，但仍然是不理想的。</p><h1 id="183d" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">解决办法</h1><p id="417a" class="pw-post-body-paragraph la lb iq lc b ld mx ka lf lg my kd li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">所以在这种情况下，builder设计模式真的大放异彩。生成器设计模式对于创建需要各种配置选项的对象非常有用。它不仅为我们提供了一个很好的API方式，还让我们可以控制我们想要的异议创建风格。所以基本上我们将有一个函数来通过函数传递不同的参数，每个函数将返回<strong class="lc ja"> ApiRequestBuilder </strong>类型。</p><h2 id="28eb" class="nc mg iq bd mh nd ne dn ml nf ng dp mp lj nh ni mr ln nj nk mt lr nl nm mv iw bi translated">例子</h2><p id="dd6c" class="pw-post-body-paragraph la lb iq lc b ld mx ka lf lg my kd li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">现在让我们使用构建器模式实现上面的例子</p><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="2c3f" class="nc mg iq no b gy ns nt l nu nv"><strong class="no ja">class</strong> ApiRequestBuilder {</span><span id="a8cf" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> httpMethod:HTTPMethod</span><span id="642b" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> endpoint: Endpoint</span><span id="771b" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> urlParams:[String:String]?</span><span id="f32c" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> headers:[String:String]?</span><span id="c8cd" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">init</strong>(endpoint:Endpoint, httpMethod:HTTPMethod) {</span><span id="1a64" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.endpoint = endpoint</span><span id="a2f4" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.httpMethod = httpMethod</span><span id="2491" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="ed4b" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> urlParams(urlParams:[String:String]?) -&gt; ApiRequestBuilder {</span><span id="947d" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.urlParams = urlParams</span><span id="7f49" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="d575" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="6b73" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> headers(headers:[String:String]?) -&gt; ApiRequestBuilder {</span><span id="de47" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.headers = headers</span><span id="d447" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="6eb5" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="b522" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="ec98" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">let</strong> apiRequest = ApiRequestBuilder(endpoint: .receipesUrl, httpMethod: .get)</span><span id="f954" class="nc mg iq no b gy nw nt l nu nv">.headers(headers: ["clientId":"xyz"])</span><span id="9098" class="nc mg iq no b gy nw nt l nu nv">.urlParams(urlParams: ["id":"abc"])</span></pre><p id="c28a" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">比方说，如果我们想增加对额外参数的支持，我们可以很容易地扩展我们的API。我们现在将添加对传递搜索、有效载荷、过滤器等的支持。</p><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="ca81" class="nc mg iq no b gy ns nt l nu nv"><strong class="no ja">class</strong> ApiRequestBuilder {</span><span id="aaa1" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> httpMethod:HTTPMethod</span><span id="a1c8" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> endpoint:Endpoint</span><span id="2540" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> urlParams:[String:String]?</span><span id="658b" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> headers:[String:String]?</span><span id="9630" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> payload:[String:<strong class="no ja">Any</strong>]?</span><span id="d6db" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> filters:[String:String]?</span><span id="1174" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">var</strong> searchBy:[String:String]?</span><span id="49ac" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">init</strong>(endpoint:Endpoint, httpMethod:HTTPMethod) {</span><span id="f465" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.endpoint = endpoint</span><span id="6ffa" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.httpMethod = httpMethod</span><span id="7363" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="a50d" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> urlParams(urlParams:[String:String]?) -&gt; ApiRequestBuilder {</span><span id="e8c9" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.urlParams = urlParams</span><span id="8106" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="90b8" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="6341" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> headers(headers:[String:String]) -&gt; ApiRequestBuilder {</span><span id="4354" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.headers = headers</span><span id="2080" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="776f" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="cdc8" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> payload(payload:[String:<strong class="no ja">Any</strong>]) -&gt;ApiRequestBuilder {</span><span id="2dd3" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.payload = payload</span><span id="3705" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="adfe" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="20b1" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> filters(filters:[String:String]) -&gt;ApiRequestBuilder {</span><span id="3dab" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.filters = filters</span><span id="c12e" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="b195" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="abf9" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">func</strong> searchBy(searchBy:[String:String]) -&gt;ApiRequestBuilder {</span><span id="b7fc" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">self</strong>.searchBy = searchBy</span><span id="21b7" class="nc mg iq no b gy nw nt l nu nv"><strong class="no ja">return</strong> <strong class="no ja">self</strong></span><span id="d703" class="nc mg iq no b gy nw nt l nu nv">}</span><span id="41dc" class="nc mg iq no b gy nw nt l nu nv">}</span></pre><p id="43bf" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">现在，假设我们想要发出一个请求来获取一个食谱列表。我们将以这种简单的方式提出我们的请求</p><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="c4d8" class="nc mg iq no b gy ns nt l nu nv"><strong class="no ja">let</strong> apiRequest = ApiRequestBuilder(endpoint: .receipesUrl, httpMethod: .get)</span><span id="a4f2" class="nc mg iq no b gy nw nt l nu nv">.headers(headers: ["clientId":"xyz"])</span><span id="61f9" class="nc mg iq no b gy nw nt l nu nv">.urlParams(urlParams: ["id":"abc"])</span></pre><p id="984f" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">为了得到精确的结果，让我们添加过滤器和搜索</p><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="15c3" class="nc mg iq no b gy ns nt l nu nv"><strong class="no ja">let</strong> apiRequest = ApiRequestBuilder(endpoint: .receipesUrl, httpMethod: .get)</span><span id="3717" class="nc mg iq no b gy nw nt l nu nv">.headers(headers: ["clientId":"xyz"])</span><span id="457e" class="nc mg iq no b gy nw nt l nu nv">.urlParams(urlParams: ["id":"abc"])</span><span id="aebc" class="nc mg iq no b gy nw nt l nu nv">.filters(filters: ["createdTime &gt;=":"1601261533"])</span><span id="527e" class="nc mg iq no b gy nw nt l nu nv">.searchBy(searchBy: ["name":"pasta"])</span></pre><p id="f782" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">因此，看看我们如何方便地以更易于理解和使用的API形式扩展异议创建。</p><h1 id="4123" class="mf mg iq bd mh mi mj mk ml mm mn mo mp kf mq kg mr ki ms kj mt kl mu km mv mw bi translated">结论</h1><p id="7cb2" class="pw-post-body-paragraph la lb iq lc b ld mx ka lf lg my kd li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">生成器是一种创造性的设计模式，它允许一步一步地创建对象。创建需要各种配置选项的对象非常有用。</p></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="e2e8" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="oe">原载于2020年9月28日</em><a class="ae of" href="https://www.shashankthakur.dev/2020/09/how-to-use-builder-design-pattern-in.html" rel="noopener ugc nofollow" target="_blank"><em class="oe">https://www . shashankthakur . dev</em></a><em class="oe">。</em></p></div></div>    
</body>
</html>
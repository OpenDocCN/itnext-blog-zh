<html>
<head>
<title>How to create an application using the Monzo Bank API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Monzo Bank API创建应用程序</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-create-an-application-using-the-monzo-bank-api-700e90e1f949?source=collection_archive---------2-----------------------#2018-03-11">https://itnext.io/how-to-create-an-application-using-the-monzo-bank-api-700e90e1f949?source=collection_archive---------2-----------------------#2018-03-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/81181fd7bcdd87d7988ea59da2c2f899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BahUOYLechONYZKRcTF0QA.png"/></div></div></figure><div class=""/><p id="eb10" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">监控你的支出是保持你的财务领先的推荐方法之一，由于Monzo等银行创新，这变得非常容易。我们将与Monzo API进行对话，以提取我们的帐户和交易列表。我们不会构建一个单一页面的应用程序，因为这里的重点是通过后端代码演示API访问。</p><p id="b8eb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">过去探索OAuth对我来说很可怕，我相信其他人也会有这种感觉。然而，由于OAuth 2中的一些变化，使用API变得更加简单。这里希望降低进入的门槛，这样你就可以自信地亲自尝试，体验这一领域的成功。肯定会有一个<em class="kw">来回的证书交换</em>，然而之后就一帆风顺了。下图显示了该流程的预期结果:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi kx"><img src="../Images/3520aea480340d5bb1fa69fc9315d830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*8rSB-NUtcIkOxF8TFFCQoQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">申请流程。我们的应用程序请求一个访问令牌，但它没有包含在这个图中，这样我们可以简化事情:)</figcaption></figure><p id="5d15" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">流程可以描述如下:</p><ol class=""><li id="0e5f" class="lg lh jb ka b kb kc kf kg kj li kn lj kr lk kv ll lm ln lo bi translated">用户进入欢迎屏幕</li><li id="2c6e" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">用户点击“登录”按钮</li><li id="0c32" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">用户被引导到Monzo的授权屏幕上</li><li id="5cf9" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">用户输入他们的电子邮件地址并点击“提交”</li><li id="f7fb" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">用户查看他们的电子邮件并点击“登录Monzo”链接</li><li id="b1e4" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">用户被重定向回我们的应用程序，显示他们的Monzo帐户</li><li id="b745" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">用户点击账户，将他们引导到属于该特定账户的所有交易的页面</li></ol><h1 id="6040" class="lu lv jb bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">为我们的应用程序创建OAuth客户端</h1><p id="bda0" class="pw-post-body-paragraph jy jz jb ka b kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr mw kt ku kv ij bi translated">在我们编写应用程序之前，我们需要在<a class="ae mx" href="https://developers.monzo.com/" rel="noopener ugc nofollow" target="_blank"> Monzo的开发者网站</a>上创建一个OAuth客户端。进入网站，点击“<strong class="ka jc">用你的Monzo账户</strong>登录，进入游乐场。一旦你进去了:</p><ol class=""><li id="0d56" class="lg lh jb ka b kb kc kf kg kj li kn lj kr lk kv ll lm ln lo bi translated">点击右上角主导航上的“<strong class="ka jc">客户端</strong></li><li id="741b" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">点击“<strong class="ka jc">新建OAuth客户端</strong></li><li id="c8f7" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">提供<strong class="ka jc">名称</strong>、<strong class="ka jc">重定向URL</strong>和<strong class="ka jc">描述</strong>。<em class="kw">我们不会担心这个例子中的其他字段。</em></li><li id="9f8a" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">点击<strong class="ka jc">提交</strong>创建您的客户</li></ol><p id="5810" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">执行上述操作后，您将返回到“<strong class="ka jc">管理OAuth客户端</strong>”屏幕，其中列出了您的条目(<em class="kw">如果看不到，请尝试刷新页面</em>)。选择您创建的客户端，并记下<strong class="ka jc">客户端ID </strong>和<strong class="ka jc">客户端密码</strong>。我们将在下一步中需要这些。</p><h1 id="b225" class="lu lv jb bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">开始编码吧！</h1><p id="2483" class="pw-post-body-paragraph jy jz jb ka b kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr mw kt ku kv ij bi translated">我们将与NPM包裹<a class="ae mx" href="https://www.npmjs.com/package/express" rel="noopener ugc nofollow" target="_blank">快递</a>和<a class="ae mx" href="https://www.npmjs.com/package/request" rel="noopener ugc nofollow" target="_blank">请求</a>进行轻松合作。让我们通过在我们的项目目录中运行<code class="fe my mz na nb b">npm i express request --save</code>来安装这些。然后，我们将使用下面的代码片段设置我们的服务器和欢迎页面:</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="5133" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行上面的代码会为我们设置一个欢迎屏幕，其中包含我们的行动要求，以启动流程的其余部分。稍后将填充<strong class="ka jc"> accessToken </strong>变量。这将保存有关当前用户会话的信息。<em class="kw">有一种更安全的方式来处理这个会话，并将这个挑战留给你</em>。现在让我们继续。</p><p id="b02d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击按钮中的<strong class="ka jc">符号，页面将转到Monzo的授权页面，该页面包含查询字符串中的表单字段值。为了让我们成功地从Monzo重定向，我们需要定义一个端点来接受用户重定向到我们的应用程序时发送给我们的授权码。在<code class="fe my mz na nb b">app.listen(3000);</code>之前让我们来看看:</strong></p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="fb78" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的端点是根据创建OAuth客户机时设置的重定向url命名的。成功重定向后，Monzo将发送关键字'<strong class="ka jc">代码</strong>'和'<strong class="ka jc">状态</strong>'的查询字符串值。我们将在下面的请求中使用'<strong class="ka jc">代码</strong>'来检索访问令牌。这将持续几个小时。然后，我们将这个访问令牌持久化到我们之前创建的<strong class="ka jc"> accessToken </strong>变量中。我们还会将用户重定向到<strong class="ka jc">/账户</strong>屏幕。让我们现在创建这个。</p><h1 id="e403" class="lu lv jb bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">从用户帐户中检索信息</h1><p id="7f0e" class="pw-post-body-paragraph jy jz jb ka b kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr mw kt ku kv ij bi translated">现在我们有了令牌，可以列出帐户了:</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="1dbb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将显示一个无序的帐户信息列表，并带有一个查看所选帐户交易历史的链接。这将要求我们的最后一个端点获取并显示该事务信息:</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="baa3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">金额以便士的形式返回，因此需要如代码片段所示的格式。完整的解决方案可在找到。下面可以看到一个演示:</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="ne nd l"/></div></figure><h1 id="7dca" class="lu lv jb bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">结论</h1><p id="06ca" class="pw-post-body-paragraph jy jz jb ka b kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr mw kt ku kv ij bi translated">我们的教程到此结束。一如既往，最好的学习方法是实践。我希望您花时间尝试代码片段，并从结果中学到一些东西。目前，电子邮件链接似乎是用户授权你的应用程序的主要方式，尽管Monzo可能正在做出改进。</p><p id="38de" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你认为这个解决方案怎么样？在评论里告诉我。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="da60" class="lu lv jb bd lw lx nm lz ma mb nn md me mf no mh mi mj np ml mm mn nq mp mq mr bi translated">进一步阅读</h1><ol class=""><li id="a78f" class="lg lh jb ka b kb ms kf mt kj nr kn ns kr nt kv ll lm ln lo bi translated"><a class="ae mx" href="https://developers.monzo.com" rel="noopener ugc nofollow" target="_blank"> Monzo开发者API </a></li><li id="1116" class="lg lh jb ka b kb lp kf lq kj lr kn ls kr lt kv ll lm ln lo bi translated">艾伦·帕雷基的《T4》第二版简化版</li></ol></div></div>    
</body>
</html>
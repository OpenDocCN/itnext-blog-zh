<html>
<head>
<title>Dockerize a Node.js app with VS Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用VS代码Dockerize一个Node.js应用</h1>
<blockquote>原文：<a href="https://itnext.io/dockerize-a-node-js-app-with-vs-code-bd471710dc22?source=collection_archive---------2-----------------------#2019-06-23">https://itnext.io/dockerize-a-node-js-app-with-vs-code-bd471710dc22?source=collection_archive---------2-----------------------#2019-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4b76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好亲爱的程序员，欢迎来到我的技术文章系列，献给<strong class="jp ir"> Node.js </strong>和<strong class="jp ir"> Docker。</strong>希望你喜欢！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b83f0cd273f48eb28cd61f2236e9f45d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNlQAn9sv5ig_zrHGGNyYQ.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://unsplash.com/photos/t20pc32VbrU" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/t20pc32VbrU</a></figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="afd1" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">问题:</h1><p id="2791" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">你以前从未使用过Docker，你是一名JavaScript开发人员。您希望了解如何将容器与节点一起使用。我们走吧！</p><h1 id="d3ba" class="lj lk iq bd ll lm mm lo lp lq mn ls lt lu mo lw lx ly mp ma mb mc mq me mf mg bi translated">1.设置</h1><p id="436d" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">在本教程中，我将使用我最喜欢的编辑器<a class="ae lb" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>。您还需要安装<a class="ae lb" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">节点</strong> </a>和<strong class="jp ir">停靠站</strong>。在我的例子中，我使用的是Windows，所以我从这里得到了Windows的Docker。</p><p id="9b46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个命令创建一个名为test-node-app的新文件夹，然后创建npm包文件并在VS代码中打开文件夹。</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="e862" class="mw lk iq ms b gy mx my l mz na">mkdir test-node-app &amp;&amp; cd test-node-app &amp;&amp; npm init -y &amp;&amp; code .</span></pre><p id="eced" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另外，请安装express来创建服务器。</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="0466" class="mw lk iq ms b gy mx my l mz na">npm i express</span></pre><h1 id="abd3" class="lj lk iq bd ll lm mm lo lp lq mn ls lt lu mo lw lx ly mp ma mb mc mq me mf mg bi translated">2.创建基本节点应用程序</h1><p id="8d27" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">打开<em class="nb"> package.json </em>文件，修改如下:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="c60b" class="mw lk iq ms b gy mx my l mz na">{<br/> "name": "test-node-app",<br/> "version": "1.0.0",<br/> "description": "",<br/> "main":<strong class="ms ir"> "server.js",</strong><br/> "scripts": {<br/><strong class="ms ir">   "start": "node server.js",</strong><br/>   "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/> },<br/> "keywords": [],<br/> "author": "",<br/> "license": "ISC",<br/> "dependencies": {<br/>  <strong class="ms ir"> "express": "^4.17.1"</strong><br/>  }<br/>}</span></pre><p id="f511" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在添加名为<em class="nb"> server.js: </em>的新文件</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="1cf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">超级基础基础app准备好了。现在我们来局部测试一下。在应用程序文件夹中运行此命令:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="339e" class="mw lk iq ms b gy mx my l mz na">npm start</span></pre><p id="2af9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该在控制台中看到以下内容，并且能够通过链接<a class="ae lb" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080/ </a>访问服务器</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/6779b5fc4627d3243877dc71d49506d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JkzlHYbKoF0GmhwoLOzAAQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">我正在使用git bash终端</figcaption></figure><h1 id="1839" class="lj lk iq bd ll lm mm lo lp lq mn ls lt lu mo lw lx ly mp ma mb mc mq me mf mg bi translated">3.准备文档文件</h1><p id="8af4" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">为了建立我们的形象，我们需要一个docker文件。创建一个名为<code class="fe nf ng nh ms b">Dockerfile</code>的文件</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="5033" class="mw lk iq ms b gy mx my l mz na">touch Dockerfile</span></pre><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="cc5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个文件告诉docker下载版本8的Node.js，为应用程序创建目录，复制那里的package.json文件，为node_modules运行<code class="fe nf ng nh ms b">npm install</code>，告诉这个应用程序想要使用哪个端口，最后用<code class="fe nf ng nh ms b">npm start</code>运行它。</p><p id="5493" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呃..很多是吗？😮</p><p id="1b43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还需要一个名为<code class="fe nf ng nh ms b">.dockerignore</code>的文件。创建并粘贴以下内容:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="9f55" class="mw lk iq ms b gy mx my l mz na">node_modules<br/>npm-debug.log</span></pre><h1 id="5720" class="lj lk iq bd ll lm mm lo lp lq mn ls lt lu mo lw lx ly mp ma mb mc mq me mf mg bi translated">4.建立码头工人形象</h1><p id="ae17" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">首先，用这个命令构建我们的映像。</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="b643" class="mw lk iq ms b gy mx my l mz na">docker build -t test-node-app .</span></pre><p id="54b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等到它完成，现在我们可以看到新的图像创建。</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="9bea" class="mw lk iq ms b gy mx my l mz na">docker images</span></pre><p id="46c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你用的是VS代码，可以安装一个非常好看的<a class="ae lb" href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker" rel="noopener ugc nofollow" target="_blank"> Docker扩展</a>。它在侧面板上添加了一个打开Docker explorer的按钮。在这里，您可以看到所有可用的图像和容器。从那里你可以运行，停止和删除容器，这是非常有用的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a6a4f4f6304238a910d09516803366bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*SYnYG8ar-evHr5y2-EncZQ.png"/></div></figure><p id="b77a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想删除图像，请运行以下命令:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="31f4" class="mw lk iq ms b gy mx my l mz na">docker rmi &lt;image id&gt;</span></pre><h1 id="1590" class="lj lk iq bd ll lm mm lo lp lq mn ls lt lu mo lw lx ly mp ma mb mc mq me mf mg bi translated">5.运行Docker容器(最终)</h1><p id="039f" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">是时候运行基于我们映像的容器了(我们在隔离环境中的应用程序)。重要的是我们需要告诉docker如何映射端口。现在我们运行我们的容器，将8080端口映射到49165。</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="ce62" class="mw lk iq ms b gy mx my l mz na">docker run -p 49165:8080 -d test-node-app</span></pre><p id="fd0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着我们现在可以通过这个网址访问应用程序<a class="ae lb" href="http://localhost:49165/" rel="noopener ugc nofollow" target="_blank"> http://localhost:49165/ </a></p><p id="1ddc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一个非常有用的命令可以查看所有正在运行的容器:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="ac00" class="mw lk iq ms b gy mx my l mz na">docker ps</span></pre><p id="764d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过在VS Code Docker扩展中右键单击或通过以下命令来停止容器:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="2b19" class="mw lk iq ms b gy mx my l mz na">docker stop &lt;container id&gt;</span></pre><p id="087c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您再次运行<code class="fe nf ng nh ms b">docker ps</code>，您将看不到您的容器正在运行。如果您想查看停止的容器，您需要像这样在命令中添加<code class="fe nf ng nh ms b">— all</code>标志:</p><pre class="km kn ko kp gt mr ms mt mu aw mv bi"><span id="1b93" class="mw lk iq ms b gy mx my l mz na">docker ps -a</span></pre><p id="2e31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你还有一些问题，你可以在这里查阅官方<a class="ae lb" href="https://nodejs.org/de/docs/guides/nodejs-docker-webapp/" rel="noopener ugc nofollow" target="_blank">文件</a>。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="ed5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">🚀如果你从那篇文章中读到了一些有趣的东西，请喜欢并关注我的更多帖子。谢谢你亲爱的编码员！😏</p></div></div>    
</body>
</html>
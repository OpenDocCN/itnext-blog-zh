<html>
<head>
<title>How to easily command your app with hotword detection?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用热门词检测轻松指挥你的app？</h1>
<blockquote>原文：<a href="https://itnext.io/how-to-easily-command-your-app-with-hotword-detection-1001e582c46e?source=collection_archive---------0-----------------------#2017-08-22">https://itnext.io/how-to-easily-command-your-app-with-hotword-detection-1001e582c46e?source=collection_archive---------0-----------------------#2017-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="970b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建自己的热门词汇，类似于“好的，谷歌”，“嘿Siri”</h2></div><p id="f587" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在最后的教程中建议了一些实现连续语音识别的库。我们的目标是开发一款只支持语音控制的安卓应用。我们首先研究了类似于<a class="ae lb" href="https://www.google.com/search/about/" rel="noopener ugc nofollow" target="_blank">Google Now</a>&amp;<a class="ae lb" href="https://assistant.google.com/" rel="noopener ugc nofollow" target="_blank">Google Assistant</a><a class="ae lb" href="https://developers.google.com/voice-actions/" rel="noopener ugc nofollow" target="_blank">语音操作</a><a class="ae lb" href="https://developer.android.com/reference/android/speech/SpeechRecognizer.html" rel="noopener ugc nofollow" target="_blank">speech recognizer</a>和<a class="ae lb" href="https://developer.android.com/reference/android/speech/tts/TextToSpeech.html" rel="noopener ugc nofollow" target="_blank"> TextToSpeech </a>的本地方法。我们还体验到，Google Assistant - <code class="fe lc ld le lf b">"Ok, Google"</code>，不允许我们在前台保持应用程序的同时采取进一步的自定义操作。</p><p id="441a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">解决方案是创建我们自己的热门词汇来触发应用程序采取进一步的行动，比如增加我们的用例中某个玩家的分数:乒乓球板应用程序。有两个特色的第三方库，看起来有希望拥有自己的热门词汇。<a class="ae lb" href="https://cmusphinx.github.io/wiki/tutorialandroid/" rel="noopener ugc nofollow" target="_blank"> PocketSphinx </a>和<a class="ae lb" href="https://snowboy.kitt.ai/" rel="noopener ugc nofollow" target="_blank"> Snowboy </a>。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/f7e056f44bbfbc486898d55f6d3f1a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6w82EuMI01G2_V2Vlc3sqg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">使用热门词汇检测的乒乓球游戏的用户界面。</figcaption></figure><h1 id="0abf" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">PocketSphinx:</h1><p id="d40a" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">我们从下载示例github项目开始。它首先检测热门词汇<code class="fe lc ld le lf b">"oh mighty computer"</code>，然后检测其他热门词汇，如<code class="fe lc ld le lf b">"digits", "forecast", "phones"</code>。结果并不令人满意，我们无法继续实现这个库。</p><div class="mt mu gp gr mv mw"><a href="https://github.com/cmusphinx/pocketsphinx-android-demo" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd ir gy z fp nb fr fs nc fu fw ip bi translated">cmusphinx/pocket sphinx-Android-演示</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">这是一个pocketsphinx在android上的演示</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">github.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk lq mw"/></div></div></a></div><h1 id="0782" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">雪男孩:</h1><p id="2c28" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">他们的网站用一个教程视频欢迎你，这个视频解释了这个库的功能，这正是我们正在寻找的。这是一个可定制的热门词汇检测引擎，由深度神经网络驱动。它是轻量级和嵌入式的。您不需要互联网连接，并且它与示例语言模型配合得很好。</p><blockquote class="nl nm nn"><p id="354d" class="kf kg no kh b ki kj jr kk kl km ju kn np kp kq kr nq kt ku kv nr kx ky kz la ij bi translated">您可以查看他们的文档，了解如何将这个库包含到您自己的应用程序中。</p></blockquote><div class="mt mu gp gr mv mw"><a href="https://github.com/Kitt-AI/snowboy" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd ir gy z fp nb fr fs nc fu fw ip bi translated">kitt-AI/雪球</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">基于snowboy - DNN的热门词和唤醒词检测工具包</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">github.com</p></div></div><div class="nf l"><div class="ns l nh ni nj nf nk lq mw"/></div></div></a></div><h2 id="53ee" class="nt lx iq bd ly nu nv dn mc nw nx dp mg ko ny nz mi ks oa ob mk kw oc od mm oe bi translated"><strong class="ak">个人型号:</strong></h2><p id="186e" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">通过他们的<a class="ae lb" href="https://snowboy.kitt.ai/dashboard" rel="noopener ugc nofollow" target="_blank">网站</a>或者<a class="ae lb" href="https://snowboy.kitt.ai/api/v1/train/" rel="noopener ugc nofollow" target="_blank">热门词API </a>，你可以创建你的个人模型，。pmdl文件。不好的是这种个人模式只对你的声音有效。</p><h2 id="b957" class="nt lx iq bd ly nu nv dn mc nw nx dp mg ko ny nz mi ks oa ob mk kw oc od mm oe bi translated"><strong class="ak">通用型号:</strong></h2><p id="359c" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">如果你想拥有一个可以被任何人触发的热门词汇，你需要和尽可能多的人一起训练你的语言模型。为你的热门词汇创建一个通用模型。umdl)并不是免费的。您应该联系图书馆所有者了解价格。有两个用于测试的示例通用模型，<code class="fe lc ld le lf b">Alexa</code>和<code class="fe lc ld le lf b">Snowboy</code>，我们将在本教程中使用它们。</p><h1 id="e6c9" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">决定我们自己的声音动作实现</h1><p id="4718" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">我们有两种方法可供选择。更简单和更准确的方法是使用两个热词，如<code class="fe lc ld le lf b">Alexa</code>和<code class="fe lc ld le lf b">Snowboy</code>，来确定谁在我们的应用程序中得分。如果我们需要更多的语音命令，这将不是一个合理的实现。在我们的例子中，我们不需要复杂的语音命令，因此这种方法非常适合。</p><p id="3df0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二种方法是只使用一个热门词汇，比如<code class="fe lc ld le lf b">Alexa</code>，然后对命令的其余部分使用语音识别。我们尝试微软Bing API在热门词检测后识别命令，如<code class="fe lc ld le lf b">Alexa, red</code>或<code class="fe lc ld le lf b">Alexa, blue</code></p><p id="bd0f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还使用一个标志来保持屏幕打开，以便在游戏过程中进行连续的语音识别。</p><pre class="lh li lj lk gt of lf og oh aw oi bi"><span id="1bc0" class="nt lx iq lf b gy oj ok l ol om">getWindow().addFlags(WindowManager.LayoutParams.<strong class="lf ir"><em class="no">FLAG_KEEP_SCREEN_ON)</em></strong></span></pre><h2 id="7774" class="nt lx iq bd ly nu nv dn mc nw nx dp mg ko ny nz mi ks oa ob mk kw oc od mm oe bi translated"><strong class="ak">仅使用带有两个热门词汇的Snowboy库:</strong></h2><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi on"><img src="../Images/04a80720bd473120b0fd5edada779619.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*9lP7Xv3O3jghKBPafhjaeg.png"/></div></figure><p id="4ca7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们首先用两个不同的模型初始化我们的热门词检测器类<code class="fe lc ld le lf b">SnowboyDetect</code>。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="7f61" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用native <code class="fe lc ld le lf b">AudioRecord</code>类实现连续监听来检测热门词汇。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="903e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过下面的代码块，我们对每个语音数据块运行热门词汇检测。该库能够识别热门词汇，即使它们由于缓冲区大小而被拆分。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="2a08" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">用Snowboy检测热门词后使用Bing API进行语音识别:</strong></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi on"><img src="../Images/af9a30ba8fe35ee6eb6d0efb085429ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*tvQTK_Mlm8nzlmby_hezQw.png"/></div></figure><p id="b42d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我们的用例来说，这种方法的缺点是我们必须为区分两个静态关键字的每个调用付费。虽然使用两个热门词汇对我们来说已经足够了，但我们希望用动态命令来改进我们的实现。因此我们需要声音识别。没有免费的服务可以将语音转换成文本，但有许多付费的好服务，如<a class="ae lb" href="https://aws.amazon.com/documentation/lex/" rel="noopener ugc nofollow" target="_blank">亚马逊Lex </a>、<a class="ae lb" href="https://cloud.google.com/speech/?gclid=Cj0KCQjw5arMBRDzARIsAAqmJeyjkv2jJGsBi4j7LsCirwy4GJsNUTkLTBQjdeaWokEyCsJSlzuRKvoaAmWzEALw_wcB&amp;dclid=CIjsk7uZytUCFQ2rdwodUXIEsA" rel="noopener ugc nofollow" target="_blank">谷歌语音API </a>、<a class="ae lb" href="https://docs.microsoft.com/en-us/azure/cognitive-services/speech/getstarted/getstartedjavaandroid" rel="noopener ugc nofollow" target="_blank">微软必应API </a>。我们需要一个获取音频数据并返回不同可信度文本的服务。对于我们的用例，Bing API是众多满足我们需求的服务中最容易实现的。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="95a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个api有两种不同的语音识别方法。你可以使用麦克风或发送波形文件。我们方法中最大的挑战是将Snowboy实现与Bing API相结合。因为我们已经为Snowboy库使用了麦克风，所以我们选择发送wave文件选项。我们期待像<code class="fe lc ld le lf b">Alexa, red</code>或<code class="fe lc ld le lf b">Alexa, blue</code>这样的命令。在检测到hotword后，我们录制下面的语音一段时间，并将其作为wave文件发送到Bing API，并获得文本结果。根据结果，我们增加相关玩家的分数。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oo op l"/></div></figure><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oo op l"/></div></figure><h2 id="6ae0" class="nt lx iq bd ly nu nv dn mc nw nx dp mg ko ny nz mi ks oa ob mk kw oc od mm oe bi translated">结论</h2><p id="86de" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">热门词检测是实现连续语音识别目标的基础部分。目前，这是触发您的应用程序收听语音操作的最符合逻辑的方式。使用两个热门词汇的方法最适合我们。它很流畅，而且相当准确。唯一的问题是当环境中有太多噪音时识别语音命令。</p><p id="4404" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过服务结合实现本地热门词汇检测和语音识别也很有前景。但是它不如第一种方法精确。有时，检测到热门词汇后录制的音频数据可能会出现静音检测问题。这可能与Bing API有关。此外，决定何时开始和停止记录发送到语音识别服务的语音数据可能很棘手。</p><p id="fb97" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经开始在办公室使用我们的乒乓球应用程序来记录我们的分数，现在我们面临成为最佳球员的挑战。</p><p id="77b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢你刚刚读到的，别忘了阅读关于这个项目的其他文章<a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/using-voice-commands-in-an-android-app-b0be26d50958"><em class="no"/></a><em class="no">。觉得这是一个很酷的项目，喜欢文章？通过点击鼓掌图标来给予一些掌声👏🏽。</em></p></div></div>    
</body>
</html>